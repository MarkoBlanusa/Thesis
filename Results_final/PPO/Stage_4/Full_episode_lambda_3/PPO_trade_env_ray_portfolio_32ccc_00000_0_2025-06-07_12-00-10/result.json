{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5, "cur_lr": 0.00010000000000000002, "total_loss": -0.1374226038861606, "policy_loss": -0.06487636813350643, "vf_loss": 0.21609584502875806, "vf_explained_var": 0.12837055822213492, "kl": 0.011253464638462855, "entropy": 14.300172826978896, "entropy_coeff": 0.009999999999999998}, "model": {}, "num_grad_updates_lifetime": 90.5, "diff_num_grad_updates_vs_sampler_policy": 89.5}}, "num_env_steps_sampled": 5259, "num_env_steps_trained": 5259, "num_agent_steps_sampled": 5259, "num_agent_steps_trained": 5259}, "sampler_results": {"episode_reward_max": -19.258097190037464, "episode_reward_min": -65.40042692782038, "episode_reward_mean": -35.13614218075294, "episode_len_mean": 375.64285714285717, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.40042692782038, -22.363844992556725, -39.67474470997841, -30.714078330738563, -21.63603545508221, -28.37716980082248, -26.668957578083063, -19.258097190037464, -20.705981960282468, -41.021661098853464, -46.83628407835066, -55.21072300202043, -26.418044431257236, -47.61994097465763], "episode_lengths": [419, 241, 305, 297, 259, 1117, 281, 269, 288, 324, 350, 439, 295, 375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6622215705229837, "mean_inference_ms": 7.310983374042258, "mean_action_processing_ms": 0.5131739462344089, "mean_env_wait_ms": 24.644456090977084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035706588200160434, "StateBufferConnector_ms": 0.022220611572265625, "ViewRequirementAgentConnector_ms": 0.9223733629499163}}, "episode_reward_max": -19.258097190037464, "episode_reward_min": -65.40042692782038, "episode_reward_mean": -35.13614218075294, "episode_len_mean": 375.64285714285717, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-65.40042692782038, -22.363844992556725, -39.67474470997841, -30.714078330738563, -21.63603545508221, -28.37716980082248, -26.668957578083063, -19.258097190037464, -20.705981960282468, -41.021661098853464, -46.83628407835066, -55.21072300202043, -26.418044431257236, -47.61994097465763], "episode_lengths": [419, 241, 305, 297, 259, 1117, 281, 269, 288, 324, 350, 439, 295, 375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6622215705229837, "mean_inference_ms": 7.310983374042258, "mean_action_processing_ms": 0.5131739462344089, "mean_env_wait_ms": 24.644456090977084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035706588200160434, "StateBufferConnector_ms": 0.022220611572265625, "ViewRequirementAgentConnector_ms": 0.9223733629499163}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5259, "num_agent_steps_trained": 5259, "num_env_steps_sampled": 5259, "num_env_steps_trained": 5259, "num_env_steps_sampled_this_iter": 5259, "num_env_steps_trained_this_iter": 5259, "num_env_steps_sampled_throughput_per_sec": 169.7801461403401, "num_env_steps_trained_throughput_per_sec": 169.7801461403401, "timesteps_total": 5259, "num_steps_trained_this_iter": 5259, "agent_timesteps_total": 5259, "timers": {"training_iteration_time_ms": 30975.353, "sample_time_ms": 24690.413, "load_time_ms": 1381.443, "load_throughput": 3806.89, "learn_time_ms": 4444.647, "learn_throughput": 1183.221, "synch_weights_time_ms": 411.559}, "counters": {"num_env_steps_sampled": 5259, "num_env_steps_trained": 5259, "num_agent_steps_sampled": 5259, "num_agent_steps_trained": 5259}, "done": false, "episodes_total": 14, "training_iteration": 1, "trial_id": "32ccc_00000", "date": "2025-06-07_12-01-44", "timestamp": 1749290504, "time_this_iter_s": 30.9983332157135, "time_total_s": 30.9983332157135, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 30.9983332157135, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 49.7, "ram_util_percent": 68.74210526315787, "gpu_util_percent0": 0.049473684210526316, "vram_util_percent0": 0.05210903234649122}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5, "cur_lr": 9.994741e-05, "total_loss": -0.11454471427481622, "policy_loss": -0.021403747349977492, "vf_loss": 0.15352428635582327, "vf_explained_var": 0.595856721997261, "kl": 0.008047972138829209, "entropy": 14.359983978271485, "entropy_coeff": 0.009973705}, "model": {}, "num_grad_updates_lifetime": 280.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 11077, "num_env_steps_trained": 11077, "num_agent_steps_sampled": 11077, "num_agent_steps_trained": 11077}, "sampler_results": {"episode_reward_max": 15.936835352241701, "episode_reward_min": -65.40042692782038, "episode_reward_mean": -23.729155385924496, "episode_len_mean": 395.60714285714283, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.40042692782038, -22.363844992556725, -39.67474470997841, -30.714078330738563, -21.63603545508221, -28.37716980082248, -26.668957578083063, -19.258097190037464, -20.705981960282468, -41.021661098853464, -46.83628407835066, -55.21072300202043, -26.418044431257236, -47.61994097465763, 15.936835352241701, -2.1702503369098296, -2.8880819974787366, -19.66831915013725, -7.941646672485021, -1.3642967545251494, -52.09552407213531, -36.54750208365535, -0.633896789164214, -34.78884807008794, -24.689187647038032, 10.007778715512089, -12.01254727170572, -3.654873497776111], "episode_lengths": [419, 241, 305, 297, 259, 1117, 281, 269, 288, 324, 350, 439, 295, 375, 259, 259, 295, 406, 296, 339, 587, 453, 295, 567, 411, 328, 950, 373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5409733912741777, "mean_inference_ms": 7.2104544128400505, "mean_action_processing_ms": 0.505076895265997, "mean_env_wait_ms": 23.636894767692215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500840595790318, "StateBufferConnector_ms": 0.01827308109828404, "ViewRequirementAgentConnector_ms": 0.8301879678453717}}, "episode_reward_max": 15.936835352241701, "episode_reward_min": -65.40042692782038, "episode_reward_mean": -23.729155385924496, "episode_len_mean": 395.60714285714283, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-65.40042692782038, -22.363844992556725, -39.67474470997841, -30.714078330738563, -21.63603545508221, -28.37716980082248, -26.668957578083063, -19.258097190037464, -20.705981960282468, -41.021661098853464, -46.83628407835066, -55.21072300202043, -26.418044431257236, -47.61994097465763, 15.936835352241701, -2.1702503369098296, -2.8880819974787366, -19.66831915013725, -7.941646672485021, -1.3642967545251494, -52.09552407213531, -36.54750208365535, -0.633896789164214, -34.78884807008794, -24.689187647038032, 10.007778715512089, -12.01254727170572, -3.654873497776111], "episode_lengths": [419, 241, 305, 297, 259, 1117, 281, 269, 288, 324, 350, 439, 295, 375, 259, 259, 295, 406, 296, 339, 587, 453, 295, 567, 411, 328, 950, 373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5409733912741777, "mean_inference_ms": 7.2104544128400505, "mean_action_processing_ms": 0.505076895265997, "mean_env_wait_ms": 23.636894767692215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500840595790318, "StateBufferConnector_ms": 0.01827308109828404, "ViewRequirementAgentConnector_ms": 0.8301879678453717}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11077, "num_agent_steps_trained": 11077, "num_env_steps_sampled": 11077, "num_env_steps_trained": 11077, "num_env_steps_sampled_this_iter": 5818, "num_env_steps_trained_this_iter": 5818, "num_env_steps_sampled_throughput_per_sec": 206.7051547753347, "num_env_steps_trained_throughput_per_sec": 206.7051547753347, "timesteps_total": 11077, "num_steps_trained_this_iter": 5818, "agent_timesteps_total": 11077, "timers": {"training_iteration_time_ms": 29560.862, "sample_time_ms": 23473.587, "load_time_ms": 1126.623, "load_throughput": 4916.017, "learn_time_ms": 4511.993, "learn_throughput": 1227.506, "synch_weights_time_ms": 398.516}, "counters": {"num_env_steps_sampled": 11077, "num_env_steps_trained": 11077, "num_agent_steps_sampled": 11077, "num_agent_steps_trained": 11077}, "done": false, "episodes_total": 28, "training_iteration": 2, "trial_id": "32ccc_00000", "date": "2025-06-07_12-02-13", "timestamp": 1749290533, "time_this_iter_s": 28.15937352180481, "time_total_s": 59.15770673751831, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 59.15770673751831, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 56.55454545454545, "ram_util_percent": 71.14242424242425, "gpu_util_percent0": 0.046363636363636364, "vram_util_percent0": 0.21620995107323232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5, "cur_lr": 9.988923000000003e-05, "total_loss": -0.1254238743626047, "policy_loss": -0.031690253984803955, "vf_loss": 0.1509147063557369, "vf_explained_var": 0.7344245714445908, "kl": 0.00697315507775329, "entropy": 14.3288223862648, "entropy_coeff": 0.009944615}, "model": {}, "num_grad_updates_lifetime": 500.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 17947, "num_env_steps_trained": 17947, "num_agent_steps_sampled": 17947, "num_agent_steps_trained": 17947}, "sampler_results": {"episode_reward_max": 23.8030513385187, "episode_reward_min": -65.40042692782038, "episode_reward_mean": -18.877212875658195, "episode_len_mean": 427.3095238095238, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.40042692782038, -22.363844992556725, -39.67474470997841, -30.714078330738563, -21.63603545508221, -28.37716980082248, -26.668957578083063, -19.258097190037464, -20.705981960282468, -41.021661098853464, -46.83628407835066, -55.21072300202043, -26.418044431257236, -47.61994097465763, 15.936835352241701, -2.1702503369098296, -2.8880819974787366, -19.66831915013725, -7.941646672485021, -1.3642967545251494, -52.09552407213531, -36.54750208365535, -0.633896789164214, -34.78884807008794, -24.689187647038032, 10.007778715512089, -12.01254727170572, -3.654873497776111, 1.6732252017983833, -36.366970342576195, -1.5201646127893547, -26.260299430169933, -1.3735788683399477, 3.4457193454103567, -23.96872960323088, -14.607439816748434, -26.623545178497483, 23.8030513385187, -3.3342687776948288, -2.7628861642589797, -24.910606371333774, 4.379903308154179], "episode_lengths": [419, 241, 305, 297, 259, 1117, 281, 269, 288, 324, 350, 439, 295, 375, 259, 259, 295, 406, 296, 339, 587, 453, 295, 567, 411, 328, 950, 373, 233, 915, 796, 440, 212, 273, 653, 408, 273, 259, 408, 849, 778, 373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.442859902810748, "mean_inference_ms": 7.107109717124344, "mean_action_processing_ms": 0.4957931778869985, "mean_env_wait_ms": 22.929262900997053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02856935773577009, "StateBufferConnector_ms": 0.01930736360095796, "ViewRequirementAgentConnector_ms": 0.7946831839425224}}, "episode_reward_max": 23.8030513385187, "episode_reward_min": -65.40042692782038, "episode_reward_mean": -18.877212875658195, "episode_len_mean": 427.3095238095238, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-65.40042692782038, -22.363844992556725, -39.67474470997841, -30.714078330738563, -21.63603545508221, -28.37716980082248, -26.668957578083063, -19.258097190037464, -20.705981960282468, -41.021661098853464, -46.83628407835066, -55.21072300202043, -26.418044431257236, -47.61994097465763, 15.936835352241701, -2.1702503369098296, -2.8880819974787366, -19.66831915013725, -7.941646672485021, -1.3642967545251494, -52.09552407213531, -36.54750208365535, -0.633896789164214, -34.78884807008794, -24.689187647038032, 10.007778715512089, -12.01254727170572, -3.654873497776111, 1.6732252017983833, -36.366970342576195, -1.5201646127893547, -26.260299430169933, -1.3735788683399477, 3.4457193454103567, -23.96872960323088, -14.607439816748434, -26.623545178497483, 23.8030513385187, -3.3342687776948288, -2.7628861642589797, -24.910606371333774, 4.379903308154179], "episode_lengths": [419, 241, 305, 297, 259, 1117, 281, 269, 288, 324, 350, 439, 295, 375, 259, 259, 295, 406, 296, 339, 587, 453, 295, 567, 411, 328, 950, 373, 233, 915, 796, 440, 212, 273, 653, 408, 273, 259, 408, 849, 778, 373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.442859902810748, "mean_inference_ms": 7.107109717124344, "mean_action_processing_ms": 0.4957931778869985, "mean_env_wait_ms": 22.929262900997053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02856935773577009, "StateBufferConnector_ms": 0.01930736360095796, "ViewRequirementAgentConnector_ms": 0.7946831839425224}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17947, "num_agent_steps_trained": 17947, "num_env_steps_sampled": 17947, "num_env_steps_trained": 17947, "num_env_steps_sampled_this_iter": 6870, "num_env_steps_trained_this_iter": 6870, "num_env_steps_sampled_throughput_per_sec": 230.63900374445313, "num_env_steps_trained_throughput_per_sec": 230.63900374445313, "timesteps_total": 17947, "num_steps_trained_this_iter": 6870, "agent_timesteps_total": 17947, "timers": {"training_iteration_time_ms": 29636.178, "sample_time_ms": 23199.876, "load_time_ms": 1095.874, "load_throughput": 5458.959, "learn_time_ms": 4874.382, "learn_throughput": 1227.301, "synch_weights_time_ms": 413.95}, "counters": {"num_env_steps_sampled": 17947, "num_env_steps_trained": 17947, "num_agent_steps_sampled": 17947, "num_agent_steps_trained": 17947}, "done": false, "episodes_total": 42, "training_iteration": 3, "trial_id": "32ccc_00000", "date": "2025-06-07_12-02-43", "timestamp": 1749290563, "time_this_iter_s": 29.801832914352417, "time_total_s": 88.95953965187073, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 88.95953965187073, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 56.88333333333333, "ram_util_percent": 71.86111111111113, "gpu_util_percent0": 0.057499999999999996, "vram_util_percent0": 0.38319227430555547}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.25, "cur_lr": 9.982053000000003e-05, "total_loss": -0.049503150225306554, "policy_loss": 0.047781548334751275, "vf_loss": 0.14557930399508526, "vf_explained_var": 0.7933152228593826, "kl": 0.00813326098541468, "entropy": 14.428656248251597, "entropy_coeff": 0.009910265}, "model": {}, "num_grad_updates_lifetime": 740.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 24905, "num_env_steps_trained": 24905, "num_agent_steps_sampled": 24905, "num_agent_steps_trained": 24905}, "sampler_results": {"episode_reward_max": 23.8030513385187, "episode_reward_min": -65.40042692782038, "episode_reward_mean": -14.137348498725808, "episode_len_mean": 444.73214285714283, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.40042692782038, -22.363844992556725, -39.67474470997841, -30.714078330738563, -21.63603545508221, -28.37716980082248, -26.668957578083063, -19.258097190037464, -20.705981960282468, -41.021661098853464, -46.83628407835066, -55.21072300202043, -26.418044431257236, -47.61994097465763, 15.936835352241701, -2.1702503369098296, -2.8880819974787366, -19.66831915013725, -7.941646672485021, -1.3642967545251494, -52.09552407213531, -36.54750208365535, -0.633896789164214, -34.78884807008794, -24.689187647038032, 10.007778715512089, -12.01254727170572, -3.654873497776111, 1.6732252017983833, -36.366970342576195, -1.5201646127893547, -26.260299430169933, -1.3735788683399477, 3.4457193454103567, -23.96872960323088, -14.607439816748434, -26.623545178497483, 23.8030513385187, -3.3342687776948288, -2.7628861642589797, -24.910606371333774, 4.379903308154179, -41.18468998249631, 2.593656449735272, 0.4884257439052494, 13.893608638292973, -14.180751420227892, -23.929680159223032, 17.927360750426946, 6.532702574278514, 10.958171380855976, 10.966567614133895, 10.427877658767, 12.986082002685453, -16.336889522990635, 10.008983120855573], "episode_lengths": [419, 241, 305, 297, 259, 1117, 281, 269, 288, 324, 350, 439, 295, 375, 259, 259, 295, 406, 296, 339, 587, 453, 295, 567, 411, 328, 950, 373, 233, 915, 796, 440, 212, 273, 653, 408, 273, 259, 408, 849, 778, 373, 439, 326, 1090, 259, 751, 984, 244, 168, 183, 296, 269, 1117, 567, 265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3763203411342135, "mean_inference_ms": 7.02013846611811, "mean_action_processing_ms": 0.4883824154314749, "mean_env_wait_ms": 22.41676215565865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024968811443873813, "StateBufferConnector_ms": 0.016279731478009905, "ViewRequirementAgentConnector_ms": 0.7945248058864048}}, "episode_reward_max": 23.8030513385187, "episode_reward_min": -65.40042692782038, "episode_reward_mean": -14.137348498725808, "episode_len_mean": 444.73214285714283, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-65.40042692782038, -22.363844992556725, -39.67474470997841, -30.714078330738563, -21.63603545508221, -28.37716980082248, -26.668957578083063, -19.258097190037464, -20.705981960282468, -41.021661098853464, -46.83628407835066, -55.21072300202043, -26.418044431257236, -47.61994097465763, 15.936835352241701, -2.1702503369098296, -2.8880819974787366, -19.66831915013725, -7.941646672485021, -1.3642967545251494, -52.09552407213531, -36.54750208365535, -0.633896789164214, -34.78884807008794, -24.689187647038032, 10.007778715512089, -12.01254727170572, -3.654873497776111, 1.6732252017983833, -36.366970342576195, -1.5201646127893547, -26.260299430169933, -1.3735788683399477, 3.4457193454103567, -23.96872960323088, -14.607439816748434, -26.623545178497483, 23.8030513385187, -3.3342687776948288, -2.7628861642589797, -24.910606371333774, 4.379903308154179, -41.18468998249631, 2.593656449735272, 0.4884257439052494, 13.893608638292973, -14.180751420227892, -23.929680159223032, 17.927360750426946, 6.532702574278514, 10.958171380855976, 10.966567614133895, 10.427877658767, 12.986082002685453, -16.336889522990635, 10.008983120855573], "episode_lengths": [419, 241, 305, 297, 259, 1117, 281, 269, 288, 324, 350, 439, 295, 375, 259, 259, 295, 406, 296, 339, 587, 453, 295, 567, 411, 328, 950, 373, 233, 915, 796, 440, 212, 273, 653, 408, 273, 259, 408, 849, 778, 373, 439, 326, 1090, 259, 751, 984, 244, 168, 183, 296, 269, 1117, 567, 265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3763203411342135, "mean_inference_ms": 7.02013846611811, "mean_action_processing_ms": 0.4883824154314749, "mean_env_wait_ms": 22.41676215565865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024968811443873813, "StateBufferConnector_ms": 0.016279731478009905, "ViewRequirementAgentConnector_ms": 0.7945248058864048}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24905, "num_agent_steps_trained": 24905, "num_env_steps_sampled": 24905, "num_env_steps_trained": 24905, "num_env_steps_sampled_this_iter": 6958, "num_env_steps_trained_this_iter": 6958, "num_env_steps_sampled_throughput_per_sec": 217.32374394215154, "num_env_steps_trained_throughput_per_sec": 217.32374394215154, "timesteps_total": 24905, "num_steps_trained_this_iter": 6958, "agent_timesteps_total": 24905, "timers": {"training_iteration_time_ms": 30231.321, "sample_time_ms": 23643.619, "load_time_ms": 1076.217, "load_throughput": 5785.313, "learn_time_ms": 5046.61, "learn_throughput": 1233.749, "synch_weights_time_ms": 414.268}, "counters": {"num_env_steps_sampled": 24905, "num_env_steps_trained": 24905, "num_agent_steps_sampled": 24905, "num_agent_steps_trained": 24905}, "done": false, "episodes_total": 56, "training_iteration": 4, "trial_id": "32ccc_00000", "date": "2025-06-07_12-03-15", "timestamp": 1749290595, "time_this_iter_s": 32.03259873390198, "time_total_s": 120.9921383857727, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 120.9921383857727, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 53.369230769230775, "ram_util_percent": 72.06410256410257, "gpu_util_percent0": 0.061538461538461535, "vram_util_percent0": 0.565033219818376}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.25, "cur_lr": 9.975095000000004e-05, "total_loss": -0.13280504915940886, "policy_loss": -0.03197625390566827, "vf_loss": 0.1351191374861325, "vf_explained_var": 0.8725894560416539, "kl": 0.0075578684165672405, "entropy": 14.506036619345346, "entropy_coeff": 0.009875474999999998}, "model": {}, "num_grad_updates_lifetime": 980.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 31668, "num_env_steps_trained": 31668, "num_agent_steps_sampled": 31668, "num_agent_steps_trained": 31668}, "sampler_results": {"episode_reward_max": 26.292218688725306, "episode_reward_min": -65.40042692782038, "episode_reward_mean": -11.800860143457472, "episode_len_mean": 452.4, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.40042692782038, -22.363844992556725, -39.67474470997841, -30.714078330738563, -21.63603545508221, -28.37716980082248, -26.668957578083063, -19.258097190037464, -20.705981960282468, -41.021661098853464, -46.83628407835066, -55.21072300202043, -26.418044431257236, -47.61994097465763, 15.936835352241701, -2.1702503369098296, -2.8880819974787366, -19.66831915013725, -7.941646672485021, -1.3642967545251494, -52.09552407213531, -36.54750208365535, -0.633896789164214, -34.78884807008794, -24.689187647038032, 10.007778715512089, -12.01254727170572, -3.654873497776111, 1.6732252017983833, -36.366970342576195, -1.5201646127893547, -26.260299430169933, -1.3735788683399477, 3.4457193454103567, -23.96872960323088, -14.607439816748434, -26.623545178497483, 23.8030513385187, -3.3342687776948288, -2.7628861642589797, -24.910606371333774, 4.379903308154179, -41.18468998249631, 2.593656449735272, 0.4884257439052494, 13.893608638292973, -14.180751420227892, -23.929680159223032, 17.927360750426946, 6.532702574278514, 10.958171380855976, 10.966567614133895, 10.427877658767, 12.986082002685453, -16.336889522990635, 10.008983120855573, 26.292218688725306, -12.560840179741998, 3.1492325078675574, 6.549258727157416, -28.08106270160294, 18.573629628705405, 10.027611869332063, 15.072332626001387, -22.532755346576575, 14.132015857715881, -24.21889107775263, 10.228674325537304, -25.68661413162303, -25.31350490712293], "episode_lengths": [419, 241, 305, 297, 259, 1117, 281, 269, 288, 324, 350, 439, 295, 375, 259, 259, 295, 406, 296, 339, 587, 453, 295, 567, 411, 328, 950, 373, 233, 915, 796, 440, 212, 273, 653, 408, 273, 259, 408, 849, 778, 373, 439, 326, 1090, 259, 751, 984, 244, 168, 183, 296, 269, 1117, 567, 265, 1117, 953, 269, 269, 397, 259, 295, 299, 439, 229, 411, 338, 825, 663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.33033518966698, "mean_inference_ms": 6.965785679293628, "mean_action_processing_ms": 0.48316956704037234, "mean_env_wait_ms": 22.054396320868545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02572366169520787, "StateBufferConnector_ms": 0.021748202187674388, "ViewRequirementAgentConnector_ms": 0.7479241916111538}}, "episode_reward_max": 26.292218688725306, "episode_reward_min": -65.40042692782038, "episode_reward_mean": -11.800860143457472, "episode_len_mean": 452.4, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-65.40042692782038, -22.363844992556725, -39.67474470997841, -30.714078330738563, -21.63603545508221, -28.37716980082248, -26.668957578083063, -19.258097190037464, -20.705981960282468, -41.021661098853464, -46.83628407835066, -55.21072300202043, -26.418044431257236, -47.61994097465763, 15.936835352241701, -2.1702503369098296, -2.8880819974787366, -19.66831915013725, -7.941646672485021, -1.3642967545251494, -52.09552407213531, -36.54750208365535, -0.633896789164214, -34.78884807008794, -24.689187647038032, 10.007778715512089, -12.01254727170572, -3.654873497776111, 1.6732252017983833, -36.366970342576195, -1.5201646127893547, -26.260299430169933, -1.3735788683399477, 3.4457193454103567, -23.96872960323088, -14.607439816748434, -26.623545178497483, 23.8030513385187, -3.3342687776948288, -2.7628861642589797, -24.910606371333774, 4.379903308154179, -41.18468998249631, 2.593656449735272, 0.4884257439052494, 13.893608638292973, -14.180751420227892, -23.929680159223032, 17.927360750426946, 6.532702574278514, 10.958171380855976, 10.966567614133895, 10.427877658767, 12.986082002685453, -16.336889522990635, 10.008983120855573, 26.292218688725306, -12.560840179741998, 3.1492325078675574, 6.549258727157416, -28.08106270160294, 18.573629628705405, 10.027611869332063, 15.072332626001387, -22.532755346576575, 14.132015857715881, -24.21889107775263, 10.228674325537304, -25.68661413162303, -25.31350490712293], "episode_lengths": [419, 241, 305, 297, 259, 1117, 281, 269, 288, 324, 350, 439, 295, 375, 259, 259, 295, 406, 296, 339, 587, 453, 295, 567, 411, 328, 950, 373, 233, 915, 796, 440, 212, 273, 653, 408, 273, 259, 408, 849, 778, 373, 439, 326, 1090, 259, 751, 984, 244, 168, 183, 296, 269, 1117, 567, 265, 1117, 953, 269, 269, 397, 259, 295, 299, 439, 229, 411, 338, 825, 663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.33033518966698, "mean_inference_ms": 6.965785679293628, "mean_action_processing_ms": 0.48316956704037234, "mean_env_wait_ms": 22.054396320868545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02572366169520787, "StateBufferConnector_ms": 0.021748202187674388, "ViewRequirementAgentConnector_ms": 0.7479241916111538}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31668, "num_agent_steps_trained": 31668, "num_env_steps_sampled": 31668, "num_env_steps_trained": 31668, "num_env_steps_sampled_this_iter": 6763, "num_env_steps_trained_this_iter": 6763, "num_env_steps_sampled_throughput_per_sec": 208.63696674723064, "num_env_steps_trained_throughput_per_sec": 208.63696674723064, "timesteps_total": 31668, "num_steps_trained_this_iter": 6763, "agent_timesteps_total": 31668, "timers": {"training_iteration_time_ms": 30668.088, "sample_time_ms": 24027.919, "load_time_ms": 1033.472, "load_throughput": 6128.467, "learn_time_ms": 5141.156, "learn_throughput": 1231.941, "synch_weights_time_ms": 415.057}, "counters": {"num_env_steps_sampled": 31668, "num_env_steps_trained": 31668, "num_agent_steps_sampled": 31668, "num_agent_steps_trained": 31668}, "done": false, "episodes_total": 70, "training_iteration": 5, "trial_id": "32ccc_00000", "date": "2025-06-07_12-03-47", "timestamp": 1749290627, "time_this_iter_s": 32.42950677871704, "time_total_s": 153.42164516448975, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 153.42164516448975, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 54.87435897435897, "ram_util_percent": 71.9641025641026, "gpu_util_percent0": 0.05102564102564103, "vram_util_percent0": 0.71044921875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.25, "cur_lr": 9.968331999999997e-05, "total_loss": -0.16338308779522775, "policy_loss": -0.055930676402446505, "vf_loss": 0.10983993404855331, "vf_explained_var": 0.8938422804077466, "kl": 0.007712953595409999, "entropy": 14.462259217103322, "entropy_coeff": 0.00984166}, "model": {}, "num_grad_updates_lifetime": 1220.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 38619, "num_env_steps_trained": 38619, "num_agent_steps_sampled": 38619, "num_agent_steps_trained": 38619}, "sampler_results": {"episode_reward_max": 31.81321962263502, "episode_reward_min": -65.40042692782038, "episode_reward_mean": -9.976976906082669, "episode_len_mean": 459.75, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.40042692782038, -22.363844992556725, -39.67474470997841, -30.714078330738563, -21.63603545508221, -28.37716980082248, -26.668957578083063, -19.258097190037464, -20.705981960282468, -41.021661098853464, -46.83628407835066, -55.21072300202043, -26.418044431257236, -47.61994097465763, 15.936835352241701, -2.1702503369098296, -2.8880819974787366, -19.66831915013725, -7.941646672485021, -1.3642967545251494, -52.09552407213531, -36.54750208365535, -0.633896789164214, -34.78884807008794, -24.689187647038032, 10.007778715512089, -12.01254727170572, -3.654873497776111, 1.6732252017983833, -36.366970342576195, -1.5201646127893547, -26.260299430169933, -1.3735788683399477, 3.4457193454103567, -23.96872960323088, -14.607439816748434, -26.623545178497483, 23.8030513385187, -3.3342687776948288, -2.7628861642589797, -24.910606371333774, 4.379903308154179, -41.18468998249631, 2.593656449735272, 0.4884257439052494, 13.893608638292973, -14.180751420227892, -23.929680159223032, 17.927360750426946, 6.532702574278514, 10.958171380855976, 10.966567614133895, 10.427877658767, 12.986082002685453, -16.336889522990635, 10.008983120855573, 26.292218688725306, -12.560840179741998, 3.1492325078675574, 6.549258727157416, -28.08106270160294, 18.573629628705405, 10.027611869332063, 15.072332626001387, -22.532755346576575, 14.132015857715881, -24.21889107775263, 10.228674325537304, -25.68661413162303, -25.31350490712293, 12.200512493322588, -12.787120538593602, -10.625213487507223, -10.499285873933637, 11.370210322474806, -6.38260963127589, -33.05732701579037, 11.617041932620474, 9.854064463961956, -18.603167357797243, -4.987201272645419, 31.81321962263502, 16.893614323461986, -8.812588049854746], "episode_lengths": [419, 241, 305, 297, 259, 1117, 281, 269, 288, 324, 350, 439, 295, 375, 259, 259, 295, 406, 296, 339, 587, 453, 295, 567, 411, 328, 950, 373, 233, 915, 796, 440, 212, 273, 653, 408, 273, 259, 408, 849, 778, 373, 439, 326, 1090, 259, 751, 984, 244, 168, 183, 296, 269, 1117, 567, 265, 1117, 953, 269, 269, 397, 259, 295, 299, 439, 229, 411, 338, 825, 663, 278, 873, 790, 872, 298, 373, 530, 297, 165, 420, 370, 1117, 295, 273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.298349480188869, "mean_inference_ms": 6.929221357934964, "mean_action_processing_ms": 0.4794221929032611, "mean_env_wait_ms": 21.809579939754396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02627684956505185, "StateBufferConnector_ms": 0.02168871107555571, "ViewRequirementAgentConnector_ms": 0.748698768161592}}, "episode_reward_max": 31.81321962263502, "episode_reward_min": -65.40042692782038, "episode_reward_mean": -9.976976906082669, "episode_len_mean": 459.75, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-65.40042692782038, -22.363844992556725, -39.67474470997841, -30.714078330738563, -21.63603545508221, -28.37716980082248, -26.668957578083063, -19.258097190037464, -20.705981960282468, -41.021661098853464, -46.83628407835066, -55.21072300202043, -26.418044431257236, -47.61994097465763, 15.936835352241701, -2.1702503369098296, -2.8880819974787366, -19.66831915013725, -7.941646672485021, -1.3642967545251494, -52.09552407213531, -36.54750208365535, -0.633896789164214, -34.78884807008794, -24.689187647038032, 10.007778715512089, -12.01254727170572, -3.654873497776111, 1.6732252017983833, -36.366970342576195, -1.5201646127893547, -26.260299430169933, -1.3735788683399477, 3.4457193454103567, -23.96872960323088, -14.607439816748434, -26.623545178497483, 23.8030513385187, -3.3342687776948288, -2.7628861642589797, -24.910606371333774, 4.379903308154179, -41.18468998249631, 2.593656449735272, 0.4884257439052494, 13.893608638292973, -14.180751420227892, -23.929680159223032, 17.927360750426946, 6.532702574278514, 10.958171380855976, 10.966567614133895, 10.427877658767, 12.986082002685453, -16.336889522990635, 10.008983120855573, 26.292218688725306, -12.560840179741998, 3.1492325078675574, 6.549258727157416, -28.08106270160294, 18.573629628705405, 10.027611869332063, 15.072332626001387, -22.532755346576575, 14.132015857715881, -24.21889107775263, 10.228674325537304, -25.68661413162303, -25.31350490712293, 12.200512493322588, -12.787120538593602, -10.625213487507223, -10.499285873933637, 11.370210322474806, -6.38260963127589, -33.05732701579037, 11.617041932620474, 9.854064463961956, -18.603167357797243, -4.987201272645419, 31.81321962263502, 16.893614323461986, -8.812588049854746], "episode_lengths": [419, 241, 305, 297, 259, 1117, 281, 269, 288, 324, 350, 439, 295, 375, 259, 259, 295, 406, 296, 339, 587, 453, 295, 567, 411, 328, 950, 373, 233, 915, 796, 440, 212, 273, 653, 408, 273, 259, 408, 849, 778, 373, 439, 326, 1090, 259, 751, 984, 244, 168, 183, 296, 269, 1117, 567, 265, 1117, 953, 269, 269, 397, 259, 295, 299, 439, 229, 411, 338, 825, 663, 278, 873, 790, 872, 298, 373, 530, 297, 165, 420, 370, 1117, 295, 273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.298349480188869, "mean_inference_ms": 6.929221357934964, "mean_action_processing_ms": 0.4794221929032611, "mean_env_wait_ms": 21.809579939754396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02627684956505185, "StateBufferConnector_ms": 0.02168871107555571, "ViewRequirementAgentConnector_ms": 0.748698768161592}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38619, "num_agent_steps_trained": 38619, "num_env_steps_sampled": 38619, "num_env_steps_trained": 38619, "num_env_steps_sampled_this_iter": 6951, "num_env_steps_trained_this_iter": 6951, "num_env_steps_sampled_throughput_per_sec": 207.31187940169477, "num_env_steps_trained_throughput_per_sec": 207.31187940169477, "timesteps_total": 38619, "num_steps_trained_this_iter": 6951, "agent_timesteps_total": 38619, "timers": {"training_iteration_time_ms": 31144.939, "sample_time_ms": 24449.096, "load_time_ms": 1011.476, "load_throughput": 6363.474, "learn_time_ms": 5217.728, "learn_throughput": 1233.583, "synch_weights_time_ms": 416.271}, "counters": {"num_env_steps_sampled": 38619, "num_env_steps_trained": 38619, "num_agent_steps_sampled": 38619, "num_agent_steps_trained": 38619}, "done": false, "episodes_total": 84, "training_iteration": 6, "trial_id": "32ccc_00000", "date": "2025-06-07_12-04-21", "timestamp": 1749290661, "time_this_iter_s": 33.54566407203674, "time_total_s": 186.9673092365265, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 186.9673092365265, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 56.45250000000001, "ram_util_percent": 70.095, "gpu_util_percent0": 0.05750000000000001, "vram_util_percent0": 0.71044921875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.25, "cur_lr": 9.961381e-05, "total_loss": -0.13473652573022993, "policy_loss": -0.026885461260098963, "vf_loss": 0.10574700444191694, "vf_explained_var": 0.8992710978984833, "kl": 0.009332349534437526, "entropy": 14.470238719940186, "entropy_coeff": 0.009806905000000001}, "model": {}, "num_grad_updates_lifetime": 1465.5, "diff_num_grad_updates_vs_sampler_policy": 124.5}}, "num_env_steps_sampled": 45808, "num_env_steps_trained": 45808, "num_agent_steps_sampled": 45808, "num_agent_steps_trained": 45808}, "sampler_results": {"episode_reward_max": 39.74101853562374, "episode_reward_min": -65.40042692782038, "episode_reward_mean": -8.196546378862587, "episode_len_mean": 467.42857142857144, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.40042692782038, -22.363844992556725, -39.67474470997841, -30.714078330738563, -21.63603545508221, -28.37716980082248, -26.668957578083063, -19.258097190037464, -20.705981960282468, -41.021661098853464, -46.83628407835066, -55.21072300202043, -26.418044431257236, -47.61994097465763, 15.936835352241701, -2.1702503369098296, -2.8880819974787366, -19.66831915013725, -7.941646672485021, -1.3642967545251494, -52.09552407213531, -36.54750208365535, -0.633896789164214, -34.78884807008794, -24.689187647038032, 10.007778715512089, -12.01254727170572, -3.654873497776111, 1.6732252017983833, -36.366970342576195, -1.5201646127893547, -26.260299430169933, -1.3735788683399477, 3.4457193454103567, -23.96872960323088, -14.607439816748434, -26.623545178497483, 23.8030513385187, -3.3342687776948288, -2.7628861642589797, -24.910606371333774, 4.379903308154179, -41.18468998249631, 2.593656449735272, 0.4884257439052494, 13.893608638292973, -14.180751420227892, -23.929680159223032, 17.927360750426946, 6.532702574278514, 10.958171380855976, 10.966567614133895, 10.427877658767, 12.986082002685453, -16.336889522990635, 10.008983120855573, 26.292218688725306, -12.560840179741998, 3.1492325078675574, 6.549258727157416, -28.08106270160294, 18.573629628705405, 10.027611869332063, 15.072332626001387, -22.532755346576575, 14.132015857715881, -24.21889107775263, 10.228674325537304, -25.68661413162303, -25.31350490712293, 12.200512493322588, -12.787120538593602, -10.625213487507223, -10.499285873933637, 11.370210322474806, -6.38260963127589, -33.05732701579037, 11.617041932620474, 9.854064463961956, -18.603167357797243, -4.987201272645419, 31.81321962263502, 16.893614323461986, -8.812588049854746, 14.966517485322617, 9.202658119768138, 10.530553842170725, 4.472591709840547, -41.92568826349812, 2.884413499203571, 19.162109681824308, 4.396303357476661, -13.210579751203891, -3.6250706893646476, -18.10259218983403, -3.33080791438316, 39.74101853562374, 9.643087559464352], "episode_lengths": [419, 241, 305, 297, 259, 1117, 281, 269, 288, 324, 350, 439, 295, 375, 259, 259, 295, 406, 296, 339, 587, 453, 295, 567, 411, 328, 950, 373, 233, 915, 796, 440, 212, 273, 653, 408, 273, 259, 408, 849, 778, 373, 439, 326, 1090, 259, 751, 984, 244, 168, 183, 296, 269, 1117, 567, 265, 1117, 953, 269, 269, 397, 259, 295, 299, 439, 229, 411, 338, 825, 663, 278, 873, 790, 872, 298, 373, 530, 297, 165, 420, 370, 1117, 295, 273, 230, 163, 269, 1117, 907, 342, 269, 295, 406, 664, 754, 406, 1117, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2676039519293965, "mean_inference_ms": 6.893193296024525, "mean_action_processing_ms": 0.47600908944091813, "mean_env_wait_ms": 21.592035558234283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029730796813964844, "StateBufferConnector_ms": 0.02373408298103177, "ViewRequirementAgentConnector_ms": 0.7610622717409717}}, "episode_reward_max": 39.74101853562374, "episode_reward_min": -65.40042692782038, "episode_reward_mean": -8.196546378862587, "episode_len_mean": 467.42857142857144, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-65.40042692782038, -22.363844992556725, -39.67474470997841, -30.714078330738563, -21.63603545508221, -28.37716980082248, -26.668957578083063, -19.258097190037464, -20.705981960282468, -41.021661098853464, -46.83628407835066, -55.21072300202043, -26.418044431257236, -47.61994097465763, 15.936835352241701, -2.1702503369098296, -2.8880819974787366, -19.66831915013725, -7.941646672485021, -1.3642967545251494, -52.09552407213531, -36.54750208365535, -0.633896789164214, -34.78884807008794, -24.689187647038032, 10.007778715512089, -12.01254727170572, -3.654873497776111, 1.6732252017983833, -36.366970342576195, -1.5201646127893547, -26.260299430169933, -1.3735788683399477, 3.4457193454103567, -23.96872960323088, -14.607439816748434, -26.623545178497483, 23.8030513385187, -3.3342687776948288, -2.7628861642589797, -24.910606371333774, 4.379903308154179, -41.18468998249631, 2.593656449735272, 0.4884257439052494, 13.893608638292973, -14.180751420227892, -23.929680159223032, 17.927360750426946, 6.532702574278514, 10.958171380855976, 10.966567614133895, 10.427877658767, 12.986082002685453, -16.336889522990635, 10.008983120855573, 26.292218688725306, -12.560840179741998, 3.1492325078675574, 6.549258727157416, -28.08106270160294, 18.573629628705405, 10.027611869332063, 15.072332626001387, -22.532755346576575, 14.132015857715881, -24.21889107775263, 10.228674325537304, -25.68661413162303, -25.31350490712293, 12.200512493322588, -12.787120538593602, -10.625213487507223, -10.499285873933637, 11.370210322474806, -6.38260963127589, -33.05732701579037, 11.617041932620474, 9.854064463961956, -18.603167357797243, -4.987201272645419, 31.81321962263502, 16.893614323461986, -8.812588049854746, 14.966517485322617, 9.202658119768138, 10.530553842170725, 4.472591709840547, -41.92568826349812, 2.884413499203571, 19.162109681824308, 4.396303357476661, -13.210579751203891, -3.6250706893646476, -18.10259218983403, -3.33080791438316, 39.74101853562374, 9.643087559464352], "episode_lengths": [419, 241, 305, 297, 259, 1117, 281, 269, 288, 324, 350, 439, 295, 375, 259, 259, 295, 406, 296, 339, 587, 453, 295, 567, 411, 328, 950, 373, 233, 915, 796, 440, 212, 273, 653, 408, 273, 259, 408, 849, 778, 373, 439, 326, 1090, 259, 751, 984, 244, 168, 183, 296, 269, 1117, 567, 265, 1117, 953, 269, 269, 397, 259, 295, 299, 439, 229, 411, 338, 825, 663, 278, 873, 790, 872, 298, 373, 530, 297, 165, 420, 370, 1117, 295, 273, 230, 163, 269, 1117, 907, 342, 269, 295, 406, 664, 754, 406, 1117, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2676039519293965, "mean_inference_ms": 6.893193296024525, "mean_action_processing_ms": 0.47600908944091813, "mean_env_wait_ms": 21.592035558234283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029730796813964844, "StateBufferConnector_ms": 0.02373408298103177, "ViewRequirementAgentConnector_ms": 0.7610622717409717}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45808, "num_agent_steps_trained": 45808, "num_env_steps_sampled": 45808, "num_env_steps_trained": 45808, "num_env_steps_sampled_this_iter": 7189, "num_env_steps_trained_this_iter": 7189, "num_env_steps_sampled_throughput_per_sec": 216.34007383580388, "num_env_steps_trained_throughput_per_sec": 216.34007383580388, "timesteps_total": 45808, "num_steps_trained_this_iter": 7189, "agent_timesteps_total": 45808, "timers": {"training_iteration_time_ms": 31442.818, "sample_time_ms": 24671.878, "load_time_ms": 1004.382, "load_throughput": 6515.451, "learn_time_ms": 5298.404, "learn_throughput": 1235.089, "synch_weights_time_ms": 418.15}, "counters": {"num_env_steps_sampled": 45808, "num_env_steps_trained": 45808, "num_agent_steps_sampled": 45808, "num_agent_steps_trained": 45808}, "done": false, "episodes_total": 98, "training_iteration": 7, "trial_id": "32ccc_00000", "date": "2025-06-07_12-04-54", "timestamp": 1749290694, "time_this_iter_s": 33.2458119392395, "time_total_s": 220.213121175766, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 220.213121175766, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 54.4175, "ram_util_percent": 68.79249999999999, "gpu_util_percent0": 0.053500000000000006, "vram_util_percent0": 0.751953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.25, "cur_lr": 9.954192000000002e-05, "total_loss": -0.13198969385453632, "policy_loss": -0.02346003491963659, "vf_loss": 0.10350763941893265, "vf_explained_var": 0.9124666137354714, "kl": 0.007198566639619033, "entropy": 14.469571163540795, "entropy_coeff": 0.009770959999999999}, "model": {}, "num_grad_updates_lifetime": 1695.5, "diff_num_grad_updates_vs_sampler_policy": 104.5}}, "num_env_steps_sampled": 51706, "num_env_steps_trained": 51706, "num_agent_steps_sampled": 51706, "num_agent_steps_trained": 51706}, "sampler_results": {"episode_reward_max": 39.74101853562374, "episode_reward_min": -52.09552407213531, "episode_reward_mean": -3.3347431244723045, "episode_len_mean": 471.17, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.418044431257236, -47.61994097465763, 15.936835352241701, -2.1702503369098296, -2.8880819974787366, -19.66831915013725, -7.941646672485021, -1.3642967545251494, -52.09552407213531, -36.54750208365535, -0.633896789164214, -34.78884807008794, -24.689187647038032, 10.007778715512089, -12.01254727170572, -3.654873497776111, 1.6732252017983833, -36.366970342576195, -1.5201646127893547, -26.260299430169933, -1.3735788683399477, 3.4457193454103567, -23.96872960323088, -14.607439816748434, -26.623545178497483, 23.8030513385187, -3.3342687776948288, -2.7628861642589797, -24.910606371333774, 4.379903308154179, -41.18468998249631, 2.593656449735272, 0.4884257439052494, 13.893608638292973, -14.180751420227892, -23.929680159223032, 17.927360750426946, 6.532702574278514, 10.958171380855976, 10.966567614133895, 10.427877658767, 12.986082002685453, -16.336889522990635, 10.008983120855573, 26.292218688725306, -12.560840179741998, 3.1492325078675574, 6.549258727157416, -28.08106270160294, 18.573629628705405, 10.027611869332063, 15.072332626001387, -22.532755346576575, 14.132015857715881, -24.21889107775263, 10.228674325537304, -25.68661413162303, -25.31350490712293, 12.200512493322588, -12.787120538593602, -10.625213487507223, -10.499285873933637, 11.370210322474806, -6.38260963127589, -33.05732701579037, 11.617041932620474, 9.854064463961956, -18.603167357797243, -4.987201272645419, 31.81321962263502, 16.893614323461986, -8.812588049854746, 14.966517485322617, 9.202658119768138, 10.530553842170725, 4.472591709840547, -41.92568826349812, 2.884413499203571, 19.162109681824308, 4.396303357476661, -13.210579751203891, -3.6250706893646476, -18.10259218983403, -3.33080791438316, 39.74101853562374, 9.643087559464352, -21.504486395148202, 11.288467006507636, 3.545080622119256, -29.545950995484755, 6.715149164648961, 8.379243808990308, 31.46310658010655, -0.2259359495471741, 0.8863012876348093, -14.25018866527674, 11.019450755307172, 16.260094626964673, 10.373891836531387, 17.515003873322904], "episode_lengths": [295, 375, 259, 259, 295, 406, 296, 339, 587, 453, 295, 567, 411, 328, 950, 373, 233, 915, 796, 440, 212, 273, 653, 408, 273, 259, 408, 849, 778, 373, 439, 326, 1090, 259, 751, 984, 244, 168, 183, 296, 269, 1117, 567, 265, 1117, 953, 269, 269, 397, 259, 295, 299, 439, 229, 411, 338, 825, 663, 278, 873, 790, 872, 298, 373, 530, 297, 165, 420, 370, 1117, 295, 273, 230, 163, 269, 1117, 907, 342, 269, 295, 406, 664, 754, 406, 1117, 250, 653, 259, 299, 439, 299, 244, 1068, 409, 391, 686, 295, 259, 302, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.191711485926403, "mean_inference_ms": 6.81255127328604, "mean_action_processing_ms": 0.46839275954239473, "mean_env_wait_ms": 21.051363234434938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030156373977661133, "StateBufferConnector_ms": 0.025295019149780273, "ViewRequirementAgentConnector_ms": 0.7408239841461182}}, "episode_reward_max": 39.74101853562374, "episode_reward_min": -52.09552407213531, "episode_reward_mean": -3.3347431244723045, "episode_len_mean": 471.17, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26.418044431257236, -47.61994097465763, 15.936835352241701, -2.1702503369098296, -2.8880819974787366, -19.66831915013725, -7.941646672485021, -1.3642967545251494, -52.09552407213531, -36.54750208365535, -0.633896789164214, -34.78884807008794, -24.689187647038032, 10.007778715512089, -12.01254727170572, -3.654873497776111, 1.6732252017983833, -36.366970342576195, -1.5201646127893547, -26.260299430169933, -1.3735788683399477, 3.4457193454103567, -23.96872960323088, -14.607439816748434, -26.623545178497483, 23.8030513385187, -3.3342687776948288, -2.7628861642589797, -24.910606371333774, 4.379903308154179, -41.18468998249631, 2.593656449735272, 0.4884257439052494, 13.893608638292973, -14.180751420227892, -23.929680159223032, 17.927360750426946, 6.532702574278514, 10.958171380855976, 10.966567614133895, 10.427877658767, 12.986082002685453, -16.336889522990635, 10.008983120855573, 26.292218688725306, -12.560840179741998, 3.1492325078675574, 6.549258727157416, -28.08106270160294, 18.573629628705405, 10.027611869332063, 15.072332626001387, -22.532755346576575, 14.132015857715881, -24.21889107775263, 10.228674325537304, -25.68661413162303, -25.31350490712293, 12.200512493322588, -12.787120538593602, -10.625213487507223, -10.499285873933637, 11.370210322474806, -6.38260963127589, -33.05732701579037, 11.617041932620474, 9.854064463961956, -18.603167357797243, -4.987201272645419, 31.81321962263502, 16.893614323461986, -8.812588049854746, 14.966517485322617, 9.202658119768138, 10.530553842170725, 4.472591709840547, -41.92568826349812, 2.884413499203571, 19.162109681824308, 4.396303357476661, -13.210579751203891, -3.6250706893646476, -18.10259218983403, -3.33080791438316, 39.74101853562374, 9.643087559464352, -21.504486395148202, 11.288467006507636, 3.545080622119256, -29.545950995484755, 6.715149164648961, 8.379243808990308, 31.46310658010655, -0.2259359495471741, 0.8863012876348093, -14.25018866527674, 11.019450755307172, 16.260094626964673, 10.373891836531387, 17.515003873322904], "episode_lengths": [295, 375, 259, 259, 295, 406, 296, 339, 587, 453, 295, 567, 411, 328, 950, 373, 233, 915, 796, 440, 212, 273, 653, 408, 273, 259, 408, 849, 778, 373, 439, 326, 1090, 259, 751, 984, 244, 168, 183, 296, 269, 1117, 567, 265, 1117, 953, 269, 269, 397, 259, 295, 299, 439, 229, 411, 338, 825, 663, 278, 873, 790, 872, 298, 373, 530, 297, 165, 420, 370, 1117, 295, 273, 230, 163, 269, 1117, 907, 342, 269, 295, 406, 664, 754, 406, 1117, 250, 653, 259, 299, 439, 299, 244, 1068, 409, 391, 686, 295, 259, 302, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.191711485926403, "mean_inference_ms": 6.81255127328604, "mean_action_processing_ms": 0.46839275954239473, "mean_env_wait_ms": 21.051363234434938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030156373977661133, "StateBufferConnector_ms": 0.025295019149780273, "ViewRequirementAgentConnector_ms": 0.7408239841461182}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51706, "num_agent_steps_trained": 51706, "num_env_steps_sampled": 51706, "num_env_steps_trained": 51706, "num_env_steps_sampled_this_iter": 5898, "num_env_steps_trained_this_iter": 5898, "num_env_steps_sampled_throughput_per_sec": 196.3825184569205, "num_env_steps_trained_throughput_per_sec": 196.3825184569205, "timesteps_total": 51706, "num_steps_trained_this_iter": 5898, "agent_timesteps_total": 51706, "timers": {"training_iteration_time_ms": 31266.618, "sample_time_ms": 24566.815, "load_time_ms": 975.869, "load_throughput": 6623.072, "learn_time_ms": 5259.611, "learn_throughput": 1228.846, "synch_weights_time_ms": 415.365}, "counters": {"num_env_steps_sampled": 51706, "num_env_steps_trained": 51706, "num_agent_steps_sampled": 51706, "num_agent_steps_trained": 51706}, "done": false, "episodes_total": 112, "training_iteration": 8, "trial_id": "32ccc_00000", "date": "2025-06-07_12-05-24", "timestamp": 1749290724, "time_this_iter_s": 30.04361319541931, "time_total_s": 250.2567343711853, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 250.2567343711853, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 52.17499999999999, "ram_util_percent": 68.3361111111111, "gpu_util_percent0": 0.053888888888888896, "vram_util_percent0": 0.90576171875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.948294000000003e-05, "total_loss": -0.1270936054676505, "policy_loss": -0.02390626778027841, "vf_loss": 0.12554578100264605, "vf_explained_var": 0.9204516014882497, "kl": 0.008938604380195362, "entropy": 14.573611882754735, "entropy_coeff": 0.009741470000000002}, "model": {}, "num_grad_updates_lifetime": 1940.5, "diff_num_grad_updates_vs_sampler_policy": 139.5}}, "num_env_steps_sampled": 59785, "num_env_steps_trained": 59785, "num_agent_steps_sampled": 59785, "num_agent_steps_trained": 59785}, "sampler_results": {"episode_reward_max": 39.74101853562374, "episode_reward_min": -41.92568826349812, "episode_reward_mean": -1.8023561191270638, "episode_len_mean": 500.31, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.01254727170572, -3.654873497776111, 1.6732252017983833, -36.366970342576195, -1.5201646127893547, -26.260299430169933, -1.3735788683399477, 3.4457193454103567, -23.96872960323088, -14.607439816748434, -26.623545178497483, 23.8030513385187, -3.3342687776948288, -2.7628861642589797, -24.910606371333774, 4.379903308154179, -41.18468998249631, 2.593656449735272, 0.4884257439052494, 13.893608638292973, -14.180751420227892, -23.929680159223032, 17.927360750426946, 6.532702574278514, 10.958171380855976, 10.966567614133895, 10.427877658767, 12.986082002685453, -16.336889522990635, 10.008983120855573, 26.292218688725306, -12.560840179741998, 3.1492325078675574, 6.549258727157416, -28.08106270160294, 18.573629628705405, 10.027611869332063, 15.072332626001387, -22.532755346576575, 14.132015857715881, -24.21889107775263, 10.228674325537304, -25.68661413162303, -25.31350490712293, 12.200512493322588, -12.787120538593602, -10.625213487507223, -10.499285873933637, 11.370210322474806, -6.38260963127589, -33.05732701579037, 11.617041932620474, 9.854064463961956, -18.603167357797243, -4.987201272645419, 31.81321962263502, 16.893614323461986, -8.812588049854746, 14.966517485322617, 9.202658119768138, 10.530553842170725, 4.472591709840547, -41.92568826349812, 2.884413499203571, 19.162109681824308, 4.396303357476661, -13.210579751203891, -3.6250706893646476, -18.10259218983403, -3.33080791438316, 39.74101853562374, 9.643087559464352, -21.504486395148202, 11.288467006507636, 3.545080622119256, -29.545950995484755, 6.715149164648961, 8.379243808990308, 31.46310658010655, -0.2259359495471741, 0.8863012876348093, -14.25018866527674, 11.019450755307172, 16.260094626964673, 10.373891836531387, 17.515003873322904, 15.304686941387551, -11.187950214524337, 6.7775546314389405, -11.210396486601084, 9.31184276244931, -17.87140570641791, -10.205604584586055, -9.472294477596781, 10.804686260752423, -10.617444361737384, 17.48513326822518, -28.701166406104562, -21.723975633162482, -16.335890370776646], "episode_lengths": [950, 373, 233, 915, 796, 440, 212, 273, 653, 408, 273, 259, 408, 849, 778, 373, 439, 326, 1090, 259, 751, 984, 244, 168, 183, 296, 269, 1117, 567, 265, 1117, 953, 269, 269, 397, 259, 295, 299, 439, 229, 411, 338, 825, 663, 278, 873, 790, 872, 298, 373, 530, 297, 165, 420, 370, 1117, 295, 273, 230, 163, 269, 1117, 907, 342, 269, 295, 406, 664, 754, 406, 1117, 250, 653, 259, 299, 439, 299, 244, 1068, 409, 391, 686, 295, 259, 302, 295, 295, 362, 273, 1117, 373, 367, 743, 911, 298, 411, 1117, 517, 763, 532]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.127117957992254, "mean_inference_ms": 6.737200194624204, "mean_action_processing_ms": 0.4614701602671351, "mean_env_wait_ms": 20.632083514050834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030150890350341797, "StateBufferConnector_ms": 0.025211811065673828, "ViewRequirementAgentConnector_ms": 0.7223968505859375}}, "episode_reward_max": 39.74101853562374, "episode_reward_min": -41.92568826349812, "episode_reward_mean": -1.8023561191270638, "episode_len_mean": 500.31, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.01254727170572, -3.654873497776111, 1.6732252017983833, -36.366970342576195, -1.5201646127893547, -26.260299430169933, -1.3735788683399477, 3.4457193454103567, -23.96872960323088, -14.607439816748434, -26.623545178497483, 23.8030513385187, -3.3342687776948288, -2.7628861642589797, -24.910606371333774, 4.379903308154179, -41.18468998249631, 2.593656449735272, 0.4884257439052494, 13.893608638292973, -14.180751420227892, -23.929680159223032, 17.927360750426946, 6.532702574278514, 10.958171380855976, 10.966567614133895, 10.427877658767, 12.986082002685453, -16.336889522990635, 10.008983120855573, 26.292218688725306, -12.560840179741998, 3.1492325078675574, 6.549258727157416, -28.08106270160294, 18.573629628705405, 10.027611869332063, 15.072332626001387, -22.532755346576575, 14.132015857715881, -24.21889107775263, 10.228674325537304, -25.68661413162303, -25.31350490712293, 12.200512493322588, -12.787120538593602, -10.625213487507223, -10.499285873933637, 11.370210322474806, -6.38260963127589, -33.05732701579037, 11.617041932620474, 9.854064463961956, -18.603167357797243, -4.987201272645419, 31.81321962263502, 16.893614323461986, -8.812588049854746, 14.966517485322617, 9.202658119768138, 10.530553842170725, 4.472591709840547, -41.92568826349812, 2.884413499203571, 19.162109681824308, 4.396303357476661, -13.210579751203891, -3.6250706893646476, -18.10259218983403, -3.33080791438316, 39.74101853562374, 9.643087559464352, -21.504486395148202, 11.288467006507636, 3.545080622119256, -29.545950995484755, 6.715149164648961, 8.379243808990308, 31.46310658010655, -0.2259359495471741, 0.8863012876348093, -14.25018866527674, 11.019450755307172, 16.260094626964673, 10.373891836531387, 17.515003873322904, 15.304686941387551, -11.187950214524337, 6.7775546314389405, -11.210396486601084, 9.31184276244931, -17.87140570641791, -10.205604584586055, -9.472294477596781, 10.804686260752423, -10.617444361737384, 17.48513326822518, -28.701166406104562, -21.723975633162482, -16.335890370776646], "episode_lengths": [950, 373, 233, 915, 796, 440, 212, 273, 653, 408, 273, 259, 408, 849, 778, 373, 439, 326, 1090, 259, 751, 984, 244, 168, 183, 296, 269, 1117, 567, 265, 1117, 953, 269, 269, 397, 259, 295, 299, 439, 229, 411, 338, 825, 663, 278, 873, 790, 872, 298, 373, 530, 297, 165, 420, 370, 1117, 295, 273, 230, 163, 269, 1117, 907, 342, 269, 295, 406, 664, 754, 406, 1117, 250, 653, 259, 299, 439, 299, 244, 1068, 409, 391, 686, 295, 259, 302, 295, 295, 362, 273, 1117, 373, 367, 743, 911, 298, 411, 1117, 517, 763, 532]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.127117957992254, "mean_inference_ms": 6.737200194624204, "mean_action_processing_ms": 0.4614701602671351, "mean_env_wait_ms": 20.632083514050834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030150890350341797, "StateBufferConnector_ms": 0.025211811065673828, "ViewRequirementAgentConnector_ms": 0.7223968505859375}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59785, "num_agent_steps_trained": 59785, "num_env_steps_sampled": 59785, "num_env_steps_trained": 59785, "num_env_steps_sampled_this_iter": 8079, "num_env_steps_trained_this_iter": 8079, "num_env_steps_sampled_throughput_per_sec": 210.94658863505896, "num_env_steps_trained_throughput_per_sec": 210.94658863505896, "timesteps_total": 59785, "num_steps_trained_this_iter": 8079, "agent_timesteps_total": 59785, "timers": {"training_iteration_time_ms": 32047.971, "sample_time_ms": 24932.238, "load_time_ms": 1052.036, "load_throughput": 6314.212, "learn_time_ms": 5596.775, "learn_throughput": 1186.894, "synch_weights_time_ms": 418.081}, "counters": {"num_env_steps_sampled": 59785, "num_env_steps_trained": 59785, "num_agent_steps_sampled": 59785, "num_agent_steps_trained": 59785}, "done": false, "episodes_total": 126, "training_iteration": 9, "trial_id": "32ccc_00000", "date": "2025-06-07_12-06-03", "timestamp": 1749290763, "time_this_iter_s": 38.32263159751892, "time_total_s": 288.5793659687042, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 288.5793659687042, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 55.68695652173913, "ram_util_percent": 69.87391304347825, "gpu_util_percent0": 0.09739130434782607, "vram_util_percent0": 0.9234247622282609}}
{"evaluation": {"sampler_results": {"episode_reward_max": -0.9226331818162826, "episode_reward_min": -10.075541694416355, "episode_reward_mean": -3.9897401375701014, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.075541694416355, -5.017935965956774, -2.2509676753947514, -1.6816221702663456, -0.9226331818162826], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6811341856253397, "mean_inference_ms": 3.6306886020623126, "mean_action_processing_ms": 0.23957546577909222, "mean_env_wait_ms": 10.507628920282786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.019927024841308594, "ViewRequirementAgentConnector_ms": 0.2805519104003906}}, "episode_reward_max": -0.9226331818162826, "episode_reward_min": -10.075541694416355, "episode_reward_mean": -3.9897401375701014, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.075541694416355, -5.017935965956774, -2.2509676753947514, -1.6816221702663456, -0.9226331818162826], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6811341856253397, "mean_inference_ms": 3.6306886020623126, "mean_action_processing_ms": 0.23957546577909222, "mean_env_wait_ms": 10.507628920282786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.019927024841308594, "ViewRequirementAgentConnector_ms": 0.2805519104003906}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.940215e-05, "total_loss": -0.11735983631751012, "policy_loss": -0.003485970216847601, "vf_loss": 0.0905796554516114, "vf_explained_var": 0.9414411516416641, "kl": 0.00918818013756425, "entropy": 14.657786946069626, "entropy_coeff": 0.009701075}, "model": {}, "num_grad_updates_lifetime": 2185.5, "diff_num_grad_updates_vs_sampler_policy": 104.5}}, "num_env_steps_sampled": 65924, "num_env_steps_trained": 65924, "num_agent_steps_sampled": 65924, "num_agent_steps_trained": 65924}, "sampler_results": {"episode_reward_max": 39.74101853562374, "episode_reward_min": -41.92568826349812, "episode_reward_mean": 0.652492747190948, "episode_len_mean": 483.5, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.379903308154179, -41.18468998249631, 2.593656449735272, 0.4884257439052494, 13.893608638292973, -14.180751420227892, -23.929680159223032, 17.927360750426946, 6.532702574278514, 10.958171380855976, 10.966567614133895, 10.427877658767, 12.986082002685453, -16.336889522990635, 10.008983120855573, 26.292218688725306, -12.560840179741998, 3.1492325078675574, 6.549258727157416, -28.08106270160294, 18.573629628705405, 10.027611869332063, 15.072332626001387, -22.532755346576575, 14.132015857715881, -24.21889107775263, 10.228674325537304, -25.68661413162303, -25.31350490712293, 12.200512493322588, -12.787120538593602, -10.625213487507223, -10.499285873933637, 11.370210322474806, -6.38260963127589, -33.05732701579037, 11.617041932620474, 9.854064463961956, -18.603167357797243, -4.987201272645419, 31.81321962263502, 16.893614323461986, -8.812588049854746, 14.966517485322617, 9.202658119768138, 10.530553842170725, 4.472591709840547, -41.92568826349812, 2.884413499203571, 19.162109681824308, 4.396303357476661, -13.210579751203891, -3.6250706893646476, -18.10259218983403, -3.33080791438316, 39.74101853562374, 9.643087559464352, -21.504486395148202, 11.288467006507636, 3.545080622119256, -29.545950995484755, 6.715149164648961, 8.379243808990308, 31.46310658010655, -0.2259359495471741, 0.8863012876348093, -14.25018866527674, 11.019450755307172, 16.260094626964673, 10.373891836531387, 17.515003873322904, 15.304686941387551, -11.187950214524337, 6.7775546314389405, -11.210396486601084, 9.31184276244931, -17.87140570641791, -10.205604584586055, -9.472294477596781, 10.804686260752423, -10.617444361737384, 17.48513326822518, -28.701166406104562, -21.723975633162482, -16.335890370776646, 4.335048573006972, 20.175518691053387, 9.240045379983002, -7.991370150725665, 11.547924235470695, -13.536833866592321, 20.512482518951803, -3.5582040558278534, 5.668777609483988, 0.4122541805948017, -10.125360925251302, 9.833759452396487, 14.889586497781892, 23.26513053823423, 12.342213903846833], "episode_lengths": [373, 439, 326, 1090, 259, 751, 984, 244, 168, 183, 296, 269, 1117, 567, 265, 1117, 953, 269, 269, 397, 259, 295, 299, 439, 229, 411, 338, 825, 663, 278, 873, 790, 872, 298, 373, 530, 297, 165, 420, 370, 1117, 295, 273, 230, 163, 269, 1117, 907, 342, 269, 295, 406, 664, 754, 406, 1117, 250, 653, 259, 299, 439, 299, 244, 1068, 409, 391, 686, 295, 259, 302, 295, 295, 362, 273, 1117, 373, 367, 743, 911, 298, 411, 1117, 517, 763, 532, 348, 247, 1117, 467, 272, 373, 256, 604, 324, 439, 764, 91, 286, 295, 256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1004540615023224, "mean_inference_ms": 6.7127625191921485, "mean_action_processing_ms": 0.45813247544991265, "mean_env_wait_ms": 20.463014020165957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026156187057495117, "StateBufferConnector_ms": 0.032251834869384766, "ViewRequirementAgentConnector_ms": 0.7277271747589111}}, "episode_reward_max": 39.74101853562374, "episode_reward_min": -41.92568826349812, "episode_reward_mean": 0.652492747190948, "episode_len_mean": 483.5, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.379903308154179, -41.18468998249631, 2.593656449735272, 0.4884257439052494, 13.893608638292973, -14.180751420227892, -23.929680159223032, 17.927360750426946, 6.532702574278514, 10.958171380855976, 10.966567614133895, 10.427877658767, 12.986082002685453, -16.336889522990635, 10.008983120855573, 26.292218688725306, -12.560840179741998, 3.1492325078675574, 6.549258727157416, -28.08106270160294, 18.573629628705405, 10.027611869332063, 15.072332626001387, -22.532755346576575, 14.132015857715881, -24.21889107775263, 10.228674325537304, -25.68661413162303, -25.31350490712293, 12.200512493322588, -12.787120538593602, -10.625213487507223, -10.499285873933637, 11.370210322474806, -6.38260963127589, -33.05732701579037, 11.617041932620474, 9.854064463961956, -18.603167357797243, -4.987201272645419, 31.81321962263502, 16.893614323461986, -8.812588049854746, 14.966517485322617, 9.202658119768138, 10.530553842170725, 4.472591709840547, -41.92568826349812, 2.884413499203571, 19.162109681824308, 4.396303357476661, -13.210579751203891, -3.6250706893646476, -18.10259218983403, -3.33080791438316, 39.74101853562374, 9.643087559464352, -21.504486395148202, 11.288467006507636, 3.545080622119256, -29.545950995484755, 6.715149164648961, 8.379243808990308, 31.46310658010655, -0.2259359495471741, 0.8863012876348093, -14.25018866527674, 11.019450755307172, 16.260094626964673, 10.373891836531387, 17.515003873322904, 15.304686941387551, -11.187950214524337, 6.7775546314389405, -11.210396486601084, 9.31184276244931, -17.87140570641791, -10.205604584586055, -9.472294477596781, 10.804686260752423, -10.617444361737384, 17.48513326822518, -28.701166406104562, -21.723975633162482, -16.335890370776646, 4.335048573006972, 20.175518691053387, 9.240045379983002, -7.991370150725665, 11.547924235470695, -13.536833866592321, 20.512482518951803, -3.5582040558278534, 5.668777609483988, 0.4122541805948017, -10.125360925251302, 9.833759452396487, 14.889586497781892, 23.26513053823423, 12.342213903846833], "episode_lengths": [373, 439, 326, 1090, 259, 751, 984, 244, 168, 183, 296, 269, 1117, 567, 265, 1117, 953, 269, 269, 397, 259, 295, 299, 439, 229, 411, 338, 825, 663, 278, 873, 790, 872, 298, 373, 530, 297, 165, 420, 370, 1117, 295, 273, 230, 163, 269, 1117, 907, 342, 269, 295, 406, 664, 754, 406, 1117, 250, 653, 259, 299, 439, 299, 244, 1068, 409, 391, 686, 295, 259, 302, 295, 295, 362, 273, 1117, 373, 367, 743, 911, 298, 411, 1117, 517, 763, 532, 348, 247, 1117, 467, 272, 373, 256, 604, 324, 439, 764, 91, 286, 295, 256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1004540615023224, "mean_inference_ms": 6.7127625191921485, "mean_action_processing_ms": 0.45813247544991265, "mean_env_wait_ms": 20.463014020165957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026156187057495117, "StateBufferConnector_ms": 0.032251834869384766, "ViewRequirementAgentConnector_ms": 0.7277271747589111}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65924, "num_agent_steps_trained": 65924, "num_env_steps_sampled": 65924, "num_env_steps_trained": 65924, "num_env_steps_sampled_this_iter": 6139, "num_env_steps_trained_this_iter": 6139, "num_env_steps_sampled_throughput_per_sec": 198.62200415065533, "num_env_steps_trained_throughput_per_sec": 198.62200415065533, "timesteps_total": 65924, "num_steps_trained_this_iter": 6139, "agent_timesteps_total": 65924, "timers": {"training_iteration_time_ms": 31933.97, "sample_time_ms": 24923.465, "load_time_ms": 1015.993, "load_throughput": 6488.626, "learn_time_ms": 5526.73, "learn_throughput": 1192.821, "synch_weights_time_ms": 418.423}, "counters": {"num_env_steps_sampled": 65924, "num_env_steps_trained": 65924, "num_agent_steps_sampled": 65924, "num_agent_steps_trained": 65924}, "done": false, "episodes_total": 141, "training_iteration": 10, "trial_id": "32ccc_00000", "date": "2025-06-07_12-06-49", "timestamp": 1749290809, "time_this_iter_s": 45.83780360221863, "time_total_s": 334.41716957092285, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 334.41716957092285, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 41.205357142857146, "ram_util_percent": 71.10357142857143, "gpu_util_percent0": 0.04214285714285715, "vram_util_percent0": 0.96826171875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.934076000000005e-05, "total_loss": -0.14466881263069808, "policy_loss": -0.03826189014022627, "vf_loss": 0.1205574026874577, "vf_explained_var": 0.9417634797592958, "kl": 0.009595265779231947, "entropy": 14.867416286468506, "entropy_coeff": 0.009670380000000003}, "model": {}, "num_grad_updates_lifetime": 2410.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 72823, "num_env_steps_trained": 72823, "num_agent_steps_sampled": 72823, "num_agent_steps_trained": 72823}, "sampler_results": {"episode_reward_max": 39.74101853562374, "episode_reward_min": -46.91744389823901, "episode_reward_mean": -1.3839915924800186, "episode_len_mean": 481.83, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.008983120855573, 26.292218688725306, -12.560840179741998, 3.1492325078675574, 6.549258727157416, -28.08106270160294, 18.573629628705405, 10.027611869332063, 15.072332626001387, -22.532755346576575, 14.132015857715881, -24.21889107775263, 10.228674325537304, -25.68661413162303, -25.31350490712293, 12.200512493322588, -12.787120538593602, -10.625213487507223, -10.499285873933637, 11.370210322474806, -6.38260963127589, -33.05732701579037, 11.617041932620474, 9.854064463961956, -18.603167357797243, -4.987201272645419, 31.81321962263502, 16.893614323461986, -8.812588049854746, 14.966517485322617, 9.202658119768138, 10.530553842170725, 4.472591709840547, -41.92568826349812, 2.884413499203571, 19.162109681824308, 4.396303357476661, -13.210579751203891, -3.6250706893646476, -18.10259218983403, -3.33080791438316, 39.74101853562374, 9.643087559464352, -21.504486395148202, 11.288467006507636, 3.545080622119256, -29.545950995484755, 6.715149164648961, 8.379243808990308, 31.46310658010655, -0.2259359495471741, 0.8863012876348093, -14.25018866527674, 11.019450755307172, 16.260094626964673, 10.373891836531387, 17.515003873322904, 15.304686941387551, -11.187950214524337, 6.7775546314389405, -11.210396486601084, 9.31184276244931, -17.87140570641791, -10.205604584586055, -9.472294477596781, 10.804686260752423, -10.617444361737384, 17.48513326822518, -28.701166406104562, -21.723975633162482, -16.335890370776646, 4.335048573006972, 20.175518691053387, 9.240045379983002, -7.991370150725665, 11.547924235470695, -13.536833866592321, 20.512482518951803, -3.5582040558278534, 5.668777609483988, 0.4122541805948017, -10.125360925251302, 9.833759452396487, 14.889586497781892, 23.26513053823423, 12.342213903846833, 9.649963838936038, -25.502530139991123, -25.465734062611276, -46.91744389823901, -15.738186443691193, 7.902591148289924, -9.909204928351745, 8.469015435953374, -19.342068087134205, -12.283525907484947, -22.668856617767123, -26.587317095185476, 0.8748297006171839, -30.60762187413953], "episode_lengths": [265, 1117, 953, 269, 269, 397, 259, 295, 299, 439, 229, 411, 338, 825, 663, 278, 873, 790, 872, 298, 373, 530, 297, 165, 420, 370, 1117, 295, 273, 230, 163, 269, 1117, 907, 342, 269, 295, 406, 664, 754, 406, 1117, 250, 653, 259, 299, 439, 299, 244, 1068, 409, 391, 686, 295, 259, 302, 295, 295, 362, 273, 1117, 373, 367, 743, 911, 298, 411, 1117, 517, 763, 532, 348, 247, 1117, 467, 272, 373, 256, 604, 324, 439, 764, 91, 286, 295, 256, 269, 824, 435, 763, 639, 272, 410, 231, 457, 695, 522, 440, 288, 654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.082144495835914, "mean_inference_ms": 6.705868259054175, "mean_action_processing_ms": 0.45652600822453687, "mean_env_wait_ms": 20.38283430296238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02923440933227539, "StateBufferConnector_ms": 0.03423595428466797, "ViewRequirementAgentConnector_ms": 0.7044334411621094}}, "episode_reward_max": 39.74101853562374, "episode_reward_min": -46.91744389823901, "episode_reward_mean": -1.3839915924800186, "episode_len_mean": 481.83, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.008983120855573, 26.292218688725306, -12.560840179741998, 3.1492325078675574, 6.549258727157416, -28.08106270160294, 18.573629628705405, 10.027611869332063, 15.072332626001387, -22.532755346576575, 14.132015857715881, -24.21889107775263, 10.228674325537304, -25.68661413162303, -25.31350490712293, 12.200512493322588, -12.787120538593602, -10.625213487507223, -10.499285873933637, 11.370210322474806, -6.38260963127589, -33.05732701579037, 11.617041932620474, 9.854064463961956, -18.603167357797243, -4.987201272645419, 31.81321962263502, 16.893614323461986, -8.812588049854746, 14.966517485322617, 9.202658119768138, 10.530553842170725, 4.472591709840547, -41.92568826349812, 2.884413499203571, 19.162109681824308, 4.396303357476661, -13.210579751203891, -3.6250706893646476, -18.10259218983403, -3.33080791438316, 39.74101853562374, 9.643087559464352, -21.504486395148202, 11.288467006507636, 3.545080622119256, -29.545950995484755, 6.715149164648961, 8.379243808990308, 31.46310658010655, -0.2259359495471741, 0.8863012876348093, -14.25018866527674, 11.019450755307172, 16.260094626964673, 10.373891836531387, 17.515003873322904, 15.304686941387551, -11.187950214524337, 6.7775546314389405, -11.210396486601084, 9.31184276244931, -17.87140570641791, -10.205604584586055, -9.472294477596781, 10.804686260752423, -10.617444361737384, 17.48513326822518, -28.701166406104562, -21.723975633162482, -16.335890370776646, 4.335048573006972, 20.175518691053387, 9.240045379983002, -7.991370150725665, 11.547924235470695, -13.536833866592321, 20.512482518951803, -3.5582040558278534, 5.668777609483988, 0.4122541805948017, -10.125360925251302, 9.833759452396487, 14.889586497781892, 23.26513053823423, 12.342213903846833, 9.649963838936038, -25.502530139991123, -25.465734062611276, -46.91744389823901, -15.738186443691193, 7.902591148289924, -9.909204928351745, 8.469015435953374, -19.342068087134205, -12.283525907484947, -22.668856617767123, -26.587317095185476, 0.8748297006171839, -30.60762187413953], "episode_lengths": [265, 1117, 953, 269, 269, 397, 259, 295, 299, 439, 229, 411, 338, 825, 663, 278, 873, 790, 872, 298, 373, 530, 297, 165, 420, 370, 1117, 295, 273, 230, 163, 269, 1117, 907, 342, 269, 295, 406, 664, 754, 406, 1117, 250, 653, 259, 299, 439, 299, 244, 1068, 409, 391, 686, 295, 259, 302, 295, 295, 362, 273, 1117, 373, 367, 743, 911, 298, 411, 1117, 517, 763, 532, 348, 247, 1117, 467, 272, 373, 256, 604, 324, 439, 764, 91, 286, 295, 256, 269, 824, 435, 763, 639, 272, 410, 231, 457, 695, 522, 440, 288, 654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.082144495835914, "mean_inference_ms": 6.705868259054175, "mean_action_processing_ms": 0.45652600822453687, "mean_env_wait_ms": 20.38283430296238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02923440933227539, "StateBufferConnector_ms": 0.03423595428466797, "ViewRequirementAgentConnector_ms": 0.7044334411621094}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72823, "num_agent_steps_trained": 72823, "num_env_steps_sampled": 72823, "num_env_steps_trained": 72823, "num_env_steps_sampled_this_iter": 6899, "num_env_steps_trained_this_iter": 6899, "num_env_steps_sampled_throughput_per_sec": 238.7359591070962, "num_env_steps_trained_throughput_per_sec": 238.7359591070962, "timesteps_total": 72823, "num_steps_trained_this_iter": 6899, "agent_timesteps_total": 72823, "timers": {"training_iteration_time_ms": 31726.238, "sample_time_ms": 24642.319, "load_time_ms": 974.417, "load_throughput": 6933.789, "learn_time_ms": 5641.281, "learn_throughput": 1197.671, "synch_weights_time_ms": 418.491}, "counters": {"num_env_steps_sampled": 72823, "num_env_steps_trained": 72823, "num_agent_steps_sampled": 72823, "num_agent_steps_trained": 72823}, "done": false, "episodes_total": 155, "training_iteration": 11, "trial_id": "32ccc_00000", "date": "2025-06-07_12-07-18", "timestamp": 1749290838, "time_this_iter_s": 28.913574934005737, "time_total_s": 363.3307445049286, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 363.3307445049286, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 63.64411764705883, "ram_util_percent": 71.58529411764708, "gpu_util_percent0": 0.07058823529411765, "vram_util_percent0": 0.96826171875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.927177e-05, "total_loss": -0.1190160214933085, "policy_loss": -0.002015834059245114, "vf_loss": 0.07719842226501426, "vf_explained_var": 0.9349697363787683, "kl": 0.00866041173435909, "entropy": 14.657944383292362, "entropy_coeff": 0.009635884999999999}, "model": {}, "num_grad_updates_lifetime": 2675.5, "diff_num_grad_updates_vs_sampler_policy": 144.5}}, "num_env_steps_sampled": 81043, "num_env_steps_trained": 81043, "num_agent_steps_sampled": 81043, "num_agent_steps_trained": 81043}, "sampler_results": {"episode_reward_max": 39.74101853562374, "episode_reward_min": -46.91744389823901, "episode_reward_mean": -0.22300326274485605, "episode_len_mean": 500.38, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.31350490712293, 12.200512493322588, -12.787120538593602, -10.625213487507223, -10.499285873933637, 11.370210322474806, -6.38260963127589, -33.05732701579037, 11.617041932620474, 9.854064463961956, -18.603167357797243, -4.987201272645419, 31.81321962263502, 16.893614323461986, -8.812588049854746, 14.966517485322617, 9.202658119768138, 10.530553842170725, 4.472591709840547, -41.92568826349812, 2.884413499203571, 19.162109681824308, 4.396303357476661, -13.210579751203891, -3.6250706893646476, -18.10259218983403, -3.33080791438316, 39.74101853562374, 9.643087559464352, -21.504486395148202, 11.288467006507636, 3.545080622119256, -29.545950995484755, 6.715149164648961, 8.379243808990308, 31.46310658010655, -0.2259359495471741, 0.8863012876348093, -14.25018866527674, 11.019450755307172, 16.260094626964673, 10.373891836531387, 17.515003873322904, 15.304686941387551, -11.187950214524337, 6.7775546314389405, -11.210396486601084, 9.31184276244931, -17.87140570641791, -10.205604584586055, -9.472294477596781, 10.804686260752423, -10.617444361737384, 17.48513326822518, -28.701166406104562, -21.723975633162482, -16.335890370776646, 4.335048573006972, 20.175518691053387, 9.240045379983002, -7.991370150725665, 11.547924235470695, -13.536833866592321, 20.512482518951803, -3.5582040558278534, 5.668777609483988, 0.4122541805948017, -10.125360925251302, 9.833759452396487, 14.889586497781892, 23.26513053823423, 12.342213903846833, 9.649963838936038, -25.502530139991123, -25.465734062611276, -46.91744389823901, -15.738186443691193, 7.902591148289924, -9.909204928351745, 8.469015435953374, -19.342068087134205, -12.283525907484947, -22.668856617767123, -26.587317095185476, 0.8748297006171839, -30.60762187413953, 3.0279345044712764, 8.509089861402678, 4.636437147079624, 6.66978806351683, 14.048465332042984, 22.04190561999534, 4.766453920283977, 8.28213731912754, 9.398577810280639, 12.351280155681089, -8.074561939152066, 5.81850275384762, 11.461289183792063, 14.115327155747423], "episode_lengths": [663, 278, 873, 790, 872, 298, 373, 530, 297, 165, 420, 370, 1117, 295, 273, 230, 163, 269, 1117, 907, 342, 269, 295, 406, 664, 754, 406, 1117, 250, 653, 259, 299, 439, 299, 244, 1068, 409, 391, 686, 295, 259, 302, 295, 295, 362, 273, 1117, 373, 367, 743, 911, 298, 411, 1117, 517, 763, 532, 348, 247, 1117, 467, 272, 373, 256, 604, 324, 439, 764, 91, 286, 295, 256, 269, 824, 435, 763, 639, 272, 410, 231, 457, 695, 522, 440, 288, 654, 373, 748, 1117, 317, 269, 1109, 1117, 304, 1117, 372, 605, 300, 240, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.06179227055401, "mean_inference_ms": 6.687635725781203, "mean_action_processing_ms": 0.45483904993135466, "mean_env_wait_ms": 20.306820189556674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02521038055419922, "StateBufferConnector_ms": 0.0332033634185791, "ViewRequirementAgentConnector_ms": 0.7162935733795166}}, "episode_reward_max": 39.74101853562374, "episode_reward_min": -46.91744389823901, "episode_reward_mean": -0.22300326274485605, "episode_len_mean": 500.38, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25.31350490712293, 12.200512493322588, -12.787120538593602, -10.625213487507223, -10.499285873933637, 11.370210322474806, -6.38260963127589, -33.05732701579037, 11.617041932620474, 9.854064463961956, -18.603167357797243, -4.987201272645419, 31.81321962263502, 16.893614323461986, -8.812588049854746, 14.966517485322617, 9.202658119768138, 10.530553842170725, 4.472591709840547, -41.92568826349812, 2.884413499203571, 19.162109681824308, 4.396303357476661, -13.210579751203891, -3.6250706893646476, -18.10259218983403, -3.33080791438316, 39.74101853562374, 9.643087559464352, -21.504486395148202, 11.288467006507636, 3.545080622119256, -29.545950995484755, 6.715149164648961, 8.379243808990308, 31.46310658010655, -0.2259359495471741, 0.8863012876348093, -14.25018866527674, 11.019450755307172, 16.260094626964673, 10.373891836531387, 17.515003873322904, 15.304686941387551, -11.187950214524337, 6.7775546314389405, -11.210396486601084, 9.31184276244931, -17.87140570641791, -10.205604584586055, -9.472294477596781, 10.804686260752423, -10.617444361737384, 17.48513326822518, -28.701166406104562, -21.723975633162482, -16.335890370776646, 4.335048573006972, 20.175518691053387, 9.240045379983002, -7.991370150725665, 11.547924235470695, -13.536833866592321, 20.512482518951803, -3.5582040558278534, 5.668777609483988, 0.4122541805948017, -10.125360925251302, 9.833759452396487, 14.889586497781892, 23.26513053823423, 12.342213903846833, 9.649963838936038, -25.502530139991123, -25.465734062611276, -46.91744389823901, -15.738186443691193, 7.902591148289924, -9.909204928351745, 8.469015435953374, -19.342068087134205, -12.283525907484947, -22.668856617767123, -26.587317095185476, 0.8748297006171839, -30.60762187413953, 3.0279345044712764, 8.509089861402678, 4.636437147079624, 6.66978806351683, 14.048465332042984, 22.04190561999534, 4.766453920283977, 8.28213731912754, 9.398577810280639, 12.351280155681089, -8.074561939152066, 5.81850275384762, 11.461289183792063, 14.115327155747423], "episode_lengths": [663, 278, 873, 790, 872, 298, 373, 530, 297, 165, 420, 370, 1117, 295, 273, 230, 163, 269, 1117, 907, 342, 269, 295, 406, 664, 754, 406, 1117, 250, 653, 259, 299, 439, 299, 244, 1068, 409, 391, 686, 295, 259, 302, 295, 295, 362, 273, 1117, 373, 367, 743, 911, 298, 411, 1117, 517, 763, 532, 348, 247, 1117, 467, 272, 373, 256, 604, 324, 439, 764, 91, 286, 295, 256, 269, 824, 435, 763, 639, 272, 410, 231, 457, 695, 522, 440, 288, 654, 373, 748, 1117, 317, 269, 1109, 1117, 304, 1117, 372, 605, 300, 240, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.06179227055401, "mean_inference_ms": 6.687635725781203, "mean_action_processing_ms": 0.45483904993135466, "mean_env_wait_ms": 20.306820189556674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02521038055419922, "StateBufferConnector_ms": 0.0332033634185791, "ViewRequirementAgentConnector_ms": 0.7162935733795166}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81043, "num_agent_steps_trained": 81043, "num_env_steps_sampled": 81043, "num_env_steps_trained": 81043, "num_env_steps_sampled_this_iter": 8220, "num_env_steps_trained_this_iter": 8220, "num_env_steps_sampled_throughput_per_sec": 198.80582698660493, "num_env_steps_trained_throughput_per_sec": 198.80582698660493, "timesteps_total": 81043, "num_steps_trained_this_iter": 8220, "agent_timesteps_total": 81043, "timers": {"training_iteration_time_ms": 33046.288, "sample_time_ms": 25146.954, "load_time_ms": 1121.076, "load_throughput": 6240.968, "learn_time_ms": 6275.386, "learn_throughput": 1114.927, "synch_weights_time_ms": 451.888}, "counters": {"num_env_steps_sampled": 81043, "num_env_steps_trained": 81043, "num_agent_steps_sampled": 81043, "num_agent_steps_trained": 81043}, "done": false, "episodes_total": 169, "training_iteration": 12, "trial_id": "32ccc_00000", "date": "2025-06-07_12-07-59", "timestamp": 1749290879, "time_this_iter_s": 41.369890213012695, "time_total_s": 404.7006347179413, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 404.7006347179413, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 51.316, "ram_util_percent": 73.454, "gpu_util_percent0": 0.153, "vram_util_percent0": 0.96826171875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.918956999999999e-05, "total_loss": -0.11420194672307733, "policy_loss": 0.0005992222295114489, "vf_loss": 0.0866341347439271, "vf_explained_var": 0.931069467826323, "kl": 0.008342095477101711, "entropy": 14.782422854683617, "entropy_coeff": 0.009594784999999998}, "model": {}, "num_grad_updates_lifetime": 2985.5, "diff_num_grad_updates_vs_sampler_policy": 164.5}}, "num_env_steps_sampled": 90447, "num_env_steps_trained": 90447, "num_agent_steps_sampled": 90447, "num_agent_steps_trained": 90447}, "sampler_results": {"episode_reward_max": 39.74101853562374, "episode_reward_min": -46.91744389823901, "episode_reward_mean": 0.949583730797615, "episode_len_mean": 521.01, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.812588049854746, 14.966517485322617, 9.202658119768138, 10.530553842170725, 4.472591709840547, -41.92568826349812, 2.884413499203571, 19.162109681824308, 4.396303357476661, -13.210579751203891, -3.6250706893646476, -18.10259218983403, -3.33080791438316, 39.74101853562374, 9.643087559464352, -21.504486395148202, 11.288467006507636, 3.545080622119256, -29.545950995484755, 6.715149164648961, 8.379243808990308, 31.46310658010655, -0.2259359495471741, 0.8863012876348093, -14.25018866527674, 11.019450755307172, 16.260094626964673, 10.373891836531387, 17.515003873322904, 15.304686941387551, -11.187950214524337, 6.7775546314389405, -11.210396486601084, 9.31184276244931, -17.87140570641791, -10.205604584586055, -9.472294477596781, 10.804686260752423, -10.617444361737384, 17.48513326822518, -28.701166406104562, -21.723975633162482, -16.335890370776646, 4.335048573006972, 20.175518691053387, 9.240045379983002, -7.991370150725665, 11.547924235470695, -13.536833866592321, 20.512482518951803, -3.5582040558278534, 5.668777609483988, 0.4122541805948017, -10.125360925251302, 9.833759452396487, 14.889586497781892, 23.26513053823423, 12.342213903846833, 9.649963838936038, -25.502530139991123, -25.465734062611276, -46.91744389823901, -15.738186443691193, 7.902591148289924, -9.909204928351745, 8.469015435953374, -19.342068087134205, -12.283525907484947, -22.668856617767123, -26.587317095185476, 0.8748297006171839, -30.60762187413953, 3.0279345044712764, 8.509089861402678, 4.636437147079624, 6.66978806351683, 14.048465332042984, 22.04190561999534, 4.766453920283977, 8.28213731912754, 9.398577810280639, 12.351280155681089, -8.074561939152066, 5.81850275384762, 11.461289183792063, 14.115327155747423, -7.428572450263511, -3.648544893700363, 9.204599962787096, -7.695753267602488, 6.897185239300707, 8.62206240622611, -0.595224740129956, 20.48389386698618, 4.790706421001384, 7.1123777742152825, 27.256058287807736, 9.278952057245275, 4.541592343953493, 9.932599420230668], "episode_lengths": [273, 230, 163, 269, 1117, 907, 342, 269, 295, 406, 664, 754, 406, 1117, 250, 653, 259, 299, 439, 299, 244, 1068, 409, 391, 686, 295, 259, 302, 295, 295, 362, 273, 1117, 373, 367, 743, 911, 298, 411, 1117, 517, 763, 532, 348, 247, 1117, 467, 272, 373, 256, 604, 324, 439, 764, 91, 286, 295, 256, 269, 824, 435, 763, 639, 272, 410, 231, 457, 695, 522, 440, 288, 654, 373, 748, 1117, 317, 269, 1109, 1117, 304, 1117, 372, 605, 300, 240, 232, 870, 762, 288, 797, 390, 268, 629, 1117, 373, 653, 1117, 1117, 763, 260]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.044001579153626, "mean_inference_ms": 6.675447233266857, "mean_action_processing_ms": 0.45379914470187716, "mean_env_wait_ms": 20.25206360025011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022141218185424805, "StateBufferConnector_ms": 0.03317737579345703, "ViewRequirementAgentConnector_ms": 0.7028772830963135}}, "episode_reward_max": 39.74101853562374, "episode_reward_min": -46.91744389823901, "episode_reward_mean": 0.949583730797615, "episode_len_mean": 521.01, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.812588049854746, 14.966517485322617, 9.202658119768138, 10.530553842170725, 4.472591709840547, -41.92568826349812, 2.884413499203571, 19.162109681824308, 4.396303357476661, -13.210579751203891, -3.6250706893646476, -18.10259218983403, -3.33080791438316, 39.74101853562374, 9.643087559464352, -21.504486395148202, 11.288467006507636, 3.545080622119256, -29.545950995484755, 6.715149164648961, 8.379243808990308, 31.46310658010655, -0.2259359495471741, 0.8863012876348093, -14.25018866527674, 11.019450755307172, 16.260094626964673, 10.373891836531387, 17.515003873322904, 15.304686941387551, -11.187950214524337, 6.7775546314389405, -11.210396486601084, 9.31184276244931, -17.87140570641791, -10.205604584586055, -9.472294477596781, 10.804686260752423, -10.617444361737384, 17.48513326822518, -28.701166406104562, -21.723975633162482, -16.335890370776646, 4.335048573006972, 20.175518691053387, 9.240045379983002, -7.991370150725665, 11.547924235470695, -13.536833866592321, 20.512482518951803, -3.5582040558278534, 5.668777609483988, 0.4122541805948017, -10.125360925251302, 9.833759452396487, 14.889586497781892, 23.26513053823423, 12.342213903846833, 9.649963838936038, -25.502530139991123, -25.465734062611276, -46.91744389823901, -15.738186443691193, 7.902591148289924, -9.909204928351745, 8.469015435953374, -19.342068087134205, -12.283525907484947, -22.668856617767123, -26.587317095185476, 0.8748297006171839, -30.60762187413953, 3.0279345044712764, 8.509089861402678, 4.636437147079624, 6.66978806351683, 14.048465332042984, 22.04190561999534, 4.766453920283977, 8.28213731912754, 9.398577810280639, 12.351280155681089, -8.074561939152066, 5.81850275384762, 11.461289183792063, 14.115327155747423, -7.428572450263511, -3.648544893700363, 9.204599962787096, -7.695753267602488, 6.897185239300707, 8.62206240622611, -0.595224740129956, 20.48389386698618, 4.790706421001384, 7.1123777742152825, 27.256058287807736, 9.278952057245275, 4.541592343953493, 9.932599420230668], "episode_lengths": [273, 230, 163, 269, 1117, 907, 342, 269, 295, 406, 664, 754, 406, 1117, 250, 653, 259, 299, 439, 299, 244, 1068, 409, 391, 686, 295, 259, 302, 295, 295, 362, 273, 1117, 373, 367, 743, 911, 298, 411, 1117, 517, 763, 532, 348, 247, 1117, 467, 272, 373, 256, 604, 324, 439, 764, 91, 286, 295, 256, 269, 824, 435, 763, 639, 272, 410, 231, 457, 695, 522, 440, 288, 654, 373, 748, 1117, 317, 269, 1109, 1117, 304, 1117, 372, 605, 300, 240, 232, 870, 762, 288, 797, 390, 268, 629, 1117, 373, 653, 1117, 1117, 763, 260]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.044001579153626, "mean_inference_ms": 6.675447233266857, "mean_action_processing_ms": 0.45379914470187716, "mean_env_wait_ms": 20.25206360025011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022141218185424805, "StateBufferConnector_ms": 0.03317737579345703, "ViewRequirementAgentConnector_ms": 0.7028772830963135}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90447, "num_agent_steps_trained": 90447, "num_env_steps_sampled": 90447, "num_env_steps_trained": 90447, "num_env_steps_sampled_this_iter": 9404, "num_env_steps_trained_this_iter": 9404, "num_env_steps_sampled_throughput_per_sec": 204.60119805859554, "num_env_steps_trained_throughput_per_sec": 204.60119805859554, "timesteps_total": 90447, "num_steps_trained_this_iter": 9404, "agent_timesteps_total": 90447, "timers": {"training_iteration_time_ms": 34663.866, "sample_time_ms": 25876.18, "load_time_ms": 1279.037, "load_throughput": 5668.327, "learn_time_ms": 7003.977, "learn_throughput": 1035.126, "synch_weights_time_ms": 451.13}, "counters": {"num_env_steps_sampled": 90447, "num_env_steps_trained": 90447, "num_agent_steps_sampled": 90447, "num_agent_steps_trained": 90447}, "done": false, "episodes_total": 183, "training_iteration": 13, "trial_id": "32ccc_00000", "date": "2025-06-07_12-08-45", "timestamp": 1749290925, "time_this_iter_s": 45.97556924819946, "time_total_s": 450.67620396614075, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 450.67620396614075, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 55.69454545454545, "ram_util_percent": 78.09272727272726, "gpu_util_percent0": 0.15763636363636363, "vram_util_percent0": 0.96826171875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.909553000000001e-05, "total_loss": -0.1432815015618314, "policy_loss": -0.029184860210385053, "vf_loss": 0.08818380520228417, "vf_explained_var": 0.9232074477980213, "kl": 0.008262844479618399, "entropy": 14.829086651340608, "entropy_coeff": 0.009547765}, "model": {}, "num_grad_updates_lifetime": 3305.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 99257, "num_env_steps_trained": 99257, "num_agent_steps_sampled": 99257, "num_agent_steps_trained": 99257}, "sampler_results": {"episode_reward_max": 33.18750957842652, "episode_reward_min": -46.91744389823901, "episode_reward_mean": 1.359459669500599, "episode_len_mean": 534.49, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.504486395148202, 11.288467006507636, 3.545080622119256, -29.545950995484755, 6.715149164648961, 8.379243808990308, 31.46310658010655, -0.2259359495471741, 0.8863012876348093, -14.25018866527674, 11.019450755307172, 16.260094626964673, 10.373891836531387, 17.515003873322904, 15.304686941387551, -11.187950214524337, 6.7775546314389405, -11.210396486601084, 9.31184276244931, -17.87140570641791, -10.205604584586055, -9.472294477596781, 10.804686260752423, -10.617444361737384, 17.48513326822518, -28.701166406104562, -21.723975633162482, -16.335890370776646, 4.335048573006972, 20.175518691053387, 9.240045379983002, -7.991370150725665, 11.547924235470695, -13.536833866592321, 20.512482518951803, -3.5582040558278534, 5.668777609483988, 0.4122541805948017, -10.125360925251302, 9.833759452396487, 14.889586497781892, 23.26513053823423, 12.342213903846833, 9.649963838936038, -25.502530139991123, -25.465734062611276, -46.91744389823901, -15.738186443691193, 7.902591148289924, -9.909204928351745, 8.469015435953374, -19.342068087134205, -12.283525907484947, -22.668856617767123, -26.587317095185476, 0.8748297006171839, -30.60762187413953, 3.0279345044712764, 8.509089861402678, 4.636437147079624, 6.66978806351683, 14.048465332042984, 22.04190561999534, 4.766453920283977, 8.28213731912754, 9.398577810280639, 12.351280155681089, -8.074561939152066, 5.81850275384762, 11.461289183792063, 14.115327155747423, -7.428572450263511, -3.648544893700363, 9.204599962787096, -7.695753267602488, 6.897185239300707, 8.62206240622611, -0.595224740129956, 20.48389386698618, 4.790706421001384, 7.1123777742152825, 27.256058287807736, 9.278952057245275, 4.541592343953493, 9.932599420230668, 12.302033978358661, 8.004495295767914, -3.290972773424759, 33.18750957842652, -13.309997493687925, -25.115762962852912, 22.100194476040613, 1.6982205736581093, 3.6801282484616014, 16.527842078867195, 29.982037056391675, -18.10326448468074, 14.717400827613085, 6.304438208034659, -21.704781804119254], "episode_lengths": [653, 259, 299, 439, 299, 244, 1068, 409, 391, 686, 295, 259, 302, 295, 295, 362, 273, 1117, 373, 367, 743, 911, 298, 411, 1117, 517, 763, 532, 348, 247, 1117, 467, 272, 373, 256, 604, 324, 439, 764, 91, 286, 295, 256, 269, 824, 435, 763, 639, 272, 410, 231, 457, 695, 522, 440, 288, 654, 373, 748, 1117, 317, 269, 1109, 1117, 304, 1117, 372, 605, 300, 240, 232, 870, 762, 288, 797, 390, 268, 629, 1117, 373, 653, 1117, 1117, 763, 260, 269, 303, 831, 1117, 406, 470, 259, 688, 91, 1117, 945, 520, 268, 828, 698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0323137241877145, "mean_inference_ms": 6.671257572471157, "mean_action_processing_ms": 0.45287521620679105, "mean_env_wait_ms": 20.219686264835097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01408076286315918, "StateBufferConnector_ms": 0.030139923095703125, "ViewRequirementAgentConnector_ms": 0.6926290988922119}}, "episode_reward_max": 33.18750957842652, "episode_reward_min": -46.91744389823901, "episode_reward_mean": 1.359459669500599, "episode_len_mean": 534.49, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.504486395148202, 11.288467006507636, 3.545080622119256, -29.545950995484755, 6.715149164648961, 8.379243808990308, 31.46310658010655, -0.2259359495471741, 0.8863012876348093, -14.25018866527674, 11.019450755307172, 16.260094626964673, 10.373891836531387, 17.515003873322904, 15.304686941387551, -11.187950214524337, 6.7775546314389405, -11.210396486601084, 9.31184276244931, -17.87140570641791, -10.205604584586055, -9.472294477596781, 10.804686260752423, -10.617444361737384, 17.48513326822518, -28.701166406104562, -21.723975633162482, -16.335890370776646, 4.335048573006972, 20.175518691053387, 9.240045379983002, -7.991370150725665, 11.547924235470695, -13.536833866592321, 20.512482518951803, -3.5582040558278534, 5.668777609483988, 0.4122541805948017, -10.125360925251302, 9.833759452396487, 14.889586497781892, 23.26513053823423, 12.342213903846833, 9.649963838936038, -25.502530139991123, -25.465734062611276, -46.91744389823901, -15.738186443691193, 7.902591148289924, -9.909204928351745, 8.469015435953374, -19.342068087134205, -12.283525907484947, -22.668856617767123, -26.587317095185476, 0.8748297006171839, -30.60762187413953, 3.0279345044712764, 8.509089861402678, 4.636437147079624, 6.66978806351683, 14.048465332042984, 22.04190561999534, 4.766453920283977, 8.28213731912754, 9.398577810280639, 12.351280155681089, -8.074561939152066, 5.81850275384762, 11.461289183792063, 14.115327155747423, -7.428572450263511, -3.648544893700363, 9.204599962787096, -7.695753267602488, 6.897185239300707, 8.62206240622611, -0.595224740129956, 20.48389386698618, 4.790706421001384, 7.1123777742152825, 27.256058287807736, 9.278952057245275, 4.541592343953493, 9.932599420230668, 12.302033978358661, 8.004495295767914, -3.290972773424759, 33.18750957842652, -13.309997493687925, -25.115762962852912, 22.100194476040613, 1.6982205736581093, 3.6801282484616014, 16.527842078867195, 29.982037056391675, -18.10326448468074, 14.717400827613085, 6.304438208034659, -21.704781804119254], "episode_lengths": [653, 259, 299, 439, 299, 244, 1068, 409, 391, 686, 295, 259, 302, 295, 295, 362, 273, 1117, 373, 367, 743, 911, 298, 411, 1117, 517, 763, 532, 348, 247, 1117, 467, 272, 373, 256, 604, 324, 439, 764, 91, 286, 295, 256, 269, 824, 435, 763, 639, 272, 410, 231, 457, 695, 522, 440, 288, 654, 373, 748, 1117, 317, 269, 1109, 1117, 304, 1117, 372, 605, 300, 240, 232, 870, 762, 288, 797, 390, 268, 629, 1117, 373, 653, 1117, 1117, 763, 260, 269, 303, 831, 1117, 406, 470, 259, 688, 91, 1117, 945, 520, 268, 828, 698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0323137241877145, "mean_inference_ms": 6.671257572471157, "mean_action_processing_ms": 0.45287521620679105, "mean_env_wait_ms": 20.219686264835097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01408076286315918, "StateBufferConnector_ms": 0.030139923095703125, "ViewRequirementAgentConnector_ms": 0.6926290988922119}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99257, "num_agent_steps_trained": 99257, "num_env_steps_sampled": 99257, "num_env_steps_trained": 99257, "num_env_steps_sampled_this_iter": 8810, "num_env_steps_trained_this_iter": 8810, "num_env_steps_sampled_throughput_per_sec": 193.27208184278157, "num_env_steps_trained_throughput_per_sec": 193.27208184278157, "timesteps_total": 99257, "num_steps_trained_this_iter": 8810, "agent_timesteps_total": 99257, "timers": {"training_iteration_time_ms": 36020.532, "sample_time_ms": 26387.388, "load_time_ms": 1402.026, "load_throughput": 5303.183, "learn_time_ms": 7726.481, "learn_throughput": 962.301, "synch_weights_time_ms": 449.302}, "counters": {"num_env_steps_sampled": 99257, "num_env_steps_trained": 99257, "num_agent_steps_sampled": 99257, "num_agent_steps_trained": 99257}, "done": false, "episodes_total": 198, "training_iteration": 14, "trial_id": "32ccc_00000", "date": "2025-06-07_12-09-31", "timestamp": 1749290971, "time_this_iter_s": 45.59912848472595, "time_total_s": 496.2753324508667, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 496.2753324508667, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 52.02, "ram_util_percent": 81.07818181818182, "gpu_util_percent0": 0.16800000000000004, "vram_util_percent0": 0.96826171875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.900743000000001e-05, "total_loss": -0.14220303499512374, "policy_loss": -0.029684309186413883, "vf_loss": 0.09142691883817315, "vf_explained_var": 0.9240715370178223, "kl": 0.008201593800098635, "entropy": 14.833358280181885, "entropy_coeff": 0.009503714999999998}, "model": {}, "num_grad_updates_lifetime": 3585.5, "diff_num_grad_updates_vs_sampler_policy": 124.5}}, "num_env_steps_sampled": 106411, "num_env_steps_trained": 106411, "num_agent_steps_sampled": 106411, "num_agent_steps_trained": 106411}, "sampler_results": {"episode_reward_max": 33.18750957842652, "episode_reward_min": -46.91744389823901, "episode_reward_mean": 1.0236717441998655, "episode_len_mean": 547.05, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.304686941387551, -11.187950214524337, 6.7775546314389405, -11.210396486601084, 9.31184276244931, -17.87140570641791, -10.205604584586055, -9.472294477596781, 10.804686260752423, -10.617444361737384, 17.48513326822518, -28.701166406104562, -21.723975633162482, -16.335890370776646, 4.335048573006972, 20.175518691053387, 9.240045379983002, -7.991370150725665, 11.547924235470695, -13.536833866592321, 20.512482518951803, -3.5582040558278534, 5.668777609483988, 0.4122541805948017, -10.125360925251302, 9.833759452396487, 14.889586497781892, 23.26513053823423, 12.342213903846833, 9.649963838936038, -25.502530139991123, -25.465734062611276, -46.91744389823901, -15.738186443691193, 7.902591148289924, -9.909204928351745, 8.469015435953374, -19.342068087134205, -12.283525907484947, -22.668856617767123, -26.587317095185476, 0.8748297006171839, -30.60762187413953, 3.0279345044712764, 8.509089861402678, 4.636437147079624, 6.66978806351683, 14.048465332042984, 22.04190561999534, 4.766453920283977, 8.28213731912754, 9.398577810280639, 12.351280155681089, -8.074561939152066, 5.81850275384762, 11.461289183792063, 14.115327155747423, -7.428572450263511, -3.648544893700363, 9.204599962787096, -7.695753267602488, 6.897185239300707, 8.62206240622611, -0.595224740129956, 20.48389386698618, 4.790706421001384, 7.1123777742152825, 27.256058287807736, 9.278952057245275, 4.541592343953493, 9.932599420230668, 12.302033978358661, 8.004495295767914, -3.290972773424759, 33.18750957842652, -13.309997493687925, -25.115762962852912, 22.100194476040613, 1.6982205736581093, 3.6801282484616014, 16.527842078867195, 29.982037056391675, -18.10326448468074, 14.717400827613085, 6.304438208034659, -21.704781804119254, -13.252508705168474, -21.818539355988598, 13.546093792238402, -22.440536632272924, 13.632040034743813, 2.6715088138572547, -11.33330488278149, 19.110810986329188, -8.581327050926381, 19.08373467835752, 10.420590836719775, 20.66185201456059, 13.76594330295737, -17.125922806022615], "episode_lengths": [295, 362, 273, 1117, 373, 367, 743, 911, 298, 411, 1117, 517, 763, 532, 348, 247, 1117, 467, 272, 373, 256, 604, 324, 439, 764, 91, 286, 295, 256, 269, 824, 435, 763, 639, 272, 410, 231, 457, 695, 522, 440, 288, 654, 373, 748, 1117, 317, 269, 1109, 1117, 304, 1117, 372, 605, 300, 240, 232, 870, 762, 288, 797, 390, 268, 629, 1117, 373, 653, 1117, 1117, 763, 260, 269, 303, 831, 1117, 406, 470, 259, 688, 91, 1117, 945, 520, 268, 828, 698, 406, 605, 269, 487, 1117, 295, 797, 1117, 374, 269, 252, 295, 260, 611]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.020543702772065, "mean_inference_ms": 6.662061009927069, "mean_action_processing_ms": 0.45210730943393096, "mean_env_wait_ms": 20.19408152507442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012476444244384766, "StateBufferConnector_ms": 0.029124975204467773, "ViewRequirementAgentConnector_ms": 0.7075774669647217}}, "episode_reward_max": 33.18750957842652, "episode_reward_min": -46.91744389823901, "episode_reward_mean": 1.0236717441998655, "episode_len_mean": 547.05, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.304686941387551, -11.187950214524337, 6.7775546314389405, -11.210396486601084, 9.31184276244931, -17.87140570641791, -10.205604584586055, -9.472294477596781, 10.804686260752423, -10.617444361737384, 17.48513326822518, -28.701166406104562, -21.723975633162482, -16.335890370776646, 4.335048573006972, 20.175518691053387, 9.240045379983002, -7.991370150725665, 11.547924235470695, -13.536833866592321, 20.512482518951803, -3.5582040558278534, 5.668777609483988, 0.4122541805948017, -10.125360925251302, 9.833759452396487, 14.889586497781892, 23.26513053823423, 12.342213903846833, 9.649963838936038, -25.502530139991123, -25.465734062611276, -46.91744389823901, -15.738186443691193, 7.902591148289924, -9.909204928351745, 8.469015435953374, -19.342068087134205, -12.283525907484947, -22.668856617767123, -26.587317095185476, 0.8748297006171839, -30.60762187413953, 3.0279345044712764, 8.509089861402678, 4.636437147079624, 6.66978806351683, 14.048465332042984, 22.04190561999534, 4.766453920283977, 8.28213731912754, 9.398577810280639, 12.351280155681089, -8.074561939152066, 5.81850275384762, 11.461289183792063, 14.115327155747423, -7.428572450263511, -3.648544893700363, 9.204599962787096, -7.695753267602488, 6.897185239300707, 8.62206240622611, -0.595224740129956, 20.48389386698618, 4.790706421001384, 7.1123777742152825, 27.256058287807736, 9.278952057245275, 4.541592343953493, 9.932599420230668, 12.302033978358661, 8.004495295767914, -3.290972773424759, 33.18750957842652, -13.309997493687925, -25.115762962852912, 22.100194476040613, 1.6982205736581093, 3.6801282484616014, 16.527842078867195, 29.982037056391675, -18.10326448468074, 14.717400827613085, 6.304438208034659, -21.704781804119254, -13.252508705168474, -21.818539355988598, 13.546093792238402, -22.440536632272924, 13.632040034743813, 2.6715088138572547, -11.33330488278149, 19.110810986329188, -8.581327050926381, 19.08373467835752, 10.420590836719775, 20.66185201456059, 13.76594330295737, -17.125922806022615], "episode_lengths": [295, 362, 273, 1117, 373, 367, 743, 911, 298, 411, 1117, 517, 763, 532, 348, 247, 1117, 467, 272, 373, 256, 604, 324, 439, 764, 91, 286, 295, 256, 269, 824, 435, 763, 639, 272, 410, 231, 457, 695, 522, 440, 288, 654, 373, 748, 1117, 317, 269, 1109, 1117, 304, 1117, 372, 605, 300, 240, 232, 870, 762, 288, 797, 390, 268, 629, 1117, 373, 653, 1117, 1117, 763, 260, 269, 303, 831, 1117, 406, 470, 259, 688, 91, 1117, 945, 520, 268, 828, 698, 406, 605, 269, 487, 1117, 295, 797, 1117, 374, 269, 252, 295, 260, 611]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.020543702772065, "mean_inference_ms": 6.662061009927069, "mean_action_processing_ms": 0.45210730943393096, "mean_env_wait_ms": 20.19408152507442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012476444244384766, "StateBufferConnector_ms": 0.029124975204467773, "ViewRequirementAgentConnector_ms": 0.7075774669647217}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106411, "num_agent_steps_trained": 106411, "num_env_steps_sampled": 106411, "num_env_steps_trained": 106411, "num_env_steps_sampled_this_iter": 7154, "num_env_steps_trained_this_iter": 7154, "num_env_steps_sampled_throughput_per_sec": 212.9616173779338, "num_env_steps_trained_throughput_per_sec": 212.9616173779338, "timesteps_total": 106411, "num_steps_trained_this_iter": 7154, "agent_timesteps_total": 106411, "timers": {"training_iteration_time_ms": 36138.307, "sample_time_ms": 26462.387, "load_time_ms": 1410.204, "load_throughput": 5300.156, "learn_time_ms": 7761.357, "learn_throughput": 963.015, "synch_weights_time_ms": 448.324}, "counters": {"num_env_steps_sampled": 106411, "num_env_steps_trained": 106411, "num_agent_steps_sampled": 106411, "num_agent_steps_trained": 106411}, "done": false, "episodes_total": 212, "training_iteration": 15, "trial_id": "32ccc_00000", "date": "2025-06-07_12-10-04", "timestamp": 1749291004, "time_this_iter_s": 33.607916831970215, "time_total_s": 529.8832492828369, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 529.8832492828369, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 55.339999999999996, "ram_util_percent": 82.11500000000001, "gpu_util_percent0": 0.052750000000000005, "vram_util_percent0": 0.96826171875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.893589000000001e-05, "total_loss": -0.09613653604197316, "policy_loss": 0.013824113758513704, "vf_loss": 0.09985738112777472, "vf_explained_var": 0.9509715135097504, "kl": 0.008755107192439026, "entropy": 14.893649070739746, "entropy_coeff": 0.009467945}, "model": {}, "num_grad_updates_lifetime": 3835.5, "diff_num_grad_updates_vs_sampler_policy": 124.5}}, "num_env_steps_sampled": 113413, "num_env_steps_trained": 113413, "num_agent_steps_sampled": 113413, "num_agent_steps_trained": 113413}, "sampler_results": {"episode_reward_max": 33.18750957842652, "episode_reward_min": -46.91744389823901, "episode_reward_mean": 2.131646014186584, "episode_len_mean": 532.8, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.175518691053387, 9.240045379983002, -7.991370150725665, 11.547924235470695, -13.536833866592321, 20.512482518951803, -3.5582040558278534, 5.668777609483988, 0.4122541805948017, -10.125360925251302, 9.833759452396487, 14.889586497781892, 23.26513053823423, 12.342213903846833, 9.649963838936038, -25.502530139991123, -25.465734062611276, -46.91744389823901, -15.738186443691193, 7.902591148289924, -9.909204928351745, 8.469015435953374, -19.342068087134205, -12.283525907484947, -22.668856617767123, -26.587317095185476, 0.8748297006171839, -30.60762187413953, 3.0279345044712764, 8.509089861402678, 4.636437147079624, 6.66978806351683, 14.048465332042984, 22.04190561999534, 4.766453920283977, 8.28213731912754, 9.398577810280639, 12.351280155681089, -8.074561939152066, 5.81850275384762, 11.461289183792063, 14.115327155747423, -7.428572450263511, -3.648544893700363, 9.204599962787096, -7.695753267602488, 6.897185239300707, 8.62206240622611, -0.595224740129956, 20.48389386698618, 4.790706421001384, 7.1123777742152825, 27.256058287807736, 9.278952057245275, 4.541592343953493, 9.932599420230668, 12.302033978358661, 8.004495295767914, -3.290972773424759, 33.18750957842652, -13.309997493687925, -25.115762962852912, 22.100194476040613, 1.6982205736581093, 3.6801282484616014, 16.527842078867195, 29.982037056391675, -18.10326448468074, 14.717400827613085, 6.304438208034659, -21.704781804119254, -13.252508705168474, -21.818539355988598, 13.546093792238402, -22.440536632272924, 13.632040034743813, 2.6715088138572547, -11.33330488278149, 19.110810986329188, -8.581327050926381, 19.08373467835752, 10.420590836719775, 20.66185201456059, 13.76594330295737, -17.125922806022615, 0.8935859514955857, -9.264852054968859, 2.9659158459242434, 0.26867545747603483, 8.580587010218128, 22.043452145107896, -18.81713244464297, 22.631988087046125, 8.017894819369626, 3.90272330758649, 21.144722494498662, 4.151500946384602, -5.429771430453831, -34.696468383578875, 11.097429442962152], "episode_lengths": [247, 1117, 467, 272, 373, 256, 604, 324, 439, 764, 91, 286, 295, 256, 269, 824, 435, 763, 639, 272, 410, 231, 457, 695, 522, 440, 288, 654, 373, 748, 1117, 317, 269, 1109, 1117, 304, 1117, 372, 605, 300, 240, 232, 870, 762, 288, 797, 390, 268, 629, 1117, 373, 653, 1117, 1117, 763, 260, 269, 303, 831, 1117, 406, 470, 259, 688, 91, 1117, 945, 520, 268, 828, 698, 406, 605, 269, 487, 1117, 295, 797, 1117, 374, 269, 252, 295, 260, 611, 379, 822, 365, 406, 91, 1117, 409, 295, 295, 934, 299, 233, 392, 614, 351]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.011187610665564, "mean_inference_ms": 6.653479425498311, "mean_action_processing_ms": 0.4515248787907676, "mean_env_wait_ms": 20.165228877040516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013507604598999023, "StateBufferConnector_ms": 0.027115821838378906, "ViewRequirementAgentConnector_ms": 0.7166974544525146}}, "episode_reward_max": 33.18750957842652, "episode_reward_min": -46.91744389823901, "episode_reward_mean": 2.131646014186584, "episode_len_mean": 532.8, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.175518691053387, 9.240045379983002, -7.991370150725665, 11.547924235470695, -13.536833866592321, 20.512482518951803, -3.5582040558278534, 5.668777609483988, 0.4122541805948017, -10.125360925251302, 9.833759452396487, 14.889586497781892, 23.26513053823423, 12.342213903846833, 9.649963838936038, -25.502530139991123, -25.465734062611276, -46.91744389823901, -15.738186443691193, 7.902591148289924, -9.909204928351745, 8.469015435953374, -19.342068087134205, -12.283525907484947, -22.668856617767123, -26.587317095185476, 0.8748297006171839, -30.60762187413953, 3.0279345044712764, 8.509089861402678, 4.636437147079624, 6.66978806351683, 14.048465332042984, 22.04190561999534, 4.766453920283977, 8.28213731912754, 9.398577810280639, 12.351280155681089, -8.074561939152066, 5.81850275384762, 11.461289183792063, 14.115327155747423, -7.428572450263511, -3.648544893700363, 9.204599962787096, -7.695753267602488, 6.897185239300707, 8.62206240622611, -0.595224740129956, 20.48389386698618, 4.790706421001384, 7.1123777742152825, 27.256058287807736, 9.278952057245275, 4.541592343953493, 9.932599420230668, 12.302033978358661, 8.004495295767914, -3.290972773424759, 33.18750957842652, -13.309997493687925, -25.115762962852912, 22.100194476040613, 1.6982205736581093, 3.6801282484616014, 16.527842078867195, 29.982037056391675, -18.10326448468074, 14.717400827613085, 6.304438208034659, -21.704781804119254, -13.252508705168474, -21.818539355988598, 13.546093792238402, -22.440536632272924, 13.632040034743813, 2.6715088138572547, -11.33330488278149, 19.110810986329188, -8.581327050926381, 19.08373467835752, 10.420590836719775, 20.66185201456059, 13.76594330295737, -17.125922806022615, 0.8935859514955857, -9.264852054968859, 2.9659158459242434, 0.26867545747603483, 8.580587010218128, 22.043452145107896, -18.81713244464297, 22.631988087046125, 8.017894819369626, 3.90272330758649, 21.144722494498662, 4.151500946384602, -5.429771430453831, -34.696468383578875, 11.097429442962152], "episode_lengths": [247, 1117, 467, 272, 373, 256, 604, 324, 439, 764, 91, 286, 295, 256, 269, 824, 435, 763, 639, 272, 410, 231, 457, 695, 522, 440, 288, 654, 373, 748, 1117, 317, 269, 1109, 1117, 304, 1117, 372, 605, 300, 240, 232, 870, 762, 288, 797, 390, 268, 629, 1117, 373, 653, 1117, 1117, 763, 260, 269, 303, 831, 1117, 406, 470, 259, 688, 91, 1117, 945, 520, 268, 828, 698, 406, 605, 269, 487, 1117, 295, 797, 1117, 374, 269, 252, 295, 260, 611, 379, 822, 365, 406, 91, 1117, 409, 295, 295, 934, 299, 233, 392, 614, 351]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.011187610665564, "mean_inference_ms": 6.653479425498311, "mean_action_processing_ms": 0.4515248787907676, "mean_env_wait_ms": 20.165228877040516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013507604598999023, "StateBufferConnector_ms": 0.027115821838378906, "ViewRequirementAgentConnector_ms": 0.7166974544525146}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113413, "num_agent_steps_trained": 113413, "num_env_steps_sampled": 113413, "num_env_steps_trained": 113413, "num_env_steps_sampled_this_iter": 7002, "num_env_steps_trained_this_iter": 7002, "num_env_steps_sampled_throughput_per_sec": 196.63328604857344, "num_env_steps_trained_throughput_per_sec": 196.63328604857344, "timesteps_total": 113413, "num_steps_trained_this_iter": 7002, "agent_timesteps_total": 113413, "timers": {"training_iteration_time_ms": 36346.331, "sample_time_ms": 26504.367, "load_time_ms": 1409.269, "load_throughput": 5307.29, "learn_time_ms": 7928.467, "learn_throughput": 943.36, "synch_weights_time_ms": 447.62}, "counters": {"num_env_steps_sampled": 113413, "num_env_steps_trained": 113413, "num_agent_steps_sampled": 113413, "num_agent_steps_trained": 113413}, "done": false, "episodes_total": 227, "training_iteration": 16, "trial_id": "32ccc_00000", "date": "2025-06-07_12-10-40", "timestamp": 1749291040, "time_this_iter_s": 35.6304349899292, "time_total_s": 565.5136842727661, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 565.5136842727661, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 51.33636363636364, "ram_util_percent": 82.14772727272725, "gpu_util_percent0": 0.08727272727272728, "vram_util_percent0": 0.96826171875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.886587000000004e-05, "total_loss": -0.1125805843505077, "policy_loss": 0.003230963525711559, "vf_loss": 0.07980329242767766, "vf_explained_var": 0.9340447945892811, "kl": 0.009519956394324654, "entropy": 14.941535108089447, "entropy_coeff": 0.009432935000000002}, "model": {}, "num_grad_updates_lifetime": 4160.5, "diff_num_grad_updates_vs_sampler_policy": 199.5}}, "num_env_steps_sampled": 124691, "num_env_steps_trained": 124691, "num_agent_steps_sampled": 124691, "num_agent_steps_trained": 124691}, "sampler_results": {"episode_reward_max": 34.53429120015461, "episode_reward_min": -46.91744389823901, "episode_reward_mean": 3.051202251599507, "episode_len_mean": 587.67, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.649963838936038, -25.502530139991123, -25.465734062611276, -46.91744389823901, -15.738186443691193, 7.902591148289924, -9.909204928351745, 8.469015435953374, -19.342068087134205, -12.283525907484947, -22.668856617767123, -26.587317095185476, 0.8748297006171839, -30.60762187413953, 3.0279345044712764, 8.509089861402678, 4.636437147079624, 6.66978806351683, 14.048465332042984, 22.04190561999534, 4.766453920283977, 8.28213731912754, 9.398577810280639, 12.351280155681089, -8.074561939152066, 5.81850275384762, 11.461289183792063, 14.115327155747423, -7.428572450263511, -3.648544893700363, 9.204599962787096, -7.695753267602488, 6.897185239300707, 8.62206240622611, -0.595224740129956, 20.48389386698618, 4.790706421001384, 7.1123777742152825, 27.256058287807736, 9.278952057245275, 4.541592343953493, 9.932599420230668, 12.302033978358661, 8.004495295767914, -3.290972773424759, 33.18750957842652, -13.309997493687925, -25.115762962852912, 22.100194476040613, 1.6982205736581093, 3.6801282484616014, 16.527842078867195, 29.982037056391675, -18.10326448468074, 14.717400827613085, 6.304438208034659, -21.704781804119254, -13.252508705168474, -21.818539355988598, 13.546093792238402, -22.440536632272924, 13.632040034743813, 2.6715088138572547, -11.33330488278149, 19.110810986329188, -8.581327050926381, 19.08373467835752, 10.420590836719775, 20.66185201456059, 13.76594330295737, -17.125922806022615, 0.8935859514955857, -9.264852054968859, 2.9659158459242434, 0.26867545747603483, 8.580587010218128, 22.043452145107896, -18.81713244464297, 22.631988087046125, 8.017894819369626, 3.90272330758649, 21.144722494498662, 4.151500946384602, -5.429771430453831, -34.696468383578875, 11.097429442962152, 19.359626707017387, 14.25703140982592, -9.754102149454488, 32.06893024050207, -7.202307005845971, 12.757069167044461, 15.001014993683793, 13.86512815648641, 11.349515703888436, 34.53429120015461, 11.67787930707685, 9.82674956001443, 6.76101779602767, 20.129702664270752], "episode_lengths": [269, 824, 435, 763, 639, 272, 410, 231, 457, 695, 522, 440, 288, 654, 373, 748, 1117, 317, 269, 1109, 1117, 304, 1117, 372, 605, 300, 240, 232, 870, 762, 288, 797, 390, 268, 629, 1117, 373, 653, 1117, 1117, 763, 260, 269, 303, 831, 1117, 406, 470, 259, 688, 91, 1117, 945, 520, 268, 828, 698, 406, 605, 269, 487, 1117, 295, 797, 1117, 374, 269, 252, 295, 260, 611, 379, 822, 365, 406, 91, 1117, 409, 295, 295, 934, 299, 233, 392, 614, 351, 1117, 1117, 410, 1117, 875, 1117, 234, 1117, 233, 1117, 295, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0080589447467583, "mean_inference_ms": 6.6439899786497225, "mean_action_processing_ms": 0.4513244013300453, "mean_env_wait_ms": 20.144136253202944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02009296417236328, "StateBufferConnector_ms": 0.017083168029785156, "ViewRequirementAgentConnector_ms": 0.7269315719604492}}, "episode_reward_max": 34.53429120015461, "episode_reward_min": -46.91744389823901, "episode_reward_mean": 3.051202251599507, "episode_len_mean": 587.67, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.649963838936038, -25.502530139991123, -25.465734062611276, -46.91744389823901, -15.738186443691193, 7.902591148289924, -9.909204928351745, 8.469015435953374, -19.342068087134205, -12.283525907484947, -22.668856617767123, -26.587317095185476, 0.8748297006171839, -30.60762187413953, 3.0279345044712764, 8.509089861402678, 4.636437147079624, 6.66978806351683, 14.048465332042984, 22.04190561999534, 4.766453920283977, 8.28213731912754, 9.398577810280639, 12.351280155681089, -8.074561939152066, 5.81850275384762, 11.461289183792063, 14.115327155747423, -7.428572450263511, -3.648544893700363, 9.204599962787096, -7.695753267602488, 6.897185239300707, 8.62206240622611, -0.595224740129956, 20.48389386698618, 4.790706421001384, 7.1123777742152825, 27.256058287807736, 9.278952057245275, 4.541592343953493, 9.932599420230668, 12.302033978358661, 8.004495295767914, -3.290972773424759, 33.18750957842652, -13.309997493687925, -25.115762962852912, 22.100194476040613, 1.6982205736581093, 3.6801282484616014, 16.527842078867195, 29.982037056391675, -18.10326448468074, 14.717400827613085, 6.304438208034659, -21.704781804119254, -13.252508705168474, -21.818539355988598, 13.546093792238402, -22.440536632272924, 13.632040034743813, 2.6715088138572547, -11.33330488278149, 19.110810986329188, -8.581327050926381, 19.08373467835752, 10.420590836719775, 20.66185201456059, 13.76594330295737, -17.125922806022615, 0.8935859514955857, -9.264852054968859, 2.9659158459242434, 0.26867545747603483, 8.580587010218128, 22.043452145107896, -18.81713244464297, 22.631988087046125, 8.017894819369626, 3.90272330758649, 21.144722494498662, 4.151500946384602, -5.429771430453831, -34.696468383578875, 11.097429442962152, 19.359626707017387, 14.25703140982592, -9.754102149454488, 32.06893024050207, -7.202307005845971, 12.757069167044461, 15.001014993683793, 13.86512815648641, 11.349515703888436, 34.53429120015461, 11.67787930707685, 9.82674956001443, 6.76101779602767, 20.129702664270752], "episode_lengths": [269, 824, 435, 763, 639, 272, 410, 231, 457, 695, 522, 440, 288, 654, 373, 748, 1117, 317, 269, 1109, 1117, 304, 1117, 372, 605, 300, 240, 232, 870, 762, 288, 797, 390, 268, 629, 1117, 373, 653, 1117, 1117, 763, 260, 269, 303, 831, 1117, 406, 470, 259, 688, 91, 1117, 945, 520, 268, 828, 698, 406, 605, 269, 487, 1117, 295, 797, 1117, 374, 269, 252, 295, 260, 611, 379, 822, 365, 406, 91, 1117, 409, 295, 295, 934, 299, 233, 392, 614, 351, 1117, 1117, 410, 1117, 875, 1117, 234, 1117, 233, 1117, 295, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0080589447467583, "mean_inference_ms": 6.6439899786497225, "mean_action_processing_ms": 0.4513244013300453, "mean_env_wait_ms": 20.144136253202944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02009296417236328, "StateBufferConnector_ms": 0.017083168029785156, "ViewRequirementAgentConnector_ms": 0.7269315719604492}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124691, "num_agent_steps_trained": 124691, "num_env_steps_sampled": 124691, "num_env_steps_trained": 124691, "num_env_steps_sampled_this_iter": 11278, "num_env_steps_trained_this_iter": 11278, "num_env_steps_sampled_throughput_per_sec": 216.8291852288447, "num_env_steps_trained_throughput_per_sec": 216.8291852288447, "timesteps_total": 124691, "num_steps_trained_this_iter": 11278, "agent_timesteps_total": 124691, "timers": {"training_iteration_time_ms": 38224.651, "sample_time_ms": 27210.979, "load_time_ms": 1656.184, "load_throughput": 4762.936, "learn_time_ms": 8847.138, "learn_throughput": 891.622, "synch_weights_time_ms": 444.377}, "counters": {"num_env_steps_sampled": 124691, "num_env_steps_trained": 124691, "num_agent_steps_sampled": 124691, "num_agent_steps_trained": 124691}, "done": false, "episodes_total": 241, "training_iteration": 17, "trial_id": "32ccc_00000", "date": "2025-06-07_12-11-32", "timestamp": 1749291092, "time_this_iter_s": 52.03130340576172, "time_total_s": 617.5449876785278, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 617.5449876785278, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 58.566129032258054, "ram_util_percent": 84.83387096774193, "gpu_util_percent0": 0.16612903225806455, "vram_util_percent0": 0.9681514616935482}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.875309000000001e-05, "total_loss": -0.12874888219404965, "policy_loss": -0.017882980032106085, "vf_loss": 0.09574598892591894, "vf_explained_var": 0.9386454097429912, "kl": 0.00801877762741545, "entropy": 14.994013516108195, "entropy_coeff": 0.009376544999999998}, "model": {}, "num_grad_updates_lifetime": 4510.5, "diff_num_grad_updates_vs_sampler_policy": 149.5}}, "num_env_steps_sampled": 133142, "num_env_steps_trained": 133142, "num_agent_steps_sampled": 133142, "num_agent_steps_trained": 133142}, "sampler_results": {"episode_reward_max": 34.53429120015461, "episode_reward_min": -34.696468383578875, "episode_reward_mean": 5.544724526473746, "episode_len_mean": 603.19, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0279345044712764, 8.509089861402678, 4.636437147079624, 6.66978806351683, 14.048465332042984, 22.04190561999534, 4.766453920283977, 8.28213731912754, 9.398577810280639, 12.351280155681089, -8.074561939152066, 5.81850275384762, 11.461289183792063, 14.115327155747423, -7.428572450263511, -3.648544893700363, 9.204599962787096, -7.695753267602488, 6.897185239300707, 8.62206240622611, -0.595224740129956, 20.48389386698618, 4.790706421001384, 7.1123777742152825, 27.256058287807736, 9.278952057245275, 4.541592343953493, 9.932599420230668, 12.302033978358661, 8.004495295767914, -3.290972773424759, 33.18750957842652, -13.309997493687925, -25.115762962852912, 22.100194476040613, 1.6982205736581093, 3.6801282484616014, 16.527842078867195, 29.982037056391675, -18.10326448468074, 14.717400827613085, 6.304438208034659, -21.704781804119254, -13.252508705168474, -21.818539355988598, 13.546093792238402, -22.440536632272924, 13.632040034743813, 2.6715088138572547, -11.33330488278149, 19.110810986329188, -8.581327050926381, 19.08373467835752, 10.420590836719775, 20.66185201456059, 13.76594330295737, -17.125922806022615, 0.8935859514955857, -9.264852054968859, 2.9659158459242434, 0.26867545747603483, 8.580587010218128, 22.043452145107896, -18.81713244464297, 22.631988087046125, 8.017894819369626, 3.90272330758649, 21.144722494498662, 4.151500946384602, -5.429771430453831, -34.696468383578875, 11.097429442962152, 19.359626707017387, 14.25703140982592, -9.754102149454488, 32.06893024050207, -7.202307005845971, 12.757069167044461, 15.001014993683793, 13.86512815648641, 11.349515703888436, 34.53429120015461, 11.67787930707685, 9.82674956001443, 6.76101779602767, 20.129702664270752, 1.910762857535357, 1.3285500477632635, 6.716527079297141, 5.777991645438141, -26.679089532573844, -10.920129521699957, 5.305579697238197, -2.577226912407001, 7.048698535269832, 16.586210465738198, 9.092632676878088, -0.8114796562306037, 1.6917030170984941, 26.75540815727931], "episode_lengths": [373, 748, 1117, 317, 269, 1109, 1117, 304, 1117, 372, 605, 300, 240, 232, 870, 762, 288, 797, 390, 268, 629, 1117, 373, 653, 1117, 1117, 763, 260, 269, 303, 831, 1117, 406, 470, 259, 688, 91, 1117, 945, 520, 268, 828, 698, 406, 605, 269, 487, 1117, 295, 797, 1117, 374, 269, 252, 295, 260, 611, 379, 822, 365, 406, 91, 1117, 409, 295, 295, 934, 299, 233, 392, 614, 351, 1117, 1117, 410, 1117, 875, 1117, 234, 1117, 233, 1117, 295, 1117, 295, 1117, 1094, 373, 295, 653, 662, 411, 1117, 381, 261, 269, 295, 406, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.003244540468397, "mean_inference_ms": 6.628719286407639, "mean_action_processing_ms": 0.45055301611249804, "mean_env_wait_ms": 20.103272555561247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016035079956054688, "StateBufferConnector_ms": 0.015195369720458984, "ViewRequirementAgentConnector_ms": 0.7533421516418457}}, "episode_reward_max": 34.53429120015461, "episode_reward_min": -34.696468383578875, "episode_reward_mean": 5.544724526473746, "episode_len_mean": 603.19, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.0279345044712764, 8.509089861402678, 4.636437147079624, 6.66978806351683, 14.048465332042984, 22.04190561999534, 4.766453920283977, 8.28213731912754, 9.398577810280639, 12.351280155681089, -8.074561939152066, 5.81850275384762, 11.461289183792063, 14.115327155747423, -7.428572450263511, -3.648544893700363, 9.204599962787096, -7.695753267602488, 6.897185239300707, 8.62206240622611, -0.595224740129956, 20.48389386698618, 4.790706421001384, 7.1123777742152825, 27.256058287807736, 9.278952057245275, 4.541592343953493, 9.932599420230668, 12.302033978358661, 8.004495295767914, -3.290972773424759, 33.18750957842652, -13.309997493687925, -25.115762962852912, 22.100194476040613, 1.6982205736581093, 3.6801282484616014, 16.527842078867195, 29.982037056391675, -18.10326448468074, 14.717400827613085, 6.304438208034659, -21.704781804119254, -13.252508705168474, -21.818539355988598, 13.546093792238402, -22.440536632272924, 13.632040034743813, 2.6715088138572547, -11.33330488278149, 19.110810986329188, -8.581327050926381, 19.08373467835752, 10.420590836719775, 20.66185201456059, 13.76594330295737, -17.125922806022615, 0.8935859514955857, -9.264852054968859, 2.9659158459242434, 0.26867545747603483, 8.580587010218128, 22.043452145107896, -18.81713244464297, 22.631988087046125, 8.017894819369626, 3.90272330758649, 21.144722494498662, 4.151500946384602, -5.429771430453831, -34.696468383578875, 11.097429442962152, 19.359626707017387, 14.25703140982592, -9.754102149454488, 32.06893024050207, -7.202307005845971, 12.757069167044461, 15.001014993683793, 13.86512815648641, 11.349515703888436, 34.53429120015461, 11.67787930707685, 9.82674956001443, 6.76101779602767, 20.129702664270752, 1.910762857535357, 1.3285500477632635, 6.716527079297141, 5.777991645438141, -26.679089532573844, -10.920129521699957, 5.305579697238197, -2.577226912407001, 7.048698535269832, 16.586210465738198, 9.092632676878088, -0.8114796562306037, 1.6917030170984941, 26.75540815727931], "episode_lengths": [373, 748, 1117, 317, 269, 1109, 1117, 304, 1117, 372, 605, 300, 240, 232, 870, 762, 288, 797, 390, 268, 629, 1117, 373, 653, 1117, 1117, 763, 260, 269, 303, 831, 1117, 406, 470, 259, 688, 91, 1117, 945, 520, 268, 828, 698, 406, 605, 269, 487, 1117, 295, 797, 1117, 374, 269, 252, 295, 260, 611, 379, 822, 365, 406, 91, 1117, 409, 295, 295, 934, 299, 233, 392, 614, 351, 1117, 1117, 410, 1117, 875, 1117, 234, 1117, 233, 1117, 295, 1117, 295, 1117, 1094, 373, 295, 653, 662, 411, 1117, 381, 261, 269, 295, 406, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.003244540468397, "mean_inference_ms": 6.628719286407639, "mean_action_processing_ms": 0.45055301611249804, "mean_env_wait_ms": 20.103272555561247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016035079956054688, "StateBufferConnector_ms": 0.015195369720458984, "ViewRequirementAgentConnector_ms": 0.7533421516418457}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 133142, "num_agent_steps_trained": 133142, "num_env_steps_sampled": 133142, "num_env_steps_trained": 133142, "num_env_steps_sampled_this_iter": 8451, "num_env_steps_trained_this_iter": 8451, "num_env_steps_sampled_throughput_per_sec": 208.14617658451053, "num_env_steps_trained_throughput_per_sec": 208.14617658451053, "timesteps_total": 133142, "num_steps_trained_this_iter": 8451, "agent_timesteps_total": 133142, "timers": {"training_iteration_time_ms": 39281.456, "sample_time_ms": 27640.231, "load_time_ms": 1676.103, "load_throughput": 4858.651, "learn_time_ms": 9449.746, "learn_throughput": 861.78, "synch_weights_time_ms": 447.012}, "counters": {"num_env_steps_sampled": 133142, "num_env_steps_trained": 133142, "num_agent_steps_sampled": 133142, "num_agent_steps_trained": 133142}, "done": false, "episodes_total": 255, "training_iteration": 18, "trial_id": "32ccc_00000", "date": "2025-06-07_12-12-13", "timestamp": 1749291133, "time_this_iter_s": 40.61626124382019, "time_total_s": 658.161248922348, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 658.161248922348, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 55.15, "ram_util_percent": 84.15, "gpu_util_percent0": 0.14354166666666668, "vram_util_percent0": 0.9679361979166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.866857999999997e-05, "total_loss": -0.1029983073938638, "policy_loss": 0.006156284901602515, "vf_loss": 0.09946819070790862, "vf_explained_var": 0.9275139042015733, "kl": 0.008188433074911732, "entropy": 15.000455547201222, "entropy_coeff": 0.00933429}, "model": {}, "num_grad_updates_lifetime": 4805.5, "diff_num_grad_updates_vs_sampler_policy": 144.5}}, "num_env_steps_sampled": 141330, "num_env_steps_trained": 141330, "num_agent_steps_sampled": 141330, "num_agent_steps_trained": 141330}, "sampler_results": {"episode_reward_max": 34.78064349531646, "episode_reward_min": -34.696468383578875, "episode_reward_mean": 4.7023683285738915, "episode_len_mean": 602.87, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.428572450263511, -3.648544893700363, 9.204599962787096, -7.695753267602488, 6.897185239300707, 8.62206240622611, -0.595224740129956, 20.48389386698618, 4.790706421001384, 7.1123777742152825, 27.256058287807736, 9.278952057245275, 4.541592343953493, 9.932599420230668, 12.302033978358661, 8.004495295767914, -3.290972773424759, 33.18750957842652, -13.309997493687925, -25.115762962852912, 22.100194476040613, 1.6982205736581093, 3.6801282484616014, 16.527842078867195, 29.982037056391675, -18.10326448468074, 14.717400827613085, 6.304438208034659, -21.704781804119254, -13.252508705168474, -21.818539355988598, 13.546093792238402, -22.440536632272924, 13.632040034743813, 2.6715088138572547, -11.33330488278149, 19.110810986329188, -8.581327050926381, 19.08373467835752, 10.420590836719775, 20.66185201456059, 13.76594330295737, -17.125922806022615, 0.8935859514955857, -9.264852054968859, 2.9659158459242434, 0.26867545747603483, 8.580587010218128, 22.043452145107896, -18.81713244464297, 22.631988087046125, 8.017894819369626, 3.90272330758649, 21.144722494498662, 4.151500946384602, -5.429771430453831, -34.696468383578875, 11.097429442962152, 19.359626707017387, 14.25703140982592, -9.754102149454488, 32.06893024050207, -7.202307005845971, 12.757069167044461, 15.001014993683793, 13.86512815648641, 11.349515703888436, 34.53429120015461, 11.67787930707685, 9.82674956001443, 6.76101779602767, 20.129702664270752, 1.910762857535357, 1.3285500477632635, 6.716527079297141, 5.777991645438141, -26.679089532573844, -10.920129521699957, 5.305579697238197, -2.577226912407001, 7.048698535269832, 16.586210465738198, 9.092632676878088, -0.8114796562306037, 1.6917030170984941, 26.75540815727931, 4.249388866572714, 6.522323430400893, 1.3584235405928262, 34.78064349531646, 0.07624777619890599, -13.426964370562853, -23.075208877731626, -4.338973636352817, 11.442176518628553, -4.485539178753598, 9.69553858332074, -16.76785429175129, 8.886599227563716, 17.900206014689065], "episode_lengths": [870, 762, 288, 797, 390, 268, 629, 1117, 373, 653, 1117, 1117, 763, 260, 269, 303, 831, 1117, 406, 470, 259, 688, 91, 1117, 945, 520, 268, 828, 698, 406, 605, 269, 487, 1117, 295, 797, 1117, 374, 269, 252, 295, 260, 611, 379, 822, 365, 406, 91, 1117, 409, 295, 295, 934, 299, 233, 392, 614, 351, 1117, 1117, 410, 1117, 875, 1117, 234, 1117, 233, 1117, 295, 1117, 295, 1117, 1094, 373, 295, 653, 662, 411, 1117, 381, 261, 269, 295, 406, 1117, 1117, 295, 350, 674, 1117, 654, 809, 944, 406, 288, 372, 945, 770, 269, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0012228234413563, "mean_inference_ms": 6.62268329270248, "mean_action_processing_ms": 0.4502525721080252, "mean_env_wait_ms": 20.084503964467437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019053220748901367, "StateBufferConnector_ms": 0.01415872573852539, "ViewRequirementAgentConnector_ms": 0.753260612487793}}, "episode_reward_max": 34.78064349531646, "episode_reward_min": -34.696468383578875, "episode_reward_mean": 4.7023683285738915, "episode_len_mean": 602.87, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.428572450263511, -3.648544893700363, 9.204599962787096, -7.695753267602488, 6.897185239300707, 8.62206240622611, -0.595224740129956, 20.48389386698618, 4.790706421001384, 7.1123777742152825, 27.256058287807736, 9.278952057245275, 4.541592343953493, 9.932599420230668, 12.302033978358661, 8.004495295767914, -3.290972773424759, 33.18750957842652, -13.309997493687925, -25.115762962852912, 22.100194476040613, 1.6982205736581093, 3.6801282484616014, 16.527842078867195, 29.982037056391675, -18.10326448468074, 14.717400827613085, 6.304438208034659, -21.704781804119254, -13.252508705168474, -21.818539355988598, 13.546093792238402, -22.440536632272924, 13.632040034743813, 2.6715088138572547, -11.33330488278149, 19.110810986329188, -8.581327050926381, 19.08373467835752, 10.420590836719775, 20.66185201456059, 13.76594330295737, -17.125922806022615, 0.8935859514955857, -9.264852054968859, 2.9659158459242434, 0.26867545747603483, 8.580587010218128, 22.043452145107896, -18.81713244464297, 22.631988087046125, 8.017894819369626, 3.90272330758649, 21.144722494498662, 4.151500946384602, -5.429771430453831, -34.696468383578875, 11.097429442962152, 19.359626707017387, 14.25703140982592, -9.754102149454488, 32.06893024050207, -7.202307005845971, 12.757069167044461, 15.001014993683793, 13.86512815648641, 11.349515703888436, 34.53429120015461, 11.67787930707685, 9.82674956001443, 6.76101779602767, 20.129702664270752, 1.910762857535357, 1.3285500477632635, 6.716527079297141, 5.777991645438141, -26.679089532573844, -10.920129521699957, 5.305579697238197, -2.577226912407001, 7.048698535269832, 16.586210465738198, 9.092632676878088, -0.8114796562306037, 1.6917030170984941, 26.75540815727931, 4.249388866572714, 6.522323430400893, 1.3584235405928262, 34.78064349531646, 0.07624777619890599, -13.426964370562853, -23.075208877731626, -4.338973636352817, 11.442176518628553, -4.485539178753598, 9.69553858332074, -16.76785429175129, 8.886599227563716, 17.900206014689065], "episode_lengths": [870, 762, 288, 797, 390, 268, 629, 1117, 373, 653, 1117, 1117, 763, 260, 269, 303, 831, 1117, 406, 470, 259, 688, 91, 1117, 945, 520, 268, 828, 698, 406, 605, 269, 487, 1117, 295, 797, 1117, 374, 269, 252, 295, 260, 611, 379, 822, 365, 406, 91, 1117, 409, 295, 295, 934, 299, 233, 392, 614, 351, 1117, 1117, 410, 1117, 875, 1117, 234, 1117, 233, 1117, 295, 1117, 295, 1117, 1094, 373, 295, 653, 662, 411, 1117, 381, 261, 269, 295, 406, 1117, 1117, 295, 350, 674, 1117, 654, 809, 944, 406, 288, 372, 945, 770, 269, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0012228234413563, "mean_inference_ms": 6.62268329270248, "mean_action_processing_ms": 0.4502525721080252, "mean_env_wait_ms": 20.084503964467437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019053220748901367, "StateBufferConnector_ms": 0.01415872573852539, "ViewRequirementAgentConnector_ms": 0.753260612487793}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141330, "num_agent_steps_trained": 141330, "num_env_steps_sampled": 141330, "num_env_steps_trained": 141330, "num_env_steps_sampled_this_iter": 8188, "num_env_steps_trained_this_iter": 8188, "num_env_steps_sampled_throughput_per_sec": 215.53308363148108, "num_env_steps_trained_throughput_per_sec": 215.53308363148108, "timesteps_total": 141330, "num_steps_trained_this_iter": 8188, "agent_timesteps_total": 141330, "timers": {"training_iteration_time_ms": 39250.53, "sample_time_ms": 27622.43, "load_time_ms": 1615.773, "load_throughput": 5046.811, "learn_time_ms": 9500.539, "learn_throughput": 858.32, "synch_weights_time_ms": 441.857}, "counters": {"num_env_steps_sampled": 141330, "num_env_steps_trained": 141330, "num_agent_steps_sampled": 141330, "num_agent_steps_trained": 141330}, "done": false, "episodes_total": 269, "training_iteration": 19, "trial_id": "32ccc_00000", "date": "2025-06-07_12-12-51", "timestamp": 1749291171, "time_this_iter_s": 38.00552749633789, "time_total_s": 696.1667764186859, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 696.1667764186859, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 55.673913043478244, "ram_util_percent": 83.84782608695654, "gpu_util_percent0": 0.11413043478260868, "vram_util_percent0": 0.9679361979166663}}
{"evaluation": {"sampler_results": {"episode_reward_max": 15.445654510678082, "episode_reward_min": 10.63674709791442, "episode_reward_mean": 12.999043083918991, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.445654510678082, 14.46715937774882, 12.917558227756984, 11.528096205496647, 10.63674709791442], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5055611365389268, "mean_inference_ms": 3.504707268047177, "mean_action_processing_ms": 0.2623547166019338, "mean_env_wait_ms": 10.431064334270554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019960403442382812, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.06020545959472656}}, "episode_reward_max": 15.445654510678082, "episode_reward_min": 10.63674709791442, "episode_reward_mean": 12.999043083918991, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.445654510678082, 14.46715937774882, 12.917558227756984, 11.528096205496647, 10.63674709791442], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5055611365389268, "mean_inference_ms": 3.504707268047177, "mean_action_processing_ms": 0.2623547166019338, "mean_env_wait_ms": 10.431064334270554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019960403442382812, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.06020545959472656}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.858670000000002e-05, "total_loss": -0.12395895331376983, "policy_loss": -0.01623473156303648, "vf_loss": 0.10379657437123599, "vf_explained_var": 0.9370852101233698, "kl": 0.008217699915000263, "entropy": 15.052742687348397, "entropy_coeff": 0.00929335}, "model": {}, "num_grad_updates_lifetime": 5105.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 150024, "num_env_steps_trained": 150024, "num_agent_steps_sampled": 150024, "num_agent_steps_trained": 150024}, "sampler_results": {"episode_reward_max": 34.78064349531646, "episode_reward_min": -63.84584003085472, "episode_reward_mean": 2.943168087029816, "episode_len_mean": 595.77, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.302033978358661, 8.004495295767914, -3.290972773424759, 33.18750957842652, -13.309997493687925, -25.115762962852912, 22.100194476040613, 1.6982205736581093, 3.6801282484616014, 16.527842078867195, 29.982037056391675, -18.10326448468074, 14.717400827613085, 6.304438208034659, -21.704781804119254, -13.252508705168474, -21.818539355988598, 13.546093792238402, -22.440536632272924, 13.632040034743813, 2.6715088138572547, -11.33330488278149, 19.110810986329188, -8.581327050926381, 19.08373467835752, 10.420590836719775, 20.66185201456059, 13.76594330295737, -17.125922806022615, 0.8935859514955857, -9.264852054968859, 2.9659158459242434, 0.26867545747603483, 8.580587010218128, 22.043452145107896, -18.81713244464297, 22.631988087046125, 8.017894819369626, 3.90272330758649, 21.144722494498662, 4.151500946384602, -5.429771430453831, -34.696468383578875, 11.097429442962152, 19.359626707017387, 14.25703140982592, -9.754102149454488, 32.06893024050207, -7.202307005845971, 12.757069167044461, 15.001014993683793, 13.86512815648641, 11.349515703888436, 34.53429120015461, 11.67787930707685, 9.82674956001443, 6.76101779602767, 20.129702664270752, 1.910762857535357, 1.3285500477632635, 6.716527079297141, 5.777991645438141, -26.679089532573844, -10.920129521699957, 5.305579697238197, -2.577226912407001, 7.048698535269832, 16.586210465738198, 9.092632676878088, -0.8114796562306037, 1.6917030170984941, 26.75540815727931, 4.249388866572714, 6.522323430400893, 1.3584235405928262, 34.78064349531646, 0.07624777619890599, -13.426964370562853, -23.075208877731626, -4.338973636352817, 11.442176518628553, -4.485539178753598, 9.69553858332074, -16.76785429175129, 8.886599227563716, 17.900206014689065, -63.84584003085472, 16.084137832153065, -4.427672428986455, -12.504587593946832, 7.0449284307653315, -24.79510041281373, 4.704746692695923, -8.289889172655151, 13.544863137705665, -12.742575743835088, 11.623631501933875, -0.20440453018418225, 10.311931345971379, -23.672260754298993], "episode_lengths": [269, 303, 831, 1117, 406, 470, 259, 688, 91, 1117, 945, 520, 268, 828, 698, 406, 605, 269, 487, 1117, 295, 797, 1117, 374, 269, 252, 295, 260, 611, 379, 822, 365, 406, 91, 1117, 409, 295, 295, 934, 299, 233, 392, 614, 351, 1117, 1117, 410, 1117, 875, 1117, 234, 1117, 233, 1117, 295, 1117, 295, 1117, 1094, 373, 295, 653, 662, 411, 1117, 381, 261, 269, 295, 406, 1117, 1117, 295, 350, 674, 1117, 654, 809, 944, 406, 288, 372, 945, 770, 269, 295, 653, 1117, 1117, 881, 373, 617, 297, 657, 1117, 353, 270, 406, 269, 567]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9993851537303515, "mean_inference_ms": 6.61556654158762, "mean_action_processing_ms": 0.4496693462250246, "mean_env_wait_ms": 20.0628275289313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02307605743408203, "StateBufferConnector_ms": 0.02725982666015625, "ViewRequirementAgentConnector_ms": 0.781304121017456}}, "episode_reward_max": 34.78064349531646, "episode_reward_min": -63.84584003085472, "episode_reward_mean": 2.943168087029816, "episode_len_mean": 595.77, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.302033978358661, 8.004495295767914, -3.290972773424759, 33.18750957842652, -13.309997493687925, -25.115762962852912, 22.100194476040613, 1.6982205736581093, 3.6801282484616014, 16.527842078867195, 29.982037056391675, -18.10326448468074, 14.717400827613085, 6.304438208034659, -21.704781804119254, -13.252508705168474, -21.818539355988598, 13.546093792238402, -22.440536632272924, 13.632040034743813, 2.6715088138572547, -11.33330488278149, 19.110810986329188, -8.581327050926381, 19.08373467835752, 10.420590836719775, 20.66185201456059, 13.76594330295737, -17.125922806022615, 0.8935859514955857, -9.264852054968859, 2.9659158459242434, 0.26867545747603483, 8.580587010218128, 22.043452145107896, -18.81713244464297, 22.631988087046125, 8.017894819369626, 3.90272330758649, 21.144722494498662, 4.151500946384602, -5.429771430453831, -34.696468383578875, 11.097429442962152, 19.359626707017387, 14.25703140982592, -9.754102149454488, 32.06893024050207, -7.202307005845971, 12.757069167044461, 15.001014993683793, 13.86512815648641, 11.349515703888436, 34.53429120015461, 11.67787930707685, 9.82674956001443, 6.76101779602767, 20.129702664270752, 1.910762857535357, 1.3285500477632635, 6.716527079297141, 5.777991645438141, -26.679089532573844, -10.920129521699957, 5.305579697238197, -2.577226912407001, 7.048698535269832, 16.586210465738198, 9.092632676878088, -0.8114796562306037, 1.6917030170984941, 26.75540815727931, 4.249388866572714, 6.522323430400893, 1.3584235405928262, 34.78064349531646, 0.07624777619890599, -13.426964370562853, -23.075208877731626, -4.338973636352817, 11.442176518628553, -4.485539178753598, 9.69553858332074, -16.76785429175129, 8.886599227563716, 17.900206014689065, -63.84584003085472, 16.084137832153065, -4.427672428986455, -12.504587593946832, 7.0449284307653315, -24.79510041281373, 4.704746692695923, -8.289889172655151, 13.544863137705665, -12.742575743835088, 11.623631501933875, -0.20440453018418225, 10.311931345971379, -23.672260754298993], "episode_lengths": [269, 303, 831, 1117, 406, 470, 259, 688, 91, 1117, 945, 520, 268, 828, 698, 406, 605, 269, 487, 1117, 295, 797, 1117, 374, 269, 252, 295, 260, 611, 379, 822, 365, 406, 91, 1117, 409, 295, 295, 934, 299, 233, 392, 614, 351, 1117, 1117, 410, 1117, 875, 1117, 234, 1117, 233, 1117, 295, 1117, 295, 1117, 1094, 373, 295, 653, 662, 411, 1117, 381, 261, 269, 295, 406, 1117, 1117, 295, 350, 674, 1117, 654, 809, 944, 406, 288, 372, 945, 770, 269, 295, 653, 1117, 1117, 881, 373, 617, 297, 657, 1117, 353, 270, 406, 269, 567]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9993851537303515, "mean_inference_ms": 6.61556654158762, "mean_action_processing_ms": 0.4496693462250246, "mean_env_wait_ms": 20.0628275289313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02307605743408203, "StateBufferConnector_ms": 0.02725982666015625, "ViewRequirementAgentConnector_ms": 0.781304121017456}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150024, "num_agent_steps_trained": 150024, "num_env_steps_sampled": 150024, "num_env_steps_trained": 150024, "num_env_steps_sampled_this_iter": 8694, "num_env_steps_trained_this_iter": 8694, "num_env_steps_sampled_throughput_per_sec": 206.34535301144663, "num_env_steps_trained_throughput_per_sec": 206.34535301144663, "timesteps_total": 150024, "num_steps_trained_this_iter": 8694, "agent_timesteps_total": 150024, "timers": {"training_iteration_time_ms": 40373.059, "sample_time_ms": 28002.648, "load_time_ms": 1653.662, "load_throughput": 5085.682, "learn_time_ms": 10203.703, "learn_throughput": 824.211, "synch_weights_time_ms": 442.117}, "counters": {"num_env_steps_sampled": 150024, "num_env_steps_trained": 150024, "num_agent_steps_sampled": 150024, "num_agent_steps_trained": 150024}, "done": false, "episodes_total": 283, "training_iteration": 20, "trial_id": "32ccc_00000", "date": "2025-06-07_12-13-47", "timestamp": 1749291227, "time_this_iter_s": 56.43018436431885, "time_total_s": 752.5969607830048, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 752.5969607830048, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 44.44782608695653, "ram_util_percent": 83.80724637681162, "gpu_util_percent0": 0.12579710144927536, "vram_util_percent0": 0.9679361979166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.849975999999999e-05, "total_loss": -0.12358616368534664, "policy_loss": -0.014832242992189196, "vf_loss": 0.09988380437716841, "vf_explained_var": 0.9380641087337777, "kl": 0.009006410995412616, "entropy": 15.118560225875289, "entropy_coeff": 0.00924988}, "model": {}, "num_grad_updates_lifetime": 5395.5, "diff_num_grad_updates_vs_sampler_policy": 134.5}}, "num_env_steps_sampled": 157849, "num_env_steps_trained": 157849, "num_agent_steps_sampled": 157849, "num_agent_steps_trained": 157849}, "sampler_results": {"episode_reward_max": 34.78064349531646, "episode_reward_min": -63.84584003085472, "episode_reward_mean": 2.2611721064758536, "episode_len_mean": 592.9, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.704781804119254, -13.252508705168474, -21.818539355988598, 13.546093792238402, -22.440536632272924, 13.632040034743813, 2.6715088138572547, -11.33330488278149, 19.110810986329188, -8.581327050926381, 19.08373467835752, 10.420590836719775, 20.66185201456059, 13.76594330295737, -17.125922806022615, 0.8935859514955857, -9.264852054968859, 2.9659158459242434, 0.26867545747603483, 8.580587010218128, 22.043452145107896, -18.81713244464297, 22.631988087046125, 8.017894819369626, 3.90272330758649, 21.144722494498662, 4.151500946384602, -5.429771430453831, -34.696468383578875, 11.097429442962152, 19.359626707017387, 14.25703140982592, -9.754102149454488, 32.06893024050207, -7.202307005845971, 12.757069167044461, 15.001014993683793, 13.86512815648641, 11.349515703888436, 34.53429120015461, 11.67787930707685, 9.82674956001443, 6.76101779602767, 20.129702664270752, 1.910762857535357, 1.3285500477632635, 6.716527079297141, 5.777991645438141, -26.679089532573844, -10.920129521699957, 5.305579697238197, -2.577226912407001, 7.048698535269832, 16.586210465738198, 9.092632676878088, -0.8114796562306037, 1.6917030170984941, 26.75540815727931, 4.249388866572714, 6.522323430400893, 1.3584235405928262, 34.78064349531646, 0.07624777619890599, -13.426964370562853, -23.075208877731626, -4.338973636352817, 11.442176518628553, -4.485539178753598, 9.69553858332074, -16.76785429175129, 8.886599227563716, 17.900206014689065, -63.84584003085472, 16.084137832153065, -4.427672428986455, -12.504587593946832, 7.0449284307653315, -24.79510041281373, 4.704746692695923, -8.289889172655151, 13.544863137705665, -12.742575743835088, 11.623631501933875, -0.20440453018418225, 10.311931345971379, -23.672260754298993, 11.281901313049756, 18.8997428692589, 11.454167113658222, 21.478860922092267, -22.183894965318423, -12.354900028654107, 15.589064057249708, -24.182306880067976, -25.202844653817277, 13.912301321537523, 14.904827424849898, 0.9809076093745412, 1.421530515443452, -5.514652067079093], "episode_lengths": [698, 406, 605, 269, 487, 1117, 295, 797, 1117, 374, 269, 252, 295, 260, 611, 379, 822, 365, 406, 91, 1117, 409, 295, 295, 934, 299, 233, 392, 614, 351, 1117, 1117, 410, 1117, 875, 1117, 234, 1117, 233, 1117, 295, 1117, 295, 1117, 1094, 373, 295, 653, 662, 411, 1117, 381, 261, 269, 295, 406, 1117, 1117, 295, 350, 674, 1117, 654, 809, 944, 406, 288, 372, 945, 770, 269, 295, 653, 1117, 1117, 881, 373, 617, 297, 657, 1117, 353, 270, 406, 269, 567, 232, 295, 295, 1117, 439, 629, 258, 469, 441, 297, 1117, 1117, 320, 799]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9986174042070644, "mean_inference_ms": 6.609760073248535, "mean_action_processing_ms": 0.449536862491414, "mean_env_wait_ms": 20.05611706281754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02574014663696289, "StateBufferConnector_ms": 0.026257038116455078, "ViewRequirementAgentConnector_ms": 0.7722280025482178}}, "episode_reward_max": 34.78064349531646, "episode_reward_min": -63.84584003085472, "episode_reward_mean": 2.2611721064758536, "episode_len_mean": 592.9, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.704781804119254, -13.252508705168474, -21.818539355988598, 13.546093792238402, -22.440536632272924, 13.632040034743813, 2.6715088138572547, -11.33330488278149, 19.110810986329188, -8.581327050926381, 19.08373467835752, 10.420590836719775, 20.66185201456059, 13.76594330295737, -17.125922806022615, 0.8935859514955857, -9.264852054968859, 2.9659158459242434, 0.26867545747603483, 8.580587010218128, 22.043452145107896, -18.81713244464297, 22.631988087046125, 8.017894819369626, 3.90272330758649, 21.144722494498662, 4.151500946384602, -5.429771430453831, -34.696468383578875, 11.097429442962152, 19.359626707017387, 14.25703140982592, -9.754102149454488, 32.06893024050207, -7.202307005845971, 12.757069167044461, 15.001014993683793, 13.86512815648641, 11.349515703888436, 34.53429120015461, 11.67787930707685, 9.82674956001443, 6.76101779602767, 20.129702664270752, 1.910762857535357, 1.3285500477632635, 6.716527079297141, 5.777991645438141, -26.679089532573844, -10.920129521699957, 5.305579697238197, -2.577226912407001, 7.048698535269832, 16.586210465738198, 9.092632676878088, -0.8114796562306037, 1.6917030170984941, 26.75540815727931, 4.249388866572714, 6.522323430400893, 1.3584235405928262, 34.78064349531646, 0.07624777619890599, -13.426964370562853, -23.075208877731626, -4.338973636352817, 11.442176518628553, -4.485539178753598, 9.69553858332074, -16.76785429175129, 8.886599227563716, 17.900206014689065, -63.84584003085472, 16.084137832153065, -4.427672428986455, -12.504587593946832, 7.0449284307653315, -24.79510041281373, 4.704746692695923, -8.289889172655151, 13.544863137705665, -12.742575743835088, 11.623631501933875, -0.20440453018418225, 10.311931345971379, -23.672260754298993, 11.281901313049756, 18.8997428692589, 11.454167113658222, 21.478860922092267, -22.183894965318423, -12.354900028654107, 15.589064057249708, -24.182306880067976, -25.202844653817277, 13.912301321537523, 14.904827424849898, 0.9809076093745412, 1.421530515443452, -5.514652067079093], "episode_lengths": [698, 406, 605, 269, 487, 1117, 295, 797, 1117, 374, 269, 252, 295, 260, 611, 379, 822, 365, 406, 91, 1117, 409, 295, 295, 934, 299, 233, 392, 614, 351, 1117, 1117, 410, 1117, 875, 1117, 234, 1117, 233, 1117, 295, 1117, 295, 1117, 1094, 373, 295, 653, 662, 411, 1117, 381, 261, 269, 295, 406, 1117, 1117, 295, 350, 674, 1117, 654, 809, 944, 406, 288, 372, 945, 770, 269, 295, 653, 1117, 1117, 881, 373, 617, 297, 657, 1117, 353, 270, 406, 269, 567, 232, 295, 295, 1117, 439, 629, 258, 469, 441, 297, 1117, 1117, 320, 799]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9986174042070644, "mean_inference_ms": 6.609760073248535, "mean_action_processing_ms": 0.449536862491414, "mean_env_wait_ms": 20.05611706281754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02574014663696289, "StateBufferConnector_ms": 0.026257038116455078, "ViewRequirementAgentConnector_ms": 0.7722280025482178}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157849, "num_agent_steps_trained": 157849, "num_env_steps_sampled": 157849, "num_env_steps_trained": 157849, "num_env_steps_sampled_this_iter": 7825, "num_env_steps_trained_this_iter": 7825, "num_env_steps_sampled_throughput_per_sec": 211.13480431813025, "num_env_steps_trained_throughput_per_sec": 211.13480431813025, "timesteps_total": 157849, "num_steps_trained_this_iter": 7825, "agent_timesteps_total": 157849, "timers": {"training_iteration_time_ms": 41189.418, "sample_time_ms": 28512.687, "load_time_ms": 1653.086, "load_throughput": 5143.472, "learn_time_ms": 10509.387, "learn_throughput": 809.048, "synch_weights_time_ms": 442.74}, "counters": {"num_env_steps_sampled": 157849, "num_env_steps_trained": 157849, "num_agent_steps_sampled": 157849, "num_agent_steps_trained": 157849}, "done": false, "episodes_total": 297, "training_iteration": 21, "trial_id": "32ccc_00000", "date": "2025-06-07_12-14-25", "timestamp": 1749291265, "time_this_iter_s": 37.079627990722656, "time_total_s": 789.6765887737274, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 789.6765887737274, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 53.52954545454545, "ram_util_percent": 83.62272727272729, "gpu_util_percent0": 0.11113636363636364, "vram_util_percent0": 0.9679361979166664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.842151000000002e-05, "total_loss": -0.14943557214393313, "policy_loss": -0.037851101593696514, "vf_loss": 0.0887383233370452, "vf_explained_var": 0.926166555799287, "kl": 0.00873378521039207, "entropy": 15.12337386361484, "entropy_coeff": 0.009210755000000001}, "model": {}, "num_grad_updates_lifetime": 5675.5, "diff_num_grad_updates_vs_sampler_policy": 144.5}}, "num_env_steps_sampled": 166155, "num_env_steps_trained": 166155, "num_agent_steps_sampled": 166155, "num_agent_steps_trained": 166155}, "sampler_results": {"episode_reward_max": 44.830816067975135, "episode_reward_min": -63.84584003085472, "episode_reward_mean": 3.04151197436631, "episode_len_mean": 603.55, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.125922806022615, 0.8935859514955857, -9.264852054968859, 2.9659158459242434, 0.26867545747603483, 8.580587010218128, 22.043452145107896, -18.81713244464297, 22.631988087046125, 8.017894819369626, 3.90272330758649, 21.144722494498662, 4.151500946384602, -5.429771430453831, -34.696468383578875, 11.097429442962152, 19.359626707017387, 14.25703140982592, -9.754102149454488, 32.06893024050207, -7.202307005845971, 12.757069167044461, 15.001014993683793, 13.86512815648641, 11.349515703888436, 34.53429120015461, 11.67787930707685, 9.82674956001443, 6.76101779602767, 20.129702664270752, 1.910762857535357, 1.3285500477632635, 6.716527079297141, 5.777991645438141, -26.679089532573844, -10.920129521699957, 5.305579697238197, -2.577226912407001, 7.048698535269832, 16.586210465738198, 9.092632676878088, -0.8114796562306037, 1.6917030170984941, 26.75540815727931, 4.249388866572714, 6.522323430400893, 1.3584235405928262, 34.78064349531646, 0.07624777619890599, -13.426964370562853, -23.075208877731626, -4.338973636352817, 11.442176518628553, -4.485539178753598, 9.69553858332074, -16.76785429175129, 8.886599227563716, 17.900206014689065, -63.84584003085472, 16.084137832153065, -4.427672428986455, -12.504587593946832, 7.0449284307653315, -24.79510041281373, 4.704746692695923, -8.289889172655151, 13.544863137705665, -12.742575743835088, 11.623631501933875, -0.20440453018418225, 10.311931345971379, -23.672260754298993, 11.281901313049756, 18.8997428692589, 11.454167113658222, 21.478860922092267, -22.183894965318423, -12.354900028654107, 15.589064057249708, -24.182306880067976, -25.202844653817277, 13.912301321537523, 14.904827424849898, 0.9809076093745412, 1.421530515443452, -5.514652067079093, -12.53221627510547, 16.74415640252303, -10.653920241584164, 44.830816067975135, 13.578124976989516, -10.345318428323319, 17.382143342581816, -0.01004770332086491, 9.785533147847127, -4.613856907323192, 11.195633069348688, -2.2837484452030377, 5.895643050988263, 12.822620760158998], "episode_lengths": [611, 379, 822, 365, 406, 91, 1117, 409, 295, 295, 934, 299, 233, 392, 614, 351, 1117, 1117, 410, 1117, 875, 1117, 234, 1117, 233, 1117, 295, 1117, 295, 1117, 1094, 373, 295, 653, 662, 411, 1117, 381, 261, 269, 295, 406, 1117, 1117, 295, 350, 674, 1117, 654, 809, 944, 406, 288, 372, 945, 770, 269, 295, 653, 1117, 1117, 881, 373, 617, 297, 657, 1117, 353, 270, 406, 269, 567, 232, 295, 295, 1117, 439, 629, 258, 469, 441, 297, 1117, 1117, 320, 799, 896, 269, 371, 1117, 795, 768, 1117, 317, 223, 610, 305, 400, 170, 948]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9972862664274607, "mean_inference_ms": 6.604822323065454, "mean_action_processing_ms": 0.4494294798267069, "mean_env_wait_ms": 20.03544728474129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02232837677001953, "StateBufferConnector_ms": 0.025227069854736328, "ViewRequirementAgentConnector_ms": 0.7676191329956055}}, "episode_reward_max": 44.830816067975135, "episode_reward_min": -63.84584003085472, "episode_reward_mean": 3.04151197436631, "episode_len_mean": 603.55, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.125922806022615, 0.8935859514955857, -9.264852054968859, 2.9659158459242434, 0.26867545747603483, 8.580587010218128, 22.043452145107896, -18.81713244464297, 22.631988087046125, 8.017894819369626, 3.90272330758649, 21.144722494498662, 4.151500946384602, -5.429771430453831, -34.696468383578875, 11.097429442962152, 19.359626707017387, 14.25703140982592, -9.754102149454488, 32.06893024050207, -7.202307005845971, 12.757069167044461, 15.001014993683793, 13.86512815648641, 11.349515703888436, 34.53429120015461, 11.67787930707685, 9.82674956001443, 6.76101779602767, 20.129702664270752, 1.910762857535357, 1.3285500477632635, 6.716527079297141, 5.777991645438141, -26.679089532573844, -10.920129521699957, 5.305579697238197, -2.577226912407001, 7.048698535269832, 16.586210465738198, 9.092632676878088, -0.8114796562306037, 1.6917030170984941, 26.75540815727931, 4.249388866572714, 6.522323430400893, 1.3584235405928262, 34.78064349531646, 0.07624777619890599, -13.426964370562853, -23.075208877731626, -4.338973636352817, 11.442176518628553, -4.485539178753598, 9.69553858332074, -16.76785429175129, 8.886599227563716, 17.900206014689065, -63.84584003085472, 16.084137832153065, -4.427672428986455, -12.504587593946832, 7.0449284307653315, -24.79510041281373, 4.704746692695923, -8.289889172655151, 13.544863137705665, -12.742575743835088, 11.623631501933875, -0.20440453018418225, 10.311931345971379, -23.672260754298993, 11.281901313049756, 18.8997428692589, 11.454167113658222, 21.478860922092267, -22.183894965318423, -12.354900028654107, 15.589064057249708, -24.182306880067976, -25.202844653817277, 13.912301321537523, 14.904827424849898, 0.9809076093745412, 1.421530515443452, -5.514652067079093, -12.53221627510547, 16.74415640252303, -10.653920241584164, 44.830816067975135, 13.578124976989516, -10.345318428323319, 17.382143342581816, -0.01004770332086491, 9.785533147847127, -4.613856907323192, 11.195633069348688, -2.2837484452030377, 5.895643050988263, 12.822620760158998], "episode_lengths": [611, 379, 822, 365, 406, 91, 1117, 409, 295, 295, 934, 299, 233, 392, 614, 351, 1117, 1117, 410, 1117, 875, 1117, 234, 1117, 233, 1117, 295, 1117, 295, 1117, 1094, 373, 295, 653, 662, 411, 1117, 381, 261, 269, 295, 406, 1117, 1117, 295, 350, 674, 1117, 654, 809, 944, 406, 288, 372, 945, 770, 269, 295, 653, 1117, 1117, 881, 373, 617, 297, 657, 1117, 353, 270, 406, 269, 567, 232, 295, 295, 1117, 439, 629, 258, 469, 441, 297, 1117, 1117, 320, 799, 896, 269, 371, 1117, 795, 768, 1117, 317, 223, 610, 305, 400, 170, 948]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9972862664274607, "mean_inference_ms": 6.604822323065454, "mean_action_processing_ms": 0.4494294798267069, "mean_env_wait_ms": 20.03544728474129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02232837677001953, "StateBufferConnector_ms": 0.025227069854736328, "ViewRequirementAgentConnector_ms": 0.7676191329956055}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166155, "num_agent_steps_trained": 166155, "num_env_steps_sampled": 166155, "num_env_steps_trained": 166155, "num_env_steps_sampled_this_iter": 8306, "num_env_steps_trained_this_iter": 8306, "num_env_steps_sampled_throughput_per_sec": 208.62962515859718, "num_env_steps_trained_throughput_per_sec": 208.62962515859718, "timesteps_total": 166155, "num_steps_trained_this_iter": 8306, "agent_timesteps_total": 166155, "timers": {"training_iteration_time_ms": 41035.849, "sample_time_ms": 28539.477, "load_time_ms": 1525.153, "load_throughput": 5580.554, "learn_time_ms": 10489.388, "learn_throughput": 811.411, "synch_weights_time_ms": 409.655}, "counters": {"num_env_steps_sampled": 166155, "num_env_steps_trained": 166155, "num_agent_steps_sampled": 166155, "num_agent_steps_trained": 166155}, "done": false, "episodes_total": 311, "training_iteration": 22, "trial_id": "32ccc_00000", "date": "2025-06-07_12-15-05", "timestamp": 1749291305, "time_this_iter_s": 39.82920598983765, "time_total_s": 829.5057947635651, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 829.5057947635651, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 52.75625, "ram_util_percent": 84.17291666666667, "gpu_util_percent0": 0.139375, "vram_util_percent0": 0.9679361979166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.833845000000002e-05, "total_loss": -0.12703970901267087, "policy_loss": -0.01606558054304009, "vf_loss": 0.08875030033393866, "vf_explained_var": 0.9345416300826602, "kl": 0.009275379962310404, "entropy": 15.133083764712016, "entropy_coeff": 0.009169225000000001}, "model": {}, "num_grad_updates_lifetime": 6000.5, "diff_num_grad_updates_vs_sampler_policy": 179.5}}, "num_env_steps_sampled": 176272, "num_env_steps_trained": 176272, "num_agent_steps_sampled": 176272, "num_agent_steps_trained": 176272}, "sampler_results": {"episode_reward_max": 44.830816067975135, "episode_reward_min": -63.84584003085472, "episode_reward_mean": 3.664274170272925, "episode_len_mean": 638.24, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.696468383578875, 11.097429442962152, 19.359626707017387, 14.25703140982592, -9.754102149454488, 32.06893024050207, -7.202307005845971, 12.757069167044461, 15.001014993683793, 13.86512815648641, 11.349515703888436, 34.53429120015461, 11.67787930707685, 9.82674956001443, 6.76101779602767, 20.129702664270752, 1.910762857535357, 1.3285500477632635, 6.716527079297141, 5.777991645438141, -26.679089532573844, -10.920129521699957, 5.305579697238197, -2.577226912407001, 7.048698535269832, 16.586210465738198, 9.092632676878088, -0.8114796562306037, 1.6917030170984941, 26.75540815727931, 4.249388866572714, 6.522323430400893, 1.3584235405928262, 34.78064349531646, 0.07624777619890599, -13.426964370562853, -23.075208877731626, -4.338973636352817, 11.442176518628553, -4.485539178753598, 9.69553858332074, -16.76785429175129, 8.886599227563716, 17.900206014689065, -63.84584003085472, 16.084137832153065, -4.427672428986455, -12.504587593946832, 7.0449284307653315, -24.79510041281373, 4.704746692695923, -8.289889172655151, 13.544863137705665, -12.742575743835088, 11.623631501933875, -0.20440453018418225, 10.311931345971379, -23.672260754298993, 11.281901313049756, 18.8997428692589, 11.454167113658222, 21.478860922092267, -22.183894965318423, -12.354900028654107, 15.589064057249708, -24.182306880067976, -25.202844653817277, 13.912301321537523, 14.904827424849898, 0.9809076093745412, 1.421530515443452, -5.514652067079093, -12.53221627510547, 16.74415640252303, -10.653920241584164, 44.830816067975135, 13.578124976989516, -10.345318428323319, 17.382143342581816, -0.01004770332086491, 9.785533147847127, -4.613856907323192, 11.195633069348688, -2.2837484452030377, 5.895643050988263, 12.822620760158998, 13.087173379807679, -23.526301319807978, -7.314298413521482, 13.251785092977082, 28.743906309665437, 6.55011968867369, 14.89631625256299, 2.9482748091532085, 11.550016737632788, -3.789347402887008, 11.038203173327558, 35.261089502708096, -21.68726661441445, 25.229915723802936], "episode_lengths": [614, 351, 1117, 1117, 410, 1117, 875, 1117, 234, 1117, 233, 1117, 295, 1117, 295, 1117, 1094, 373, 295, 653, 662, 411, 1117, 381, 261, 269, 295, 406, 1117, 1117, 295, 350, 674, 1117, 654, 809, 944, 406, 288, 372, 945, 770, 269, 295, 653, 1117, 1117, 881, 373, 617, 297, 657, 1117, 353, 270, 406, 269, 567, 232, 295, 295, 1117, 439, 629, 258, 469, 441, 297, 1117, 1117, 320, 799, 896, 269, 371, 1117, 795, 768, 1117, 317, 223, 610, 305, 400, 170, 948, 1117, 733, 673, 295, 1117, 295, 918, 765, 295, 797, 230, 1117, 648, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.995486983624657, "mean_inference_ms": 6.603705682925332, "mean_action_processing_ms": 0.44934850734790416, "mean_env_wait_ms": 20.01605514145003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022358179092407227, "StateBufferConnector_ms": 0.024208784103393555, "ViewRequirementAgentConnector_ms": 0.7643013000488281}}, "episode_reward_max": 44.830816067975135, "episode_reward_min": -63.84584003085472, "episode_reward_mean": 3.664274170272925, "episode_len_mean": 638.24, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.696468383578875, 11.097429442962152, 19.359626707017387, 14.25703140982592, -9.754102149454488, 32.06893024050207, -7.202307005845971, 12.757069167044461, 15.001014993683793, 13.86512815648641, 11.349515703888436, 34.53429120015461, 11.67787930707685, 9.82674956001443, 6.76101779602767, 20.129702664270752, 1.910762857535357, 1.3285500477632635, 6.716527079297141, 5.777991645438141, -26.679089532573844, -10.920129521699957, 5.305579697238197, -2.577226912407001, 7.048698535269832, 16.586210465738198, 9.092632676878088, -0.8114796562306037, 1.6917030170984941, 26.75540815727931, 4.249388866572714, 6.522323430400893, 1.3584235405928262, 34.78064349531646, 0.07624777619890599, -13.426964370562853, -23.075208877731626, -4.338973636352817, 11.442176518628553, -4.485539178753598, 9.69553858332074, -16.76785429175129, 8.886599227563716, 17.900206014689065, -63.84584003085472, 16.084137832153065, -4.427672428986455, -12.504587593946832, 7.0449284307653315, -24.79510041281373, 4.704746692695923, -8.289889172655151, 13.544863137705665, -12.742575743835088, 11.623631501933875, -0.20440453018418225, 10.311931345971379, -23.672260754298993, 11.281901313049756, 18.8997428692589, 11.454167113658222, 21.478860922092267, -22.183894965318423, -12.354900028654107, 15.589064057249708, -24.182306880067976, -25.202844653817277, 13.912301321537523, 14.904827424849898, 0.9809076093745412, 1.421530515443452, -5.514652067079093, -12.53221627510547, 16.74415640252303, -10.653920241584164, 44.830816067975135, 13.578124976989516, -10.345318428323319, 17.382143342581816, -0.01004770332086491, 9.785533147847127, -4.613856907323192, 11.195633069348688, -2.2837484452030377, 5.895643050988263, 12.822620760158998, 13.087173379807679, -23.526301319807978, -7.314298413521482, 13.251785092977082, 28.743906309665437, 6.55011968867369, 14.89631625256299, 2.9482748091532085, 11.550016737632788, -3.789347402887008, 11.038203173327558, 35.261089502708096, -21.68726661441445, 25.229915723802936], "episode_lengths": [614, 351, 1117, 1117, 410, 1117, 875, 1117, 234, 1117, 233, 1117, 295, 1117, 295, 1117, 1094, 373, 295, 653, 662, 411, 1117, 381, 261, 269, 295, 406, 1117, 1117, 295, 350, 674, 1117, 654, 809, 944, 406, 288, 372, 945, 770, 269, 295, 653, 1117, 1117, 881, 373, 617, 297, 657, 1117, 353, 270, 406, 269, 567, 232, 295, 295, 1117, 439, 629, 258, 469, 441, 297, 1117, 1117, 320, 799, 896, 269, 371, 1117, 795, 768, 1117, 317, 223, 610, 305, 400, 170, 948, 1117, 733, 673, 295, 1117, 295, 918, 765, 295, 797, 230, 1117, 648, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.995486983624657, "mean_inference_ms": 6.603705682925332, "mean_action_processing_ms": 0.44934850734790416, "mean_env_wait_ms": 20.01605514145003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022358179092407227, "StateBufferConnector_ms": 0.024208784103393555, "ViewRequirementAgentConnector_ms": 0.7643013000488281}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176272, "num_agent_steps_trained": 176272, "num_env_steps_sampled": 176272, "num_env_steps_trained": 176272, "num_env_steps_sampled_this_iter": 10117, "num_env_steps_trained_this_iter": 10117, "num_env_steps_sampled_throughput_per_sec": 214.9274008502406, "num_env_steps_trained_throughput_per_sec": 214.9274008502406, "timesteps_total": 176272, "num_steps_trained_this_iter": 10117, "agent_timesteps_total": 176272, "timers": {"training_iteration_time_ms": 41146.761, "sample_time_ms": 28665.904, "load_time_ms": 1410.288, "load_throughput": 6085.637, "learn_time_ms": 10593.551, "learn_throughput": 810.163, "synch_weights_time_ms": 406.491}, "counters": {"num_env_steps_sampled": 176272, "num_env_steps_trained": 176272, "num_agent_steps_sampled": 176272, "num_agent_steps_trained": 176272}, "done": false, "episodes_total": 325, "training_iteration": 23, "trial_id": "32ccc_00000", "date": "2025-06-07_12-15-52", "timestamp": 1749291352, "time_this_iter_s": 47.09971737861633, "time_total_s": 876.6055121421814, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 876.6055121421814, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 56.071929824561394, "ram_util_percent": 85.03859649122805, "gpu_util_percent0": 0.1824561403508772, "vram_util_percent0": 0.9679361979166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.823728000000001e-05, "total_loss": -0.11893823366483737, "policy_loss": -0.01088677599769214, "vf_loss": 0.0967484461207842, "vf_explained_var": 0.9238694394456929, "kl": 0.008897209028083157, "entropy": 15.154469102004478, "entropy_coeff": 0.009118639999999999}, "model": {}, "num_grad_updates_lifetime": 6325.5, "diff_num_grad_updates_vs_sampler_policy": 144.5}}, "num_env_steps_sampled": 184452, "num_env_steps_trained": 184452, "num_agent_steps_sampled": 184452, "num_agent_steps_trained": 184452}, "sampler_results": {"episode_reward_max": 44.830816067975135, "episode_reward_min": -63.84584003085472, "episode_reward_mean": 2.496725163932633, "episode_len_mean": 611.73, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.76101779602767, 20.129702664270752, 1.910762857535357, 1.3285500477632635, 6.716527079297141, 5.777991645438141, -26.679089532573844, -10.920129521699957, 5.305579697238197, -2.577226912407001, 7.048698535269832, 16.586210465738198, 9.092632676878088, -0.8114796562306037, 1.6917030170984941, 26.75540815727931, 4.249388866572714, 6.522323430400893, 1.3584235405928262, 34.78064349531646, 0.07624777619890599, -13.426964370562853, -23.075208877731626, -4.338973636352817, 11.442176518628553, -4.485539178753598, 9.69553858332074, -16.76785429175129, 8.886599227563716, 17.900206014689065, -63.84584003085472, 16.084137832153065, -4.427672428986455, -12.504587593946832, 7.0449284307653315, -24.79510041281373, 4.704746692695923, -8.289889172655151, 13.544863137705665, -12.742575743835088, 11.623631501933875, -0.20440453018418225, 10.311931345971379, -23.672260754298993, 11.281901313049756, 18.8997428692589, 11.454167113658222, 21.478860922092267, -22.183894965318423, -12.354900028654107, 15.589064057249708, -24.182306880067976, -25.202844653817277, 13.912301321537523, 14.904827424849898, 0.9809076093745412, 1.421530515443452, -5.514652067079093, -12.53221627510547, 16.74415640252303, -10.653920241584164, 44.830816067975135, 13.578124976989516, -10.345318428323319, 17.382143342581816, -0.01004770332086491, 9.785533147847127, -4.613856907323192, 11.195633069348688, -2.2837484452030377, 5.895643050988263, 12.822620760158998, 13.087173379807679, -23.526301319807978, -7.314298413521482, 13.251785092977082, 28.743906309665437, 6.55011968867369, 14.89631625256299, 2.9482748091532085, 11.550016737632788, -3.789347402887008, 11.038203173327558, 35.261089502708096, -21.68726661441445, 25.229915723802936, 14.07376355223976, -21.18852372561871, -10.24607313238437, 19.446223447240108, -11.476650157999806, 5.8075685681215665, 8.136645015142587, -6.422828962069399, 8.288594277596935, -42.83853884757761, 11.717541069971615, 15.870369037469306, 9.527796995675397, 16.691000577940628], "episode_lengths": [295, 1117, 1094, 373, 295, 653, 662, 411, 1117, 381, 261, 269, 295, 406, 1117, 1117, 295, 350, 674, 1117, 654, 809, 944, 406, 288, 372, 945, 770, 269, 295, 653, 1117, 1117, 881, 373, 617, 297, 657, 1117, 353, 270, 406, 269, 567, 232, 295, 295, 1117, 439, 629, 258, 469, 441, 297, 1117, 1117, 320, 799, 896, 269, 371, 1117, 795, 768, 1117, 317, 223, 610, 305, 400, 170, 948, 1117, 733, 673, 295, 1117, 295, 918, 765, 295, 797, 230, 1117, 648, 1117, 328, 752, 763, 1117, 1117, 373, 938, 461, 295, 945, 269, 269, 288, 265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9906177963498155, "mean_inference_ms": 6.600930939108203, "mean_action_processing_ms": 0.44921667895487494, "mean_env_wait_ms": 19.99940677470557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019501686096191406, "StateBufferConnector_ms": 0.024208784103393555, "ViewRequirementAgentConnector_ms": 0.7507829666137695}}, "episode_reward_max": 44.830816067975135, "episode_reward_min": -63.84584003085472, "episode_reward_mean": 2.496725163932633, "episode_len_mean": 611.73, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.76101779602767, 20.129702664270752, 1.910762857535357, 1.3285500477632635, 6.716527079297141, 5.777991645438141, -26.679089532573844, -10.920129521699957, 5.305579697238197, -2.577226912407001, 7.048698535269832, 16.586210465738198, 9.092632676878088, -0.8114796562306037, 1.6917030170984941, 26.75540815727931, 4.249388866572714, 6.522323430400893, 1.3584235405928262, 34.78064349531646, 0.07624777619890599, -13.426964370562853, -23.075208877731626, -4.338973636352817, 11.442176518628553, -4.485539178753598, 9.69553858332074, -16.76785429175129, 8.886599227563716, 17.900206014689065, -63.84584003085472, 16.084137832153065, -4.427672428986455, -12.504587593946832, 7.0449284307653315, -24.79510041281373, 4.704746692695923, -8.289889172655151, 13.544863137705665, -12.742575743835088, 11.623631501933875, -0.20440453018418225, 10.311931345971379, -23.672260754298993, 11.281901313049756, 18.8997428692589, 11.454167113658222, 21.478860922092267, -22.183894965318423, -12.354900028654107, 15.589064057249708, -24.182306880067976, -25.202844653817277, 13.912301321537523, 14.904827424849898, 0.9809076093745412, 1.421530515443452, -5.514652067079093, -12.53221627510547, 16.74415640252303, -10.653920241584164, 44.830816067975135, 13.578124976989516, -10.345318428323319, 17.382143342581816, -0.01004770332086491, 9.785533147847127, -4.613856907323192, 11.195633069348688, -2.2837484452030377, 5.895643050988263, 12.822620760158998, 13.087173379807679, -23.526301319807978, -7.314298413521482, 13.251785092977082, 28.743906309665437, 6.55011968867369, 14.89631625256299, 2.9482748091532085, 11.550016737632788, -3.789347402887008, 11.038203173327558, 35.261089502708096, -21.68726661441445, 25.229915723802936, 14.07376355223976, -21.18852372561871, -10.24607313238437, 19.446223447240108, -11.476650157999806, 5.8075685681215665, 8.136645015142587, -6.422828962069399, 8.288594277596935, -42.83853884757761, 11.717541069971615, 15.870369037469306, 9.527796995675397, 16.691000577940628], "episode_lengths": [295, 1117, 1094, 373, 295, 653, 662, 411, 1117, 381, 261, 269, 295, 406, 1117, 1117, 295, 350, 674, 1117, 654, 809, 944, 406, 288, 372, 945, 770, 269, 295, 653, 1117, 1117, 881, 373, 617, 297, 657, 1117, 353, 270, 406, 269, 567, 232, 295, 295, 1117, 439, 629, 258, 469, 441, 297, 1117, 1117, 320, 799, 896, 269, 371, 1117, 795, 768, 1117, 317, 223, 610, 305, 400, 170, 948, 1117, 733, 673, 295, 1117, 295, 918, 765, 295, 797, 230, 1117, 648, 1117, 328, 752, 763, 1117, 1117, 373, 938, 461, 295, 945, 269, 269, 288, 265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9906177963498155, "mean_inference_ms": 6.600930939108203, "mean_action_processing_ms": 0.44921667895487494, "mean_env_wait_ms": 19.99940677470557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019501686096191406, "StateBufferConnector_ms": 0.024208784103393555, "ViewRequirementAgentConnector_ms": 0.7507829666137695}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184452, "num_agent_steps_trained": 184452, "num_env_steps_sampled": 184452, "num_env_steps_trained": 184452, "num_env_steps_sampled_this_iter": 8180, "num_env_steps_trained_this_iter": 8180, "num_env_steps_sampled_throughput_per_sec": 213.12719309794875, "num_env_steps_trained_throughput_per_sec": 213.12719309794875, "timesteps_total": 184452, "num_steps_trained_this_iter": 8180, "agent_timesteps_total": 184452, "timers": {"training_iteration_time_ms": 40426.504, "sample_time_ms": 28405.992, "load_time_ms": 1289.033, "load_throughput": 6609.218, "learn_time_ms": 10252.526, "learn_throughput": 830.966, "synch_weights_time_ms": 408.783}, "counters": {"num_env_steps_sampled": 184452, "num_env_steps_trained": 184452, "num_agent_steps_sampled": 184452, "num_agent_steps_trained": 184452}, "done": false, "episodes_total": 339, "training_iteration": 24, "trial_id": "32ccc_00000", "date": "2025-06-07_12-16-30", "timestamp": 1749291390, "time_this_iter_s": 38.396841049194336, "time_total_s": 915.0023531913757, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 915.0023531913757, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 53.45869565217393, "ram_util_percent": 84.47391304347823, "gpu_util_percent0": 0.12326086956521741, "vram_util_percent0": 0.9679361979166663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.815548000000002e-05, "total_loss": -0.11296236759118204, "policy_loss": -0.0024045617100949, "vf_loss": 0.08813010450452566, "vf_explained_var": 0.9496521723270416, "kl": 0.009937295600206458, "entropy": 15.228350050789969, "entropy_coeff": 0.009077739999999999}, "model": {}, "num_grad_updates_lifetime": 6645.5, "diff_num_grad_updates_vs_sampler_policy": 174.5}}, "num_env_steps_sampled": 194380, "num_env_steps_trained": 194380, "num_agent_steps_sampled": 194380, "num_agent_steps_trained": 194380}, "sampler_results": {"episode_reward_max": 44.830816067975135, "episode_reward_min": -63.84584003085472, "episode_reward_mean": 2.8989212233157815, "episode_len_mean": 634.72, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6917030170984941, 26.75540815727931, 4.249388866572714, 6.522323430400893, 1.3584235405928262, 34.78064349531646, 0.07624777619890599, -13.426964370562853, -23.075208877731626, -4.338973636352817, 11.442176518628553, -4.485539178753598, 9.69553858332074, -16.76785429175129, 8.886599227563716, 17.900206014689065, -63.84584003085472, 16.084137832153065, -4.427672428986455, -12.504587593946832, 7.0449284307653315, -24.79510041281373, 4.704746692695923, -8.289889172655151, 13.544863137705665, -12.742575743835088, 11.623631501933875, -0.20440453018418225, 10.311931345971379, -23.672260754298993, 11.281901313049756, 18.8997428692589, 11.454167113658222, 21.478860922092267, -22.183894965318423, -12.354900028654107, 15.589064057249708, -24.182306880067976, -25.202844653817277, 13.912301321537523, 14.904827424849898, 0.9809076093745412, 1.421530515443452, -5.514652067079093, -12.53221627510547, 16.74415640252303, -10.653920241584164, 44.830816067975135, 13.578124976989516, -10.345318428323319, 17.382143342581816, -0.01004770332086491, 9.785533147847127, -4.613856907323192, 11.195633069348688, -2.2837484452030377, 5.895643050988263, 12.822620760158998, 13.087173379807679, -23.526301319807978, -7.314298413521482, 13.251785092977082, 28.743906309665437, 6.55011968867369, 14.89631625256299, 2.9482748091532085, 11.550016737632788, -3.789347402887008, 11.038203173327558, 35.261089502708096, -21.68726661441445, 25.229915723802936, 14.07376355223976, -21.18852372561871, -10.24607313238437, 19.446223447240108, -11.476650157999806, 5.8075685681215665, 8.136645015142587, -6.422828962069399, 8.288594277596935, -42.83853884757761, 11.717541069971615, 15.870369037469306, 9.527796995675397, 16.691000577940628, -19.64530813741647, 10.509322043777974, -5.0214269127827, -14.363074016152067, 23.886572345164293, 5.230953160506586, 18.182236827923006, 11.762265368806581, 4.974772542522349, -36.02964685844383, 8.678123830940478, 43.5135419347075, 11.34346988519828, 16.86755176610816], "episode_lengths": [1117, 1117, 295, 350, 674, 1117, 654, 809, 944, 406, 288, 372, 945, 770, 269, 295, 653, 1117, 1117, 881, 373, 617, 297, 657, 1117, 353, 270, 406, 269, 567, 232, 295, 295, 1117, 439, 629, 258, 469, 441, 297, 1117, 1117, 320, 799, 896, 269, 371, 1117, 795, 768, 1117, 317, 223, 610, 305, 400, 170, 948, 1117, 733, 673, 295, 1117, 295, 918, 765, 295, 797, 230, 1117, 648, 1117, 328, 752, 763, 1117, 1117, 373, 938, 461, 295, 945, 269, 269, 288, 265, 411, 295, 391, 399, 1117, 1117, 1117, 1117, 896, 642, 286, 1117, 763, 260]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.984066773559139, "mean_inference_ms": 6.597325085124282, "mean_action_processing_ms": 0.44884238896955336, "mean_env_wait_ms": 19.981267359531692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018477916717529297, "StateBufferConnector_ms": 0.025095462799072266, "ViewRequirementAgentConnector_ms": 0.7178761959075928}}, "episode_reward_max": 44.830816067975135, "episode_reward_min": -63.84584003085472, "episode_reward_mean": 2.8989212233157815, "episode_len_mean": 634.72, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.6917030170984941, 26.75540815727931, 4.249388866572714, 6.522323430400893, 1.3584235405928262, 34.78064349531646, 0.07624777619890599, -13.426964370562853, -23.075208877731626, -4.338973636352817, 11.442176518628553, -4.485539178753598, 9.69553858332074, -16.76785429175129, 8.886599227563716, 17.900206014689065, -63.84584003085472, 16.084137832153065, -4.427672428986455, -12.504587593946832, 7.0449284307653315, -24.79510041281373, 4.704746692695923, -8.289889172655151, 13.544863137705665, -12.742575743835088, 11.623631501933875, -0.20440453018418225, 10.311931345971379, -23.672260754298993, 11.281901313049756, 18.8997428692589, 11.454167113658222, 21.478860922092267, -22.183894965318423, -12.354900028654107, 15.589064057249708, -24.182306880067976, -25.202844653817277, 13.912301321537523, 14.904827424849898, 0.9809076093745412, 1.421530515443452, -5.514652067079093, -12.53221627510547, 16.74415640252303, -10.653920241584164, 44.830816067975135, 13.578124976989516, -10.345318428323319, 17.382143342581816, -0.01004770332086491, 9.785533147847127, -4.613856907323192, 11.195633069348688, -2.2837484452030377, 5.895643050988263, 12.822620760158998, 13.087173379807679, -23.526301319807978, -7.314298413521482, 13.251785092977082, 28.743906309665437, 6.55011968867369, 14.89631625256299, 2.9482748091532085, 11.550016737632788, -3.789347402887008, 11.038203173327558, 35.261089502708096, -21.68726661441445, 25.229915723802936, 14.07376355223976, -21.18852372561871, -10.24607313238437, 19.446223447240108, -11.476650157999806, 5.8075685681215665, 8.136645015142587, -6.422828962069399, 8.288594277596935, -42.83853884757761, 11.717541069971615, 15.870369037469306, 9.527796995675397, 16.691000577940628, -19.64530813741647, 10.509322043777974, -5.0214269127827, -14.363074016152067, 23.886572345164293, 5.230953160506586, 18.182236827923006, 11.762265368806581, 4.974772542522349, -36.02964685844383, 8.678123830940478, 43.5135419347075, 11.34346988519828, 16.86755176610816], "episode_lengths": [1117, 1117, 295, 350, 674, 1117, 654, 809, 944, 406, 288, 372, 945, 770, 269, 295, 653, 1117, 1117, 881, 373, 617, 297, 657, 1117, 353, 270, 406, 269, 567, 232, 295, 295, 1117, 439, 629, 258, 469, 441, 297, 1117, 1117, 320, 799, 896, 269, 371, 1117, 795, 768, 1117, 317, 223, 610, 305, 400, 170, 948, 1117, 733, 673, 295, 1117, 295, 918, 765, 295, 797, 230, 1117, 648, 1117, 328, 752, 763, 1117, 1117, 373, 938, 461, 295, 945, 269, 269, 288, 265, 411, 295, 391, 399, 1117, 1117, 1117, 1117, 896, 642, 286, 1117, 763, 260]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.984066773559139, "mean_inference_ms": 6.597325085124282, "mean_action_processing_ms": 0.44884238896955336, "mean_env_wait_ms": 19.981267359531692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018477916717529297, "StateBufferConnector_ms": 0.025095462799072266, "ViewRequirementAgentConnector_ms": 0.7178761959075928}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 194380, "num_agent_steps_trained": 194380, "num_env_steps_sampled": 194380, "num_env_steps_trained": 194380, "num_env_steps_sampled_this_iter": 9928, "num_env_steps_trained_this_iter": 9928, "num_env_steps_sampled_throughput_per_sec": 218.90087768995335, "num_env_steps_trained_throughput_per_sec": 218.90087768995335, "timesteps_total": 194380, "num_steps_trained_this_iter": 9928, "agent_timesteps_total": 194380, "timers": {"training_iteration_time_ms": 41602.599, "sample_time_ms": 28838.604, "load_time_ms": 1317.465, "load_throughput": 6677.143, "learn_time_ms": 10967.965, "learn_throughput": 802.054, "synch_weights_time_ms": 407.335}, "counters": {"num_env_steps_sampled": 194380, "num_env_steps_trained": 194380, "num_agent_steps_sampled": 194380, "num_agent_steps_trained": 194380}, "done": false, "episodes_total": 353, "training_iteration": 25, "trial_id": "32ccc_00000", "date": "2025-06-07_12-17-16", "timestamp": 1749291436, "time_this_iter_s": 45.51175928115845, "time_total_s": 960.5141124725342, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 960.5141124725342, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 56.147272727272735, "ram_util_percent": 84.93636363636361, "gpu_util_percent0": 0.158, "vram_util_percent0": 0.9679361979166664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.805619999999998e-05, "total_loss": -0.12704866480339191, "policy_loss": -0.01697862473284376, "vf_loss": 0.08764337675710177, "vf_explained_var": 0.93723925948143, "kl": 0.008665084443858837, "entropy": 15.224264805892417, "entropy_coeff": 0.009028099999999999}, "model": {}, "num_grad_updates_lifetime": 6965.5, "diff_num_grad_updates_vs_sampler_policy": 144.5}}, "num_env_steps_sampled": 202577, "num_env_steps_trained": 202577, "num_agent_steps_sampled": 202577, "num_agent_steps_trained": 202577}, "sampler_results": {"episode_reward_max": 44.830816067975135, "episode_reward_min": -63.84584003085472, "episode_reward_mean": 3.5432415440587217, "episode_len_mean": 618.11, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.886599227563716, 17.900206014689065, -63.84584003085472, 16.084137832153065, -4.427672428986455, -12.504587593946832, 7.0449284307653315, -24.79510041281373, 4.704746692695923, -8.289889172655151, 13.544863137705665, -12.742575743835088, 11.623631501933875, -0.20440453018418225, 10.311931345971379, -23.672260754298993, 11.281901313049756, 18.8997428692589, 11.454167113658222, 21.478860922092267, -22.183894965318423, -12.354900028654107, 15.589064057249708, -24.182306880067976, -25.202844653817277, 13.912301321537523, 14.904827424849898, 0.9809076093745412, 1.421530515443452, -5.514652067079093, -12.53221627510547, 16.74415640252303, -10.653920241584164, 44.830816067975135, 13.578124976989516, -10.345318428323319, 17.382143342581816, -0.01004770332086491, 9.785533147847127, -4.613856907323192, 11.195633069348688, -2.2837484452030377, 5.895643050988263, 12.822620760158998, 13.087173379807679, -23.526301319807978, -7.314298413521482, 13.251785092977082, 28.743906309665437, 6.55011968867369, 14.89631625256299, 2.9482748091532085, 11.550016737632788, -3.789347402887008, 11.038203173327558, 35.261089502708096, -21.68726661441445, 25.229915723802936, 14.07376355223976, -21.18852372561871, -10.24607313238437, 19.446223447240108, -11.476650157999806, 5.8075685681215665, 8.136645015142587, -6.422828962069399, 8.288594277596935, -42.83853884757761, 11.717541069971615, 15.870369037469306, 9.527796995675397, 16.691000577940628, -19.64530813741647, 10.509322043777974, -5.0214269127827, -14.363074016152067, 23.886572345164293, 5.230953160506586, 18.182236827923006, 11.762265368806581, 4.974772542522349, -36.02964685844383, 8.678123830940478, 43.5135419347075, 11.34346988519828, 16.86755176610816, 14.353993761820197, 18.585761114673307, 11.361334525175351, -13.744457319351511, 32.97225688509524, 24.884357733405675, 3.0806785176991056, 4.03016462433195, -11.653392753749962, -11.298453284664193, -6.114066921621664, 12.23716042242639, 4.66183278030419, 15.552175019006654], "episode_lengths": [269, 295, 653, 1117, 1117, 881, 373, 617, 297, 657, 1117, 353, 270, 406, 269, 567, 232, 295, 295, 1117, 439, 629, 258, 469, 441, 297, 1117, 1117, 320, 799, 896, 269, 371, 1117, 795, 768, 1117, 317, 223, 610, 305, 400, 170, 948, 1117, 733, 673, 295, 1117, 295, 918, 765, 295, 797, 230, 1117, 648, 1117, 328, 752, 763, 1117, 1117, 373, 938, 461, 295, 945, 269, 269, 288, 265, 411, 295, 391, 399, 1117, 1117, 1117, 1117, 896, 642, 286, 1117, 763, 260, 307, 881, 259, 763, 1117, 945, 297, 728, 410, 651, 1117, 158, 295, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9789822917407662, "mean_inference_ms": 6.595689816983886, "mean_action_processing_ms": 0.4486213228267203, "mean_env_wait_ms": 19.968357327167872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018995046615600586, "StateBufferConnector_ms": 0.022055625915527344, "ViewRequirementAgentConnector_ms": 0.7132525444030762}}, "episode_reward_max": 44.830816067975135, "episode_reward_min": -63.84584003085472, "episode_reward_mean": 3.5432415440587217, "episode_len_mean": 618.11, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.886599227563716, 17.900206014689065, -63.84584003085472, 16.084137832153065, -4.427672428986455, -12.504587593946832, 7.0449284307653315, -24.79510041281373, 4.704746692695923, -8.289889172655151, 13.544863137705665, -12.742575743835088, 11.623631501933875, -0.20440453018418225, 10.311931345971379, -23.672260754298993, 11.281901313049756, 18.8997428692589, 11.454167113658222, 21.478860922092267, -22.183894965318423, -12.354900028654107, 15.589064057249708, -24.182306880067976, -25.202844653817277, 13.912301321537523, 14.904827424849898, 0.9809076093745412, 1.421530515443452, -5.514652067079093, -12.53221627510547, 16.74415640252303, -10.653920241584164, 44.830816067975135, 13.578124976989516, -10.345318428323319, 17.382143342581816, -0.01004770332086491, 9.785533147847127, -4.613856907323192, 11.195633069348688, -2.2837484452030377, 5.895643050988263, 12.822620760158998, 13.087173379807679, -23.526301319807978, -7.314298413521482, 13.251785092977082, 28.743906309665437, 6.55011968867369, 14.89631625256299, 2.9482748091532085, 11.550016737632788, -3.789347402887008, 11.038203173327558, 35.261089502708096, -21.68726661441445, 25.229915723802936, 14.07376355223976, -21.18852372561871, -10.24607313238437, 19.446223447240108, -11.476650157999806, 5.8075685681215665, 8.136645015142587, -6.422828962069399, 8.288594277596935, -42.83853884757761, 11.717541069971615, 15.870369037469306, 9.527796995675397, 16.691000577940628, -19.64530813741647, 10.509322043777974, -5.0214269127827, -14.363074016152067, 23.886572345164293, 5.230953160506586, 18.182236827923006, 11.762265368806581, 4.974772542522349, -36.02964685844383, 8.678123830940478, 43.5135419347075, 11.34346988519828, 16.86755176610816, 14.353993761820197, 18.585761114673307, 11.361334525175351, -13.744457319351511, 32.97225688509524, 24.884357733405675, 3.0806785176991056, 4.03016462433195, -11.653392753749962, -11.298453284664193, -6.114066921621664, 12.23716042242639, 4.66183278030419, 15.552175019006654], "episode_lengths": [269, 295, 653, 1117, 1117, 881, 373, 617, 297, 657, 1117, 353, 270, 406, 269, 567, 232, 295, 295, 1117, 439, 629, 258, 469, 441, 297, 1117, 1117, 320, 799, 896, 269, 371, 1117, 795, 768, 1117, 317, 223, 610, 305, 400, 170, 948, 1117, 733, 673, 295, 1117, 295, 918, 765, 295, 797, 230, 1117, 648, 1117, 328, 752, 763, 1117, 1117, 373, 938, 461, 295, 945, 269, 269, 288, 265, 411, 295, 391, 399, 1117, 1117, 1117, 1117, 896, 642, 286, 1117, 763, 260, 307, 881, 259, 763, 1117, 945, 297, 728, 410, 651, 1117, 158, 295, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9789822917407662, "mean_inference_ms": 6.595689816983886, "mean_action_processing_ms": 0.4486213228267203, "mean_env_wait_ms": 19.968357327167872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018995046615600586, "StateBufferConnector_ms": 0.022055625915527344, "ViewRequirementAgentConnector_ms": 0.7132525444030762}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 202577, "num_agent_steps_trained": 202577, "num_env_steps_sampled": 202577, "num_env_steps_trained": 202577, "num_env_steps_sampled_this_iter": 8197, "num_env_steps_trained_this_iter": 8197, "num_env_steps_sampled_throughput_per_sec": 208.09326191527975, "num_env_steps_trained_throughput_per_sec": 208.09326191527975, "timesteps_total": 202577, "num_steps_trained_this_iter": 8197, "agent_timesteps_total": 202577, "timers": {"training_iteration_time_ms": 41980.755, "sample_time_ms": 28900.97, "load_time_ms": 1323.875, "load_throughput": 6735.075, "learn_time_ms": 11279.996, "learn_throughput": 790.461, "synch_weights_time_ms": 404.854}, "counters": {"num_env_steps_sampled": 202577, "num_env_steps_trained": 202577, "num_agent_steps_sampled": 202577, "num_agent_steps_trained": 202577}, "done": false, "episodes_total": 367, "training_iteration": 26, "trial_id": "32ccc_00000", "date": "2025-06-07_12-17-55", "timestamp": 1749291475, "time_this_iter_s": 39.40679454803467, "time_total_s": 999.9209070205688, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 999.9209070205688, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 53.31276595744679, "ram_util_percent": 84.57234042553189, "gpu_util_percent0": 0.13319148936170216, "vram_util_percent0": 0.9679361979166663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.797423e-05, "total_loss": -0.12039124815550167, "policy_loss": -0.010052092814197142, "vf_loss": 0.08904402711428702, "vf_explained_var": 0.940808100104332, "kl": 0.008558620767192528, "entropy": 15.368913815816244, "entropy_coeff": 0.008987115000000002}, "model": {}, "num_grad_updates_lifetime": 7260.5, "diff_num_grad_updates_vs_sampler_policy": 149.5}}, "num_env_steps_sampled": 211213, "num_env_steps_trained": 211213, "num_agent_steps_sampled": 211213, "num_agent_steps_trained": 211213}, "sampler_results": {"episode_reward_max": 44.830816067975135, "episode_reward_min": -42.83853884757761, "episode_reward_mean": 4.368503045094492, "episode_len_mean": 620.25, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.311931345971379, -23.672260754298993, 11.281901313049756, 18.8997428692589, 11.454167113658222, 21.478860922092267, -22.183894965318423, -12.354900028654107, 15.589064057249708, -24.182306880067976, -25.202844653817277, 13.912301321537523, 14.904827424849898, 0.9809076093745412, 1.421530515443452, -5.514652067079093, -12.53221627510547, 16.74415640252303, -10.653920241584164, 44.830816067975135, 13.578124976989516, -10.345318428323319, 17.382143342581816, -0.01004770332086491, 9.785533147847127, -4.613856907323192, 11.195633069348688, -2.2837484452030377, 5.895643050988263, 12.822620760158998, 13.087173379807679, -23.526301319807978, -7.314298413521482, 13.251785092977082, 28.743906309665437, 6.55011968867369, 14.89631625256299, 2.9482748091532085, 11.550016737632788, -3.789347402887008, 11.038203173327558, 35.261089502708096, -21.68726661441445, 25.229915723802936, 14.07376355223976, -21.18852372561871, -10.24607313238437, 19.446223447240108, -11.476650157999806, 5.8075685681215665, 8.136645015142587, -6.422828962069399, 8.288594277596935, -42.83853884757761, 11.717541069971615, 15.870369037469306, 9.527796995675397, 16.691000577940628, -19.64530813741647, 10.509322043777974, -5.0214269127827, -14.363074016152067, 23.886572345164293, 5.230953160506586, 18.182236827923006, 11.762265368806581, 4.974772542522349, -36.02964685844383, 8.678123830940478, 43.5135419347075, 11.34346988519828, 16.86755176610816, 14.353993761820197, 18.585761114673307, 11.361334525175351, -13.744457319351511, 32.97225688509524, 24.884357733405675, 3.0806785176991056, 4.03016462433195, -11.653392753749962, -11.298453284664193, -6.114066921621664, 12.23716042242639, 4.66183278030419, 15.552175019006654, 4.623039805152056, -4.149517646616085, -20.911495593175314, 21.390823301026032, -25.72590935970971, 16.55450226811989, -32.73066927372893, 5.34319353599788, 20.545443829106834, 11.62678635136924, -0.17862878322655484, 14.446409650633283, 13.287196526638652, 11.384018416220272], "episode_lengths": [269, 567, 232, 295, 295, 1117, 439, 629, 258, 469, 441, 297, 1117, 1117, 320, 799, 896, 269, 371, 1117, 795, 768, 1117, 317, 223, 610, 305, 400, 170, 948, 1117, 733, 673, 295, 1117, 295, 918, 765, 295, 797, 230, 1117, 648, 1117, 328, 752, 763, 1117, 1117, 373, 938, 461, 295, 945, 269, 269, 288, 265, 411, 295, 391, 399, 1117, 1117, 1117, 1117, 896, 642, 286, 1117, 763, 260, 307, 881, 259, 763, 1117, 945, 297, 728, 410, 651, 1117, 158, 295, 269, 398, 704, 763, 259, 414, 1117, 364, 406, 1117, 302, 391, 1117, 269, 1015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9743372194512077, "mean_inference_ms": 6.593310668292206, "mean_action_processing_ms": 0.44848396348575315, "mean_env_wait_ms": 19.952256405284412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01698136329650879, "StateBufferConnector_ms": 0.009018659591674805, "ViewRequirementAgentConnector_ms": 0.694598913192749}}, "episode_reward_max": 44.830816067975135, "episode_reward_min": -42.83853884757761, "episode_reward_mean": 4.368503045094492, "episode_len_mean": 620.25, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.311931345971379, -23.672260754298993, 11.281901313049756, 18.8997428692589, 11.454167113658222, 21.478860922092267, -22.183894965318423, -12.354900028654107, 15.589064057249708, -24.182306880067976, -25.202844653817277, 13.912301321537523, 14.904827424849898, 0.9809076093745412, 1.421530515443452, -5.514652067079093, -12.53221627510547, 16.74415640252303, -10.653920241584164, 44.830816067975135, 13.578124976989516, -10.345318428323319, 17.382143342581816, -0.01004770332086491, 9.785533147847127, -4.613856907323192, 11.195633069348688, -2.2837484452030377, 5.895643050988263, 12.822620760158998, 13.087173379807679, -23.526301319807978, -7.314298413521482, 13.251785092977082, 28.743906309665437, 6.55011968867369, 14.89631625256299, 2.9482748091532085, 11.550016737632788, -3.789347402887008, 11.038203173327558, 35.261089502708096, -21.68726661441445, 25.229915723802936, 14.07376355223976, -21.18852372561871, -10.24607313238437, 19.446223447240108, -11.476650157999806, 5.8075685681215665, 8.136645015142587, -6.422828962069399, 8.288594277596935, -42.83853884757761, 11.717541069971615, 15.870369037469306, 9.527796995675397, 16.691000577940628, -19.64530813741647, 10.509322043777974, -5.0214269127827, -14.363074016152067, 23.886572345164293, 5.230953160506586, 18.182236827923006, 11.762265368806581, 4.974772542522349, -36.02964685844383, 8.678123830940478, 43.5135419347075, 11.34346988519828, 16.86755176610816, 14.353993761820197, 18.585761114673307, 11.361334525175351, -13.744457319351511, 32.97225688509524, 24.884357733405675, 3.0806785176991056, 4.03016462433195, -11.653392753749962, -11.298453284664193, -6.114066921621664, 12.23716042242639, 4.66183278030419, 15.552175019006654, 4.623039805152056, -4.149517646616085, -20.911495593175314, 21.390823301026032, -25.72590935970971, 16.55450226811989, -32.73066927372893, 5.34319353599788, 20.545443829106834, 11.62678635136924, -0.17862878322655484, 14.446409650633283, 13.287196526638652, 11.384018416220272], "episode_lengths": [269, 567, 232, 295, 295, 1117, 439, 629, 258, 469, 441, 297, 1117, 1117, 320, 799, 896, 269, 371, 1117, 795, 768, 1117, 317, 223, 610, 305, 400, 170, 948, 1117, 733, 673, 295, 1117, 295, 918, 765, 295, 797, 230, 1117, 648, 1117, 328, 752, 763, 1117, 1117, 373, 938, 461, 295, 945, 269, 269, 288, 265, 411, 295, 391, 399, 1117, 1117, 1117, 1117, 896, 642, 286, 1117, 763, 260, 307, 881, 259, 763, 1117, 945, 297, 728, 410, 651, 1117, 158, 295, 269, 398, 704, 763, 259, 414, 1117, 364, 406, 1117, 302, 391, 1117, 269, 1015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9743372194512077, "mean_inference_ms": 6.593310668292206, "mean_action_processing_ms": 0.44848396348575315, "mean_env_wait_ms": 19.952256405284412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01698136329650879, "StateBufferConnector_ms": 0.009018659591674805, "ViewRequirementAgentConnector_ms": 0.694598913192749}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 211213, "num_agent_steps_trained": 211213, "num_env_steps_sampled": 211213, "num_env_steps_trained": 211213, "num_env_steps_sampled_this_iter": 8636, "num_env_steps_trained_this_iter": 8636, "num_env_steps_sampled_throughput_per_sec": 203.54450303407498, "num_env_steps_trained_throughput_per_sec": 203.54450303407498, "timesteps_total": 211213, "num_steps_trained_this_iter": 8636, "agent_timesteps_total": 211213, "timers": {"training_iteration_time_ms": 41022.233, "sample_time_ms": 28407.331, "load_time_ms": 1096.593, "load_throughput": 7890.077, "learn_time_ms": 11045.678, "learn_throughput": 783.311, "synch_weights_time_ms": 408.12}, "counters": {"num_env_steps_sampled": 211213, "num_env_steps_trained": 211213, "num_agent_steps_sampled": 211213, "num_agent_steps_trained": 211213}, "done": false, "episodes_total": 381, "training_iteration": 27, "trial_id": "32ccc_00000", "date": "2025-06-07_12-18-38", "timestamp": 1749291518, "time_this_iter_s": 42.44408392906189, "time_total_s": 1042.3649909496307, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1042.3649909496307, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 52.06153846153845, "ram_util_percent": 84.99999999999999, "gpu_util_percent0": 0.1957692307692308, "vram_util_percent0": 0.9679361979166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.788787000000004e-05, "total_loss": -0.1479026198745347, "policy_loss": -0.04013342726438378, "vf_loss": 0.09648488597371258, "vf_explained_var": 0.9253571957349778, "kl": 0.009461771212171208, "entropy": 15.417976907583384, "entropy_coeff": 0.008943935}, "model": {}, "num_grad_updates_lifetime": 7540.5, "diff_num_grad_updates_vs_sampler_policy": 129.5}}, "num_env_steps_sampled": 218587, "num_env_steps_trained": 218587, "num_agent_steps_sampled": 218587, "num_agent_steps_trained": 218587}, "sampler_results": {"episode_reward_max": 44.830816067975135, "episode_reward_min": -42.83853884757761, "episode_reward_mean": 4.6181785812753064, "episode_len_mean": 618.57, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.421530515443452, -5.514652067079093, -12.53221627510547, 16.74415640252303, -10.653920241584164, 44.830816067975135, 13.578124976989516, -10.345318428323319, 17.382143342581816, -0.01004770332086491, 9.785533147847127, -4.613856907323192, 11.195633069348688, -2.2837484452030377, 5.895643050988263, 12.822620760158998, 13.087173379807679, -23.526301319807978, -7.314298413521482, 13.251785092977082, 28.743906309665437, 6.55011968867369, 14.89631625256299, 2.9482748091532085, 11.550016737632788, -3.789347402887008, 11.038203173327558, 35.261089502708096, -21.68726661441445, 25.229915723802936, 14.07376355223976, -21.18852372561871, -10.24607313238437, 19.446223447240108, -11.476650157999806, 5.8075685681215665, 8.136645015142587, -6.422828962069399, 8.288594277596935, -42.83853884757761, 11.717541069971615, 15.870369037469306, 9.527796995675397, 16.691000577940628, -19.64530813741647, 10.509322043777974, -5.0214269127827, -14.363074016152067, 23.886572345164293, 5.230953160506586, 18.182236827923006, 11.762265368806581, 4.974772542522349, -36.02964685844383, 8.678123830940478, 43.5135419347075, 11.34346988519828, 16.86755176610816, 14.353993761820197, 18.585761114673307, 11.361334525175351, -13.744457319351511, 32.97225688509524, 24.884357733405675, 3.0806785176991056, 4.03016462433195, -11.653392753749962, -11.298453284664193, -6.114066921621664, 12.23716042242639, 4.66183278030419, 15.552175019006654, 4.623039805152056, -4.149517646616085, -20.911495593175314, 21.390823301026032, -25.72590935970971, 16.55450226811989, -32.73066927372893, 5.34319353599788, 20.545443829106834, 11.62678635136924, -0.17862878322655484, 14.446409650633283, 13.287196526638652, 11.384018416220272, -17.505404252326684, -12.906719264041685, 14.34467551710304, 32.176607539749156, 13.47724217065868, 6.036161301792975, 7.190760542146823, 10.334847067017312, -12.507902470573152, 2.876632278214858, 7.0227714495791815, -11.058432221680727, -8.51214486306094, 5.215955518388059], "episode_lengths": [320, 799, 896, 269, 371, 1117, 795, 768, 1117, 317, 223, 610, 305, 400, 170, 948, 1117, 733, 673, 295, 1117, 295, 918, 765, 295, 797, 230, 1117, 648, 1117, 328, 752, 763, 1117, 1117, 373, 938, 461, 295, 945, 269, 269, 288, 265, 411, 295, 391, 399, 1117, 1117, 1117, 1117, 896, 642, 286, 1117, 763, 260, 307, 881, 259, 763, 1117, 945, 297, 728, 410, 651, 1117, 158, 295, 269, 398, 704, 763, 259, 414, 1117, 364, 406, 1117, 302, 391, 1117, 269, 1015, 760, 468, 295, 1117, 231, 295, 305, 295, 647, 410, 168, 836, 430, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9691579635565182, "mean_inference_ms": 6.590595910288784, "mean_action_processing_ms": 0.44832036247592255, "mean_env_wait_ms": 19.935714176058287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01832413673400879, "StateBufferConnector_ms": 0.01101064682006836, "ViewRequirementAgentConnector_ms": 0.7031114101409912}}, "episode_reward_max": 44.830816067975135, "episode_reward_min": -42.83853884757761, "episode_reward_mean": 4.6181785812753064, "episode_len_mean": 618.57, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.421530515443452, -5.514652067079093, -12.53221627510547, 16.74415640252303, -10.653920241584164, 44.830816067975135, 13.578124976989516, -10.345318428323319, 17.382143342581816, -0.01004770332086491, 9.785533147847127, -4.613856907323192, 11.195633069348688, -2.2837484452030377, 5.895643050988263, 12.822620760158998, 13.087173379807679, -23.526301319807978, -7.314298413521482, 13.251785092977082, 28.743906309665437, 6.55011968867369, 14.89631625256299, 2.9482748091532085, 11.550016737632788, -3.789347402887008, 11.038203173327558, 35.261089502708096, -21.68726661441445, 25.229915723802936, 14.07376355223976, -21.18852372561871, -10.24607313238437, 19.446223447240108, -11.476650157999806, 5.8075685681215665, 8.136645015142587, -6.422828962069399, 8.288594277596935, -42.83853884757761, 11.717541069971615, 15.870369037469306, 9.527796995675397, 16.691000577940628, -19.64530813741647, 10.509322043777974, -5.0214269127827, -14.363074016152067, 23.886572345164293, 5.230953160506586, 18.182236827923006, 11.762265368806581, 4.974772542522349, -36.02964685844383, 8.678123830940478, 43.5135419347075, 11.34346988519828, 16.86755176610816, 14.353993761820197, 18.585761114673307, 11.361334525175351, -13.744457319351511, 32.97225688509524, 24.884357733405675, 3.0806785176991056, 4.03016462433195, -11.653392753749962, -11.298453284664193, -6.114066921621664, 12.23716042242639, 4.66183278030419, 15.552175019006654, 4.623039805152056, -4.149517646616085, -20.911495593175314, 21.390823301026032, -25.72590935970971, 16.55450226811989, -32.73066927372893, 5.34319353599788, 20.545443829106834, 11.62678635136924, -0.17862878322655484, 14.446409650633283, 13.287196526638652, 11.384018416220272, -17.505404252326684, -12.906719264041685, 14.34467551710304, 32.176607539749156, 13.47724217065868, 6.036161301792975, 7.190760542146823, 10.334847067017312, -12.507902470573152, 2.876632278214858, 7.0227714495791815, -11.058432221680727, -8.51214486306094, 5.215955518388059], "episode_lengths": [320, 799, 896, 269, 371, 1117, 795, 768, 1117, 317, 223, 610, 305, 400, 170, 948, 1117, 733, 673, 295, 1117, 295, 918, 765, 295, 797, 230, 1117, 648, 1117, 328, 752, 763, 1117, 1117, 373, 938, 461, 295, 945, 269, 269, 288, 265, 411, 295, 391, 399, 1117, 1117, 1117, 1117, 896, 642, 286, 1117, 763, 260, 307, 881, 259, 763, 1117, 945, 297, 728, 410, 651, 1117, 158, 295, 269, 398, 704, 763, 259, 414, 1117, 364, 406, 1117, 302, 391, 1117, 269, 1015, 760, 468, 295, 1117, 231, 295, 305, 295, 647, 410, 168, 836, 430, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9691579635565182, "mean_inference_ms": 6.590595910288784, "mean_action_processing_ms": 0.44832036247592255, "mean_env_wait_ms": 19.935714176058287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01832413673400879, "StateBufferConnector_ms": 0.01101064682006836, "ViewRequirementAgentConnector_ms": 0.7031114101409912}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 218587, "num_agent_steps_trained": 218587, "num_env_steps_sampled": 218587, "num_env_steps_trained": 218587, "num_env_steps_sampled_this_iter": 7374, "num_env_steps_trained_this_iter": 7374, "num_env_steps_sampled_throughput_per_sec": 207.60852110848896, "num_env_steps_trained_throughput_per_sec": 207.60852110848896, "timesteps_total": 218587, "num_steps_trained_this_iter": 7374, "agent_timesteps_total": 218587, "timers": {"training_iteration_time_ms": 40513.982, "sample_time_ms": 28214.058, "load_time_ms": 1089.351, "load_throughput": 7843.66, "learn_time_ms": 10731.684, "learn_throughput": 796.194, "synch_weights_time_ms": 410.621}, "counters": {"num_env_steps_sampled": 218587, "num_env_steps_trained": 218587, "num_agent_steps_sampled": 218587, "num_agent_steps_trained": 218587}, "done": false, "episodes_total": 395, "training_iteration": 28, "trial_id": "32ccc_00000", "date": "2025-06-07_12-19-13", "timestamp": 1749291553, "time_this_iter_s": 35.53375959396362, "time_total_s": 1077.8987505435944, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1077.8987505435944, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 56.71395348837209, "ram_util_percent": 83.14418604651162, "gpu_util_percent0": 0.10348837209302326, "vram_util_percent0": 0.9679361979166664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.781413e-05, "total_loss": -0.14993958672096666, "policy_loss": -0.04135698882970386, "vf_loss": 0.09472721098349071, "vf_explained_var": 0.9422121896193578, "kl": 0.010383539117621974, "entropy": 15.526855314694918, "entropy_coeff": 0.008907065000000002}, "model": {}, "num_grad_updates_lifetime": 7800.5, "diff_num_grad_updates_vs_sampler_policy": 129.5}}, "num_env_steps_sampled": 226044, "num_env_steps_trained": 226044, "num_agent_steps_sampled": 226044, "num_agent_steps_trained": 226044}, "sampler_results": {"episode_reward_max": 43.5135419347075, "episode_reward_min": -42.83853884757761, "episode_reward_mean": 4.514480882272725, "episode_len_mean": 610.07, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.895643050988263, 12.822620760158998, 13.087173379807679, -23.526301319807978, -7.314298413521482, 13.251785092977082, 28.743906309665437, 6.55011968867369, 14.89631625256299, 2.9482748091532085, 11.550016737632788, -3.789347402887008, 11.038203173327558, 35.261089502708096, -21.68726661441445, 25.229915723802936, 14.07376355223976, -21.18852372561871, -10.24607313238437, 19.446223447240108, -11.476650157999806, 5.8075685681215665, 8.136645015142587, -6.422828962069399, 8.288594277596935, -42.83853884757761, 11.717541069971615, 15.870369037469306, 9.527796995675397, 16.691000577940628, -19.64530813741647, 10.509322043777974, -5.0214269127827, -14.363074016152067, 23.886572345164293, 5.230953160506586, 18.182236827923006, 11.762265368806581, 4.974772542522349, -36.02964685844383, 8.678123830940478, 43.5135419347075, 11.34346988519828, 16.86755176610816, 14.353993761820197, 18.585761114673307, 11.361334525175351, -13.744457319351511, 32.97225688509524, 24.884357733405675, 3.0806785176991056, 4.03016462433195, -11.653392753749962, -11.298453284664193, -6.114066921621664, 12.23716042242639, 4.66183278030419, 15.552175019006654, 4.623039805152056, -4.149517646616085, -20.911495593175314, 21.390823301026032, -25.72590935970971, 16.55450226811989, -32.73066927372893, 5.34319353599788, 20.545443829106834, 11.62678635136924, -0.17862878322655484, 14.446409650633283, 13.287196526638652, 11.384018416220272, -17.505404252326684, -12.906719264041685, 14.34467551710304, 32.176607539749156, 13.47724217065868, 6.036161301792975, 7.190760542146823, 10.334847067017312, -12.507902470573152, 2.876632278214858, 7.0227714495791815, -11.058432221680727, -8.51214486306094, 5.215955518388059, 15.520531813031013, -11.119147241795101, -8.550429953880002, 5.440821545526773, 23.714234436150427, 17.867225627000504, 15.526180611164445, 17.170334225351233, -36.774475745371554, -8.653425346708042, 16.348671164443488, 12.91291058474934, 10.897500910615287, -11.686525075766417], "episode_lengths": [170, 948, 1117, 733, 673, 295, 1117, 295, 918, 765, 295, 797, 230, 1117, 648, 1117, 328, 752, 763, 1117, 1117, 373, 938, 461, 295, 945, 269, 269, 288, 265, 411, 295, 391, 399, 1117, 1117, 1117, 1117, 896, 642, 286, 1117, 763, 260, 307, 881, 259, 763, 1117, 945, 297, 728, 410, 651, 1117, 158, 295, 269, 398, 704, 763, 259, 414, 1117, 364, 406, 1117, 302, 391, 1117, 269, 1015, 760, 468, 295, 1117, 231, 295, 305, 295, 647, 410, 168, 836, 430, 1117, 1117, 761, 1117, 439, 295, 1117, 151, 295, 589, 409, 269, 295, 230, 373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9648823429398607, "mean_inference_ms": 6.588372699459241, "mean_action_processing_ms": 0.44811658164236334, "mean_env_wait_ms": 19.92051281234553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017321109771728516, "StateBufferConnector_ms": 0.01204228401184082, "ViewRequirementAgentConnector_ms": 0.6924078464508057}}, "episode_reward_max": 43.5135419347075, "episode_reward_min": -42.83853884757761, "episode_reward_mean": 4.514480882272725, "episode_len_mean": 610.07, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.895643050988263, 12.822620760158998, 13.087173379807679, -23.526301319807978, -7.314298413521482, 13.251785092977082, 28.743906309665437, 6.55011968867369, 14.89631625256299, 2.9482748091532085, 11.550016737632788, -3.789347402887008, 11.038203173327558, 35.261089502708096, -21.68726661441445, 25.229915723802936, 14.07376355223976, -21.18852372561871, -10.24607313238437, 19.446223447240108, -11.476650157999806, 5.8075685681215665, 8.136645015142587, -6.422828962069399, 8.288594277596935, -42.83853884757761, 11.717541069971615, 15.870369037469306, 9.527796995675397, 16.691000577940628, -19.64530813741647, 10.509322043777974, -5.0214269127827, -14.363074016152067, 23.886572345164293, 5.230953160506586, 18.182236827923006, 11.762265368806581, 4.974772542522349, -36.02964685844383, 8.678123830940478, 43.5135419347075, 11.34346988519828, 16.86755176610816, 14.353993761820197, 18.585761114673307, 11.361334525175351, -13.744457319351511, 32.97225688509524, 24.884357733405675, 3.0806785176991056, 4.03016462433195, -11.653392753749962, -11.298453284664193, -6.114066921621664, 12.23716042242639, 4.66183278030419, 15.552175019006654, 4.623039805152056, -4.149517646616085, -20.911495593175314, 21.390823301026032, -25.72590935970971, 16.55450226811989, -32.73066927372893, 5.34319353599788, 20.545443829106834, 11.62678635136924, -0.17862878322655484, 14.446409650633283, 13.287196526638652, 11.384018416220272, -17.505404252326684, -12.906719264041685, 14.34467551710304, 32.176607539749156, 13.47724217065868, 6.036161301792975, 7.190760542146823, 10.334847067017312, -12.507902470573152, 2.876632278214858, 7.0227714495791815, -11.058432221680727, -8.51214486306094, 5.215955518388059, 15.520531813031013, -11.119147241795101, -8.550429953880002, 5.440821545526773, 23.714234436150427, 17.867225627000504, 15.526180611164445, 17.170334225351233, -36.774475745371554, -8.653425346708042, 16.348671164443488, 12.91291058474934, 10.897500910615287, -11.686525075766417], "episode_lengths": [170, 948, 1117, 733, 673, 295, 1117, 295, 918, 765, 295, 797, 230, 1117, 648, 1117, 328, 752, 763, 1117, 1117, 373, 938, 461, 295, 945, 269, 269, 288, 265, 411, 295, 391, 399, 1117, 1117, 1117, 1117, 896, 642, 286, 1117, 763, 260, 307, 881, 259, 763, 1117, 945, 297, 728, 410, 651, 1117, 158, 295, 269, 398, 704, 763, 259, 414, 1117, 364, 406, 1117, 302, 391, 1117, 269, 1015, 760, 468, 295, 1117, 231, 295, 305, 295, 647, 410, 168, 836, 430, 1117, 1117, 761, 1117, 439, 295, 1117, 151, 295, 589, 409, 269, 295, 230, 373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9648823429398607, "mean_inference_ms": 6.588372699459241, "mean_action_processing_ms": 0.44811658164236334, "mean_env_wait_ms": 19.92051281234553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017321109771728516, "StateBufferConnector_ms": 0.01204228401184082, "ViewRequirementAgentConnector_ms": 0.6924078464508057}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226044, "num_agent_steps_trained": 226044, "num_env_steps_sampled": 226044, "num_env_steps_trained": 226044, "num_env_steps_sampled_this_iter": 7457, "num_env_steps_trained_this_iter": 7457, "num_env_steps_sampled_throughput_per_sec": 199.21985483202812, "num_env_steps_trained_throughput_per_sec": 199.21985483202812, "timesteps_total": 226044, "num_steps_trained_this_iter": 7457, "agent_timesteps_total": 226044, "timers": {"training_iteration_time_ms": 40458.131, "sample_time_ms": 28121.924, "load_time_ms": 1094.038, "load_throughput": 7743.238, "learn_time_ms": 10760.603, "learn_throughput": 787.261, "synch_weights_time_ms": 414.201}, "counters": {"num_env_steps_sampled": 226044, "num_env_steps_trained": 226044, "num_agent_steps_sampled": 226044, "num_agent_steps_trained": 226044}, "done": false, "episodes_total": 409, "training_iteration": 29, "trial_id": "32ccc_00000", "date": "2025-06-07_12-19-51", "timestamp": 1749291591, "time_this_iter_s": 37.44801616668701, "time_total_s": 1115.3467667102814, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1115.3467667102814, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 53.544444444444444, "ram_util_percent": 74.14444444444443, "gpu_util_percent0": 0.1311111111111111, "vram_util_percent0": 0.9679361979166663}}
{"evaluation": {"sampler_results": {"episode_reward_max": -2.972707465312617, "episode_reward_min": -5.304279752310732, "episode_reward_mean": -3.7954062212110244, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.304279752310732, -3.8646321768683722, -3.5950755240606433, -3.240336187502759, -2.972707465312617], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4433261494151237, "mean_inference_ms": 3.5653680789647693, "mean_action_processing_ms": 0.2495602652975633, "mean_env_wait_ms": 10.381171600579439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.03998756408691406, "ViewRequirementAgentConnector_ms": 0.20111560821533203}}, "episode_reward_max": -2.972707465312617, "episode_reward_min": -5.304279752310732, "episode_reward_mean": -3.7954062212110244, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.304279752310732, -3.8646321768683722, -3.5950755240606433, -3.240336187502759, -2.972707465312617], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4433261494151237, "mean_inference_ms": 3.5653680789647693, "mean_action_processing_ms": 0.2495602652975633, "mean_env_wait_ms": 10.381171600579439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.03998756408691406, "ViewRequirementAgentConnector_ms": 0.20111560821533203}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.773956000000003e-05, "total_loss": -0.12676645762797806, "policy_loss": -0.01970858644964474, "vf_loss": 0.09974029485677038, "vf_explained_var": 0.9294095843069015, "kl": 0.0101195094329136, "entropy": 15.586056998468214, "entropy_coeff": 0.00886978}, "model": {}, "num_grad_updates_lifetime": 8085.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 234884, "num_env_steps_trained": 234884, "num_agent_steps_sampled": 234884, "num_agent_steps_trained": 234884}, "sampler_results": {"episode_reward_max": 43.5135419347075, "episode_reward_min": -42.83853884757761, "episode_reward_mean": 3.44419601626604, "episode_len_mean": 603.77, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.68726661441445, 25.229915723802936, 14.07376355223976, -21.18852372561871, -10.24607313238437, 19.446223447240108, -11.476650157999806, 5.8075685681215665, 8.136645015142587, -6.422828962069399, 8.288594277596935, -42.83853884757761, 11.717541069971615, 15.870369037469306, 9.527796995675397, 16.691000577940628, -19.64530813741647, 10.509322043777974, -5.0214269127827, -14.363074016152067, 23.886572345164293, 5.230953160506586, 18.182236827923006, 11.762265368806581, 4.974772542522349, -36.02964685844383, 8.678123830940478, 43.5135419347075, 11.34346988519828, 16.86755176610816, 14.353993761820197, 18.585761114673307, 11.361334525175351, -13.744457319351511, 32.97225688509524, 24.884357733405675, 3.0806785176991056, 4.03016462433195, -11.653392753749962, -11.298453284664193, -6.114066921621664, 12.23716042242639, 4.66183278030419, 15.552175019006654, 4.623039805152056, -4.149517646616085, -20.911495593175314, 21.390823301026032, -25.72590935970971, 16.55450226811989, -32.73066927372893, 5.34319353599788, 20.545443829106834, 11.62678635136924, -0.17862878322655484, 14.446409650633283, 13.287196526638652, 11.384018416220272, -17.505404252326684, -12.906719264041685, 14.34467551710304, 32.176607539749156, 13.47724217065868, 6.036161301792975, 7.190760542146823, 10.334847067017312, -12.507902470573152, 2.876632278214858, 7.0227714495791815, -11.058432221680727, -8.51214486306094, 5.215955518388059, 15.520531813031013, -11.119147241795101, -8.550429953880002, 5.440821545526773, 23.714234436150427, 17.867225627000504, 15.526180611164445, 17.170334225351233, -36.774475745371554, -8.653425346708042, 16.348671164443488, 12.91291058474934, 10.897500910615287, -11.686525075766417, -21.473625559488664, -14.310822965412171, -12.438615432771554, 12.17672007595152, 18.909828863927263, -4.7467877330854975, -13.55302930437792, 2.6580173647392433, 0.6283404225201747, 26.73561500587931, 8.946164039909494, 15.462754690434137, -4.855766993528085, 0.24792254607360342], "episode_lengths": [648, 1117, 328, 752, 763, 1117, 1117, 373, 938, 461, 295, 945, 269, 269, 288, 265, 411, 295, 391, 399, 1117, 1117, 1117, 1117, 896, 642, 286, 1117, 763, 260, 307, 881, 259, 763, 1117, 945, 297, 728, 410, 651, 1117, 158, 295, 269, 398, 704, 763, 259, 414, 1117, 364, 406, 1117, 302, 391, 1117, 269, 1015, 760, 468, 295, 1117, 231, 295, 305, 295, 647, 410, 168, 836, 430, 1117, 1117, 761, 1117, 439, 295, 1117, 151, 295, 589, 409, 269, 295, 230, 373, 733, 439, 1117, 295, 1117, 367, 961, 373, 317, 295, 262, 1117, 1117, 330]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9605772272066915, "mean_inference_ms": 6.583994107459834, "mean_action_processing_ms": 0.44778324853109697, "mean_env_wait_ms": 19.904320977900294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01728534698486328, "StateBufferConnector_ms": 0.014107942581176758, "ViewRequirementAgentConnector_ms": 0.6729304790496826}}, "episode_reward_max": 43.5135419347075, "episode_reward_min": -42.83853884757761, "episode_reward_mean": 3.44419601626604, "episode_len_mean": 603.77, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.68726661441445, 25.229915723802936, 14.07376355223976, -21.18852372561871, -10.24607313238437, 19.446223447240108, -11.476650157999806, 5.8075685681215665, 8.136645015142587, -6.422828962069399, 8.288594277596935, -42.83853884757761, 11.717541069971615, 15.870369037469306, 9.527796995675397, 16.691000577940628, -19.64530813741647, 10.509322043777974, -5.0214269127827, -14.363074016152067, 23.886572345164293, 5.230953160506586, 18.182236827923006, 11.762265368806581, 4.974772542522349, -36.02964685844383, 8.678123830940478, 43.5135419347075, 11.34346988519828, 16.86755176610816, 14.353993761820197, 18.585761114673307, 11.361334525175351, -13.744457319351511, 32.97225688509524, 24.884357733405675, 3.0806785176991056, 4.03016462433195, -11.653392753749962, -11.298453284664193, -6.114066921621664, 12.23716042242639, 4.66183278030419, 15.552175019006654, 4.623039805152056, -4.149517646616085, -20.911495593175314, 21.390823301026032, -25.72590935970971, 16.55450226811989, -32.73066927372893, 5.34319353599788, 20.545443829106834, 11.62678635136924, -0.17862878322655484, 14.446409650633283, 13.287196526638652, 11.384018416220272, -17.505404252326684, -12.906719264041685, 14.34467551710304, 32.176607539749156, 13.47724217065868, 6.036161301792975, 7.190760542146823, 10.334847067017312, -12.507902470573152, 2.876632278214858, 7.0227714495791815, -11.058432221680727, -8.51214486306094, 5.215955518388059, 15.520531813031013, -11.119147241795101, -8.550429953880002, 5.440821545526773, 23.714234436150427, 17.867225627000504, 15.526180611164445, 17.170334225351233, -36.774475745371554, -8.653425346708042, 16.348671164443488, 12.91291058474934, 10.897500910615287, -11.686525075766417, -21.473625559488664, -14.310822965412171, -12.438615432771554, 12.17672007595152, 18.909828863927263, -4.7467877330854975, -13.55302930437792, 2.6580173647392433, 0.6283404225201747, 26.73561500587931, 8.946164039909494, 15.462754690434137, -4.855766993528085, 0.24792254607360342], "episode_lengths": [648, 1117, 328, 752, 763, 1117, 1117, 373, 938, 461, 295, 945, 269, 269, 288, 265, 411, 295, 391, 399, 1117, 1117, 1117, 1117, 896, 642, 286, 1117, 763, 260, 307, 881, 259, 763, 1117, 945, 297, 728, 410, 651, 1117, 158, 295, 269, 398, 704, 763, 259, 414, 1117, 364, 406, 1117, 302, 391, 1117, 269, 1015, 760, 468, 295, 1117, 231, 295, 305, 295, 647, 410, 168, 836, 430, 1117, 1117, 761, 1117, 439, 295, 1117, 151, 295, 589, 409, 269, 295, 230, 373, 733, 439, 1117, 295, 1117, 367, 961, 373, 317, 295, 262, 1117, 1117, 330]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9605772272066915, "mean_inference_ms": 6.583994107459834, "mean_action_processing_ms": 0.44778324853109697, "mean_env_wait_ms": 19.904320977900294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01728534698486328, "StateBufferConnector_ms": 0.014107942581176758, "ViewRequirementAgentConnector_ms": 0.6729304790496826}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234884, "num_agent_steps_trained": 234884, "num_env_steps_sampled": 234884, "num_env_steps_trained": 234884, "num_env_steps_sampled_this_iter": 8840, "num_env_steps_trained_this_iter": 8840, "num_env_steps_sampled_throughput_per_sec": 205.6004546076785, "num_env_steps_trained_throughput_per_sec": 205.6004546076785, "timesteps_total": 234884, "num_steps_trained_this_iter": 8840, "agent_timesteps_total": 234884, "timers": {"training_iteration_time_ms": 40544.407, "sample_time_ms": 28119.987, "load_time_ms": 1105.129, "load_throughput": 7678.739, "learn_time_ms": 10839.821, "learn_throughput": 782.854, "synch_weights_time_ms": 413.043}, "counters": {"num_env_steps_sampled": 234884, "num_env_steps_trained": 234884, "num_agent_steps_sampled": 234884, "num_agent_steps_trained": 234884}, "done": false, "episodes_total": 423, "training_iteration": 30, "trial_id": "32ccc_00000", "date": "2025-06-07_12-20-48", "timestamp": 1749291648, "time_this_iter_s": 57.42705297470093, "time_total_s": 1172.7738196849823, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1172.7738196849823, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 44.74714285714286, "ram_util_percent": 74.61142857142859, "gpu_util_percent0": 0.13957142857142857, "vram_util_percent0": 0.967936197916667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.765116000000002e-05, "total_loss": -0.13077584593950578, "policy_loss": -0.025281369072549482, "vf_loss": 0.10377706550609539, "vf_explained_var": 0.9268376194378909, "kl": 0.00965689638413845, "entropy": 15.617638285019819, "entropy_coeff": 0.00882558}, "model": {}, "num_grad_updates_lifetime": 8410.5, "diff_num_grad_updates_vs_sampler_policy": 169.5}}, "num_env_steps_sampled": 244586, "num_env_steps_trained": 244586, "num_agent_steps_sampled": 244586, "num_agent_steps_trained": 244586}, "sampler_results": {"episode_reward_max": 43.5135419347075, "episode_reward_min": -39.88217517746149, "episode_reward_mean": 2.9996353833985085, "episode_len_mean": 606.87, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.527796995675397, 16.691000577940628, -19.64530813741647, 10.509322043777974, -5.0214269127827, -14.363074016152067, 23.886572345164293, 5.230953160506586, 18.182236827923006, 11.762265368806581, 4.974772542522349, -36.02964685844383, 8.678123830940478, 43.5135419347075, 11.34346988519828, 16.86755176610816, 14.353993761820197, 18.585761114673307, 11.361334525175351, -13.744457319351511, 32.97225688509524, 24.884357733405675, 3.0806785176991056, 4.03016462433195, -11.653392753749962, -11.298453284664193, -6.114066921621664, 12.23716042242639, 4.66183278030419, 15.552175019006654, 4.623039805152056, -4.149517646616085, -20.911495593175314, 21.390823301026032, -25.72590935970971, 16.55450226811989, -32.73066927372893, 5.34319353599788, 20.545443829106834, 11.62678635136924, -0.17862878322655484, 14.446409650633283, 13.287196526638652, 11.384018416220272, -17.505404252326684, -12.906719264041685, 14.34467551710304, 32.176607539749156, 13.47724217065868, 6.036161301792975, 7.190760542146823, 10.334847067017312, -12.507902470573152, 2.876632278214858, 7.0227714495791815, -11.058432221680727, -8.51214486306094, 5.215955518388059, 15.520531813031013, -11.119147241795101, -8.550429953880002, 5.440821545526773, 23.714234436150427, 17.867225627000504, 15.526180611164445, 17.170334225351233, -36.774475745371554, -8.653425346708042, 16.348671164443488, 12.91291058474934, 10.897500910615287, -11.686525075766417, -21.473625559488664, -14.310822965412171, -12.438615432771554, 12.17672007595152, 18.909828863927263, -4.7467877330854975, -13.55302930437792, 2.6580173647392433, 0.6283404225201747, 26.73561500587931, 8.946164039909494, 15.462754690434137, -4.855766993528085, 0.24792254607360342, -4.136617497567769, 12.329723790758663, 2.126413835856466, 2.7153187437789064, 16.85878099212693, 11.845774005285, -39.88217517746149, -25.25092302040153, 18.90936229830184, 15.234977517891156, -27.946884524427837, 9.986440759974872, -7.323914289679597, -35.21160146966838], "episode_lengths": [288, 265, 411, 295, 391, 399, 1117, 1117, 1117, 1117, 896, 642, 286, 1117, 763, 260, 307, 881, 259, 763, 1117, 945, 297, 728, 410, 651, 1117, 158, 295, 269, 398, 704, 763, 259, 414, 1117, 364, 406, 1117, 302, 391, 1117, 269, 1015, 760, 468, 295, 1117, 231, 295, 305, 295, 647, 410, 168, 836, 430, 1117, 1117, 761, 1117, 439, 295, 1117, 151, 295, 589, 409, 269, 295, 230, 373, 733, 439, 1117, 295, 1117, 367, 961, 373, 317, 295, 262, 1117, 1117, 330, 406, 269, 304, 1090, 1117, 259, 886, 381, 1088, 1108, 653, 294, 1117, 730]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.956849452961621, "mean_inference_ms": 6.579786459113547, "mean_action_processing_ms": 0.44760137407949896, "mean_env_wait_ms": 19.89241146274898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015552043914794922, "StateBufferConnector_ms": 0.01607656478881836, "ViewRequirementAgentConnector_ms": 0.6995265483856201}}, "episode_reward_max": 43.5135419347075, "episode_reward_min": -39.88217517746149, "episode_reward_mean": 2.9996353833985085, "episode_len_mean": 606.87, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.527796995675397, 16.691000577940628, -19.64530813741647, 10.509322043777974, -5.0214269127827, -14.363074016152067, 23.886572345164293, 5.230953160506586, 18.182236827923006, 11.762265368806581, 4.974772542522349, -36.02964685844383, 8.678123830940478, 43.5135419347075, 11.34346988519828, 16.86755176610816, 14.353993761820197, 18.585761114673307, 11.361334525175351, -13.744457319351511, 32.97225688509524, 24.884357733405675, 3.0806785176991056, 4.03016462433195, -11.653392753749962, -11.298453284664193, -6.114066921621664, 12.23716042242639, 4.66183278030419, 15.552175019006654, 4.623039805152056, -4.149517646616085, -20.911495593175314, 21.390823301026032, -25.72590935970971, 16.55450226811989, -32.73066927372893, 5.34319353599788, 20.545443829106834, 11.62678635136924, -0.17862878322655484, 14.446409650633283, 13.287196526638652, 11.384018416220272, -17.505404252326684, -12.906719264041685, 14.34467551710304, 32.176607539749156, 13.47724217065868, 6.036161301792975, 7.190760542146823, 10.334847067017312, -12.507902470573152, 2.876632278214858, 7.0227714495791815, -11.058432221680727, -8.51214486306094, 5.215955518388059, 15.520531813031013, -11.119147241795101, -8.550429953880002, 5.440821545526773, 23.714234436150427, 17.867225627000504, 15.526180611164445, 17.170334225351233, -36.774475745371554, -8.653425346708042, 16.348671164443488, 12.91291058474934, 10.897500910615287, -11.686525075766417, -21.473625559488664, -14.310822965412171, -12.438615432771554, 12.17672007595152, 18.909828863927263, -4.7467877330854975, -13.55302930437792, 2.6580173647392433, 0.6283404225201747, 26.73561500587931, 8.946164039909494, 15.462754690434137, -4.855766993528085, 0.24792254607360342, -4.136617497567769, 12.329723790758663, 2.126413835856466, 2.7153187437789064, 16.85878099212693, 11.845774005285, -39.88217517746149, -25.25092302040153, 18.90936229830184, 15.234977517891156, -27.946884524427837, 9.986440759974872, -7.323914289679597, -35.21160146966838], "episode_lengths": [288, 265, 411, 295, 391, 399, 1117, 1117, 1117, 1117, 896, 642, 286, 1117, 763, 260, 307, 881, 259, 763, 1117, 945, 297, 728, 410, 651, 1117, 158, 295, 269, 398, 704, 763, 259, 414, 1117, 364, 406, 1117, 302, 391, 1117, 269, 1015, 760, 468, 295, 1117, 231, 295, 305, 295, 647, 410, 168, 836, 430, 1117, 1117, 761, 1117, 439, 295, 1117, 151, 295, 589, 409, 269, 295, 230, 373, 733, 439, 1117, 295, 1117, 367, 961, 373, 317, 295, 262, 1117, 1117, 330, 406, 269, 304, 1090, 1117, 259, 886, 381, 1088, 1108, 653, 294, 1117, 730]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.956849452961621, "mean_inference_ms": 6.579786459113547, "mean_action_processing_ms": 0.44760137407949896, "mean_env_wait_ms": 19.89241146274898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015552043914794922, "StateBufferConnector_ms": 0.01607656478881836, "ViewRequirementAgentConnector_ms": 0.6995265483856201}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244586, "num_agent_steps_trained": 244586, "num_env_steps_sampled": 244586, "num_env_steps_trained": 244586, "num_env_steps_sampled_this_iter": 9702, "num_env_steps_trained_this_iter": 9702, "num_env_steps_sampled_throughput_per_sec": 217.89331183147212, "num_env_steps_trained_throughput_per_sec": 217.89331183147212, "timesteps_total": 244586, "num_steps_trained_this_iter": 9702, "agent_timesteps_total": 244586, "timers": {"training_iteration_time_ms": 41290.782, "sample_time_ms": 28405.077, "load_time_ms": 1141.819, "load_throughput": 7596.387, "learn_time_ms": 11266.302, "learn_throughput": 769.88, "synch_weights_time_ms": 409.196}, "counters": {"num_env_steps_sampled": 244586, "num_env_steps_trained": 244586, "num_agent_steps_sampled": 244586, "num_agent_steps_trained": 244586}, "done": false, "episodes_total": 437, "training_iteration": 31, "trial_id": "32ccc_00000", "date": "2025-06-07_12-21-33", "timestamp": 1749291693, "time_this_iter_s": 44.662123918533325, "time_total_s": 1217.4359436035156, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1217.4359436035156, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 55.505660377358495, "ram_util_percent": 75.40377358490565, "gpu_util_percent0": 0.15830188679245283, "vram_util_percent0": 0.9679361979166664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.755414000000002e-05, "total_loss": -0.15729903335527828, "policy_loss": -0.045763010221295794, "vf_loss": 0.08316846431232988, "vf_explained_var": 0.9321823690334956, "kl": 0.009435955569303985, "entropy": 15.68474017461141, "entropy_coeff": 0.00877707}, "model": {}, "num_grad_updates_lifetime": 8730.5, "diff_num_grad_updates_vs_sampler_policy": 149.5}}, "num_env_steps_sampled": 253257, "num_env_steps_trained": 253257, "num_agent_steps_sampled": 253257, "num_agent_steps_trained": 253257}, "sampler_results": {"episode_reward_max": 32.97225688509524, "episode_reward_min": -39.88217517746149, "episode_reward_mean": 2.605032238054227, "episode_len_mean": 599.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.34346988519828, 16.86755176610816, 14.353993761820197, 18.585761114673307, 11.361334525175351, -13.744457319351511, 32.97225688509524, 24.884357733405675, 3.0806785176991056, 4.03016462433195, -11.653392753749962, -11.298453284664193, -6.114066921621664, 12.23716042242639, 4.66183278030419, 15.552175019006654, 4.623039805152056, -4.149517646616085, -20.911495593175314, 21.390823301026032, -25.72590935970971, 16.55450226811989, -32.73066927372893, 5.34319353599788, 20.545443829106834, 11.62678635136924, -0.17862878322655484, 14.446409650633283, 13.287196526638652, 11.384018416220272, -17.505404252326684, -12.906719264041685, 14.34467551710304, 32.176607539749156, 13.47724217065868, 6.036161301792975, 7.190760542146823, 10.334847067017312, -12.507902470573152, 2.876632278214858, 7.0227714495791815, -11.058432221680727, -8.51214486306094, 5.215955518388059, 15.520531813031013, -11.119147241795101, -8.550429953880002, 5.440821545526773, 23.714234436150427, 17.867225627000504, 15.526180611164445, 17.170334225351233, -36.774475745371554, -8.653425346708042, 16.348671164443488, 12.91291058474934, 10.897500910615287, -11.686525075766417, -21.473625559488664, -14.310822965412171, -12.438615432771554, 12.17672007595152, 18.909828863927263, -4.7467877330854975, -13.55302930437792, 2.6580173647392433, 0.6283404225201747, 26.73561500587931, 8.946164039909494, 15.462754690434137, -4.855766993528085, 0.24792254607360342, -4.136617497567769, 12.329723790758663, 2.126413835856466, 2.7153187437789064, 16.85878099212693, 11.845774005285, -39.88217517746149, -25.25092302040153, 18.90936229830184, 15.234977517891156, -27.946884524427837, 9.986440759974872, -7.323914289679597, -35.21160146966838, 8.223076566379843, 3.9346782492765326, -16.847631284524518, 6.519133719667005, 12.162976752055418, -5.449309389657294, 18.050627203419605, -10.235015686807861, -0.45629618113969617, 30.302571459718273, -9.843090215625148, 20.45770417376039, 6.644510532774337, -25.027120730555417], "episode_lengths": [763, 260, 307, 881, 259, 763, 1117, 945, 297, 728, 410, 651, 1117, 158, 295, 269, 398, 704, 763, 259, 414, 1117, 364, 406, 1117, 302, 391, 1117, 269, 1015, 760, 468, 295, 1117, 231, 295, 305, 295, 647, 410, 168, 836, 430, 1117, 1117, 761, 1117, 439, 295, 1117, 151, 295, 589, 409, 269, 295, 230, 373, 733, 439, 1117, 295, 1117, 367, 961, 373, 317, 295, 262, 1117, 1117, 330, 406, 269, 304, 1090, 1117, 259, 886, 381, 1088, 1108, 653, 294, 1117, 730, 961, 796, 428, 148, 269, 415, 295, 333, 893, 1117, 1117, 295, 1117, 487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9525815474353572, "mean_inference_ms": 6.573809529005472, "mean_action_processing_ms": 0.44732107288182027, "mean_env_wait_ms": 19.876690908518615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016556262969970703, "StateBufferConnector_ms": 0.015095233917236328, "ViewRequirementAgentConnector_ms": 0.7160732746124268}}, "episode_reward_max": 32.97225688509524, "episode_reward_min": -39.88217517746149, "episode_reward_mean": 2.605032238054227, "episode_len_mean": 599.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.34346988519828, 16.86755176610816, 14.353993761820197, 18.585761114673307, 11.361334525175351, -13.744457319351511, 32.97225688509524, 24.884357733405675, 3.0806785176991056, 4.03016462433195, -11.653392753749962, -11.298453284664193, -6.114066921621664, 12.23716042242639, 4.66183278030419, 15.552175019006654, 4.623039805152056, -4.149517646616085, -20.911495593175314, 21.390823301026032, -25.72590935970971, 16.55450226811989, -32.73066927372893, 5.34319353599788, 20.545443829106834, 11.62678635136924, -0.17862878322655484, 14.446409650633283, 13.287196526638652, 11.384018416220272, -17.505404252326684, -12.906719264041685, 14.34467551710304, 32.176607539749156, 13.47724217065868, 6.036161301792975, 7.190760542146823, 10.334847067017312, -12.507902470573152, 2.876632278214858, 7.0227714495791815, -11.058432221680727, -8.51214486306094, 5.215955518388059, 15.520531813031013, -11.119147241795101, -8.550429953880002, 5.440821545526773, 23.714234436150427, 17.867225627000504, 15.526180611164445, 17.170334225351233, -36.774475745371554, -8.653425346708042, 16.348671164443488, 12.91291058474934, 10.897500910615287, -11.686525075766417, -21.473625559488664, -14.310822965412171, -12.438615432771554, 12.17672007595152, 18.909828863927263, -4.7467877330854975, -13.55302930437792, 2.6580173647392433, 0.6283404225201747, 26.73561500587931, 8.946164039909494, 15.462754690434137, -4.855766993528085, 0.24792254607360342, -4.136617497567769, 12.329723790758663, 2.126413835856466, 2.7153187437789064, 16.85878099212693, 11.845774005285, -39.88217517746149, -25.25092302040153, 18.90936229830184, 15.234977517891156, -27.946884524427837, 9.986440759974872, -7.323914289679597, -35.21160146966838, 8.223076566379843, 3.9346782492765326, -16.847631284524518, 6.519133719667005, 12.162976752055418, -5.449309389657294, 18.050627203419605, -10.235015686807861, -0.45629618113969617, 30.302571459718273, -9.843090215625148, 20.45770417376039, 6.644510532774337, -25.027120730555417], "episode_lengths": [763, 260, 307, 881, 259, 763, 1117, 945, 297, 728, 410, 651, 1117, 158, 295, 269, 398, 704, 763, 259, 414, 1117, 364, 406, 1117, 302, 391, 1117, 269, 1015, 760, 468, 295, 1117, 231, 295, 305, 295, 647, 410, 168, 836, 430, 1117, 1117, 761, 1117, 439, 295, 1117, 151, 295, 589, 409, 269, 295, 230, 373, 733, 439, 1117, 295, 1117, 367, 961, 373, 317, 295, 262, 1117, 1117, 330, 406, 269, 304, 1090, 1117, 259, 886, 381, 1088, 1108, 653, 294, 1117, 730, 961, 796, 428, 148, 269, 415, 295, 333, 893, 1117, 1117, 295, 1117, 487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9525815474353572, "mean_inference_ms": 6.573809529005472, "mean_action_processing_ms": 0.44732107288182027, "mean_env_wait_ms": 19.876690908518615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016556262969970703, "StateBufferConnector_ms": 0.015095233917236328, "ViewRequirementAgentConnector_ms": 0.7160732746124268}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 253257, "num_agent_steps_trained": 253257, "num_env_steps_sampled": 253257, "num_env_steps_trained": 253257, "num_env_steps_sampled_this_iter": 8671, "num_env_steps_trained_this_iter": 8671, "num_env_steps_sampled_throughput_per_sec": 207.5834548552485, "num_env_steps_trained_throughput_per_sec": 207.5834548552485, "timesteps_total": 253257, "num_steps_trained_this_iter": 8671, "agent_timesteps_total": 253257, "timers": {"training_iteration_time_ms": 41486.779, "sample_time_ms": 28479.472, "load_time_ms": 1142.252, "load_throughput": 7625.464, "learn_time_ms": 11383.295, "learn_throughput": 765.174, "synch_weights_time_ms": 409.482}, "counters": {"num_env_steps_sampled": 253257, "num_env_steps_trained": 253257, "num_agent_steps_sampled": 253257, "num_agent_steps_trained": 253257}, "done": false, "episodes_total": 451, "training_iteration": 32, "trial_id": "32ccc_00000", "date": "2025-06-07_12-22-15", "timestamp": 1749291735, "time_this_iter_s": 41.77115178108215, "time_total_s": 1259.2070953845978, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1259.2070953845978, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 53.21372549019607, "ram_util_percent": 74.78627450980392, "gpu_util_percent0": 0.17176470588235296, "vram_util_percent0": 0.9679361979166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.746742999999998e-05, "total_loss": -0.1285927738385996, "policy_loss": -0.020472090951948158, "vf_loss": 0.09377195087351627, "vf_explained_var": 0.9295151397105186, "kl": 0.009257988848221068, "entropy": 15.733227169898248, "entropy_coeff": 0.008733715000000001}, "model": {}, "num_grad_updates_lifetime": 9035.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 262030, "num_env_steps_trained": 262030, "num_agent_steps_sampled": 262030, "num_agent_steps_trained": 262030}, "sampler_results": {"episode_reward_max": 41.084420249932215, "episode_reward_min": -39.88217517746149, "episode_reward_mean": 2.452139056206274, "episode_len_mean": 600.17, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.66183278030419, 15.552175019006654, 4.623039805152056, -4.149517646616085, -20.911495593175314, 21.390823301026032, -25.72590935970971, 16.55450226811989, -32.73066927372893, 5.34319353599788, 20.545443829106834, 11.62678635136924, -0.17862878322655484, 14.446409650633283, 13.287196526638652, 11.384018416220272, -17.505404252326684, -12.906719264041685, 14.34467551710304, 32.176607539749156, 13.47724217065868, 6.036161301792975, 7.190760542146823, 10.334847067017312, -12.507902470573152, 2.876632278214858, 7.0227714495791815, -11.058432221680727, -8.51214486306094, 5.215955518388059, 15.520531813031013, -11.119147241795101, -8.550429953880002, 5.440821545526773, 23.714234436150427, 17.867225627000504, 15.526180611164445, 17.170334225351233, -36.774475745371554, -8.653425346708042, 16.348671164443488, 12.91291058474934, 10.897500910615287, -11.686525075766417, -21.473625559488664, -14.310822965412171, -12.438615432771554, 12.17672007595152, 18.909828863927263, -4.7467877330854975, -13.55302930437792, 2.6580173647392433, 0.6283404225201747, 26.73561500587931, 8.946164039909494, 15.462754690434137, -4.855766993528085, 0.24792254607360342, -4.136617497567769, 12.329723790758663, 2.126413835856466, 2.7153187437789064, 16.85878099212693, 11.845774005285, -39.88217517746149, -25.25092302040153, 18.90936229830184, 15.234977517891156, -27.946884524427837, 9.986440759974872, -7.323914289679597, -35.21160146966838, 8.223076566379843, 3.9346782492765326, -16.847631284524518, 6.519133719667005, 12.162976752055418, -5.449309389657294, 18.050627203419605, -10.235015686807861, -0.45629618113969617, 30.302571459718273, -9.843090215625148, 20.45770417376039, 6.644510532774337, -25.027120730555417, -6.080911502020509, 26.18196550746668, 26.36354177399619, 19.982507489932445, -26.840123346897137, 8.199031960611928, -31.337388417257248, -3.092827935475631, -5.159385065831184, 12.088942338864204, 14.799041506540549, 14.435206499205924, 0.9930197126826976, 41.084420249932215], "episode_lengths": [295, 269, 398, 704, 763, 259, 414, 1117, 364, 406, 1117, 302, 391, 1117, 269, 1015, 760, 468, 295, 1117, 231, 295, 305, 295, 647, 410, 168, 836, 430, 1117, 1117, 761, 1117, 439, 295, 1117, 151, 295, 589, 409, 269, 295, 230, 373, 733, 439, 1117, 295, 1117, 367, 961, 373, 317, 295, 262, 1117, 1117, 330, 406, 269, 304, 1090, 1117, 259, 886, 381, 1088, 1108, 653, 294, 1117, 730, 961, 796, 428, 148, 269, 415, 295, 333, 893, 1117, 1117, 295, 1117, 487, 614, 1117, 1117, 269, 409, 295, 1117, 457, 605, 328, 295, 269, 764, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9489262740319893, "mean_inference_ms": 6.567926742637832, "mean_action_processing_ms": 0.44695153872446214, "mean_env_wait_ms": 19.863481123222286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01703619956970215, "StateBufferConnector_ms": 0.01977062225341797, "ViewRequirementAgentConnector_ms": 0.7134771347045898}}, "episode_reward_max": 41.084420249932215, "episode_reward_min": -39.88217517746149, "episode_reward_mean": 2.452139056206274, "episode_len_mean": 600.17, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.66183278030419, 15.552175019006654, 4.623039805152056, -4.149517646616085, -20.911495593175314, 21.390823301026032, -25.72590935970971, 16.55450226811989, -32.73066927372893, 5.34319353599788, 20.545443829106834, 11.62678635136924, -0.17862878322655484, 14.446409650633283, 13.287196526638652, 11.384018416220272, -17.505404252326684, -12.906719264041685, 14.34467551710304, 32.176607539749156, 13.47724217065868, 6.036161301792975, 7.190760542146823, 10.334847067017312, -12.507902470573152, 2.876632278214858, 7.0227714495791815, -11.058432221680727, -8.51214486306094, 5.215955518388059, 15.520531813031013, -11.119147241795101, -8.550429953880002, 5.440821545526773, 23.714234436150427, 17.867225627000504, 15.526180611164445, 17.170334225351233, -36.774475745371554, -8.653425346708042, 16.348671164443488, 12.91291058474934, 10.897500910615287, -11.686525075766417, -21.473625559488664, -14.310822965412171, -12.438615432771554, 12.17672007595152, 18.909828863927263, -4.7467877330854975, -13.55302930437792, 2.6580173647392433, 0.6283404225201747, 26.73561500587931, 8.946164039909494, 15.462754690434137, -4.855766993528085, 0.24792254607360342, -4.136617497567769, 12.329723790758663, 2.126413835856466, 2.7153187437789064, 16.85878099212693, 11.845774005285, -39.88217517746149, -25.25092302040153, 18.90936229830184, 15.234977517891156, -27.946884524427837, 9.986440759974872, -7.323914289679597, -35.21160146966838, 8.223076566379843, 3.9346782492765326, -16.847631284524518, 6.519133719667005, 12.162976752055418, -5.449309389657294, 18.050627203419605, -10.235015686807861, -0.45629618113969617, 30.302571459718273, -9.843090215625148, 20.45770417376039, 6.644510532774337, -25.027120730555417, -6.080911502020509, 26.18196550746668, 26.36354177399619, 19.982507489932445, -26.840123346897137, 8.199031960611928, -31.337388417257248, -3.092827935475631, -5.159385065831184, 12.088942338864204, 14.799041506540549, 14.435206499205924, 0.9930197126826976, 41.084420249932215], "episode_lengths": [295, 269, 398, 704, 763, 259, 414, 1117, 364, 406, 1117, 302, 391, 1117, 269, 1015, 760, 468, 295, 1117, 231, 295, 305, 295, 647, 410, 168, 836, 430, 1117, 1117, 761, 1117, 439, 295, 1117, 151, 295, 589, 409, 269, 295, 230, 373, 733, 439, 1117, 295, 1117, 367, 961, 373, 317, 295, 262, 1117, 1117, 330, 406, 269, 304, 1090, 1117, 259, 886, 381, 1088, 1108, 653, 294, 1117, 730, 961, 796, 428, 148, 269, 415, 295, 333, 893, 1117, 1117, 295, 1117, 487, 614, 1117, 1117, 269, 409, 295, 1117, 457, 605, 328, 295, 269, 764, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9489262740319893, "mean_inference_ms": 6.567926742637832, "mean_action_processing_ms": 0.44695153872446214, "mean_env_wait_ms": 19.863481123222286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01703619956970215, "StateBufferConnector_ms": 0.01977062225341797, "ViewRequirementAgentConnector_ms": 0.7134771347045898}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 262030, "num_agent_steps_trained": 262030, "num_env_steps_sampled": 262030, "num_env_steps_trained": 262030, "num_env_steps_sampled_this_iter": 8773, "num_env_steps_trained_this_iter": 8773, "num_env_steps_sampled_throughput_per_sec": 202.5661782372544, "num_env_steps_trained_throughput_per_sec": 202.5661782372544, "timesteps_total": 262030, "num_steps_trained_this_iter": 8773, "agent_timesteps_total": 262030, "timers": {"training_iteration_time_ms": 41110.538, "sample_time_ms": 28176.106, "load_time_ms": 1104.54, "load_throughput": 7764.136, "learn_time_ms": 11346.346, "learn_throughput": 755.82, "synch_weights_time_ms": 410.839}, "counters": {"num_env_steps_sampled": 262030, "num_env_steps_trained": 262030, "num_agent_steps_sampled": 262030, "num_agent_steps_trained": 262030}, "done": false, "episodes_total": 465, "training_iteration": 33, "trial_id": "32ccc_00000", "date": "2025-06-07_12-22-58", "timestamp": 1749291778, "time_this_iter_s": 43.32630395889282, "time_total_s": 1302.5333993434906, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1302.5333993434906, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 51.7153846153846, "ram_util_percent": 75.26153846153846, "gpu_util_percent0": 0.19846153846153844, "vram_util_percent0": 0.9679361979166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.73797e-05, "total_loss": -0.12677622094863755, "policy_loss": -0.015157472471458421, "vf_loss": 0.08271372797653863, "vf_explained_var": 0.9303750662427199, "kl": 0.008327339228325351, "entropy": 15.820041766919587, "entropy_coeff": 0.00868985}, "model": {}, "num_grad_updates_lifetime": 9380.5, "diff_num_grad_updates_vs_sampler_policy": 189.5}}, "num_env_steps_sampled": 272672, "num_env_steps_trained": 272672, "num_agent_steps_sampled": 272672, "num_agent_steps_trained": 272672}, "sampler_results": {"episode_reward_max": 41.084420249932215, "episode_reward_min": -88.10429458502617, "episode_reward_mean": 2.8943175783771977, "episode_len_mean": 627.43, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.287196526638652, 11.384018416220272, -17.505404252326684, -12.906719264041685, 14.34467551710304, 32.176607539749156, 13.47724217065868, 6.036161301792975, 7.190760542146823, 10.334847067017312, -12.507902470573152, 2.876632278214858, 7.0227714495791815, -11.058432221680727, -8.51214486306094, 5.215955518388059, 15.520531813031013, -11.119147241795101, -8.550429953880002, 5.440821545526773, 23.714234436150427, 17.867225627000504, 15.526180611164445, 17.170334225351233, -36.774475745371554, -8.653425346708042, 16.348671164443488, 12.91291058474934, 10.897500910615287, -11.686525075766417, -21.473625559488664, -14.310822965412171, -12.438615432771554, 12.17672007595152, 18.909828863927263, -4.7467877330854975, -13.55302930437792, 2.6580173647392433, 0.6283404225201747, 26.73561500587931, 8.946164039909494, 15.462754690434137, -4.855766993528085, 0.24792254607360342, -4.136617497567769, 12.329723790758663, 2.126413835856466, 2.7153187437789064, 16.85878099212693, 11.845774005285, -39.88217517746149, -25.25092302040153, 18.90936229830184, 15.234977517891156, -27.946884524427837, 9.986440759974872, -7.323914289679597, -35.21160146966838, 8.223076566379843, 3.9346782492765326, -16.847631284524518, 6.519133719667005, 12.162976752055418, -5.449309389657294, 18.050627203419605, -10.235015686807861, -0.45629618113969617, 30.302571459718273, -9.843090215625148, 20.45770417376039, 6.644510532774337, -25.027120730555417, -6.080911502020509, 26.18196550746668, 26.36354177399619, 19.982507489932445, -26.840123346897137, 8.199031960611928, -31.337388417257248, -3.092827935475631, -5.159385065831184, 12.088942338864204, 14.799041506540549, 14.435206499205924, 0.9930197126826976, 41.084420249932215, 19.05722229096691, -88.10429458502617, 9.795923586233057, 15.664150698406889, 17.805568595071424, 4.448362417596291, -11.261193779094338, 34.877315840032274, 4.806833100412155, 28.650038064486303, 8.576354253183462, -15.961776335094743, 21.96628007990696, 24.945053874271412], "episode_lengths": [269, 1015, 760, 468, 295, 1117, 231, 295, 305, 295, 647, 410, 168, 836, 430, 1117, 1117, 761, 1117, 439, 295, 1117, 151, 295, 589, 409, 269, 295, 230, 373, 733, 439, 1117, 295, 1117, 367, 961, 373, 317, 295, 262, 1117, 1117, 330, 406, 269, 304, 1090, 1117, 259, 886, 381, 1088, 1108, 653, 294, 1117, 730, 961, 796, 428, 148, 269, 415, 295, 333, 893, 1117, 1117, 295, 1117, 487, 614, 1117, 1117, 269, 409, 295, 1117, 457, 605, 328, 295, 269, 764, 1117, 956, 896, 353, 295, 1117, 288, 376, 1097, 931, 1117, 148, 834, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9444614622705327, "mean_inference_ms": 6.562320066447696, "mean_action_processing_ms": 0.44660676481027556, "mean_env_wait_ms": 19.850854802896563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031685590744018555, "StateBufferConnector_ms": 0.019786596298217773, "ViewRequirementAgentConnector_ms": 0.6941103935241699}}, "episode_reward_max": 41.084420249932215, "episode_reward_min": -88.10429458502617, "episode_reward_mean": 2.8943175783771977, "episode_len_mean": 627.43, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.287196526638652, 11.384018416220272, -17.505404252326684, -12.906719264041685, 14.34467551710304, 32.176607539749156, 13.47724217065868, 6.036161301792975, 7.190760542146823, 10.334847067017312, -12.507902470573152, 2.876632278214858, 7.0227714495791815, -11.058432221680727, -8.51214486306094, 5.215955518388059, 15.520531813031013, -11.119147241795101, -8.550429953880002, 5.440821545526773, 23.714234436150427, 17.867225627000504, 15.526180611164445, 17.170334225351233, -36.774475745371554, -8.653425346708042, 16.348671164443488, 12.91291058474934, 10.897500910615287, -11.686525075766417, -21.473625559488664, -14.310822965412171, -12.438615432771554, 12.17672007595152, 18.909828863927263, -4.7467877330854975, -13.55302930437792, 2.6580173647392433, 0.6283404225201747, 26.73561500587931, 8.946164039909494, 15.462754690434137, -4.855766993528085, 0.24792254607360342, -4.136617497567769, 12.329723790758663, 2.126413835856466, 2.7153187437789064, 16.85878099212693, 11.845774005285, -39.88217517746149, -25.25092302040153, 18.90936229830184, 15.234977517891156, -27.946884524427837, 9.986440759974872, -7.323914289679597, -35.21160146966838, 8.223076566379843, 3.9346782492765326, -16.847631284524518, 6.519133719667005, 12.162976752055418, -5.449309389657294, 18.050627203419605, -10.235015686807861, -0.45629618113969617, 30.302571459718273, -9.843090215625148, 20.45770417376039, 6.644510532774337, -25.027120730555417, -6.080911502020509, 26.18196550746668, 26.36354177399619, 19.982507489932445, -26.840123346897137, 8.199031960611928, -31.337388417257248, -3.092827935475631, -5.159385065831184, 12.088942338864204, 14.799041506540549, 14.435206499205924, 0.9930197126826976, 41.084420249932215, 19.05722229096691, -88.10429458502617, 9.795923586233057, 15.664150698406889, 17.805568595071424, 4.448362417596291, -11.261193779094338, 34.877315840032274, 4.806833100412155, 28.650038064486303, 8.576354253183462, -15.961776335094743, 21.96628007990696, 24.945053874271412], "episode_lengths": [269, 1015, 760, 468, 295, 1117, 231, 295, 305, 295, 647, 410, 168, 836, 430, 1117, 1117, 761, 1117, 439, 295, 1117, 151, 295, 589, 409, 269, 295, 230, 373, 733, 439, 1117, 295, 1117, 367, 961, 373, 317, 295, 262, 1117, 1117, 330, 406, 269, 304, 1090, 1117, 259, 886, 381, 1088, 1108, 653, 294, 1117, 730, 961, 796, 428, 148, 269, 415, 295, 333, 893, 1117, 1117, 295, 1117, 487, 614, 1117, 1117, 269, 409, 295, 1117, 457, 605, 328, 295, 269, 764, 1117, 956, 896, 353, 295, 1117, 288, 376, 1097, 931, 1117, 148, 834, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9444614622705327, "mean_inference_ms": 6.562320066447696, "mean_action_processing_ms": 0.44660676481027556, "mean_env_wait_ms": 19.850854802896563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031685590744018555, "StateBufferConnector_ms": 0.019786596298217773, "ViewRequirementAgentConnector_ms": 0.6941103935241699}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272672, "num_agent_steps_trained": 272672, "num_env_steps_sampled": 272672, "num_env_steps_trained": 272672, "num_env_steps_sampled_this_iter": 10642, "num_env_steps_trained_this_iter": 10642, "num_env_steps_sampled_throughput_per_sec": 219.97097354670115, "num_env_steps_trained_throughput_per_sec": 219.97097354670115, "timesteps_total": 272672, "num_steps_trained_this_iter": 10642, "agent_timesteps_total": 272672, "timers": {"training_iteration_time_ms": 42110.366, "sample_time_ms": 28627.889, "load_time_ms": 1142.573, "load_throughput": 7721.167, "learn_time_ms": 11852.948, "learn_throughput": 744.287, "synch_weights_time_ms": 411.845}, "counters": {"num_env_steps_sampled": 272672, "num_env_steps_trained": 272672, "num_agent_steps_sampled": 272672, "num_agent_steps_trained": 272672}, "done": false, "episodes_total": 479, "training_iteration": 34, "trial_id": "32ccc_00000", "date": "2025-06-07_12-23-47", "timestamp": 1749291827, "time_this_iter_s": 48.39509630203247, "time_total_s": 1350.928495645523, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1350.928495645523, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 57.146551724137936, "ram_util_percent": 76.02241379310347, "gpu_util_percent0": 0.16913793103448277, "vram_util_percent0": 0.9679361979166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.727328000000002e-05, "total_loss": -0.13487130531072114, "policy_loss": -0.020268660992096066, "vf_loss": 0.06737934857908938, "vf_explained_var": 0.9282857659700755, "kl": 0.009504244220993684, "entropy": 15.74738279806601, "entropy_coeff": 0.008636640000000001}, "model": {}, "num_grad_updates_lifetime": 9755.5, "diff_num_grad_updates_vs_sampler_policy": 184.5}}, "num_env_steps_sampled": 283270, "num_env_steps_trained": 283270, "num_agent_steps_sampled": 283270, "num_agent_steps_trained": 283270}, "sampler_results": {"episode_reward_max": 41.084420249932215, "episode_reward_min": -88.10429458502617, "episode_reward_mean": 4.150757979566687, "episode_len_mean": 662.3, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.51214486306094, 5.215955518388059, 15.520531813031013, -11.119147241795101, -8.550429953880002, 5.440821545526773, 23.714234436150427, 17.867225627000504, 15.526180611164445, 17.170334225351233, -36.774475745371554, -8.653425346708042, 16.348671164443488, 12.91291058474934, 10.897500910615287, -11.686525075766417, -21.473625559488664, -14.310822965412171, -12.438615432771554, 12.17672007595152, 18.909828863927263, -4.7467877330854975, -13.55302930437792, 2.6580173647392433, 0.6283404225201747, 26.73561500587931, 8.946164039909494, 15.462754690434137, -4.855766993528085, 0.24792254607360342, -4.136617497567769, 12.329723790758663, 2.126413835856466, 2.7153187437789064, 16.85878099212693, 11.845774005285, -39.88217517746149, -25.25092302040153, 18.90936229830184, 15.234977517891156, -27.946884524427837, 9.986440759974872, -7.323914289679597, -35.21160146966838, 8.223076566379843, 3.9346782492765326, -16.847631284524518, 6.519133719667005, 12.162976752055418, -5.449309389657294, 18.050627203419605, -10.235015686807861, -0.45629618113969617, 30.302571459718273, -9.843090215625148, 20.45770417376039, 6.644510532774337, -25.027120730555417, -6.080911502020509, 26.18196550746668, 26.36354177399619, 19.982507489932445, -26.840123346897137, 8.199031960611928, -31.337388417257248, -3.092827935475631, -5.159385065831184, 12.088942338864204, 14.799041506540549, 14.435206499205924, 0.9930197126826976, 41.084420249932215, 19.05722229096691, -88.10429458502617, 9.795923586233057, 15.664150698406889, 17.805568595071424, 4.448362417596291, -11.261193779094338, 34.877315840032274, 4.806833100412155, 28.650038064486303, 8.576354253183462, -15.961776335094743, 21.96628007990696, 24.945053874271412, 5.8649517000123845, 18.746031619947285, 13.3701420329733, 16.16627480525723, 28.463978173875212, 18.43277199638174, -13.832507395095105, 26.394643619250925, 8.855265955480624, 14.218135758636445, 24.191377528063878, 10.573574552992334, 8.740995808389298, 9.610858563282072], "episode_lengths": [430, 1117, 1117, 761, 1117, 439, 295, 1117, 151, 295, 589, 409, 269, 295, 230, 373, 733, 439, 1117, 295, 1117, 367, 961, 373, 317, 295, 262, 1117, 1117, 330, 406, 269, 304, 1090, 1117, 259, 886, 381, 1088, 1108, 653, 294, 1117, 730, 961, 796, 428, 148, 269, 415, 295, 333, 893, 1117, 1117, 295, 1117, 487, 614, 1117, 1117, 269, 409, 295, 1117, 457, 605, 328, 295, 269, 764, 1117, 956, 896, 353, 295, 1117, 288, 376, 1097, 931, 1117, 148, 834, 1117, 1117, 673, 268, 295, 1117, 1117, 1117, 401, 1117, 269, 799, 1117, 1117, 874, 317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9407505637253883, "mean_inference_ms": 6.557643087869751, "mean_action_processing_ms": 0.4462900742715813, "mean_env_wait_ms": 19.8410280723172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03071308135986328, "StateBufferConnector_ms": 0.019779205322265625, "ViewRequirementAgentConnector_ms": 0.670128345489502}}, "episode_reward_max": 41.084420249932215, "episode_reward_min": -88.10429458502617, "episode_reward_mean": 4.150757979566687, "episode_len_mean": 662.3, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.51214486306094, 5.215955518388059, 15.520531813031013, -11.119147241795101, -8.550429953880002, 5.440821545526773, 23.714234436150427, 17.867225627000504, 15.526180611164445, 17.170334225351233, -36.774475745371554, -8.653425346708042, 16.348671164443488, 12.91291058474934, 10.897500910615287, -11.686525075766417, -21.473625559488664, -14.310822965412171, -12.438615432771554, 12.17672007595152, 18.909828863927263, -4.7467877330854975, -13.55302930437792, 2.6580173647392433, 0.6283404225201747, 26.73561500587931, 8.946164039909494, 15.462754690434137, -4.855766993528085, 0.24792254607360342, -4.136617497567769, 12.329723790758663, 2.126413835856466, 2.7153187437789064, 16.85878099212693, 11.845774005285, -39.88217517746149, -25.25092302040153, 18.90936229830184, 15.234977517891156, -27.946884524427837, 9.986440759974872, -7.323914289679597, -35.21160146966838, 8.223076566379843, 3.9346782492765326, -16.847631284524518, 6.519133719667005, 12.162976752055418, -5.449309389657294, 18.050627203419605, -10.235015686807861, -0.45629618113969617, 30.302571459718273, -9.843090215625148, 20.45770417376039, 6.644510532774337, -25.027120730555417, -6.080911502020509, 26.18196550746668, 26.36354177399619, 19.982507489932445, -26.840123346897137, 8.199031960611928, -31.337388417257248, -3.092827935475631, -5.159385065831184, 12.088942338864204, 14.799041506540549, 14.435206499205924, 0.9930197126826976, 41.084420249932215, 19.05722229096691, -88.10429458502617, 9.795923586233057, 15.664150698406889, 17.805568595071424, 4.448362417596291, -11.261193779094338, 34.877315840032274, 4.806833100412155, 28.650038064486303, 8.576354253183462, -15.961776335094743, 21.96628007990696, 24.945053874271412, 5.8649517000123845, 18.746031619947285, 13.3701420329733, 16.16627480525723, 28.463978173875212, 18.43277199638174, -13.832507395095105, 26.394643619250925, 8.855265955480624, 14.218135758636445, 24.191377528063878, 10.573574552992334, 8.740995808389298, 9.610858563282072], "episode_lengths": [430, 1117, 1117, 761, 1117, 439, 295, 1117, 151, 295, 589, 409, 269, 295, 230, 373, 733, 439, 1117, 295, 1117, 367, 961, 373, 317, 295, 262, 1117, 1117, 330, 406, 269, 304, 1090, 1117, 259, 886, 381, 1088, 1108, 653, 294, 1117, 730, 961, 796, 428, 148, 269, 415, 295, 333, 893, 1117, 1117, 295, 1117, 487, 614, 1117, 1117, 269, 409, 295, 1117, 457, 605, 328, 295, 269, 764, 1117, 956, 896, 353, 295, 1117, 288, 376, 1097, 931, 1117, 148, 834, 1117, 1117, 673, 268, 295, 1117, 1117, 1117, 401, 1117, 269, 799, 1117, 1117, 874, 317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9407505637253883, "mean_inference_ms": 6.557643087869751, "mean_action_processing_ms": 0.4462900742715813, "mean_env_wait_ms": 19.8410280723172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03071308135986328, "StateBufferConnector_ms": 0.019779205322265625, "ViewRequirementAgentConnector_ms": 0.670128345489502}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283270, "num_agent_steps_trained": 283270, "num_env_steps_sampled": 283270, "num_env_steps_trained": 283270, "num_env_steps_sampled_this_iter": 10598, "num_env_steps_trained_this_iter": 10598, "num_env_steps_sampled_throughput_per_sec": 218.21928673090758, "num_env_steps_trained_throughput_per_sec": 218.21928673090758, "timesteps_total": 283270, "num_steps_trained_this_iter": 10598, "agent_timesteps_total": 283270, "timers": {"training_iteration_time_ms": 42431.562, "sample_time_ms": 28768.609, "load_time_ms": 1307.342, "load_throughput": 6799.293, "learn_time_ms": 11863.25, "learn_throughput": 749.289, "synch_weights_time_ms": 415.216}, "counters": {"num_env_steps_sampled": 283270, "num_env_steps_trained": 283270, "num_agent_steps_sampled": 283270, "num_agent_steps_trained": 283270}, "done": false, "episodes_total": 493, "training_iteration": 35, "trial_id": "32ccc_00000", "date": "2025-06-07_12-24-36", "timestamp": 1749291876, "time_this_iter_s": 48.57367396354675, "time_total_s": 1399.5021696090698, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1399.5021696090698, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 58.15, "ram_util_percent": 77.7551724137931, "gpu_util_percent0": 0.16086206896551725, "vram_util_percent0": 0.9677285380747126}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.71673e-05, "total_loss": -0.1412553248235353, "policy_loss": -0.02991819571054614, "vf_loss": 0.07885461521389729, "vf_explained_var": 0.9330915531691383, "kl": 0.00976723816814285, "entropy": 15.86905571713167, "entropy_coeff": 0.00858365}, "model": {}, "num_grad_updates_lifetime": 10110.5, "diff_num_grad_updates_vs_sampler_policy": 169.5}}, "num_env_steps_sampled": 293066, "num_env_steps_trained": 293066, "num_agent_steps_sampled": 293066, "num_agent_steps_trained": 293066}, "sampler_results": {"episode_reward_max": 41.084420249932215, "episode_reward_min": -88.10429458502617, "episode_reward_mean": 4.755130217958649, "episode_len_mean": 676.25, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.897500910615287, -11.686525075766417, -21.473625559488664, -14.310822965412171, -12.438615432771554, 12.17672007595152, 18.909828863927263, -4.7467877330854975, -13.55302930437792, 2.6580173647392433, 0.6283404225201747, 26.73561500587931, 8.946164039909494, 15.462754690434137, -4.855766993528085, 0.24792254607360342, -4.136617497567769, 12.329723790758663, 2.126413835856466, 2.7153187437789064, 16.85878099212693, 11.845774005285, -39.88217517746149, -25.25092302040153, 18.90936229830184, 15.234977517891156, -27.946884524427837, 9.986440759974872, -7.323914289679597, -35.21160146966838, 8.223076566379843, 3.9346782492765326, -16.847631284524518, 6.519133719667005, 12.162976752055418, -5.449309389657294, 18.050627203419605, -10.235015686807861, -0.45629618113969617, 30.302571459718273, -9.843090215625148, 20.45770417376039, 6.644510532774337, -25.027120730555417, -6.080911502020509, 26.18196550746668, 26.36354177399619, 19.982507489932445, -26.840123346897137, 8.199031960611928, -31.337388417257248, -3.092827935475631, -5.159385065831184, 12.088942338864204, 14.799041506540549, 14.435206499205924, 0.9930197126826976, 41.084420249932215, 19.05722229096691, -88.10429458502617, 9.795923586233057, 15.664150698406889, 17.805568595071424, 4.448362417596291, -11.261193779094338, 34.877315840032274, 4.806833100412155, 28.650038064486303, 8.576354253183462, -15.961776335094743, 21.96628007990696, 24.945053874271412, 5.8649517000123845, 18.746031619947285, 13.3701420329733, 16.16627480525723, 28.463978173875212, 18.43277199638174, -13.832507395095105, 26.394643619250925, 8.855265955480624, 14.218135758636445, 24.191377528063878, 10.573574552992334, 8.740995808389298, 9.610858563282072, 5.037509087106132, -5.766611863774311, -5.129012594502318, 17.08343883040294, 6.030743370126614, -4.305620648261771, 25.27040646349318, 31.882353727628693, 12.973040503964706, 27.259329979323507, -14.755867711771469, 10.577174668947256, 16.377165583783967, -5.989583182281223], "episode_lengths": [230, 373, 733, 439, 1117, 295, 1117, 367, 961, 373, 317, 295, 262, 1117, 1117, 330, 406, 269, 304, 1090, 1117, 259, 886, 381, 1088, 1108, 653, 294, 1117, 730, 961, 796, 428, 148, 269, 415, 295, 333, 893, 1117, 1117, 295, 1117, 487, 614, 1117, 1117, 269, 409, 295, 1117, 457, 605, 328, 295, 269, 764, 1117, 956, 896, 353, 295, 1117, 288, 376, 1097, 931, 1117, 148, 834, 1117, 1117, 673, 268, 295, 1117, 1117, 1117, 401, 1117, 269, 799, 1117, 1117, 874, 317, 950, 824, 605, 295, 304, 416, 1117, 1117, 295, 1117, 637, 763, 295, 1061]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9373141945415062, "mean_inference_ms": 6.555753409076742, "mean_action_processing_ms": 0.44606888211970214, "mean_env_wait_ms": 19.839648513772858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034633636474609375, "StateBufferConnector_ms": 0.024801254272460938, "ViewRequirementAgentConnector_ms": 0.6319077014923096}}, "episode_reward_max": 41.084420249932215, "episode_reward_min": -88.10429458502617, "episode_reward_mean": 4.755130217958649, "episode_len_mean": 676.25, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.897500910615287, -11.686525075766417, -21.473625559488664, -14.310822965412171, -12.438615432771554, 12.17672007595152, 18.909828863927263, -4.7467877330854975, -13.55302930437792, 2.6580173647392433, 0.6283404225201747, 26.73561500587931, 8.946164039909494, 15.462754690434137, -4.855766993528085, 0.24792254607360342, -4.136617497567769, 12.329723790758663, 2.126413835856466, 2.7153187437789064, 16.85878099212693, 11.845774005285, -39.88217517746149, -25.25092302040153, 18.90936229830184, 15.234977517891156, -27.946884524427837, 9.986440759974872, -7.323914289679597, -35.21160146966838, 8.223076566379843, 3.9346782492765326, -16.847631284524518, 6.519133719667005, 12.162976752055418, -5.449309389657294, 18.050627203419605, -10.235015686807861, -0.45629618113969617, 30.302571459718273, -9.843090215625148, 20.45770417376039, 6.644510532774337, -25.027120730555417, -6.080911502020509, 26.18196550746668, 26.36354177399619, 19.982507489932445, -26.840123346897137, 8.199031960611928, -31.337388417257248, -3.092827935475631, -5.159385065831184, 12.088942338864204, 14.799041506540549, 14.435206499205924, 0.9930197126826976, 41.084420249932215, 19.05722229096691, -88.10429458502617, 9.795923586233057, 15.664150698406889, 17.805568595071424, 4.448362417596291, -11.261193779094338, 34.877315840032274, 4.806833100412155, 28.650038064486303, 8.576354253183462, -15.961776335094743, 21.96628007990696, 24.945053874271412, 5.8649517000123845, 18.746031619947285, 13.3701420329733, 16.16627480525723, 28.463978173875212, 18.43277199638174, -13.832507395095105, 26.394643619250925, 8.855265955480624, 14.218135758636445, 24.191377528063878, 10.573574552992334, 8.740995808389298, 9.610858563282072, 5.037509087106132, -5.766611863774311, -5.129012594502318, 17.08343883040294, 6.030743370126614, -4.305620648261771, 25.27040646349318, 31.882353727628693, 12.973040503964706, 27.259329979323507, -14.755867711771469, 10.577174668947256, 16.377165583783967, -5.989583182281223], "episode_lengths": [230, 373, 733, 439, 1117, 295, 1117, 367, 961, 373, 317, 295, 262, 1117, 1117, 330, 406, 269, 304, 1090, 1117, 259, 886, 381, 1088, 1108, 653, 294, 1117, 730, 961, 796, 428, 148, 269, 415, 295, 333, 893, 1117, 1117, 295, 1117, 487, 614, 1117, 1117, 269, 409, 295, 1117, 457, 605, 328, 295, 269, 764, 1117, 956, 896, 353, 295, 1117, 288, 376, 1097, 931, 1117, 148, 834, 1117, 1117, 673, 268, 295, 1117, 1117, 1117, 401, 1117, 269, 799, 1117, 1117, 874, 317, 950, 824, 605, 295, 304, 416, 1117, 1117, 295, 1117, 637, 763, 295, 1061]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9373141945415062, "mean_inference_ms": 6.555753409076742, "mean_action_processing_ms": 0.44606888211970214, "mean_env_wait_ms": 19.839648513772858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034633636474609375, "StateBufferConnector_ms": 0.024801254272460938, "ViewRequirementAgentConnector_ms": 0.6319077014923096}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 293066, "num_agent_steps_trained": 293066, "num_env_steps_sampled": 293066, "num_env_steps_trained": 293066, "num_env_steps_sampled_this_iter": 9796, "num_env_steps_trained_this_iter": 9796, "num_env_steps_sampled_throughput_per_sec": 209.97020040615578, "num_env_steps_trained_throughput_per_sec": 209.97020040615578, "timesteps_total": 293066, "num_steps_trained_this_iter": 9796, "agent_timesteps_total": 293066, "timers": {"training_iteration_time_ms": 43157.887, "sample_time_ms": 29083.697, "load_time_ms": 1343.754, "load_throughput": 6734.047, "learn_time_ms": 12202.894, "learn_throughput": 741.537, "synch_weights_time_ms": 448.959}, "counters": {"num_env_steps_sampled": 293066, "num_env_steps_trained": 293066, "num_agent_steps_sampled": 293066, "num_agent_steps_trained": 293066}, "done": false, "episodes_total": 507, "training_iteration": 36, "trial_id": "32ccc_00000", "date": "2025-06-07_12-25-22", "timestamp": 1749291922, "time_this_iter_s": 46.672240257263184, "time_total_s": 1446.174409866333, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1446.174409866333, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 55.901785714285715, "ram_util_percent": 80.57678571428572, "gpu_util_percent0": 0.1901785714285714, "vram_util_percent0": 0.96728515625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.706934e-05, "total_loss": -0.1314822916261619, "policy_loss": -0.018777829288554034, "vf_loss": 0.07262910662316963, "vf_explained_var": 0.9251525577745939, "kl": 0.009663775369163456, "entropy": 15.899990425611797, "entropy_coeff": 0.00853467}, "model": {}, "num_grad_updates_lifetime": 10470.5, "diff_num_grad_updates_vs_sampler_policy": 189.5}}, "num_env_steps_sampled": 303879, "num_env_steps_trained": 303879, "num_agent_steps_sampled": 303879, "num_agent_steps_trained": 303879}, "sampler_results": {"episode_reward_max": 41.084420249932215, "episode_reward_min": -88.10429458502617, "episode_reward_mean": 6.613894313010272, "episode_len_mean": 704.42, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.855766993528085, 0.24792254607360342, -4.136617497567769, 12.329723790758663, 2.126413835856466, 2.7153187437789064, 16.85878099212693, 11.845774005285, -39.88217517746149, -25.25092302040153, 18.90936229830184, 15.234977517891156, -27.946884524427837, 9.986440759974872, -7.323914289679597, -35.21160146966838, 8.223076566379843, 3.9346782492765326, -16.847631284524518, 6.519133719667005, 12.162976752055418, -5.449309389657294, 18.050627203419605, -10.235015686807861, -0.45629618113969617, 30.302571459718273, -9.843090215625148, 20.45770417376039, 6.644510532774337, -25.027120730555417, -6.080911502020509, 26.18196550746668, 26.36354177399619, 19.982507489932445, -26.840123346897137, 8.199031960611928, -31.337388417257248, -3.092827935475631, -5.159385065831184, 12.088942338864204, 14.799041506540549, 14.435206499205924, 0.9930197126826976, 41.084420249932215, 19.05722229096691, -88.10429458502617, 9.795923586233057, 15.664150698406889, 17.805568595071424, 4.448362417596291, -11.261193779094338, 34.877315840032274, 4.806833100412155, 28.650038064486303, 8.576354253183462, -15.961776335094743, 21.96628007990696, 24.945053874271412, 5.8649517000123845, 18.746031619947285, 13.3701420329733, 16.16627480525723, 28.463978173875212, 18.43277199638174, -13.832507395095105, 26.394643619250925, 8.855265955480624, 14.218135758636445, 24.191377528063878, 10.573574552992334, 8.740995808389298, 9.610858563282072, 5.037509087106132, -5.766611863774311, -5.129012594502318, 17.08343883040294, 6.030743370126614, -4.305620648261771, 25.27040646349318, 31.882353727628693, 12.973040503964706, 27.259329979323507, -14.755867711771469, 10.577174668947256, 16.377165583783967, -5.989583182281223, 9.414705553731572, 17.32173371599693, 14.299521243154599, 11.388175078037756, 34.59315757355221, 23.311471871050284, -18.97771827206977, 12.172502036802198, 3.2654722116153074, 32.70948859549222, -0.3553826322896345, 25.331574426365208, 13.465329829585833, 26.141913577211746], "episode_lengths": [1117, 330, 406, 269, 304, 1090, 1117, 259, 886, 381, 1088, 1108, 653, 294, 1117, 730, 961, 796, 428, 148, 269, 415, 295, 333, 893, 1117, 1117, 295, 1117, 487, 614, 1117, 1117, 269, 409, 295, 1117, 457, 605, 328, 295, 269, 764, 1117, 956, 896, 353, 295, 1117, 288, 376, 1097, 931, 1117, 148, 834, 1117, 1117, 673, 268, 295, 1117, 1117, 1117, 401, 1117, 269, 799, 1117, 1117, 874, 317, 950, 824, 605, 295, 304, 416, 1117, 1117, 295, 1117, 637, 763, 295, 1061, 798, 295, 233, 690, 1117, 1117, 406, 295, 855, 1117, 698, 1117, 958, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9340702764522175, "mean_inference_ms": 6.555062249917894, "mean_action_processing_ms": 0.4458727956434068, "mean_env_wait_ms": 19.839251788802233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036666154861450195, "StateBufferConnector_ms": 0.024755477905273438, "ViewRequirementAgentConnector_ms": 0.6279139518737793}}, "episode_reward_max": 41.084420249932215, "episode_reward_min": -88.10429458502617, "episode_reward_mean": 6.613894313010272, "episode_len_mean": 704.42, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.855766993528085, 0.24792254607360342, -4.136617497567769, 12.329723790758663, 2.126413835856466, 2.7153187437789064, 16.85878099212693, 11.845774005285, -39.88217517746149, -25.25092302040153, 18.90936229830184, 15.234977517891156, -27.946884524427837, 9.986440759974872, -7.323914289679597, -35.21160146966838, 8.223076566379843, 3.9346782492765326, -16.847631284524518, 6.519133719667005, 12.162976752055418, -5.449309389657294, 18.050627203419605, -10.235015686807861, -0.45629618113969617, 30.302571459718273, -9.843090215625148, 20.45770417376039, 6.644510532774337, -25.027120730555417, -6.080911502020509, 26.18196550746668, 26.36354177399619, 19.982507489932445, -26.840123346897137, 8.199031960611928, -31.337388417257248, -3.092827935475631, -5.159385065831184, 12.088942338864204, 14.799041506540549, 14.435206499205924, 0.9930197126826976, 41.084420249932215, 19.05722229096691, -88.10429458502617, 9.795923586233057, 15.664150698406889, 17.805568595071424, 4.448362417596291, -11.261193779094338, 34.877315840032274, 4.806833100412155, 28.650038064486303, 8.576354253183462, -15.961776335094743, 21.96628007990696, 24.945053874271412, 5.8649517000123845, 18.746031619947285, 13.3701420329733, 16.16627480525723, 28.463978173875212, 18.43277199638174, -13.832507395095105, 26.394643619250925, 8.855265955480624, 14.218135758636445, 24.191377528063878, 10.573574552992334, 8.740995808389298, 9.610858563282072, 5.037509087106132, -5.766611863774311, -5.129012594502318, 17.08343883040294, 6.030743370126614, -4.305620648261771, 25.27040646349318, 31.882353727628693, 12.973040503964706, 27.259329979323507, -14.755867711771469, 10.577174668947256, 16.377165583783967, -5.989583182281223, 9.414705553731572, 17.32173371599693, 14.299521243154599, 11.388175078037756, 34.59315757355221, 23.311471871050284, -18.97771827206977, 12.172502036802198, 3.2654722116153074, 32.70948859549222, -0.3553826322896345, 25.331574426365208, 13.465329829585833, 26.141913577211746], "episode_lengths": [1117, 330, 406, 269, 304, 1090, 1117, 259, 886, 381, 1088, 1108, 653, 294, 1117, 730, 961, 796, 428, 148, 269, 415, 295, 333, 893, 1117, 1117, 295, 1117, 487, 614, 1117, 1117, 269, 409, 295, 1117, 457, 605, 328, 295, 269, 764, 1117, 956, 896, 353, 295, 1117, 288, 376, 1097, 931, 1117, 148, 834, 1117, 1117, 673, 268, 295, 1117, 1117, 1117, 401, 1117, 269, 799, 1117, 1117, 874, 317, 950, 824, 605, 295, 304, 416, 1117, 1117, 295, 1117, 637, 763, 295, 1061, 798, 295, 233, 690, 1117, 1117, 406, 295, 855, 1117, 698, 1117, 958, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9340702764522175, "mean_inference_ms": 6.555062249917894, "mean_action_processing_ms": 0.4458727956434068, "mean_env_wait_ms": 19.839251788802233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036666154861450195, "StateBufferConnector_ms": 0.024755477905273438, "ViewRequirementAgentConnector_ms": 0.6279139518737793}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 303879, "num_agent_steps_trained": 303879, "num_env_steps_sampled": 303879, "num_env_steps_trained": 303879, "num_env_steps_sampled_this_iter": 10813, "num_env_steps_trained_this_iter": 10813, "num_env_steps_sampled_throughput_per_sec": 213.1038958507111, "num_env_steps_trained_throughput_per_sec": 213.1038958507111, "timesteps_total": 303879, "num_steps_trained_this_iter": 10813, "agent_timesteps_total": 303879, "timers": {"training_iteration_time_ms": 43989.131, "sample_time_ms": 29478.721, "load_time_ms": 1519.882, "load_throughput": 6096.921, "learn_time_ms": 12462.652, "learn_throughput": 743.55, "synch_weights_time_ms": 445.733}, "counters": {"num_env_steps_sampled": 303879, "num_env_steps_trained": 303879, "num_agent_steps_sampled": 303879, "num_agent_steps_trained": 303879}, "done": false, "episodes_total": 521, "training_iteration": 37, "trial_id": "32ccc_00000", "date": "2025-06-07_12-26-13", "timestamp": 1749291973, "time_this_iter_s": 50.7566442489624, "time_total_s": 1496.9310541152954, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1496.9310541152954, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 57.288524590163924, "ram_util_percent": 81.94918032786885, "gpu_util_percent0": 0.18655737704918035, "vram_util_percent0": 0.9662765753073771}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.696121000000002e-05, "total_loss": -0.131507177875028, "policy_loss": -0.018951991694565448, "vf_loss": 0.07397144440846104, "vf_explained_var": 0.9390741628077295, "kl": 0.009432085414907003, "entropy": 16.027823493215774, "entropy_coeff": 0.008480605}, "model": {}, "num_grad_updates_lifetime": 10840.5, "diff_num_grad_updates_vs_sampler_policy": 179.5}}, "num_env_steps_sampled": 314061, "num_env_steps_trained": 314061, "num_agent_steps_sampled": 314061, "num_agent_steps_trained": 314061}, "sampler_results": {"episode_reward_max": 41.084420249932215, "episode_reward_min": -88.10429458502617, "episode_reward_mean": 8.306972631506365, "episode_len_mean": 713.22, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.323914289679597, -35.21160146966838, 8.223076566379843, 3.9346782492765326, -16.847631284524518, 6.519133719667005, 12.162976752055418, -5.449309389657294, 18.050627203419605, -10.235015686807861, -0.45629618113969617, 30.302571459718273, -9.843090215625148, 20.45770417376039, 6.644510532774337, -25.027120730555417, -6.080911502020509, 26.18196550746668, 26.36354177399619, 19.982507489932445, -26.840123346897137, 8.199031960611928, -31.337388417257248, -3.092827935475631, -5.159385065831184, 12.088942338864204, 14.799041506540549, 14.435206499205924, 0.9930197126826976, 41.084420249932215, 19.05722229096691, -88.10429458502617, 9.795923586233057, 15.664150698406889, 17.805568595071424, 4.448362417596291, -11.261193779094338, 34.877315840032274, 4.806833100412155, 28.650038064486303, 8.576354253183462, -15.961776335094743, 21.96628007990696, 24.945053874271412, 5.8649517000123845, 18.746031619947285, 13.3701420329733, 16.16627480525723, 28.463978173875212, 18.43277199638174, -13.832507395095105, 26.394643619250925, 8.855265955480624, 14.218135758636445, 24.191377528063878, 10.573574552992334, 8.740995808389298, 9.610858563282072, 5.037509087106132, -5.766611863774311, -5.129012594502318, 17.08343883040294, 6.030743370126614, -4.305620648261771, 25.27040646349318, 31.882353727628693, 12.973040503964706, 27.259329979323507, -14.755867711771469, 10.577174668947256, 16.377165583783967, -5.989583182281223, 9.414705553731572, 17.32173371599693, 14.299521243154599, 11.388175078037756, 34.59315757355221, 23.311471871050284, -18.97771827206977, 12.172502036802198, 3.2654722116153074, 32.70948859549222, -0.3553826322896345, 25.331574426365208, 13.465329829585833, 26.141913577211746, -8.413781060224823, 11.016416239825773, -0.22263603356933614, 12.29516917437562, 8.830116349421374, 31.047829985468223, 23.373905582551767, 8.29445569959507, -4.3848803557574065, 12.640124285943902, 26.185885889318598, 2.5172675154286437, 16.76080851162238, 17.549497342270307], "episode_lengths": [1117, 730, 961, 796, 428, 148, 269, 415, 295, 333, 893, 1117, 1117, 295, 1117, 487, 614, 1117, 1117, 269, 409, 295, 1117, 457, 605, 328, 295, 269, 764, 1117, 956, 896, 353, 295, 1117, 288, 376, 1097, 931, 1117, 148, 834, 1117, 1117, 673, 268, 295, 1117, 1117, 1117, 401, 1117, 269, 799, 1117, 1117, 874, 317, 950, 824, 605, 295, 304, 416, 1117, 1117, 295, 1117, 637, 763, 295, 1061, 798, 295, 233, 690, 1117, 1117, 406, 295, 855, 1117, 698, 1117, 958, 1117, 791, 396, 761, 1117, 306, 1117, 295, 297, 801, 1090, 1117, 682, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9308603636315007, "mean_inference_ms": 6.555736428114875, "mean_action_processing_ms": 0.44569855869062813, "mean_env_wait_ms": 19.841220390869765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03871035575866699, "StateBufferConnector_ms": 0.02178478240966797, "ViewRequirementAgentConnector_ms": 0.604954719543457}}, "episode_reward_max": 41.084420249932215, "episode_reward_min": -88.10429458502617, "episode_reward_mean": 8.306972631506365, "episode_len_mean": 713.22, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.323914289679597, -35.21160146966838, 8.223076566379843, 3.9346782492765326, -16.847631284524518, 6.519133719667005, 12.162976752055418, -5.449309389657294, 18.050627203419605, -10.235015686807861, -0.45629618113969617, 30.302571459718273, -9.843090215625148, 20.45770417376039, 6.644510532774337, -25.027120730555417, -6.080911502020509, 26.18196550746668, 26.36354177399619, 19.982507489932445, -26.840123346897137, 8.199031960611928, -31.337388417257248, -3.092827935475631, -5.159385065831184, 12.088942338864204, 14.799041506540549, 14.435206499205924, 0.9930197126826976, 41.084420249932215, 19.05722229096691, -88.10429458502617, 9.795923586233057, 15.664150698406889, 17.805568595071424, 4.448362417596291, -11.261193779094338, 34.877315840032274, 4.806833100412155, 28.650038064486303, 8.576354253183462, -15.961776335094743, 21.96628007990696, 24.945053874271412, 5.8649517000123845, 18.746031619947285, 13.3701420329733, 16.16627480525723, 28.463978173875212, 18.43277199638174, -13.832507395095105, 26.394643619250925, 8.855265955480624, 14.218135758636445, 24.191377528063878, 10.573574552992334, 8.740995808389298, 9.610858563282072, 5.037509087106132, -5.766611863774311, -5.129012594502318, 17.08343883040294, 6.030743370126614, -4.305620648261771, 25.27040646349318, 31.882353727628693, 12.973040503964706, 27.259329979323507, -14.755867711771469, 10.577174668947256, 16.377165583783967, -5.989583182281223, 9.414705553731572, 17.32173371599693, 14.299521243154599, 11.388175078037756, 34.59315757355221, 23.311471871050284, -18.97771827206977, 12.172502036802198, 3.2654722116153074, 32.70948859549222, -0.3553826322896345, 25.331574426365208, 13.465329829585833, 26.141913577211746, -8.413781060224823, 11.016416239825773, -0.22263603356933614, 12.29516917437562, 8.830116349421374, 31.047829985468223, 23.373905582551767, 8.29445569959507, -4.3848803557574065, 12.640124285943902, 26.185885889318598, 2.5172675154286437, 16.76080851162238, 17.549497342270307], "episode_lengths": [1117, 730, 961, 796, 428, 148, 269, 415, 295, 333, 893, 1117, 1117, 295, 1117, 487, 614, 1117, 1117, 269, 409, 295, 1117, 457, 605, 328, 295, 269, 764, 1117, 956, 896, 353, 295, 1117, 288, 376, 1097, 931, 1117, 148, 834, 1117, 1117, 673, 268, 295, 1117, 1117, 1117, 401, 1117, 269, 799, 1117, 1117, 874, 317, 950, 824, 605, 295, 304, 416, 1117, 1117, 295, 1117, 637, 763, 295, 1061, 798, 295, 233, 690, 1117, 1117, 406, 295, 855, 1117, 698, 1117, 958, 1117, 791, 396, 761, 1117, 306, 1117, 295, 297, 801, 1090, 1117, 682, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9308603636315007, "mean_inference_ms": 6.555736428114875, "mean_action_processing_ms": 0.44569855869062813, "mean_env_wait_ms": 19.841220390869765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03871035575866699, "StateBufferConnector_ms": 0.02178478240966797, "ViewRequirementAgentConnector_ms": 0.604954719543457}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 314061, "num_agent_steps_trained": 314061, "num_env_steps_sampled": 314061, "num_env_steps_trained": 314061, "num_env_steps_sampled_this_iter": 10182, "num_env_steps_trained_this_iter": 10182, "num_env_steps_sampled_throughput_per_sec": 221.81834480118047, "num_env_steps_trained_throughput_per_sec": 221.81834480118047, "timesteps_total": 314061, "num_steps_trained_this_iter": 10182, "agent_timesteps_total": 314061, "timers": {"training_iteration_time_ms": 45027.496, "sample_time_ms": 29984.028, "load_time_ms": 1560.354, "load_throughput": 6118.74, "learn_time_ms": 12961.076, "learn_throughput": 736.621, "synch_weights_time_ms": 442.991}, "counters": {"num_env_steps_sampled": 314061, "num_env_steps_trained": 314061, "num_agent_steps_sampled": 314061, "num_agent_steps_trained": 314061}, "done": false, "episodes_total": 535, "training_iteration": 38, "trial_id": "32ccc_00000", "date": "2025-06-07_12-26-59", "timestamp": 1749292019, "time_this_iter_s": 45.9182231426239, "time_total_s": 1542.8492772579193, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1542.8492772579193, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 57.77636363636364, "ram_util_percent": 81.88363636363634, "gpu_util_percent0": 0.16709090909090912, "vram_util_percent0": 0.96435546875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.685939e-05, "total_loss": -0.14862092460544468, "policy_loss": -0.039966988460898085, "vf_loss": 0.08438795880104105, "vf_explained_var": 0.9484286199013392, "kl": 0.00979928851670896, "entropy": 16.037975323994953, "entropy_coeff": 0.008429695}, "model": {}, "num_grad_updates_lifetime": 11170.5, "diff_num_grad_updates_vs_sampler_policy": 149.5}}, "num_env_steps_sampled": 322680, "num_env_steps_trained": 322680, "num_agent_steps_sampled": 322680, "num_agent_steps_trained": 322680}, "sampler_results": {"episode_reward_max": 41.084420249932215, "episode_reward_min": -88.10429458502617, "episode_reward_mean": 8.874420510042116, "episode_len_mean": 710.27, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.644510532774337, -25.027120730555417, -6.080911502020509, 26.18196550746668, 26.36354177399619, 19.982507489932445, -26.840123346897137, 8.199031960611928, -31.337388417257248, -3.092827935475631, -5.159385065831184, 12.088942338864204, 14.799041506540549, 14.435206499205924, 0.9930197126826976, 41.084420249932215, 19.05722229096691, -88.10429458502617, 9.795923586233057, 15.664150698406889, 17.805568595071424, 4.448362417596291, -11.261193779094338, 34.877315840032274, 4.806833100412155, 28.650038064486303, 8.576354253183462, -15.961776335094743, 21.96628007990696, 24.945053874271412, 5.8649517000123845, 18.746031619947285, 13.3701420329733, 16.16627480525723, 28.463978173875212, 18.43277199638174, -13.832507395095105, 26.394643619250925, 8.855265955480624, 14.218135758636445, 24.191377528063878, 10.573574552992334, 8.740995808389298, 9.610858563282072, 5.037509087106132, -5.766611863774311, -5.129012594502318, 17.08343883040294, 6.030743370126614, -4.305620648261771, 25.27040646349318, 31.882353727628693, 12.973040503964706, 27.259329979323507, -14.755867711771469, 10.577174668947256, 16.377165583783967, -5.989583182281223, 9.414705553731572, 17.32173371599693, 14.299521243154599, 11.388175078037756, 34.59315757355221, 23.311471871050284, -18.97771827206977, 12.172502036802198, 3.2654722116153074, 32.70948859549222, -0.3553826322896345, 25.331574426365208, 13.465329829585833, 26.141913577211746, -8.413781060224823, 11.016416239825773, -0.22263603356933614, 12.29516917437562, 8.830116349421374, 31.047829985468223, 23.373905582551767, 8.29445569959507, -4.3848803557574065, 12.640124285943902, 26.185885889318598, 2.5172675154286437, 16.76080851162238, 17.549497342270307, 20.296398663764233, -2.6606355195143605, 15.434110997088602, 3.321359972787001, 21.128541546446804, 0.100078827702621, -10.804316267761024, 29.305062928771104, 10.65218692775763, 15.346050508661964, -18.79799423928265, 13.339336365492379, -4.075750248001843, -21.555733003162857], "episode_lengths": [1117, 487, 614, 1117, 1117, 269, 409, 295, 1117, 457, 605, 328, 295, 269, 764, 1117, 956, 896, 353, 295, 1117, 288, 376, 1097, 931, 1117, 148, 834, 1117, 1117, 673, 268, 295, 1117, 1117, 1117, 401, 1117, 269, 799, 1117, 1117, 874, 317, 950, 824, 605, 295, 304, 416, 1117, 1117, 295, 1117, 637, 763, 295, 1061, 798, 295, 233, 690, 1117, 1117, 406, 295, 855, 1117, 698, 1117, 958, 1117, 791, 396, 761, 1117, 306, 1117, 295, 297, 801, 1090, 1117, 682, 1117, 295, 295, 342, 295, 1117, 295, 357, 449, 1117, 925, 269, 605, 1117, 793, 643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.928099205977836, "mean_inference_ms": 6.558000023688801, "mean_action_processing_ms": 0.44564678634724, "mean_env_wait_ms": 19.84693706421009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03870105743408203, "StateBufferConnector_ms": 0.020775556564331055, "ViewRequirementAgentConnector_ms": 0.5955667495727539}}, "episode_reward_max": 41.084420249932215, "episode_reward_min": -88.10429458502617, "episode_reward_mean": 8.874420510042116, "episode_len_mean": 710.27, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.644510532774337, -25.027120730555417, -6.080911502020509, 26.18196550746668, 26.36354177399619, 19.982507489932445, -26.840123346897137, 8.199031960611928, -31.337388417257248, -3.092827935475631, -5.159385065831184, 12.088942338864204, 14.799041506540549, 14.435206499205924, 0.9930197126826976, 41.084420249932215, 19.05722229096691, -88.10429458502617, 9.795923586233057, 15.664150698406889, 17.805568595071424, 4.448362417596291, -11.261193779094338, 34.877315840032274, 4.806833100412155, 28.650038064486303, 8.576354253183462, -15.961776335094743, 21.96628007990696, 24.945053874271412, 5.8649517000123845, 18.746031619947285, 13.3701420329733, 16.16627480525723, 28.463978173875212, 18.43277199638174, -13.832507395095105, 26.394643619250925, 8.855265955480624, 14.218135758636445, 24.191377528063878, 10.573574552992334, 8.740995808389298, 9.610858563282072, 5.037509087106132, -5.766611863774311, -5.129012594502318, 17.08343883040294, 6.030743370126614, -4.305620648261771, 25.27040646349318, 31.882353727628693, 12.973040503964706, 27.259329979323507, -14.755867711771469, 10.577174668947256, 16.377165583783967, -5.989583182281223, 9.414705553731572, 17.32173371599693, 14.299521243154599, 11.388175078037756, 34.59315757355221, 23.311471871050284, -18.97771827206977, 12.172502036802198, 3.2654722116153074, 32.70948859549222, -0.3553826322896345, 25.331574426365208, 13.465329829585833, 26.141913577211746, -8.413781060224823, 11.016416239825773, -0.22263603356933614, 12.29516917437562, 8.830116349421374, 31.047829985468223, 23.373905582551767, 8.29445569959507, -4.3848803557574065, 12.640124285943902, 26.185885889318598, 2.5172675154286437, 16.76080851162238, 17.549497342270307, 20.296398663764233, -2.6606355195143605, 15.434110997088602, 3.321359972787001, 21.128541546446804, 0.100078827702621, -10.804316267761024, 29.305062928771104, 10.65218692775763, 15.346050508661964, -18.79799423928265, 13.339336365492379, -4.075750248001843, -21.555733003162857], "episode_lengths": [1117, 487, 614, 1117, 1117, 269, 409, 295, 1117, 457, 605, 328, 295, 269, 764, 1117, 956, 896, 353, 295, 1117, 288, 376, 1097, 931, 1117, 148, 834, 1117, 1117, 673, 268, 295, 1117, 1117, 1117, 401, 1117, 269, 799, 1117, 1117, 874, 317, 950, 824, 605, 295, 304, 416, 1117, 1117, 295, 1117, 637, 763, 295, 1061, 798, 295, 233, 690, 1117, 1117, 406, 295, 855, 1117, 698, 1117, 958, 1117, 791, 396, 761, 1117, 306, 1117, 295, 297, 801, 1090, 1117, 682, 1117, 295, 295, 342, 295, 1117, 295, 357, 449, 1117, 925, 269, 605, 1117, 793, 643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.928099205977836, "mean_inference_ms": 6.558000023688801, "mean_action_processing_ms": 0.44564678634724, "mean_env_wait_ms": 19.84693706421009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03870105743408203, "StateBufferConnector_ms": 0.020775556564331055, "ViewRequirementAgentConnector_ms": 0.5955667495727539}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 322680, "num_agent_steps_trained": 322680, "num_env_steps_sampled": 322680, "num_env_steps_trained": 322680, "num_env_steps_sampled_this_iter": 8619, "num_env_steps_trained_this_iter": 8619, "num_env_steps_sampled_throughput_per_sec": 202.4397255387576, "num_env_steps_trained_throughput_per_sec": 202.4397255387576, "timesteps_total": 322680, "num_steps_trained_this_iter": 8619, "agent_timesteps_total": 322680, "timers": {"training_iteration_time_ms": 45541.859, "sample_time_ms": 30154.4, "load_time_ms": 1563.684, "load_throughput": 6180.022, "learn_time_ms": 13271.753, "learn_throughput": 728.133, "synch_weights_time_ms": 471.274}, "counters": {"num_env_steps_sampled": 322680, "num_env_steps_trained": 322680, "num_agent_steps_sampled": 322680, "num_agent_steps_trained": 322680}, "done": false, "episodes_total": 549, "training_iteration": 39, "trial_id": "32ccc_00000", "date": "2025-06-07_12-27-42", "timestamp": 1749292062, "time_this_iter_s": 42.591633319854736, "time_total_s": 1585.440910577774, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1585.440910577774, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 53.29019607843138, "ram_util_percent": 81.19019607843137, "gpu_util_percent0": 0.18980392156862744, "vram_util_percent0": 0.96435546875}}
{"evaluation": {"sampler_results": {"episode_reward_max": 5.0254525196812345, "episode_reward_min": 3.7335298335522493, "episode_reward_mean": 4.429472399959947, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0254525196812345, 4.846935620076762, 4.2899656093288385, 4.251478417160651, 3.7335298335522493], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.461158657618043, "mean_inference_ms": 3.4587321091009136, "mean_action_processing_ms": 0.2497843638997595, "mean_env_wait_ms": 10.485782470433682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019989013671875, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1493978500366211}}, "episode_reward_max": 5.0254525196812345, "episode_reward_min": 3.7335298335522493, "episode_reward_mean": 4.429472399959947, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0254525196812345, 4.846935620076762, 4.2899656093288385, 4.251478417160651, 3.7335298335522493], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.461158657618043, "mean_inference_ms": 3.4587321091009136, "mean_action_processing_ms": 0.2497843638997595, "mean_env_wait_ms": 10.485782470433682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019989013671875, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1493978500366211}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.677320000000002e-05, "total_loss": -0.14734943811152432, "policy_loss": -0.03795003568768545, "vf_loss": 0.07956077757518033, "vf_explained_var": 0.9303816486049343, "kl": 0.00914918393513416, "entropy": 16.026910735465385, "entropy_coeff": 0.0083866}, "model": {}, "num_grad_updates_lifetime": 11505.5, "diff_num_grad_updates_vs_sampler_policy": 184.5}}, "num_env_steps_sampled": 333146, "num_env_steps_trained": 333146, "num_agent_steps_sampled": 333146, "num_agent_steps_trained": 333146}, "sampler_results": {"episode_reward_max": 41.084420249932215, "episode_reward_min": -88.10429458502617, "episode_reward_mean": 8.962955281687078, "episode_len_mean": 729.97, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9930197126826976, 41.084420249932215, 19.05722229096691, -88.10429458502617, 9.795923586233057, 15.664150698406889, 17.805568595071424, 4.448362417596291, -11.261193779094338, 34.877315840032274, 4.806833100412155, 28.650038064486303, 8.576354253183462, -15.961776335094743, 21.96628007990696, 24.945053874271412, 5.8649517000123845, 18.746031619947285, 13.3701420329733, 16.16627480525723, 28.463978173875212, 18.43277199638174, -13.832507395095105, 26.394643619250925, 8.855265955480624, 14.218135758636445, 24.191377528063878, 10.573574552992334, 8.740995808389298, 9.610858563282072, 5.037509087106132, -5.766611863774311, -5.129012594502318, 17.08343883040294, 6.030743370126614, -4.305620648261771, 25.27040646349318, 31.882353727628693, 12.973040503964706, 27.259329979323507, -14.755867711771469, 10.577174668947256, 16.377165583783967, -5.989583182281223, 9.414705553731572, 17.32173371599693, 14.299521243154599, 11.388175078037756, 34.59315757355221, 23.311471871050284, -18.97771827206977, 12.172502036802198, 3.2654722116153074, 32.70948859549222, -0.3553826322896345, 25.331574426365208, 13.465329829585833, 26.141913577211746, -8.413781060224823, 11.016416239825773, -0.22263603356933614, 12.29516917437562, 8.830116349421374, 31.047829985468223, 23.373905582551767, 8.29445569959507, -4.3848803557574065, 12.640124285943902, 26.185885889318598, 2.5172675154286437, 16.76080851162238, 17.549497342270307, 20.296398663764233, -2.6606355195143605, 15.434110997088602, 3.321359972787001, 21.128541546446804, 0.100078827702621, -10.804316267761024, 29.305062928771104, 10.65218692775763, 15.346050508661964, -18.79799423928265, 13.339336365492379, -4.075750248001843, -21.555733003162857, 38.2524449385796, 31.190312295749596, 14.431400147966533, -18.75630997998552, 22.44213333433021, -8.496319659972936, 8.22934358702965, 15.976055281209558, 18.748194113884665, 30.4107360701647, -40.523984925341985, -18.117651647534753, -33.377286081306075, -20.398599698921885], "episode_lengths": [764, 1117, 956, 896, 353, 295, 1117, 288, 376, 1097, 931, 1117, 148, 834, 1117, 1117, 673, 268, 295, 1117, 1117, 1117, 401, 1117, 269, 799, 1117, 1117, 874, 317, 950, 824, 605, 295, 304, 416, 1117, 1117, 295, 1117, 637, 763, 295, 1061, 798, 295, 233, 690, 1117, 1117, 406, 295, 855, 1117, 698, 1117, 958, 1117, 791, 396, 761, 1117, 306, 1117, 295, 297, 801, 1090, 1117, 682, 1117, 295, 295, 342, 295, 1117, 295, 357, 449, 1117, 925, 269, 605, 1117, 793, 643, 1117, 1117, 295, 622, 1117, 796, 1117, 295, 295, 1117, 624, 468, 802, 684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9256250691402548, "mean_inference_ms": 6.561710807854318, "mean_action_processing_ms": 0.4458607490179684, "mean_env_wait_ms": 19.855656466039466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036699771881103516, "StateBufferConnector_ms": 0.016100168228149414, "ViewRequirementAgentConnector_ms": 0.5827150344848633}}, "episode_reward_max": 41.084420249932215, "episode_reward_min": -88.10429458502617, "episode_reward_mean": 8.962955281687078, "episode_len_mean": 729.97, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9930197126826976, 41.084420249932215, 19.05722229096691, -88.10429458502617, 9.795923586233057, 15.664150698406889, 17.805568595071424, 4.448362417596291, -11.261193779094338, 34.877315840032274, 4.806833100412155, 28.650038064486303, 8.576354253183462, -15.961776335094743, 21.96628007990696, 24.945053874271412, 5.8649517000123845, 18.746031619947285, 13.3701420329733, 16.16627480525723, 28.463978173875212, 18.43277199638174, -13.832507395095105, 26.394643619250925, 8.855265955480624, 14.218135758636445, 24.191377528063878, 10.573574552992334, 8.740995808389298, 9.610858563282072, 5.037509087106132, -5.766611863774311, -5.129012594502318, 17.08343883040294, 6.030743370126614, -4.305620648261771, 25.27040646349318, 31.882353727628693, 12.973040503964706, 27.259329979323507, -14.755867711771469, 10.577174668947256, 16.377165583783967, -5.989583182281223, 9.414705553731572, 17.32173371599693, 14.299521243154599, 11.388175078037756, 34.59315757355221, 23.311471871050284, -18.97771827206977, 12.172502036802198, 3.2654722116153074, 32.70948859549222, -0.3553826322896345, 25.331574426365208, 13.465329829585833, 26.141913577211746, -8.413781060224823, 11.016416239825773, -0.22263603356933614, 12.29516917437562, 8.830116349421374, 31.047829985468223, 23.373905582551767, 8.29445569959507, -4.3848803557574065, 12.640124285943902, 26.185885889318598, 2.5172675154286437, 16.76080851162238, 17.549497342270307, 20.296398663764233, -2.6606355195143605, 15.434110997088602, 3.321359972787001, 21.128541546446804, 0.100078827702621, -10.804316267761024, 29.305062928771104, 10.65218692775763, 15.346050508661964, -18.79799423928265, 13.339336365492379, -4.075750248001843, -21.555733003162857, 38.2524449385796, 31.190312295749596, 14.431400147966533, -18.75630997998552, 22.44213333433021, -8.496319659972936, 8.22934358702965, 15.976055281209558, 18.748194113884665, 30.4107360701647, -40.523984925341985, -18.117651647534753, -33.377286081306075, -20.398599698921885], "episode_lengths": [764, 1117, 956, 896, 353, 295, 1117, 288, 376, 1097, 931, 1117, 148, 834, 1117, 1117, 673, 268, 295, 1117, 1117, 1117, 401, 1117, 269, 799, 1117, 1117, 874, 317, 950, 824, 605, 295, 304, 416, 1117, 1117, 295, 1117, 637, 763, 295, 1061, 798, 295, 233, 690, 1117, 1117, 406, 295, 855, 1117, 698, 1117, 958, 1117, 791, 396, 761, 1117, 306, 1117, 295, 297, 801, 1090, 1117, 682, 1117, 295, 295, 342, 295, 1117, 295, 357, 449, 1117, 925, 269, 605, 1117, 793, 643, 1117, 1117, 295, 622, 1117, 796, 1117, 295, 295, 1117, 624, 468, 802, 684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9256250691402548, "mean_inference_ms": 6.561710807854318, "mean_action_processing_ms": 0.4458607490179684, "mean_env_wait_ms": 19.855656466039466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036699771881103516, "StateBufferConnector_ms": 0.016100168228149414, "ViewRequirementAgentConnector_ms": 0.5827150344848633}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 333146, "num_agent_steps_trained": 333146, "num_env_steps_sampled": 333146, "num_env_steps_trained": 333146, "num_env_steps_sampled_this_iter": 10466, "num_env_steps_trained_this_iter": 10466, "num_env_steps_sampled_throughput_per_sec": 222.42014649203972, "num_env_steps_trained_throughput_per_sec": 222.42014649203972, "timesteps_total": 333146, "num_steps_trained_this_iter": 10466, "agent_timesteps_total": 333146, "timers": {"training_iteration_time_ms": 45947.767, "sample_time_ms": 30439.832, "load_time_ms": 1575.036, "load_throughput": 6238.715, "learn_time_ms": 13380.982, "learn_throughput": 734.341, "synch_weights_time_ms": 467.095}, "counters": {"num_env_steps_sampled": 333146, "num_env_steps_trained": 333146, "num_agent_steps_sampled": 333146, "num_agent_steps_trained": 333146}, "done": false, "episodes_total": 563, "training_iteration": 40, "trial_id": "32ccc_00000", "date": "2025-06-07_12-28-44", "timestamp": 1749292124, "time_this_iter_s": 61.66165471076965, "time_total_s": 1647.1025652885437, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1647.1025652885437, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 48.51891891891892, "ram_util_percent": 81.81486486486487, "gpu_util_percent0": 0.13891891891891894, "vram_util_percent0": 0.96435546875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.666854000000001e-05, "total_loss": -0.12245074001105462, "policy_loss": -0.010763765922899399, "vf_loss": 0.06793977004759337, "vf_explained_var": 0.9352811008691788, "kl": 0.010335497559287393, "entropy": 16.00150286011074, "entropy_coeff": 0.008334270000000001}, "model": {}, "num_grad_updates_lifetime": 11920.5, "diff_num_grad_updates_vs_sampler_policy": 229.5}}, "num_env_steps_sampled": 346182, "num_env_steps_trained": 346182, "num_agent_steps_sampled": 346182, "num_agent_steps_trained": 346182}, "sampler_results": {"episode_reward_max": 50.80364858675695, "episode_reward_min": -40.523984925341985, "episode_reward_mean": 10.638514271577215, "episode_len_mean": 757.44, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.96628007990696, 24.945053874271412, 5.8649517000123845, 18.746031619947285, 13.3701420329733, 16.16627480525723, 28.463978173875212, 18.43277199638174, -13.832507395095105, 26.394643619250925, 8.855265955480624, 14.218135758636445, 24.191377528063878, 10.573574552992334, 8.740995808389298, 9.610858563282072, 5.037509087106132, -5.766611863774311, -5.129012594502318, 17.08343883040294, 6.030743370126614, -4.305620648261771, 25.27040646349318, 31.882353727628693, 12.973040503964706, 27.259329979323507, -14.755867711771469, 10.577174668947256, 16.377165583783967, -5.989583182281223, 9.414705553731572, 17.32173371599693, 14.299521243154599, 11.388175078037756, 34.59315757355221, 23.311471871050284, -18.97771827206977, 12.172502036802198, 3.2654722116153074, 32.70948859549222, -0.3553826322896345, 25.331574426365208, 13.465329829585833, 26.141913577211746, -8.413781060224823, 11.016416239825773, -0.22263603356933614, 12.29516917437562, 8.830116349421374, 31.047829985468223, 23.373905582551767, 8.29445569959507, -4.3848803557574065, 12.640124285943902, 26.185885889318598, 2.5172675154286437, 16.76080851162238, 17.549497342270307, 20.296398663764233, -2.6606355195143605, 15.434110997088602, 3.321359972787001, 21.128541546446804, 0.100078827702621, -10.804316267761024, 29.305062928771104, 10.65218692775763, 15.346050508661964, -18.79799423928265, 13.339336365492379, -4.075750248001843, -21.555733003162857, 38.2524449385796, 31.190312295749596, 14.431400147966533, -18.75630997998552, 22.44213333433021, -8.496319659972936, 8.22934358702965, 15.976055281209558, 18.748194113884665, 30.4107360701647, -40.523984925341985, -18.117651647534753, -33.377286081306075, -20.398599698921885, 40.9738989456164, 39.33564761934865, 10.749585991935822, 27.304838275954232, 17.51675478975239, -8.276933669703798, 50.80364858675695, 22.3478936019683, 18.930803663234137, -1.8576096607856907, -7.3805943127055045, -5.486185648945943, 13.469174971215594, 19.556919945160576], "episode_lengths": [1117, 1117, 673, 268, 295, 1117, 1117, 1117, 401, 1117, 269, 799, 1117, 1117, 874, 317, 950, 824, 605, 295, 304, 416, 1117, 1117, 295, 1117, 637, 763, 295, 1061, 798, 295, 233, 690, 1117, 1117, 406, 295, 855, 1117, 698, 1117, 958, 1117, 791, 396, 761, 1117, 306, 1117, 295, 297, 801, 1090, 1117, 682, 1117, 295, 295, 342, 295, 1117, 295, 357, 449, 1117, 925, 269, 605, 1117, 793, 643, 1117, 1117, 295, 622, 1117, 796, 1117, 295, 295, 1117, 624, 468, 802, 684, 1117, 1117, 1117, 295, 1117, 454, 1117, 1117, 1117, 443, 896, 895, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9262089313313673, "mean_inference_ms": 6.568536637464495, "mean_action_processing_ms": 0.4462621346692404, "mean_env_wait_ms": 19.875069894707163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023825407028198242, "StateBufferConnector_ms": 0.01760101318359375, "ViewRequirementAgentConnector_ms": 0.5901970863342285}}, "episode_reward_max": 50.80364858675695, "episode_reward_min": -40.523984925341985, "episode_reward_mean": 10.638514271577215, "episode_len_mean": 757.44, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.96628007990696, 24.945053874271412, 5.8649517000123845, 18.746031619947285, 13.3701420329733, 16.16627480525723, 28.463978173875212, 18.43277199638174, -13.832507395095105, 26.394643619250925, 8.855265955480624, 14.218135758636445, 24.191377528063878, 10.573574552992334, 8.740995808389298, 9.610858563282072, 5.037509087106132, -5.766611863774311, -5.129012594502318, 17.08343883040294, 6.030743370126614, -4.305620648261771, 25.27040646349318, 31.882353727628693, 12.973040503964706, 27.259329979323507, -14.755867711771469, 10.577174668947256, 16.377165583783967, -5.989583182281223, 9.414705553731572, 17.32173371599693, 14.299521243154599, 11.388175078037756, 34.59315757355221, 23.311471871050284, -18.97771827206977, 12.172502036802198, 3.2654722116153074, 32.70948859549222, -0.3553826322896345, 25.331574426365208, 13.465329829585833, 26.141913577211746, -8.413781060224823, 11.016416239825773, -0.22263603356933614, 12.29516917437562, 8.830116349421374, 31.047829985468223, 23.373905582551767, 8.29445569959507, -4.3848803557574065, 12.640124285943902, 26.185885889318598, 2.5172675154286437, 16.76080851162238, 17.549497342270307, 20.296398663764233, -2.6606355195143605, 15.434110997088602, 3.321359972787001, 21.128541546446804, 0.100078827702621, -10.804316267761024, 29.305062928771104, 10.65218692775763, 15.346050508661964, -18.79799423928265, 13.339336365492379, -4.075750248001843, -21.555733003162857, 38.2524449385796, 31.190312295749596, 14.431400147966533, -18.75630997998552, 22.44213333433021, -8.496319659972936, 8.22934358702965, 15.976055281209558, 18.748194113884665, 30.4107360701647, -40.523984925341985, -18.117651647534753, -33.377286081306075, -20.398599698921885, 40.9738989456164, 39.33564761934865, 10.749585991935822, 27.304838275954232, 17.51675478975239, -8.276933669703798, 50.80364858675695, 22.3478936019683, 18.930803663234137, -1.8576096607856907, -7.3805943127055045, -5.486185648945943, 13.469174971215594, 19.556919945160576], "episode_lengths": [1117, 1117, 673, 268, 295, 1117, 1117, 1117, 401, 1117, 269, 799, 1117, 1117, 874, 317, 950, 824, 605, 295, 304, 416, 1117, 1117, 295, 1117, 637, 763, 295, 1061, 798, 295, 233, 690, 1117, 1117, 406, 295, 855, 1117, 698, 1117, 958, 1117, 791, 396, 761, 1117, 306, 1117, 295, 297, 801, 1090, 1117, 682, 1117, 295, 295, 342, 295, 1117, 295, 357, 449, 1117, 925, 269, 605, 1117, 793, 643, 1117, 1117, 295, 622, 1117, 796, 1117, 295, 295, 1117, 624, 468, 802, 684, 1117, 1117, 1117, 295, 1117, 454, 1117, 1117, 1117, 443, 896, 895, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9262089313313673, "mean_inference_ms": 6.568536637464495, "mean_action_processing_ms": 0.4462621346692404, "mean_env_wait_ms": 19.875069894707163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023825407028198242, "StateBufferConnector_ms": 0.01760101318359375, "ViewRequirementAgentConnector_ms": 0.5901970863342285}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 346182, "num_agent_steps_trained": 346182, "num_env_steps_sampled": 346182, "num_env_steps_trained": 346182, "num_env_steps_sampled_this_iter": 13036, "num_env_steps_trained_this_iter": 13036, "num_env_steps_sampled_throughput_per_sec": 224.15599242067742, "num_env_steps_trained_throughput_per_sec": 224.15599242067742, "timesteps_total": 346182, "num_steps_trained_this_iter": 13036, "agent_timesteps_total": 346182, "timers": {"training_iteration_time_ms": 47310.822, "sample_time_ms": 31113.363, "load_time_ms": 1842.927, "load_throughput": 5512.753, "learn_time_ms": 13793.401, "learn_throughput": 736.555, "synch_weights_time_ms": 470.605}, "counters": {"num_env_steps_sampled": 346182, "num_env_steps_trained": 346182, "num_agent_steps_sampled": 346182, "num_agent_steps_trained": 346182}, "done": false, "episodes_total": 577, "training_iteration": 41, "trial_id": "32ccc_00000", "date": "2025-06-07_12-29-42", "timestamp": 1749292182, "time_this_iter_s": 58.17192554473877, "time_total_s": 1705.2744908332825, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1705.2744908332825, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 62.489855072463754, "ram_util_percent": 85.15797101449276, "gpu_util_percent0": 0.1820289855072464, "vram_util_percent0": 0.96435546875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.653818e-05, "total_loss": -0.09835248075425625, "policy_loss": 0.007770918236055877, "vf_loss": 0.08463826647726819, "vf_explained_var": 0.938944938480854, "kl": 0.00992999752334981, "entropy": 16.05450274705887, "entropy_coeff": 0.008269090000000002}, "model": {}, "num_grad_updates_lifetime": 12350.5, "diff_num_grad_updates_vs_sampler_policy": 199.5}}, "num_env_steps_sampled": 357566, "num_env_steps_trained": 357566, "num_agent_steps_sampled": 357566, "num_agent_steps_trained": 357566}, "sampler_results": {"episode_reward_max": 50.80364858675695, "episode_reward_min": -40.523984925341985, "episode_reward_mean": 10.018026406828602, "episode_len_mean": 754.87, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.740995808389298, 9.610858563282072, 5.037509087106132, -5.766611863774311, -5.129012594502318, 17.08343883040294, 6.030743370126614, -4.305620648261771, 25.27040646349318, 31.882353727628693, 12.973040503964706, 27.259329979323507, -14.755867711771469, 10.577174668947256, 16.377165583783967, -5.989583182281223, 9.414705553731572, 17.32173371599693, 14.299521243154599, 11.388175078037756, 34.59315757355221, 23.311471871050284, -18.97771827206977, 12.172502036802198, 3.2654722116153074, 32.70948859549222, -0.3553826322896345, 25.331574426365208, 13.465329829585833, 26.141913577211746, -8.413781060224823, 11.016416239825773, -0.22263603356933614, 12.29516917437562, 8.830116349421374, 31.047829985468223, 23.373905582551767, 8.29445569959507, -4.3848803557574065, 12.640124285943902, 26.185885889318598, 2.5172675154286437, 16.76080851162238, 17.549497342270307, 20.296398663764233, -2.6606355195143605, 15.434110997088602, 3.321359972787001, 21.128541546446804, 0.100078827702621, -10.804316267761024, 29.305062928771104, 10.65218692775763, 15.346050508661964, -18.79799423928265, 13.339336365492379, -4.075750248001843, -21.555733003162857, 38.2524449385796, 31.190312295749596, 14.431400147966533, -18.75630997998552, 22.44213333433021, -8.496319659972936, 8.22934358702965, 15.976055281209558, 18.748194113884665, 30.4107360701647, -40.523984925341985, -18.117651647534753, -33.377286081306075, -20.398599698921885, 40.9738989456164, 39.33564761934865, 10.749585991935822, 27.304838275954232, 17.51675478975239, -8.276933669703798, 50.80364858675695, 22.3478936019683, 18.930803663234137, -1.8576096607856907, -7.3805943127055045, -5.486185648945943, 13.469174971215594, 19.556919945160576, 31.80066077066398, 17.960589497709105, 2.797818210371392, -15.614224852148803, 15.840349503152872, 34.85383079978857, -5.473956066367615, 24.873476693011813, 3.830867555239535, 18.870638078145646, 24.288691943085563, -21.850847188636102, 1.9940333200082527, 22.135259563069116], "episode_lengths": [874, 317, 950, 824, 605, 295, 304, 416, 1117, 1117, 295, 1117, 637, 763, 295, 1061, 798, 295, 233, 690, 1117, 1117, 406, 295, 855, 1117, 698, 1117, 958, 1117, 791, 396, 761, 1117, 306, 1117, 295, 297, 801, 1090, 1117, 682, 1117, 295, 295, 342, 295, 1117, 295, 357, 449, 1117, 925, 269, 605, 1117, 793, 643, 1117, 1117, 295, 622, 1117, 796, 1117, 295, 295, 1117, 624, 468, 802, 684, 1117, 1117, 1117, 295, 1117, 454, 1117, 1117, 1117, 443, 896, 895, 1117, 1117, 1117, 295, 695, 1117, 295, 1117, 925, 1117, 295, 295, 1117, 765, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9274274335640627, "mean_inference_ms": 6.576135071174494, "mean_action_processing_ms": 0.44677672218298975, "mean_env_wait_ms": 19.897746586968697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0247802734375, "StateBufferConnector_ms": 0.01658940315246582, "ViewRequirementAgentConnector_ms": 0.6186015605926514}}, "episode_reward_max": 50.80364858675695, "episode_reward_min": -40.523984925341985, "episode_reward_mean": 10.018026406828602, "episode_len_mean": 754.87, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.740995808389298, 9.610858563282072, 5.037509087106132, -5.766611863774311, -5.129012594502318, 17.08343883040294, 6.030743370126614, -4.305620648261771, 25.27040646349318, 31.882353727628693, 12.973040503964706, 27.259329979323507, -14.755867711771469, 10.577174668947256, 16.377165583783967, -5.989583182281223, 9.414705553731572, 17.32173371599693, 14.299521243154599, 11.388175078037756, 34.59315757355221, 23.311471871050284, -18.97771827206977, 12.172502036802198, 3.2654722116153074, 32.70948859549222, -0.3553826322896345, 25.331574426365208, 13.465329829585833, 26.141913577211746, -8.413781060224823, 11.016416239825773, -0.22263603356933614, 12.29516917437562, 8.830116349421374, 31.047829985468223, 23.373905582551767, 8.29445569959507, -4.3848803557574065, 12.640124285943902, 26.185885889318598, 2.5172675154286437, 16.76080851162238, 17.549497342270307, 20.296398663764233, -2.6606355195143605, 15.434110997088602, 3.321359972787001, 21.128541546446804, 0.100078827702621, -10.804316267761024, 29.305062928771104, 10.65218692775763, 15.346050508661964, -18.79799423928265, 13.339336365492379, -4.075750248001843, -21.555733003162857, 38.2524449385796, 31.190312295749596, 14.431400147966533, -18.75630997998552, 22.44213333433021, -8.496319659972936, 8.22934358702965, 15.976055281209558, 18.748194113884665, 30.4107360701647, -40.523984925341985, -18.117651647534753, -33.377286081306075, -20.398599698921885, 40.9738989456164, 39.33564761934865, 10.749585991935822, 27.304838275954232, 17.51675478975239, -8.276933669703798, 50.80364858675695, 22.3478936019683, 18.930803663234137, -1.8576096607856907, -7.3805943127055045, -5.486185648945943, 13.469174971215594, 19.556919945160576, 31.80066077066398, 17.960589497709105, 2.797818210371392, -15.614224852148803, 15.840349503152872, 34.85383079978857, -5.473956066367615, 24.873476693011813, 3.830867555239535, 18.870638078145646, 24.288691943085563, -21.850847188636102, 1.9940333200082527, 22.135259563069116], "episode_lengths": [874, 317, 950, 824, 605, 295, 304, 416, 1117, 1117, 295, 1117, 637, 763, 295, 1061, 798, 295, 233, 690, 1117, 1117, 406, 295, 855, 1117, 698, 1117, 958, 1117, 791, 396, 761, 1117, 306, 1117, 295, 297, 801, 1090, 1117, 682, 1117, 295, 295, 342, 295, 1117, 295, 357, 449, 1117, 925, 269, 605, 1117, 793, 643, 1117, 1117, 295, 622, 1117, 796, 1117, 295, 295, 1117, 624, 468, 802, 684, 1117, 1117, 1117, 295, 1117, 454, 1117, 1117, 1117, 443, 896, 895, 1117, 1117, 1117, 295, 695, 1117, 295, 1117, 925, 1117, 295, 295, 1117, 765, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9274274335640627, "mean_inference_ms": 6.576135071174494, "mean_action_processing_ms": 0.44677672218298975, "mean_env_wait_ms": 19.897746586968697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0247802734375, "StateBufferConnector_ms": 0.01658940315246582, "ViewRequirementAgentConnector_ms": 0.6186015605926514}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 357566, "num_agent_steps_trained": 357566, "num_env_steps_sampled": 357566, "num_env_steps_trained": 357566, "num_env_steps_sampled_this_iter": 11384, "num_env_steps_trained_this_iter": 11384, "num_env_steps_sampled_throughput_per_sec": 218.86204648565692, "num_env_steps_trained_throughput_per_sec": 218.86204648565692, "timesteps_total": 357566, "num_steps_trained_this_iter": 11384, "agent_timesteps_total": 357566, "timers": {"training_iteration_time_ms": 48335.157, "sample_time_ms": 31647.92, "load_time_ms": 1891.434, "load_throughput": 5514.81, "learn_time_ms": 14233.8, "learn_throughput": 732.826, "synch_weights_time_ms": 473.019}, "counters": {"num_env_steps_sampled": 357566, "num_env_steps_trained": 357566, "num_agent_steps_sampled": 357566, "num_agent_steps_trained": 357566}, "done": false, "episodes_total": 591, "training_iteration": 42, "trial_id": "32ccc_00000", "date": "2025-06-07_12-30-34", "timestamp": 1749292234, "time_this_iter_s": 52.03405547142029, "time_total_s": 1757.3085463047028, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1757.3085463047028, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 59.603278688524604, "ram_util_percent": 87.09836065573772, "gpu_util_percent0": 0.19934426229508195, "vram_util_percent0": 0.96435546875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.642434000000002e-05, "total_loss": -0.1361202346872277, "policy_loss": -0.02335589437648972, "vf_loss": 0.05766171909096401, "vf_explained_var": 0.9424443714502381, "kl": 0.010113233961725733, "entropy": 15.991756248474122, "entropy_coeff": 0.008212170000000001}, "model": {}, "num_grad_updates_lifetime": 12755.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 369308, "num_env_steps_trained": 369308, "num_agent_steps_sampled": 369308, "num_agent_steps_trained": 369308}, "sampler_results": {"episode_reward_max": 50.80364858675695, "episode_reward_min": -40.523984925341985, "episode_reward_mean": 12.09647323589848, "episode_len_mean": 775.98, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.377165583783967, -5.989583182281223, 9.414705553731572, 17.32173371599693, 14.299521243154599, 11.388175078037756, 34.59315757355221, 23.311471871050284, -18.97771827206977, 12.172502036802198, 3.2654722116153074, 32.70948859549222, -0.3553826322896345, 25.331574426365208, 13.465329829585833, 26.141913577211746, -8.413781060224823, 11.016416239825773, -0.22263603356933614, 12.29516917437562, 8.830116349421374, 31.047829985468223, 23.373905582551767, 8.29445569959507, -4.3848803557574065, 12.640124285943902, 26.185885889318598, 2.5172675154286437, 16.76080851162238, 17.549497342270307, 20.296398663764233, -2.6606355195143605, 15.434110997088602, 3.321359972787001, 21.128541546446804, 0.100078827702621, -10.804316267761024, 29.305062928771104, 10.65218692775763, 15.346050508661964, -18.79799423928265, 13.339336365492379, -4.075750248001843, -21.555733003162857, 38.2524449385796, 31.190312295749596, 14.431400147966533, -18.75630997998552, 22.44213333433021, -8.496319659972936, 8.22934358702965, 15.976055281209558, 18.748194113884665, 30.4107360701647, -40.523984925341985, -18.117651647534753, -33.377286081306075, -20.398599698921885, 40.9738989456164, 39.33564761934865, 10.749585991935822, 27.304838275954232, 17.51675478975239, -8.276933669703798, 50.80364858675695, 22.3478936019683, 18.930803663234137, -1.8576096607856907, -7.3805943127055045, -5.486185648945943, 13.469174971215594, 19.556919945160576, 31.80066077066398, 17.960589497709105, 2.797818210371392, -15.614224852148803, 15.840349503152872, 34.85383079978857, -5.473956066367615, 24.873476693011813, 3.830867555239535, 18.870638078145646, 24.288691943085563, -21.850847188636102, 1.9940333200082527, 22.135259563069116, 20.826106884526087, 28.862081986557786, 8.677259333673064, 22.65808516569484, 23.201190205717168, 37.08405424002145, 42.60971757592307, 13.797146021943416, -10.067817940743748, 36.95298262690893, 31.218724492433722, 18.225749495494842, 15.94630345716497, 42.361837546026806], "episode_lengths": [295, 1061, 798, 295, 233, 690, 1117, 1117, 406, 295, 855, 1117, 698, 1117, 958, 1117, 791, 396, 761, 1117, 306, 1117, 295, 297, 801, 1090, 1117, 682, 1117, 295, 295, 342, 295, 1117, 295, 357, 449, 1117, 925, 269, 605, 1117, 793, 643, 1117, 1117, 295, 622, 1117, 796, 1117, 295, 295, 1117, 624, 468, 802, 684, 1117, 1117, 1117, 295, 1117, 454, 1117, 1117, 1117, 443, 896, 895, 1117, 1117, 1117, 295, 695, 1117, 295, 1117, 925, 1117, 295, 295, 1117, 765, 1117, 1117, 295, 295, 945, 295, 1117, 1117, 1117, 1117, 681, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9302638551387634, "mean_inference_ms": 6.583801228494946, "mean_action_processing_ms": 0.44730724301387315, "mean_env_wait_ms": 19.92064972350854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021856069564819336, "StateBufferConnector_ms": 0.014600038528442383, "ViewRequirementAgentConnector_ms": 0.6410255432128906}}, "episode_reward_max": 50.80364858675695, "episode_reward_min": -40.523984925341985, "episode_reward_mean": 12.09647323589848, "episode_len_mean": 775.98, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.377165583783967, -5.989583182281223, 9.414705553731572, 17.32173371599693, 14.299521243154599, 11.388175078037756, 34.59315757355221, 23.311471871050284, -18.97771827206977, 12.172502036802198, 3.2654722116153074, 32.70948859549222, -0.3553826322896345, 25.331574426365208, 13.465329829585833, 26.141913577211746, -8.413781060224823, 11.016416239825773, -0.22263603356933614, 12.29516917437562, 8.830116349421374, 31.047829985468223, 23.373905582551767, 8.29445569959507, -4.3848803557574065, 12.640124285943902, 26.185885889318598, 2.5172675154286437, 16.76080851162238, 17.549497342270307, 20.296398663764233, -2.6606355195143605, 15.434110997088602, 3.321359972787001, 21.128541546446804, 0.100078827702621, -10.804316267761024, 29.305062928771104, 10.65218692775763, 15.346050508661964, -18.79799423928265, 13.339336365492379, -4.075750248001843, -21.555733003162857, 38.2524449385796, 31.190312295749596, 14.431400147966533, -18.75630997998552, 22.44213333433021, -8.496319659972936, 8.22934358702965, 15.976055281209558, 18.748194113884665, 30.4107360701647, -40.523984925341985, -18.117651647534753, -33.377286081306075, -20.398599698921885, 40.9738989456164, 39.33564761934865, 10.749585991935822, 27.304838275954232, 17.51675478975239, -8.276933669703798, 50.80364858675695, 22.3478936019683, 18.930803663234137, -1.8576096607856907, -7.3805943127055045, -5.486185648945943, 13.469174971215594, 19.556919945160576, 31.80066077066398, 17.960589497709105, 2.797818210371392, -15.614224852148803, 15.840349503152872, 34.85383079978857, -5.473956066367615, 24.873476693011813, 3.830867555239535, 18.870638078145646, 24.288691943085563, -21.850847188636102, 1.9940333200082527, 22.135259563069116, 20.826106884526087, 28.862081986557786, 8.677259333673064, 22.65808516569484, 23.201190205717168, 37.08405424002145, 42.60971757592307, 13.797146021943416, -10.067817940743748, 36.95298262690893, 31.218724492433722, 18.225749495494842, 15.94630345716497, 42.361837546026806], "episode_lengths": [295, 1061, 798, 295, 233, 690, 1117, 1117, 406, 295, 855, 1117, 698, 1117, 958, 1117, 791, 396, 761, 1117, 306, 1117, 295, 297, 801, 1090, 1117, 682, 1117, 295, 295, 342, 295, 1117, 295, 357, 449, 1117, 925, 269, 605, 1117, 793, 643, 1117, 1117, 295, 622, 1117, 796, 1117, 295, 295, 1117, 624, 468, 802, 684, 1117, 1117, 1117, 295, 1117, 454, 1117, 1117, 1117, 443, 896, 895, 1117, 1117, 1117, 295, 695, 1117, 295, 1117, 925, 1117, 295, 295, 1117, 765, 1117, 1117, 295, 295, 945, 295, 1117, 1117, 1117, 1117, 681, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9302638551387634, "mean_inference_ms": 6.583801228494946, "mean_action_processing_ms": 0.44730724301387315, "mean_env_wait_ms": 19.92064972350854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021856069564819336, "StateBufferConnector_ms": 0.014600038528442383, "ViewRequirementAgentConnector_ms": 0.6410255432128906}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 369308, "num_agent_steps_trained": 369308, "num_env_steps_sampled": 369308, "num_env_steps_trained": 369308, "num_env_steps_sampled_this_iter": 11742, "num_env_steps_trained_this_iter": 11742, "num_env_steps_sampled_throughput_per_sec": 228.73022202876695, "num_env_steps_trained_throughput_per_sec": 228.73022202876695, "timesteps_total": 369308, "num_steps_trained_this_iter": 11742, "agent_timesteps_total": 369308, "timers": {"training_iteration_time_ms": 49137.785, "sample_time_ms": 32247.457, "load_time_ms": 1936.486, "load_throughput": 5539.83, "learn_time_ms": 14389.872, "learn_throughput": 745.51, "synch_weights_time_ms": 473.525}, "counters": {"num_env_steps_sampled": 369308, "num_env_steps_trained": 369308, "num_agent_steps_sampled": 369308, "num_agent_steps_trained": 369308}, "done": false, "episodes_total": 605, "training_iteration": 43, "trial_id": "32ccc_00000", "date": "2025-06-07_12-31-26", "timestamp": 1749292286, "time_this_iter_s": 51.35413837432861, "time_total_s": 1808.6626846790314, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1808.6626846790314, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 61.03387096774193, "ram_util_percent": 86.71290322580646, "gpu_util_percent0": 0.17903225806451611, "vram_util_percent0": 0.96435546875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.630692000000003e-05, "total_loss": -0.11113623837442245, "policy_loss": -0.005570378830266553, "vf_loss": 0.08438531835455187, "vf_explained_var": 0.9361372308675633, "kl": 0.010187987950334465, "entropy": 16.208450898458793, "entropy_coeff": 0.00815346}, "model": {}, "num_grad_updates_lifetime": 13175.5, "diff_num_grad_updates_vs_sampler_policy": 214.5}}, "num_env_steps_sampled": 381414, "num_env_steps_trained": 381414, "num_agent_steps_sampled": 381414, "num_agent_steps_trained": 381414}, "sampler_results": {"episode_reward_max": 50.80364858675695, "episode_reward_min": -40.523984925341985, "episode_reward_mean": 11.797014349021966, "episode_len_mean": 796.1, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.465329829585833, 26.141913577211746, -8.413781060224823, 11.016416239825773, -0.22263603356933614, 12.29516917437562, 8.830116349421374, 31.047829985468223, 23.373905582551767, 8.29445569959507, -4.3848803557574065, 12.640124285943902, 26.185885889318598, 2.5172675154286437, 16.76080851162238, 17.549497342270307, 20.296398663764233, -2.6606355195143605, 15.434110997088602, 3.321359972787001, 21.128541546446804, 0.100078827702621, -10.804316267761024, 29.305062928771104, 10.65218692775763, 15.346050508661964, -18.79799423928265, 13.339336365492379, -4.075750248001843, -21.555733003162857, 38.2524449385796, 31.190312295749596, 14.431400147966533, -18.75630997998552, 22.44213333433021, -8.496319659972936, 8.22934358702965, 15.976055281209558, 18.748194113884665, 30.4107360701647, -40.523984925341985, -18.117651647534753, -33.377286081306075, -20.398599698921885, 40.9738989456164, 39.33564761934865, 10.749585991935822, 27.304838275954232, 17.51675478975239, -8.276933669703798, 50.80364858675695, 22.3478936019683, 18.930803663234137, -1.8576096607856907, -7.3805943127055045, -5.486185648945943, 13.469174971215594, 19.556919945160576, 31.80066077066398, 17.960589497709105, 2.797818210371392, -15.614224852148803, 15.840349503152872, 34.85383079978857, -5.473956066367615, 24.873476693011813, 3.830867555239535, 18.870638078145646, 24.288691943085563, -21.850847188636102, 1.9940333200082527, 22.135259563069116, 20.826106884526087, 28.862081986557786, 8.677259333673064, 22.65808516569484, 23.201190205717168, 37.08405424002145, 42.60971757592307, 13.797146021943416, -10.067817940743748, 36.95298262690893, 31.218724492433722, 18.225749495494842, 15.94630345716497, 42.361837546026806, 5.155506287286724, 22.624192181748334, 12.586185744476598, -5.390011837936588, 2.9373930060997435, 8.12454583119967, 37.92931130625909, 14.731091376903398, 11.92168306808532, 13.157611275914078, 0.5447268912974272, 0.33501494840200047, 4.183866194533889, 16.07527884102052], "episode_lengths": [958, 1117, 791, 396, 761, 1117, 306, 1117, 295, 297, 801, 1090, 1117, 682, 1117, 295, 295, 342, 295, 1117, 295, 357, 449, 1117, 925, 269, 605, 1117, 793, 643, 1117, 1117, 295, 622, 1117, 796, 1117, 295, 295, 1117, 624, 468, 802, 684, 1117, 1117, 1117, 295, 1117, 454, 1117, 1117, 1117, 443, 896, 895, 1117, 1117, 1117, 295, 695, 1117, 295, 1117, 925, 1117, 295, 295, 1117, 765, 1117, 1117, 295, 295, 945, 295, 1117, 1117, 1117, 1117, 681, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 795, 295, 1117, 295, 1117, 373, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9342614991298648, "mean_inference_ms": 6.591350054985703, "mean_action_processing_ms": 0.447915318675884, "mean_env_wait_ms": 19.944455109101565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022467851638793945, "StateBufferConnector_ms": 0.01421046257019043, "ViewRequirementAgentConnector_ms": 0.6602470874786377}}, "episode_reward_max": 50.80364858675695, "episode_reward_min": -40.523984925341985, "episode_reward_mean": 11.797014349021966, "episode_len_mean": 796.1, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.465329829585833, 26.141913577211746, -8.413781060224823, 11.016416239825773, -0.22263603356933614, 12.29516917437562, 8.830116349421374, 31.047829985468223, 23.373905582551767, 8.29445569959507, -4.3848803557574065, 12.640124285943902, 26.185885889318598, 2.5172675154286437, 16.76080851162238, 17.549497342270307, 20.296398663764233, -2.6606355195143605, 15.434110997088602, 3.321359972787001, 21.128541546446804, 0.100078827702621, -10.804316267761024, 29.305062928771104, 10.65218692775763, 15.346050508661964, -18.79799423928265, 13.339336365492379, -4.075750248001843, -21.555733003162857, 38.2524449385796, 31.190312295749596, 14.431400147966533, -18.75630997998552, 22.44213333433021, -8.496319659972936, 8.22934358702965, 15.976055281209558, 18.748194113884665, 30.4107360701647, -40.523984925341985, -18.117651647534753, -33.377286081306075, -20.398599698921885, 40.9738989456164, 39.33564761934865, 10.749585991935822, 27.304838275954232, 17.51675478975239, -8.276933669703798, 50.80364858675695, 22.3478936019683, 18.930803663234137, -1.8576096607856907, -7.3805943127055045, -5.486185648945943, 13.469174971215594, 19.556919945160576, 31.80066077066398, 17.960589497709105, 2.797818210371392, -15.614224852148803, 15.840349503152872, 34.85383079978857, -5.473956066367615, 24.873476693011813, 3.830867555239535, 18.870638078145646, 24.288691943085563, -21.850847188636102, 1.9940333200082527, 22.135259563069116, 20.826106884526087, 28.862081986557786, 8.677259333673064, 22.65808516569484, 23.201190205717168, 37.08405424002145, 42.60971757592307, 13.797146021943416, -10.067817940743748, 36.95298262690893, 31.218724492433722, 18.225749495494842, 15.94630345716497, 42.361837546026806, 5.155506287286724, 22.624192181748334, 12.586185744476598, -5.390011837936588, 2.9373930060997435, 8.12454583119967, 37.92931130625909, 14.731091376903398, 11.92168306808532, 13.157611275914078, 0.5447268912974272, 0.33501494840200047, 4.183866194533889, 16.07527884102052], "episode_lengths": [958, 1117, 791, 396, 761, 1117, 306, 1117, 295, 297, 801, 1090, 1117, 682, 1117, 295, 295, 342, 295, 1117, 295, 357, 449, 1117, 925, 269, 605, 1117, 793, 643, 1117, 1117, 295, 622, 1117, 796, 1117, 295, 295, 1117, 624, 468, 802, 684, 1117, 1117, 1117, 295, 1117, 454, 1117, 1117, 1117, 443, 896, 895, 1117, 1117, 1117, 295, 695, 1117, 295, 1117, 925, 1117, 295, 295, 1117, 765, 1117, 1117, 295, 295, 945, 295, 1117, 1117, 1117, 1117, 681, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 795, 295, 1117, 295, 1117, 373, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9342614991298648, "mean_inference_ms": 6.591350054985703, "mean_action_processing_ms": 0.447915318675884, "mean_env_wait_ms": 19.944455109101565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022467851638793945, "StateBufferConnector_ms": 0.01421046257019043, "ViewRequirementAgentConnector_ms": 0.6602470874786377}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 381414, "num_agent_steps_trained": 381414, "num_env_steps_sampled": 381414, "num_env_steps_trained": 381414, "num_env_steps_sampled_this_iter": 12106, "num_env_steps_trained_this_iter": 12106, "num_env_steps_sampled_throughput_per_sec": 219.94459777476447, "num_env_steps_trained_throughput_per_sec": 219.94459777476447, "timesteps_total": 381414, "num_steps_trained_this_iter": 12106, "agent_timesteps_total": 381414, "timers": {"training_iteration_time_ms": 49803.987, "sample_time_ms": 32549.557, "load_time_ms": 2116.777, "load_throughput": 5137.15, "learn_time_ms": 14570.352, "learn_throughput": 746.324, "synch_weights_time_ms": 473.23}, "counters": {"num_env_steps_sampled": 381414, "num_env_steps_trained": 381414, "num_agent_steps_sampled": 381414, "num_agent_steps_trained": 381414}, "done": false, "episodes_total": 619, "training_iteration": 44, "trial_id": "32ccc_00000", "date": "2025-06-07_12-32-21", "timestamp": 1749292341, "time_this_iter_s": 55.05481243133545, "time_total_s": 1863.7174971103668, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1863.7174971103668, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 61.18307692307692, "ram_util_percent": 88.12769230769231, "gpu_util_percent0": 0.17538461538461542, "vram_util_percent0": 0.9647010216346154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.618586e-05, "total_loss": -0.12546824882922106, "policy_loss": -0.0216752052850911, "vf_loss": 0.08467366332678418, "vf_explained_var": 0.9176289166274824, "kl": 0.010010828551343078, "entropy": 16.118576094978735, "entropy_coeff": 0.00809293}, "model": {}, "num_grad_updates_lifetime": 13580.5, "diff_num_grad_updates_vs_sampler_policy": 189.5}}, "num_env_steps_sampled": 392193, "num_env_steps_trained": 392193, "num_agent_steps_sampled": 392193, "num_agent_steps_trained": 392193}, "sampler_results": {"episode_reward_max": 50.80364858675695, "episode_reward_min": -40.523984925341985, "episode_reward_mean": 10.422504036097466, "episode_len_mean": 795.44, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.76080851162238, 17.549497342270307, 20.296398663764233, -2.6606355195143605, 15.434110997088602, 3.321359972787001, 21.128541546446804, 0.100078827702621, -10.804316267761024, 29.305062928771104, 10.65218692775763, 15.346050508661964, -18.79799423928265, 13.339336365492379, -4.075750248001843, -21.555733003162857, 38.2524449385796, 31.190312295749596, 14.431400147966533, -18.75630997998552, 22.44213333433021, -8.496319659972936, 8.22934358702965, 15.976055281209558, 18.748194113884665, 30.4107360701647, -40.523984925341985, -18.117651647534753, -33.377286081306075, -20.398599698921885, 40.9738989456164, 39.33564761934865, 10.749585991935822, 27.304838275954232, 17.51675478975239, -8.276933669703798, 50.80364858675695, 22.3478936019683, 18.930803663234137, -1.8576096607856907, -7.3805943127055045, -5.486185648945943, 13.469174971215594, 19.556919945160576, 31.80066077066398, 17.960589497709105, 2.797818210371392, -15.614224852148803, 15.840349503152872, 34.85383079978857, -5.473956066367615, 24.873476693011813, 3.830867555239535, 18.870638078145646, 24.288691943085563, -21.850847188636102, 1.9940333200082527, 22.135259563069116, 20.826106884526087, 28.862081986557786, 8.677259333673064, 22.65808516569484, 23.201190205717168, 37.08405424002145, 42.60971757592307, 13.797146021943416, -10.067817940743748, 36.95298262690893, 31.218724492433722, 18.225749495494842, 15.94630345716497, 42.361837546026806, 5.155506287286724, 22.624192181748334, 12.586185744476598, -5.390011837936588, 2.9373930060997435, 8.12454583119967, 37.92931130625909, 14.731091376903398, 11.92168306808532, 13.157611275914078, 0.5447268912974272, 0.33501494840200047, 4.183866194533889, 16.07527884102052, -16.053402138663948, -40.148410840336446, 1.9658686420092186, -18.678912940164007, -5.267377053925972, 22.71009291722304, 15.92943775365437, 23.331405447236953, -12.114606117982499, 25.558098387082094, -9.941276592112859, 6.567508780423758, 16.66945704118796, 14.808202101093565], "episode_lengths": [1117, 295, 295, 342, 295, 1117, 295, 357, 449, 1117, 925, 269, 605, 1117, 793, 643, 1117, 1117, 295, 622, 1117, 796, 1117, 295, 295, 1117, 624, 468, 802, 684, 1117, 1117, 1117, 295, 1117, 454, 1117, 1117, 1117, 443, 896, 895, 1117, 1117, 1117, 295, 695, 1117, 295, 1117, 925, 1117, 295, 295, 1117, 765, 1117, 1117, 295, 295, 945, 295, 1117, 1117, 1117, 1117, 681, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 795, 295, 1117, 295, 1117, 373, 1117, 1117, 1117, 1117, 797, 870, 882, 578, 950, 1117, 269, 1117, 761, 1117, 614, 1117, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9384212210651117, "mean_inference_ms": 6.599631539544971, "mean_action_processing_ms": 0.4485250973451916, "mean_env_wait_ms": 19.969863310613395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02042222023010254, "StateBufferConnector_ms": 0.01421046257019043, "ViewRequirementAgentConnector_ms": 0.6718177795410156}}, "episode_reward_max": 50.80364858675695, "episode_reward_min": -40.523984925341985, "episode_reward_mean": 10.422504036097466, "episode_len_mean": 795.44, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.76080851162238, 17.549497342270307, 20.296398663764233, -2.6606355195143605, 15.434110997088602, 3.321359972787001, 21.128541546446804, 0.100078827702621, -10.804316267761024, 29.305062928771104, 10.65218692775763, 15.346050508661964, -18.79799423928265, 13.339336365492379, -4.075750248001843, -21.555733003162857, 38.2524449385796, 31.190312295749596, 14.431400147966533, -18.75630997998552, 22.44213333433021, -8.496319659972936, 8.22934358702965, 15.976055281209558, 18.748194113884665, 30.4107360701647, -40.523984925341985, -18.117651647534753, -33.377286081306075, -20.398599698921885, 40.9738989456164, 39.33564761934865, 10.749585991935822, 27.304838275954232, 17.51675478975239, -8.276933669703798, 50.80364858675695, 22.3478936019683, 18.930803663234137, -1.8576096607856907, -7.3805943127055045, -5.486185648945943, 13.469174971215594, 19.556919945160576, 31.80066077066398, 17.960589497709105, 2.797818210371392, -15.614224852148803, 15.840349503152872, 34.85383079978857, -5.473956066367615, 24.873476693011813, 3.830867555239535, 18.870638078145646, 24.288691943085563, -21.850847188636102, 1.9940333200082527, 22.135259563069116, 20.826106884526087, 28.862081986557786, 8.677259333673064, 22.65808516569484, 23.201190205717168, 37.08405424002145, 42.60971757592307, 13.797146021943416, -10.067817940743748, 36.95298262690893, 31.218724492433722, 18.225749495494842, 15.94630345716497, 42.361837546026806, 5.155506287286724, 22.624192181748334, 12.586185744476598, -5.390011837936588, 2.9373930060997435, 8.12454583119967, 37.92931130625909, 14.731091376903398, 11.92168306808532, 13.157611275914078, 0.5447268912974272, 0.33501494840200047, 4.183866194533889, 16.07527884102052, -16.053402138663948, -40.148410840336446, 1.9658686420092186, -18.678912940164007, -5.267377053925972, 22.71009291722304, 15.92943775365437, 23.331405447236953, -12.114606117982499, 25.558098387082094, -9.941276592112859, 6.567508780423758, 16.66945704118796, 14.808202101093565], "episode_lengths": [1117, 295, 295, 342, 295, 1117, 295, 357, 449, 1117, 925, 269, 605, 1117, 793, 643, 1117, 1117, 295, 622, 1117, 796, 1117, 295, 295, 1117, 624, 468, 802, 684, 1117, 1117, 1117, 295, 1117, 454, 1117, 1117, 1117, 443, 896, 895, 1117, 1117, 1117, 295, 695, 1117, 295, 1117, 925, 1117, 295, 295, 1117, 765, 1117, 1117, 295, 295, 945, 295, 1117, 1117, 1117, 1117, 681, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 795, 295, 1117, 295, 1117, 373, 1117, 1117, 1117, 1117, 797, 870, 882, 578, 950, 1117, 269, 1117, 761, 1117, 614, 1117, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9384212210651117, "mean_inference_ms": 6.599631539544971, "mean_action_processing_ms": 0.4485250973451916, "mean_env_wait_ms": 19.969863310613395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02042222023010254, "StateBufferConnector_ms": 0.01421046257019043, "ViewRequirementAgentConnector_ms": 0.6718177795410156}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392193, "num_agent_steps_trained": 392193, "num_env_steps_sampled": 392193, "num_env_steps_trained": 392193, "num_env_steps_sampled_this_iter": 10779, "num_env_steps_trained_this_iter": 10779, "num_env_steps_sampled_throughput_per_sec": 223.37535963865946, "num_env_steps_trained_throughput_per_sec": 223.37535963865946, "timesteps_total": 392193, "num_steps_trained_this_iter": 10779, "agent_timesteps_total": 392193, "timers": {"training_iteration_time_ms": 49772.915, "sample_time_ms": 32582.525, "load_time_ms": 1980.781, "load_throughput": 5498.994, "learn_time_ms": 14644.723, "learn_throughput": 743.77, "synch_weights_time_ms": 471.678}, "counters": {"num_env_steps_sampled": 392193, "num_env_steps_trained": 392193, "num_agent_steps_sampled": 392193, "num_agent_steps_trained": 392193}, "done": false, "episodes_total": 633, "training_iteration": 45, "trial_id": "32ccc_00000", "date": "2025-06-07_12-33-09", "timestamp": 1749292389, "time_this_iter_s": 48.27180790901184, "time_total_s": 1911.9893050193787, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1911.9893050193787, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 59.82068965517242, "ram_util_percent": 89.79655172413794, "gpu_util_percent0": 0.17793103448275863, "vram_util_percent0": 0.96533203125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.607807000000002e-05, "total_loss": -0.10417514839355135, "policy_loss": -0.0008832234048168175, "vf_loss": 0.08195371786830946, "vf_explained_var": 0.9265471014380455, "kl": 0.010552436646541388, "entropy": 16.0712197637558, "entropy_coeff": 0.008039035}, "model": {}, "num_grad_updates_lifetime": 13970.5, "diff_num_grad_updates_vs_sampler_policy": 199.5}}, "num_env_steps_sampled": 403487, "num_env_steps_trained": 403487, "num_agent_steps_sampled": 403487, "num_agent_steps_trained": 403487}, "sampler_results": {"episode_reward_max": 50.80364858675695, "episode_reward_min": -40.523984925341985, "episode_reward_mean": 11.166036820837105, "episode_len_mean": 822.43, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.075750248001843, -21.555733003162857, 38.2524449385796, 31.190312295749596, 14.431400147966533, -18.75630997998552, 22.44213333433021, -8.496319659972936, 8.22934358702965, 15.976055281209558, 18.748194113884665, 30.4107360701647, -40.523984925341985, -18.117651647534753, -33.377286081306075, -20.398599698921885, 40.9738989456164, 39.33564761934865, 10.749585991935822, 27.304838275954232, 17.51675478975239, -8.276933669703798, 50.80364858675695, 22.3478936019683, 18.930803663234137, -1.8576096607856907, -7.3805943127055045, -5.486185648945943, 13.469174971215594, 19.556919945160576, 31.80066077066398, 17.960589497709105, 2.797818210371392, -15.614224852148803, 15.840349503152872, 34.85383079978857, -5.473956066367615, 24.873476693011813, 3.830867555239535, 18.870638078145646, 24.288691943085563, -21.850847188636102, 1.9940333200082527, 22.135259563069116, 20.826106884526087, 28.862081986557786, 8.677259333673064, 22.65808516569484, 23.201190205717168, 37.08405424002145, 42.60971757592307, 13.797146021943416, -10.067817940743748, 36.95298262690893, 31.218724492433722, 18.225749495494842, 15.94630345716497, 42.361837546026806, 5.155506287286724, 22.624192181748334, 12.586185744476598, -5.390011837936588, 2.9373930060997435, 8.12454583119967, 37.92931130625909, 14.731091376903398, 11.92168306808532, 13.157611275914078, 0.5447268912974272, 0.33501494840200047, 4.183866194533889, 16.07527884102052, -16.053402138663948, -40.148410840336446, 1.9658686420092186, -18.678912940164007, -5.267377053925972, 22.71009291722304, 15.92943775365437, 23.331405447236953, -12.114606117982499, 25.558098387082094, -9.941276592112859, 6.567508780423758, 16.66945704118796, 14.808202101093565, 6.7238944584484726, 45.147086221135964, 20.397398981406987, 13.396657283024556, 13.989591664051286, 15.778847823262073, 5.273434035811243, -9.720561832601165, 27.669444643920702, 3.7562962241321847, 17.349101603874292, 8.455051334219405, 16.27945107001848, 20.82807152906622], "episode_lengths": [793, 643, 1117, 1117, 295, 622, 1117, 796, 1117, 295, 295, 1117, 624, 468, 802, 684, 1117, 1117, 1117, 295, 1117, 454, 1117, 1117, 1117, 443, 896, 895, 1117, 1117, 1117, 295, 695, 1117, 295, 1117, 925, 1117, 295, 295, 1117, 765, 1117, 1117, 295, 295, 945, 295, 1117, 1117, 1117, 1117, 681, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 795, 295, 1117, 295, 1117, 373, 1117, 1117, 1117, 1117, 797, 870, 882, 578, 950, 1117, 269, 1117, 761, 1117, 614, 1117, 295, 295, 797, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 381, 1117, 295, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9436593740087778, "mean_inference_ms": 6.608734698049347, "mean_action_processing_ms": 0.44917229992610613, "mean_env_wait_ms": 19.99739461164181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020441293716430664, "StateBufferConnector_ms": 0.017688512802124023, "ViewRequirementAgentConnector_ms": 0.6593296527862549}}, "episode_reward_max": 50.80364858675695, "episode_reward_min": -40.523984925341985, "episode_reward_mean": 11.166036820837105, "episode_len_mean": 822.43, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.075750248001843, -21.555733003162857, 38.2524449385796, 31.190312295749596, 14.431400147966533, -18.75630997998552, 22.44213333433021, -8.496319659972936, 8.22934358702965, 15.976055281209558, 18.748194113884665, 30.4107360701647, -40.523984925341985, -18.117651647534753, -33.377286081306075, -20.398599698921885, 40.9738989456164, 39.33564761934865, 10.749585991935822, 27.304838275954232, 17.51675478975239, -8.276933669703798, 50.80364858675695, 22.3478936019683, 18.930803663234137, -1.8576096607856907, -7.3805943127055045, -5.486185648945943, 13.469174971215594, 19.556919945160576, 31.80066077066398, 17.960589497709105, 2.797818210371392, -15.614224852148803, 15.840349503152872, 34.85383079978857, -5.473956066367615, 24.873476693011813, 3.830867555239535, 18.870638078145646, 24.288691943085563, -21.850847188636102, 1.9940333200082527, 22.135259563069116, 20.826106884526087, 28.862081986557786, 8.677259333673064, 22.65808516569484, 23.201190205717168, 37.08405424002145, 42.60971757592307, 13.797146021943416, -10.067817940743748, 36.95298262690893, 31.218724492433722, 18.225749495494842, 15.94630345716497, 42.361837546026806, 5.155506287286724, 22.624192181748334, 12.586185744476598, -5.390011837936588, 2.9373930060997435, 8.12454583119967, 37.92931130625909, 14.731091376903398, 11.92168306808532, 13.157611275914078, 0.5447268912974272, 0.33501494840200047, 4.183866194533889, 16.07527884102052, -16.053402138663948, -40.148410840336446, 1.9658686420092186, -18.678912940164007, -5.267377053925972, 22.71009291722304, 15.92943775365437, 23.331405447236953, -12.114606117982499, 25.558098387082094, -9.941276592112859, 6.567508780423758, 16.66945704118796, 14.808202101093565, 6.7238944584484726, 45.147086221135964, 20.397398981406987, 13.396657283024556, 13.989591664051286, 15.778847823262073, 5.273434035811243, -9.720561832601165, 27.669444643920702, 3.7562962241321847, 17.349101603874292, 8.455051334219405, 16.27945107001848, 20.82807152906622], "episode_lengths": [793, 643, 1117, 1117, 295, 622, 1117, 796, 1117, 295, 295, 1117, 624, 468, 802, 684, 1117, 1117, 1117, 295, 1117, 454, 1117, 1117, 1117, 443, 896, 895, 1117, 1117, 1117, 295, 695, 1117, 295, 1117, 925, 1117, 295, 295, 1117, 765, 1117, 1117, 295, 295, 945, 295, 1117, 1117, 1117, 1117, 681, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 795, 295, 1117, 295, 1117, 373, 1117, 1117, 1117, 1117, 797, 870, 882, 578, 950, 1117, 269, 1117, 761, 1117, 614, 1117, 295, 295, 797, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 381, 1117, 295, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9436593740087778, "mean_inference_ms": 6.608734698049347, "mean_action_processing_ms": 0.44917229992610613, "mean_env_wait_ms": 19.99739461164181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020441293716430664, "StateBufferConnector_ms": 0.017688512802124023, "ViewRequirementAgentConnector_ms": 0.6593296527862549}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 403487, "num_agent_steps_trained": 403487, "num_env_steps_sampled": 403487, "num_env_steps_trained": 403487, "num_env_steps_sampled_this_iter": 11294, "num_env_steps_trained_this_iter": 11294, "num_env_steps_sampled_throughput_per_sec": 216.76442754999246, "num_env_steps_trained_throughput_per_sec": 216.76442754999246, "timesteps_total": 403487, "num_steps_trained_this_iter": 11294, "agent_timesteps_total": 403487, "timers": {"training_iteration_time_ms": 50317.755, "sample_time_ms": 32865.532, "load_time_ms": 1995.439, "load_throughput": 5533.669, "learn_time_ms": 14915.236, "learn_throughput": 740.324, "synch_weights_time_ms": 446.731}, "counters": {"num_env_steps_sampled": 403487, "num_env_steps_trained": 403487, "num_agent_steps_sampled": 403487, "num_agent_steps_trained": 403487}, "done": false, "episodes_total": 647, "training_iteration": 46, "trial_id": "32ccc_00000", "date": "2025-06-07_12-34-01", "timestamp": 1749292441, "time_this_iter_s": 52.11455321311951, "time_total_s": 1964.1038582324982, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1964.1038582324982, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 58.2241935483871, "ram_util_percent": 89.79032258064515, "gpu_util_percent0": 0.20354838709677414, "vram_util_percent0": 0.96533203125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.596513000000002e-05, "total_loss": -0.10519103778875433, "policy_loss": 0.000842513112584129, "vf_loss": 0.06980671724071726, "vf_explained_var": 0.9405162577331067, "kl": 0.011182027023752207, "entropy": 16.081712934970856, "entropy_coeff": 0.007982564999999999}, "model": {}, "num_grad_updates_lifetime": 14370.5, "diff_num_grad_updates_vs_sampler_policy": 199.5}}, "num_env_steps_sampled": 414748, "num_env_steps_trained": 414748, "num_agent_steps_sampled": 414748, "num_agent_steps_trained": 414748}, "sampler_results": {"episode_reward_max": 50.80364858675695, "episode_reward_min": -40.148410840336446, "episode_reward_mean": 12.91233290822848, "episode_len_mean": 830.88, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.377286081306075, -20.398599698921885, 40.9738989456164, 39.33564761934865, 10.749585991935822, 27.304838275954232, 17.51675478975239, -8.276933669703798, 50.80364858675695, 22.3478936019683, 18.930803663234137, -1.8576096607856907, -7.3805943127055045, -5.486185648945943, 13.469174971215594, 19.556919945160576, 31.80066077066398, 17.960589497709105, 2.797818210371392, -15.614224852148803, 15.840349503152872, 34.85383079978857, -5.473956066367615, 24.873476693011813, 3.830867555239535, 18.870638078145646, 24.288691943085563, -21.850847188636102, 1.9940333200082527, 22.135259563069116, 20.826106884526087, 28.862081986557786, 8.677259333673064, 22.65808516569484, 23.201190205717168, 37.08405424002145, 42.60971757592307, 13.797146021943416, -10.067817940743748, 36.95298262690893, 31.218724492433722, 18.225749495494842, 15.94630345716497, 42.361837546026806, 5.155506287286724, 22.624192181748334, 12.586185744476598, -5.390011837936588, 2.9373930060997435, 8.12454583119967, 37.92931130625909, 14.731091376903398, 11.92168306808532, 13.157611275914078, 0.5447268912974272, 0.33501494840200047, 4.183866194533889, 16.07527884102052, -16.053402138663948, -40.148410840336446, 1.9658686420092186, -18.678912940164007, -5.267377053925972, 22.71009291722304, 15.92943775365437, 23.331405447236953, -12.114606117982499, 25.558098387082094, -9.941276592112859, 6.567508780423758, 16.66945704118796, 14.808202101093565, 6.7238944584484726, 45.147086221135964, 20.397398981406987, 13.396657283024556, 13.989591664051286, 15.778847823262073, 5.273434035811243, -9.720561832601165, 27.669444643920702, 3.7562962241321847, 17.349101603874292, 8.455051334219405, 16.27945107001848, 20.82807152906622, 24.812079545525286, 50.20076830022965, -9.86764512995533, 27.67982695543311, 17.383960761767167, 10.318649611711553, 1.2210791737021716, 18.864390437090393, 20.54115669193879, 19.650160985806256, -0.6734359020400925, 15.882081409931939, 23.861749323162954, 22.90965687974842], "episode_lengths": [802, 684, 1117, 1117, 1117, 295, 1117, 454, 1117, 1117, 1117, 443, 896, 895, 1117, 1117, 1117, 295, 695, 1117, 295, 1117, 925, 1117, 295, 295, 1117, 765, 1117, 1117, 295, 295, 945, 295, 1117, 1117, 1117, 1117, 681, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 795, 295, 1117, 295, 1117, 373, 1117, 1117, 1117, 1117, 797, 870, 882, 578, 950, 1117, 269, 1117, 761, 1117, 614, 1117, 295, 295, 797, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 381, 1117, 295, 295, 1117, 295, 1117, 730, 1117, 1117, 295, 1117, 1117, 1117, 1117, 415, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9495981904766615, "mean_inference_ms": 6.617414282942739, "mean_action_processing_ms": 0.44977177532871976, "mean_env_wait_ms": 20.025777130799312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021298646926879883, "StateBufferConnector_ms": 0.02175164222717285, "ViewRequirementAgentConnector_ms": 0.6529934406280518}}, "episode_reward_max": 50.80364858675695, "episode_reward_min": -40.148410840336446, "episode_reward_mean": 12.91233290822848, "episode_len_mean": 830.88, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-33.377286081306075, -20.398599698921885, 40.9738989456164, 39.33564761934865, 10.749585991935822, 27.304838275954232, 17.51675478975239, -8.276933669703798, 50.80364858675695, 22.3478936019683, 18.930803663234137, -1.8576096607856907, -7.3805943127055045, -5.486185648945943, 13.469174971215594, 19.556919945160576, 31.80066077066398, 17.960589497709105, 2.797818210371392, -15.614224852148803, 15.840349503152872, 34.85383079978857, -5.473956066367615, 24.873476693011813, 3.830867555239535, 18.870638078145646, 24.288691943085563, -21.850847188636102, 1.9940333200082527, 22.135259563069116, 20.826106884526087, 28.862081986557786, 8.677259333673064, 22.65808516569484, 23.201190205717168, 37.08405424002145, 42.60971757592307, 13.797146021943416, -10.067817940743748, 36.95298262690893, 31.218724492433722, 18.225749495494842, 15.94630345716497, 42.361837546026806, 5.155506287286724, 22.624192181748334, 12.586185744476598, -5.390011837936588, 2.9373930060997435, 8.12454583119967, 37.92931130625909, 14.731091376903398, 11.92168306808532, 13.157611275914078, 0.5447268912974272, 0.33501494840200047, 4.183866194533889, 16.07527884102052, -16.053402138663948, -40.148410840336446, 1.9658686420092186, -18.678912940164007, -5.267377053925972, 22.71009291722304, 15.92943775365437, 23.331405447236953, -12.114606117982499, 25.558098387082094, -9.941276592112859, 6.567508780423758, 16.66945704118796, 14.808202101093565, 6.7238944584484726, 45.147086221135964, 20.397398981406987, 13.396657283024556, 13.989591664051286, 15.778847823262073, 5.273434035811243, -9.720561832601165, 27.669444643920702, 3.7562962241321847, 17.349101603874292, 8.455051334219405, 16.27945107001848, 20.82807152906622, 24.812079545525286, 50.20076830022965, -9.86764512995533, 27.67982695543311, 17.383960761767167, 10.318649611711553, 1.2210791737021716, 18.864390437090393, 20.54115669193879, 19.650160985806256, -0.6734359020400925, 15.882081409931939, 23.861749323162954, 22.90965687974842], "episode_lengths": [802, 684, 1117, 1117, 1117, 295, 1117, 454, 1117, 1117, 1117, 443, 896, 895, 1117, 1117, 1117, 295, 695, 1117, 295, 1117, 925, 1117, 295, 295, 1117, 765, 1117, 1117, 295, 295, 945, 295, 1117, 1117, 1117, 1117, 681, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 795, 295, 1117, 295, 1117, 373, 1117, 1117, 1117, 1117, 797, 870, 882, 578, 950, 1117, 269, 1117, 761, 1117, 614, 1117, 295, 295, 797, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 381, 1117, 295, 295, 1117, 295, 1117, 730, 1117, 1117, 295, 1117, 1117, 1117, 1117, 415, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9495981904766615, "mean_inference_ms": 6.617414282942739, "mean_action_processing_ms": 0.44977177532871976, "mean_env_wait_ms": 20.025777130799312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021298646926879883, "StateBufferConnector_ms": 0.02175164222717285, "ViewRequirementAgentConnector_ms": 0.6529934406280518}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 414748, "num_agent_steps_trained": 414748, "num_env_steps_sampled": 414748, "num_env_steps_trained": 414748, "num_env_steps_sampled_this_iter": 11261, "num_env_steps_trained_this_iter": 11261, "num_env_steps_sampled_throughput_per_sec": 221.7438883264731, "num_env_steps_trained_throughput_per_sec": 221.7438883264731, "timesteps_total": 414748, "num_steps_trained_this_iter": 11261, "agent_timesteps_total": 414748, "timers": {"training_iteration_time_ms": 50322.086, "sample_time_ms": 33011.4, "load_time_ms": 1853.252, "load_throughput": 5982.404, "learn_time_ms": 14886.115, "learn_throughput": 744.781, "synch_weights_time_ms": 479.541}, "counters": {"num_env_steps_sampled": 414748, "num_env_steps_trained": 414748, "num_agent_steps_sampled": 414748, "num_agent_steps_trained": 414748}, "done": false, "episodes_total": 661, "training_iteration": 47, "trial_id": "32ccc_00000", "date": "2025-06-07_12-34-52", "timestamp": 1749292492, "time_this_iter_s": 50.80298829078674, "time_total_s": 2014.906846523285, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2014.906846523285, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 58.54666666666667, "ram_util_percent": 89.78833333333333, "gpu_util_percent0": 0.1765, "vram_util_percent0": 0.96533203125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.585252e-05, "total_loss": -0.11715833681036851, "policy_loss": -0.015344204339385863, "vf_loss": 0.08577480605404292, "vf_explained_var": 0.935260808297566, "kl": 0.009379973736592677, "entropy": 16.239572380610873, "entropy_coeff": 0.007926260000000003}, "model": {}, "num_grad_updates_lifetime": 14745.5, "diff_num_grad_updates_vs_sampler_policy": 174.5}}, "num_env_steps_sampled": 424738, "num_env_steps_trained": 424738, "num_agent_steps_sampled": 424738, "num_agent_steps_trained": 424738}, "sampler_results": {"episode_reward_max": 50.20076830022965, "episode_reward_min": -52.55122389771357, "episode_reward_mean": 11.925070184580555, "episode_len_mean": 807.9, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.469174971215594, 19.556919945160576, 31.80066077066398, 17.960589497709105, 2.797818210371392, -15.614224852148803, 15.840349503152872, 34.85383079978857, -5.473956066367615, 24.873476693011813, 3.830867555239535, 18.870638078145646, 24.288691943085563, -21.850847188636102, 1.9940333200082527, 22.135259563069116, 20.826106884526087, 28.862081986557786, 8.677259333673064, 22.65808516569484, 23.201190205717168, 37.08405424002145, 42.60971757592307, 13.797146021943416, -10.067817940743748, 36.95298262690893, 31.218724492433722, 18.225749495494842, 15.94630345716497, 42.361837546026806, 5.155506287286724, 22.624192181748334, 12.586185744476598, -5.390011837936588, 2.9373930060997435, 8.12454583119967, 37.92931130625909, 14.731091376903398, 11.92168306808532, 13.157611275914078, 0.5447268912974272, 0.33501494840200047, 4.183866194533889, 16.07527884102052, -16.053402138663948, -40.148410840336446, 1.9658686420092186, -18.678912940164007, -5.267377053925972, 22.71009291722304, 15.92943775365437, 23.331405447236953, -12.114606117982499, 25.558098387082094, -9.941276592112859, 6.567508780423758, 16.66945704118796, 14.808202101093565, 6.7238944584484726, 45.147086221135964, 20.397398981406987, 13.396657283024556, 13.989591664051286, 15.778847823262073, 5.273434035811243, -9.720561832601165, 27.669444643920702, 3.7562962241321847, 17.349101603874292, 8.455051334219405, 16.27945107001848, 20.82807152906622, 24.812079545525286, 50.20076830022965, -9.86764512995533, 27.67982695543311, 17.383960761767167, 10.318649611711553, 1.2210791737021716, 18.864390437090393, 20.54115669193879, 19.650160985806256, -0.6734359020400925, 15.882081409931939, 23.861749323162954, 22.90965687974842, 31.892409194904026, 32.65087090354341, -4.498599780983232, 48.603520272163955, 4.257724339315848, -1.876279609371561, -52.55122389771357, 10.905813907388234, -26.709803824189986, -26.923997526232004, 15.466874650522389, -6.286413954233203, 11.910529454774176, 15.618165907516715], "episode_lengths": [1117, 1117, 1117, 295, 695, 1117, 295, 1117, 925, 1117, 295, 295, 1117, 765, 1117, 1117, 295, 295, 945, 295, 1117, 1117, 1117, 1117, 681, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 795, 295, 1117, 295, 1117, 373, 1117, 1117, 1117, 1117, 797, 870, 882, 578, 950, 1117, 269, 1117, 761, 1117, 614, 1117, 295, 295, 797, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 381, 1117, 295, 295, 1117, 295, 1117, 730, 1117, 1117, 295, 1117, 1117, 1117, 1117, 415, 295, 1117, 295, 1117, 1117, 439, 1117, 887, 1117, 583, 295, 406, 373, 1117, 832, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9535401648716482, "mean_inference_ms": 6.623645470088302, "mean_action_processing_ms": 0.45020904646748966, "mean_env_wait_ms": 20.04358651991644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019520282745361328, "StateBufferConnector_ms": 0.023787260055541992, "ViewRequirementAgentConnector_ms": 0.6629245281219482}}, "episode_reward_max": 50.20076830022965, "episode_reward_min": -52.55122389771357, "episode_reward_mean": 11.925070184580555, "episode_len_mean": 807.9, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.469174971215594, 19.556919945160576, 31.80066077066398, 17.960589497709105, 2.797818210371392, -15.614224852148803, 15.840349503152872, 34.85383079978857, -5.473956066367615, 24.873476693011813, 3.830867555239535, 18.870638078145646, 24.288691943085563, -21.850847188636102, 1.9940333200082527, 22.135259563069116, 20.826106884526087, 28.862081986557786, 8.677259333673064, 22.65808516569484, 23.201190205717168, 37.08405424002145, 42.60971757592307, 13.797146021943416, -10.067817940743748, 36.95298262690893, 31.218724492433722, 18.225749495494842, 15.94630345716497, 42.361837546026806, 5.155506287286724, 22.624192181748334, 12.586185744476598, -5.390011837936588, 2.9373930060997435, 8.12454583119967, 37.92931130625909, 14.731091376903398, 11.92168306808532, 13.157611275914078, 0.5447268912974272, 0.33501494840200047, 4.183866194533889, 16.07527884102052, -16.053402138663948, -40.148410840336446, 1.9658686420092186, -18.678912940164007, -5.267377053925972, 22.71009291722304, 15.92943775365437, 23.331405447236953, -12.114606117982499, 25.558098387082094, -9.941276592112859, 6.567508780423758, 16.66945704118796, 14.808202101093565, 6.7238944584484726, 45.147086221135964, 20.397398981406987, 13.396657283024556, 13.989591664051286, 15.778847823262073, 5.273434035811243, -9.720561832601165, 27.669444643920702, 3.7562962241321847, 17.349101603874292, 8.455051334219405, 16.27945107001848, 20.82807152906622, 24.812079545525286, 50.20076830022965, -9.86764512995533, 27.67982695543311, 17.383960761767167, 10.318649611711553, 1.2210791737021716, 18.864390437090393, 20.54115669193879, 19.650160985806256, -0.6734359020400925, 15.882081409931939, 23.861749323162954, 22.90965687974842, 31.892409194904026, 32.65087090354341, -4.498599780983232, 48.603520272163955, 4.257724339315848, -1.876279609371561, -52.55122389771357, 10.905813907388234, -26.709803824189986, -26.923997526232004, 15.466874650522389, -6.286413954233203, 11.910529454774176, 15.618165907516715], "episode_lengths": [1117, 1117, 1117, 295, 695, 1117, 295, 1117, 925, 1117, 295, 295, 1117, 765, 1117, 1117, 295, 295, 945, 295, 1117, 1117, 1117, 1117, 681, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 795, 295, 1117, 295, 1117, 373, 1117, 1117, 1117, 1117, 797, 870, 882, 578, 950, 1117, 269, 1117, 761, 1117, 614, 1117, 295, 295, 797, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 381, 1117, 295, 295, 1117, 295, 1117, 730, 1117, 1117, 295, 1117, 1117, 1117, 1117, 415, 295, 1117, 295, 1117, 1117, 439, 1117, 887, 1117, 583, 295, 406, 373, 1117, 832, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9535401648716482, "mean_inference_ms": 6.623645470088302, "mean_action_processing_ms": 0.45020904646748966, "mean_env_wait_ms": 20.04358651991644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019520282745361328, "StateBufferConnector_ms": 0.023787260055541992, "ViewRequirementAgentConnector_ms": 0.6629245281219482}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424738, "num_agent_steps_trained": 424738, "num_env_steps_sampled": 424738, "num_env_steps_trained": 424738, "num_env_steps_sampled_this_iter": 9990, "num_env_steps_trained_this_iter": 9990, "num_env_steps_sampled_throughput_per_sec": 219.29657352212672, "num_env_steps_trained_throughput_per_sec": 219.29657352212672, "timesteps_total": 424738, "num_steps_trained_this_iter": 9990, "agent_timesteps_total": 424738, "timers": {"training_iteration_time_ms": 50287.318, "sample_time_ms": 32957.71, "load_time_ms": 1844.175, "load_throughput": 6001.436, "learn_time_ms": 14917.024, "learn_throughput": 741.951, "synch_weights_time_ms": 476.845}, "counters": {"num_env_steps_sampled": 424738, "num_env_steps_trained": 424738, "num_agent_steps_sampled": 424738, "num_agent_steps_trained": 424738}, "done": false, "episodes_total": 675, "training_iteration": 48, "trial_id": "32ccc_00000", "date": "2025-06-07_12-35-38", "timestamp": 1749292538, "time_this_iter_s": 45.57052206993103, "time_total_s": 2060.477368593216, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2060.477368593216, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 56.594444444444434, "ram_util_percent": 89.26296296296297, "gpu_util_percent0": 0.1698148148148148, "vram_util_percent0": 0.96533203125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.575262e-05, "total_loss": -0.12399655722174197, "policy_loss": -0.017797224345625952, "vf_loss": 0.06732304991007998, "vf_explained_var": 0.9465613085490007, "kl": 0.010554372464332449, "entropy": 16.21515077933287, "entropy_coeff": 0.007876309999999997}, "model": {}, "num_grad_updates_lifetime": 15115.5, "diff_num_grad_updates_vs_sampler_policy": 194.5}}, "num_env_steps_sampled": 435919, "num_env_steps_trained": 435919, "num_agent_steps_sampled": 435919, "num_agent_steps_trained": 435919}, "sampler_results": {"episode_reward_max": 50.20076830022965, "episode_reward_min": -52.55122389771357, "episode_reward_mean": 13.34601787966472, "episode_len_mean": 805.87, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.9940333200082527, 22.135259563069116, 20.826106884526087, 28.862081986557786, 8.677259333673064, 22.65808516569484, 23.201190205717168, 37.08405424002145, 42.60971757592307, 13.797146021943416, -10.067817940743748, 36.95298262690893, 31.218724492433722, 18.225749495494842, 15.94630345716497, 42.361837546026806, 5.155506287286724, 22.624192181748334, 12.586185744476598, -5.390011837936588, 2.9373930060997435, 8.12454583119967, 37.92931130625909, 14.731091376903398, 11.92168306808532, 13.157611275914078, 0.5447268912974272, 0.33501494840200047, 4.183866194533889, 16.07527884102052, -16.053402138663948, -40.148410840336446, 1.9658686420092186, -18.678912940164007, -5.267377053925972, 22.71009291722304, 15.92943775365437, 23.331405447236953, -12.114606117982499, 25.558098387082094, -9.941276592112859, 6.567508780423758, 16.66945704118796, 14.808202101093565, 6.7238944584484726, 45.147086221135964, 20.397398981406987, 13.396657283024556, 13.989591664051286, 15.778847823262073, 5.273434035811243, -9.720561832601165, 27.669444643920702, 3.7562962241321847, 17.349101603874292, 8.455051334219405, 16.27945107001848, 20.82807152906622, 24.812079545525286, 50.20076830022965, -9.86764512995533, 27.67982695543311, 17.383960761767167, 10.318649611711553, 1.2210791737021716, 18.864390437090393, 20.54115669193879, 19.650160985806256, -0.6734359020400925, 15.882081409931939, 23.861749323162954, 22.90965687974842, 31.892409194904026, 32.65087090354341, -4.498599780983232, 48.603520272163955, 4.257724339315848, -1.876279609371561, -52.55122389771357, 10.905813907388234, -26.709803824189986, -26.923997526232004, 15.466874650522389, -6.286413954233203, 11.910529454774176, 15.618165907516715, 35.238132013016816, 33.294937852855384, 16.54052043880852, 45.01725423580587, 19.1190424048624, 18.69870590335197, 31.55766414274004, 14.263160920463548, 20.14016619484651, 15.806644462681412, -6.01010435159023, 19.361746968862207, 22.796434997514833, 21.47445318458933], "episode_lengths": [1117, 1117, 295, 295, 945, 295, 1117, 1117, 1117, 1117, 681, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 795, 295, 1117, 295, 1117, 373, 1117, 1117, 1117, 1117, 797, 870, 882, 578, 950, 1117, 269, 1117, 761, 1117, 614, 1117, 295, 295, 797, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 381, 1117, 295, 295, 1117, 295, 1117, 730, 1117, 1117, 295, 1117, 1117, 1117, 1117, 415, 295, 1117, 295, 1117, 1117, 439, 1117, 887, 1117, 583, 295, 406, 373, 1117, 832, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 770, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9571602327658375, "mean_inference_ms": 6.628714085616267, "mean_action_processing_ms": 0.45051173025172103, "mean_env_wait_ms": 20.058551932585978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018530607223510742, "StateBufferConnector_ms": 0.024246692657470703, "ViewRequirementAgentConnector_ms": 0.6502721309661865}}, "episode_reward_max": 50.20076830022965, "episode_reward_min": -52.55122389771357, "episode_reward_mean": 13.34601787966472, "episode_len_mean": 805.87, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.9940333200082527, 22.135259563069116, 20.826106884526087, 28.862081986557786, 8.677259333673064, 22.65808516569484, 23.201190205717168, 37.08405424002145, 42.60971757592307, 13.797146021943416, -10.067817940743748, 36.95298262690893, 31.218724492433722, 18.225749495494842, 15.94630345716497, 42.361837546026806, 5.155506287286724, 22.624192181748334, 12.586185744476598, -5.390011837936588, 2.9373930060997435, 8.12454583119967, 37.92931130625909, 14.731091376903398, 11.92168306808532, 13.157611275914078, 0.5447268912974272, 0.33501494840200047, 4.183866194533889, 16.07527884102052, -16.053402138663948, -40.148410840336446, 1.9658686420092186, -18.678912940164007, -5.267377053925972, 22.71009291722304, 15.92943775365437, 23.331405447236953, -12.114606117982499, 25.558098387082094, -9.941276592112859, 6.567508780423758, 16.66945704118796, 14.808202101093565, 6.7238944584484726, 45.147086221135964, 20.397398981406987, 13.396657283024556, 13.989591664051286, 15.778847823262073, 5.273434035811243, -9.720561832601165, 27.669444643920702, 3.7562962241321847, 17.349101603874292, 8.455051334219405, 16.27945107001848, 20.82807152906622, 24.812079545525286, 50.20076830022965, -9.86764512995533, 27.67982695543311, 17.383960761767167, 10.318649611711553, 1.2210791737021716, 18.864390437090393, 20.54115669193879, 19.650160985806256, -0.6734359020400925, 15.882081409931939, 23.861749323162954, 22.90965687974842, 31.892409194904026, 32.65087090354341, -4.498599780983232, 48.603520272163955, 4.257724339315848, -1.876279609371561, -52.55122389771357, 10.905813907388234, -26.709803824189986, -26.923997526232004, 15.466874650522389, -6.286413954233203, 11.910529454774176, 15.618165907516715, 35.238132013016816, 33.294937852855384, 16.54052043880852, 45.01725423580587, 19.1190424048624, 18.69870590335197, 31.55766414274004, 14.263160920463548, 20.14016619484651, 15.806644462681412, -6.01010435159023, 19.361746968862207, 22.796434997514833, 21.47445318458933], "episode_lengths": [1117, 1117, 295, 295, 945, 295, 1117, 1117, 1117, 1117, 681, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 795, 295, 1117, 295, 1117, 373, 1117, 1117, 1117, 1117, 797, 870, 882, 578, 950, 1117, 269, 1117, 761, 1117, 614, 1117, 295, 295, 797, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 381, 1117, 295, 295, 1117, 295, 1117, 730, 1117, 1117, 295, 1117, 1117, 1117, 1117, 415, 295, 1117, 295, 1117, 1117, 439, 1117, 887, 1117, 583, 295, 406, 373, 1117, 832, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 770, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9571602327658375, "mean_inference_ms": 6.628714085616267, "mean_action_processing_ms": 0.45051173025172103, "mean_env_wait_ms": 20.058551932585978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018530607223510742, "StateBufferConnector_ms": 0.024246692657470703, "ViewRequirementAgentConnector_ms": 0.6502721309661865}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 435919, "num_agent_steps_trained": 435919, "num_env_steps_sampled": 435919, "num_env_steps_trained": 435919, "num_env_steps_sampled_this_iter": 11181, "num_env_steps_trained_this_iter": 11181, "num_env_steps_sampled_throughput_per_sec": 217.84404235485496, "num_env_steps_trained_throughput_per_sec": 217.84404235485496, "timesteps_total": 435919, "num_steps_trained_this_iter": 11181, "agent_timesteps_total": 435919, "timers": {"training_iteration_time_ms": 51162.425, "sample_time_ms": 33462.64, "load_time_ms": 1879.391, "load_throughput": 6025.302, "learn_time_ms": 15281.583, "learn_throughput": 741.016, "synch_weights_time_ms": 445.902}, "counters": {"num_env_steps_sampled": 435919, "num_env_steps_trained": 435919, "num_agent_steps_sampled": 435919, "num_agent_steps_trained": 435919}, "done": false, "episodes_total": 689, "training_iteration": 49, "trial_id": "32ccc_00000", "date": "2025-06-07_12-36-29", "timestamp": 1749292589, "time_this_iter_s": 51.34226727485657, "time_total_s": 2111.8196358680725, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2111.8196358680725, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 58.640983606557384, "ram_util_percent": 90.25409836065577, "gpu_util_percent0": 0.20278688524590166, "vram_util_percent0": 0.96533203125}}
{"evaluation": {"sampler_results": {"episode_reward_max": 3.1324116495004497, "episode_reward_min": 1.260626875541435, "episode_reward_mean": 2.234740853520487, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.1324116495004497, 2.065823440789885, 2.7658496108640094, 1.260626875541435, 1.9489926909066575], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4681718681615685, "mean_inference_ms": 3.485839487650787, "mean_action_processing_ms": 0.24708331447403165, "mean_env_wait_ms": 10.457353678974632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.05970954895019531}}, "episode_reward_max": 3.1324116495004497, "episode_reward_min": 1.260626875541435, "episode_reward_mean": 2.234740853520487, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.1324116495004497, 2.065823440789885, 2.7658496108640094, 1.260626875541435, 1.9489926909066575], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4681718681615685, "mean_inference_ms": 3.485839487650787, "mean_action_processing_ms": 0.24708331447403165, "mean_env_wait_ms": 10.457353678974632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.05970954895019531}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.564081e-05, "total_loss": -0.12039193496573716, "policy_loss": -0.01837552204960957, "vf_loss": 0.08015308539150283, "vf_explained_var": 0.9161351870000363, "kl": 0.009624733091804956, "entropy": 16.27350919485092, "entropy_coeff": 0.007820405}, "model": {}, "num_grad_updates_lifetime": 15510.5, "diff_num_grad_updates_vs_sampler_policy": 199.5}}, "num_env_steps_sampled": 447373, "num_env_steps_trained": 447373, "num_agent_steps_sampled": 447373, "num_agent_steps_trained": 447373}, "sampler_results": {"episode_reward_max": 52.935743072670164, "episode_reward_min": -78.61452783165774, "episode_reward_mean": 12.645876264936145, "episode_len_mean": 794.77, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.94630345716497, 42.361837546026806, 5.155506287286724, 22.624192181748334, 12.586185744476598, -5.390011837936588, 2.9373930060997435, 8.12454583119967, 37.92931130625909, 14.731091376903398, 11.92168306808532, 13.157611275914078, 0.5447268912974272, 0.33501494840200047, 4.183866194533889, 16.07527884102052, -16.053402138663948, -40.148410840336446, 1.9658686420092186, -18.678912940164007, -5.267377053925972, 22.71009291722304, 15.92943775365437, 23.331405447236953, -12.114606117982499, 25.558098387082094, -9.941276592112859, 6.567508780423758, 16.66945704118796, 14.808202101093565, 6.7238944584484726, 45.147086221135964, 20.397398981406987, 13.396657283024556, 13.989591664051286, 15.778847823262073, 5.273434035811243, -9.720561832601165, 27.669444643920702, 3.7562962241321847, 17.349101603874292, 8.455051334219405, 16.27945107001848, 20.82807152906622, 24.812079545525286, 50.20076830022965, -9.86764512995533, 27.67982695543311, 17.383960761767167, 10.318649611711553, 1.2210791737021716, 18.864390437090393, 20.54115669193879, 19.650160985806256, -0.6734359020400925, 15.882081409931939, 23.861749323162954, 22.90965687974842, 31.892409194904026, 32.65087090354341, -4.498599780983232, 48.603520272163955, 4.257724339315848, -1.876279609371561, -52.55122389771357, 10.905813907388234, -26.709803824189986, -26.923997526232004, 15.466874650522389, -6.286413954233203, 11.910529454774176, 15.618165907516715, 35.238132013016816, 33.294937852855384, 16.54052043880852, 45.01725423580587, 19.1190424048624, 18.69870590335197, 31.55766414274004, 14.263160920463548, 20.14016619484651, 15.806644462681412, -6.01010435159023, 19.361746968862207, 22.796434997514833, 21.47445318458933, -78.61452783165774, 49.796190714308025, 15.697610934710351, 1.2042503194603076, 16.384901227519276, 15.04111151635459, 19.587019137632097, 52.935743072670164, 16.470796095623236, 38.832945330436345, 12.292101653067778, 32.052291326402006, 13.784837505762498, 22.695140496081887], "episode_lengths": [295, 1117, 1117, 1117, 295, 1117, 795, 295, 1117, 295, 1117, 373, 1117, 1117, 1117, 1117, 797, 870, 882, 578, 950, 1117, 269, 1117, 761, 1117, 614, 1117, 295, 295, 797, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 381, 1117, 295, 295, 1117, 295, 1117, 730, 1117, 1117, 295, 1117, 1117, 1117, 1117, 415, 295, 1117, 295, 1117, 1117, 439, 1117, 887, 1117, 583, 295, 406, 373, 1117, 832, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 770, 1117, 1117, 295, 1043, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9605592193949224, "mean_inference_ms": 6.633239703204837, "mean_action_processing_ms": 0.4507649806715374, "mean_env_wait_ms": 20.072021777514284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01841425895690918, "StateBufferConnector_ms": 0.02524423599243164, "ViewRequirementAgentConnector_ms": 0.6578919887542725}}, "episode_reward_max": 52.935743072670164, "episode_reward_min": -78.61452783165774, "episode_reward_mean": 12.645876264936145, "episode_len_mean": 794.77, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.94630345716497, 42.361837546026806, 5.155506287286724, 22.624192181748334, 12.586185744476598, -5.390011837936588, 2.9373930060997435, 8.12454583119967, 37.92931130625909, 14.731091376903398, 11.92168306808532, 13.157611275914078, 0.5447268912974272, 0.33501494840200047, 4.183866194533889, 16.07527884102052, -16.053402138663948, -40.148410840336446, 1.9658686420092186, -18.678912940164007, -5.267377053925972, 22.71009291722304, 15.92943775365437, 23.331405447236953, -12.114606117982499, 25.558098387082094, -9.941276592112859, 6.567508780423758, 16.66945704118796, 14.808202101093565, 6.7238944584484726, 45.147086221135964, 20.397398981406987, 13.396657283024556, 13.989591664051286, 15.778847823262073, 5.273434035811243, -9.720561832601165, 27.669444643920702, 3.7562962241321847, 17.349101603874292, 8.455051334219405, 16.27945107001848, 20.82807152906622, 24.812079545525286, 50.20076830022965, -9.86764512995533, 27.67982695543311, 17.383960761767167, 10.318649611711553, 1.2210791737021716, 18.864390437090393, 20.54115669193879, 19.650160985806256, -0.6734359020400925, 15.882081409931939, 23.861749323162954, 22.90965687974842, 31.892409194904026, 32.65087090354341, -4.498599780983232, 48.603520272163955, 4.257724339315848, -1.876279609371561, -52.55122389771357, 10.905813907388234, -26.709803824189986, -26.923997526232004, 15.466874650522389, -6.286413954233203, 11.910529454774176, 15.618165907516715, 35.238132013016816, 33.294937852855384, 16.54052043880852, 45.01725423580587, 19.1190424048624, 18.69870590335197, 31.55766414274004, 14.263160920463548, 20.14016619484651, 15.806644462681412, -6.01010435159023, 19.361746968862207, 22.796434997514833, 21.47445318458933, -78.61452783165774, 49.796190714308025, 15.697610934710351, 1.2042503194603076, 16.384901227519276, 15.04111151635459, 19.587019137632097, 52.935743072670164, 16.470796095623236, 38.832945330436345, 12.292101653067778, 32.052291326402006, 13.784837505762498, 22.695140496081887], "episode_lengths": [295, 1117, 1117, 1117, 295, 1117, 795, 295, 1117, 295, 1117, 373, 1117, 1117, 1117, 1117, 797, 870, 882, 578, 950, 1117, 269, 1117, 761, 1117, 614, 1117, 295, 295, 797, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 381, 1117, 295, 295, 1117, 295, 1117, 730, 1117, 1117, 295, 1117, 1117, 1117, 1117, 415, 295, 1117, 295, 1117, 1117, 439, 1117, 887, 1117, 583, 295, 406, 373, 1117, 832, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 770, 1117, 1117, 295, 1043, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9605592193949224, "mean_inference_ms": 6.633239703204837, "mean_action_processing_ms": 0.4507649806715374, "mean_env_wait_ms": 20.072021777514284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01841425895690918, "StateBufferConnector_ms": 0.02524423599243164, "ViewRequirementAgentConnector_ms": 0.6578919887542725}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 447373, "num_agent_steps_trained": 447373, "num_env_steps_sampled": 447373, "num_env_steps_trained": 447373, "num_env_steps_sampled_this_iter": 11454, "num_env_steps_trained_this_iter": 11454, "num_env_steps_sampled_throughput_per_sec": 224.21922395520076, "num_env_steps_trained_throughput_per_sec": 224.21922395520076, "timesteps_total": 447373, "num_steps_trained_this_iter": 11454, "agent_timesteps_total": 447373, "timers": {"training_iteration_time_ms": 51565.31, "sample_time_ms": 33696.484, "load_time_ms": 1908.849, "load_throughput": 5984.079, "learn_time_ms": 15416.761, "learn_throughput": 740.927, "synch_weights_time_ms": 451.896}, "counters": {"num_env_steps_sampled": 447373, "num_env_steps_trained": 447373, "num_agent_steps_sampled": 447373, "num_agent_steps_trained": 447373}, "done": false, "episodes_total": 703, "training_iteration": 50, "trial_id": "32ccc_00000", "date": "2025-06-07_12-37-35", "timestamp": 1749292655, "time_this_iter_s": 65.68813920021057, "time_total_s": 2177.507775068283, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2177.507775068283, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 50.331645569620264, "ram_util_percent": 89.8987341772152, "gpu_util_percent0": 0.14721518987341772, "vram_util_percent0": 0.96533203125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.552627e-05, "total_loss": -0.11269896968799664, "policy_loss": -0.012106208734274497, "vf_loss": 0.08082588793688708, "vf_explained_var": 0.92342247759754, "kl": 0.011176757527508114, "entropy": 16.261166095733643, "entropy_coeff": 0.007763135000000002}, "model": {}, "num_grad_updates_lifetime": 15930.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 459723, "num_env_steps_trained": 459723, "num_agent_steps_sampled": 459723, "num_agent_steps_trained": 459723}, "sampler_results": {"episode_reward_max": 52.935743072670164, "episode_reward_min": -78.61452783165774, "episode_reward_mean": 13.759956568264204, "episode_len_mean": 805.43, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.183866194533889, 16.07527884102052, -16.053402138663948, -40.148410840336446, 1.9658686420092186, -18.678912940164007, -5.267377053925972, 22.71009291722304, 15.92943775365437, 23.331405447236953, -12.114606117982499, 25.558098387082094, -9.941276592112859, 6.567508780423758, 16.66945704118796, 14.808202101093565, 6.7238944584484726, 45.147086221135964, 20.397398981406987, 13.396657283024556, 13.989591664051286, 15.778847823262073, 5.273434035811243, -9.720561832601165, 27.669444643920702, 3.7562962241321847, 17.349101603874292, 8.455051334219405, 16.27945107001848, 20.82807152906622, 24.812079545525286, 50.20076830022965, -9.86764512995533, 27.67982695543311, 17.383960761767167, 10.318649611711553, 1.2210791737021716, 18.864390437090393, 20.54115669193879, 19.650160985806256, -0.6734359020400925, 15.882081409931939, 23.861749323162954, 22.90965687974842, 31.892409194904026, 32.65087090354341, -4.498599780983232, 48.603520272163955, 4.257724339315848, -1.876279609371561, -52.55122389771357, 10.905813907388234, -26.709803824189986, -26.923997526232004, 15.466874650522389, -6.286413954233203, 11.910529454774176, 15.618165907516715, 35.238132013016816, 33.294937852855384, 16.54052043880852, 45.01725423580587, 19.1190424048624, 18.69870590335197, 31.55766414274004, 14.263160920463548, 20.14016619484651, 15.806644462681412, -6.01010435159023, 19.361746968862207, 22.796434997514833, 21.47445318458933, -78.61452783165774, 49.796190714308025, 15.697610934710351, 1.2042503194603076, 16.384901227519276, 15.04111151635459, 19.587019137632097, 52.935743072670164, 16.470796095623236, 38.832945330436345, 12.292101653067778, 32.052291326402006, 13.784837505762498, 22.695140496081887, -6.7484781394607865, 10.085582755862069, 10.631577937961397, 44.145621130344736, 13.195953122729188, 9.821304198847942, 32.98912077971073, 15.341642604523102, 25.598654622152942, 14.804181883541778, 50.26507214250421, 33.646182718431334, 17.886554608926808, 22.71045104965753], "episode_lengths": [1117, 1117, 797, 870, 882, 578, 950, 1117, 269, 1117, 761, 1117, 614, 1117, 295, 295, 797, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 381, 1117, 295, 295, 1117, 295, 1117, 730, 1117, 1117, 295, 1117, 1117, 1117, 1117, 415, 295, 1117, 295, 1117, 1117, 439, 1117, 887, 1117, 583, 295, 406, 373, 1117, 832, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 770, 1117, 1117, 295, 1043, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9646445687153011, "mean_inference_ms": 6.637509332154133, "mean_action_processing_ms": 0.45101688949539104, "mean_env_wait_ms": 20.085428616344203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01880669593811035, "StateBufferConnector_ms": 0.02219867706298828, "ViewRequirementAgentConnector_ms": 0.710329532623291}}, "episode_reward_max": 52.935743072670164, "episode_reward_min": -78.61452783165774, "episode_reward_mean": 13.759956568264204, "episode_len_mean": 805.43, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.183866194533889, 16.07527884102052, -16.053402138663948, -40.148410840336446, 1.9658686420092186, -18.678912940164007, -5.267377053925972, 22.71009291722304, 15.92943775365437, 23.331405447236953, -12.114606117982499, 25.558098387082094, -9.941276592112859, 6.567508780423758, 16.66945704118796, 14.808202101093565, 6.7238944584484726, 45.147086221135964, 20.397398981406987, 13.396657283024556, 13.989591664051286, 15.778847823262073, 5.273434035811243, -9.720561832601165, 27.669444643920702, 3.7562962241321847, 17.349101603874292, 8.455051334219405, 16.27945107001848, 20.82807152906622, 24.812079545525286, 50.20076830022965, -9.86764512995533, 27.67982695543311, 17.383960761767167, 10.318649611711553, 1.2210791737021716, 18.864390437090393, 20.54115669193879, 19.650160985806256, -0.6734359020400925, 15.882081409931939, 23.861749323162954, 22.90965687974842, 31.892409194904026, 32.65087090354341, -4.498599780983232, 48.603520272163955, 4.257724339315848, -1.876279609371561, -52.55122389771357, 10.905813907388234, -26.709803824189986, -26.923997526232004, 15.466874650522389, -6.286413954233203, 11.910529454774176, 15.618165907516715, 35.238132013016816, 33.294937852855384, 16.54052043880852, 45.01725423580587, 19.1190424048624, 18.69870590335197, 31.55766414274004, 14.263160920463548, 20.14016619484651, 15.806644462681412, -6.01010435159023, 19.361746968862207, 22.796434997514833, 21.47445318458933, -78.61452783165774, 49.796190714308025, 15.697610934710351, 1.2042503194603076, 16.384901227519276, 15.04111151635459, 19.587019137632097, 52.935743072670164, 16.470796095623236, 38.832945330436345, 12.292101653067778, 32.052291326402006, 13.784837505762498, 22.695140496081887, -6.7484781394607865, 10.085582755862069, 10.631577937961397, 44.145621130344736, 13.195953122729188, 9.821304198847942, 32.98912077971073, 15.341642604523102, 25.598654622152942, 14.804181883541778, 50.26507214250421, 33.646182718431334, 17.886554608926808, 22.71045104965753], "episode_lengths": [1117, 1117, 797, 870, 882, 578, 950, 1117, 269, 1117, 761, 1117, 614, 1117, 295, 295, 797, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 381, 1117, 295, 295, 1117, 295, 1117, 730, 1117, 1117, 295, 1117, 1117, 1117, 1117, 415, 295, 1117, 295, 1117, 1117, 439, 1117, 887, 1117, 583, 295, 406, 373, 1117, 832, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 770, 1117, 1117, 295, 1043, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9646445687153011, "mean_inference_ms": 6.637509332154133, "mean_action_processing_ms": 0.45101688949539104, "mean_env_wait_ms": 20.085428616344203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01880669593811035, "StateBufferConnector_ms": 0.02219867706298828, "ViewRequirementAgentConnector_ms": 0.710329532623291}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 459723, "num_agent_steps_trained": 459723, "num_env_steps_sampled": 459723, "num_env_steps_trained": 459723, "num_env_steps_sampled_this_iter": 12350, "num_env_steps_trained_this_iter": 12350, "num_env_steps_sampled_throughput_per_sec": 231.10288399183767, "num_env_steps_trained_throughput_per_sec": 231.10288399183767, "timesteps_total": 459723, "num_steps_trained_this_iter": 12350, "agent_timesteps_total": 459723, "timers": {"training_iteration_time_ms": 51093.657, "sample_time_ms": 33584.063, "load_time_ms": 1686.634, "load_throughput": 6731.809, "learn_time_ms": 15283.706, "learn_throughput": 742.889, "synch_weights_time_ms": 453.252}, "counters": {"num_env_steps_sampled": 459723, "num_env_steps_trained": 459723, "num_agent_steps_sampled": 459723, "num_agent_steps_trained": 459723}, "done": false, "episodes_total": 717, "training_iteration": 51, "trial_id": "32ccc_00000", "date": "2025-06-07_12-38-28", "timestamp": 1749292708, "time_this_iter_s": 53.46316838264465, "time_total_s": 2230.9709434509277, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2230.9709434509277, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 63.61111111111112, "ram_util_percent": 90.55555555555554, "gpu_util_percent0": 0.16904761904761906, "vram_util_percent0": 0.96533203125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.540277e-05, "total_loss": -0.12062498938460696, "policy_loss": -0.017718543987064822, "vf_loss": 0.06862664541942959, "vf_explained_var": 0.9229130058846575, "kl": 0.011150567155167896, "entropy": 16.21633823475939, "entropy_coeff": 0.007701385000000001}, "model": {}, "num_grad_updates_lifetime": 16385.5, "diff_num_grad_updates_vs_sampler_policy": 234.5}}, "num_env_steps_sampled": 472895, "num_env_steps_trained": 472895, "num_agent_steps_sampled": 472895, "num_agent_steps_trained": 472895}, "sampler_results": {"episode_reward_max": 59.12539012669324, "episode_reward_min": -78.61452783165774, "episode_reward_mean": 17.434694711680496, "episode_len_mean": 812.92, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.66945704118796, 14.808202101093565, 6.7238944584484726, 45.147086221135964, 20.397398981406987, 13.396657283024556, 13.989591664051286, 15.778847823262073, 5.273434035811243, -9.720561832601165, 27.669444643920702, 3.7562962241321847, 17.349101603874292, 8.455051334219405, 16.27945107001848, 20.82807152906622, 24.812079545525286, 50.20076830022965, -9.86764512995533, 27.67982695543311, 17.383960761767167, 10.318649611711553, 1.2210791737021716, 18.864390437090393, 20.54115669193879, 19.650160985806256, -0.6734359020400925, 15.882081409931939, 23.861749323162954, 22.90965687974842, 31.892409194904026, 32.65087090354341, -4.498599780983232, 48.603520272163955, 4.257724339315848, -1.876279609371561, -52.55122389771357, 10.905813907388234, -26.709803824189986, -26.923997526232004, 15.466874650522389, -6.286413954233203, 11.910529454774176, 15.618165907516715, 35.238132013016816, 33.294937852855384, 16.54052043880852, 45.01725423580587, 19.1190424048624, 18.69870590335197, 31.55766414274004, 14.263160920463548, 20.14016619484651, 15.806644462681412, -6.01010435159023, 19.361746968862207, 22.796434997514833, 21.47445318458933, -78.61452783165774, 49.796190714308025, 15.697610934710351, 1.2042503194603076, 16.384901227519276, 15.04111151635459, 19.587019137632097, 52.935743072670164, 16.470796095623236, 38.832945330436345, 12.292101653067778, 32.052291326402006, 13.784837505762498, 22.695140496081887, -6.7484781394607865, 10.085582755862069, 10.631577937961397, 44.145621130344736, 13.195953122729188, 9.821304198847942, 32.98912077971073, 15.341642604523102, 25.598654622152942, 14.804181883541778, 50.26507214250421, 33.646182718431334, 17.886554608926808, 22.71045104965753, 45.41041058383806, 22.807113130153354, 13.2897830748265, 42.047990254210944, 27.97154653155274, 9.714166766978297, 59.12539012669324, 46.235513238006426, 26.959489144269224, 52.72682141929988, 26.024234811860637, -0.18516366622140312, 11.067661466070293, -1.6035712599109193], "episode_lengths": [295, 295, 797, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 381, 1117, 295, 295, 1117, 295, 1117, 730, 1117, 1117, 295, 1117, 1117, 1117, 1117, 415, 295, 1117, 295, 1117, 1117, 439, 1117, 887, 1117, 583, 295, 406, 373, 1117, 832, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 770, 1117, 1117, 295, 1043, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9714281978171488, "mean_inference_ms": 6.642554218466353, "mean_action_processing_ms": 0.45140932223734714, "mean_env_wait_ms": 20.102418746241703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021845579147338867, "StateBufferConnector_ms": 0.02259659767150879, "ViewRequirementAgentConnector_ms": 0.744694709777832}}, "episode_reward_max": 59.12539012669324, "episode_reward_min": -78.61452783165774, "episode_reward_mean": 17.434694711680496, "episode_len_mean": 812.92, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.66945704118796, 14.808202101093565, 6.7238944584484726, 45.147086221135964, 20.397398981406987, 13.396657283024556, 13.989591664051286, 15.778847823262073, 5.273434035811243, -9.720561832601165, 27.669444643920702, 3.7562962241321847, 17.349101603874292, 8.455051334219405, 16.27945107001848, 20.82807152906622, 24.812079545525286, 50.20076830022965, -9.86764512995533, 27.67982695543311, 17.383960761767167, 10.318649611711553, 1.2210791737021716, 18.864390437090393, 20.54115669193879, 19.650160985806256, -0.6734359020400925, 15.882081409931939, 23.861749323162954, 22.90965687974842, 31.892409194904026, 32.65087090354341, -4.498599780983232, 48.603520272163955, 4.257724339315848, -1.876279609371561, -52.55122389771357, 10.905813907388234, -26.709803824189986, -26.923997526232004, 15.466874650522389, -6.286413954233203, 11.910529454774176, 15.618165907516715, 35.238132013016816, 33.294937852855384, 16.54052043880852, 45.01725423580587, 19.1190424048624, 18.69870590335197, 31.55766414274004, 14.263160920463548, 20.14016619484651, 15.806644462681412, -6.01010435159023, 19.361746968862207, 22.796434997514833, 21.47445318458933, -78.61452783165774, 49.796190714308025, 15.697610934710351, 1.2042503194603076, 16.384901227519276, 15.04111151635459, 19.587019137632097, 52.935743072670164, 16.470796095623236, 38.832945330436345, 12.292101653067778, 32.052291326402006, 13.784837505762498, 22.695140496081887, -6.7484781394607865, 10.085582755862069, 10.631577937961397, 44.145621130344736, 13.195953122729188, 9.821304198847942, 32.98912077971073, 15.341642604523102, 25.598654622152942, 14.804181883541778, 50.26507214250421, 33.646182718431334, 17.886554608926808, 22.71045104965753, 45.41041058383806, 22.807113130153354, 13.2897830748265, 42.047990254210944, 27.97154653155274, 9.714166766978297, 59.12539012669324, 46.235513238006426, 26.959489144269224, 52.72682141929988, 26.024234811860637, -0.18516366622140312, 11.067661466070293, -1.6035712599109193], "episode_lengths": [295, 295, 797, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 381, 1117, 295, 295, 1117, 295, 1117, 730, 1117, 1117, 295, 1117, 1117, 1117, 1117, 415, 295, 1117, 295, 1117, 1117, 439, 1117, 887, 1117, 583, 295, 406, 373, 1117, 832, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 770, 1117, 1117, 295, 1043, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9714281978171488, "mean_inference_ms": 6.642554218466353, "mean_action_processing_ms": 0.45140932223734714, "mean_env_wait_ms": 20.102418746241703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021845579147338867, "StateBufferConnector_ms": 0.02259659767150879, "ViewRequirementAgentConnector_ms": 0.744694709777832}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472895, "num_agent_steps_trained": 472895, "num_env_steps_sampled": 472895, "num_env_steps_trained": 472895, "num_env_steps_sampled_this_iter": 13172, "num_env_steps_trained_this_iter": 13172, "num_env_steps_sampled_throughput_per_sec": 221.21362368036745, "num_env_steps_trained_throughput_per_sec": 221.21362368036745, "timesteps_total": 472895, "num_steps_trained_this_iter": 13172, "agent_timesteps_total": 472895, "timers": {"training_iteration_time_ms": 51846.632, "sample_time_ms": 33922.649, "load_time_ms": 1936.293, "load_throughput": 5956.176, "learn_time_ms": 15442.957, "learn_throughput": 746.806, "synch_weights_time_ms": 456.233}, "counters": {"num_env_steps_sampled": 472895, "num_env_steps_trained": 472895, "num_agent_steps_sampled": 472895, "num_agent_steps_trained": 472895}, "done": false, "episodes_total": 731, "training_iteration": 52, "trial_id": "32ccc_00000", "date": "2025-06-07_12-39-28", "timestamp": 1749292768, "time_this_iter_s": 59.55725455284119, "time_total_s": 2290.528198003769, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2290.528198003769, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 63.05714285714284, "ram_util_percent": 91.87428571428568, "gpu_util_percent0": 0.18528571428571433, "vram_util_percent0": 0.9652157738095241}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.527104999999999e-05, "total_loss": -0.14226551528060527, "policy_loss": -0.040819792991779846, "vf_loss": 0.07580774996542569, "vf_explained_var": 0.9303301845536087, "kl": 0.01058953242238865, "entropy": 16.437866858280067, "entropy_coeff": 0.007635525000000003}, "model": {}, "num_grad_updates_lifetime": 16785.5, "diff_num_grad_updates_vs_sampler_policy": 164.5}}, "num_env_steps_sampled": 482281, "num_env_steps_trained": 482281, "num_agent_steps_sampled": 482281, "num_agent_steps_trained": 482281}, "sampler_results": {"episode_reward_max": 59.12539012669324, "episode_reward_min": -78.61452783165774, "episode_reward_mean": 17.4926760835162, "episode_len_mean": 802.06, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.27945107001848, 20.82807152906622, 24.812079545525286, 50.20076830022965, -9.86764512995533, 27.67982695543311, 17.383960761767167, 10.318649611711553, 1.2210791737021716, 18.864390437090393, 20.54115669193879, 19.650160985806256, -0.6734359020400925, 15.882081409931939, 23.861749323162954, 22.90965687974842, 31.892409194904026, 32.65087090354341, -4.498599780983232, 48.603520272163955, 4.257724339315848, -1.876279609371561, -52.55122389771357, 10.905813907388234, -26.709803824189986, -26.923997526232004, 15.466874650522389, -6.286413954233203, 11.910529454774176, 15.618165907516715, 35.238132013016816, 33.294937852855384, 16.54052043880852, 45.01725423580587, 19.1190424048624, 18.69870590335197, 31.55766414274004, 14.263160920463548, 20.14016619484651, 15.806644462681412, -6.01010435159023, 19.361746968862207, 22.796434997514833, 21.47445318458933, -78.61452783165774, 49.796190714308025, 15.697610934710351, 1.2042503194603076, 16.384901227519276, 15.04111151635459, 19.587019137632097, 52.935743072670164, 16.470796095623236, 38.832945330436345, 12.292101653067778, 32.052291326402006, 13.784837505762498, 22.695140496081887, -6.7484781394607865, 10.085582755862069, 10.631577937961397, 44.145621130344736, 13.195953122729188, 9.821304198847942, 32.98912077971073, 15.341642604523102, 25.598654622152942, 14.804181883541778, 50.26507214250421, 33.646182718431334, 17.886554608926808, 22.71045104965753, 45.41041058383806, 22.807113130153354, 13.2897830748265, 42.047990254210944, 27.97154653155274, 9.714166766978297, 59.12539012669324, 46.235513238006426, 26.959489144269224, 52.72682141929988, 26.024234811860637, -0.18516366622140312, 11.067661466070293, -1.6035712599109193, 13.568744371501513, 19.952703819305793, 1.568662892456489, 24.123847597687448, 19.935121391262776, -6.898797409455755, 15.484540199468784, -5.458400717898762, 33.520917580051375, 14.316429939938997, 29.124816019893924, 37.13982183557588, 8.39563541388856, 0.7179958328612899], "episode_lengths": [295, 1117, 295, 1117, 730, 1117, 1117, 295, 1117, 1117, 1117, 1117, 415, 295, 1117, 295, 1117, 1117, 439, 1117, 887, 1117, 583, 295, 406, 373, 1117, 832, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 770, 1117, 1117, 295, 1043, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1078, 295, 386, 295, 295, 654, 1117, 406, 1117, 269, 1117, 1117, 295, 945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9773785400468697, "mean_inference_ms": 6.647940926271259, "mean_action_processing_ms": 0.4517345953851675, "mean_env_wait_ms": 20.11938802485537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022843360900878906, "StateBufferConnector_ms": 0.022112607955932617, "ViewRequirementAgentConnector_ms": 0.7595655918121338}}, "episode_reward_max": 59.12539012669324, "episode_reward_min": -78.61452783165774, "episode_reward_mean": 17.4926760835162, "episode_len_mean": 802.06, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.27945107001848, 20.82807152906622, 24.812079545525286, 50.20076830022965, -9.86764512995533, 27.67982695543311, 17.383960761767167, 10.318649611711553, 1.2210791737021716, 18.864390437090393, 20.54115669193879, 19.650160985806256, -0.6734359020400925, 15.882081409931939, 23.861749323162954, 22.90965687974842, 31.892409194904026, 32.65087090354341, -4.498599780983232, 48.603520272163955, 4.257724339315848, -1.876279609371561, -52.55122389771357, 10.905813907388234, -26.709803824189986, -26.923997526232004, 15.466874650522389, -6.286413954233203, 11.910529454774176, 15.618165907516715, 35.238132013016816, 33.294937852855384, 16.54052043880852, 45.01725423580587, 19.1190424048624, 18.69870590335197, 31.55766414274004, 14.263160920463548, 20.14016619484651, 15.806644462681412, -6.01010435159023, 19.361746968862207, 22.796434997514833, 21.47445318458933, -78.61452783165774, 49.796190714308025, 15.697610934710351, 1.2042503194603076, 16.384901227519276, 15.04111151635459, 19.587019137632097, 52.935743072670164, 16.470796095623236, 38.832945330436345, 12.292101653067778, 32.052291326402006, 13.784837505762498, 22.695140496081887, -6.7484781394607865, 10.085582755862069, 10.631577937961397, 44.145621130344736, 13.195953122729188, 9.821304198847942, 32.98912077971073, 15.341642604523102, 25.598654622152942, 14.804181883541778, 50.26507214250421, 33.646182718431334, 17.886554608926808, 22.71045104965753, 45.41041058383806, 22.807113130153354, 13.2897830748265, 42.047990254210944, 27.97154653155274, 9.714166766978297, 59.12539012669324, 46.235513238006426, 26.959489144269224, 52.72682141929988, 26.024234811860637, -0.18516366622140312, 11.067661466070293, -1.6035712599109193, 13.568744371501513, 19.952703819305793, 1.568662892456489, 24.123847597687448, 19.935121391262776, -6.898797409455755, 15.484540199468784, -5.458400717898762, 33.520917580051375, 14.316429939938997, 29.124816019893924, 37.13982183557588, 8.39563541388856, 0.7179958328612899], "episode_lengths": [295, 1117, 295, 1117, 730, 1117, 1117, 295, 1117, 1117, 1117, 1117, 415, 295, 1117, 295, 1117, 1117, 439, 1117, 887, 1117, 583, 295, 406, 373, 1117, 832, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 770, 1117, 1117, 295, 1043, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1078, 295, 386, 295, 295, 654, 1117, 406, 1117, 269, 1117, 1117, 295, 945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9773785400468697, "mean_inference_ms": 6.647940926271259, "mean_action_processing_ms": 0.4517345953851675, "mean_env_wait_ms": 20.11938802485537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022843360900878906, "StateBufferConnector_ms": 0.022112607955932617, "ViewRequirementAgentConnector_ms": 0.7595655918121338}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 482281, "num_agent_steps_trained": 482281, "num_env_steps_sampled": 482281, "num_env_steps_trained": 482281, "num_env_steps_sampled_this_iter": 9386, "num_env_steps_trained_this_iter": 9386, "num_env_steps_sampled_throughput_per_sec": 195.05908563342743, "num_env_steps_trained_throughput_per_sec": 195.05908563342743, "timesteps_total": 482281, "num_steps_trained_this_iter": 9386, "agent_timesteps_total": 482281, "timers": {"training_iteration_time_ms": 51524.949, "sample_time_ms": 33768.135, "load_time_ms": 1920.82, "load_throughput": 5881.498, "learn_time_ms": 15284.841, "learn_throughput": 739.118, "synch_weights_time_ms": 463.87}, "counters": {"num_env_steps_sampled": 482281, "num_env_steps_trained": 482281, "num_agent_steps_sampled": 482281, "num_agent_steps_trained": 482281}, "done": false, "episodes_total": 745, "training_iteration": 53, "trial_id": "32ccc_00000", "date": "2025-06-07_12-40-16", "timestamp": 1749292816, "time_this_iter_s": 48.132747173309326, "time_total_s": 2338.6609451770782, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2338.6609451770782, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 60.60535714285714, "ram_util_percent": 91.38571428571427, "gpu_util_percent0": 0.17339285714285715, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.517719e-05, "total_loss": -0.121108742016035, "policy_loss": -0.02280234978983312, "vf_loss": 0.08246029336005449, "vf_explained_var": 0.8880887281894684, "kl": 0.011547608610583536, "entropy": 16.404608734675815, "entropy_coeff": 0.007588595000000002}, "model": {}, "num_grad_updates_lifetime": 17125.5, "diff_num_grad_updates_vs_sampler_policy": 174.5}}, "num_env_steps_sampled": 492306, "num_env_steps_trained": 492306, "num_agent_steps_sampled": 492306, "num_agent_steps_trained": 492306}, "sampler_results": {"episode_reward_max": 125.29819801062803, "episode_reward_min": -78.61452783165774, "episode_reward_mean": 19.29590395256325, "episode_len_mean": 789.7, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.861749323162954, 22.90965687974842, 31.892409194904026, 32.65087090354341, -4.498599780983232, 48.603520272163955, 4.257724339315848, -1.876279609371561, -52.55122389771357, 10.905813907388234, -26.709803824189986, -26.923997526232004, 15.466874650522389, -6.286413954233203, 11.910529454774176, 15.618165907516715, 35.238132013016816, 33.294937852855384, 16.54052043880852, 45.01725423580587, 19.1190424048624, 18.69870590335197, 31.55766414274004, 14.263160920463548, 20.14016619484651, 15.806644462681412, -6.01010435159023, 19.361746968862207, 22.796434997514833, 21.47445318458933, -78.61452783165774, 49.796190714308025, 15.697610934710351, 1.2042503194603076, 16.384901227519276, 15.04111151635459, 19.587019137632097, 52.935743072670164, 16.470796095623236, 38.832945330436345, 12.292101653067778, 32.052291326402006, 13.784837505762498, 22.695140496081887, -6.7484781394607865, 10.085582755862069, 10.631577937961397, 44.145621130344736, 13.195953122729188, 9.821304198847942, 32.98912077971073, 15.341642604523102, 25.598654622152942, 14.804181883541778, 50.26507214250421, 33.646182718431334, 17.886554608926808, 22.71045104965753, 45.41041058383806, 22.807113130153354, 13.2897830748265, 42.047990254210944, 27.97154653155274, 9.714166766978297, 59.12539012669324, 46.235513238006426, 26.959489144269224, 52.72682141929988, 26.024234811860637, -0.18516366622140312, 11.067661466070293, -1.6035712599109193, 13.568744371501513, 19.952703819305793, 1.568662892456489, 24.123847597687448, 19.935121391262776, -6.898797409455755, 15.484540199468784, -5.458400717898762, 33.520917580051375, 14.316429939938997, 29.124816019893924, 37.13982183557588, 8.39563541388856, 0.7179958328612899, 50.68101396370604, 21.06526927540575, -33.78060141393743, 125.29819801062803, 22.669031480762154, 18.096168369861502, 38.65773782799963, 27.797770491040794, 15.55737775723361, 16.292264884053207, 14.547360213781987, 9.470020561048688, 20.811780132190986, 66.27999079115578], "episode_lengths": [1117, 295, 1117, 1117, 439, 1117, 887, 1117, 583, 295, 406, 373, 1117, 832, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 770, 1117, 1117, 295, 1043, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1078, 295, 386, 295, 295, 654, 1117, 406, 1117, 269, 1117, 1117, 295, 945, 1117, 295, 436, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.983739922621208, "mean_inference_ms": 6.6552877073845504, "mean_action_processing_ms": 0.4522388666843176, "mean_env_wait_ms": 20.14285423574264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02294611930847168, "StateBufferConnector_ms": 0.019060134887695312, "ViewRequirementAgentConnector_ms": 0.8083934783935547}}, "episode_reward_max": 125.29819801062803, "episode_reward_min": -78.61452783165774, "episode_reward_mean": 19.29590395256325, "episode_len_mean": 789.7, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.861749323162954, 22.90965687974842, 31.892409194904026, 32.65087090354341, -4.498599780983232, 48.603520272163955, 4.257724339315848, -1.876279609371561, -52.55122389771357, 10.905813907388234, -26.709803824189986, -26.923997526232004, 15.466874650522389, -6.286413954233203, 11.910529454774176, 15.618165907516715, 35.238132013016816, 33.294937852855384, 16.54052043880852, 45.01725423580587, 19.1190424048624, 18.69870590335197, 31.55766414274004, 14.263160920463548, 20.14016619484651, 15.806644462681412, -6.01010435159023, 19.361746968862207, 22.796434997514833, 21.47445318458933, -78.61452783165774, 49.796190714308025, 15.697610934710351, 1.2042503194603076, 16.384901227519276, 15.04111151635459, 19.587019137632097, 52.935743072670164, 16.470796095623236, 38.832945330436345, 12.292101653067778, 32.052291326402006, 13.784837505762498, 22.695140496081887, -6.7484781394607865, 10.085582755862069, 10.631577937961397, 44.145621130344736, 13.195953122729188, 9.821304198847942, 32.98912077971073, 15.341642604523102, 25.598654622152942, 14.804181883541778, 50.26507214250421, 33.646182718431334, 17.886554608926808, 22.71045104965753, 45.41041058383806, 22.807113130153354, 13.2897830748265, 42.047990254210944, 27.97154653155274, 9.714166766978297, 59.12539012669324, 46.235513238006426, 26.959489144269224, 52.72682141929988, 26.024234811860637, -0.18516366622140312, 11.067661466070293, -1.6035712599109193, 13.568744371501513, 19.952703819305793, 1.568662892456489, 24.123847597687448, 19.935121391262776, -6.898797409455755, 15.484540199468784, -5.458400717898762, 33.520917580051375, 14.316429939938997, 29.124816019893924, 37.13982183557588, 8.39563541388856, 0.7179958328612899, 50.68101396370604, 21.06526927540575, -33.78060141393743, 125.29819801062803, 22.669031480762154, 18.096168369861502, 38.65773782799963, 27.797770491040794, 15.55737775723361, 16.292264884053207, 14.547360213781987, 9.470020561048688, 20.811780132190986, 66.27999079115578], "episode_lengths": [1117, 295, 1117, 1117, 439, 1117, 887, 1117, 583, 295, 406, 373, 1117, 832, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 770, 1117, 1117, 295, 1043, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1078, 295, 386, 295, 295, 654, 1117, 406, 1117, 269, 1117, 1117, 295, 945, 1117, 295, 436, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.983739922621208, "mean_inference_ms": 6.6552877073845504, "mean_action_processing_ms": 0.4522388666843176, "mean_env_wait_ms": 20.14285423574264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02294611930847168, "StateBufferConnector_ms": 0.019060134887695312, "ViewRequirementAgentConnector_ms": 0.8083934783935547}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492306, "num_agent_steps_trained": 492306, "num_env_steps_sampled": 492306, "num_env_steps_trained": 492306, "num_env_steps_sampled_this_iter": 10025, "num_env_steps_trained_this_iter": 10025, "num_env_steps_sampled_throughput_per_sec": 187.53538864912892, "num_env_steps_trained_throughput_per_sec": 187.53538864912892, "timesteps_total": 492306, "num_steps_trained_this_iter": 10025, "agent_timesteps_total": 492306, "timers": {"training_iteration_time_ms": 51366.493, "sample_time_ms": 34011.9, "load_time_ms": 1788.5, "load_throughput": 6200.279, "learn_time_ms": 15016.5, "learn_throughput": 738.468, "synch_weights_time_ms": 464.335}, "counters": {"num_env_steps_sampled": 492306, "num_env_steps_trained": 492306, "num_agent_steps_sampled": 492306, "num_agent_steps_trained": 492306}, "done": false, "episodes_total": 759, "training_iteration": 54, "trial_id": "32ccc_00000", "date": "2025-06-07_12-41-10", "timestamp": 1749292870, "time_this_iter_s": 53.471577405929565, "time_total_s": 2392.132522583008, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2392.132522583008, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 64.77619047619048, "ram_util_percent": 92.61428571428571, "gpu_util_percent0": 0.1642857142857143, "vram_util_percent0": 0.9650065104166664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.507694000000001e-05, "total_loss": -0.11801375369700096, "policy_loss": -0.018036367518255825, "vf_loss": 0.0753246796740727, "vf_explained_var": 0.9304878768595782, "kl": 0.01046847749510825, "entropy": 16.433487577871844, "entropy_coeff": 0.007538470000000001}, "model": {}, "num_grad_updates_lifetime": 17520.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 504824, "num_env_steps_trained": 504824, "num_agent_steps_sampled": 504824, "num_agent_steps_trained": 504824}, "sampler_results": {"episode_reward_max": 125.29819801062803, "episode_reward_min": -78.61452783165774, "episode_reward_mean": 20.965687666123458, "episode_len_mean": 803.81, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.618165907516715, 35.238132013016816, 33.294937852855384, 16.54052043880852, 45.01725423580587, 19.1190424048624, 18.69870590335197, 31.55766414274004, 14.263160920463548, 20.14016619484651, 15.806644462681412, -6.01010435159023, 19.361746968862207, 22.796434997514833, 21.47445318458933, -78.61452783165774, 49.796190714308025, 15.697610934710351, 1.2042503194603076, 16.384901227519276, 15.04111151635459, 19.587019137632097, 52.935743072670164, 16.470796095623236, 38.832945330436345, 12.292101653067778, 32.052291326402006, 13.784837505762498, 22.695140496081887, -6.7484781394607865, 10.085582755862069, 10.631577937961397, 44.145621130344736, 13.195953122729188, 9.821304198847942, 32.98912077971073, 15.341642604523102, 25.598654622152942, 14.804181883541778, 50.26507214250421, 33.646182718431334, 17.886554608926808, 22.71045104965753, 45.41041058383806, 22.807113130153354, 13.2897830748265, 42.047990254210944, 27.97154653155274, 9.714166766978297, 59.12539012669324, 46.235513238006426, 26.959489144269224, 52.72682141929988, 26.024234811860637, -0.18516366622140312, 11.067661466070293, -1.6035712599109193, 13.568744371501513, 19.952703819305793, 1.568662892456489, 24.123847597687448, 19.935121391262776, -6.898797409455755, 15.484540199468784, -5.458400717898762, 33.520917580051375, 14.316429939938997, 29.124816019893924, 37.13982183557588, 8.39563541388856, 0.7179958328612899, 50.68101396370604, 21.06526927540575, -33.78060141393743, 125.29819801062803, 22.669031480762154, 18.096168369861502, 38.65773782799963, 27.797770491040794, 15.55737775723361, 16.292264884053207, 14.547360213781987, 9.470020561048688, 20.811780132190986, 66.27999079115578, 8.704830726122628, 24.16919999904201, 30.502274703882463, 39.35623426199391, 13.919672915475502, 14.085689958103162, 4.975039995312402, 26.148536487876278, 34.66959055308236, 22.78404787908823, -4.752508641607424, -7.182415751137473, 14.360359975407755, 14.848257538413328, 14.002391087765446], "episode_lengths": [295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 770, 1117, 1117, 295, 1043, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1078, 295, 386, 295, 295, 654, 1117, 406, 1117, 269, 1117, 1117, 295, 945, 1117, 295, 436, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 91, 1117, 1117, 1117, 1083, 295, 295, 295, 1117, 1117, 1117, 406, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9904346875351835, "mean_inference_ms": 6.662755507136839, "mean_action_processing_ms": 0.45300285678478036, "mean_env_wait_ms": 20.178938858395565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024953365325927734, "StateBufferConnector_ms": 0.015049219131469727, "ViewRequirementAgentConnector_ms": 0.7950763702392578}}, "episode_reward_max": 125.29819801062803, "episode_reward_min": -78.61452783165774, "episode_reward_mean": 20.965687666123458, "episode_len_mean": 803.81, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.618165907516715, 35.238132013016816, 33.294937852855384, 16.54052043880852, 45.01725423580587, 19.1190424048624, 18.69870590335197, 31.55766414274004, 14.263160920463548, 20.14016619484651, 15.806644462681412, -6.01010435159023, 19.361746968862207, 22.796434997514833, 21.47445318458933, -78.61452783165774, 49.796190714308025, 15.697610934710351, 1.2042503194603076, 16.384901227519276, 15.04111151635459, 19.587019137632097, 52.935743072670164, 16.470796095623236, 38.832945330436345, 12.292101653067778, 32.052291326402006, 13.784837505762498, 22.695140496081887, -6.7484781394607865, 10.085582755862069, 10.631577937961397, 44.145621130344736, 13.195953122729188, 9.821304198847942, 32.98912077971073, 15.341642604523102, 25.598654622152942, 14.804181883541778, 50.26507214250421, 33.646182718431334, 17.886554608926808, 22.71045104965753, 45.41041058383806, 22.807113130153354, 13.2897830748265, 42.047990254210944, 27.97154653155274, 9.714166766978297, 59.12539012669324, 46.235513238006426, 26.959489144269224, 52.72682141929988, 26.024234811860637, -0.18516366622140312, 11.067661466070293, -1.6035712599109193, 13.568744371501513, 19.952703819305793, 1.568662892456489, 24.123847597687448, 19.935121391262776, -6.898797409455755, 15.484540199468784, -5.458400717898762, 33.520917580051375, 14.316429939938997, 29.124816019893924, 37.13982183557588, 8.39563541388856, 0.7179958328612899, 50.68101396370604, 21.06526927540575, -33.78060141393743, 125.29819801062803, 22.669031480762154, 18.096168369861502, 38.65773782799963, 27.797770491040794, 15.55737775723361, 16.292264884053207, 14.547360213781987, 9.470020561048688, 20.811780132190986, 66.27999079115578, 8.704830726122628, 24.16919999904201, 30.502274703882463, 39.35623426199391, 13.919672915475502, 14.085689958103162, 4.975039995312402, 26.148536487876278, 34.66959055308236, 22.78404787908823, -4.752508641607424, -7.182415751137473, 14.360359975407755, 14.848257538413328, 14.002391087765446], "episode_lengths": [295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 770, 1117, 1117, 295, 1043, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1078, 295, 386, 295, 295, 654, 1117, 406, 1117, 269, 1117, 1117, 295, 945, 1117, 295, 436, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 91, 1117, 1117, 1117, 1083, 295, 295, 295, 1117, 1117, 1117, 406, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9904346875351835, "mean_inference_ms": 6.662755507136839, "mean_action_processing_ms": 0.45300285678478036, "mean_env_wait_ms": 20.178938858395565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024953365325927734, "StateBufferConnector_ms": 0.015049219131469727, "ViewRequirementAgentConnector_ms": 0.7950763702392578}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504824, "num_agent_steps_trained": 504824, "num_env_steps_sampled": 504824, "num_env_steps_trained": 504824, "num_env_steps_sampled_this_iter": 12518, "num_env_steps_trained_this_iter": 12518, "num_env_steps_sampled_throughput_per_sec": 223.22284727487045, "num_env_steps_trained_throughput_per_sec": 223.22284727487045, "timesteps_total": 504824, "num_steps_trained_this_iter": 12518, "agent_timesteps_total": 504824, "timers": {"training_iteration_time_ms": 52148.832, "sample_time_ms": 34591.553, "load_time_ms": 1901.041, "load_throughput": 5924.702, "learn_time_ms": 15104.624, "learn_throughput": 745.672, "synch_weights_time_ms": 465.094}, "counters": {"num_env_steps_sampled": 504824, "num_env_steps_trained": 504824, "num_agent_steps_sampled": 504824, "num_agent_steps_trained": 504824}, "done": false, "episodes_total": 774, "training_iteration": 55, "trial_id": "32ccc_00000", "date": "2025-06-07_12-42-06", "timestamp": 1749292926, "time_this_iter_s": 56.13207530975342, "time_total_s": 2448.2645978927612, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2448.2645978927612, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 63.07014925373135, "ram_util_percent": 92.00895522388056, "gpu_util_percent0": 0.147910447761194, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.495176e-05, "total_loss": -0.10348274854677064, "policy_loss": -0.0009249531105160713, "vf_loss": 0.06613935098318117, "vf_explained_var": 0.9305310586520604, "kl": 0.010302905698981683, "entropy": 16.544870818001883, "entropy_coeff": 0.007475880000000001}, "model": {}, "num_grad_updates_lifetime": 17915.5, "diff_num_grad_updates_vs_sampler_policy": 174.5}}, "num_env_steps_sampled": 514771, "num_env_steps_trained": 514771, "num_agent_steps_sampled": 514771, "num_agent_steps_trained": 514771}, "sampler_results": {"episode_reward_max": 125.29819801062803, "episode_reward_min": -78.61452783165774, "episode_reward_mean": 20.335750717613884, "episode_len_mean": 791.47, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.47445318458933, -78.61452783165774, 49.796190714308025, 15.697610934710351, 1.2042503194603076, 16.384901227519276, 15.04111151635459, 19.587019137632097, 52.935743072670164, 16.470796095623236, 38.832945330436345, 12.292101653067778, 32.052291326402006, 13.784837505762498, 22.695140496081887, -6.7484781394607865, 10.085582755862069, 10.631577937961397, 44.145621130344736, 13.195953122729188, 9.821304198847942, 32.98912077971073, 15.341642604523102, 25.598654622152942, 14.804181883541778, 50.26507214250421, 33.646182718431334, 17.886554608926808, 22.71045104965753, 45.41041058383806, 22.807113130153354, 13.2897830748265, 42.047990254210944, 27.97154653155274, 9.714166766978297, 59.12539012669324, 46.235513238006426, 26.959489144269224, 52.72682141929988, 26.024234811860637, -0.18516366622140312, 11.067661466070293, -1.6035712599109193, 13.568744371501513, 19.952703819305793, 1.568662892456489, 24.123847597687448, 19.935121391262776, -6.898797409455755, 15.484540199468784, -5.458400717898762, 33.520917580051375, 14.316429939938997, 29.124816019893924, 37.13982183557588, 8.39563541388856, 0.7179958328612899, 50.68101396370604, 21.06526927540575, -33.78060141393743, 125.29819801062803, 22.669031480762154, 18.096168369861502, 38.65773782799963, 27.797770491040794, 15.55737775723361, 16.292264884053207, 14.547360213781987, 9.470020561048688, 20.811780132190986, 66.27999079115578, 8.704830726122628, 24.16919999904201, 30.502274703882463, 39.35623426199391, 13.919672915475502, 14.085689958103162, 4.975039995312402, 26.148536487876278, 34.66959055308236, 22.78404787908823, -4.752508641607424, -7.182415751137473, 14.360359975407755, 14.848257538413328, 14.002391087765446, 20.66903490035716, 21.190842850768885, 35.343753990509505, 21.358825127999005, 15.123818430233804, 33.98092662070628, -4.484285298149101, 12.848894277129332, 0.944919762739489, 24.29198130969112, 5.397513677647568, 1.9441081427925113, 27.454693770647406, 22.38374967770559], "episode_lengths": [295, 1043, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1078, 295, 386, 295, 295, 654, 1117, 406, 1117, 269, 1117, 1117, 295, 945, 1117, 295, 436, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 91, 1117, 1117, 1117, 1083, 295, 295, 295, 1117, 1117, 1117, 406, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 358, 295, 1117, 1117, 1117, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.997233721540968, "mean_inference_ms": 6.671609314987282, "mean_action_processing_ms": 0.45370131955941045, "mean_env_wait_ms": 20.207309660853863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02391338348388672, "StateBufferConnector_ms": 0.01304483413696289, "ViewRequirementAgentConnector_ms": 0.8340351581573486}}, "episode_reward_max": 125.29819801062803, "episode_reward_min": -78.61452783165774, "episode_reward_mean": 20.335750717613884, "episode_len_mean": 791.47, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.47445318458933, -78.61452783165774, 49.796190714308025, 15.697610934710351, 1.2042503194603076, 16.384901227519276, 15.04111151635459, 19.587019137632097, 52.935743072670164, 16.470796095623236, 38.832945330436345, 12.292101653067778, 32.052291326402006, 13.784837505762498, 22.695140496081887, -6.7484781394607865, 10.085582755862069, 10.631577937961397, 44.145621130344736, 13.195953122729188, 9.821304198847942, 32.98912077971073, 15.341642604523102, 25.598654622152942, 14.804181883541778, 50.26507214250421, 33.646182718431334, 17.886554608926808, 22.71045104965753, 45.41041058383806, 22.807113130153354, 13.2897830748265, 42.047990254210944, 27.97154653155274, 9.714166766978297, 59.12539012669324, 46.235513238006426, 26.959489144269224, 52.72682141929988, 26.024234811860637, -0.18516366622140312, 11.067661466070293, -1.6035712599109193, 13.568744371501513, 19.952703819305793, 1.568662892456489, 24.123847597687448, 19.935121391262776, -6.898797409455755, 15.484540199468784, -5.458400717898762, 33.520917580051375, 14.316429939938997, 29.124816019893924, 37.13982183557588, 8.39563541388856, 0.7179958328612899, 50.68101396370604, 21.06526927540575, -33.78060141393743, 125.29819801062803, 22.669031480762154, 18.096168369861502, 38.65773782799963, 27.797770491040794, 15.55737775723361, 16.292264884053207, 14.547360213781987, 9.470020561048688, 20.811780132190986, 66.27999079115578, 8.704830726122628, 24.16919999904201, 30.502274703882463, 39.35623426199391, 13.919672915475502, 14.085689958103162, 4.975039995312402, 26.148536487876278, 34.66959055308236, 22.78404787908823, -4.752508641607424, -7.182415751137473, 14.360359975407755, 14.848257538413328, 14.002391087765446, 20.66903490035716, 21.190842850768885, 35.343753990509505, 21.358825127999005, 15.123818430233804, 33.98092662070628, -4.484285298149101, 12.848894277129332, 0.944919762739489, 24.29198130969112, 5.397513677647568, 1.9441081427925113, 27.454693770647406, 22.38374967770559], "episode_lengths": [295, 1043, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1078, 295, 386, 295, 295, 654, 1117, 406, 1117, 269, 1117, 1117, 295, 945, 1117, 295, 436, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 91, 1117, 1117, 1117, 1083, 295, 295, 295, 1117, 1117, 1117, 406, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 358, 295, 1117, 1117, 1117, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.997233721540968, "mean_inference_ms": 6.671609314987282, "mean_action_processing_ms": 0.45370131955941045, "mean_env_wait_ms": 20.207309660853863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02391338348388672, "StateBufferConnector_ms": 0.01304483413696289, "ViewRequirementAgentConnector_ms": 0.8340351581573486}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 514771, "num_agent_steps_trained": 514771, "num_env_steps_sampled": 514771, "num_env_steps_trained": 514771, "num_env_steps_sampled_this_iter": 9947, "num_env_steps_trained_this_iter": 9947, "num_env_steps_sampled_throughput_per_sec": 201.61405362980537, "num_env_steps_trained_throughput_per_sec": 201.61405362980537, "timesteps_total": 514771, "num_steps_trained_this_iter": 9947, "agent_timesteps_total": 514771, "timers": {"training_iteration_time_ms": 51872.252, "sample_time_ms": 34583.288, "load_time_ms": 1887.346, "load_throughput": 5896.322, "learn_time_ms": 14854.89, "learn_throughput": 749.141, "synch_weights_time_ms": 461.41}, "counters": {"num_env_steps_sampled": 514771, "num_env_steps_trained": 514771, "num_agent_steps_sampled": 514771, "num_agent_steps_trained": 514771}, "done": false, "episodes_total": 788, "training_iteration": 56, "trial_id": "32ccc_00000", "date": "2025-06-07_12-42-56", "timestamp": 1749292976, "time_this_iter_s": 49.34872603416443, "time_total_s": 2497.6133239269257, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2497.6133239269257, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 56.891525423728815, "ram_util_percent": 89.92033898305084, "gpu_util_percent0": 0.18220338983050843, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.485229e-05, "total_loss": -0.10923484674131032, "policy_loss": -0.01210089398747576, "vf_loss": 0.08253703896022802, "vf_explained_var": 0.9451374954410962, "kl": 0.010860516436775965, "entropy": 16.597121395383564, "entropy_coeff": 0.007426145000000001}, "model": {}, "num_grad_updates_lifetime": 18230.5, "diff_num_grad_updates_vs_sampler_policy": 139.5}}, "num_env_steps_sampled": 522660, "num_env_steps_trained": 522660, "num_agent_steps_sampled": 522660, "num_agent_steps_trained": 522660}, "sampler_results": {"episode_reward_max": 125.29819801062803, "episode_reward_min": -33.78060141393743, "episode_reward_mean": 19.828374539932945, "episode_len_mean": 764.04, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.695140496081887, -6.7484781394607865, 10.085582755862069, 10.631577937961397, 44.145621130344736, 13.195953122729188, 9.821304198847942, 32.98912077971073, 15.341642604523102, 25.598654622152942, 14.804181883541778, 50.26507214250421, 33.646182718431334, 17.886554608926808, 22.71045104965753, 45.41041058383806, 22.807113130153354, 13.2897830748265, 42.047990254210944, 27.97154653155274, 9.714166766978297, 59.12539012669324, 46.235513238006426, 26.959489144269224, 52.72682141929988, 26.024234811860637, -0.18516366622140312, 11.067661466070293, -1.6035712599109193, 13.568744371501513, 19.952703819305793, 1.568662892456489, 24.123847597687448, 19.935121391262776, -6.898797409455755, 15.484540199468784, -5.458400717898762, 33.520917580051375, 14.316429939938997, 29.124816019893924, 37.13982183557588, 8.39563541388856, 0.7179958328612899, 50.68101396370604, 21.06526927540575, -33.78060141393743, 125.29819801062803, 22.669031480762154, 18.096168369861502, 38.65773782799963, 27.797770491040794, 15.55737775723361, 16.292264884053207, 14.547360213781987, 9.470020561048688, 20.811780132190986, 66.27999079115578, 8.704830726122628, 24.16919999904201, 30.502274703882463, 39.35623426199391, 13.919672915475502, 14.085689958103162, 4.975039995312402, 26.148536487876278, 34.66959055308236, 22.78404787908823, -4.752508641607424, -7.182415751137473, 14.360359975407755, 14.848257538413328, 14.002391087765446, 20.66903490035716, 21.190842850768885, 35.343753990509505, 21.358825127999005, 15.123818430233804, 33.98092662070628, -4.484285298149101, 12.848894277129332, 0.944919762739489, 24.29198130969112, 5.397513677647568, 1.9441081427925113, 27.454693770647406, 22.38374967770559, 22.011602730992042, 36.60727824056101, 18.532392696935826, 0.2614853425574468, -21.085328346360097, 14.979322822377771, 19.178139394673305, 7.075841593767252, 13.338649153858068, 24.181561229942684, 14.035483658679695, 11.141176492120346, -9.431116102573634, 25.375617511252344], "episode_lengths": [1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1078, 295, 386, 295, 295, 654, 1117, 406, 1117, 269, 1117, 1117, 295, 945, 1117, 295, 436, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 91, 1117, 1117, 1117, 1083, 295, 295, 295, 1117, 1117, 1117, 406, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 358, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 378, 539, 295, 295, 1117, 295, 1117, 295, 1117, 439, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0035112474372276, "mean_inference_ms": 6.680674953175415, "mean_action_processing_ms": 0.4544921543940005, "mean_env_wait_ms": 20.235012548306027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023095130920410156, "StateBufferConnector_ms": 0.013080120086669922, "ViewRequirementAgentConnector_ms": 0.8281149864196777}}, "episode_reward_max": 125.29819801062803, "episode_reward_min": -33.78060141393743, "episode_reward_mean": 19.828374539932945, "episode_len_mean": 764.04, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.695140496081887, -6.7484781394607865, 10.085582755862069, 10.631577937961397, 44.145621130344736, 13.195953122729188, 9.821304198847942, 32.98912077971073, 15.341642604523102, 25.598654622152942, 14.804181883541778, 50.26507214250421, 33.646182718431334, 17.886554608926808, 22.71045104965753, 45.41041058383806, 22.807113130153354, 13.2897830748265, 42.047990254210944, 27.97154653155274, 9.714166766978297, 59.12539012669324, 46.235513238006426, 26.959489144269224, 52.72682141929988, 26.024234811860637, -0.18516366622140312, 11.067661466070293, -1.6035712599109193, 13.568744371501513, 19.952703819305793, 1.568662892456489, 24.123847597687448, 19.935121391262776, -6.898797409455755, 15.484540199468784, -5.458400717898762, 33.520917580051375, 14.316429939938997, 29.124816019893924, 37.13982183557588, 8.39563541388856, 0.7179958328612899, 50.68101396370604, 21.06526927540575, -33.78060141393743, 125.29819801062803, 22.669031480762154, 18.096168369861502, 38.65773782799963, 27.797770491040794, 15.55737775723361, 16.292264884053207, 14.547360213781987, 9.470020561048688, 20.811780132190986, 66.27999079115578, 8.704830726122628, 24.16919999904201, 30.502274703882463, 39.35623426199391, 13.919672915475502, 14.085689958103162, 4.975039995312402, 26.148536487876278, 34.66959055308236, 22.78404787908823, -4.752508641607424, -7.182415751137473, 14.360359975407755, 14.848257538413328, 14.002391087765446, 20.66903490035716, 21.190842850768885, 35.343753990509505, 21.358825127999005, 15.123818430233804, 33.98092662070628, -4.484285298149101, 12.848894277129332, 0.944919762739489, 24.29198130969112, 5.397513677647568, 1.9441081427925113, 27.454693770647406, 22.38374967770559, 22.011602730992042, 36.60727824056101, 18.532392696935826, 0.2614853425574468, -21.085328346360097, 14.979322822377771, 19.178139394673305, 7.075841593767252, 13.338649153858068, 24.181561229942684, 14.035483658679695, 11.141176492120346, -9.431116102573634, 25.375617511252344], "episode_lengths": [1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1078, 295, 386, 295, 295, 654, 1117, 406, 1117, 269, 1117, 1117, 295, 945, 1117, 295, 436, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 91, 1117, 1117, 1117, 1083, 295, 295, 295, 1117, 1117, 1117, 406, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 358, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 378, 539, 295, 295, 1117, 295, 1117, 295, 1117, 439, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0035112474372276, "mean_inference_ms": 6.680674953175415, "mean_action_processing_ms": 0.4544921543940005, "mean_env_wait_ms": 20.235012548306027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023095130920410156, "StateBufferConnector_ms": 0.013080120086669922, "ViewRequirementAgentConnector_ms": 0.8281149864196777}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 522660, "num_agent_steps_trained": 522660, "num_env_steps_sampled": 522660, "num_env_steps_trained": 522660, "num_env_steps_sampled_this_iter": 7889, "num_env_steps_trained_this_iter": 7889, "num_env_steps_sampled_throughput_per_sec": 184.5610609212798, "num_env_steps_trained_throughput_per_sec": 184.5610609212798, "timesteps_total": 522660, "num_steps_trained_this_iter": 7889, "agent_timesteps_total": 522660, "timers": {"training_iteration_time_ms": 51068.337, "sample_time_ms": 34329.312, "load_time_ms": 1836.951, "load_throughput": 5874.517, "learn_time_ms": 14390.137, "learn_throughput": 749.903, "synch_weights_time_ms": 430.181}, "counters": {"num_env_steps_sampled": 522660, "num_env_steps_trained": 522660, "num_agent_steps_sampled": 522660, "num_agent_steps_trained": 522660}, "done": false, "episodes_total": 802, "training_iteration": 57, "trial_id": "32ccc_00000", "date": "2025-06-07_12-43-38", "timestamp": 1749293018, "time_this_iter_s": 42.765156507492065, "time_total_s": 2540.3784804344177, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2540.3784804344177, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 52.076470588235296, "ram_util_percent": 87.4843137254902, "gpu_util_percent0": 0.1484313725490196, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.47734e-05, "total_loss": -0.1357993311033799, "policy_loss": -0.03545113543349987, "vf_loss": 0.07033294177829073, "vf_explained_var": 0.9112583132890555, "kl": 0.010058946977294862, "entropy": 16.611674264761117, "entropy_coeff": 0.007386699999999997}, "model": {}, "num_grad_updates_lifetime": 18565.5, "diff_num_grad_updates_vs_sampler_policy": 194.5}}, "num_env_steps_sampled": 533725, "num_env_steps_trained": 533725, "num_agent_steps_sampled": 533725, "num_agent_steps_trained": 533725}, "sampler_results": {"episode_reward_max": 125.29819801062803, "episode_reward_min": -44.78100007537291, "episode_reward_mean": 18.748240939358553, "episode_len_mean": 751.19, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.71045104965753, 45.41041058383806, 22.807113130153354, 13.2897830748265, 42.047990254210944, 27.97154653155274, 9.714166766978297, 59.12539012669324, 46.235513238006426, 26.959489144269224, 52.72682141929988, 26.024234811860637, -0.18516366622140312, 11.067661466070293, -1.6035712599109193, 13.568744371501513, 19.952703819305793, 1.568662892456489, 24.123847597687448, 19.935121391262776, -6.898797409455755, 15.484540199468784, -5.458400717898762, 33.520917580051375, 14.316429939938997, 29.124816019893924, 37.13982183557588, 8.39563541388856, 0.7179958328612899, 50.68101396370604, 21.06526927540575, -33.78060141393743, 125.29819801062803, 22.669031480762154, 18.096168369861502, 38.65773782799963, 27.797770491040794, 15.55737775723361, 16.292264884053207, 14.547360213781987, 9.470020561048688, 20.811780132190986, 66.27999079115578, 8.704830726122628, 24.16919999904201, 30.502274703882463, 39.35623426199391, 13.919672915475502, 14.085689958103162, 4.975039995312402, 26.148536487876278, 34.66959055308236, 22.78404787908823, -4.752508641607424, -7.182415751137473, 14.360359975407755, 14.848257538413328, 14.002391087765446, 20.66903490035716, 21.190842850768885, 35.343753990509505, 21.358825127999005, 15.123818430233804, 33.98092662070628, -4.484285298149101, 12.848894277129332, 0.944919762739489, 24.29198130969112, 5.397513677647568, 1.9441081427925113, 27.454693770647406, 22.38374967770559, 22.011602730992042, 36.60727824056101, 18.532392696935826, 0.2614853425574468, -21.085328346360097, 14.979322822377771, 19.178139394673305, 7.075841593767252, 13.338649153858068, 24.181561229942684, 14.035483658679695, 11.141176492120346, -9.431116102573634, 25.375617511252344, 5.409770136869319, 19.42109118783399, 4.179858176149304, 29.6802998972392, 10.958579558832131, 1.9686886869014328, 22.304110963013155, 16.094493346925507, 23.91939016139091, 20.669092804620963, 32.86782539612118, 15.624782815582783, 28.027767748611296, -44.78100007537291], "episode_lengths": [1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1078, 295, 386, 295, 295, 654, 1117, 406, 1117, 269, 1117, 1117, 295, 945, 1117, 295, 436, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 91, 1117, 1117, 1117, 1083, 295, 295, 295, 1117, 1117, 1117, 406, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 358, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 378, 539, 295, 295, 1117, 295, 1117, 295, 1117, 439, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.008760634744232, "mean_inference_ms": 6.6901353830339545, "mean_action_processing_ms": 0.4553361847755496, "mean_env_wait_ms": 20.262623350953625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0180511474609375, "StateBufferConnector_ms": 0.017114639282226562, "ViewRequirementAgentConnector_ms": 0.7851214408874512}}, "episode_reward_max": 125.29819801062803, "episode_reward_min": -44.78100007537291, "episode_reward_mean": 18.748240939358553, "episode_len_mean": 751.19, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.71045104965753, 45.41041058383806, 22.807113130153354, 13.2897830748265, 42.047990254210944, 27.97154653155274, 9.714166766978297, 59.12539012669324, 46.235513238006426, 26.959489144269224, 52.72682141929988, 26.024234811860637, -0.18516366622140312, 11.067661466070293, -1.6035712599109193, 13.568744371501513, 19.952703819305793, 1.568662892456489, 24.123847597687448, 19.935121391262776, -6.898797409455755, 15.484540199468784, -5.458400717898762, 33.520917580051375, 14.316429939938997, 29.124816019893924, 37.13982183557588, 8.39563541388856, 0.7179958328612899, 50.68101396370604, 21.06526927540575, -33.78060141393743, 125.29819801062803, 22.669031480762154, 18.096168369861502, 38.65773782799963, 27.797770491040794, 15.55737775723361, 16.292264884053207, 14.547360213781987, 9.470020561048688, 20.811780132190986, 66.27999079115578, 8.704830726122628, 24.16919999904201, 30.502274703882463, 39.35623426199391, 13.919672915475502, 14.085689958103162, 4.975039995312402, 26.148536487876278, 34.66959055308236, 22.78404787908823, -4.752508641607424, -7.182415751137473, 14.360359975407755, 14.848257538413328, 14.002391087765446, 20.66903490035716, 21.190842850768885, 35.343753990509505, 21.358825127999005, 15.123818430233804, 33.98092662070628, -4.484285298149101, 12.848894277129332, 0.944919762739489, 24.29198130969112, 5.397513677647568, 1.9441081427925113, 27.454693770647406, 22.38374967770559, 22.011602730992042, 36.60727824056101, 18.532392696935826, 0.2614853425574468, -21.085328346360097, 14.979322822377771, 19.178139394673305, 7.075841593767252, 13.338649153858068, 24.181561229942684, 14.035483658679695, 11.141176492120346, -9.431116102573634, 25.375617511252344, 5.409770136869319, 19.42109118783399, 4.179858176149304, 29.6802998972392, 10.958579558832131, 1.9686886869014328, 22.304110963013155, 16.094493346925507, 23.91939016139091, 20.669092804620963, 32.86782539612118, 15.624782815582783, 28.027767748611296, -44.78100007537291], "episode_lengths": [1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1078, 295, 386, 295, 295, 654, 1117, 406, 1117, 269, 1117, 1117, 295, 945, 1117, 295, 436, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 91, 1117, 1117, 1117, 1083, 295, 295, 295, 1117, 1117, 1117, 406, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 358, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 378, 539, 295, 295, 1117, 295, 1117, 295, 1117, 439, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.008760634744232, "mean_inference_ms": 6.6901353830339545, "mean_action_processing_ms": 0.4553361847755496, "mean_env_wait_ms": 20.262623350953625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0180511474609375, "StateBufferConnector_ms": 0.017114639282226562, "ViewRequirementAgentConnector_ms": 0.7851214408874512}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 533725, "num_agent_steps_trained": 533725, "num_env_steps_sampled": 533725, "num_env_steps_trained": 533725, "num_env_steps_sampled_this_iter": 11065, "num_env_steps_trained_this_iter": 11065, "num_env_steps_sampled_throughput_per_sec": 209.13733737664546, "num_env_steps_trained_throughput_per_sec": 209.13733737664546, "timesteps_total": 533725, "num_steps_trained_this_iter": 11065, "agent_timesteps_total": 533725, "timers": {"training_iteration_time_ms": 51803.643, "sample_time_ms": 34776.432, "load_time_ms": 1860.771, "load_throughput": 5857.088, "learn_time_ms": 14651.711, "learn_throughput": 743.852, "synch_weights_time_ms": 432.005}, "counters": {"num_env_steps_sampled": 533725, "num_env_steps_trained": 533725, "num_agent_steps_sampled": 533725, "num_agent_steps_trained": 533725}, "done": false, "episodes_total": 816, "training_iteration": 58, "trial_id": "32ccc_00000", "date": "2025-06-07_12-44-31", "timestamp": 1749293071, "time_this_iter_s": 52.923667192459106, "time_total_s": 2593.302147626877, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2593.302147626877, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 58.860317460317454, "ram_util_percent": 88.09682539682545, "gpu_util_percent0": 0.20015873015873012, "vram_util_percent0": 0.9650065104166664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.466275e-05, "total_loss": -0.11438766565588594, "policy_loss": -0.016959278624563014, "vf_loss": 0.07194080015760847, "vf_explained_var": 0.9297231933102011, "kl": 0.011110029672636301, "entropy": 16.422483402490617, "entropy_coeff": 0.007331374999999999}, "model": {}, "num_grad_updates_lifetime": 18920.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 542794, "num_env_steps_trained": 542794, "num_agent_steps_sampled": 542794, "num_agent_steps_trained": 542794}, "sampler_results": {"episode_reward_max": 132.4104014536705, "episode_reward_min": -44.78100007537291, "episode_reward_mean": 19.148326118837044, "episode_len_mean": 710.16, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.6035712599109193, 13.568744371501513, 19.952703819305793, 1.568662892456489, 24.123847597687448, 19.935121391262776, -6.898797409455755, 15.484540199468784, -5.458400717898762, 33.520917580051375, 14.316429939938997, 29.124816019893924, 37.13982183557588, 8.39563541388856, 0.7179958328612899, 50.68101396370604, 21.06526927540575, -33.78060141393743, 125.29819801062803, 22.669031480762154, 18.096168369861502, 38.65773782799963, 27.797770491040794, 15.55737775723361, 16.292264884053207, 14.547360213781987, 9.470020561048688, 20.811780132190986, 66.27999079115578, 8.704830726122628, 24.16919999904201, 30.502274703882463, 39.35623426199391, 13.919672915475502, 14.085689958103162, 4.975039995312402, 26.148536487876278, 34.66959055308236, 22.78404787908823, -4.752508641607424, -7.182415751137473, 14.360359975407755, 14.848257538413328, 14.002391087765446, 20.66903490035716, 21.190842850768885, 35.343753990509505, 21.358825127999005, 15.123818430233804, 33.98092662070628, -4.484285298149101, 12.848894277129332, 0.944919762739489, 24.29198130969112, 5.397513677647568, 1.9441081427925113, 27.454693770647406, 22.38374967770559, 22.011602730992042, 36.60727824056101, 18.532392696935826, 0.2614853425574468, -21.085328346360097, 14.979322822377771, 19.178139394673305, 7.075841593767252, 13.338649153858068, 24.181561229942684, 14.035483658679695, 11.141176492120346, -9.431116102573634, 25.375617511252344, 5.409770136869319, 19.42109118783399, 4.179858176149304, 29.6802998972392, 10.958579558832131, 1.9686886869014328, 22.304110963013155, 16.094493346925507, 23.91939016139091, 20.669092804620963, 32.86782539612118, 15.624782815582783, 28.027767748611296, -44.78100007537291, 18.303355900129926, 15.843237216021542, 53.72438263395717, 10.878046004210677, 11.903373800726108, 15.289719768640996, 132.4104014536705, 12.311780181894889, 47.38218412948905, 56.53030384422987, 18.304518462312345, 34.05451966743126, 3.694716324801224, 15.283386491529281], "episode_lengths": [1117, 1078, 295, 386, 295, 295, 654, 1117, 406, 1117, 269, 1117, 1117, 295, 945, 1117, 295, 436, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 91, 1117, 1117, 1117, 1083, 295, 295, 295, 1117, 1117, 1117, 406, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 358, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 378, 539, 295, 295, 1117, 295, 1117, 295, 1117, 439, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 654, 295, 295, 1117, 295, 302, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0122385000985363, "mean_inference_ms": 6.697889449628146, "mean_action_processing_ms": 0.4560445211157229, "mean_env_wait_ms": 20.285350412176204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017032861709594727, "StateBufferConnector_ms": 0.017075300216674805, "ViewRequirementAgentConnector_ms": 0.7754106521606445}}, "episode_reward_max": 132.4104014536705, "episode_reward_min": -44.78100007537291, "episode_reward_mean": 19.148326118837044, "episode_len_mean": 710.16, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.6035712599109193, 13.568744371501513, 19.952703819305793, 1.568662892456489, 24.123847597687448, 19.935121391262776, -6.898797409455755, 15.484540199468784, -5.458400717898762, 33.520917580051375, 14.316429939938997, 29.124816019893924, 37.13982183557588, 8.39563541388856, 0.7179958328612899, 50.68101396370604, 21.06526927540575, -33.78060141393743, 125.29819801062803, 22.669031480762154, 18.096168369861502, 38.65773782799963, 27.797770491040794, 15.55737775723361, 16.292264884053207, 14.547360213781987, 9.470020561048688, 20.811780132190986, 66.27999079115578, 8.704830726122628, 24.16919999904201, 30.502274703882463, 39.35623426199391, 13.919672915475502, 14.085689958103162, 4.975039995312402, 26.148536487876278, 34.66959055308236, 22.78404787908823, -4.752508641607424, -7.182415751137473, 14.360359975407755, 14.848257538413328, 14.002391087765446, 20.66903490035716, 21.190842850768885, 35.343753990509505, 21.358825127999005, 15.123818430233804, 33.98092662070628, -4.484285298149101, 12.848894277129332, 0.944919762739489, 24.29198130969112, 5.397513677647568, 1.9441081427925113, 27.454693770647406, 22.38374967770559, 22.011602730992042, 36.60727824056101, 18.532392696935826, 0.2614853425574468, -21.085328346360097, 14.979322822377771, 19.178139394673305, 7.075841593767252, 13.338649153858068, 24.181561229942684, 14.035483658679695, 11.141176492120346, -9.431116102573634, 25.375617511252344, 5.409770136869319, 19.42109118783399, 4.179858176149304, 29.6802998972392, 10.958579558832131, 1.9686886869014328, 22.304110963013155, 16.094493346925507, 23.91939016139091, 20.669092804620963, 32.86782539612118, 15.624782815582783, 28.027767748611296, -44.78100007537291, 18.303355900129926, 15.843237216021542, 53.72438263395717, 10.878046004210677, 11.903373800726108, 15.289719768640996, 132.4104014536705, 12.311780181894889, 47.38218412948905, 56.53030384422987, 18.304518462312345, 34.05451966743126, 3.694716324801224, 15.283386491529281], "episode_lengths": [1117, 1078, 295, 386, 295, 295, 654, 1117, 406, 1117, 269, 1117, 1117, 295, 945, 1117, 295, 436, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 91, 1117, 1117, 1117, 1083, 295, 295, 295, 1117, 1117, 1117, 406, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 358, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 378, 539, 295, 295, 1117, 295, 1117, 295, 1117, 439, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 654, 295, 295, 1117, 295, 302, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0122385000985363, "mean_inference_ms": 6.697889449628146, "mean_action_processing_ms": 0.4560445211157229, "mean_env_wait_ms": 20.285350412176204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017032861709594727, "StateBufferConnector_ms": 0.017075300216674805, "ViewRequirementAgentConnector_ms": 0.7754106521606445}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 542794, "num_agent_steps_trained": 542794, "num_env_steps_sampled": 542794, "num_env_steps_trained": 542794, "num_env_steps_sampled_this_iter": 9069, "num_env_steps_trained_this_iter": 9069, "num_env_steps_sampled_throughput_per_sec": 195.83299642304175, "num_env_steps_trained_throughput_per_sec": 195.83299642304175, "timesteps_total": 542794, "num_steps_trained_this_iter": 9069, "agent_timesteps_total": 542794, "timers": {"training_iteration_time_ms": 51302.059, "sample_time_ms": 34665.755, "load_time_ms": 1831.799, "load_throughput": 5834.427, "learn_time_ms": 14283.775, "learn_throughput": 748.227, "synch_weights_time_ms": 439.405}, "counters": {"num_env_steps_sampled": 542794, "num_env_steps_trained": 542794, "num_agent_steps_sampled": 542794, "num_agent_steps_trained": 542794}, "done": false, "episodes_total": 830, "training_iteration": 59, "trial_id": "32ccc_00000", "date": "2025-06-07_12-45-18", "timestamp": 1749293118, "time_this_iter_s": 46.32890510559082, "time_total_s": 2639.6310527324677, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2639.6310527324677, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 53.89464285714286, "ram_util_percent": 88.12857142857142, "gpu_util_percent0": 0.18089285714285716, "vram_util_percent0": 0.9650065104166667}}
{"evaluation": {"sampler_results": {"episode_reward_max": 9.474354165113425, "episode_reward_min": 8.32378931322006, "episode_reward_mean": 8.984022138458531, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.474354165113425, 8.863715690322255, 9.050674129768462, 9.20757739386845, 8.32378931322006], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5563449659245618, "mean_inference_ms": 3.531810706604479, "mean_action_processing_ms": 0.2637748117141157, "mean_env_wait_ms": 10.805218359241232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4655933380126953}}, "episode_reward_max": 9.474354165113425, "episode_reward_min": 8.32378931322006, "episode_reward_mean": 8.984022138458531, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.474354165113425, 8.863715690322255, 9.050674129768462, 9.20757739386845, 8.32378931322006], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5563449659245618, "mean_inference_ms": 3.531810706604479, "mean_action_processing_ms": 0.2637748117141157, "mean_env_wait_ms": 10.805218359241232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4655933380126953}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.457206000000002e-05, "total_loss": -0.12189892870282117, "policy_loss": -0.024331053906414463, "vf_loss": 0.07544673049430314, "vf_explained_var": 0.9259668373747876, "kl": 0.009096702009821546, "entropy": 16.653649237281396, "entropy_coeff": 0.007286030000000001}, "model": {}, "num_grad_updates_lifetime": 19270.5, "diff_num_grad_updates_vs_sampler_policy": 189.5}}, "num_env_steps_sampled": 553500, "num_env_steps_trained": 553500, "num_agent_steps_sampled": 553500, "num_agent_steps_trained": 553500}, "sampler_results": {"episode_reward_max": 132.4104014536705, "episode_reward_min": -44.78100007537291, "episode_reward_mean": 19.99691160234859, "episode_len_mean": 721.64, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7179958328612899, 50.68101396370604, 21.06526927540575, -33.78060141393743, 125.29819801062803, 22.669031480762154, 18.096168369861502, 38.65773782799963, 27.797770491040794, 15.55737775723361, 16.292264884053207, 14.547360213781987, 9.470020561048688, 20.811780132190986, 66.27999079115578, 8.704830726122628, 24.16919999904201, 30.502274703882463, 39.35623426199391, 13.919672915475502, 14.085689958103162, 4.975039995312402, 26.148536487876278, 34.66959055308236, 22.78404787908823, -4.752508641607424, -7.182415751137473, 14.360359975407755, 14.848257538413328, 14.002391087765446, 20.66903490035716, 21.190842850768885, 35.343753990509505, 21.358825127999005, 15.123818430233804, 33.98092662070628, -4.484285298149101, 12.848894277129332, 0.944919762739489, 24.29198130969112, 5.397513677647568, 1.9441081427925113, 27.454693770647406, 22.38374967770559, 22.011602730992042, 36.60727824056101, 18.532392696935826, 0.2614853425574468, -21.085328346360097, 14.979322822377771, 19.178139394673305, 7.075841593767252, 13.338649153858068, 24.181561229942684, 14.035483658679695, 11.141176492120346, -9.431116102573634, 25.375617511252344, 5.409770136869319, 19.42109118783399, 4.179858176149304, 29.6802998972392, 10.958579558832131, 1.9686886869014328, 22.304110963013155, 16.094493346925507, 23.91939016139091, 20.669092804620963, 32.86782539612118, 15.624782815582783, 28.027767748611296, -44.78100007537291, 18.303355900129926, 15.843237216021542, 53.72438263395717, 10.878046004210677, 11.903373800726108, 15.289719768640996, 132.4104014536705, 12.311780181894889, 47.38218412948905, 56.53030384422987, 18.304518462312345, 34.05451966743126, 3.694716324801224, 15.283386491529281, 45.18049955634745, 33.91483967659545, 11.285805490417099, 7.870559029608938, 14.915327642172615, 34.50958967647872, 23.78320077458291, 13.518980120987226, 17.435857837636743, 15.609860259630572, 32.61860828203212, 22.574607732461185, 25.48008722708655, -10.668803281117057], "episode_lengths": [945, 1117, 295, 436, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 91, 1117, 1117, 1117, 1083, 295, 295, 295, 1117, 1117, 1117, 406, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 358, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 378, 539, 295, 295, 1117, 295, 1117, 295, 1117, 439, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 654, 295, 295, 1117, 295, 302, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0161173524018325, "mean_inference_ms": 6.705485974094254, "mean_action_processing_ms": 0.45681453598231114, "mean_env_wait_ms": 20.307504932117098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020036935806274414, "StateBufferConnector_ms": 0.015134096145629883, "ViewRequirementAgentConnector_ms": 0.7566044330596924}}, "episode_reward_max": 132.4104014536705, "episode_reward_min": -44.78100007537291, "episode_reward_mean": 19.99691160234859, "episode_len_mean": 721.64, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7179958328612899, 50.68101396370604, 21.06526927540575, -33.78060141393743, 125.29819801062803, 22.669031480762154, 18.096168369861502, 38.65773782799963, 27.797770491040794, 15.55737775723361, 16.292264884053207, 14.547360213781987, 9.470020561048688, 20.811780132190986, 66.27999079115578, 8.704830726122628, 24.16919999904201, 30.502274703882463, 39.35623426199391, 13.919672915475502, 14.085689958103162, 4.975039995312402, 26.148536487876278, 34.66959055308236, 22.78404787908823, -4.752508641607424, -7.182415751137473, 14.360359975407755, 14.848257538413328, 14.002391087765446, 20.66903490035716, 21.190842850768885, 35.343753990509505, 21.358825127999005, 15.123818430233804, 33.98092662070628, -4.484285298149101, 12.848894277129332, 0.944919762739489, 24.29198130969112, 5.397513677647568, 1.9441081427925113, 27.454693770647406, 22.38374967770559, 22.011602730992042, 36.60727824056101, 18.532392696935826, 0.2614853425574468, -21.085328346360097, 14.979322822377771, 19.178139394673305, 7.075841593767252, 13.338649153858068, 24.181561229942684, 14.035483658679695, 11.141176492120346, -9.431116102573634, 25.375617511252344, 5.409770136869319, 19.42109118783399, 4.179858176149304, 29.6802998972392, 10.958579558832131, 1.9686886869014328, 22.304110963013155, 16.094493346925507, 23.91939016139091, 20.669092804620963, 32.86782539612118, 15.624782815582783, 28.027767748611296, -44.78100007537291, 18.303355900129926, 15.843237216021542, 53.72438263395717, 10.878046004210677, 11.903373800726108, 15.289719768640996, 132.4104014536705, 12.311780181894889, 47.38218412948905, 56.53030384422987, 18.304518462312345, 34.05451966743126, 3.694716324801224, 15.283386491529281, 45.18049955634745, 33.91483967659545, 11.285805490417099, 7.870559029608938, 14.915327642172615, 34.50958967647872, 23.78320077458291, 13.518980120987226, 17.435857837636743, 15.609860259630572, 32.61860828203212, 22.574607732461185, 25.48008722708655, -10.668803281117057], "episode_lengths": [945, 1117, 295, 436, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 91, 1117, 1117, 1117, 1083, 295, 295, 295, 1117, 1117, 1117, 406, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 358, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 378, 539, 295, 295, 1117, 295, 1117, 295, 1117, 439, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 654, 295, 295, 1117, 295, 302, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0161173524018325, "mean_inference_ms": 6.705485974094254, "mean_action_processing_ms": 0.45681453598231114, "mean_env_wait_ms": 20.307504932117098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020036935806274414, "StateBufferConnector_ms": 0.015134096145629883, "ViewRequirementAgentConnector_ms": 0.7566044330596924}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 553500, "num_agent_steps_trained": 553500, "num_env_steps_sampled": 553500, "num_env_steps_trained": 553500, "num_env_steps_sampled_this_iter": 10706, "num_env_steps_trained_this_iter": 10706, "num_env_steps_sampled_throughput_per_sec": 211.47058660446694, "num_env_steps_trained_throughput_per_sec": 211.47058660446694, "timesteps_total": 553500, "num_steps_trained_this_iter": 10706, "agent_timesteps_total": 553500, "timers": {"training_iteration_time_ms": 51256.308, "sample_time_ms": 34724.389, "load_time_ms": 1834.463, "load_throughput": 5785.182, "learn_time_ms": 14175.194, "learn_throughput": 748.681, "synch_weights_time_ms": 439.227}, "counters": {"num_env_steps_sampled": 553500, "num_env_steps_trained": 553500, "num_agent_steps_sampled": 553500, "num_agent_steps_trained": 553500}, "done": false, "episodes_total": 844, "training_iteration": 60, "trial_id": "32ccc_00000", "date": "2025-06-07_12-46-26", "timestamp": 1749293186, "time_this_iter_s": 67.94368958473206, "time_total_s": 2707.5747423171997, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2707.5747423171997, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 49.07777777777778, "ram_util_percent": 88.40987654320988, "gpu_util_percent0": 0.13814814814814816, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.4465e-05, "total_loss": -0.12239024507641597, "policy_loss": -0.02448242100347814, "vf_loss": 0.06964866763569022, "vf_explained_var": 0.9200753287265175, "kl": 0.010256969487685496, "entropy": 16.603463720020496, "entropy_coeff": 0.007232500000000001}, "model": {}, "num_grad_updates_lifetime": 19650.5, "diff_num_grad_updates_vs_sampler_policy": 189.5}}, "num_env_steps_sampled": 564206, "num_env_steps_trained": 564206, "num_agent_steps_sampled": 564206, "num_agent_steps_trained": 564206}, "sampler_results": {"episode_reward_max": 132.4104014536705, "episode_reward_min": -44.78100007537291, "episode_reward_mean": 19.09414717659877, "episode_len_mean": 730.17, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.27999079115578, 8.704830726122628, 24.16919999904201, 30.502274703882463, 39.35623426199391, 13.919672915475502, 14.085689958103162, 4.975039995312402, 26.148536487876278, 34.66959055308236, 22.78404787908823, -4.752508641607424, -7.182415751137473, 14.360359975407755, 14.848257538413328, 14.002391087765446, 20.66903490035716, 21.190842850768885, 35.343753990509505, 21.358825127999005, 15.123818430233804, 33.98092662070628, -4.484285298149101, 12.848894277129332, 0.944919762739489, 24.29198130969112, 5.397513677647568, 1.9441081427925113, 27.454693770647406, 22.38374967770559, 22.011602730992042, 36.60727824056101, 18.532392696935826, 0.2614853425574468, -21.085328346360097, 14.979322822377771, 19.178139394673305, 7.075841593767252, 13.338649153858068, 24.181561229942684, 14.035483658679695, 11.141176492120346, -9.431116102573634, 25.375617511252344, 5.409770136869319, 19.42109118783399, 4.179858176149304, 29.6802998972392, 10.958579558832131, 1.9686886869014328, 22.304110963013155, 16.094493346925507, 23.91939016139091, 20.669092804620963, 32.86782539612118, 15.624782815582783, 28.027767748611296, -44.78100007537291, 18.303355900129926, 15.843237216021542, 53.72438263395717, 10.878046004210677, 11.903373800726108, 15.289719768640996, 132.4104014536705, 12.311780181894889, 47.38218412948905, 56.53030384422987, 18.304518462312345, 34.05451966743126, 3.694716324801224, 15.283386491529281, 45.18049955634745, 33.91483967659545, 11.285805490417099, 7.870559029608938, 14.915327642172615, 34.50958967647872, 23.78320077458291, 13.518980120987226, 17.435857837636743, 15.609860259630572, 32.61860828203212, 22.574607732461185, 25.48008722708655, -10.668803281117057, 15.70299192069557, 43.746701096311604, 32.03189155345187, -11.590847524596505, 15.210550894297981, 15.850069713574808, 16.536981842770647, 10.925563173064393, 20.36109587258105, 17.3553052000681, 8.586173171131406, 23.55961797241602, 27.05569940951082, 22.273150516376827], "episode_lengths": [1117, 91, 1117, 1117, 1117, 1083, 295, 295, 295, 1117, 1117, 1117, 406, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 358, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 378, 539, 295, 295, 1117, 295, 1117, 295, 1117, 439, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 654, 295, 295, 1117, 295, 302, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.019548019410869, "mean_inference_ms": 6.7114493369400385, "mean_action_processing_ms": 0.4574793824456424, "mean_env_wait_ms": 20.324179802105675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018065690994262695, "StateBufferConnector_ms": 0.01797032356262207, "ViewRequirementAgentConnector_ms": 0.7475457191467285}}, "episode_reward_max": 132.4104014536705, "episode_reward_min": -44.78100007537291, "episode_reward_mean": 19.09414717659877, "episode_len_mean": 730.17, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [66.27999079115578, 8.704830726122628, 24.16919999904201, 30.502274703882463, 39.35623426199391, 13.919672915475502, 14.085689958103162, 4.975039995312402, 26.148536487876278, 34.66959055308236, 22.78404787908823, -4.752508641607424, -7.182415751137473, 14.360359975407755, 14.848257538413328, 14.002391087765446, 20.66903490035716, 21.190842850768885, 35.343753990509505, 21.358825127999005, 15.123818430233804, 33.98092662070628, -4.484285298149101, 12.848894277129332, 0.944919762739489, 24.29198130969112, 5.397513677647568, 1.9441081427925113, 27.454693770647406, 22.38374967770559, 22.011602730992042, 36.60727824056101, 18.532392696935826, 0.2614853425574468, -21.085328346360097, 14.979322822377771, 19.178139394673305, 7.075841593767252, 13.338649153858068, 24.181561229942684, 14.035483658679695, 11.141176492120346, -9.431116102573634, 25.375617511252344, 5.409770136869319, 19.42109118783399, 4.179858176149304, 29.6802998972392, 10.958579558832131, 1.9686886869014328, 22.304110963013155, 16.094493346925507, 23.91939016139091, 20.669092804620963, 32.86782539612118, 15.624782815582783, 28.027767748611296, -44.78100007537291, 18.303355900129926, 15.843237216021542, 53.72438263395717, 10.878046004210677, 11.903373800726108, 15.289719768640996, 132.4104014536705, 12.311780181894889, 47.38218412948905, 56.53030384422987, 18.304518462312345, 34.05451966743126, 3.694716324801224, 15.283386491529281, 45.18049955634745, 33.91483967659545, 11.285805490417099, 7.870559029608938, 14.915327642172615, 34.50958967647872, 23.78320077458291, 13.518980120987226, 17.435857837636743, 15.609860259630572, 32.61860828203212, 22.574607732461185, 25.48008722708655, -10.668803281117057, 15.70299192069557, 43.746701096311604, 32.03189155345187, -11.590847524596505, 15.210550894297981, 15.850069713574808, 16.536981842770647, 10.925563173064393, 20.36109587258105, 17.3553052000681, 8.586173171131406, 23.55961797241602, 27.05569940951082, 22.273150516376827], "episode_lengths": [1117, 91, 1117, 1117, 1117, 1083, 295, 295, 295, 1117, 1117, 1117, 406, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 358, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 378, 539, 295, 295, 1117, 295, 1117, 295, 1117, 439, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 654, 295, 295, 1117, 295, 302, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.019548019410869, "mean_inference_ms": 6.7114493369400385, "mean_action_processing_ms": 0.4574793824456424, "mean_env_wait_ms": 20.324179802105675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018065690994262695, "StateBufferConnector_ms": 0.01797032356262207, "ViewRequirementAgentConnector_ms": 0.7475457191467285}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564206, "num_agent_steps_trained": 564206, "num_env_steps_sampled": 564206, "num_env_steps_trained": 564206, "num_env_steps_sampled_this_iter": 10706, "num_env_steps_trained_this_iter": 10706, "num_env_steps_sampled_throughput_per_sec": 210.6591402709447, "num_env_steps_trained_throughput_per_sec": 210.6591402709447, "timesteps_total": 564206, "num_steps_trained_this_iter": 10706, "agent_timesteps_total": 564206, "timers": {"training_iteration_time_ms": 50994.512, "sample_time_ms": 34616.263, "load_time_ms": 1811.861, "load_throughput": 5766.611, "learn_time_ms": 14044.093, "learn_throughput": 743.964, "synch_weights_time_ms": 439.442}, "counters": {"num_env_steps_sampled": 564206, "num_env_steps_trained": 564206, "num_agent_steps_sampled": 564206, "num_agent_steps_trained": 564206}, "done": false, "episodes_total": 858, "training_iteration": 61, "trial_id": "32ccc_00000", "date": "2025-06-07_12-47-17", "timestamp": 1749293237, "time_this_iter_s": 50.83848285675049, "time_total_s": 2758.41322517395, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2758.41322517395, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 58.4, "ram_util_percent": 89.11639344262294, "gpu_util_percent0": 0.18262295081967217, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.435793999999999e-05, "total_loss": -0.12085073909679936, "policy_loss": -0.022896279476514212, "vf_loss": 0.06769252933392471, "vf_explained_var": 0.9218381163748828, "kl": 0.011541518106905466, "entropy": 16.674384596131066, "entropy_coeff": 0.007178970000000002}, "model": {}, "num_grad_updates_lifetime": 20060.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 576556, "num_env_steps_trained": 576556, "num_agent_steps_sampled": 576556, "num_agent_steps_trained": 576556}, "sampler_results": {"episode_reward_max": 132.4104014536705, "episode_reward_min": -44.78100007537291, "episode_reward_mean": 18.82625296894587, "episode_len_mean": 739.66, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.848257538413328, 14.002391087765446, 20.66903490035716, 21.190842850768885, 35.343753990509505, 21.358825127999005, 15.123818430233804, 33.98092662070628, -4.484285298149101, 12.848894277129332, 0.944919762739489, 24.29198130969112, 5.397513677647568, 1.9441081427925113, 27.454693770647406, 22.38374967770559, 22.011602730992042, 36.60727824056101, 18.532392696935826, 0.2614853425574468, -21.085328346360097, 14.979322822377771, 19.178139394673305, 7.075841593767252, 13.338649153858068, 24.181561229942684, 14.035483658679695, 11.141176492120346, -9.431116102573634, 25.375617511252344, 5.409770136869319, 19.42109118783399, 4.179858176149304, 29.6802998972392, 10.958579558832131, 1.9686886869014328, 22.304110963013155, 16.094493346925507, 23.91939016139091, 20.669092804620963, 32.86782539612118, 15.624782815582783, 28.027767748611296, -44.78100007537291, 18.303355900129926, 15.843237216021542, 53.72438263395717, 10.878046004210677, 11.903373800726108, 15.289719768640996, 132.4104014536705, 12.311780181894889, 47.38218412948905, 56.53030384422987, 18.304518462312345, 34.05451966743126, 3.694716324801224, 15.283386491529281, 45.18049955634745, 33.91483967659545, 11.285805490417099, 7.870559029608938, 14.915327642172615, 34.50958967647872, 23.78320077458291, 13.518980120987226, 17.435857837636743, 15.609860259630572, 32.61860828203212, 22.574607732461185, 25.48008722708655, -10.668803281117057, 15.70299192069557, 43.746701096311604, 32.03189155345187, -11.590847524596505, 15.210550894297981, 15.850069713574808, 16.536981842770647, 10.925563173064393, 20.36109587258105, 17.3553052000681, 8.586173171131406, 23.55961797241602, 27.05569940951082, 22.273150516376827, 36.28165433015884, 22.4945915988375, 31.059705756715044, 26.897197726628047, 15.470923294566202, 20.582475339494426, 24.195213853588577, 1.0070949605279171, 2.1824239046570235, 21.51990216507576, 4.881622175122063, 3.066436488497437, 8.734375338586808, 42.85750615605188], "episode_lengths": [1117, 1117, 295, 295, 1117, 295, 295, 1117, 358, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 378, 539, 295, 295, 1117, 295, 1117, 295, 1117, 439, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 654, 295, 295, 1117, 295, 302, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.024766087816084, "mean_inference_ms": 6.719246018602352, "mean_action_processing_ms": 0.4580618149120802, "mean_env_wait_ms": 20.33527402300381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020052194595336914, "StateBufferConnector_ms": 0.02193164825439453, "ViewRequirementAgentConnector_ms": 0.7772917747497559}}, "episode_reward_max": 132.4104014536705, "episode_reward_min": -44.78100007537291, "episode_reward_mean": 18.82625296894587, "episode_len_mean": 739.66, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.848257538413328, 14.002391087765446, 20.66903490035716, 21.190842850768885, 35.343753990509505, 21.358825127999005, 15.123818430233804, 33.98092662070628, -4.484285298149101, 12.848894277129332, 0.944919762739489, 24.29198130969112, 5.397513677647568, 1.9441081427925113, 27.454693770647406, 22.38374967770559, 22.011602730992042, 36.60727824056101, 18.532392696935826, 0.2614853425574468, -21.085328346360097, 14.979322822377771, 19.178139394673305, 7.075841593767252, 13.338649153858068, 24.181561229942684, 14.035483658679695, 11.141176492120346, -9.431116102573634, 25.375617511252344, 5.409770136869319, 19.42109118783399, 4.179858176149304, 29.6802998972392, 10.958579558832131, 1.9686886869014328, 22.304110963013155, 16.094493346925507, 23.91939016139091, 20.669092804620963, 32.86782539612118, 15.624782815582783, 28.027767748611296, -44.78100007537291, 18.303355900129926, 15.843237216021542, 53.72438263395717, 10.878046004210677, 11.903373800726108, 15.289719768640996, 132.4104014536705, 12.311780181894889, 47.38218412948905, 56.53030384422987, 18.304518462312345, 34.05451966743126, 3.694716324801224, 15.283386491529281, 45.18049955634745, 33.91483967659545, 11.285805490417099, 7.870559029608938, 14.915327642172615, 34.50958967647872, 23.78320077458291, 13.518980120987226, 17.435857837636743, 15.609860259630572, 32.61860828203212, 22.574607732461185, 25.48008722708655, -10.668803281117057, 15.70299192069557, 43.746701096311604, 32.03189155345187, -11.590847524596505, 15.210550894297981, 15.850069713574808, 16.536981842770647, 10.925563173064393, 20.36109587258105, 17.3553052000681, 8.586173171131406, 23.55961797241602, 27.05569940951082, 22.273150516376827, 36.28165433015884, 22.4945915988375, 31.059705756715044, 26.897197726628047, 15.470923294566202, 20.582475339494426, 24.195213853588577, 1.0070949605279171, 2.1824239046570235, 21.51990216507576, 4.881622175122063, 3.066436488497437, 8.734375338586808, 42.85750615605188], "episode_lengths": [1117, 1117, 295, 295, 1117, 295, 295, 1117, 358, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 378, 539, 295, 295, 1117, 295, 1117, 295, 1117, 439, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 654, 295, 295, 1117, 295, 302, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.024766087816084, "mean_inference_ms": 6.719246018602352, "mean_action_processing_ms": 0.4580618149120802, "mean_env_wait_ms": 20.33527402300381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020052194595336914, "StateBufferConnector_ms": 0.02193164825439453, "ViewRequirementAgentConnector_ms": 0.7772917747497559}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576556, "num_agent_steps_trained": 576556, "num_env_steps_sampled": 576556, "num_env_steps_trained": 576556, "num_env_steps_sampled_this_iter": 12350, "num_env_steps_trained_this_iter": 12350, "num_env_steps_sampled_throughput_per_sec": 227.56576344084962, "num_env_steps_trained_throughput_per_sec": 227.56576344084962, "timesteps_total": 576556, "num_steps_trained_this_iter": 12350, "agent_timesteps_total": 576556, "timers": {"training_iteration_time_ms": 50467.089, "sample_time_ms": 34568.997, "load_time_ms": 1597.158, "load_throughput": 6490.341, "learn_time_ms": 13780.424, "learn_throughput": 752.234, "synch_weights_time_ms": 439.528}, "counters": {"num_env_steps_sampled": 576556, "num_env_steps_trained": 576556, "num_agent_steps_sampled": 576556, "num_agent_steps_trained": 576556}, "done": false, "episodes_total": 872, "training_iteration": 62, "trial_id": "32ccc_00000", "date": "2025-06-07_12-48-11", "timestamp": 1749293291, "time_this_iter_s": 54.287025928497314, "time_total_s": 2812.7002511024475, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2812.7002511024475, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 64.034375, "ram_util_percent": 89.60156249999999, "gpu_util_percent0": 0.1675, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.423444e-05, "total_loss": -0.13713970391786304, "policy_loss": -0.038930201435718556, "vf_loss": 0.06110873453897135, "vf_explained_var": 0.9469486762737406, "kl": 0.01027878454479239, "entropy": 16.55519598270285, "entropy_coeff": 0.007117220000000001}, "model": {}, "num_grad_updates_lifetime": 20425.5, "diff_num_grad_updates_vs_sampler_policy": 144.5}}, "num_env_steps_sampled": 584770, "num_env_steps_trained": 584770, "num_agent_steps_sampled": 584770, "num_agent_steps_trained": 584770}, "sampler_results": {"episode_reward_max": 132.4104014536705, "episode_reward_min": -44.78100007537291, "episode_reward_mean": 19.400899413206634, "episode_len_mean": 714.11, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.454693770647406, 22.38374967770559, 22.011602730992042, 36.60727824056101, 18.532392696935826, 0.2614853425574468, -21.085328346360097, 14.979322822377771, 19.178139394673305, 7.075841593767252, 13.338649153858068, 24.181561229942684, 14.035483658679695, 11.141176492120346, -9.431116102573634, 25.375617511252344, 5.409770136869319, 19.42109118783399, 4.179858176149304, 29.6802998972392, 10.958579558832131, 1.9686886869014328, 22.304110963013155, 16.094493346925507, 23.91939016139091, 20.669092804620963, 32.86782539612118, 15.624782815582783, 28.027767748611296, -44.78100007537291, 18.303355900129926, 15.843237216021542, 53.72438263395717, 10.878046004210677, 11.903373800726108, 15.289719768640996, 132.4104014536705, 12.311780181894889, 47.38218412948905, 56.53030384422987, 18.304518462312345, 34.05451966743126, 3.694716324801224, 15.283386491529281, 45.18049955634745, 33.91483967659545, 11.285805490417099, 7.870559029608938, 14.915327642172615, 34.50958967647872, 23.78320077458291, 13.518980120987226, 17.435857837636743, 15.609860259630572, 32.61860828203212, 22.574607732461185, 25.48008722708655, -10.668803281117057, 15.70299192069557, 43.746701096311604, 32.03189155345187, -11.590847524596505, 15.210550894297981, 15.850069713574808, 16.536981842770647, 10.925563173064393, 20.36109587258105, 17.3553052000681, 8.586173171131406, 23.55961797241602, 27.05569940951082, 22.273150516376827, 36.28165433015884, 22.4945915988375, 31.059705756715044, 26.897197726628047, 15.470923294566202, 20.582475339494426, 24.195213853588577, 1.0070949605279171, 2.1824239046570235, 21.51990216507576, 4.881622175122063, 3.066436488497437, 8.734375338586808, 42.85750615605188, 34.7331848718435, 20.719351276200463, 29.792614337094726, 21.240624311846364, 16.213015428064228, 17.91399026721807, 17.83224418015532, 18.89864870300026, 19.705837311464602, 15.363031881443902, -1.1759428303313693, 18.02260498412936, 29.155925204306055, 16.510496918245256], "episode_lengths": [1117, 295, 295, 1117, 295, 378, 539, 295, 295, 1117, 295, 1117, 295, 1117, 439, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 654, 295, 295, 1117, 295, 302, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 269, 295, 1117, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.028722075047094, "mean_inference_ms": 6.724834473936028, "mean_action_processing_ms": 0.4587135554715897, "mean_env_wait_ms": 20.35084686705992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026711702346801758, "StateBufferConnector_ms": 0.025974273681640625, "ViewRequirementAgentConnector_ms": 0.746126651763916}}, "episode_reward_max": 132.4104014536705, "episode_reward_min": -44.78100007537291, "episode_reward_mean": 19.400899413206634, "episode_len_mean": 714.11, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.454693770647406, 22.38374967770559, 22.011602730992042, 36.60727824056101, 18.532392696935826, 0.2614853425574468, -21.085328346360097, 14.979322822377771, 19.178139394673305, 7.075841593767252, 13.338649153858068, 24.181561229942684, 14.035483658679695, 11.141176492120346, -9.431116102573634, 25.375617511252344, 5.409770136869319, 19.42109118783399, 4.179858176149304, 29.6802998972392, 10.958579558832131, 1.9686886869014328, 22.304110963013155, 16.094493346925507, 23.91939016139091, 20.669092804620963, 32.86782539612118, 15.624782815582783, 28.027767748611296, -44.78100007537291, 18.303355900129926, 15.843237216021542, 53.72438263395717, 10.878046004210677, 11.903373800726108, 15.289719768640996, 132.4104014536705, 12.311780181894889, 47.38218412948905, 56.53030384422987, 18.304518462312345, 34.05451966743126, 3.694716324801224, 15.283386491529281, 45.18049955634745, 33.91483967659545, 11.285805490417099, 7.870559029608938, 14.915327642172615, 34.50958967647872, 23.78320077458291, 13.518980120987226, 17.435857837636743, 15.609860259630572, 32.61860828203212, 22.574607732461185, 25.48008722708655, -10.668803281117057, 15.70299192069557, 43.746701096311604, 32.03189155345187, -11.590847524596505, 15.210550894297981, 15.850069713574808, 16.536981842770647, 10.925563173064393, 20.36109587258105, 17.3553052000681, 8.586173171131406, 23.55961797241602, 27.05569940951082, 22.273150516376827, 36.28165433015884, 22.4945915988375, 31.059705756715044, 26.897197726628047, 15.470923294566202, 20.582475339494426, 24.195213853588577, 1.0070949605279171, 2.1824239046570235, 21.51990216507576, 4.881622175122063, 3.066436488497437, 8.734375338586808, 42.85750615605188, 34.7331848718435, 20.719351276200463, 29.792614337094726, 21.240624311846364, 16.213015428064228, 17.91399026721807, 17.83224418015532, 18.89864870300026, 19.705837311464602, 15.363031881443902, -1.1759428303313693, 18.02260498412936, 29.155925204306055, 16.510496918245256], "episode_lengths": [1117, 295, 295, 1117, 295, 378, 539, 295, 295, 1117, 295, 1117, 295, 1117, 439, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 654, 295, 295, 1117, 295, 302, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 269, 295, 1117, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.028722075047094, "mean_inference_ms": 6.724834473936028, "mean_action_processing_ms": 0.4587135554715897, "mean_env_wait_ms": 20.35084686705992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026711702346801758, "StateBufferConnector_ms": 0.025974273681640625, "ViewRequirementAgentConnector_ms": 0.746126651763916}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584770, "num_agent_steps_trained": 584770, "num_env_steps_sampled": 584770, "num_env_steps_trained": 584770, "num_env_steps_sampled_this_iter": 8214, "num_env_steps_trained_this_iter": 8214, "num_env_steps_sampled_throughput_per_sec": 185.9009850676434, "num_env_steps_trained_throughput_per_sec": 185.9009850676434, "timesteps_total": 584770, "num_steps_trained_this_iter": 8214, "agent_timesteps_total": 584770, "timers": {"training_iteration_time_ms": 50073.695, "sample_time_ms": 34480.193, "load_time_ms": 1557.865, "load_throughput": 6578.813, "learn_time_ms": 13521.49, "learn_throughput": 757.971, "synch_weights_time_ms": 433.966}, "counters": {"num_env_steps_sampled": 584770, "num_env_steps_trained": 584770, "num_agent_steps_sampled": 584770, "num_agent_steps_trained": 584770}, "done": false, "episodes_total": 886, "training_iteration": 63, "trial_id": "32ccc_00000", "date": "2025-06-07_12-48-55", "timestamp": 1749293335, "time_this_iter_s": 44.20077347755432, "time_total_s": 2856.901024580002, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2856.901024580002, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 52.405660377358494, "ram_util_percent": 88.36037735849057, "gpu_util_percent0": 0.1577358490566038, "vram_util_percent0": 0.9650065104166664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.415230000000001e-05, "total_loss": -0.1522878312509796, "policy_loss": -0.05557869064525284, "vf_loss": 0.06701635507995199, "vf_explained_var": 0.9210902380532232, "kl": 0.009476405663058515, "entropy": 16.675536665423163, "entropy_coeff": 0.007076150000000001}, "model": {}, "num_grad_updates_lifetime": 20715.5, "diff_num_grad_updates_vs_sampler_policy": 144.5}}, "num_env_steps_sampled": 593010, "num_env_steps_trained": 593010, "num_agent_steps_sampled": 593010, "num_agent_steps_trained": 593010}, "sampler_results": {"episode_reward_max": 132.4104014536705, "episode_reward_min": -44.78100007537291, "episode_reward_mean": 19.3168935577221, "episode_len_mean": 710.84, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.431116102573634, 25.375617511252344, 5.409770136869319, 19.42109118783399, 4.179858176149304, 29.6802998972392, 10.958579558832131, 1.9686886869014328, 22.304110963013155, 16.094493346925507, 23.91939016139091, 20.669092804620963, 32.86782539612118, 15.624782815582783, 28.027767748611296, -44.78100007537291, 18.303355900129926, 15.843237216021542, 53.72438263395717, 10.878046004210677, 11.903373800726108, 15.289719768640996, 132.4104014536705, 12.311780181894889, 47.38218412948905, 56.53030384422987, 18.304518462312345, 34.05451966743126, 3.694716324801224, 15.283386491529281, 45.18049955634745, 33.91483967659545, 11.285805490417099, 7.870559029608938, 14.915327642172615, 34.50958967647872, 23.78320077458291, 13.518980120987226, 17.435857837636743, 15.609860259630572, 32.61860828203212, 22.574607732461185, 25.48008722708655, -10.668803281117057, 15.70299192069557, 43.746701096311604, 32.03189155345187, -11.590847524596505, 15.210550894297981, 15.850069713574808, 16.536981842770647, 10.925563173064393, 20.36109587258105, 17.3553052000681, 8.586173171131406, 23.55961797241602, 27.05569940951082, 22.273150516376827, 36.28165433015884, 22.4945915988375, 31.059705756715044, 26.897197726628047, 15.470923294566202, 20.582475339494426, 24.195213853588577, 1.0070949605279171, 2.1824239046570235, 21.51990216507576, 4.881622175122063, 3.066436488497437, 8.734375338586808, 42.85750615605188, 34.7331848718435, 20.719351276200463, 29.792614337094726, 21.240624311846364, 16.213015428064228, 17.91399026721807, 17.83224418015532, 18.89864870300026, 19.705837311464602, 15.363031881443902, -1.1759428303313693, 18.02260498412936, 29.155925204306055, 16.510496918245256, 16.291964714808536, 26.635565597969745, -17.913693171012984, 4.523237853738932, 20.194079643971072, 16.44705617483765, 18.02835716293877, 27.155247949397957, 18.504370823729044, 15.667449849568289, 13.093102195769578, 34.56031478678257, 12.731968123287045, -4.2235587957817025], "episode_lengths": [439, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 654, 295, 295, 1117, 295, 302, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 269, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0327380562888275, "mean_inference_ms": 6.730341213970681, "mean_action_processing_ms": 0.4592929579675712, "mean_env_wait_ms": 20.3659710253378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02875971794128418, "StateBufferConnector_ms": 0.024996519088745117, "ViewRequirementAgentConnector_ms": 0.7703366279602051}}, "episode_reward_max": 132.4104014536705, "episode_reward_min": -44.78100007537291, "episode_reward_mean": 19.3168935577221, "episode_len_mean": 710.84, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.431116102573634, 25.375617511252344, 5.409770136869319, 19.42109118783399, 4.179858176149304, 29.6802998972392, 10.958579558832131, 1.9686886869014328, 22.304110963013155, 16.094493346925507, 23.91939016139091, 20.669092804620963, 32.86782539612118, 15.624782815582783, 28.027767748611296, -44.78100007537291, 18.303355900129926, 15.843237216021542, 53.72438263395717, 10.878046004210677, 11.903373800726108, 15.289719768640996, 132.4104014536705, 12.311780181894889, 47.38218412948905, 56.53030384422987, 18.304518462312345, 34.05451966743126, 3.694716324801224, 15.283386491529281, 45.18049955634745, 33.91483967659545, 11.285805490417099, 7.870559029608938, 14.915327642172615, 34.50958967647872, 23.78320077458291, 13.518980120987226, 17.435857837636743, 15.609860259630572, 32.61860828203212, 22.574607732461185, 25.48008722708655, -10.668803281117057, 15.70299192069557, 43.746701096311604, 32.03189155345187, -11.590847524596505, 15.210550894297981, 15.850069713574808, 16.536981842770647, 10.925563173064393, 20.36109587258105, 17.3553052000681, 8.586173171131406, 23.55961797241602, 27.05569940951082, 22.273150516376827, 36.28165433015884, 22.4945915988375, 31.059705756715044, 26.897197726628047, 15.470923294566202, 20.582475339494426, 24.195213853588577, 1.0070949605279171, 2.1824239046570235, 21.51990216507576, 4.881622175122063, 3.066436488497437, 8.734375338586808, 42.85750615605188, 34.7331848718435, 20.719351276200463, 29.792614337094726, 21.240624311846364, 16.213015428064228, 17.91399026721807, 17.83224418015532, 18.89864870300026, 19.705837311464602, 15.363031881443902, -1.1759428303313693, 18.02260498412936, 29.155925204306055, 16.510496918245256, 16.291964714808536, 26.635565597969745, -17.913693171012984, 4.523237853738932, 20.194079643971072, 16.44705617483765, 18.02835716293877, 27.155247949397957, 18.504370823729044, 15.667449849568289, 13.093102195769578, 34.56031478678257, 12.731968123287045, -4.2235587957817025], "episode_lengths": [439, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 654, 295, 295, 1117, 295, 302, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 269, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0327380562888275, "mean_inference_ms": 6.730341213970681, "mean_action_processing_ms": 0.4592929579675712, "mean_env_wait_ms": 20.3659710253378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02875971794128418, "StateBufferConnector_ms": 0.024996519088745117, "ViewRequirementAgentConnector_ms": 0.7703366279602051}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 593010, "num_agent_steps_trained": 593010, "num_env_steps_sampled": 593010, "num_env_steps_trained": 593010, "num_env_steps_sampled_this_iter": 8240, "num_env_steps_trained_this_iter": 8240, "num_env_steps_sampled_throughput_per_sec": 191.02482461894084, "num_env_steps_trained_throughput_per_sec": 191.02482461894084, "timesteps_total": 593010, "num_steps_trained_this_iter": 8240, "agent_timesteps_total": 593010, "timers": {"training_iteration_time_ms": 49041.613, "sample_time_ms": 33866.19, "load_time_ms": 1469.143, "load_throughput": 6854.607, "learn_time_ms": 13187.986, "learn_throughput": 763.604, "synch_weights_time_ms": 441.492}, "counters": {"num_env_steps_sampled": 593010, "num_env_steps_trained": 593010, "num_agent_steps_sampled": 593010, "num_agent_steps_trained": 593010}, "done": false, "episodes_total": 900, "training_iteration": 64, "trial_id": "32ccc_00000", "date": "2025-06-07_12-49-39", "timestamp": 1749293379, "time_this_iter_s": 43.15996718406677, "time_total_s": 2900.0609917640686, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2900.0609917640686, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 52.51923076923076, "ram_util_percent": 87.67500000000001, "gpu_util_percent0": 0.14961538461538462, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.40699e-05, "total_loss": -0.14792310893610722, "policy_loss": -0.054296651747333065, "vf_loss": 0.07703015527297412, "vf_explained_var": 0.931794971419919, "kl": 0.009859893283869643, "entropy": 16.768846151905674, "entropy_coeff": 0.007034949999999999}, "model": {}, "num_grad_updates_lifetime": 21015.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 601753, "num_env_steps_trained": 601753, "num_agent_steps_sampled": 601753, "num_agent_steps_trained": 601753}, "sampler_results": {"episode_reward_max": 132.4104014536705, "episode_reward_min": -44.78100007537291, "episode_reward_mean": 19.02653323648748, "episode_len_mean": 697.99, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.027767748611296, -44.78100007537291, 18.303355900129926, 15.843237216021542, 53.72438263395717, 10.878046004210677, 11.903373800726108, 15.289719768640996, 132.4104014536705, 12.311780181894889, 47.38218412948905, 56.53030384422987, 18.304518462312345, 34.05451966743126, 3.694716324801224, 15.283386491529281, 45.18049955634745, 33.91483967659545, 11.285805490417099, 7.870559029608938, 14.915327642172615, 34.50958967647872, 23.78320077458291, 13.518980120987226, 17.435857837636743, 15.609860259630572, 32.61860828203212, 22.574607732461185, 25.48008722708655, -10.668803281117057, 15.70299192069557, 43.746701096311604, 32.03189155345187, -11.590847524596505, 15.210550894297981, 15.850069713574808, 16.536981842770647, 10.925563173064393, 20.36109587258105, 17.3553052000681, 8.586173171131406, 23.55961797241602, 27.05569940951082, 22.273150516376827, 36.28165433015884, 22.4945915988375, 31.059705756715044, 26.897197726628047, 15.470923294566202, 20.582475339494426, 24.195213853588577, 1.0070949605279171, 2.1824239046570235, 21.51990216507576, 4.881622175122063, 3.066436488497437, 8.734375338586808, 42.85750615605188, 34.7331848718435, 20.719351276200463, 29.792614337094726, 21.240624311846364, 16.213015428064228, 17.91399026721807, 17.83224418015532, 18.89864870300026, 19.705837311464602, 15.363031881443902, -1.1759428303313693, 18.02260498412936, 29.155925204306055, 16.510496918245256, 16.291964714808536, 26.635565597969745, -17.913693171012984, 4.523237853738932, 20.194079643971072, 16.44705617483765, 18.02835716293877, 27.155247949397957, 18.504370823729044, 15.667449849568289, 13.093102195769578, 34.56031478678257, 12.731968123287045, -4.2235587957817025, 6.649017692903146, 23.55668972775261, 17.19390395505032, 25.667250393991022, 17.36807665553457, 12.863412212198305, 10.610515752074337, 17.021005887402136, -0.6942690641471977, 26.793523989072114, 12.911932588635384, 15.128074866145454, 14.802256106816, -9.864938346731186], "episode_lengths": [1117, 654, 295, 295, 1117, 295, 302, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 269, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 798, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.036347762112487, "mean_inference_ms": 6.7344896233893765, "mean_action_processing_ms": 0.45982140072903943, "mean_env_wait_ms": 20.377973814353073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02872467041015625, "StateBufferConnector_ms": 0.024974584579467773, "ViewRequirementAgentConnector_ms": 0.757591724395752}}, "episode_reward_max": 132.4104014536705, "episode_reward_min": -44.78100007537291, "episode_reward_mean": 19.02653323648748, "episode_len_mean": 697.99, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.027767748611296, -44.78100007537291, 18.303355900129926, 15.843237216021542, 53.72438263395717, 10.878046004210677, 11.903373800726108, 15.289719768640996, 132.4104014536705, 12.311780181894889, 47.38218412948905, 56.53030384422987, 18.304518462312345, 34.05451966743126, 3.694716324801224, 15.283386491529281, 45.18049955634745, 33.91483967659545, 11.285805490417099, 7.870559029608938, 14.915327642172615, 34.50958967647872, 23.78320077458291, 13.518980120987226, 17.435857837636743, 15.609860259630572, 32.61860828203212, 22.574607732461185, 25.48008722708655, -10.668803281117057, 15.70299192069557, 43.746701096311604, 32.03189155345187, -11.590847524596505, 15.210550894297981, 15.850069713574808, 16.536981842770647, 10.925563173064393, 20.36109587258105, 17.3553052000681, 8.586173171131406, 23.55961797241602, 27.05569940951082, 22.273150516376827, 36.28165433015884, 22.4945915988375, 31.059705756715044, 26.897197726628047, 15.470923294566202, 20.582475339494426, 24.195213853588577, 1.0070949605279171, 2.1824239046570235, 21.51990216507576, 4.881622175122063, 3.066436488497437, 8.734375338586808, 42.85750615605188, 34.7331848718435, 20.719351276200463, 29.792614337094726, 21.240624311846364, 16.213015428064228, 17.91399026721807, 17.83224418015532, 18.89864870300026, 19.705837311464602, 15.363031881443902, -1.1759428303313693, 18.02260498412936, 29.155925204306055, 16.510496918245256, 16.291964714808536, 26.635565597969745, -17.913693171012984, 4.523237853738932, 20.194079643971072, 16.44705617483765, 18.02835716293877, 27.155247949397957, 18.504370823729044, 15.667449849568289, 13.093102195769578, 34.56031478678257, 12.731968123287045, -4.2235587957817025, 6.649017692903146, 23.55668972775261, 17.19390395505032, 25.667250393991022, 17.36807665553457, 12.863412212198305, 10.610515752074337, 17.021005887402136, -0.6942690641471977, 26.793523989072114, 12.911932588635384, 15.128074866145454, 14.802256106816, -9.864938346731186], "episode_lengths": [1117, 654, 295, 295, 1117, 295, 302, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 269, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 798, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.036347762112487, "mean_inference_ms": 6.7344896233893765, "mean_action_processing_ms": 0.45982140072903943, "mean_env_wait_ms": 20.377973814353073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02872467041015625, "StateBufferConnector_ms": 0.024974584579467773, "ViewRequirementAgentConnector_ms": 0.757591724395752}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 601753, "num_agent_steps_trained": 601753, "num_env_steps_sampled": 601753, "num_env_steps_trained": 601753, "num_env_steps_sampled_this_iter": 8743, "num_env_steps_trained_this_iter": 8743, "num_env_steps_sampled_throughput_per_sec": 192.3359224932196, "num_env_steps_trained_throughput_per_sec": 192.3359224932196, "timesteps_total": 601753, "num_steps_trained_this_iter": 8743, "agent_timesteps_total": 601753, "timers": {"training_iteration_time_ms": 47979.457, "sample_time_ms": 33230.816, "load_time_ms": 1310.447, "load_throughput": 7396.637, "learn_time_ms": 12921.934, "learn_throughput": 750.112, "synch_weights_time_ms": 442.552}, "counters": {"num_env_steps_sampled": 601753, "num_env_steps_trained": 601753, "num_agent_steps_sampled": 601753, "num_agent_steps_trained": 601753}, "done": false, "episodes_total": 914, "training_iteration": 65, "trial_id": "32ccc_00000", "date": "2025-06-07_12-50-24", "timestamp": 1749293424, "time_this_iter_s": 45.47647309303284, "time_total_s": 2945.5374648571014, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2945.5374648571014, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 52.70909090909089, "ram_util_percent": 87.67272727272729, "gpu_util_percent0": 0.17218181818181816, "vram_util_percent0": 0.9650065104166664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.398247e-05, "total_loss": -0.123325166074293, "policy_loss": -0.02696341671448733, "vf_loss": 0.06646836846534696, "vf_explained_var": 0.929066093989781, "kl": 0.010450491745558753, "entropy": 16.822288186209544, "entropy_coeff": 0.006991234999999999}, "model": {}, "num_grad_updates_lifetime": 21345.5, "diff_num_grad_updates_vs_sampler_policy": 174.5}}, "num_env_steps_sampled": 611637, "num_env_steps_trained": 611637, "num_agent_steps_sampled": 611637, "num_agent_steps_trained": 611637}, "sampler_results": {"episode_reward_max": 46.72795997830343, "episode_reward_min": -19.62664520686122, "episode_reward_mean": 17.12563418564887, "episode_len_mean": 702.55, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.694716324801224, 15.283386491529281, 45.18049955634745, 33.91483967659545, 11.285805490417099, 7.870559029608938, 14.915327642172615, 34.50958967647872, 23.78320077458291, 13.518980120987226, 17.435857837636743, 15.609860259630572, 32.61860828203212, 22.574607732461185, 25.48008722708655, -10.668803281117057, 15.70299192069557, 43.746701096311604, 32.03189155345187, -11.590847524596505, 15.210550894297981, 15.850069713574808, 16.536981842770647, 10.925563173064393, 20.36109587258105, 17.3553052000681, 8.586173171131406, 23.55961797241602, 27.05569940951082, 22.273150516376827, 36.28165433015884, 22.4945915988375, 31.059705756715044, 26.897197726628047, 15.470923294566202, 20.582475339494426, 24.195213853588577, 1.0070949605279171, 2.1824239046570235, 21.51990216507576, 4.881622175122063, 3.066436488497437, 8.734375338586808, 42.85750615605188, 34.7331848718435, 20.719351276200463, 29.792614337094726, 21.240624311846364, 16.213015428064228, 17.91399026721807, 17.83224418015532, 18.89864870300026, 19.705837311464602, 15.363031881443902, -1.1759428303313693, 18.02260498412936, 29.155925204306055, 16.510496918245256, 16.291964714808536, 26.635565597969745, -17.913693171012984, 4.523237853738932, 20.194079643971072, 16.44705617483765, 18.02835716293877, 27.155247949397957, 18.504370823729044, 15.667449849568289, 13.093102195769578, 34.56031478678257, 12.731968123287045, -4.2235587957817025, 6.649017692903146, 23.55668972775261, 17.19390395505032, 25.667250393991022, 17.36807665553457, 12.863412212198305, 10.610515752074337, 17.021005887402136, -0.6942690641471977, 26.793523989072114, 12.911932588635384, 15.128074866145454, 14.802256106816, -9.864938346731186, 24.248286432853277, 22.731524093974325, 8.992088815085216, 19.50482323084332, 3.0857622178196147, -19.62664520686122, 10.845663266498265, 15.70201204555412, 46.72795997830343, 25.840088157118334, 13.17340825931474, 17.88863719008313, 13.621904203979811, 17.35717296752555], "episode_lengths": [1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 269, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 798, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.039760349542371, "mean_inference_ms": 6.738473215472152, "mean_action_processing_ms": 0.46037603770487634, "mean_env_wait_ms": 20.389705044341298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02974414825439453, "StateBufferConnector_ms": 0.024977445602416992, "ViewRequirementAgentConnector_ms": 0.7713589668273926}}, "episode_reward_max": 46.72795997830343, "episode_reward_min": -19.62664520686122, "episode_reward_mean": 17.12563418564887, "episode_len_mean": 702.55, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.694716324801224, 15.283386491529281, 45.18049955634745, 33.91483967659545, 11.285805490417099, 7.870559029608938, 14.915327642172615, 34.50958967647872, 23.78320077458291, 13.518980120987226, 17.435857837636743, 15.609860259630572, 32.61860828203212, 22.574607732461185, 25.48008722708655, -10.668803281117057, 15.70299192069557, 43.746701096311604, 32.03189155345187, -11.590847524596505, 15.210550894297981, 15.850069713574808, 16.536981842770647, 10.925563173064393, 20.36109587258105, 17.3553052000681, 8.586173171131406, 23.55961797241602, 27.05569940951082, 22.273150516376827, 36.28165433015884, 22.4945915988375, 31.059705756715044, 26.897197726628047, 15.470923294566202, 20.582475339494426, 24.195213853588577, 1.0070949605279171, 2.1824239046570235, 21.51990216507576, 4.881622175122063, 3.066436488497437, 8.734375338586808, 42.85750615605188, 34.7331848718435, 20.719351276200463, 29.792614337094726, 21.240624311846364, 16.213015428064228, 17.91399026721807, 17.83224418015532, 18.89864870300026, 19.705837311464602, 15.363031881443902, -1.1759428303313693, 18.02260498412936, 29.155925204306055, 16.510496918245256, 16.291964714808536, 26.635565597969745, -17.913693171012984, 4.523237853738932, 20.194079643971072, 16.44705617483765, 18.02835716293877, 27.155247949397957, 18.504370823729044, 15.667449849568289, 13.093102195769578, 34.56031478678257, 12.731968123287045, -4.2235587957817025, 6.649017692903146, 23.55668972775261, 17.19390395505032, 25.667250393991022, 17.36807665553457, 12.863412212198305, 10.610515752074337, 17.021005887402136, -0.6942690641471977, 26.793523989072114, 12.911932588635384, 15.128074866145454, 14.802256106816, -9.864938346731186, 24.248286432853277, 22.731524093974325, 8.992088815085216, 19.50482323084332, 3.0857622178196147, -19.62664520686122, 10.845663266498265, 15.70201204555412, 46.72795997830343, 25.840088157118334, 13.17340825931474, 17.88863719008313, 13.621904203979811, 17.35717296752555], "episode_lengths": [1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 269, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 798, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.039760349542371, "mean_inference_ms": 6.738473215472152, "mean_action_processing_ms": 0.46037603770487634, "mean_env_wait_ms": 20.389705044341298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02974414825439453, "StateBufferConnector_ms": 0.024977445602416992, "ViewRequirementAgentConnector_ms": 0.7713589668273926}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 611637, "num_agent_steps_trained": 611637, "num_env_steps_sampled": 611637, "num_env_steps_trained": 611637, "num_env_steps_sampled_this_iter": 9884, "num_env_steps_trained_this_iter": 9884, "num_env_steps_sampled_throughput_per_sec": 202.93965890541665, "num_env_steps_trained_throughput_per_sec": 202.93965890541665, "timesteps_total": 611637, "num_steps_trained_this_iter": 9884, "agent_timesteps_total": 611637, "timers": {"training_iteration_time_ms": 47916.186, "sample_time_ms": 33231.689, "load_time_ms": 1305.437, "load_throughput": 7420.199, "learn_time_ms": 12860.154, "learn_throughput": 753.226, "synch_weights_time_ms": 444.516}, "counters": {"num_env_steps_sampled": 611637, "num_env_steps_trained": 611637, "num_agent_steps_sampled": 611637, "num_agent_steps_trained": 611637}, "done": false, "episodes_total": 928, "training_iteration": 66, "trial_id": "32ccc_00000", "date": "2025-06-07_12-51-13", "timestamp": 1749293473, "time_this_iter_s": 48.720040798187256, "time_total_s": 2994.2575056552887, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2994.2575056552887, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 56.14655172413792, "ram_util_percent": 88.3862068965517, "gpu_util_percent0": 0.17741379310344826, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.388363e-05, "total_loss": -0.12204727316566277, "policy_loss": -0.02760150389149203, "vf_loss": 0.06739193553221412, "vf_explained_var": 0.9484294809401035, "kl": 0.010432175207643012, "entropy": 16.705627632141113, "entropy_coeff": 0.006941815000000002}, "model": {}, "num_grad_updates_lifetime": 21680.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 620699, "num_env_steps_trained": 620699, "num_agent_steps_sampled": 620699, "num_agent_steps_trained": 620699}, "sampler_results": {"episode_reward_max": 50.16345846309753, "episode_reward_min": -50.790181597830674, "episode_reward_mean": 16.86710968757481, "episode_len_mean": 694.33, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.48008722708655, -10.668803281117057, 15.70299192069557, 43.746701096311604, 32.03189155345187, -11.590847524596505, 15.210550894297981, 15.850069713574808, 16.536981842770647, 10.925563173064393, 20.36109587258105, 17.3553052000681, 8.586173171131406, 23.55961797241602, 27.05569940951082, 22.273150516376827, 36.28165433015884, 22.4945915988375, 31.059705756715044, 26.897197726628047, 15.470923294566202, 20.582475339494426, 24.195213853588577, 1.0070949605279171, 2.1824239046570235, 21.51990216507576, 4.881622175122063, 3.066436488497437, 8.734375338586808, 42.85750615605188, 34.7331848718435, 20.719351276200463, 29.792614337094726, 21.240624311846364, 16.213015428064228, 17.91399026721807, 17.83224418015532, 18.89864870300026, 19.705837311464602, 15.363031881443902, -1.1759428303313693, 18.02260498412936, 29.155925204306055, 16.510496918245256, 16.291964714808536, 26.635565597969745, -17.913693171012984, 4.523237853738932, 20.194079643971072, 16.44705617483765, 18.02835716293877, 27.155247949397957, 18.504370823729044, 15.667449849568289, 13.093102195769578, 34.56031478678257, 12.731968123287045, -4.2235587957817025, 6.649017692903146, 23.55668972775261, 17.19390395505032, 25.667250393991022, 17.36807665553457, 12.863412212198305, 10.610515752074337, 17.021005887402136, -0.6942690641471977, 26.793523989072114, 12.911932588635384, 15.128074866145454, 14.802256106816, -9.864938346731186, 24.248286432853277, 22.731524093974325, 8.992088815085216, 19.50482323084332, 3.0857622178196147, -19.62664520686122, 10.845663266498265, 15.70201204555412, 46.72795997830343, 25.840088157118334, 13.17340825931474, 17.88863719008313, 13.621904203979811, 17.35717296752555, 30.890890769043605, 40.20041504173627, 17.359261126281467, 22.375061071550515, 20.066726592045086, 19.69936313688327, 27.014466936606084, 10.424920342584548, 16.88120741713475, 20.32276766934651, 50.16345846309753, -50.790181597830674, 11.77801109111337, 29.95702102828292], "episode_lengths": [1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 269, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 798, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0427909967712203, "mean_inference_ms": 6.7421569791063245, "mean_action_processing_ms": 0.4609577121409994, "mean_env_wait_ms": 20.400975458908547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028779983520507812, "StateBufferConnector_ms": 0.02970409393310547, "ViewRequirementAgentConnector_ms": 0.7840723991394043}}, "episode_reward_max": 50.16345846309753, "episode_reward_min": -50.790181597830674, "episode_reward_mean": 16.86710968757481, "episode_len_mean": 694.33, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.48008722708655, -10.668803281117057, 15.70299192069557, 43.746701096311604, 32.03189155345187, -11.590847524596505, 15.210550894297981, 15.850069713574808, 16.536981842770647, 10.925563173064393, 20.36109587258105, 17.3553052000681, 8.586173171131406, 23.55961797241602, 27.05569940951082, 22.273150516376827, 36.28165433015884, 22.4945915988375, 31.059705756715044, 26.897197726628047, 15.470923294566202, 20.582475339494426, 24.195213853588577, 1.0070949605279171, 2.1824239046570235, 21.51990216507576, 4.881622175122063, 3.066436488497437, 8.734375338586808, 42.85750615605188, 34.7331848718435, 20.719351276200463, 29.792614337094726, 21.240624311846364, 16.213015428064228, 17.91399026721807, 17.83224418015532, 18.89864870300026, 19.705837311464602, 15.363031881443902, -1.1759428303313693, 18.02260498412936, 29.155925204306055, 16.510496918245256, 16.291964714808536, 26.635565597969745, -17.913693171012984, 4.523237853738932, 20.194079643971072, 16.44705617483765, 18.02835716293877, 27.155247949397957, 18.504370823729044, 15.667449849568289, 13.093102195769578, 34.56031478678257, 12.731968123287045, -4.2235587957817025, 6.649017692903146, 23.55668972775261, 17.19390395505032, 25.667250393991022, 17.36807665553457, 12.863412212198305, 10.610515752074337, 17.021005887402136, -0.6942690641471977, 26.793523989072114, 12.911932588635384, 15.128074866145454, 14.802256106816, -9.864938346731186, 24.248286432853277, 22.731524093974325, 8.992088815085216, 19.50482323084332, 3.0857622178196147, -19.62664520686122, 10.845663266498265, 15.70201204555412, 46.72795997830343, 25.840088157118334, 13.17340825931474, 17.88863719008313, 13.621904203979811, 17.35717296752555, 30.890890769043605, 40.20041504173627, 17.359261126281467, 22.375061071550515, 20.066726592045086, 19.69936313688327, 27.014466936606084, 10.424920342584548, 16.88120741713475, 20.32276766934651, 50.16345846309753, -50.790181597830674, 11.77801109111337, 29.95702102828292], "episode_lengths": [1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 269, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 798, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0427909967712203, "mean_inference_ms": 6.7421569791063245, "mean_action_processing_ms": 0.4609577121409994, "mean_env_wait_ms": 20.400975458908547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028779983520507812, "StateBufferConnector_ms": 0.02970409393310547, "ViewRequirementAgentConnector_ms": 0.7840723991394043}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 620699, "num_agent_steps_trained": 620699, "num_env_steps_sampled": 620699, "num_env_steps_trained": 620699, "num_env_steps_sampled_this_iter": 9062, "num_env_steps_trained_this_iter": 9062, "num_env_steps_sampled_throughput_per_sec": 193.15790162472697, "num_env_steps_trained_throughput_per_sec": 193.15790162472697, "timesteps_total": 620699, "num_steps_trained_this_iter": 9062, "agent_timesteps_total": 620699, "timers": {"training_iteration_time_ms": 48333.218, "sample_time_ms": 33427.753, "load_time_ms": 1323.961, "load_throughput": 7404.976, "learn_time_ms": 13057.16, "learn_throughput": 750.845, "synch_weights_time_ms": 443.976}, "counters": {"num_env_steps_sampled": 620699, "num_env_steps_trained": 620699, "num_agent_steps_sampled": 620699, "num_agent_steps_trained": 620699}, "done": false, "episodes_total": 942, "training_iteration": 67, "trial_id": "32ccc_00000", "date": "2025-06-07_12-52-00", "timestamp": 1749293520, "time_this_iter_s": 46.93000149726868, "time_total_s": 3041.1875071525574, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3041.1875071525574, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 54.007017543859654, "ram_util_percent": 88.42105263157895, "gpu_util_percent0": 0.1626315789473684, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.379300999999999e-05, "total_loss": -0.1317597858905792, "policy_loss": -0.039254954259842635, "vf_loss": 0.07386554147303104, "vf_explained_var": 0.9279823365211487, "kl": 0.01101572456964641, "entropy": 16.826125549316405, "entropy_coeff": 0.006896504999999999}, "model": {}, "num_grad_updates_lifetime": 21965.5, "diff_num_grad_updates_vs_sampler_policy": 124.5}}, "num_env_steps_sampled": 627799, "num_env_steps_trained": 627799, "num_agent_steps_sampled": 627799, "num_agent_steps_trained": 627799}, "sampler_results": {"episode_reward_max": 50.16345846309753, "episode_reward_min": -50.80062867098016, "episode_reward_mean": 15.891735269814184, "episode_len_mean": 658.27, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.05569940951082, 22.273150516376827, 36.28165433015884, 22.4945915988375, 31.059705756715044, 26.897197726628047, 15.470923294566202, 20.582475339494426, 24.195213853588577, 1.0070949605279171, 2.1824239046570235, 21.51990216507576, 4.881622175122063, 3.066436488497437, 8.734375338586808, 42.85750615605188, 34.7331848718435, 20.719351276200463, 29.792614337094726, 21.240624311846364, 16.213015428064228, 17.91399026721807, 17.83224418015532, 18.89864870300026, 19.705837311464602, 15.363031881443902, -1.1759428303313693, 18.02260498412936, 29.155925204306055, 16.510496918245256, 16.291964714808536, 26.635565597969745, -17.913693171012984, 4.523237853738932, 20.194079643971072, 16.44705617483765, 18.02835716293877, 27.155247949397957, 18.504370823729044, 15.667449849568289, 13.093102195769578, 34.56031478678257, 12.731968123287045, -4.2235587957817025, 6.649017692903146, 23.55668972775261, 17.19390395505032, 25.667250393991022, 17.36807665553457, 12.863412212198305, 10.610515752074337, 17.021005887402136, -0.6942690641471977, 26.793523989072114, 12.911932588635384, 15.128074866145454, 14.802256106816, -9.864938346731186, 24.248286432853277, 22.731524093974325, 8.992088815085216, 19.50482323084332, 3.0857622178196147, -19.62664520686122, 10.845663266498265, 15.70201204555412, 46.72795997830343, 25.840088157118334, 13.17340825931474, 17.88863719008313, 13.621904203979811, 17.35717296752555, 30.890890769043605, 40.20041504173627, 17.359261126281467, 22.375061071550515, 20.066726592045086, 19.69936313688327, 27.014466936606084, 10.424920342584548, 16.88120741713475, 20.32276766934651, 50.16345846309753, -50.790181597830674, 11.77801109111337, 29.95702102828292, 22.773998223128608, 28.326533157965574, 17.72861871770742, 23.07387158101775, 12.236450523112909, 19.044331997141732, 19.72062242631033, 13.570723859997091, -9.915509220950614, 20.539594227532987, -19.898095380992913, 13.138620400735263, 16.0108052139477, -50.80062867098016], "episode_lengths": [1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 269, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 798, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 295, 799]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0456077671056754, "mean_inference_ms": 6.745686683278868, "mean_action_processing_ms": 0.4614994999424018, "mean_env_wait_ms": 20.410709577248543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030768156051635742, "StateBufferConnector_ms": 0.029855966567993164, "ViewRequirementAgentConnector_ms": 0.8064620494842529}}, "episode_reward_max": 50.16345846309753, "episode_reward_min": -50.80062867098016, "episode_reward_mean": 15.891735269814184, "episode_len_mean": 658.27, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.05569940951082, 22.273150516376827, 36.28165433015884, 22.4945915988375, 31.059705756715044, 26.897197726628047, 15.470923294566202, 20.582475339494426, 24.195213853588577, 1.0070949605279171, 2.1824239046570235, 21.51990216507576, 4.881622175122063, 3.066436488497437, 8.734375338586808, 42.85750615605188, 34.7331848718435, 20.719351276200463, 29.792614337094726, 21.240624311846364, 16.213015428064228, 17.91399026721807, 17.83224418015532, 18.89864870300026, 19.705837311464602, 15.363031881443902, -1.1759428303313693, 18.02260498412936, 29.155925204306055, 16.510496918245256, 16.291964714808536, 26.635565597969745, -17.913693171012984, 4.523237853738932, 20.194079643971072, 16.44705617483765, 18.02835716293877, 27.155247949397957, 18.504370823729044, 15.667449849568289, 13.093102195769578, 34.56031478678257, 12.731968123287045, -4.2235587957817025, 6.649017692903146, 23.55668972775261, 17.19390395505032, 25.667250393991022, 17.36807665553457, 12.863412212198305, 10.610515752074337, 17.021005887402136, -0.6942690641471977, 26.793523989072114, 12.911932588635384, 15.128074866145454, 14.802256106816, -9.864938346731186, 24.248286432853277, 22.731524093974325, 8.992088815085216, 19.50482323084332, 3.0857622178196147, -19.62664520686122, 10.845663266498265, 15.70201204555412, 46.72795997830343, 25.840088157118334, 13.17340825931474, 17.88863719008313, 13.621904203979811, 17.35717296752555, 30.890890769043605, 40.20041504173627, 17.359261126281467, 22.375061071550515, 20.066726592045086, 19.69936313688327, 27.014466936606084, 10.424920342584548, 16.88120741713475, 20.32276766934651, 50.16345846309753, -50.790181597830674, 11.77801109111337, 29.95702102828292, 22.773998223128608, 28.326533157965574, 17.72861871770742, 23.07387158101775, 12.236450523112909, 19.044331997141732, 19.72062242631033, 13.570723859997091, -9.915509220950614, 20.539594227532987, -19.898095380992913, 13.138620400735263, 16.0108052139477, -50.80062867098016], "episode_lengths": [1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 269, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 798, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 295, 799]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0456077671056754, "mean_inference_ms": 6.745686683278868, "mean_action_processing_ms": 0.4614994999424018, "mean_env_wait_ms": 20.410709577248543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030768156051635742, "StateBufferConnector_ms": 0.029855966567993164, "ViewRequirementAgentConnector_ms": 0.8064620494842529}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 627799, "num_agent_steps_trained": 627799, "num_env_steps_sampled": 627799, "num_env_steps_trained": 627799, "num_env_steps_sampled_this_iter": 7100, "num_env_steps_trained_this_iter": 7100, "num_env_steps_sampled_throughput_per_sec": 191.83523229838946, "num_env_steps_trained_throughput_per_sec": 191.83523229838946, "timesteps_total": 627799, "num_steps_trained_this_iter": 7100, "agent_timesteps_total": 627799, "timers": {"training_iteration_time_ms": 46743.529, "sample_time_ms": 32923.923, "load_time_ms": 1257.826, "load_throughput": 7479.092, "learn_time_ms": 12039.168, "learn_throughput": 781.4, "synch_weights_time_ms": 445.358}, "counters": {"num_env_steps_sampled": 627799, "num_env_steps_trained": 627799, "num_agent_steps_sampled": 627799, "num_agent_steps_trained": 627799}, "done": false, "episodes_total": 956, "training_iteration": 68, "trial_id": "32ccc_00000", "date": "2025-06-07_12-52-37", "timestamp": 1749293557, "time_this_iter_s": 37.2337327003479, "time_total_s": 3078.4212398529053, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3078.4212398529053, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 52.781818181818196, "ram_util_percent": 87.6659090909091, "gpu_util_percent0": 0.06272727272727273, "vram_util_percent0": 0.9650065104166664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.372201000000002e-05, "total_loss": -0.12035685722302232, "policy_loss": -0.02662112536046253, "vf_loss": 0.06776466333669506, "vf_explained_var": 0.9322104793455865, "kl": 0.010973360478401138, "entropy": 16.8250574959649, "entropy_coeff": 0.0068610050000000025}, "model": {}, "num_grad_updates_lifetime": 22270.5, "diff_num_grad_updates_vs_sampler_policy": 179.5}}, "num_env_steps_sampled": 638041, "num_env_steps_trained": 638041, "num_agent_steps_sampled": 638041, "num_agent_steps_trained": 638041}, "sampler_results": {"episode_reward_max": 50.16345846309753, "episode_reward_min": -50.80062867098016, "episode_reward_mean": 15.379069933376893, "episode_len_mean": 628.97, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.734375338586808, 42.85750615605188, 34.7331848718435, 20.719351276200463, 29.792614337094726, 21.240624311846364, 16.213015428064228, 17.91399026721807, 17.83224418015532, 18.89864870300026, 19.705837311464602, 15.363031881443902, -1.1759428303313693, 18.02260498412936, 29.155925204306055, 16.510496918245256, 16.291964714808536, 26.635565597969745, -17.913693171012984, 4.523237853738932, 20.194079643971072, 16.44705617483765, 18.02835716293877, 27.155247949397957, 18.504370823729044, 15.667449849568289, 13.093102195769578, 34.56031478678257, 12.731968123287045, -4.2235587957817025, 6.649017692903146, 23.55668972775261, 17.19390395505032, 25.667250393991022, 17.36807665553457, 12.863412212198305, 10.610515752074337, 17.021005887402136, -0.6942690641471977, 26.793523989072114, 12.911932588635384, 15.128074866145454, 14.802256106816, -9.864938346731186, 24.248286432853277, 22.731524093974325, 8.992088815085216, 19.50482323084332, 3.0857622178196147, -19.62664520686122, 10.845663266498265, 15.70201204555412, 46.72795997830343, 25.840088157118334, 13.17340825931474, 17.88863719008313, 13.621904203979811, 17.35717296752555, 30.890890769043605, 40.20041504173627, 17.359261126281467, 22.375061071550515, 20.066726592045086, 19.69936313688327, 27.014466936606084, 10.424920342584548, 16.88120741713475, 20.32276766934651, 50.16345846309753, -50.790181597830674, 11.77801109111337, 29.95702102828292, 22.773998223128608, 28.326533157965574, 17.72861871770742, 23.07387158101775, 12.236450523112909, 19.044331997141732, 19.72062242631033, 13.570723859997091, -9.915509220950614, 20.539594227532987, -19.898095380992913, 13.138620400735263, 16.0108052139477, -50.80062867098016, -37.676745207614374, 22.12289834960038, 14.63894768229235, 22.76684528042297, 18.131355550621606, 20.42645148256828, -2.102498077906365, 17.401623519696955, 37.61229404525038, 16.78307321572828, 13.667995184824482, 24.884838561822345, 22.31596547145775, 16.72851281726259], "episode_lengths": [295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 269, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 798, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 295, 799, 653, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0473503167023703, "mean_inference_ms": 6.748425667225672, "mean_action_processing_ms": 0.4619442225680214, "mean_env_wait_ms": 20.417978675371057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03178715705871582, "StateBufferConnector_ms": 0.03954648971557617, "ViewRequirementAgentConnector_ms": 0.7980341911315918}}, "episode_reward_max": 50.16345846309753, "episode_reward_min": -50.80062867098016, "episode_reward_mean": 15.379069933376893, "episode_len_mean": 628.97, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.734375338586808, 42.85750615605188, 34.7331848718435, 20.719351276200463, 29.792614337094726, 21.240624311846364, 16.213015428064228, 17.91399026721807, 17.83224418015532, 18.89864870300026, 19.705837311464602, 15.363031881443902, -1.1759428303313693, 18.02260498412936, 29.155925204306055, 16.510496918245256, 16.291964714808536, 26.635565597969745, -17.913693171012984, 4.523237853738932, 20.194079643971072, 16.44705617483765, 18.02835716293877, 27.155247949397957, 18.504370823729044, 15.667449849568289, 13.093102195769578, 34.56031478678257, 12.731968123287045, -4.2235587957817025, 6.649017692903146, 23.55668972775261, 17.19390395505032, 25.667250393991022, 17.36807665553457, 12.863412212198305, 10.610515752074337, 17.021005887402136, -0.6942690641471977, 26.793523989072114, 12.911932588635384, 15.128074866145454, 14.802256106816, -9.864938346731186, 24.248286432853277, 22.731524093974325, 8.992088815085216, 19.50482323084332, 3.0857622178196147, -19.62664520686122, 10.845663266498265, 15.70201204555412, 46.72795997830343, 25.840088157118334, 13.17340825931474, 17.88863719008313, 13.621904203979811, 17.35717296752555, 30.890890769043605, 40.20041504173627, 17.359261126281467, 22.375061071550515, 20.066726592045086, 19.69936313688327, 27.014466936606084, 10.424920342584548, 16.88120741713475, 20.32276766934651, 50.16345846309753, -50.790181597830674, 11.77801109111337, 29.95702102828292, 22.773998223128608, 28.326533157965574, 17.72861871770742, 23.07387158101775, 12.236450523112909, 19.044331997141732, 19.72062242631033, 13.570723859997091, -9.915509220950614, 20.539594227532987, -19.898095380992913, 13.138620400735263, 16.0108052139477, -50.80062867098016, -37.676745207614374, 22.12289834960038, 14.63894768229235, 22.76684528042297, 18.131355550621606, 20.42645148256828, -2.102498077906365, 17.401623519696955, 37.61229404525038, 16.78307321572828, 13.667995184824482, 24.884838561822345, 22.31596547145775, 16.72851281726259], "episode_lengths": [295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 269, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 798, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 295, 799, 653, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0473503167023703, "mean_inference_ms": 6.748425667225672, "mean_action_processing_ms": 0.4619442225680214, "mean_env_wait_ms": 20.417978675371057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03178715705871582, "StateBufferConnector_ms": 0.03954648971557617, "ViewRequirementAgentConnector_ms": 0.7980341911315918}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 638041, "num_agent_steps_trained": 638041, "num_env_steps_sampled": 638041, "num_env_steps_trained": 638041, "num_env_steps_sampled_this_iter": 10242, "num_env_steps_trained_this_iter": 10242, "num_env_steps_sampled_throughput_per_sec": 204.47980134633463, "num_env_steps_trained_throughput_per_sec": 204.47980134633463, "timesteps_total": 638041, "num_steps_trained_this_iter": 10242, "agent_timesteps_total": 638041, "timers": {"training_iteration_time_ms": 47121.35, "sample_time_ms": 33067.906, "load_time_ms": 1268.707, "load_throughput": 7507.409, "learn_time_ms": 12267.756, "learn_throughput": 776.401, "synch_weights_time_ms": 439.312}, "counters": {"num_env_steps_sampled": 638041, "num_env_steps_trained": 638041, "num_agent_steps_sampled": 638041, "num_agent_steps_trained": 638041}, "done": false, "episodes_total": 970, "training_iteration": 69, "trial_id": "32ccc_00000", "date": "2025-06-07_12-53-28", "timestamp": 1749293608, "time_this_iter_s": 50.1198616027832, "time_total_s": 3128.5411014556885, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3128.5411014556885, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 56.25666666666666, "ram_util_percent": 88.56166666666667, "gpu_util_percent0": 0.18383333333333335, "vram_util_percent0": 0.9650065104166665}}
{"evaluation": {"sampler_results": {"episode_reward_max": -0.3488952902962392, "episode_reward_min": -2.7466901752951896, "episode_reward_mean": -1.4423651108841202, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3488952902962392, -1.769902236507983, -0.9480574437517983, -1.3982804085693905, -2.7466901752951896], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5644263525294917, "mean_inference_ms": 3.6329398001967115, "mean_action_processing_ms": 0.26602064706286815, "mean_env_wait_ms": 10.988329345627317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04017353057861328, "StateBufferConnector_ms": 0.020008087158203125, "ViewRequirementAgentConnector_ms": 0.5453777313232422}}, "episode_reward_max": -0.3488952902962392, "episode_reward_min": -2.7466901752951896, "episode_reward_mean": -1.4423651108841202, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3488952902962392, -1.769902236507983, -0.9480574437517983, -1.3982804085693905, -2.7466901752951896], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5644263525294917, "mean_inference_ms": 3.6329398001967115, "mean_action_processing_ms": 0.26602064706286815, "mean_env_wait_ms": 10.988329345627317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04017353057861328, "StateBufferConnector_ms": 0.020008087158203125, "ViewRequirementAgentConnector_ms": 0.5453777313232422}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.361959000000001e-05, "total_loss": -0.12248407070192376, "policy_loss": -0.027135947568063524, "vf_loss": 0.0587109359752919, "vf_explained_var": 0.9407140341826847, "kl": 0.010965000874275575, "entropy": 16.789350357055664, "entropy_coeff": 0.006809794999999999}, "model": {}, "num_grad_updates_lifetime": 22625.5, "diff_num_grad_updates_vs_sampler_policy": 174.5}}, "num_env_steps_sampled": 647925, "num_env_steps_trained": 647925, "num_agent_steps_sampled": 647925, "num_agent_steps_trained": 647925}, "sampler_results": {"episode_reward_max": 50.16345846309753, "episode_reward_min": -50.80062867098016, "episode_reward_mean": 14.985536918640186, "episode_len_mean": 645.67, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.155925204306055, 16.510496918245256, 16.291964714808536, 26.635565597969745, -17.913693171012984, 4.523237853738932, 20.194079643971072, 16.44705617483765, 18.02835716293877, 27.155247949397957, 18.504370823729044, 15.667449849568289, 13.093102195769578, 34.56031478678257, 12.731968123287045, -4.2235587957817025, 6.649017692903146, 23.55668972775261, 17.19390395505032, 25.667250393991022, 17.36807665553457, 12.863412212198305, 10.610515752074337, 17.021005887402136, -0.6942690641471977, 26.793523989072114, 12.911932588635384, 15.128074866145454, 14.802256106816, -9.864938346731186, 24.248286432853277, 22.731524093974325, 8.992088815085216, 19.50482323084332, 3.0857622178196147, -19.62664520686122, 10.845663266498265, 15.70201204555412, 46.72795997830343, 25.840088157118334, 13.17340825931474, 17.88863719008313, 13.621904203979811, 17.35717296752555, 30.890890769043605, 40.20041504173627, 17.359261126281467, 22.375061071550515, 20.066726592045086, 19.69936313688327, 27.014466936606084, 10.424920342584548, 16.88120741713475, 20.32276766934651, 50.16345846309753, -50.790181597830674, 11.77801109111337, 29.95702102828292, 22.773998223128608, 28.326533157965574, 17.72861871770742, 23.07387158101775, 12.236450523112909, 19.044331997141732, 19.72062242631033, 13.570723859997091, -9.915509220950614, 20.539594227532987, -19.898095380992913, 13.138620400735263, 16.0108052139477, -50.80062867098016, -37.676745207614374, 22.12289834960038, 14.63894768229235, 22.76684528042297, 18.131355550621606, 20.42645148256828, -2.102498077906365, 17.401623519696955, 37.61229404525038, 16.78307321572828, 13.667995184824482, 24.884838561822345, 22.31596547145775, 16.72851281726259, 19.44740040710006, 20.22120436421648, 17.252447398361927, 25.61080928629018, 14.823464491533292, 16.3156020079858, 15.428567855260443, 18.294231247629142, 31.17016131712104, 25.877139450678403, 5.638631824007912, 19.250357440829404, -19.05293348990431, 31.22070114198745], "episode_lengths": [1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 798, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 295, 799, 653, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.049195571187642, "mean_inference_ms": 6.750656605013162, "mean_action_processing_ms": 0.4623620017112191, "mean_env_wait_ms": 20.424510741222385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02810955047607422, "StateBufferConnector_ms": 0.040497779846191406, "ViewRequirementAgentConnector_ms": 0.8246018886566162}}, "episode_reward_max": 50.16345846309753, "episode_reward_min": -50.80062867098016, "episode_reward_mean": 14.985536918640186, "episode_len_mean": 645.67, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.155925204306055, 16.510496918245256, 16.291964714808536, 26.635565597969745, -17.913693171012984, 4.523237853738932, 20.194079643971072, 16.44705617483765, 18.02835716293877, 27.155247949397957, 18.504370823729044, 15.667449849568289, 13.093102195769578, 34.56031478678257, 12.731968123287045, -4.2235587957817025, 6.649017692903146, 23.55668972775261, 17.19390395505032, 25.667250393991022, 17.36807665553457, 12.863412212198305, 10.610515752074337, 17.021005887402136, -0.6942690641471977, 26.793523989072114, 12.911932588635384, 15.128074866145454, 14.802256106816, -9.864938346731186, 24.248286432853277, 22.731524093974325, 8.992088815085216, 19.50482323084332, 3.0857622178196147, -19.62664520686122, 10.845663266498265, 15.70201204555412, 46.72795997830343, 25.840088157118334, 13.17340825931474, 17.88863719008313, 13.621904203979811, 17.35717296752555, 30.890890769043605, 40.20041504173627, 17.359261126281467, 22.375061071550515, 20.066726592045086, 19.69936313688327, 27.014466936606084, 10.424920342584548, 16.88120741713475, 20.32276766934651, 50.16345846309753, -50.790181597830674, 11.77801109111337, 29.95702102828292, 22.773998223128608, 28.326533157965574, 17.72861871770742, 23.07387158101775, 12.236450523112909, 19.044331997141732, 19.72062242631033, 13.570723859997091, -9.915509220950614, 20.539594227532987, -19.898095380992913, 13.138620400735263, 16.0108052139477, -50.80062867098016, -37.676745207614374, 22.12289834960038, 14.63894768229235, 22.76684528042297, 18.131355550621606, 20.42645148256828, -2.102498077906365, 17.401623519696955, 37.61229404525038, 16.78307321572828, 13.667995184824482, 24.884838561822345, 22.31596547145775, 16.72851281726259, 19.44740040710006, 20.22120436421648, 17.252447398361927, 25.61080928629018, 14.823464491533292, 16.3156020079858, 15.428567855260443, 18.294231247629142, 31.17016131712104, 25.877139450678403, 5.638631824007912, 19.250357440829404, -19.05293348990431, 31.22070114198745], "episode_lengths": [1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 798, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 295, 799, 653, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.049195571187642, "mean_inference_ms": 6.750656605013162, "mean_action_processing_ms": 0.4623620017112191, "mean_env_wait_ms": 20.424510741222385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02810955047607422, "StateBufferConnector_ms": 0.040497779846191406, "ViewRequirementAgentConnector_ms": 0.8246018886566162}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 647925, "num_agent_steps_trained": 647925, "num_env_steps_sampled": 647925, "num_env_steps_trained": 647925, "num_env_steps_sampled_this_iter": 9884, "num_env_steps_trained_this_iter": 9884, "num_env_steps_sampled_throughput_per_sec": 206.59887523281526, "num_env_steps_trained_throughput_per_sec": 206.59887523281526, "timesteps_total": 647925, "num_steps_trained_this_iter": 9884, "agent_timesteps_total": 647925, "timers": {"training_iteration_time_ms": 46842.858, "sample_time_ms": 32977.977, "load_time_ms": 1229.586, "load_throughput": 7679.414, "learn_time_ms": 12116.259, "learn_throughput": 779.325, "synch_weights_time_ms": 443.047}, "counters": {"num_env_steps_sampled": 647925, "num_env_steps_trained": 647925, "num_agent_steps_sampled": 647925, "num_agent_steps_trained": 647925}, "done": false, "episodes_total": 984, "training_iteration": 70, "trial_id": "32ccc_00000", "date": "2025-06-07_12-54-33", "timestamp": 1749293673, "time_this_iter_s": 64.75520849227905, "time_total_s": 3193.2963099479675, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3193.2963099479675, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 47.13544303797468, "ram_util_percent": 88.96708860759492, "gpu_util_percent0": 0.12658227848101267, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.352074999999998e-05, "total_loss": -0.12071435063899982, "policy_loss": -0.03056673908694869, "vf_loss": 0.06691165122070483, "vf_explained_var": 0.9494489476794288, "kl": 0.009538364819378503, "entropy": 16.480358232770648, "entropy_coeff": 0.006760375000000001}, "model": {}, "num_grad_updates_lifetime": 22905.5, "diff_num_grad_updates_vs_sampler_policy": 104.5}}, "num_env_steps_sampled": 653810, "num_env_steps_trained": 653810, "num_agent_steps_sampled": 653810, "num_agent_steps_trained": 653810}, "sampler_results": {"episode_reward_max": 50.16345846309753, "episode_reward_min": -50.80062867098016, "episode_reward_mean": 14.76572586181806, "episode_len_mean": 622.12, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.731968123287045, -4.2235587957817025, 6.649017692903146, 23.55668972775261, 17.19390395505032, 25.667250393991022, 17.36807665553457, 12.863412212198305, 10.610515752074337, 17.021005887402136, -0.6942690641471977, 26.793523989072114, 12.911932588635384, 15.128074866145454, 14.802256106816, -9.864938346731186, 24.248286432853277, 22.731524093974325, 8.992088815085216, 19.50482323084332, 3.0857622178196147, -19.62664520686122, 10.845663266498265, 15.70201204555412, 46.72795997830343, 25.840088157118334, 13.17340825931474, 17.88863719008313, 13.621904203979811, 17.35717296752555, 30.890890769043605, 40.20041504173627, 17.359261126281467, 22.375061071550515, 20.066726592045086, 19.69936313688327, 27.014466936606084, 10.424920342584548, 16.88120741713475, 20.32276766934651, 50.16345846309753, -50.790181597830674, 11.77801109111337, 29.95702102828292, 22.773998223128608, 28.326533157965574, 17.72861871770742, 23.07387158101775, 12.236450523112909, 19.044331997141732, 19.72062242631033, 13.570723859997091, -9.915509220950614, 20.539594227532987, -19.898095380992913, 13.138620400735263, 16.0108052139477, -50.80062867098016, -37.676745207614374, 22.12289834960038, 14.63894768229235, 22.76684528042297, 18.131355550621606, 20.42645148256828, -2.102498077906365, 17.401623519696955, 37.61229404525038, 16.78307321572828, 13.667995184824482, 24.884838561822345, 22.31596547145775, 16.72851281726259, 19.44740040710006, 20.22120436421648, 17.252447398361927, 25.61080928629018, 14.823464491533292, 16.3156020079858, 15.428567855260443, 18.294231247629142, 31.17016131712104, 25.877139450678403, 5.638631824007912, 19.250357440829404, -19.05293348990431, 31.22070114198745, -25.249081459737326, 22.000974519495784, 13.348441651179119, 15.308338252577595, 26.006386193676388, 18.531716602360024, 34.019995444901596, 13.703787746955529, 17.58857611969182, 15.891234822233113, 10.300801408452926, 20.644433135519655, 19.35107355491183, 15.425692030619675], "episode_lengths": [295, 1117, 798, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 295, 799, 653, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 406, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.051339414056557, "mean_inference_ms": 6.753293274342958, "mean_action_processing_ms": 0.46277021776955296, "mean_env_wait_ms": 20.43176576322186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026091575622558594, "StateBufferConnector_ms": 0.04149675369262695, "ViewRequirementAgentConnector_ms": 0.8321347236633301}}, "episode_reward_max": 50.16345846309753, "episode_reward_min": -50.80062867098016, "episode_reward_mean": 14.76572586181806, "episode_len_mean": 622.12, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.731968123287045, -4.2235587957817025, 6.649017692903146, 23.55668972775261, 17.19390395505032, 25.667250393991022, 17.36807665553457, 12.863412212198305, 10.610515752074337, 17.021005887402136, -0.6942690641471977, 26.793523989072114, 12.911932588635384, 15.128074866145454, 14.802256106816, -9.864938346731186, 24.248286432853277, 22.731524093974325, 8.992088815085216, 19.50482323084332, 3.0857622178196147, -19.62664520686122, 10.845663266498265, 15.70201204555412, 46.72795997830343, 25.840088157118334, 13.17340825931474, 17.88863719008313, 13.621904203979811, 17.35717296752555, 30.890890769043605, 40.20041504173627, 17.359261126281467, 22.375061071550515, 20.066726592045086, 19.69936313688327, 27.014466936606084, 10.424920342584548, 16.88120741713475, 20.32276766934651, 50.16345846309753, -50.790181597830674, 11.77801109111337, 29.95702102828292, 22.773998223128608, 28.326533157965574, 17.72861871770742, 23.07387158101775, 12.236450523112909, 19.044331997141732, 19.72062242631033, 13.570723859997091, -9.915509220950614, 20.539594227532987, -19.898095380992913, 13.138620400735263, 16.0108052139477, -50.80062867098016, -37.676745207614374, 22.12289834960038, 14.63894768229235, 22.76684528042297, 18.131355550621606, 20.42645148256828, -2.102498077906365, 17.401623519696955, 37.61229404525038, 16.78307321572828, 13.667995184824482, 24.884838561822345, 22.31596547145775, 16.72851281726259, 19.44740040710006, 20.22120436421648, 17.252447398361927, 25.61080928629018, 14.823464491533292, 16.3156020079858, 15.428567855260443, 18.294231247629142, 31.17016131712104, 25.877139450678403, 5.638631824007912, 19.250357440829404, -19.05293348990431, 31.22070114198745, -25.249081459737326, 22.000974519495784, 13.348441651179119, 15.308338252577595, 26.006386193676388, 18.531716602360024, 34.019995444901596, 13.703787746955529, 17.58857611969182, 15.891234822233113, 10.300801408452926, 20.644433135519655, 19.35107355491183, 15.425692030619675], "episode_lengths": [295, 1117, 798, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 295, 799, 653, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 406, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.051339414056557, "mean_inference_ms": 6.753293274342958, "mean_action_processing_ms": 0.46277021776955296, "mean_env_wait_ms": 20.43176576322186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026091575622558594, "StateBufferConnector_ms": 0.04149675369262695, "ViewRequirementAgentConnector_ms": 0.8321347236633301}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 653810, "num_agent_steps_trained": 653810, "num_env_steps_sampled": 653810, "num_env_steps_trained": 653810, "num_env_steps_sampled_this_iter": 5885, "num_env_steps_trained_this_iter": 5885, "num_env_steps_sampled_throughput_per_sec": 170.64153348559583, "num_env_steps_trained_throughput_per_sec": 170.64153348559583, "timesteps_total": 653810, "num_steps_trained_this_iter": 5885, "agent_timesteps_total": 653810, "timers": {"training_iteration_time_ms": 45209.464, "sample_time_ms": 32393.197, "load_time_ms": 1145.648, "load_throughput": 7821.25, "learn_time_ms": 11149.337, "learn_throughput": 803.671, "synch_weights_time_ms": 448.334}, "counters": {"num_env_steps_sampled": 653810, "num_env_steps_trained": 653810, "num_agent_steps_sampled": 653810, "num_agent_steps_trained": 653810}, "done": false, "episodes_total": 998, "training_iteration": 71, "trial_id": "32ccc_00000", "date": "2025-06-07_12-55-07", "timestamp": 1749293707, "time_this_iter_s": 34.503262519836426, "time_total_s": 3227.799572467804, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3227.799572467804, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 48.81904761904762, "ram_util_percent": 87.39285714285714, "gpu_util_percent0": 0.05095238095238094, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.346189999999999e-05, "total_loss": -0.13361347169615329, "policy_loss": -0.04243686599257801, "vf_loss": 0.06327785812318325, "vf_explained_var": 0.9202836159297398, "kl": 0.011422066500069506, "entropy": 16.578302296229772, "entropy_coeff": 0.00673095}, "model": {}, "num_grad_updates_lifetime": 23185.5, "diff_num_grad_updates_vs_sampler_policy": 174.5}}, "num_env_steps_sampled": 663694, "num_env_steps_trained": 663694, "num_agent_steps_sampled": 663694, "num_agent_steps_trained": 663694}, "sampler_results": {"episode_reward_max": 53.0966692558676, "episode_reward_min": -50.80062867098016, "episode_reward_mean": 15.782083434339015, "episode_len_mean": 641.75, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.802256106816, -9.864938346731186, 24.248286432853277, 22.731524093974325, 8.992088815085216, 19.50482323084332, 3.0857622178196147, -19.62664520686122, 10.845663266498265, 15.70201204555412, 46.72795997830343, 25.840088157118334, 13.17340825931474, 17.88863719008313, 13.621904203979811, 17.35717296752555, 30.890890769043605, 40.20041504173627, 17.359261126281467, 22.375061071550515, 20.066726592045086, 19.69936313688327, 27.014466936606084, 10.424920342584548, 16.88120741713475, 20.32276766934651, 50.16345846309753, -50.790181597830674, 11.77801109111337, 29.95702102828292, 22.773998223128608, 28.326533157965574, 17.72861871770742, 23.07387158101775, 12.236450523112909, 19.044331997141732, 19.72062242631033, 13.570723859997091, -9.915509220950614, 20.539594227532987, -19.898095380992913, 13.138620400735263, 16.0108052139477, -50.80062867098016, -37.676745207614374, 22.12289834960038, 14.63894768229235, 22.76684528042297, 18.131355550621606, 20.42645148256828, -2.102498077906365, 17.401623519696955, 37.61229404525038, 16.78307321572828, 13.667995184824482, 24.884838561822345, 22.31596547145775, 16.72851281726259, 19.44740040710006, 20.22120436421648, 17.252447398361927, 25.61080928629018, 14.823464491533292, 16.3156020079858, 15.428567855260443, 18.294231247629142, 31.17016131712104, 25.877139450678403, 5.638631824007912, 19.250357440829404, -19.05293348990431, 31.22070114198745, -25.249081459737326, 22.000974519495784, 13.348441651179119, 15.308338252577595, 26.006386193676388, 18.531716602360024, 34.019995444901596, 13.703787746955529, 17.58857611969182, 15.891234822233113, 10.300801408452926, 20.644433135519655, 19.35107355491183, 15.425692030619675, 38.881829000867526, 18.224701965058372, 14.353333126744632, 2.2431161680113716, 13.9725124527192, 14.031409741487225, 53.0966692558676, 18.11701108090109, 22.067512326592034, 18.869568502546752, 12.327854884008284, 29.25478181966946, 14.606386572751218, 25.16661433898837], "episode_lengths": [1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 295, 799, 653, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 406, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0533443342442528, "mean_inference_ms": 6.755988031724139, "mean_action_processing_ms": 0.46320067990190184, "mean_env_wait_ms": 20.43951489137783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026107072830200195, "StateBufferConnector_ms": 0.042467594146728516, "ViewRequirementAgentConnector_ms": 0.8172986507415771}}, "episode_reward_max": 53.0966692558676, "episode_reward_min": -50.80062867098016, "episode_reward_mean": 15.782083434339015, "episode_len_mean": 641.75, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.802256106816, -9.864938346731186, 24.248286432853277, 22.731524093974325, 8.992088815085216, 19.50482323084332, 3.0857622178196147, -19.62664520686122, 10.845663266498265, 15.70201204555412, 46.72795997830343, 25.840088157118334, 13.17340825931474, 17.88863719008313, 13.621904203979811, 17.35717296752555, 30.890890769043605, 40.20041504173627, 17.359261126281467, 22.375061071550515, 20.066726592045086, 19.69936313688327, 27.014466936606084, 10.424920342584548, 16.88120741713475, 20.32276766934651, 50.16345846309753, -50.790181597830674, 11.77801109111337, 29.95702102828292, 22.773998223128608, 28.326533157965574, 17.72861871770742, 23.07387158101775, 12.236450523112909, 19.044331997141732, 19.72062242631033, 13.570723859997091, -9.915509220950614, 20.539594227532987, -19.898095380992913, 13.138620400735263, 16.0108052139477, -50.80062867098016, -37.676745207614374, 22.12289834960038, 14.63894768229235, 22.76684528042297, 18.131355550621606, 20.42645148256828, -2.102498077906365, 17.401623519696955, 37.61229404525038, 16.78307321572828, 13.667995184824482, 24.884838561822345, 22.31596547145775, 16.72851281726259, 19.44740040710006, 20.22120436421648, 17.252447398361927, 25.61080928629018, 14.823464491533292, 16.3156020079858, 15.428567855260443, 18.294231247629142, 31.17016131712104, 25.877139450678403, 5.638631824007912, 19.250357440829404, -19.05293348990431, 31.22070114198745, -25.249081459737326, 22.000974519495784, 13.348441651179119, 15.308338252577595, 26.006386193676388, 18.531716602360024, 34.019995444901596, 13.703787746955529, 17.58857611969182, 15.891234822233113, 10.300801408452926, 20.644433135519655, 19.35107355491183, 15.425692030619675, 38.881829000867526, 18.224701965058372, 14.353333126744632, 2.2431161680113716, 13.9725124527192, 14.031409741487225, 53.0966692558676, 18.11701108090109, 22.067512326592034, 18.869568502546752, 12.327854884008284, 29.25478181966946, 14.606386572751218, 25.16661433898837], "episode_lengths": [1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 295, 799, 653, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 406, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0533443342442528, "mean_inference_ms": 6.755988031724139, "mean_action_processing_ms": 0.46320067990190184, "mean_env_wait_ms": 20.43951489137783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026107072830200195, "StateBufferConnector_ms": 0.042467594146728516, "ViewRequirementAgentConnector_ms": 0.8172986507415771}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 663694, "num_agent_steps_trained": 663694, "num_env_steps_sampled": 663694, "num_env_steps_trained": 663694, "num_env_steps_sampled_this_iter": 9884, "num_env_steps_trained_this_iter": 9884, "num_env_steps_sampled_throughput_per_sec": 201.1430154203254, "num_env_steps_trained_throughput_per_sec": 201.1430154203254, "timesteps_total": 663694, "num_steps_trained_this_iter": 9884, "agent_timesteps_total": 663694, "timers": {"training_iteration_time_ms": 44696.378, "sample_time_ms": 32087.649, "load_time_ms": 1080.039, "load_throughput": 8068.04, "learn_time_ms": 11011.227, "learn_throughput": 791.356, "synch_weights_time_ms": 446.71}, "counters": {"num_env_steps_sampled": 663694, "num_env_steps_trained": 663694, "num_agent_steps_sampled": 663694, "num_agent_steps_trained": 663694}, "done": false, "episodes_total": 1012, "training_iteration": 72, "trial_id": "32ccc_00000", "date": "2025-06-07_12-55-56", "timestamp": 1749293756, "time_this_iter_s": 49.154953956604004, "time_total_s": 3276.954526424408, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3276.954526424408, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 55.91355932203389, "ram_util_percent": 88.535593220339, "gpu_util_percent0": 0.17169491525423727, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.336306000000002e-05, "total_loss": -0.11272430895577844, "policy_loss": -0.022740213342348863, "vf_loss": 0.0669729196284784, "vf_explained_var": 0.9108127938538063, "kl": 0.010339727837960137, "entropy": 16.668104804434428, "entropy_coeff": 0.00668153}, "model": {}, "num_grad_updates_lifetime": 23565.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 675222, "num_env_steps_trained": 675222, "num_agent_steps_sampled": 675222, "num_agent_steps_trained": 675222}, "sampler_results": {"episode_reward_max": 56.45306773140399, "episode_reward_min": -50.80062867098016, "episode_reward_mean": 16.73454358978482, "episode_len_mean": 649.97, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.621904203979811, 17.35717296752555, 30.890890769043605, 40.20041504173627, 17.359261126281467, 22.375061071550515, 20.066726592045086, 19.69936313688327, 27.014466936606084, 10.424920342584548, 16.88120741713475, 20.32276766934651, 50.16345846309753, -50.790181597830674, 11.77801109111337, 29.95702102828292, 22.773998223128608, 28.326533157965574, 17.72861871770742, 23.07387158101775, 12.236450523112909, 19.044331997141732, 19.72062242631033, 13.570723859997091, -9.915509220950614, 20.539594227532987, -19.898095380992913, 13.138620400735263, 16.0108052139477, -50.80062867098016, -37.676745207614374, 22.12289834960038, 14.63894768229235, 22.76684528042297, 18.131355550621606, 20.42645148256828, -2.102498077906365, 17.401623519696955, 37.61229404525038, 16.78307321572828, 13.667995184824482, 24.884838561822345, 22.31596547145775, 16.72851281726259, 19.44740040710006, 20.22120436421648, 17.252447398361927, 25.61080928629018, 14.823464491533292, 16.3156020079858, 15.428567855260443, 18.294231247629142, 31.17016131712104, 25.877139450678403, 5.638631824007912, 19.250357440829404, -19.05293348990431, 31.22070114198745, -25.249081459737326, 22.000974519495784, 13.348441651179119, 15.308338252577595, 26.006386193676388, 18.531716602360024, 34.019995444901596, 13.703787746955529, 17.58857611969182, 15.891234822233113, 10.300801408452926, 20.644433135519655, 19.35107355491183, 15.425692030619675, 38.881829000867526, 18.224701965058372, 14.353333126744632, 2.2431161680113716, 13.9725124527192, 14.031409741487225, 53.0966692558676, 18.11701108090109, 22.067512326592034, 18.869568502546752, 12.327854884008284, 29.25478181966946, 14.606386572751218, 25.16661433898837, 53.529388503036095, 18.49866726460215, 33.05907988663454, 23.288770774255216, 12.99238258140769, 8.263118577539618, 56.45306773140399, 17.85415758487447, 20.41636322082715, 18.96318185464498, 15.359361947649194, -31.883444287492136, -0.5237553040877677, 43.02660144995689], "episode_lengths": [295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 295, 799, 653, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 406, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.056244870768185, "mean_inference_ms": 6.7596952878923116, "mean_action_processing_ms": 0.46368696393627246, "mean_env_wait_ms": 20.448996041148188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03144526481628418, "StateBufferConnector_ms": 0.041475772857666016, "ViewRequirementAgentConnector_ms": 0.8148472309112549}}, "episode_reward_max": 56.45306773140399, "episode_reward_min": -50.80062867098016, "episode_reward_mean": 16.73454358978482, "episode_len_mean": 649.97, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.621904203979811, 17.35717296752555, 30.890890769043605, 40.20041504173627, 17.359261126281467, 22.375061071550515, 20.066726592045086, 19.69936313688327, 27.014466936606084, 10.424920342584548, 16.88120741713475, 20.32276766934651, 50.16345846309753, -50.790181597830674, 11.77801109111337, 29.95702102828292, 22.773998223128608, 28.326533157965574, 17.72861871770742, 23.07387158101775, 12.236450523112909, 19.044331997141732, 19.72062242631033, 13.570723859997091, -9.915509220950614, 20.539594227532987, -19.898095380992913, 13.138620400735263, 16.0108052139477, -50.80062867098016, -37.676745207614374, 22.12289834960038, 14.63894768229235, 22.76684528042297, 18.131355550621606, 20.42645148256828, -2.102498077906365, 17.401623519696955, 37.61229404525038, 16.78307321572828, 13.667995184824482, 24.884838561822345, 22.31596547145775, 16.72851281726259, 19.44740040710006, 20.22120436421648, 17.252447398361927, 25.61080928629018, 14.823464491533292, 16.3156020079858, 15.428567855260443, 18.294231247629142, 31.17016131712104, 25.877139450678403, 5.638631824007912, 19.250357440829404, -19.05293348990431, 31.22070114198745, -25.249081459737326, 22.000974519495784, 13.348441651179119, 15.308338252577595, 26.006386193676388, 18.531716602360024, 34.019995444901596, 13.703787746955529, 17.58857611969182, 15.891234822233113, 10.300801408452926, 20.644433135519655, 19.35107355491183, 15.425692030619675, 38.881829000867526, 18.224701965058372, 14.353333126744632, 2.2431161680113716, 13.9725124527192, 14.031409741487225, 53.0966692558676, 18.11701108090109, 22.067512326592034, 18.869568502546752, 12.327854884008284, 29.25478181966946, 14.606386572751218, 25.16661433898837, 53.529388503036095, 18.49866726460215, 33.05907988663454, 23.288770774255216, 12.99238258140769, 8.263118577539618, 56.45306773140399, 17.85415758487447, 20.41636322082715, 18.96318185464498, 15.359361947649194, -31.883444287492136, -0.5237553040877677, 43.02660144995689], "episode_lengths": [295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 295, 799, 653, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 406, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.056244870768185, "mean_inference_ms": 6.7596952878923116, "mean_action_processing_ms": 0.46368696393627246, "mean_env_wait_ms": 20.448996041148188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03144526481628418, "StateBufferConnector_ms": 0.041475772857666016, "ViewRequirementAgentConnector_ms": 0.8148472309112549}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 675222, "num_agent_steps_trained": 675222, "num_env_steps_sampled": 675222, "num_env_steps_trained": 675222, "num_env_steps_sampled_this_iter": 11528, "num_env_steps_trained_this_iter": 11528, "num_env_steps_sampled_throughput_per_sec": 219.92539979824346, "num_env_steps_trained_throughput_per_sec": 219.92539979824346, "timesteps_total": 675222, "num_steps_trained_this_iter": 11528, "agent_timesteps_total": 675222, "timers": {"training_iteration_time_ms": 45519.674, "sample_time_ms": 32470.983, "load_time_ms": 1158.558, "load_throughput": 7807.292, "learn_time_ms": 11369.661, "learn_throughput": 795.556, "synch_weights_time_ms": 447.748}, "counters": {"num_env_steps_sampled": 675222, "num_env_steps_trained": 675222, "num_agent_steps_sampled": 675222, "num_agent_steps_trained": 675222}, "done": false, "episodes_total": 1026, "training_iteration": 73, "trial_id": "32ccc_00000", "date": "2025-06-07_12-56-49", "timestamp": 1749293809, "time_this_iter_s": 52.43378281593323, "time_total_s": 3329.388309240341, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3329.388309240341, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 62.48548387096775, "ram_util_percent": 89.80483870967741, "gpu_util_percent0": 0.17306451612903226, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.324778e-05, "total_loss": -0.09988001218740025, "policy_loss": -0.01689724059542641, "vf_loss": 0.08372722593425162, "vf_explained_var": 0.9299988204035265, "kl": 0.011737954809035483, "entropy": 16.541365551126415, "entropy_coeff": 0.006623890000000001}, "model": {}, "num_grad_updates_lifetime": 23915.5, "diff_num_grad_updates_vs_sampler_policy": 144.5}}, "num_env_steps_sampled": 683462, "num_env_steps_trained": 683462, "num_agent_steps_sampled": 683462, "num_agent_steps_trained": 683462}, "sampler_results": {"episode_reward_max": 95.04313358562044, "episode_reward_min": -50.80062867098016, "episode_reward_mean": 16.640422361583287, "episode_len_mean": 641.75, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.77801109111337, 29.95702102828292, 22.773998223128608, 28.326533157965574, 17.72861871770742, 23.07387158101775, 12.236450523112909, 19.044331997141732, 19.72062242631033, 13.570723859997091, -9.915509220950614, 20.539594227532987, -19.898095380992913, 13.138620400735263, 16.0108052139477, -50.80062867098016, -37.676745207614374, 22.12289834960038, 14.63894768229235, 22.76684528042297, 18.131355550621606, 20.42645148256828, -2.102498077906365, 17.401623519696955, 37.61229404525038, 16.78307321572828, 13.667995184824482, 24.884838561822345, 22.31596547145775, 16.72851281726259, 19.44740040710006, 20.22120436421648, 17.252447398361927, 25.61080928629018, 14.823464491533292, 16.3156020079858, 15.428567855260443, 18.294231247629142, 31.17016131712104, 25.877139450678403, 5.638631824007912, 19.250357440829404, -19.05293348990431, 31.22070114198745, -25.249081459737326, 22.000974519495784, 13.348441651179119, 15.308338252577595, 26.006386193676388, 18.531716602360024, 34.019995444901596, 13.703787746955529, 17.58857611969182, 15.891234822233113, 10.300801408452926, 20.644433135519655, 19.35107355491183, 15.425692030619675, 38.881829000867526, 18.224701965058372, 14.353333126744632, 2.2431161680113716, 13.9725124527192, 14.031409741487225, 53.0966692558676, 18.11701108090109, 22.067512326592034, 18.869568502546752, 12.327854884008284, 29.25478181966946, 14.606386572751218, 25.16661433898837, 53.529388503036095, 18.49866726460215, 33.05907988663454, 23.288770774255216, 12.99238258140769, 8.263118577539618, 56.45306773140399, 17.85415758487447, 20.41636322082715, 18.96318185464498, 15.359361947649194, -31.883444287492136, -0.5237553040877677, 43.02660144995689, 18.7065440683397, 13.999293539011438, 18.23152134539801, 95.04313358562044, -12.33685147333147, 6.823475627176256, 20.10347072876908, 16.422186417054178, 13.199388847548935, -38.93577881326402, 32.75882631336597, 21.032567083121023, 16.900987832649875, 24.226546218371578], "episode_lengths": [295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 295, 799, 653, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 406, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.059029462694999, "mean_inference_ms": 6.763156194225417, "mean_action_processing_ms": 0.4641156482817675, "mean_env_wait_ms": 20.457719085025705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03144383430480957, "StateBufferConnector_ms": 0.0366978645324707, "ViewRequirementAgentConnector_ms": 0.8103249073028564}}, "episode_reward_max": 95.04313358562044, "episode_reward_min": -50.80062867098016, "episode_reward_mean": 16.640422361583287, "episode_len_mean": 641.75, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.77801109111337, 29.95702102828292, 22.773998223128608, 28.326533157965574, 17.72861871770742, 23.07387158101775, 12.236450523112909, 19.044331997141732, 19.72062242631033, 13.570723859997091, -9.915509220950614, 20.539594227532987, -19.898095380992913, 13.138620400735263, 16.0108052139477, -50.80062867098016, -37.676745207614374, 22.12289834960038, 14.63894768229235, 22.76684528042297, 18.131355550621606, 20.42645148256828, -2.102498077906365, 17.401623519696955, 37.61229404525038, 16.78307321572828, 13.667995184824482, 24.884838561822345, 22.31596547145775, 16.72851281726259, 19.44740040710006, 20.22120436421648, 17.252447398361927, 25.61080928629018, 14.823464491533292, 16.3156020079858, 15.428567855260443, 18.294231247629142, 31.17016131712104, 25.877139450678403, 5.638631824007912, 19.250357440829404, -19.05293348990431, 31.22070114198745, -25.249081459737326, 22.000974519495784, 13.348441651179119, 15.308338252577595, 26.006386193676388, 18.531716602360024, 34.019995444901596, 13.703787746955529, 17.58857611969182, 15.891234822233113, 10.300801408452926, 20.644433135519655, 19.35107355491183, 15.425692030619675, 38.881829000867526, 18.224701965058372, 14.353333126744632, 2.2431161680113716, 13.9725124527192, 14.031409741487225, 53.0966692558676, 18.11701108090109, 22.067512326592034, 18.869568502546752, 12.327854884008284, 29.25478181966946, 14.606386572751218, 25.16661433898837, 53.529388503036095, 18.49866726460215, 33.05907988663454, 23.288770774255216, 12.99238258140769, 8.263118577539618, 56.45306773140399, 17.85415758487447, 20.41636322082715, 18.96318185464498, 15.359361947649194, -31.883444287492136, -0.5237553040877677, 43.02660144995689, 18.7065440683397, 13.999293539011438, 18.23152134539801, 95.04313358562044, -12.33685147333147, 6.823475627176256, 20.10347072876908, 16.422186417054178, 13.199388847548935, -38.93577881326402, 32.75882631336597, 21.032567083121023, 16.900987832649875, 24.226546218371578], "episode_lengths": [295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 295, 799, 653, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 406, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.059029462694999, "mean_inference_ms": 6.763156194225417, "mean_action_processing_ms": 0.4641156482817675, "mean_env_wait_ms": 20.457719085025705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03144383430480957, "StateBufferConnector_ms": 0.0366978645324707, "ViewRequirementAgentConnector_ms": 0.8103249073028564}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 683462, "num_agent_steps_trained": 683462, "num_env_steps_sampled": 683462, "num_env_steps_trained": 683462, "num_env_steps_sampled_this_iter": 8240, "num_env_steps_trained_this_iter": 8240, "num_env_steps_sampled_throughput_per_sec": 183.19289795317133, "num_env_steps_trained_throughput_per_sec": 183.19289795317133, "timesteps_total": 683462, "num_steps_trained_this_iter": 8240, "agent_timesteps_total": 683462, "timers": {"training_iteration_time_ms": 45704.09, "sample_time_ms": 32552.912, "load_time_ms": 1157.027, "load_throughput": 7817.624, "learn_time_ms": 11486.342, "learn_throughput": 787.474, "synch_weights_time_ms": 435.272}, "counters": {"num_env_steps_sampled": 683462, "num_env_steps_trained": 683462, "num_agent_steps_sampled": 683462, "num_agent_steps_trained": 683462}, "done": false, "episodes_total": 1040, "training_iteration": 74, "trial_id": "32ccc_00000", "date": "2025-06-07_12-57-34", "timestamp": 1749293854, "time_this_iter_s": 44.99673843383789, "time_total_s": 3374.385047674179, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3374.385047674179, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 55.187037037037044, "ram_util_percent": 88.63333333333328, "gpu_util_percent0": 0.1511111111111111, "vram_util_percent0": 0.9650065104166664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.316537999999999e-05, "total_loss": -0.11509720652227708, "policy_loss": -0.02821532810460134, "vf_loss": 0.0689583288987392, "vf_explained_var": 0.9384004155109669, "kl": 0.011533581186713177, "entropy": 16.560263008906922, "entropy_coeff": 0.006582690000000001}, "model": {}, "num_grad_updates_lifetime": 24205.5, "diff_num_grad_updates_vs_sampler_policy": 144.5}}, "num_env_steps_sampled": 691702, "num_env_steps_trained": 691702, "num_agent_steps_sampled": 691702, "num_agent_steps_trained": 691702}, "sampler_results": {"episode_reward_max": 95.04313358562044, "episode_reward_min": -50.80062867098016, "episode_reward_mean": 17.2233999951829, "episode_len_mean": 649.97, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0108052139477, -50.80062867098016, -37.676745207614374, 22.12289834960038, 14.63894768229235, 22.76684528042297, 18.131355550621606, 20.42645148256828, -2.102498077906365, 17.401623519696955, 37.61229404525038, 16.78307321572828, 13.667995184824482, 24.884838561822345, 22.31596547145775, 16.72851281726259, 19.44740040710006, 20.22120436421648, 17.252447398361927, 25.61080928629018, 14.823464491533292, 16.3156020079858, 15.428567855260443, 18.294231247629142, 31.17016131712104, 25.877139450678403, 5.638631824007912, 19.250357440829404, -19.05293348990431, 31.22070114198745, -25.249081459737326, 22.000974519495784, 13.348441651179119, 15.308338252577595, 26.006386193676388, 18.531716602360024, 34.019995444901596, 13.703787746955529, 17.58857611969182, 15.891234822233113, 10.300801408452926, 20.644433135519655, 19.35107355491183, 15.425692030619675, 38.881829000867526, 18.224701965058372, 14.353333126744632, 2.2431161680113716, 13.9725124527192, 14.031409741487225, 53.0966692558676, 18.11701108090109, 22.067512326592034, 18.869568502546752, 12.327854884008284, 29.25478181966946, 14.606386572751218, 25.16661433898837, 53.529388503036095, 18.49866726460215, 33.05907988663454, 23.288770774255216, 12.99238258140769, 8.263118577539618, 56.45306773140399, 17.85415758487447, 20.41636322082715, 18.96318185464498, 15.359361947649194, -31.883444287492136, -0.5237553040877677, 43.02660144995689, 18.7065440683397, 13.999293539011438, 18.23152134539801, 95.04313358562044, -12.33685147333147, 6.823475627176256, 20.10347072876908, 16.422186417054178, 13.199388847548935, -38.93577881326402, 32.75882631336597, 21.032567083121023, 16.900987832649875, 24.226546218371578, 3.6333697343633813, 23.568748062414173, 25.973154240502108, 23.90166735538349, 20.31104368210178, 14.570125376375255, 49.329295992845275, 15.134804938572206, 10.806772431508643, 20.063104523258605, 8.800780713172449, 10.953033581666222, 10.328877875830658, 22.997777484069534], "episode_lengths": [295, 799, 653, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 406, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.061753635741814, "mean_inference_ms": 6.765309001980448, "mean_action_processing_ms": 0.4644236835690264, "mean_env_wait_ms": 20.46318299537998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03349018096923828, "StateBufferConnector_ms": 0.03569364547729492, "ViewRequirementAgentConnector_ms": 0.8135440349578857}}, "episode_reward_max": 95.04313358562044, "episode_reward_min": -50.80062867098016, "episode_reward_mean": 17.2233999951829, "episode_len_mean": 649.97, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0108052139477, -50.80062867098016, -37.676745207614374, 22.12289834960038, 14.63894768229235, 22.76684528042297, 18.131355550621606, 20.42645148256828, -2.102498077906365, 17.401623519696955, 37.61229404525038, 16.78307321572828, 13.667995184824482, 24.884838561822345, 22.31596547145775, 16.72851281726259, 19.44740040710006, 20.22120436421648, 17.252447398361927, 25.61080928629018, 14.823464491533292, 16.3156020079858, 15.428567855260443, 18.294231247629142, 31.17016131712104, 25.877139450678403, 5.638631824007912, 19.250357440829404, -19.05293348990431, 31.22070114198745, -25.249081459737326, 22.000974519495784, 13.348441651179119, 15.308338252577595, 26.006386193676388, 18.531716602360024, 34.019995444901596, 13.703787746955529, 17.58857611969182, 15.891234822233113, 10.300801408452926, 20.644433135519655, 19.35107355491183, 15.425692030619675, 38.881829000867526, 18.224701965058372, 14.353333126744632, 2.2431161680113716, 13.9725124527192, 14.031409741487225, 53.0966692558676, 18.11701108090109, 22.067512326592034, 18.869568502546752, 12.327854884008284, 29.25478181966946, 14.606386572751218, 25.16661433898837, 53.529388503036095, 18.49866726460215, 33.05907988663454, 23.288770774255216, 12.99238258140769, 8.263118577539618, 56.45306773140399, 17.85415758487447, 20.41636322082715, 18.96318185464498, 15.359361947649194, -31.883444287492136, -0.5237553040877677, 43.02660144995689, 18.7065440683397, 13.999293539011438, 18.23152134539801, 95.04313358562044, -12.33685147333147, 6.823475627176256, 20.10347072876908, 16.422186417054178, 13.199388847548935, -38.93577881326402, 32.75882631336597, 21.032567083121023, 16.900987832649875, 24.226546218371578, 3.6333697343633813, 23.568748062414173, 25.973154240502108, 23.90166735538349, 20.31104368210178, 14.570125376375255, 49.329295992845275, 15.134804938572206, 10.806772431508643, 20.063104523258605, 8.800780713172449, 10.953033581666222, 10.328877875830658, 22.997777484069534], "episode_lengths": [295, 799, 653, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 406, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.061753635741814, "mean_inference_ms": 6.765309001980448, "mean_action_processing_ms": 0.4644236835690264, "mean_env_wait_ms": 20.46318299537998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03349018096923828, "StateBufferConnector_ms": 0.03569364547729492, "ViewRequirementAgentConnector_ms": 0.8135440349578857}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 691702, "num_agent_steps_trained": 691702, "num_env_steps_sampled": 691702, "num_env_steps_trained": 691702, "num_env_steps_sampled_this_iter": 8240, "num_env_steps_trained_this_iter": 8240, "num_env_steps_sampled_throughput_per_sec": 202.70133171785662, "num_env_steps_trained_throughput_per_sec": 202.70133171785662, "timesteps_total": 691702, "num_steps_trained_this_iter": 8240, "agent_timesteps_total": 691702, "timers": {"training_iteration_time_ms": 45223.491, "sample_time_ms": 32124.19, "load_time_ms": 1158.845, "load_throughput": 7761.949, "learn_time_ms": 11427.807, "learn_throughput": 787.106, "synch_weights_time_ms": 439.855}, "counters": {"num_env_steps_sampled": 691702, "num_env_steps_trained": 691702, "num_agent_steps_sampled": 691702, "num_agent_steps_trained": 691702}, "done": false, "episodes_total": 1054, "training_iteration": 75, "trial_id": "32ccc_00000", "date": "2025-06-07_12-58-15", "timestamp": 1749293895, "time_this_iter_s": 40.666940689086914, "time_total_s": 3415.051988363266, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3415.051988363266, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 54.097959183673474, "ram_util_percent": 88.48979591836736, "gpu_util_percent0": 0.17897959183673473, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.308297999999999e-05, "total_loss": -0.11849935708451084, "policy_loss": -0.032716224824253, "vf_loss": 0.06962289638468064, "vf_explained_var": 0.919800928607583, "kl": 0.01064198854365118, "entropy": 16.510037598013877, "entropy_coeff": 0.006541489999999999}, "model": {}, "num_grad_updates_lifetime": 24510.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 700764, "num_env_steps_trained": 700764, "num_agent_steps_sampled": 700764, "num_agent_steps_trained": 700764}, "sampler_results": {"episode_reward_max": 95.04313358562044, "episode_reward_min": -38.93577881326402, "episode_reward_mean": 18.066844075168877, "episode_len_mean": 641.35, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.31596547145775, 16.72851281726259, 19.44740040710006, 20.22120436421648, 17.252447398361927, 25.61080928629018, 14.823464491533292, 16.3156020079858, 15.428567855260443, 18.294231247629142, 31.17016131712104, 25.877139450678403, 5.638631824007912, 19.250357440829404, -19.05293348990431, 31.22070114198745, -25.249081459737326, 22.000974519495784, 13.348441651179119, 15.308338252577595, 26.006386193676388, 18.531716602360024, 34.019995444901596, 13.703787746955529, 17.58857611969182, 15.891234822233113, 10.300801408452926, 20.644433135519655, 19.35107355491183, 15.425692030619675, 38.881829000867526, 18.224701965058372, 14.353333126744632, 2.2431161680113716, 13.9725124527192, 14.031409741487225, 53.0966692558676, 18.11701108090109, 22.067512326592034, 18.869568502546752, 12.327854884008284, 29.25478181966946, 14.606386572751218, 25.16661433898837, 53.529388503036095, 18.49866726460215, 33.05907988663454, 23.288770774255216, 12.99238258140769, 8.263118577539618, 56.45306773140399, 17.85415758487447, 20.41636322082715, 18.96318185464498, 15.359361947649194, -31.883444287492136, -0.5237553040877677, 43.02660144995689, 18.7065440683397, 13.999293539011438, 18.23152134539801, 95.04313358562044, -12.33685147333147, 6.823475627176256, 20.10347072876908, 16.422186417054178, 13.199388847548935, -38.93577881326402, 32.75882631336597, 21.032567083121023, 16.900987832649875, 24.226546218371578, 3.6333697343633813, 23.568748062414173, 25.973154240502108, 23.90166735538349, 20.31104368210178, 14.570125376375255, 49.329295992845275, 15.134804938572206, 10.806772431508643, 20.063104523258605, 8.800780713172449, 10.953033581666222, 10.328877875830658, 22.997777484069534, 18.567410924414613, -32.7506228789173, 38.20844528592947, 23.057133725310308, 17.04785807600087, 14.003584573482927, 36.480465439952326, 6.1573643127807545, 19.095773504539558, 19.13952420269612, 10.38890509839119, 24.507724713356776, 9.851476834785531, 14.456620316149676], "episode_lengths": [1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 406, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0644420915173414, "mean_inference_ms": 6.767606281698486, "mean_action_processing_ms": 0.46477117881903274, "mean_env_wait_ms": 20.46874412394975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030484437942504883, "StateBufferConnector_ms": 0.02604079246520996, "ViewRequirementAgentConnector_ms": 0.7886722087860107}}, "episode_reward_max": 95.04313358562044, "episode_reward_min": -38.93577881326402, "episode_reward_mean": 18.066844075168877, "episode_len_mean": 641.35, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.31596547145775, 16.72851281726259, 19.44740040710006, 20.22120436421648, 17.252447398361927, 25.61080928629018, 14.823464491533292, 16.3156020079858, 15.428567855260443, 18.294231247629142, 31.17016131712104, 25.877139450678403, 5.638631824007912, 19.250357440829404, -19.05293348990431, 31.22070114198745, -25.249081459737326, 22.000974519495784, 13.348441651179119, 15.308338252577595, 26.006386193676388, 18.531716602360024, 34.019995444901596, 13.703787746955529, 17.58857611969182, 15.891234822233113, 10.300801408452926, 20.644433135519655, 19.35107355491183, 15.425692030619675, 38.881829000867526, 18.224701965058372, 14.353333126744632, 2.2431161680113716, 13.9725124527192, 14.031409741487225, 53.0966692558676, 18.11701108090109, 22.067512326592034, 18.869568502546752, 12.327854884008284, 29.25478181966946, 14.606386572751218, 25.16661433898837, 53.529388503036095, 18.49866726460215, 33.05907988663454, 23.288770774255216, 12.99238258140769, 8.263118577539618, 56.45306773140399, 17.85415758487447, 20.41636322082715, 18.96318185464498, 15.359361947649194, -31.883444287492136, -0.5237553040877677, 43.02660144995689, 18.7065440683397, 13.999293539011438, 18.23152134539801, 95.04313358562044, -12.33685147333147, 6.823475627176256, 20.10347072876908, 16.422186417054178, 13.199388847548935, -38.93577881326402, 32.75882631336597, 21.032567083121023, 16.900987832649875, 24.226546218371578, 3.6333697343633813, 23.568748062414173, 25.973154240502108, 23.90166735538349, 20.31104368210178, 14.570125376375255, 49.329295992845275, 15.134804938572206, 10.806772431508643, 20.063104523258605, 8.800780713172449, 10.953033581666222, 10.328877875830658, 22.997777484069534, 18.567410924414613, -32.7506228789173, 38.20844528592947, 23.057133725310308, 17.04785807600087, 14.003584573482927, 36.480465439952326, 6.1573643127807545, 19.095773504539558, 19.13952420269612, 10.38890509839119, 24.507724713356776, 9.851476834785531, 14.456620316149676], "episode_lengths": [1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 406, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0644420915173414, "mean_inference_ms": 6.767606281698486, "mean_action_processing_ms": 0.46477117881903274, "mean_env_wait_ms": 20.46874412394975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030484437942504883, "StateBufferConnector_ms": 0.02604079246520996, "ViewRequirementAgentConnector_ms": 0.7886722087860107}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 700764, "num_agent_steps_trained": 700764, "num_env_steps_sampled": 700764, "num_env_steps_trained": 700764, "num_env_steps_sampled_this_iter": 9062, "num_env_steps_trained_this_iter": 9062, "num_env_steps_sampled_throughput_per_sec": 193.35407903360195, "num_env_steps_trained_throughput_per_sec": 193.35407903360195, "timesteps_total": 700764, "num_steps_trained_this_iter": 9062, "agent_timesteps_total": 700764, "timers": {"training_iteration_time_ms": 45039.817, "sample_time_ms": 32063.777, "load_time_ms": 1155.262, "load_throughput": 7714.875, "learn_time_ms": 11310.762, "learn_throughput": 787.984, "synch_weights_time_ms": 438.517}, "counters": {"num_env_steps_sampled": 700764, "num_env_steps_trained": 700764, "num_agent_steps_sampled": 700764, "num_agent_steps_trained": 700764}, "done": false, "episodes_total": 1068, "training_iteration": 76, "trial_id": "32ccc_00000", "date": "2025-06-07_12-59-02", "timestamp": 1749293942, "time_this_iter_s": 46.882384300231934, "time_total_s": 3461.934372663498, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3461.934372663498, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 54.433928571428574, "ram_util_percent": 88.80535714285715, "gpu_util_percent0": 0.1594642857142857, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.299236000000002e-05, "total_loss": -0.06120612480278526, "policy_loss": 0.020919563911905113, "vf_loss": 0.08099947085803641, "vf_explained_var": 0.9208009464400155, "kl": 0.011427360616081777, "entropy": 16.602673397745406, "entropy_coeff": 0.006496179999999999}, "model": {}, "num_grad_updates_lifetime": 24810.5, "diff_num_grad_updates_vs_sampler_policy": 139.5}}, "num_env_steps_sampled": 708699, "num_env_steps_trained": 708699, "num_agent_steps_sampled": 708699, "num_agent_steps_trained": 708699}, "sampler_results": {"episode_reward_max": 95.04313358562044, "episode_reward_min": -48.230293153943116, "episode_reward_mean": 16.78208165504054, "episode_len_mean": 630.08, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.05293348990431, 31.22070114198745, -25.249081459737326, 22.000974519495784, 13.348441651179119, 15.308338252577595, 26.006386193676388, 18.531716602360024, 34.019995444901596, 13.703787746955529, 17.58857611969182, 15.891234822233113, 10.300801408452926, 20.644433135519655, 19.35107355491183, 15.425692030619675, 38.881829000867526, 18.224701965058372, 14.353333126744632, 2.2431161680113716, 13.9725124527192, 14.031409741487225, 53.0966692558676, 18.11701108090109, 22.067512326592034, 18.869568502546752, 12.327854884008284, 29.25478181966946, 14.606386572751218, 25.16661433898837, 53.529388503036095, 18.49866726460215, 33.05907988663454, 23.288770774255216, 12.99238258140769, 8.263118577539618, 56.45306773140399, 17.85415758487447, 20.41636322082715, 18.96318185464498, 15.359361947649194, -31.883444287492136, -0.5237553040877677, 43.02660144995689, 18.7065440683397, 13.999293539011438, 18.23152134539801, 95.04313358562044, -12.33685147333147, 6.823475627176256, 20.10347072876908, 16.422186417054178, 13.199388847548935, -38.93577881326402, 32.75882631336597, 21.032567083121023, 16.900987832649875, 24.226546218371578, 3.6333697343633813, 23.568748062414173, 25.973154240502108, 23.90166735538349, 20.31104368210178, 14.570125376375255, 49.329295992845275, 15.134804938572206, 10.806772431508643, 20.063104523258605, 8.800780713172449, 10.953033581666222, 10.328877875830658, 22.997777484069534, 18.567410924414613, -32.7506228789173, 38.20844528592947, 23.057133725310308, 17.04785807600087, 14.003584573482927, 36.480465439952326, 6.1573643127807545, 19.095773504539558, 19.13952420269612, 10.38890509839119, 24.507724713356776, 9.851476834785531, 14.456620316149676, 21.47774047402249, 22.10659353226329, 16.490133324318975, 42.00277122271163, 22.121621723463107, 10.824658216335195, -24.725038990282872, 7.126539127611878, 15.649213221865459, 16.25606982339785, -48.230293153943116, 4.744488068401431, 16.219351957467776, 17.83440481926735], "episode_lengths": [1117, 1117, 406, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 295, 295, 1117, 812, 1117, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0666869264543872, "mean_inference_ms": 6.769728028063246, "mean_action_processing_ms": 0.4650855829475152, "mean_env_wait_ms": 20.473905398331414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028511762619018555, "StateBufferConnector_ms": 0.023062467575073242, "ViewRequirementAgentConnector_ms": 0.787196159362793}}, "episode_reward_max": 95.04313358562044, "episode_reward_min": -48.230293153943116, "episode_reward_mean": 16.78208165504054, "episode_len_mean": 630.08, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.05293348990431, 31.22070114198745, -25.249081459737326, 22.000974519495784, 13.348441651179119, 15.308338252577595, 26.006386193676388, 18.531716602360024, 34.019995444901596, 13.703787746955529, 17.58857611969182, 15.891234822233113, 10.300801408452926, 20.644433135519655, 19.35107355491183, 15.425692030619675, 38.881829000867526, 18.224701965058372, 14.353333126744632, 2.2431161680113716, 13.9725124527192, 14.031409741487225, 53.0966692558676, 18.11701108090109, 22.067512326592034, 18.869568502546752, 12.327854884008284, 29.25478181966946, 14.606386572751218, 25.16661433898837, 53.529388503036095, 18.49866726460215, 33.05907988663454, 23.288770774255216, 12.99238258140769, 8.263118577539618, 56.45306773140399, 17.85415758487447, 20.41636322082715, 18.96318185464498, 15.359361947649194, -31.883444287492136, -0.5237553040877677, 43.02660144995689, 18.7065440683397, 13.999293539011438, 18.23152134539801, 95.04313358562044, -12.33685147333147, 6.823475627176256, 20.10347072876908, 16.422186417054178, 13.199388847548935, -38.93577881326402, 32.75882631336597, 21.032567083121023, 16.900987832649875, 24.226546218371578, 3.6333697343633813, 23.568748062414173, 25.973154240502108, 23.90166735538349, 20.31104368210178, 14.570125376375255, 49.329295992845275, 15.134804938572206, 10.806772431508643, 20.063104523258605, 8.800780713172449, 10.953033581666222, 10.328877875830658, 22.997777484069534, 18.567410924414613, -32.7506228789173, 38.20844528592947, 23.057133725310308, 17.04785807600087, 14.003584573482927, 36.480465439952326, 6.1573643127807545, 19.095773504539558, 19.13952420269612, 10.38890509839119, 24.507724713356776, 9.851476834785531, 14.456620316149676, 21.47774047402249, 22.10659353226329, 16.490133324318975, 42.00277122271163, 22.121621723463107, 10.824658216335195, -24.725038990282872, 7.126539127611878, 15.649213221865459, 16.25606982339785, -48.230293153943116, 4.744488068401431, 16.219351957467776, 17.83440481926735], "episode_lengths": [1117, 1117, 406, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 295, 295, 1117, 812, 1117, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0666869264543872, "mean_inference_ms": 6.769728028063246, "mean_action_processing_ms": 0.4650855829475152, "mean_env_wait_ms": 20.473905398331414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028511762619018555, "StateBufferConnector_ms": 0.023062467575073242, "ViewRequirementAgentConnector_ms": 0.787196159362793}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708699, "num_agent_steps_trained": 708699, "num_env_steps_sampled": 708699, "num_env_steps_trained": 708699, "num_env_steps_sampled_this_iter": 7935, "num_env_steps_trained_this_iter": 7935, "num_env_steps_sampled_throughput_per_sec": 184.1612832150269, "num_env_steps_trained_throughput_per_sec": 184.1612832150269, "timesteps_total": 708699, "num_steps_trained_this_iter": 7935, "agent_timesteps_total": 708699, "timers": {"training_iteration_time_ms": 44657.041, "sample_time_ms": 31899.696, "load_time_ms": 1137.884, "load_throughput": 7733.655, "learn_time_ms": 11111.886, "learn_throughput": 791.945, "synch_weights_time_ms": 441.156}, "counters": {"num_env_steps_sampled": 708699, "num_env_steps_trained": 708699, "num_agent_steps_sampled": 708699, "num_agent_steps_trained": 708699}, "done": false, "episodes_total": 1082, "training_iteration": 77, "trial_id": "32ccc_00000", "date": "2025-06-07_12-59-45", "timestamp": 1749293985, "time_this_iter_s": 43.1042594909668, "time_total_s": 3505.0386321544647, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3505.0386321544647, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 51.65384615384616, "ram_util_percent": 87.01923076923077, "gpu_util_percent0": 0.1534615384615385, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.291301e-05, "total_loss": -0.11281448677316523, "policy_loss": -0.028835755604422256, "vf_loss": 0.06629830461998398, "vf_explained_var": 0.9535063851338167, "kl": 0.010878335299645334, "entropy": 16.29798380778386, "entropy_coeff": 0.006456505}, "model": {}, "num_grad_updates_lifetime": 25080.5, "diff_num_grad_updates_vs_sampler_policy": 129.5}}, "num_env_steps_sampled": 716117, "num_env_steps_trained": 716117, "num_agent_steps_sampled": 716117, "num_agent_steps_trained": 716117}, "sampler_results": {"episode_reward_max": 95.04313358562044, "episode_reward_min": -48.230293153943116, "episode_reward_mean": 17.87147611868276, "episode_len_mean": 628.97, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.35107355491183, 15.425692030619675, 38.881829000867526, 18.224701965058372, 14.353333126744632, 2.2431161680113716, 13.9725124527192, 14.031409741487225, 53.0966692558676, 18.11701108090109, 22.067512326592034, 18.869568502546752, 12.327854884008284, 29.25478181966946, 14.606386572751218, 25.16661433898837, 53.529388503036095, 18.49866726460215, 33.05907988663454, 23.288770774255216, 12.99238258140769, 8.263118577539618, 56.45306773140399, 17.85415758487447, 20.41636322082715, 18.96318185464498, 15.359361947649194, -31.883444287492136, -0.5237553040877677, 43.02660144995689, 18.7065440683397, 13.999293539011438, 18.23152134539801, 95.04313358562044, -12.33685147333147, 6.823475627176256, 20.10347072876908, 16.422186417054178, 13.199388847548935, -38.93577881326402, 32.75882631336597, 21.032567083121023, 16.900987832649875, 24.226546218371578, 3.6333697343633813, 23.568748062414173, 25.973154240502108, 23.90166735538349, 20.31104368210178, 14.570125376375255, 49.329295992845275, 15.134804938572206, 10.806772431508643, 20.063104523258605, 8.800780713172449, 10.953033581666222, 10.328877875830658, 22.997777484069534, 18.567410924414613, -32.7506228789173, 38.20844528592947, 23.057133725310308, 17.04785807600087, 14.003584573482927, 36.480465439952326, 6.1573643127807545, 19.095773504539558, 19.13952420269612, 10.38890509839119, 24.507724713356776, 9.851476834785531, 14.456620316149676, 21.47774047402249, 22.10659353226329, 16.490133324318975, 42.00277122271163, 22.121621723463107, 10.824658216335195, -24.725038990282872, 7.126539127611878, 15.649213221865459, 16.25606982339785, -48.230293153943116, 4.744488068401431, 16.219351957467776, 17.83440481926735, 18.391662621594072, -0.498254889125261, 17.495655388142627, 13.844735144382403, 23.252824629475377, 17.28138384144528, 17.58205127151582, 16.600687851690655, 16.29076760733369, 44.686705076032936, 10.931107305677623, 63.819585433519244, 24.225050996427353, 19.29885617549938], "episode_lengths": [295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 295, 295, 1117, 812, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.068790070272261, "mean_inference_ms": 6.771867619015629, "mean_action_processing_ms": 0.46545549358794963, "mean_env_wait_ms": 20.47897398752268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030541181564331055, "StateBufferConnector_ms": 0.02104353904724121, "ViewRequirementAgentConnector_ms": 0.7596437931060791}}, "episode_reward_max": 95.04313358562044, "episode_reward_min": -48.230293153943116, "episode_reward_mean": 17.87147611868276, "episode_len_mean": 628.97, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.35107355491183, 15.425692030619675, 38.881829000867526, 18.224701965058372, 14.353333126744632, 2.2431161680113716, 13.9725124527192, 14.031409741487225, 53.0966692558676, 18.11701108090109, 22.067512326592034, 18.869568502546752, 12.327854884008284, 29.25478181966946, 14.606386572751218, 25.16661433898837, 53.529388503036095, 18.49866726460215, 33.05907988663454, 23.288770774255216, 12.99238258140769, 8.263118577539618, 56.45306773140399, 17.85415758487447, 20.41636322082715, 18.96318185464498, 15.359361947649194, -31.883444287492136, -0.5237553040877677, 43.02660144995689, 18.7065440683397, 13.999293539011438, 18.23152134539801, 95.04313358562044, -12.33685147333147, 6.823475627176256, 20.10347072876908, 16.422186417054178, 13.199388847548935, -38.93577881326402, 32.75882631336597, 21.032567083121023, 16.900987832649875, 24.226546218371578, 3.6333697343633813, 23.568748062414173, 25.973154240502108, 23.90166735538349, 20.31104368210178, 14.570125376375255, 49.329295992845275, 15.134804938572206, 10.806772431508643, 20.063104523258605, 8.800780713172449, 10.953033581666222, 10.328877875830658, 22.997777484069534, 18.567410924414613, -32.7506228789173, 38.20844528592947, 23.057133725310308, 17.04785807600087, 14.003584573482927, 36.480465439952326, 6.1573643127807545, 19.095773504539558, 19.13952420269612, 10.38890509839119, 24.507724713356776, 9.851476834785531, 14.456620316149676, 21.47774047402249, 22.10659353226329, 16.490133324318975, 42.00277122271163, 22.121621723463107, 10.824658216335195, -24.725038990282872, 7.126539127611878, 15.649213221865459, 16.25606982339785, -48.230293153943116, 4.744488068401431, 16.219351957467776, 17.83440481926735, 18.391662621594072, -0.498254889125261, 17.495655388142627, 13.844735144382403, 23.252824629475377, 17.28138384144528, 17.58205127151582, 16.600687851690655, 16.29076760733369, 44.686705076032936, 10.931107305677623, 63.819585433519244, 24.225050996427353, 19.29885617549938], "episode_lengths": [295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 295, 295, 1117, 812, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.068790070272261, "mean_inference_ms": 6.771867619015629, "mean_action_processing_ms": 0.46545549358794963, "mean_env_wait_ms": 20.47897398752268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030541181564331055, "StateBufferConnector_ms": 0.02104353904724121, "ViewRequirementAgentConnector_ms": 0.7596437931060791}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 716117, "num_agent_steps_trained": 716117, "num_env_steps_sampled": 716117, "num_env_steps_trained": 716117, "num_env_steps_sampled_this_iter": 7418, "num_env_steps_trained_this_iter": 7418, "num_env_steps_sampled_throughput_per_sec": 194.0231984876025, "num_env_steps_trained_throughput_per_sec": 194.0231984876025, "timesteps_total": 716117, "num_steps_trained_this_iter": 7418, "agent_timesteps_total": 716117, "timers": {"training_iteration_time_ms": 44779.103, "sample_time_ms": 31944.71, "load_time_ms": 1141.237, "load_throughput": 7738.794, "learn_time_ms": 11185.218, "learn_throughput": 789.596, "synch_weights_time_ms": 441.544}, "counters": {"num_env_steps_sampled": 716117, "num_env_steps_trained": 716117, "num_agent_steps_sampled": 716117, "num_agent_steps_trained": 716117}, "done": false, "episodes_total": 1096, "training_iteration": 78, "trial_id": "32ccc_00000", "date": "2025-06-07_13-00-23", "timestamp": 1749294023, "time_this_iter_s": 38.24840760231018, "time_total_s": 3543.287039756775, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3543.287039756775, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 53.834782608695654, "ram_util_percent": 86.51956521739129, "gpu_util_percent0": 0.06326086956521738, "vram_util_percent0": 0.9650065104166663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.283882999999998e-05, "total_loss": -0.08843189613362483, "policy_loss": -0.004754162397875916, "vf_loss": 0.06670649547013455, "vf_explained_var": 0.9265005586668849, "kl": 0.011856247871314304, "entropy": 16.38337916135788, "entropy_coeff": 0.0064194149999999995}, "model": {}, "num_grad_updates_lifetime": 25370.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 725179, "num_env_steps_trained": 725179, "num_agent_steps_sampled": 725179, "num_agent_steps_trained": 725179}, "sampler_results": {"episode_reward_max": 95.04313358562044, "episode_reward_min": -48.230293153943116, "episode_reward_mean": 17.99234614411028, "episode_len_mean": 620.75, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.606386572751218, 25.16661433898837, 53.529388503036095, 18.49866726460215, 33.05907988663454, 23.288770774255216, 12.99238258140769, 8.263118577539618, 56.45306773140399, 17.85415758487447, 20.41636322082715, 18.96318185464498, 15.359361947649194, -31.883444287492136, -0.5237553040877677, 43.02660144995689, 18.7065440683397, 13.999293539011438, 18.23152134539801, 95.04313358562044, -12.33685147333147, 6.823475627176256, 20.10347072876908, 16.422186417054178, 13.199388847548935, -38.93577881326402, 32.75882631336597, 21.032567083121023, 16.900987832649875, 24.226546218371578, 3.6333697343633813, 23.568748062414173, 25.973154240502108, 23.90166735538349, 20.31104368210178, 14.570125376375255, 49.329295992845275, 15.134804938572206, 10.806772431508643, 20.063104523258605, 8.800780713172449, 10.953033581666222, 10.328877875830658, 22.997777484069534, 18.567410924414613, -32.7506228789173, 38.20844528592947, 23.057133725310308, 17.04785807600087, 14.003584573482927, 36.480465439952326, 6.1573643127807545, 19.095773504539558, 19.13952420269612, 10.38890509839119, 24.507724713356776, 9.851476834785531, 14.456620316149676, 21.47774047402249, 22.10659353226329, 16.490133324318975, 42.00277122271163, 22.121621723463107, 10.824658216335195, -24.725038990282872, 7.126539127611878, 15.649213221865459, 16.25606982339785, -48.230293153943116, 4.744488068401431, 16.219351957467776, 17.83440481926735, 18.391662621594072, -0.498254889125261, 17.495655388142627, 13.844735144382403, 23.252824629475377, 17.28138384144528, 17.58205127151582, 16.600687851690655, 16.29076760733369, 44.686705076032936, 10.931107305677623, 63.819585433519244, 24.225050996427353, 19.29885617549938, 30.045881538012754, 26.995039762587123, 12.894480355622894, 21.396071149584298, 13.13050861913158, 15.385474992831163, 3.715415651698863, 46.75122524779872, 51.58830753980168, 19.688654137085493, 11.989012259261369, -12.645793908241279, 15.298787450520667, 46.07100365706147], "episode_lengths": [295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 295, 295, 1117, 812, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0708743606209, "mean_inference_ms": 6.774048235027705, "mean_action_processing_ms": 0.4657912193388228, "mean_env_wait_ms": 20.483475731016178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03836870193481445, "StateBufferConnector_ms": 0.019081592559814453, "ViewRequirementAgentConnector_ms": 0.7840604782104492}}, "episode_reward_max": 95.04313358562044, "episode_reward_min": -48.230293153943116, "episode_reward_mean": 17.99234614411028, "episode_len_mean": 620.75, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.606386572751218, 25.16661433898837, 53.529388503036095, 18.49866726460215, 33.05907988663454, 23.288770774255216, 12.99238258140769, 8.263118577539618, 56.45306773140399, 17.85415758487447, 20.41636322082715, 18.96318185464498, 15.359361947649194, -31.883444287492136, -0.5237553040877677, 43.02660144995689, 18.7065440683397, 13.999293539011438, 18.23152134539801, 95.04313358562044, -12.33685147333147, 6.823475627176256, 20.10347072876908, 16.422186417054178, 13.199388847548935, -38.93577881326402, 32.75882631336597, 21.032567083121023, 16.900987832649875, 24.226546218371578, 3.6333697343633813, 23.568748062414173, 25.973154240502108, 23.90166735538349, 20.31104368210178, 14.570125376375255, 49.329295992845275, 15.134804938572206, 10.806772431508643, 20.063104523258605, 8.800780713172449, 10.953033581666222, 10.328877875830658, 22.997777484069534, 18.567410924414613, -32.7506228789173, 38.20844528592947, 23.057133725310308, 17.04785807600087, 14.003584573482927, 36.480465439952326, 6.1573643127807545, 19.095773504539558, 19.13952420269612, 10.38890509839119, 24.507724713356776, 9.851476834785531, 14.456620316149676, 21.47774047402249, 22.10659353226329, 16.490133324318975, 42.00277122271163, 22.121621723463107, 10.824658216335195, -24.725038990282872, 7.126539127611878, 15.649213221865459, 16.25606982339785, -48.230293153943116, 4.744488068401431, 16.219351957467776, 17.83440481926735, 18.391662621594072, -0.498254889125261, 17.495655388142627, 13.844735144382403, 23.252824629475377, 17.28138384144528, 17.58205127151582, 16.600687851690655, 16.29076760733369, 44.686705076032936, 10.931107305677623, 63.819585433519244, 24.225050996427353, 19.29885617549938, 30.045881538012754, 26.995039762587123, 12.894480355622894, 21.396071149584298, 13.13050861913158, 15.385474992831163, 3.715415651698863, 46.75122524779872, 51.58830753980168, 19.688654137085493, 11.989012259261369, -12.645793908241279, 15.298787450520667, 46.07100365706147], "episode_lengths": [295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 295, 295, 1117, 812, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0708743606209, "mean_inference_ms": 6.774048235027705, "mean_action_processing_ms": 0.4657912193388228, "mean_env_wait_ms": 20.483475731016178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03836870193481445, "StateBufferConnector_ms": 0.019081592559814453, "ViewRequirementAgentConnector_ms": 0.7840604782104492}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 725179, "num_agent_steps_trained": 725179, "num_env_steps_sampled": 725179, "num_env_steps_trained": 725179, "num_env_steps_sampled_this_iter": 9062, "num_env_steps_trained_this_iter": 9062, "num_env_steps_sampled_throughput_per_sec": 194.45436778525166, "num_env_steps_trained_throughput_per_sec": 194.45436778525166, "timesteps_total": 725179, "num_steps_trained_this_iter": 9062, "agent_timesteps_total": 725179, "timers": {"training_iteration_time_ms": 44430.514, "sample_time_ms": 31814.275, "load_time_ms": 1136.216, "load_throughput": 7669.139, "learn_time_ms": 10969.884, "learn_throughput": 794.338, "synch_weights_time_ms": 445.003}, "counters": {"num_env_steps_sampled": 725179, "num_env_steps_trained": 725179, "num_agent_steps_sampled": 725179, "num_agent_steps_trained": 725179}, "done": false, "episodes_total": 1110, "training_iteration": 79, "trial_id": "32ccc_00000", "date": "2025-06-07_13-01-10", "timestamp": 1749294070, "time_this_iter_s": 46.62018847465515, "time_total_s": 3589.90722823143, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3589.90722823143, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 54.589285714285715, "ram_util_percent": 87.72142857142858, "gpu_util_percent0": 0.1692857142857143, "vram_util_percent0": 0.9650065104166667}}
{"evaluation": {"sampler_results": {"episode_reward_max": -12.088701390477736, "episode_reward_min": -14.89968626815045, "episode_reward_mean": -13.677031662552505, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.088701390477736, -13.287731090557086, -13.444354749679011, -14.66468481389825, -14.89968626815045], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.609496068831388, "mean_inference_ms": 3.6838538878930196, "mean_action_processing_ms": 0.2621457784367942, "mean_env_wait_ms": 11.160094944327248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12822628021240234}}, "episode_reward_max": -12.088701390477736, "episode_reward_min": -14.89968626815045, "episode_reward_mean": -13.677031662552505, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.088701390477736, -13.287731090557086, -13.444354749679011, -14.66468481389825, -14.89968626815045], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.609496068831388, "mean_inference_ms": 3.6838538878930196, "mean_action_processing_ms": 0.2621457784367942, "mean_env_wait_ms": 11.160094944327248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12822628021240234}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.274820999999999e-05, "total_loss": -0.1158078533859225, "policy_loss": -0.03181096349417203, "vf_loss": 0.06105134835233912, "vf_explained_var": 0.9457278018817306, "kl": 0.011738440529783317, "entropy": 16.281438970565794, "entropy_coeff": 0.006374105}, "model": {}, "num_grad_updates_lifetime": 25690.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 734241, "num_env_steps_trained": 734241, "num_agent_steps_sampled": 734241, "num_agent_steps_trained": 734241}, "sampler_results": {"episode_reward_max": 95.04313358562044, "episode_reward_min": -48.230293153943116, "episode_reward_mean": 18.325727672088934, "episode_len_mean": 612.53, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5237553040877677, 43.02660144995689, 18.7065440683397, 13.999293539011438, 18.23152134539801, 95.04313358562044, -12.33685147333147, 6.823475627176256, 20.10347072876908, 16.422186417054178, 13.199388847548935, -38.93577881326402, 32.75882631336597, 21.032567083121023, 16.900987832649875, 24.226546218371578, 3.6333697343633813, 23.568748062414173, 25.973154240502108, 23.90166735538349, 20.31104368210178, 14.570125376375255, 49.329295992845275, 15.134804938572206, 10.806772431508643, 20.063104523258605, 8.800780713172449, 10.953033581666222, 10.328877875830658, 22.997777484069534, 18.567410924414613, -32.7506228789173, 38.20844528592947, 23.057133725310308, 17.04785807600087, 14.003584573482927, 36.480465439952326, 6.1573643127807545, 19.095773504539558, 19.13952420269612, 10.38890509839119, 24.507724713356776, 9.851476834785531, 14.456620316149676, 21.47774047402249, 22.10659353226329, 16.490133324318975, 42.00277122271163, 22.121621723463107, 10.824658216335195, -24.725038990282872, 7.126539127611878, 15.649213221865459, 16.25606982339785, -48.230293153943116, 4.744488068401431, 16.219351957467776, 17.83440481926735, 18.391662621594072, -0.498254889125261, 17.495655388142627, 13.844735144382403, 23.252824629475377, 17.28138384144528, 17.58205127151582, 16.600687851690655, 16.29076760733369, 44.686705076032936, 10.931107305677623, 63.819585433519244, 24.225050996427353, 19.29885617549938, 30.045881538012754, 26.995039762587123, 12.894480355622894, 21.396071149584298, 13.13050861913158, 15.385474992831163, 3.715415651698863, 46.75122524779872, 51.58830753980168, 19.688654137085493, 11.989012259261369, -12.645793908241279, 15.298787450520667, 46.07100365706147, 9.086590343011112, 57.83839661500835, 35.601926137063, 24.17156601364265, 11.827613101963834, 2.8762309681687235, 21.012779431053147, 18.88086692212191, 77.60090870854685, 14.567143011920363, 17.87467818016536, 18.729402783050617, 4.687586090736472, 5.149561042535825], "episode_lengths": [1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 295, 295, 1117, 812, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.07219564897522, "mean_inference_ms": 6.775248821270002, "mean_action_processing_ms": 0.4660096952238723, "mean_env_wait_ms": 20.48619573124038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030034542083740234, "StateBufferConnector_ms": 0.01808953285217285, "ViewRequirementAgentConnector_ms": 0.8097655773162842}}, "episode_reward_max": 95.04313358562044, "episode_reward_min": -48.230293153943116, "episode_reward_mean": 18.325727672088934, "episode_len_mean": 612.53, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-0.5237553040877677, 43.02660144995689, 18.7065440683397, 13.999293539011438, 18.23152134539801, 95.04313358562044, -12.33685147333147, 6.823475627176256, 20.10347072876908, 16.422186417054178, 13.199388847548935, -38.93577881326402, 32.75882631336597, 21.032567083121023, 16.900987832649875, 24.226546218371578, 3.6333697343633813, 23.568748062414173, 25.973154240502108, 23.90166735538349, 20.31104368210178, 14.570125376375255, 49.329295992845275, 15.134804938572206, 10.806772431508643, 20.063104523258605, 8.800780713172449, 10.953033581666222, 10.328877875830658, 22.997777484069534, 18.567410924414613, -32.7506228789173, 38.20844528592947, 23.057133725310308, 17.04785807600087, 14.003584573482927, 36.480465439952326, 6.1573643127807545, 19.095773504539558, 19.13952420269612, 10.38890509839119, 24.507724713356776, 9.851476834785531, 14.456620316149676, 21.47774047402249, 22.10659353226329, 16.490133324318975, 42.00277122271163, 22.121621723463107, 10.824658216335195, -24.725038990282872, 7.126539127611878, 15.649213221865459, 16.25606982339785, -48.230293153943116, 4.744488068401431, 16.219351957467776, 17.83440481926735, 18.391662621594072, -0.498254889125261, 17.495655388142627, 13.844735144382403, 23.252824629475377, 17.28138384144528, 17.58205127151582, 16.600687851690655, 16.29076760733369, 44.686705076032936, 10.931107305677623, 63.819585433519244, 24.225050996427353, 19.29885617549938, 30.045881538012754, 26.995039762587123, 12.894480355622894, 21.396071149584298, 13.13050861913158, 15.385474992831163, 3.715415651698863, 46.75122524779872, 51.58830753980168, 19.688654137085493, 11.989012259261369, -12.645793908241279, 15.298787450520667, 46.07100365706147, 9.086590343011112, 57.83839661500835, 35.601926137063, 24.17156601364265, 11.827613101963834, 2.8762309681687235, 21.012779431053147, 18.88086692212191, 77.60090870854685, 14.567143011920363, 17.87467818016536, 18.729402783050617, 4.687586090736472, 5.149561042535825], "episode_lengths": [1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 295, 295, 1117, 812, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.07219564897522, "mean_inference_ms": 6.775248821270002, "mean_action_processing_ms": 0.4660096952238723, "mean_env_wait_ms": 20.48619573124038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030034542083740234, "StateBufferConnector_ms": 0.01808953285217285, "ViewRequirementAgentConnector_ms": 0.8097655773162842}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 734241, "num_agent_steps_trained": 734241, "num_env_steps_sampled": 734241, "num_env_steps_trained": 734241, "num_env_steps_sampled_this_iter": 9062, "num_env_steps_trained_this_iter": 9062, "num_env_steps_sampled_throughput_per_sec": 194.8588960735731, "num_env_steps_trained_throughput_per_sec": 194.8588960735731, "timesteps_total": 734241, "num_steps_trained_this_iter": 9062, "agent_timesteps_total": 734241, "timers": {"training_iteration_time_ms": 44296.909, "sample_time_ms": 31717.958, "load_time_ms": 1130.153, "load_throughput": 7637.548, "learn_time_ms": 10942.477, "learn_throughput": 788.816, "synch_weights_time_ms": 442.796}, "counters": {"num_env_steps_sampled": 734241, "num_env_steps_trained": 734241, "num_agent_steps_sampled": 734241, "num_agent_steps_trained": 734241}, "done": false, "episodes_total": 1124, "training_iteration": 80, "trial_id": "32ccc_00000", "date": "2025-06-07_13-02-14", "timestamp": 1749294134, "time_this_iter_s": 63.73350763320923, "time_total_s": 3653.6407358646393, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3653.6407358646393, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 45.1012987012987, "ram_util_percent": 87.86363636363635, "gpu_util_percent0": 0.1248051948051948, "vram_util_percent0": 0.965006510416667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.265759000000002e-05, "total_loss": -0.10463609952566913, "policy_loss": -0.019930480918264947, "vf_loss": 0.050302999746054414, "vf_explained_var": 0.939964372292161, "kl": 0.013243173560704235, "entropy": 16.030210667848586, "entropy_coeff": 0.006328795}, "model": {}, "num_grad_updates_lifetime": 26010.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 743303, "num_env_steps_trained": 743303, "num_agent_steps_sampled": 743303, "num_agent_steps_trained": 743303}, "sampler_results": {"episode_reward_max": 100.44763029056809, "episode_reward_min": -48.230293153943116, "episode_reward_mean": 21.152116563645468, "episode_len_mean": 604.31, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.900987832649875, 24.226546218371578, 3.6333697343633813, 23.568748062414173, 25.973154240502108, 23.90166735538349, 20.31104368210178, 14.570125376375255, 49.329295992845275, 15.134804938572206, 10.806772431508643, 20.063104523258605, 8.800780713172449, 10.953033581666222, 10.328877875830658, 22.997777484069534, 18.567410924414613, -32.7506228789173, 38.20844528592947, 23.057133725310308, 17.04785807600087, 14.003584573482927, 36.480465439952326, 6.1573643127807545, 19.095773504539558, 19.13952420269612, 10.38890509839119, 24.507724713356776, 9.851476834785531, 14.456620316149676, 21.47774047402249, 22.10659353226329, 16.490133324318975, 42.00277122271163, 22.121621723463107, 10.824658216335195, -24.725038990282872, 7.126539127611878, 15.649213221865459, 16.25606982339785, -48.230293153943116, 4.744488068401431, 16.219351957467776, 17.83440481926735, 18.391662621594072, -0.498254889125261, 17.495655388142627, 13.844735144382403, 23.252824629475377, 17.28138384144528, 17.58205127151582, 16.600687851690655, 16.29076760733369, 44.686705076032936, 10.931107305677623, 63.819585433519244, 24.225050996427353, 19.29885617549938, 30.045881538012754, 26.995039762587123, 12.894480355622894, 21.396071149584298, 13.13050861913158, 15.385474992831163, 3.715415651698863, 46.75122524779872, 51.58830753980168, 19.688654137085493, 11.989012259261369, -12.645793908241279, 15.298787450520667, 46.07100365706147, 9.086590343011112, 57.83839661500835, 35.601926137063, 24.17156601364265, 11.827613101963834, 2.8762309681687235, 21.012779431053147, 18.88086692212191, 77.60090870854685, 14.567143011920363, 17.87467818016536, 18.729402783050617, 4.687586090736472, 5.149561042535825, 37.03853151123482, 100.44763029056809, 19.99531419589145, 61.091646040388206, 85.9136888927144, 82.33347063588037, 16.22806991927441, 18.300641921760356, 17.38667644374686, 28.88019876623261, 15.846307340857848, 17.936905513503007, 13.622574318447626, 15.167856779831741], "episode_lengths": [295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 295, 295, 1117, 812, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0735612206448577, "mean_inference_ms": 6.776644249753608, "mean_action_processing_ms": 0.46623695403163423, "mean_env_wait_ms": 20.48951072314208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03592658042907715, "StateBufferConnector_ms": 0.018095016479492188, "ViewRequirementAgentConnector_ms": 0.7988724708557129}}, "episode_reward_max": 100.44763029056809, "episode_reward_min": -48.230293153943116, "episode_reward_mean": 21.152116563645468, "episode_len_mean": 604.31, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.900987832649875, 24.226546218371578, 3.6333697343633813, 23.568748062414173, 25.973154240502108, 23.90166735538349, 20.31104368210178, 14.570125376375255, 49.329295992845275, 15.134804938572206, 10.806772431508643, 20.063104523258605, 8.800780713172449, 10.953033581666222, 10.328877875830658, 22.997777484069534, 18.567410924414613, -32.7506228789173, 38.20844528592947, 23.057133725310308, 17.04785807600087, 14.003584573482927, 36.480465439952326, 6.1573643127807545, 19.095773504539558, 19.13952420269612, 10.38890509839119, 24.507724713356776, 9.851476834785531, 14.456620316149676, 21.47774047402249, 22.10659353226329, 16.490133324318975, 42.00277122271163, 22.121621723463107, 10.824658216335195, -24.725038990282872, 7.126539127611878, 15.649213221865459, 16.25606982339785, -48.230293153943116, 4.744488068401431, 16.219351957467776, 17.83440481926735, 18.391662621594072, -0.498254889125261, 17.495655388142627, 13.844735144382403, 23.252824629475377, 17.28138384144528, 17.58205127151582, 16.600687851690655, 16.29076760733369, 44.686705076032936, 10.931107305677623, 63.819585433519244, 24.225050996427353, 19.29885617549938, 30.045881538012754, 26.995039762587123, 12.894480355622894, 21.396071149584298, 13.13050861913158, 15.385474992831163, 3.715415651698863, 46.75122524779872, 51.58830753980168, 19.688654137085493, 11.989012259261369, -12.645793908241279, 15.298787450520667, 46.07100365706147, 9.086590343011112, 57.83839661500835, 35.601926137063, 24.17156601364265, 11.827613101963834, 2.8762309681687235, 21.012779431053147, 18.88086692212191, 77.60090870854685, 14.567143011920363, 17.87467818016536, 18.729402783050617, 4.687586090736472, 5.149561042535825, 37.03853151123482, 100.44763029056809, 19.99531419589145, 61.091646040388206, 85.9136888927144, 82.33347063588037, 16.22806991927441, 18.300641921760356, 17.38667644374686, 28.88019876623261, 15.846307340857848, 17.936905513503007, 13.622574318447626, 15.167856779831741], "episode_lengths": [295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 295, 295, 1117, 812, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0735612206448577, "mean_inference_ms": 6.776644249753608, "mean_action_processing_ms": 0.46623695403163423, "mean_env_wait_ms": 20.48951072314208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03592658042907715, "StateBufferConnector_ms": 0.018095016479492188, "ViewRequirementAgentConnector_ms": 0.7988724708557129}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 743303, "num_agent_steps_trained": 743303, "num_env_steps_sampled": 743303, "num_env_steps_trained": 743303, "num_env_steps_sampled_this_iter": 9062, "num_env_steps_trained_this_iter": 9062, "num_env_steps_sampled_throughput_per_sec": 191.95934699106462, "num_env_steps_trained_throughput_per_sec": 191.95934699106462, "timesteps_total": 743303, "num_steps_trained_this_iter": 9062, "agent_timesteps_total": 743303, "timers": {"training_iteration_time_ms": 45568.95, "sample_time_ms": 32165.598, "load_time_ms": 1171.802, "load_throughput": 7637.21, "learn_time_ms": 11728.668, "learn_throughput": 763.028, "synch_weights_time_ms": 437.215}, "counters": {"num_env_steps_sampled": 743303, "num_env_steps_trained": 743303, "num_agent_steps_sampled": 743303, "num_agent_steps_trained": 743303}, "done": false, "episodes_total": 1138, "training_iteration": 81, "trial_id": "32ccc_00000", "date": "2025-06-07_13-03-01", "timestamp": 1749294181, "time_this_iter_s": 47.22490048408508, "time_total_s": 3700.8656363487244, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3700.8656363487244, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 54.11052631578948, "ram_util_percent": 87.80526315789473, "gpu_util_percent0": 0.16333333333333333, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.256697000000001e-05, "total_loss": -0.10887466513767566, "policy_loss": -0.025079492394664758, "vf_loss": 0.05510556054778579, "vf_explained_var": 0.9434676043870972, "kl": 0.013423123311999583, "entropy": 16.23378394522318, "entropy_coeff": 0.006283485000000001}, "model": {}, "num_grad_updates_lifetime": 26375.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 754831, "num_env_steps_trained": 754831, "num_agent_steps_sampled": 754831, "num_agent_steps_trained": 754831}, "sampler_results": {"episode_reward_max": 100.44763029056809, "episode_reward_min": -48.230293153943116, "episode_reward_mean": 22.885221743559956, "episode_len_mean": 653.63, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.328877875830658, 22.997777484069534, 18.567410924414613, -32.7506228789173, 38.20844528592947, 23.057133725310308, 17.04785807600087, 14.003584573482927, 36.480465439952326, 6.1573643127807545, 19.095773504539558, 19.13952420269612, 10.38890509839119, 24.507724713356776, 9.851476834785531, 14.456620316149676, 21.47774047402249, 22.10659353226329, 16.490133324318975, 42.00277122271163, 22.121621723463107, 10.824658216335195, -24.725038990282872, 7.126539127611878, 15.649213221865459, 16.25606982339785, -48.230293153943116, 4.744488068401431, 16.219351957467776, 17.83440481926735, 18.391662621594072, -0.498254889125261, 17.495655388142627, 13.844735144382403, 23.252824629475377, 17.28138384144528, 17.58205127151582, 16.600687851690655, 16.29076760733369, 44.686705076032936, 10.931107305677623, 63.819585433519244, 24.225050996427353, 19.29885617549938, 30.045881538012754, 26.995039762587123, 12.894480355622894, 21.396071149584298, 13.13050861913158, 15.385474992831163, 3.715415651698863, 46.75122524779872, 51.58830753980168, 19.688654137085493, 11.989012259261369, -12.645793908241279, 15.298787450520667, 46.07100365706147, 9.086590343011112, 57.83839661500835, 35.601926137063, 24.17156601364265, 11.827613101963834, 2.8762309681687235, 21.012779431053147, 18.88086692212191, 77.60090870854685, 14.567143011920363, 17.87467818016536, 18.729402783050617, 4.687586090736472, 5.149561042535825, 37.03853151123482, 100.44763029056809, 19.99531419589145, 61.091646040388206, 85.9136888927144, 82.33347063588037, 16.22806991927441, 18.300641921760356, 17.38667644374686, 28.88019876623261, 15.846307340857848, 17.936905513503007, 13.622574318447626, 15.167856779831741, 33.741190676121896, 16.134392737033764, 59.24269558442348, 18.43129982711365, 40.854607090180565, 18.59938763098962, 29.081783486886394, 14.482032748529225, 5.7531231920676795, 28.617766146256756, 32.143416473931445, 19.219947899444445, 85.54426663909489, 39.638042542559596], "episode_lengths": [1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 295, 295, 1117, 812, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0748935686189856, "mean_inference_ms": 6.778673930057661, "mean_action_processing_ms": 0.4665233502013361, "mean_env_wait_ms": 20.49443422936482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03289532661437988, "StateBufferConnector_ms": 0.020119428634643555, "ViewRequirementAgentConnector_ms": 0.7711470127105713}}, "episode_reward_max": 100.44763029056809, "episode_reward_min": -48.230293153943116, "episode_reward_mean": 22.885221743559956, "episode_len_mean": 653.63, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.328877875830658, 22.997777484069534, 18.567410924414613, -32.7506228789173, 38.20844528592947, 23.057133725310308, 17.04785807600087, 14.003584573482927, 36.480465439952326, 6.1573643127807545, 19.095773504539558, 19.13952420269612, 10.38890509839119, 24.507724713356776, 9.851476834785531, 14.456620316149676, 21.47774047402249, 22.10659353226329, 16.490133324318975, 42.00277122271163, 22.121621723463107, 10.824658216335195, -24.725038990282872, 7.126539127611878, 15.649213221865459, 16.25606982339785, -48.230293153943116, 4.744488068401431, 16.219351957467776, 17.83440481926735, 18.391662621594072, -0.498254889125261, 17.495655388142627, 13.844735144382403, 23.252824629475377, 17.28138384144528, 17.58205127151582, 16.600687851690655, 16.29076760733369, 44.686705076032936, 10.931107305677623, 63.819585433519244, 24.225050996427353, 19.29885617549938, 30.045881538012754, 26.995039762587123, 12.894480355622894, 21.396071149584298, 13.13050861913158, 15.385474992831163, 3.715415651698863, 46.75122524779872, 51.58830753980168, 19.688654137085493, 11.989012259261369, -12.645793908241279, 15.298787450520667, 46.07100365706147, 9.086590343011112, 57.83839661500835, 35.601926137063, 24.17156601364265, 11.827613101963834, 2.8762309681687235, 21.012779431053147, 18.88086692212191, 77.60090870854685, 14.567143011920363, 17.87467818016536, 18.729402783050617, 4.687586090736472, 5.149561042535825, 37.03853151123482, 100.44763029056809, 19.99531419589145, 61.091646040388206, 85.9136888927144, 82.33347063588037, 16.22806991927441, 18.300641921760356, 17.38667644374686, 28.88019876623261, 15.846307340857848, 17.936905513503007, 13.622574318447626, 15.167856779831741, 33.741190676121896, 16.134392737033764, 59.24269558442348, 18.43129982711365, 40.854607090180565, 18.59938763098962, 29.081783486886394, 14.482032748529225, 5.7531231920676795, 28.617766146256756, 32.143416473931445, 19.219947899444445, 85.54426663909489, 39.638042542559596], "episode_lengths": [1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 295, 295, 1117, 812, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0748935686189856, "mean_inference_ms": 6.778673930057661, "mean_action_processing_ms": 0.4665233502013361, "mean_env_wait_ms": 20.49443422936482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03289532661437988, "StateBufferConnector_ms": 0.020119428634643555, "ViewRequirementAgentConnector_ms": 0.7711470127105713}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 754831, "num_agent_steps_trained": 754831, "num_env_steps_sampled": 754831, "num_env_steps_trained": 754831, "num_env_steps_sampled_this_iter": 11528, "num_env_steps_trained_this_iter": 11528, "num_env_steps_sampled_throughput_per_sec": 220.54193915941784, "num_env_steps_trained_throughput_per_sec": 220.54193915941784, "timesteps_total": 754831, "num_steps_trained_this_iter": 11528, "agent_timesteps_total": 754831, "timers": {"training_iteration_time_ms": 45882.157, "sample_time_ms": 32328.221, "load_time_ms": 1227.982, "load_throughput": 7421.686, "learn_time_ms": 11821.61, "learn_throughput": 770.936, "synch_weights_time_ms": 439.325}, "counters": {"num_env_steps_sampled": 754831, "num_env_steps_trained": 754831, "num_agent_steps_sampled": 754831, "num_agent_steps_trained": 754831}, "done": false, "episodes_total": 1152, "training_iteration": 82, "trial_id": "32ccc_00000", "date": "2025-06-07_13-03-53", "timestamp": 1749294233, "time_this_iter_s": 52.302539110183716, "time_total_s": 3753.168175458908, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3753.168175458908, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 61.2274193548387, "ram_util_percent": 88.091935483871, "gpu_util_percent0": 0.17274193548387098, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.245169e-05, "total_loss": -0.07846058374270796, "policy_loss": 0.002756370878677654, "vf_loss": 0.06477534093607504, "vf_explained_var": 0.9442251927577532, "kl": 0.011856719032730839, "entropy": 16.40446493442242, "entropy_coeff": 0.006225844999999999}, "model": {}, "num_grad_updates_lifetime": 26710.5, "diff_num_grad_updates_vs_sampler_policy": 129.5}}, "num_env_steps_sampled": 762249, "num_env_steps_trained": 762249, "num_agent_steps_sampled": 762249, "num_agent_steps_trained": 762249}, "sampler_results": {"episode_reward_max": 100.44763029056809, "episode_reward_min": -48.230293153943116, "episode_reward_mean": 23.358432844604096, "episode_len_mean": 628.97, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.851476834785531, 14.456620316149676, 21.47774047402249, 22.10659353226329, 16.490133324318975, 42.00277122271163, 22.121621723463107, 10.824658216335195, -24.725038990282872, 7.126539127611878, 15.649213221865459, 16.25606982339785, -48.230293153943116, 4.744488068401431, 16.219351957467776, 17.83440481926735, 18.391662621594072, -0.498254889125261, 17.495655388142627, 13.844735144382403, 23.252824629475377, 17.28138384144528, 17.58205127151582, 16.600687851690655, 16.29076760733369, 44.686705076032936, 10.931107305677623, 63.819585433519244, 24.225050996427353, 19.29885617549938, 30.045881538012754, 26.995039762587123, 12.894480355622894, 21.396071149584298, 13.13050861913158, 15.385474992831163, 3.715415651698863, 46.75122524779872, 51.58830753980168, 19.688654137085493, 11.989012259261369, -12.645793908241279, 15.298787450520667, 46.07100365706147, 9.086590343011112, 57.83839661500835, 35.601926137063, 24.17156601364265, 11.827613101963834, 2.8762309681687235, 21.012779431053147, 18.88086692212191, 77.60090870854685, 14.567143011920363, 17.87467818016536, 18.729402783050617, 4.687586090736472, 5.149561042535825, 37.03853151123482, 100.44763029056809, 19.99531419589145, 61.091646040388206, 85.9136888927144, 82.33347063588037, 16.22806991927441, 18.300641921760356, 17.38667644374686, 28.88019876623261, 15.846307340857848, 17.936905513503007, 13.622574318447626, 15.167856779831741, 33.741190676121896, 16.134392737033764, 59.24269558442348, 18.43129982711365, 40.854607090180565, 18.59938763098962, 29.081783486886394, 14.482032748529225, 5.7531231920676795, 28.617766146256756, 32.143416473931445, 19.219947899444445, 85.54426663909489, 39.638042542559596, 16.62666767148987, 54.840387214923794, 39.52236865898221, 20.78058811607678, 17.06551649577251, 16.21963416070123, 13.133174472935343, 20.693658600810345, 16.88904575346438, 19.796367186624895, 14.703720807409788, 18.92737381656279, -46.75617663606425, 52.109006122562356], "episode_lengths": [1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 295, 295, 1117, 812, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 295, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0766450231962823, "mean_inference_ms": 6.781095851165824, "mean_action_processing_ms": 0.4668107648861345, "mean_env_wait_ms": 20.50051834077954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03388237953186035, "StateBufferConnector_ms": 0.022083520889282227, "ViewRequirementAgentConnector_ms": 0.7976169586181641}}, "episode_reward_max": 100.44763029056809, "episode_reward_min": -48.230293153943116, "episode_reward_mean": 23.358432844604096, "episode_len_mean": 628.97, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.851476834785531, 14.456620316149676, 21.47774047402249, 22.10659353226329, 16.490133324318975, 42.00277122271163, 22.121621723463107, 10.824658216335195, -24.725038990282872, 7.126539127611878, 15.649213221865459, 16.25606982339785, -48.230293153943116, 4.744488068401431, 16.219351957467776, 17.83440481926735, 18.391662621594072, -0.498254889125261, 17.495655388142627, 13.844735144382403, 23.252824629475377, 17.28138384144528, 17.58205127151582, 16.600687851690655, 16.29076760733369, 44.686705076032936, 10.931107305677623, 63.819585433519244, 24.225050996427353, 19.29885617549938, 30.045881538012754, 26.995039762587123, 12.894480355622894, 21.396071149584298, 13.13050861913158, 15.385474992831163, 3.715415651698863, 46.75122524779872, 51.58830753980168, 19.688654137085493, 11.989012259261369, -12.645793908241279, 15.298787450520667, 46.07100365706147, 9.086590343011112, 57.83839661500835, 35.601926137063, 24.17156601364265, 11.827613101963834, 2.8762309681687235, 21.012779431053147, 18.88086692212191, 77.60090870854685, 14.567143011920363, 17.87467818016536, 18.729402783050617, 4.687586090736472, 5.149561042535825, 37.03853151123482, 100.44763029056809, 19.99531419589145, 61.091646040388206, 85.9136888927144, 82.33347063588037, 16.22806991927441, 18.300641921760356, 17.38667644374686, 28.88019876623261, 15.846307340857848, 17.936905513503007, 13.622574318447626, 15.167856779831741, 33.741190676121896, 16.134392737033764, 59.24269558442348, 18.43129982711365, 40.854607090180565, 18.59938763098962, 29.081783486886394, 14.482032748529225, 5.7531231920676795, 28.617766146256756, 32.143416473931445, 19.219947899444445, 85.54426663909489, 39.638042542559596, 16.62666767148987, 54.840387214923794, 39.52236865898221, 20.78058811607678, 17.06551649577251, 16.21963416070123, 13.133174472935343, 20.693658600810345, 16.88904575346438, 19.796367186624895, 14.703720807409788, 18.92737381656279, -46.75617663606425, 52.109006122562356], "episode_lengths": [1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 295, 295, 1117, 812, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 295, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0766450231962823, "mean_inference_ms": 6.781095851165824, "mean_action_processing_ms": 0.4668107648861345, "mean_env_wait_ms": 20.50051834077954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03388237953186035, "StateBufferConnector_ms": 0.022083520889282227, "ViewRequirementAgentConnector_ms": 0.7976169586181641}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 762249, "num_agent_steps_trained": 762249, "num_env_steps_sampled": 762249, "num_env_steps_trained": 762249, "num_env_steps_sampled_this_iter": 7418, "num_env_steps_trained_this_iter": 7418, "num_env_steps_sampled_throughput_per_sec": 198.12526337525307, "num_env_steps_trained_throughput_per_sec": 198.12526337525307, "timesteps_total": 762249, "num_steps_trained_this_iter": 7418, "agent_timesteps_total": 762249, "timers": {"training_iteration_time_ms": 44384.476, "sample_time_ms": 31797.102, "load_time_ms": 1135.59, "load_throughput": 7663.595, "learn_time_ms": 10945.658, "learn_throughput": 795.082, "synch_weights_time_ms": 443.946}, "counters": {"num_env_steps_sampled": 762249, "num_env_steps_trained": 762249, "num_agent_steps_sampled": 762249, "num_agent_steps_trained": 762249}, "done": false, "episodes_total": 1166, "training_iteration": 83, "trial_id": "32ccc_00000", "date": "2025-06-07_13-04-31", "timestamp": 1749294271, "time_this_iter_s": 37.457091331481934, "time_total_s": 3790.62526679039, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3790.62526679039, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 54.324444444444445, "ram_util_percent": 86.40444444444445, "gpu_util_percent0": 0.060000000000000005, "vram_util_percent0": 0.9650065104166663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.237751000000001e-05, "total_loss": -0.07774473107719261, "policy_loss": -1.115359498986176e-05, "vf_loss": 0.07462815613086735, "vf_explained_var": 0.916222323349544, "kl": 0.009866563612241797, "entropy": 16.377340850830077, "entropy_coeff": 0.006188755000000002}, "model": {}, "num_grad_updates_lifetime": 27015.5, "diff_num_grad_updates_vs_sampler_policy": 174.5}}, "num_env_steps_sampled": 772133, "num_env_steps_trained": 772133, "num_agent_steps_sampled": 772133, "num_agent_steps_trained": 772133}, "sampler_results": {"episode_reward_max": 100.44763029056809, "episode_reward_min": -65.26201688339056, "episode_reward_mean": 24.38647312367602, "episode_len_mean": 640.24, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.219351957467776, 17.83440481926735, 18.391662621594072, -0.498254889125261, 17.495655388142627, 13.844735144382403, 23.252824629475377, 17.28138384144528, 17.58205127151582, 16.600687851690655, 16.29076760733369, 44.686705076032936, 10.931107305677623, 63.819585433519244, 24.225050996427353, 19.29885617549938, 30.045881538012754, 26.995039762587123, 12.894480355622894, 21.396071149584298, 13.13050861913158, 15.385474992831163, 3.715415651698863, 46.75122524779872, 51.58830753980168, 19.688654137085493, 11.989012259261369, -12.645793908241279, 15.298787450520667, 46.07100365706147, 9.086590343011112, 57.83839661500835, 35.601926137063, 24.17156601364265, 11.827613101963834, 2.8762309681687235, 21.012779431053147, 18.88086692212191, 77.60090870854685, 14.567143011920363, 17.87467818016536, 18.729402783050617, 4.687586090736472, 5.149561042535825, 37.03853151123482, 100.44763029056809, 19.99531419589145, 61.091646040388206, 85.9136888927144, 82.33347063588037, 16.22806991927441, 18.300641921760356, 17.38667644374686, 28.88019876623261, 15.846307340857848, 17.936905513503007, 13.622574318447626, 15.167856779831741, 33.741190676121896, 16.134392737033764, 59.24269558442348, 18.43129982711365, 40.854607090180565, 18.59938763098962, 29.081783486886394, 14.482032748529225, 5.7531231920676795, 28.617766146256756, 32.143416473931445, 19.219947899444445, 85.54426663909489, 39.638042542559596, 16.62666767148987, 54.840387214923794, 39.52236865898221, 20.78058811607678, 17.06551649577251, 16.21963416070123, 13.133174472935343, 20.693658600810345, 16.88904575346438, 19.796367186624895, 14.703720807409788, 18.92737381656279, -46.75617663606425, 52.109006122562356, 18.72747886229508, -65.26201688339056, 32.525366475915504, 62.383414535444906, 15.869306060171073, 19.30927379727785, 23.209008293167354, 13.661711339849967, 47.86586761301933, 17.808967482713456, 19.066311430435483, -39.40373205195338, 16.24586194890939, 50.94980274443777], "episode_lengths": [295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 295, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.078560926693003, "mean_inference_ms": 6.783225372529367, "mean_action_processing_ms": 0.46711763822099944, "mean_env_wait_ms": 20.506258306249347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03287482261657715, "StateBufferConnector_ms": 0.02391648292541504, "ViewRequirementAgentConnector_ms": 0.7968857288360596}}, "episode_reward_max": 100.44763029056809, "episode_reward_min": -65.26201688339056, "episode_reward_mean": 24.38647312367602, "episode_len_mean": 640.24, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.219351957467776, 17.83440481926735, 18.391662621594072, -0.498254889125261, 17.495655388142627, 13.844735144382403, 23.252824629475377, 17.28138384144528, 17.58205127151582, 16.600687851690655, 16.29076760733369, 44.686705076032936, 10.931107305677623, 63.819585433519244, 24.225050996427353, 19.29885617549938, 30.045881538012754, 26.995039762587123, 12.894480355622894, 21.396071149584298, 13.13050861913158, 15.385474992831163, 3.715415651698863, 46.75122524779872, 51.58830753980168, 19.688654137085493, 11.989012259261369, -12.645793908241279, 15.298787450520667, 46.07100365706147, 9.086590343011112, 57.83839661500835, 35.601926137063, 24.17156601364265, 11.827613101963834, 2.8762309681687235, 21.012779431053147, 18.88086692212191, 77.60090870854685, 14.567143011920363, 17.87467818016536, 18.729402783050617, 4.687586090736472, 5.149561042535825, 37.03853151123482, 100.44763029056809, 19.99531419589145, 61.091646040388206, 85.9136888927144, 82.33347063588037, 16.22806991927441, 18.300641921760356, 17.38667644374686, 28.88019876623261, 15.846307340857848, 17.936905513503007, 13.622574318447626, 15.167856779831741, 33.741190676121896, 16.134392737033764, 59.24269558442348, 18.43129982711365, 40.854607090180565, 18.59938763098962, 29.081783486886394, 14.482032748529225, 5.7531231920676795, 28.617766146256756, 32.143416473931445, 19.219947899444445, 85.54426663909489, 39.638042542559596, 16.62666767148987, 54.840387214923794, 39.52236865898221, 20.78058811607678, 17.06551649577251, 16.21963416070123, 13.133174472935343, 20.693658600810345, 16.88904575346438, 19.796367186624895, 14.703720807409788, 18.92737381656279, -46.75617663606425, 52.109006122562356, 18.72747886229508, -65.26201688339056, 32.525366475915504, 62.383414535444906, 15.869306060171073, 19.30927379727785, 23.209008293167354, 13.661711339849967, 47.86586761301933, 17.808967482713456, 19.066311430435483, -39.40373205195338, 16.24586194890939, 50.94980274443777], "episode_lengths": [295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 295, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.078560926693003, "mean_inference_ms": 6.783225372529367, "mean_action_processing_ms": 0.46711763822099944, "mean_env_wait_ms": 20.506258306249347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03287482261657715, "StateBufferConnector_ms": 0.02391648292541504, "ViewRequirementAgentConnector_ms": 0.7968857288360596}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 772133, "num_agent_steps_trained": 772133, "num_env_steps_sampled": 772133, "num_env_steps_trained": 772133, "num_env_steps_sampled_this_iter": 9884, "num_env_steps_trained_this_iter": 9884, "num_env_steps_sampled_throughput_per_sec": 208.09399639256227, "num_env_steps_trained_throughput_per_sec": 208.09399639256227, "timesteps_total": 772133, "num_steps_trained_this_iter": 9884, "agent_timesteps_total": 772133, "timers": {"training_iteration_time_ms": 44636.261, "sample_time_ms": 31895.702, "load_time_ms": 1160.493, "load_throughput": 7640.806, "learn_time_ms": 11069.381, "learn_throughput": 801.047, "synch_weights_time_ms": 448.586}, "counters": {"num_env_steps_sampled": 772133, "num_env_steps_trained": 772133, "num_agent_steps_sampled": 772133, "num_agent_steps_trained": 772133}, "done": false, "episodes_total": 1180, "training_iteration": 84, "trial_id": "32ccc_00000", "date": "2025-06-07_13-05-18", "timestamp": 1749294318, "time_this_iter_s": 47.528921604156494, "time_total_s": 3838.1541883945465, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3838.1541883945465, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 56.059649122807016, "ram_util_percent": 86.69649122807017, "gpu_util_percent0": 0.16456140350877194, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.227867000000002e-05, "total_loss": -0.10178106753958453, "policy_loss": -0.023085096552325733, "vf_loss": 0.06784919721941496, "vf_explained_var": 0.9186378933232406, "kl": 0.01304963627330948, "entropy": 16.39948504875446, "entropy_coeff": 0.006139335000000003}, "model": {}, "num_grad_updates_lifetime": 27335.5, "diff_num_grad_updates_vs_sampler_policy": 144.5}}, "num_env_steps_sampled": 780373, "num_env_steps_trained": 780373, "num_agent_steps_sampled": 780373, "num_agent_steps_trained": 780373}, "sampler_results": {"episode_reward_max": 100.44763029056809, "episode_reward_min": -65.26201688339056, "episode_reward_mean": 23.969618750312655, "episode_len_mean": 656.68, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.225050996427353, 19.29885617549938, 30.045881538012754, 26.995039762587123, 12.894480355622894, 21.396071149584298, 13.13050861913158, 15.385474992831163, 3.715415651698863, 46.75122524779872, 51.58830753980168, 19.688654137085493, 11.989012259261369, -12.645793908241279, 15.298787450520667, 46.07100365706147, 9.086590343011112, 57.83839661500835, 35.601926137063, 24.17156601364265, 11.827613101963834, 2.8762309681687235, 21.012779431053147, 18.88086692212191, 77.60090870854685, 14.567143011920363, 17.87467818016536, 18.729402783050617, 4.687586090736472, 5.149561042535825, 37.03853151123482, 100.44763029056809, 19.99531419589145, 61.091646040388206, 85.9136888927144, 82.33347063588037, 16.22806991927441, 18.300641921760356, 17.38667644374686, 28.88019876623261, 15.846307340857848, 17.936905513503007, 13.622574318447626, 15.167856779831741, 33.741190676121896, 16.134392737033764, 59.24269558442348, 18.43129982711365, 40.854607090180565, 18.59938763098962, 29.081783486886394, 14.482032748529225, 5.7531231920676795, 28.617766146256756, 32.143416473931445, 19.219947899444445, 85.54426663909489, 39.638042542559596, 16.62666767148987, 54.840387214923794, 39.52236865898221, 20.78058811607678, 17.06551649577251, 16.21963416070123, 13.133174472935343, 20.693658600810345, 16.88904575346438, 19.796367186624895, 14.703720807409788, 18.92737381656279, -46.75617663606425, 52.109006122562356, 18.72747886229508, -65.26201688339056, 32.525366475915504, 62.383414535444906, 15.869306060171073, 19.30927379727785, 23.209008293167354, 13.661711339849967, 47.86586761301933, 17.808967482713456, 19.066311430435483, -39.40373205195338, 16.24586194890939, 50.94980274443777, 32.63423656334743, 15.834924040592938, 16.020194517032415, 8.138718180209075, 15.899665644270577, 8.563055669675292, 36.905349645568656, 8.251506617626923, 23.563691619033815, 16.971288051592946, 16.6354623179081, 21.61523548707289, 12.884690506898757, 18.129211861254163], "episode_lengths": [1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.080078523275646, "mean_inference_ms": 6.785017195972092, "mean_action_processing_ms": 0.4673671187742189, "mean_env_wait_ms": 20.5117000615281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029870033264160156, "StateBufferConnector_ms": 0.024915218353271484, "ViewRequirementAgentConnector_ms": 0.81463623046875}}, "episode_reward_max": 100.44763029056809, "episode_reward_min": -65.26201688339056, "episode_reward_mean": 23.969618750312655, "episode_len_mean": 656.68, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.225050996427353, 19.29885617549938, 30.045881538012754, 26.995039762587123, 12.894480355622894, 21.396071149584298, 13.13050861913158, 15.385474992831163, 3.715415651698863, 46.75122524779872, 51.58830753980168, 19.688654137085493, 11.989012259261369, -12.645793908241279, 15.298787450520667, 46.07100365706147, 9.086590343011112, 57.83839661500835, 35.601926137063, 24.17156601364265, 11.827613101963834, 2.8762309681687235, 21.012779431053147, 18.88086692212191, 77.60090870854685, 14.567143011920363, 17.87467818016536, 18.729402783050617, 4.687586090736472, 5.149561042535825, 37.03853151123482, 100.44763029056809, 19.99531419589145, 61.091646040388206, 85.9136888927144, 82.33347063588037, 16.22806991927441, 18.300641921760356, 17.38667644374686, 28.88019876623261, 15.846307340857848, 17.936905513503007, 13.622574318447626, 15.167856779831741, 33.741190676121896, 16.134392737033764, 59.24269558442348, 18.43129982711365, 40.854607090180565, 18.59938763098962, 29.081783486886394, 14.482032748529225, 5.7531231920676795, 28.617766146256756, 32.143416473931445, 19.219947899444445, 85.54426663909489, 39.638042542559596, 16.62666767148987, 54.840387214923794, 39.52236865898221, 20.78058811607678, 17.06551649577251, 16.21963416070123, 13.133174472935343, 20.693658600810345, 16.88904575346438, 19.796367186624895, 14.703720807409788, 18.92737381656279, -46.75617663606425, 52.109006122562356, 18.72747886229508, -65.26201688339056, 32.525366475915504, 62.383414535444906, 15.869306060171073, 19.30927379727785, 23.209008293167354, 13.661711339849967, 47.86586761301933, 17.808967482713456, 19.066311430435483, -39.40373205195338, 16.24586194890939, 50.94980274443777, 32.63423656334743, 15.834924040592938, 16.020194517032415, 8.138718180209075, 15.899665644270577, 8.563055669675292, 36.905349645568656, 8.251506617626923, 23.563691619033815, 16.971288051592946, 16.6354623179081, 21.61523548707289, 12.884690506898757, 18.129211861254163], "episode_lengths": [1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.080078523275646, "mean_inference_ms": 6.785017195972092, "mean_action_processing_ms": 0.4673671187742189, "mean_env_wait_ms": 20.5117000615281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029870033264160156, "StateBufferConnector_ms": 0.024915218353271484, "ViewRequirementAgentConnector_ms": 0.81463623046875}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780373, "num_agent_steps_trained": 780373, "num_env_steps_sampled": 780373, "num_env_steps_trained": 780373, "num_env_steps_sampled_this_iter": 8240, "num_env_steps_trained_this_iter": 8240, "num_env_steps_sampled_throughput_per_sec": 184.1812512343987, "num_env_steps_trained_throughput_per_sec": 184.1812512343987, "timesteps_total": 780373, "num_steps_trained_this_iter": 8240, "agent_timesteps_total": 780373, "timers": {"training_iteration_time_ms": 45045.021, "sample_time_ms": 32340.81, "load_time_ms": 1163.55, "load_throughput": 7620.728, "learn_time_ms": 11034.876, "learn_throughput": 803.552, "synch_weights_time_ms": 443.987}, "counters": {"num_env_steps_sampled": 780373, "num_env_steps_trained": 780373, "num_agent_steps_sampled": 780373, "num_agent_steps_trained": 780373}, "done": false, "episodes_total": 1194, "training_iteration": 85, "trial_id": "32ccc_00000", "date": "2025-06-07_13-06-03", "timestamp": 1749294363, "time_this_iter_s": 44.756529092788696, "time_total_s": 3882.910717487335, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3882.910717487335, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 52.17407407407407, "ram_util_percent": 86.31666666666666, "gpu_util_percent0": 0.16555555555555554, "vram_util_percent0": 0.9650065104166664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.219627e-05, "total_loss": -0.06020754063747039, "policy_loss": 0.01561802286764999, "vf_loss": 0.0755348543195348, "vf_explained_var": 0.9166670661223563, "kl": 0.012867269913495922, "entropy": 16.413941265407363, "entropy_coeff": 0.006098135}, "model": {}, "num_grad_updates_lifetime": 27670.5, "diff_num_grad_updates_vs_sampler_policy": 189.5}}, "num_env_steps_sampled": 791079, "num_env_steps_trained": 791079, "num_agent_steps_sampled": 791079, "num_agent_steps_trained": 791079}, "sampler_results": {"episode_reward_max": 100.44763029056809, "episode_reward_min": -65.26201688339056, "episode_reward_mean": 24.39112149477674, "episode_len_mean": 673.12, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.298787450520667, 46.07100365706147, 9.086590343011112, 57.83839661500835, 35.601926137063, 24.17156601364265, 11.827613101963834, 2.8762309681687235, 21.012779431053147, 18.88086692212191, 77.60090870854685, 14.567143011920363, 17.87467818016536, 18.729402783050617, 4.687586090736472, 5.149561042535825, 37.03853151123482, 100.44763029056809, 19.99531419589145, 61.091646040388206, 85.9136888927144, 82.33347063588037, 16.22806991927441, 18.300641921760356, 17.38667644374686, 28.88019876623261, 15.846307340857848, 17.936905513503007, 13.622574318447626, 15.167856779831741, 33.741190676121896, 16.134392737033764, 59.24269558442348, 18.43129982711365, 40.854607090180565, 18.59938763098962, 29.081783486886394, 14.482032748529225, 5.7531231920676795, 28.617766146256756, 32.143416473931445, 19.219947899444445, 85.54426663909489, 39.638042542559596, 16.62666767148987, 54.840387214923794, 39.52236865898221, 20.78058811607678, 17.06551649577251, 16.21963416070123, 13.133174472935343, 20.693658600810345, 16.88904575346438, 19.796367186624895, 14.703720807409788, 18.92737381656279, -46.75617663606425, 52.109006122562356, 18.72747886229508, -65.26201688339056, 32.525366475915504, 62.383414535444906, 15.869306060171073, 19.30927379727785, 23.209008293167354, 13.661711339849967, 47.86586761301933, 17.808967482713456, 19.066311430435483, -39.40373205195338, 16.24586194890939, 50.94980274443777, 32.63423656334743, 15.834924040592938, 16.020194517032415, 8.138718180209075, 15.899665644270577, 8.563055669675292, 36.905349645568656, 8.251506617626923, 23.563691619033815, 16.971288051592946, 16.6354623179081, 21.61523548707289, 12.884690506898757, 18.129211861254163, 17.186326177938646, 23.70388322009292, 11.798362294426472, 17.753819847498804, 21.836181969923487, 2.7337783812778422, 85.36471627694752, -5.88994825208565, 21.251251010287156, 11.08427765473731, 66.0675283325092, 79.6130658626369, 15.462118458074784, -41.35690227075625], "episode_lengths": [295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0816058759540566, "mean_inference_ms": 6.786934372563581, "mean_action_processing_ms": 0.4675960437490216, "mean_env_wait_ms": 20.517412568736436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025049686431884766, "StateBufferConnector_ms": 0.025899648666381836, "ViewRequirementAgentConnector_ms": 0.7874116897583008}}, "episode_reward_max": 100.44763029056809, "episode_reward_min": -65.26201688339056, "episode_reward_mean": 24.39112149477674, "episode_len_mean": 673.12, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.298787450520667, 46.07100365706147, 9.086590343011112, 57.83839661500835, 35.601926137063, 24.17156601364265, 11.827613101963834, 2.8762309681687235, 21.012779431053147, 18.88086692212191, 77.60090870854685, 14.567143011920363, 17.87467818016536, 18.729402783050617, 4.687586090736472, 5.149561042535825, 37.03853151123482, 100.44763029056809, 19.99531419589145, 61.091646040388206, 85.9136888927144, 82.33347063588037, 16.22806991927441, 18.300641921760356, 17.38667644374686, 28.88019876623261, 15.846307340857848, 17.936905513503007, 13.622574318447626, 15.167856779831741, 33.741190676121896, 16.134392737033764, 59.24269558442348, 18.43129982711365, 40.854607090180565, 18.59938763098962, 29.081783486886394, 14.482032748529225, 5.7531231920676795, 28.617766146256756, 32.143416473931445, 19.219947899444445, 85.54426663909489, 39.638042542559596, 16.62666767148987, 54.840387214923794, 39.52236865898221, 20.78058811607678, 17.06551649577251, 16.21963416070123, 13.133174472935343, 20.693658600810345, 16.88904575346438, 19.796367186624895, 14.703720807409788, 18.92737381656279, -46.75617663606425, 52.109006122562356, 18.72747886229508, -65.26201688339056, 32.525366475915504, 62.383414535444906, 15.869306060171073, 19.30927379727785, 23.209008293167354, 13.661711339849967, 47.86586761301933, 17.808967482713456, 19.066311430435483, -39.40373205195338, 16.24586194890939, 50.94980274443777, 32.63423656334743, 15.834924040592938, 16.020194517032415, 8.138718180209075, 15.899665644270577, 8.563055669675292, 36.905349645568656, 8.251506617626923, 23.563691619033815, 16.971288051592946, 16.6354623179081, 21.61523548707289, 12.884690506898757, 18.129211861254163, 17.186326177938646, 23.70388322009292, 11.798362294426472, 17.753819847498804, 21.836181969923487, 2.7337783812778422, 85.36471627694752, -5.88994825208565, 21.251251010287156, 11.08427765473731, 66.0675283325092, 79.6130658626369, 15.462118458074784, -41.35690227075625], "episode_lengths": [295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0816058759540566, "mean_inference_ms": 6.786934372563581, "mean_action_processing_ms": 0.4675960437490216, "mean_env_wait_ms": 20.517412568736436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025049686431884766, "StateBufferConnector_ms": 0.025899648666381836, "ViewRequirementAgentConnector_ms": 0.7874116897583008}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 791079, "num_agent_steps_trained": 791079, "num_env_steps_sampled": 791079, "num_env_steps_trained": 791079, "num_env_steps_sampled_this_iter": 10706, "num_env_steps_trained_this_iter": 10706, "num_env_steps_sampled_throughput_per_sec": 209.98630809331615, "num_env_steps_trained_throughput_per_sec": 209.98630809331615, "timesteps_total": 791079, "num_steps_trained_this_iter": 10706, "agent_timesteps_total": 791079, "timers": {"training_iteration_time_ms": 45456.609, "sample_time_ms": 32471.946, "load_time_ms": 1186.662, "load_throughput": 7610.843, "learn_time_ms": 11291.907, "learn_throughput": 799.821, "synch_weights_time_ms": 443.36}, "counters": {"num_env_steps_sampled": 791079, "num_env_steps_trained": 791079, "num_agent_steps_sampled": 791079, "num_agent_steps_trained": 791079}, "done": false, "episodes_total": 1208, "training_iteration": 86, "trial_id": "32ccc_00000", "date": "2025-06-07_13-06-54", "timestamp": 1749294414, "time_this_iter_s": 51.00528144836426, "time_total_s": 3933.9159989356995, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3933.9159989356995, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 57.7327868852459, "ram_util_percent": 87.10983606557377, "gpu_util_percent0": 0.1865573770491803, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.208920999999999e-05, "total_loss": -0.10259934653233933, "policy_loss": -0.02408991176236764, "vf_loss": 0.06529118919892138, "vf_explained_var": 0.9272434267558549, "kl": 0.012083072603398082, "entropy": 16.478691409763538, "entropy_coeff": 0.0060446050000000015}, "model": {}, "num_grad_updates_lifetime": 28050.5, "diff_num_grad_updates_vs_sampler_policy": 189.5}}, "num_env_steps_sampled": 801785, "num_env_steps_trained": 801785, "num_agent_steps_sampled": 801785, "num_agent_steps_trained": 801785}, "sampler_results": {"episode_reward_max": 100.44763029056809, "episode_reward_min": -65.26201688339056, "episode_reward_mean": 23.211126089705736, "episode_len_mean": 697.78, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.687586090736472, 5.149561042535825, 37.03853151123482, 100.44763029056809, 19.99531419589145, 61.091646040388206, 85.9136888927144, 82.33347063588037, 16.22806991927441, 18.300641921760356, 17.38667644374686, 28.88019876623261, 15.846307340857848, 17.936905513503007, 13.622574318447626, 15.167856779831741, 33.741190676121896, 16.134392737033764, 59.24269558442348, 18.43129982711365, 40.854607090180565, 18.59938763098962, 29.081783486886394, 14.482032748529225, 5.7531231920676795, 28.617766146256756, 32.143416473931445, 19.219947899444445, 85.54426663909489, 39.638042542559596, 16.62666767148987, 54.840387214923794, 39.52236865898221, 20.78058811607678, 17.06551649577251, 16.21963416070123, 13.133174472935343, 20.693658600810345, 16.88904575346438, 19.796367186624895, 14.703720807409788, 18.92737381656279, -46.75617663606425, 52.109006122562356, 18.72747886229508, -65.26201688339056, 32.525366475915504, 62.383414535444906, 15.869306060171073, 19.30927379727785, 23.209008293167354, 13.661711339849967, 47.86586761301933, 17.808967482713456, 19.066311430435483, -39.40373205195338, 16.24586194890939, 50.94980274443777, 32.63423656334743, 15.834924040592938, 16.020194517032415, 8.138718180209075, 15.899665644270577, 8.563055669675292, 36.905349645568656, 8.251506617626923, 23.563691619033815, 16.971288051592946, 16.6354623179081, 21.61523548707289, 12.884690506898757, 18.129211861254163, 17.186326177938646, 23.70388322009292, 11.798362294426472, 17.753819847498804, 21.836181969923487, 2.7337783812778422, 85.36471627694752, -5.88994825208565, 21.251251010287156, 11.08427765473731, 66.0675283325092, 79.6130658626369, 15.462118458074784, -41.35690227075625, 9.712081052378654, 33.60292629940709, 17.950756405853973, 41.497809367051815, 21.607946794201684, 12.651181653208857, 20.23288384324432, 29.984054832146384, 18.138508647116595, 20.016794037497977, -9.071227921627703, 17.32925656941185, -2.2410431383793985, 22.02642437468566], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.083322887427105, "mean_inference_ms": 6.788885701952015, "mean_action_processing_ms": 0.46781451306824734, "mean_env_wait_ms": 20.52341144212871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028113842010498047, "StateBufferConnector_ms": 0.022884845733642578, "ViewRequirementAgentConnector_ms": 0.7594313621520996}}, "episode_reward_max": 100.44763029056809, "episode_reward_min": -65.26201688339056, "episode_reward_mean": 23.211126089705736, "episode_len_mean": 697.78, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.687586090736472, 5.149561042535825, 37.03853151123482, 100.44763029056809, 19.99531419589145, 61.091646040388206, 85.9136888927144, 82.33347063588037, 16.22806991927441, 18.300641921760356, 17.38667644374686, 28.88019876623261, 15.846307340857848, 17.936905513503007, 13.622574318447626, 15.167856779831741, 33.741190676121896, 16.134392737033764, 59.24269558442348, 18.43129982711365, 40.854607090180565, 18.59938763098962, 29.081783486886394, 14.482032748529225, 5.7531231920676795, 28.617766146256756, 32.143416473931445, 19.219947899444445, 85.54426663909489, 39.638042542559596, 16.62666767148987, 54.840387214923794, 39.52236865898221, 20.78058811607678, 17.06551649577251, 16.21963416070123, 13.133174472935343, 20.693658600810345, 16.88904575346438, 19.796367186624895, 14.703720807409788, 18.92737381656279, -46.75617663606425, 52.109006122562356, 18.72747886229508, -65.26201688339056, 32.525366475915504, 62.383414535444906, 15.869306060171073, 19.30927379727785, 23.209008293167354, 13.661711339849967, 47.86586761301933, 17.808967482713456, 19.066311430435483, -39.40373205195338, 16.24586194890939, 50.94980274443777, 32.63423656334743, 15.834924040592938, 16.020194517032415, 8.138718180209075, 15.899665644270577, 8.563055669675292, 36.905349645568656, 8.251506617626923, 23.563691619033815, 16.971288051592946, 16.6354623179081, 21.61523548707289, 12.884690506898757, 18.129211861254163, 17.186326177938646, 23.70388322009292, 11.798362294426472, 17.753819847498804, 21.836181969923487, 2.7337783812778422, 85.36471627694752, -5.88994825208565, 21.251251010287156, 11.08427765473731, 66.0675283325092, 79.6130658626369, 15.462118458074784, -41.35690227075625, 9.712081052378654, 33.60292629940709, 17.950756405853973, 41.497809367051815, 21.607946794201684, 12.651181653208857, 20.23288384324432, 29.984054832146384, 18.138508647116595, 20.016794037497977, -9.071227921627703, 17.32925656941185, -2.2410431383793985, 22.02642437468566], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.083322887427105, "mean_inference_ms": 6.788885701952015, "mean_action_processing_ms": 0.46781451306824734, "mean_env_wait_ms": 20.52341144212871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028113842010498047, "StateBufferConnector_ms": 0.022884845733642578, "ViewRequirementAgentConnector_ms": 0.7594313621520996}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 801785, "num_agent_steps_trained": 801785, "num_env_steps_sampled": 801785, "num_env_steps_trained": 801785, "num_env_steps_sampled_this_iter": 10706, "num_env_steps_trained_this_iter": 10706, "num_env_steps_sampled_throughput_per_sec": 208.14240957939163, "num_env_steps_trained_throughput_per_sec": 208.14240957939163, "timesteps_total": 801785, "num_steps_trained_this_iter": 10706, "agent_timesteps_total": 801785, "timers": {"training_iteration_time_ms": 46291.479, "sample_time_ms": 32795.874, "load_time_ms": 1216.808, "load_throughput": 7650.012, "learn_time_ms": 11768.42, "learn_throughput": 790.981, "synch_weights_time_ms": 444.673}, "counters": {"num_env_steps_sampled": 801785, "num_env_steps_trained": 801785, "num_agent_steps_sampled": 801785, "num_agent_steps_trained": 801785}, "done": false, "episodes_total": 1222, "training_iteration": 87, "trial_id": "32ccc_00000", "date": "2025-06-07_13-07-46", "timestamp": 1749294466, "time_this_iter_s": 51.44890856742859, "time_total_s": 3985.364907503128, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3985.364907503128, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 57.7655737704918, "ram_util_percent": 87.41967213114758, "gpu_util_percent0": 0.18950819672131144, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.198215e-05, "total_loss": -0.09407695535618554, "policy_loss": -0.01631300022889828, "vf_loss": 0.06507734953714855, "vf_explained_var": 0.932607881981751, "kl": 0.01282264317831837, "entropy": 16.50621794667737, "entropy_coeff": 0.005991074999999999}, "model": {}, "num_grad_updates_lifetime": 28385.5, "diff_num_grad_updates_vs_sampler_policy": 144.5}}, "num_env_steps_sampled": 810025, "num_env_steps_trained": 810025, "num_agent_steps_sampled": 810025, "num_agent_steps_trained": 810025}, "sampler_results": {"episode_reward_max": 85.54426663909489, "episode_reward_min": -65.26201688339056, "episode_reward_mean": 20.417197692908665, "episode_len_mean": 673.12, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.622574318447626, 15.167856779831741, 33.741190676121896, 16.134392737033764, 59.24269558442348, 18.43129982711365, 40.854607090180565, 18.59938763098962, 29.081783486886394, 14.482032748529225, 5.7531231920676795, 28.617766146256756, 32.143416473931445, 19.219947899444445, 85.54426663909489, 39.638042542559596, 16.62666767148987, 54.840387214923794, 39.52236865898221, 20.78058811607678, 17.06551649577251, 16.21963416070123, 13.133174472935343, 20.693658600810345, 16.88904575346438, 19.796367186624895, 14.703720807409788, 18.92737381656279, -46.75617663606425, 52.109006122562356, 18.72747886229508, -65.26201688339056, 32.525366475915504, 62.383414535444906, 15.869306060171073, 19.30927379727785, 23.209008293167354, 13.661711339849967, 47.86586761301933, 17.808967482713456, 19.066311430435483, -39.40373205195338, 16.24586194890939, 50.94980274443777, 32.63423656334743, 15.834924040592938, 16.020194517032415, 8.138718180209075, 15.899665644270577, 8.563055669675292, 36.905349645568656, 8.251506617626923, 23.563691619033815, 16.971288051592946, 16.6354623179081, 21.61523548707289, 12.884690506898757, 18.129211861254163, 17.186326177938646, 23.70388322009292, 11.798362294426472, 17.753819847498804, 21.836181969923487, 2.7337783812778422, 85.36471627694752, -5.88994825208565, 21.251251010287156, 11.08427765473731, 66.0675283325092, 79.6130658626369, 15.462118458074784, -41.35690227075625, 9.712081052378654, 33.60292629940709, 17.950756405853973, 41.497809367051815, 21.607946794201684, 12.651181653208857, 20.23288384324432, 29.984054832146384, 18.138508647116595, 20.016794037497977, -9.071227921627703, 17.32925656941185, -2.2410431383793985, 22.02642437468566, 18.883124302341265, 22.081802582767377, -2.259352869747456, 35.34788436967694, 20.528575433478625, 12.259844447661793, 19.512192985797903, 18.797137570902642, 0.20097559277277097, 15.307587401996528, 12.347262504522666, 13.695163118377407, 21.549528921968317, 23.591662563100414], "episode_lengths": [295, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0851453861845686, "mean_inference_ms": 6.791243907933416, "mean_action_processing_ms": 0.4680480701476678, "mean_env_wait_ms": 20.52986709944496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020143985748291016, "StateBufferConnector_ms": 0.0278778076171875, "ViewRequirementAgentConnector_ms": 0.7963657379150391}}, "episode_reward_max": 85.54426663909489, "episode_reward_min": -65.26201688339056, "episode_reward_mean": 20.417197692908665, "episode_len_mean": 673.12, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.622574318447626, 15.167856779831741, 33.741190676121896, 16.134392737033764, 59.24269558442348, 18.43129982711365, 40.854607090180565, 18.59938763098962, 29.081783486886394, 14.482032748529225, 5.7531231920676795, 28.617766146256756, 32.143416473931445, 19.219947899444445, 85.54426663909489, 39.638042542559596, 16.62666767148987, 54.840387214923794, 39.52236865898221, 20.78058811607678, 17.06551649577251, 16.21963416070123, 13.133174472935343, 20.693658600810345, 16.88904575346438, 19.796367186624895, 14.703720807409788, 18.92737381656279, -46.75617663606425, 52.109006122562356, 18.72747886229508, -65.26201688339056, 32.525366475915504, 62.383414535444906, 15.869306060171073, 19.30927379727785, 23.209008293167354, 13.661711339849967, 47.86586761301933, 17.808967482713456, 19.066311430435483, -39.40373205195338, 16.24586194890939, 50.94980274443777, 32.63423656334743, 15.834924040592938, 16.020194517032415, 8.138718180209075, 15.899665644270577, 8.563055669675292, 36.905349645568656, 8.251506617626923, 23.563691619033815, 16.971288051592946, 16.6354623179081, 21.61523548707289, 12.884690506898757, 18.129211861254163, 17.186326177938646, 23.70388322009292, 11.798362294426472, 17.753819847498804, 21.836181969923487, 2.7337783812778422, 85.36471627694752, -5.88994825208565, 21.251251010287156, 11.08427765473731, 66.0675283325092, 79.6130658626369, 15.462118458074784, -41.35690227075625, 9.712081052378654, 33.60292629940709, 17.950756405853973, 41.497809367051815, 21.607946794201684, 12.651181653208857, 20.23288384324432, 29.984054832146384, 18.138508647116595, 20.016794037497977, -9.071227921627703, 17.32925656941185, -2.2410431383793985, 22.02642437468566, 18.883124302341265, 22.081802582767377, -2.259352869747456, 35.34788436967694, 20.528575433478625, 12.259844447661793, 19.512192985797903, 18.797137570902642, 0.20097559277277097, 15.307587401996528, 12.347262504522666, 13.695163118377407, 21.549528921968317, 23.591662563100414], "episode_lengths": [295, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0851453861845686, "mean_inference_ms": 6.791243907933416, "mean_action_processing_ms": 0.4680480701476678, "mean_env_wait_ms": 20.52986709944496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020143985748291016, "StateBufferConnector_ms": 0.0278778076171875, "ViewRequirementAgentConnector_ms": 0.7963657379150391}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 810025, "num_agent_steps_trained": 810025, "num_env_steps_sampled": 810025, "num_env_steps_trained": 810025, "num_env_steps_sampled_this_iter": 8240, "num_env_steps_trained_this_iter": 8240, "num_env_steps_sampled_throughput_per_sec": 189.24331623032032, "num_env_steps_trained_throughput_per_sec": 189.24331623032032, "timesteps_total": 810025, "num_steps_trained_this_iter": 8240, "agent_timesteps_total": 810025, "timers": {"training_iteration_time_ms": 46822.508, "sample_time_ms": 32925.648, "load_time_ms": 1225.147, "load_throughput": 7665.042, "learn_time_ms": 12163.658, "learn_throughput": 772.037, "synch_weights_time_ms": 441.08}, "counters": {"num_env_steps_sampled": 810025, "num_env_steps_trained": 810025, "num_agent_steps_sampled": 810025, "num_agent_steps_trained": 810025}, "done": false, "episodes_total": 1236, "training_iteration": 88, "trial_id": "32ccc_00000", "date": "2025-06-07_13-08-30", "timestamp": 1749294510, "time_this_iter_s": 43.5598201751709, "time_total_s": 4028.924727678299, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4028.924727678299, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 53.56153846153845, "ram_util_percent": 87.03846153846156, "gpu_util_percent0": 0.1423076923076923, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.189975000000002e-05, "total_loss": -0.09037460411430066, "policy_loss": -0.014109608074374448, "vf_loss": 0.061066771342762206, "vf_explained_var": 0.8938842124060581, "kl": 0.013298828702988286, "entropy": 16.17637079389472, "entropy_coeff": 0.005949875}, "model": {}, "num_grad_updates_lifetime": 28720.5, "diff_num_grad_updates_vs_sampler_policy": 189.5}}, "num_env_steps_sampled": 820731, "num_env_steps_trained": 820731, "num_agent_steps_sampled": 820731, "num_agent_steps_trained": 820731}, "sampler_results": {"episode_reward_max": 122.53573005865213, "episode_reward_min": -65.26201688339056, "episode_reward_mean": 22.892757105773327, "episode_len_mean": 681.34, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.54426663909489, 39.638042542559596, 16.62666767148987, 54.840387214923794, 39.52236865898221, 20.78058811607678, 17.06551649577251, 16.21963416070123, 13.133174472935343, 20.693658600810345, 16.88904575346438, 19.796367186624895, 14.703720807409788, 18.92737381656279, -46.75617663606425, 52.109006122562356, 18.72747886229508, -65.26201688339056, 32.525366475915504, 62.383414535444906, 15.869306060171073, 19.30927379727785, 23.209008293167354, 13.661711339849967, 47.86586761301933, 17.808967482713456, 19.066311430435483, -39.40373205195338, 16.24586194890939, 50.94980274443777, 32.63423656334743, 15.834924040592938, 16.020194517032415, 8.138718180209075, 15.899665644270577, 8.563055669675292, 36.905349645568656, 8.251506617626923, 23.563691619033815, 16.971288051592946, 16.6354623179081, 21.61523548707289, 12.884690506898757, 18.129211861254163, 17.186326177938646, 23.70388322009292, 11.798362294426472, 17.753819847498804, 21.836181969923487, 2.7337783812778422, 85.36471627694752, -5.88994825208565, 21.251251010287156, 11.08427765473731, 66.0675283325092, 79.6130658626369, 15.462118458074784, -41.35690227075625, 9.712081052378654, 33.60292629940709, 17.950756405853973, 41.497809367051815, 21.607946794201684, 12.651181653208857, 20.23288384324432, 29.984054832146384, 18.138508647116595, 20.016794037497977, -9.071227921627703, 17.32925656941185, -2.2410431383793985, 22.02642437468566, 18.883124302341265, 22.081802582767377, -2.259352869747456, 35.34788436967694, 20.528575433478625, 12.259844447661793, 19.512192985797903, 18.797137570902642, 0.20097559277277097, 15.307587401996528, 12.347262504522666, 13.695163118377407, 21.549528921968317, 23.591662563100414, 17.02728639227176, 26.521080788338658, 10.47529356639313, 39.63204381957158, 122.53573005865213, 6.597955031415104, 111.81716021505576, 90.64738947380803, 16.032071772288592, 15.81977630226067, 58.78173358747623, 20.754183316891055, 40.9971414669148, 15.009170086387293], "episode_lengths": [1117, 1117, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.086717761263854, "mean_inference_ms": 6.7931221546334655, "mean_action_processing_ms": 0.468270773010491, "mean_env_wait_ms": 20.53505280305313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02112722396850586, "StateBufferConnector_ms": 0.026898860931396484, "ViewRequirementAgentConnector_ms": 0.7905397415161133}}, "episode_reward_max": 122.53573005865213, "episode_reward_min": -65.26201688339056, "episode_reward_mean": 22.892757105773327, "episode_len_mean": 681.34, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [85.54426663909489, 39.638042542559596, 16.62666767148987, 54.840387214923794, 39.52236865898221, 20.78058811607678, 17.06551649577251, 16.21963416070123, 13.133174472935343, 20.693658600810345, 16.88904575346438, 19.796367186624895, 14.703720807409788, 18.92737381656279, -46.75617663606425, 52.109006122562356, 18.72747886229508, -65.26201688339056, 32.525366475915504, 62.383414535444906, 15.869306060171073, 19.30927379727785, 23.209008293167354, 13.661711339849967, 47.86586761301933, 17.808967482713456, 19.066311430435483, -39.40373205195338, 16.24586194890939, 50.94980274443777, 32.63423656334743, 15.834924040592938, 16.020194517032415, 8.138718180209075, 15.899665644270577, 8.563055669675292, 36.905349645568656, 8.251506617626923, 23.563691619033815, 16.971288051592946, 16.6354623179081, 21.61523548707289, 12.884690506898757, 18.129211861254163, 17.186326177938646, 23.70388322009292, 11.798362294426472, 17.753819847498804, 21.836181969923487, 2.7337783812778422, 85.36471627694752, -5.88994825208565, 21.251251010287156, 11.08427765473731, 66.0675283325092, 79.6130658626369, 15.462118458074784, -41.35690227075625, 9.712081052378654, 33.60292629940709, 17.950756405853973, 41.497809367051815, 21.607946794201684, 12.651181653208857, 20.23288384324432, 29.984054832146384, 18.138508647116595, 20.016794037497977, -9.071227921627703, 17.32925656941185, -2.2410431383793985, 22.02642437468566, 18.883124302341265, 22.081802582767377, -2.259352869747456, 35.34788436967694, 20.528575433478625, 12.259844447661793, 19.512192985797903, 18.797137570902642, 0.20097559277277097, 15.307587401996528, 12.347262504522666, 13.695163118377407, 21.549528921968317, 23.591662563100414, 17.02728639227176, 26.521080788338658, 10.47529356639313, 39.63204381957158, 122.53573005865213, 6.597955031415104, 111.81716021505576, 90.64738947380803, 16.032071772288592, 15.81977630226067, 58.78173358747623, 20.754183316891055, 40.9971414669148, 15.009170086387293], "episode_lengths": [1117, 1117, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.086717761263854, "mean_inference_ms": 6.7931221546334655, "mean_action_processing_ms": 0.468270773010491, "mean_env_wait_ms": 20.53505280305313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02112722396850586, "StateBufferConnector_ms": 0.026898860931396484, "ViewRequirementAgentConnector_ms": 0.7905397415161133}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 820731, "num_agent_steps_trained": 820731, "num_env_steps_sampled": 820731, "num_env_steps_trained": 820731, "num_env_steps_sampled_this_iter": 10706, "num_env_steps_trained_this_iter": 10706, "num_env_steps_sampled_throughput_per_sec": 210.23164997361022, "num_env_steps_trained_throughput_per_sec": 210.23164997361022, "timesteps_total": 820731, "num_steps_trained_this_iter": 10706, "agent_timesteps_total": 820731, "timers": {"training_iteration_time_ms": 47254.767, "sample_time_ms": 33107.944, "load_time_ms": 1237.108, "load_throughput": 7723.821, "learn_time_ms": 12401.808, "learn_throughput": 770.468, "synch_weights_time_ms": 439.337}, "counters": {"num_env_steps_sampled": 820731, "num_env_steps_trained": 820731, "num_agent_steps_sampled": 820731, "num_agent_steps_trained": 820731}, "done": false, "episodes_total": 1250, "training_iteration": 89, "trial_id": "32ccc_00000", "date": "2025-06-07_13-09-21", "timestamp": 1749294561, "time_this_iter_s": 50.94077754020691, "time_total_s": 4079.865505218506, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4079.865505218506, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 57.839344262295086, "ram_util_percent": 87.44262295081971, "gpu_util_percent0": 0.18803278688524586, "vram_util_percent0": 0.9650065104166665}}
{"evaluation": {"sampler_results": {"episode_reward_max": -7.626322706939483, "episode_reward_min": -9.082761726350615, "episode_reward_mean": -8.141438526142505, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.082761726350615, -8.485666280850387, -7.8725593796942555, -7.626322706939483, -7.639882536877785], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.61719063085255, "mean_inference_ms": 3.683747077474789, "mean_action_processing_ms": 0.2741744561178675, "mean_env_wait_ms": 11.326499671093034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.23603439331054688}}, "episode_reward_max": -7.626322706939483, "episode_reward_min": -9.082761726350615, "episode_reward_mean": -8.141438526142505, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.082761726350615, -8.485666280850387, -7.8725593796942555, -7.626322706939483, -7.639882536877785], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.61719063085255, "mean_inference_ms": 3.683747077474789, "mean_action_processing_ms": 0.2741744561178675, "mean_env_wait_ms": 11.326499671093034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.23603439331054688}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.179269000000001e-05, "total_loss": -0.1125629095450187, "policy_loss": -0.035452656535646665, "vf_loss": 0.05839737274755652, "vf_explained_var": 0.9227552578999446, "kl": 0.011881665759634733, "entropy": 16.300722389954785, "entropy_coeff": 0.005896344999999999}, "model": {}, "num_grad_updates_lifetime": 29040.5, "diff_num_grad_updates_vs_sampler_policy": 129.5}}, "num_env_steps_sampled": 828123, "num_env_steps_trained": 828123, "num_agent_steps_sampled": 828123, "num_agent_steps_trained": 828123}, "sampler_results": {"episode_reward_max": 122.53573005865213, "episode_reward_min": -65.26201688339056, "episode_reward_mean": 22.520468673819042, "episode_len_mean": 681.08, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.75617663606425, 52.109006122562356, 18.72747886229508, -65.26201688339056, 32.525366475915504, 62.383414535444906, 15.869306060171073, 19.30927379727785, 23.209008293167354, 13.661711339849967, 47.86586761301933, 17.808967482713456, 19.066311430435483, -39.40373205195338, 16.24586194890939, 50.94980274443777, 32.63423656334743, 15.834924040592938, 16.020194517032415, 8.138718180209075, 15.899665644270577, 8.563055669675292, 36.905349645568656, 8.251506617626923, 23.563691619033815, 16.971288051592946, 16.6354623179081, 21.61523548707289, 12.884690506898757, 18.129211861254163, 17.186326177938646, 23.70388322009292, 11.798362294426472, 17.753819847498804, 21.836181969923487, 2.7337783812778422, 85.36471627694752, -5.88994825208565, 21.251251010287156, 11.08427765473731, 66.0675283325092, 79.6130658626369, 15.462118458074784, -41.35690227075625, 9.712081052378654, 33.60292629940709, 17.950756405853973, 41.497809367051815, 21.607946794201684, 12.651181653208857, 20.23288384324432, 29.984054832146384, 18.138508647116595, 20.016794037497977, -9.071227921627703, 17.32925656941185, -2.2410431383793985, 22.02642437468566, 18.883124302341265, 22.081802582767377, -2.259352869747456, 35.34788436967694, 20.528575433478625, 12.259844447661793, 19.512192985797903, 18.797137570902642, 0.20097559277277097, 15.307587401996528, 12.347262504522666, 13.695163118377407, 21.549528921968317, 23.591662563100414, 17.02728639227176, 26.521080788338658, 10.47529356639313, 39.63204381957158, 122.53573005865213, 6.597955031415104, 111.81716021505576, 90.64738947380803, 16.032071772288592, 15.81977630226067, 58.78173358747623, 20.754183316891055, 40.9971414669148, 15.009170086387293, 17.245720901796886, 13.327298231119912, 7.274853823835279, 25.217406331835345, 67.53031001482535, 16.32665985667749, 21.487922910871532, 14.184575610172026, 12.21555377661706, 88.2622656105404, 16.26935178672073, 17.868839495273054, 16.637221961353415, 23.303988630341458], "episode_lengths": [1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0880144454264364, "mean_inference_ms": 6.794880853291197, "mean_action_processing_ms": 0.4684675779333611, "mean_env_wait_ms": 20.53972415305114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021135807037353516, "StateBufferConnector_ms": 0.026923418045043945, "ViewRequirementAgentConnector_ms": 0.7920498847961426}}, "episode_reward_max": 122.53573005865213, "episode_reward_min": -65.26201688339056, "episode_reward_mean": 22.520468673819042, "episode_len_mean": 681.08, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.75617663606425, 52.109006122562356, 18.72747886229508, -65.26201688339056, 32.525366475915504, 62.383414535444906, 15.869306060171073, 19.30927379727785, 23.209008293167354, 13.661711339849967, 47.86586761301933, 17.808967482713456, 19.066311430435483, -39.40373205195338, 16.24586194890939, 50.94980274443777, 32.63423656334743, 15.834924040592938, 16.020194517032415, 8.138718180209075, 15.899665644270577, 8.563055669675292, 36.905349645568656, 8.251506617626923, 23.563691619033815, 16.971288051592946, 16.6354623179081, 21.61523548707289, 12.884690506898757, 18.129211861254163, 17.186326177938646, 23.70388322009292, 11.798362294426472, 17.753819847498804, 21.836181969923487, 2.7337783812778422, 85.36471627694752, -5.88994825208565, 21.251251010287156, 11.08427765473731, 66.0675283325092, 79.6130658626369, 15.462118458074784, -41.35690227075625, 9.712081052378654, 33.60292629940709, 17.950756405853973, 41.497809367051815, 21.607946794201684, 12.651181653208857, 20.23288384324432, 29.984054832146384, 18.138508647116595, 20.016794037497977, -9.071227921627703, 17.32925656941185, -2.2410431383793985, 22.02642437468566, 18.883124302341265, 22.081802582767377, -2.259352869747456, 35.34788436967694, 20.528575433478625, 12.259844447661793, 19.512192985797903, 18.797137570902642, 0.20097559277277097, 15.307587401996528, 12.347262504522666, 13.695163118377407, 21.549528921968317, 23.591662563100414, 17.02728639227176, 26.521080788338658, 10.47529356639313, 39.63204381957158, 122.53573005865213, 6.597955031415104, 111.81716021505576, 90.64738947380803, 16.032071772288592, 15.81977630226067, 58.78173358747623, 20.754183316891055, 40.9971414669148, 15.009170086387293, 17.245720901796886, 13.327298231119912, 7.274853823835279, 25.217406331835345, 67.53031001482535, 16.32665985667749, 21.487922910871532, 14.184575610172026, 12.21555377661706, 88.2622656105404, 16.26935178672073, 17.868839495273054, 16.637221961353415, 23.303988630341458], "episode_lengths": [1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0880144454264364, "mean_inference_ms": 6.794880853291197, "mean_action_processing_ms": 0.4684675779333611, "mean_env_wait_ms": 20.53972415305114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021135807037353516, "StateBufferConnector_ms": 0.026923418045043945, "ViewRequirementAgentConnector_ms": 0.7920498847961426}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828123, "num_agent_steps_trained": 828123, "num_env_steps_sampled": 828123, "num_env_steps_trained": 828123, "num_env_steps_sampled_this_iter": 7392, "num_env_steps_trained_this_iter": 7392, "num_env_steps_sampled_throughput_per_sec": 191.91160790487058, "num_env_steps_trained_throughput_per_sec": 191.91160790487058, "timesteps_total": 828123, "num_steps_trained_this_iter": 7392, "agent_timesteps_total": 828123, "timers": {"training_iteration_time_ms": 46455.995, "sample_time_ms": 32973.986, "load_time_ms": 1207.173, "load_throughput": 7777.014, "learn_time_ms": 11765.375, "learn_throughput": 797.952, "synch_weights_time_ms": 441.657}, "counters": {"num_env_steps_sampled": 828123, "num_env_steps_trained": 828123, "num_agent_steps_sampled": 828123, "num_agent_steps_trained": 828123}, "done": false, "episodes_total": 1264, "training_iteration": 90, "trial_id": "32ccc_00000", "date": "2025-06-07_13-10-16", "timestamp": 1749294616, "time_this_iter_s": 55.599629640579224, "time_total_s": 4135.465134859085, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4135.465134859085, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 43.2179104477612, "ram_util_percent": 86.28059701492538, "gpu_util_percent0": 0.045820895522388064, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.171877e-05, "total_loss": -0.1031445966610177, "policy_loss": -0.029766809764656833, "vf_loss": 0.07119064134418626, "vf_explained_var": 0.9196912327950652, "kl": 0.012053101207278484, "entropy": 16.425208754972978, "entropy_coeff": 0.005859385}, "model": {}, "num_grad_updates_lifetime": 29390.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 840473, "num_env_steps_trained": 840473, "num_agent_steps_sampled": 840473, "num_agent_steps_trained": 840473}, "sampler_results": {"episode_reward_max": 122.53573005865213, "episode_reward_min": -48.28354222846745, "episode_reward_mean": 23.957039921651603, "episode_len_mean": 697.52, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.24586194890939, 50.94980274443777, 32.63423656334743, 15.834924040592938, 16.020194517032415, 8.138718180209075, 15.899665644270577, 8.563055669675292, 36.905349645568656, 8.251506617626923, 23.563691619033815, 16.971288051592946, 16.6354623179081, 21.61523548707289, 12.884690506898757, 18.129211861254163, 17.186326177938646, 23.70388322009292, 11.798362294426472, 17.753819847498804, 21.836181969923487, 2.7337783812778422, 85.36471627694752, -5.88994825208565, 21.251251010287156, 11.08427765473731, 66.0675283325092, 79.6130658626369, 15.462118458074784, -41.35690227075625, 9.712081052378654, 33.60292629940709, 17.950756405853973, 41.497809367051815, 21.607946794201684, 12.651181653208857, 20.23288384324432, 29.984054832146384, 18.138508647116595, 20.016794037497977, -9.071227921627703, 17.32925656941185, -2.2410431383793985, 22.02642437468566, 18.883124302341265, 22.081802582767377, -2.259352869747456, 35.34788436967694, 20.528575433478625, 12.259844447661793, 19.512192985797903, 18.797137570902642, 0.20097559277277097, 15.307587401996528, 12.347262504522666, 13.695163118377407, 21.549528921968317, 23.591662563100414, 17.02728639227176, 26.521080788338658, 10.47529356639313, 39.63204381957158, 122.53573005865213, 6.597955031415104, 111.81716021505576, 90.64738947380803, 16.032071772288592, 15.81977630226067, 58.78173358747623, 20.754183316891055, 40.9971414669148, 15.009170086387293, 17.245720901796886, 13.327298231119912, 7.274853823835279, 25.217406331835345, 67.53031001482535, 16.32665985667749, 21.487922910871532, 14.184575610172026, 12.21555377661706, 88.2622656105404, 16.26935178672073, 17.868839495273054, 16.637221961353415, 23.303988630341458, 14.304520867524815, 67.97546620856437, 70.1965046062452, 24.60676098064042, 18.784638353334888, -24.31773689789669, 18.821997531567863, 17.637829096772123, 31.64809298550321, -48.28354222846745, 16.58472989802512, 17.11252463037066, 26.222004733810778, 63.47712045870514], "episode_lengths": [295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 269, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.090345095039287, "mean_inference_ms": 6.798027958801928, "mean_action_processing_ms": 0.46871844033217586, "mean_env_wait_ms": 20.547588617713515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0251619815826416, "StateBufferConnector_ms": 0.027118444442749023, "ViewRequirementAgentConnector_ms": 0.805485725402832}}, "episode_reward_max": 122.53573005865213, "episode_reward_min": -48.28354222846745, "episode_reward_mean": 23.957039921651603, "episode_len_mean": 697.52, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.24586194890939, 50.94980274443777, 32.63423656334743, 15.834924040592938, 16.020194517032415, 8.138718180209075, 15.899665644270577, 8.563055669675292, 36.905349645568656, 8.251506617626923, 23.563691619033815, 16.971288051592946, 16.6354623179081, 21.61523548707289, 12.884690506898757, 18.129211861254163, 17.186326177938646, 23.70388322009292, 11.798362294426472, 17.753819847498804, 21.836181969923487, 2.7337783812778422, 85.36471627694752, -5.88994825208565, 21.251251010287156, 11.08427765473731, 66.0675283325092, 79.6130658626369, 15.462118458074784, -41.35690227075625, 9.712081052378654, 33.60292629940709, 17.950756405853973, 41.497809367051815, 21.607946794201684, 12.651181653208857, 20.23288384324432, 29.984054832146384, 18.138508647116595, 20.016794037497977, -9.071227921627703, 17.32925656941185, -2.2410431383793985, 22.02642437468566, 18.883124302341265, 22.081802582767377, -2.259352869747456, 35.34788436967694, 20.528575433478625, 12.259844447661793, 19.512192985797903, 18.797137570902642, 0.20097559277277097, 15.307587401996528, 12.347262504522666, 13.695163118377407, 21.549528921968317, 23.591662563100414, 17.02728639227176, 26.521080788338658, 10.47529356639313, 39.63204381957158, 122.53573005865213, 6.597955031415104, 111.81716021505576, 90.64738947380803, 16.032071772288592, 15.81977630226067, 58.78173358747623, 20.754183316891055, 40.9971414669148, 15.009170086387293, 17.245720901796886, 13.327298231119912, 7.274853823835279, 25.217406331835345, 67.53031001482535, 16.32665985667749, 21.487922910871532, 14.184575610172026, 12.21555377661706, 88.2622656105404, 16.26935178672073, 17.868839495273054, 16.637221961353415, 23.303988630341458, 14.304520867524815, 67.97546620856437, 70.1965046062452, 24.60676098064042, 18.784638353334888, -24.31773689789669, 18.821997531567863, 17.637829096772123, 31.64809298550321, -48.28354222846745, 16.58472989802512, 17.11252463037066, 26.222004733810778, 63.47712045870514], "episode_lengths": [295, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 269, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.090345095039287, "mean_inference_ms": 6.798027958801928, "mean_action_processing_ms": 0.46871844033217586, "mean_env_wait_ms": 20.547588617713515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0251619815826416, "StateBufferConnector_ms": 0.027118444442749023, "ViewRequirementAgentConnector_ms": 0.805485725402832}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840473, "num_agent_steps_trained": 840473, "num_env_steps_sampled": 840473, "num_env_steps_trained": 840473, "num_env_steps_sampled_this_iter": 12350, "num_env_steps_trained_this_iter": 12350, "num_env_steps_sampled_throughput_per_sec": 225.86238835799463, "num_env_steps_trained_throughput_per_sec": 225.86238835799463, "timesteps_total": 840473, "num_steps_trained_this_iter": 12350, "agent_timesteps_total": 840473, "timers": {"training_iteration_time_ms": 47203.135, "sample_time_ms": 33373.638, "load_time_ms": 1271.501, "load_throughput": 7642.147, "learn_time_ms": 12045.868, "learn_throughput": 806.667, "synch_weights_time_ms": 443.034}, "counters": {"num_env_steps_sampled": 840473, "num_env_steps_trained": 840473, "num_agent_steps_sampled": 840473, "num_agent_steps_trained": 840473}, "done": false, "episodes_total": 1278, "training_iteration": 91, "trial_id": "32ccc_00000", "date": "2025-06-07_13-11-11", "timestamp": 1749294671, "time_this_iter_s": 54.695019006729126, "time_total_s": 4190.160153865814, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4190.160153865814, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 64.1359375, "ram_util_percent": 88.40156250000001, "gpu_util_percent0": 0.16875, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.159527000000001e-05, "total_loss": -0.11280046943575144, "policy_loss": -0.03632339254926102, "vf_loss": 0.05615573095229383, "vf_explained_var": 0.9605481824049583, "kl": 0.011953652595995944, "entropy": 16.354601181470432, "entropy_coeff": 0.005797635}, "model": {}, "num_grad_updates_lifetime": 29740.5, "diff_num_grad_updates_vs_sampler_policy": 129.5}}, "num_env_steps_sampled": 847891, "num_env_steps_trained": 847891, "num_agent_steps_sampled": 847891, "num_agent_steps_trained": 847891}, "sampler_results": {"episode_reward_max": 122.53573005865213, "episode_reward_min": -48.28354222846745, "episode_reward_mean": 24.14754204522023, "episode_len_mean": 681.08, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.884690506898757, 18.129211861254163, 17.186326177938646, 23.70388322009292, 11.798362294426472, 17.753819847498804, 21.836181969923487, 2.7337783812778422, 85.36471627694752, -5.88994825208565, 21.251251010287156, 11.08427765473731, 66.0675283325092, 79.6130658626369, 15.462118458074784, -41.35690227075625, 9.712081052378654, 33.60292629940709, 17.950756405853973, 41.497809367051815, 21.607946794201684, 12.651181653208857, 20.23288384324432, 29.984054832146384, 18.138508647116595, 20.016794037497977, -9.071227921627703, 17.32925656941185, -2.2410431383793985, 22.02642437468566, 18.883124302341265, 22.081802582767377, -2.259352869747456, 35.34788436967694, 20.528575433478625, 12.259844447661793, 19.512192985797903, 18.797137570902642, 0.20097559277277097, 15.307587401996528, 12.347262504522666, 13.695163118377407, 21.549528921968317, 23.591662563100414, 17.02728639227176, 26.521080788338658, 10.47529356639313, 39.63204381957158, 122.53573005865213, 6.597955031415104, 111.81716021505576, 90.64738947380803, 16.032071772288592, 15.81977630226067, 58.78173358747623, 20.754183316891055, 40.9971414669148, 15.009170086387293, 17.245720901796886, 13.327298231119912, 7.274853823835279, 25.217406331835345, 67.53031001482535, 16.32665985667749, 21.487922910871532, 14.184575610172026, 12.21555377661706, 88.2622656105404, 16.26935178672073, 17.868839495273054, 16.637221961353415, 23.303988630341458, 14.304520867524815, 67.97546620856437, 70.1965046062452, 24.60676098064042, 18.784638353334888, -24.31773689789669, 18.821997531567863, 17.637829096772123, 31.64809298550321, -48.28354222846745, 16.58472989802512, 17.11252463037066, 26.222004733810778, 63.47712045870514, 53.63976207164808, 17.087642579357663, 17.59909786471196, 26.13121576330237, 14.932200556032747, 17.78162148463524, 23.42649180432289, 0.2794773280105287, 16.502720711580114, 89.97990129720641, 15.49893752992492, -16.613199135985106, 13.899078333994373, 17.134257215398495], "episode_lengths": [295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 269, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0930282024193856, "mean_inference_ms": 6.801212846532137, "mean_action_processing_ms": 0.46895074146306653, "mean_env_wait_ms": 20.55519350421288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027080297470092773, "StateBufferConnector_ms": 0.029064178466796875, "ViewRequirementAgentConnector_ms": 0.804110050201416}}, "episode_reward_max": 122.53573005865213, "episode_reward_min": -48.28354222846745, "episode_reward_mean": 24.14754204522023, "episode_len_mean": 681.08, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.884690506898757, 18.129211861254163, 17.186326177938646, 23.70388322009292, 11.798362294426472, 17.753819847498804, 21.836181969923487, 2.7337783812778422, 85.36471627694752, -5.88994825208565, 21.251251010287156, 11.08427765473731, 66.0675283325092, 79.6130658626369, 15.462118458074784, -41.35690227075625, 9.712081052378654, 33.60292629940709, 17.950756405853973, 41.497809367051815, 21.607946794201684, 12.651181653208857, 20.23288384324432, 29.984054832146384, 18.138508647116595, 20.016794037497977, -9.071227921627703, 17.32925656941185, -2.2410431383793985, 22.02642437468566, 18.883124302341265, 22.081802582767377, -2.259352869747456, 35.34788436967694, 20.528575433478625, 12.259844447661793, 19.512192985797903, 18.797137570902642, 0.20097559277277097, 15.307587401996528, 12.347262504522666, 13.695163118377407, 21.549528921968317, 23.591662563100414, 17.02728639227176, 26.521080788338658, 10.47529356639313, 39.63204381957158, 122.53573005865213, 6.597955031415104, 111.81716021505576, 90.64738947380803, 16.032071772288592, 15.81977630226067, 58.78173358747623, 20.754183316891055, 40.9971414669148, 15.009170086387293, 17.245720901796886, 13.327298231119912, 7.274853823835279, 25.217406331835345, 67.53031001482535, 16.32665985667749, 21.487922910871532, 14.184575610172026, 12.21555377661706, 88.2622656105404, 16.26935178672073, 17.868839495273054, 16.637221961353415, 23.303988630341458, 14.304520867524815, 67.97546620856437, 70.1965046062452, 24.60676098064042, 18.784638353334888, -24.31773689789669, 18.821997531567863, 17.637829096772123, 31.64809298550321, -48.28354222846745, 16.58472989802512, 17.11252463037066, 26.222004733810778, 63.47712045870514, 53.63976207164808, 17.087642579357663, 17.59909786471196, 26.13121576330237, 14.932200556032747, 17.78162148463524, 23.42649180432289, 0.2794773280105287, 16.502720711580114, 89.97990129720641, 15.49893752992492, -16.613199135985106, 13.899078333994373, 17.134257215398495], "episode_lengths": [295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 269, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0930282024193856, "mean_inference_ms": 6.801212846532137, "mean_action_processing_ms": 0.46895074146306653, "mean_env_wait_ms": 20.55519350421288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027080297470092773, "StateBufferConnector_ms": 0.029064178466796875, "ViewRequirementAgentConnector_ms": 0.804110050201416}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 847891, "num_agent_steps_trained": 847891, "num_env_steps_sampled": 847891, "num_env_steps_trained": 847891, "num_env_steps_sampled_this_iter": 7418, "num_env_steps_trained_this_iter": 7418, "num_env_steps_sampled_throughput_per_sec": 196.14020129019008, "num_env_steps_trained_throughput_per_sec": 196.14020129019008, "timesteps_total": 847891, "num_steps_trained_this_iter": 7418, "agent_timesteps_total": 847891, "timers": {"training_iteration_time_ms": 45758.0, "sample_time_ms": 32932.772, "load_time_ms": 1187.491, "load_throughput": 7836.691, "learn_time_ms": 11130.841, "learn_throughput": 836.055, "synch_weights_time_ms": 439.293}, "counters": {"num_env_steps_sampled": 847891, "num_env_steps_trained": 847891, "num_agent_steps_sampled": 847891, "num_agent_steps_trained": 847891}, "done": false, "episodes_total": 1292, "training_iteration": 92, "trial_id": "32ccc_00000", "date": "2025-06-07_13-11-49", "timestamp": 1749294709, "time_this_iter_s": 37.87289524078369, "time_total_s": 4228.033049106598, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4228.033049106598, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 53.61086956521739, "ram_util_percent": 86.65434782608693, "gpu_util_percent0": 0.06695652173913044, "vram_util_percent0": 0.9650065104166663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.152108999999999e-05, "total_loss": -0.1168913746265389, "policy_loss": -0.04031609481826308, "vf_loss": 0.05372360952605959, "vf_explained_var": 0.9382265323773027, "kl": 0.013533502028258227, "entropy": 16.38456959426403, "entropy_coeff": 0.005760545}, "model": {}, "num_grad_updates_lifetime": 30030.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 856953, "num_env_steps_trained": 856953, "num_agent_steps_sampled": 856953, "num_agent_steps_trained": 856953}, "sampler_results": {"episode_reward_max": 122.53573005865213, "episode_reward_min": -48.28354222846745, "episode_reward_mean": 24.054310411700467, "episode_len_mean": 672.86, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.462118458074784, -41.35690227075625, 9.712081052378654, 33.60292629940709, 17.950756405853973, 41.497809367051815, 21.607946794201684, 12.651181653208857, 20.23288384324432, 29.984054832146384, 18.138508647116595, 20.016794037497977, -9.071227921627703, 17.32925656941185, -2.2410431383793985, 22.02642437468566, 18.883124302341265, 22.081802582767377, -2.259352869747456, 35.34788436967694, 20.528575433478625, 12.259844447661793, 19.512192985797903, 18.797137570902642, 0.20097559277277097, 15.307587401996528, 12.347262504522666, 13.695163118377407, 21.549528921968317, 23.591662563100414, 17.02728639227176, 26.521080788338658, 10.47529356639313, 39.63204381957158, 122.53573005865213, 6.597955031415104, 111.81716021505576, 90.64738947380803, 16.032071772288592, 15.81977630226067, 58.78173358747623, 20.754183316891055, 40.9971414669148, 15.009170086387293, 17.245720901796886, 13.327298231119912, 7.274853823835279, 25.217406331835345, 67.53031001482535, 16.32665985667749, 21.487922910871532, 14.184575610172026, 12.21555377661706, 88.2622656105404, 16.26935178672073, 17.868839495273054, 16.637221961353415, 23.303988630341458, 14.304520867524815, 67.97546620856437, 70.1965046062452, 24.60676098064042, 18.784638353334888, -24.31773689789669, 18.821997531567863, 17.637829096772123, 31.64809298550321, -48.28354222846745, 16.58472989802512, 17.11252463037066, 26.222004733810778, 63.47712045870514, 53.63976207164808, 17.087642579357663, 17.59909786471196, 26.13121576330237, 14.932200556032747, 17.78162148463524, 23.42649180432289, 0.2794773280105287, 16.502720711580114, 89.97990129720641, 15.49893752992492, -16.613199135985106, 13.899078333994373, 17.134257215398495, 18.796266056471495, 34.61965933228716, 54.9494100492209, 26.42229668412626, 24.206593756108024, 66.23106434300234, 28.465807968489056, 19.08291538936619, 41.34591738879345, -5.341893577500461, 15.323823268275511, 19.664521795783546, 17.997380385957094, 12.430218951986506], "episode_lengths": [295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 269, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0956177728087426, "mean_inference_ms": 6.804213032004594, "mean_action_processing_ms": 0.46920371058546356, "mean_env_wait_ms": 20.562442358137744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03714466094970703, "StateBufferConnector_ms": 0.02693629264831543, "ViewRequirementAgentConnector_ms": 0.8079519271850586}}, "episode_reward_max": 122.53573005865213, "episode_reward_min": -48.28354222846745, "episode_reward_mean": 24.054310411700467, "episode_len_mean": 672.86, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.462118458074784, -41.35690227075625, 9.712081052378654, 33.60292629940709, 17.950756405853973, 41.497809367051815, 21.607946794201684, 12.651181653208857, 20.23288384324432, 29.984054832146384, 18.138508647116595, 20.016794037497977, -9.071227921627703, 17.32925656941185, -2.2410431383793985, 22.02642437468566, 18.883124302341265, 22.081802582767377, -2.259352869747456, 35.34788436967694, 20.528575433478625, 12.259844447661793, 19.512192985797903, 18.797137570902642, 0.20097559277277097, 15.307587401996528, 12.347262504522666, 13.695163118377407, 21.549528921968317, 23.591662563100414, 17.02728639227176, 26.521080788338658, 10.47529356639313, 39.63204381957158, 122.53573005865213, 6.597955031415104, 111.81716021505576, 90.64738947380803, 16.032071772288592, 15.81977630226067, 58.78173358747623, 20.754183316891055, 40.9971414669148, 15.009170086387293, 17.245720901796886, 13.327298231119912, 7.274853823835279, 25.217406331835345, 67.53031001482535, 16.32665985667749, 21.487922910871532, 14.184575610172026, 12.21555377661706, 88.2622656105404, 16.26935178672073, 17.868839495273054, 16.637221961353415, 23.303988630341458, 14.304520867524815, 67.97546620856437, 70.1965046062452, 24.60676098064042, 18.784638353334888, -24.31773689789669, 18.821997531567863, 17.637829096772123, 31.64809298550321, -48.28354222846745, 16.58472989802512, 17.11252463037066, 26.222004733810778, 63.47712045870514, 53.63976207164808, 17.087642579357663, 17.59909786471196, 26.13121576330237, 14.932200556032747, 17.78162148463524, 23.42649180432289, 0.2794773280105287, 16.502720711580114, 89.97990129720641, 15.49893752992492, -16.613199135985106, 13.899078333994373, 17.134257215398495, 18.796266056471495, 34.61965933228716, 54.9494100492209, 26.42229668412626, 24.206593756108024, 66.23106434300234, 28.465807968489056, 19.08291538936619, 41.34591738879345, -5.341893577500461, 15.323823268275511, 19.664521795783546, 17.997380385957094, 12.430218951986506], "episode_lengths": [295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 269, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0956177728087426, "mean_inference_ms": 6.804213032004594, "mean_action_processing_ms": 0.46920371058546356, "mean_env_wait_ms": 20.562442358137744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03714466094970703, "StateBufferConnector_ms": 0.02693629264831543, "ViewRequirementAgentConnector_ms": 0.8079519271850586}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 856953, "num_agent_steps_trained": 856953, "num_env_steps_sampled": 856953, "num_env_steps_trained": 856953, "num_env_steps_sampled_this_iter": 9062, "num_env_steps_trained_this_iter": 9062, "num_env_steps_sampled_throughput_per_sec": 191.93731733462428, "num_env_steps_trained_throughput_per_sec": 191.93731733462428, "timesteps_total": 856953, "num_steps_trained_this_iter": 9062, "agent_timesteps_total": 856953, "timers": {"training_iteration_time_ms": 46735.237, "sample_time_ms": 33228.663, "load_time_ms": 1227.326, "load_throughput": 7716.286, "learn_time_ms": 11778.683, "learn_throughput": 804.029, "synch_weights_time_ms": 432.727}, "counters": {"num_env_steps_sampled": 856953, "num_env_steps_trained": 856953, "num_agent_steps_sampled": 856953, "num_agent_steps_trained": 856953}, "done": false, "episodes_total": 1306, "training_iteration": 93, "trial_id": "32ccc_00000", "date": "2025-06-07_13-12-36", "timestamp": 1749294756, "time_this_iter_s": 47.245203256607056, "time_total_s": 4275.278252363205, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4275.278252363205, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 54.95263157894736, "ram_util_percent": 86.53508771929823, "gpu_util_percent0": 0.1668421052631579, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.143047000000002e-05, "total_loss": -0.10086895194432985, "policy_loss": -0.025823046460097362, "vf_loss": 0.05493043324050422, "vf_explained_var": 0.9445124298334122, "kl": 0.013028557155429063, "entropy": 16.299172694866474, "entropy_coeff": 0.005715235}, "model": {}, "num_grad_updates_lifetime": 30320.5, "diff_num_grad_updates_vs_sampler_policy": 129.5}}, "num_env_steps_sampled": 864371, "num_env_steps_trained": 864371, "num_agent_steps_sampled": 864371, "num_agent_steps_trained": 864371}, "sampler_results": {"episode_reward_max": 122.53573005865213, "episode_reward_min": -48.28354222846745, "episode_reward_mean": 25.466254797057335, "episode_len_mean": 639.98, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2410431383793985, 22.02642437468566, 18.883124302341265, 22.081802582767377, -2.259352869747456, 35.34788436967694, 20.528575433478625, 12.259844447661793, 19.512192985797903, 18.797137570902642, 0.20097559277277097, 15.307587401996528, 12.347262504522666, 13.695163118377407, 21.549528921968317, 23.591662563100414, 17.02728639227176, 26.521080788338658, 10.47529356639313, 39.63204381957158, 122.53573005865213, 6.597955031415104, 111.81716021505576, 90.64738947380803, 16.032071772288592, 15.81977630226067, 58.78173358747623, 20.754183316891055, 40.9971414669148, 15.009170086387293, 17.245720901796886, 13.327298231119912, 7.274853823835279, 25.217406331835345, 67.53031001482535, 16.32665985667749, 21.487922910871532, 14.184575610172026, 12.21555377661706, 88.2622656105404, 16.26935178672073, 17.868839495273054, 16.637221961353415, 23.303988630341458, 14.304520867524815, 67.97546620856437, 70.1965046062452, 24.60676098064042, 18.784638353334888, -24.31773689789669, 18.821997531567863, 17.637829096772123, 31.64809298550321, -48.28354222846745, 16.58472989802512, 17.11252463037066, 26.222004733810778, 63.47712045870514, 53.63976207164808, 17.087642579357663, 17.59909786471196, 26.13121576330237, 14.932200556032747, 17.78162148463524, 23.42649180432289, 0.2794773280105287, 16.502720711580114, 89.97990129720641, 15.49893752992492, -16.613199135985106, 13.899078333994373, 17.134257215398495, 18.796266056471495, 34.61965933228716, 54.9494100492209, 26.42229668412626, 24.206593756108024, 66.23106434300234, 28.465807968489056, 19.08291538936619, 41.34591738879345, -5.341893577500461, 15.323823268275511, 19.664521795783546, 17.997380385957094, 12.430218951986506, 66.28548416728091, 22.306669226952213, -3.7414055397612156, 84.96942229588879, 14.258218512883102, 14.775752655405537, 23.613643654890264, 27.66974421453455, 12.839360005400653, 19.423883323763288, 17.730455134265434, 19.0014851816483, 13.467181812870496, 16.352731656874575], "episode_lengths": [1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 269, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.098067150042982, "mean_inference_ms": 6.807187131106271, "mean_action_processing_ms": 0.46947409066584994, "mean_env_wait_ms": 20.56864375591346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03862190246582031, "StateBufferConnector_ms": 0.026961803436279297, "ViewRequirementAgentConnector_ms": 0.8301551342010498}}, "episode_reward_max": 122.53573005865213, "episode_reward_min": -48.28354222846745, "episode_reward_mean": 25.466254797057335, "episode_len_mean": 639.98, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2410431383793985, 22.02642437468566, 18.883124302341265, 22.081802582767377, -2.259352869747456, 35.34788436967694, 20.528575433478625, 12.259844447661793, 19.512192985797903, 18.797137570902642, 0.20097559277277097, 15.307587401996528, 12.347262504522666, 13.695163118377407, 21.549528921968317, 23.591662563100414, 17.02728639227176, 26.521080788338658, 10.47529356639313, 39.63204381957158, 122.53573005865213, 6.597955031415104, 111.81716021505576, 90.64738947380803, 16.032071772288592, 15.81977630226067, 58.78173358747623, 20.754183316891055, 40.9971414669148, 15.009170086387293, 17.245720901796886, 13.327298231119912, 7.274853823835279, 25.217406331835345, 67.53031001482535, 16.32665985667749, 21.487922910871532, 14.184575610172026, 12.21555377661706, 88.2622656105404, 16.26935178672073, 17.868839495273054, 16.637221961353415, 23.303988630341458, 14.304520867524815, 67.97546620856437, 70.1965046062452, 24.60676098064042, 18.784638353334888, -24.31773689789669, 18.821997531567863, 17.637829096772123, 31.64809298550321, -48.28354222846745, 16.58472989802512, 17.11252463037066, 26.222004733810778, 63.47712045870514, 53.63976207164808, 17.087642579357663, 17.59909786471196, 26.13121576330237, 14.932200556032747, 17.78162148463524, 23.42649180432289, 0.2794773280105287, 16.502720711580114, 89.97990129720641, 15.49893752992492, -16.613199135985106, 13.899078333994373, 17.134257215398495, 18.796266056471495, 34.61965933228716, 54.9494100492209, 26.42229668412626, 24.206593756108024, 66.23106434300234, 28.465807968489056, 19.08291538936619, 41.34591738879345, -5.341893577500461, 15.323823268275511, 19.664521795783546, 17.997380385957094, 12.430218951986506, 66.28548416728091, 22.306669226952213, -3.7414055397612156, 84.96942229588879, 14.258218512883102, 14.775752655405537, 23.613643654890264, 27.66974421453455, 12.839360005400653, 19.423883323763288, 17.730455134265434, 19.0014851816483, 13.467181812870496, 16.352731656874575], "episode_lengths": [1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 269, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.098067150042982, "mean_inference_ms": 6.807187131106271, "mean_action_processing_ms": 0.46947409066584994, "mean_env_wait_ms": 20.56864375591346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03862190246582031, "StateBufferConnector_ms": 0.026961803436279297, "ViewRequirementAgentConnector_ms": 0.8301551342010498}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864371, "num_agent_steps_trained": 864371, "num_env_steps_sampled": 864371, "num_env_steps_trained": 864371, "num_env_steps_sampled_this_iter": 7418, "num_env_steps_trained_this_iter": 7418, "num_env_steps_sampled_throughput_per_sec": 198.40406597983605, "num_env_steps_trained_throughput_per_sec": 198.40406597983605, "timesteps_total": 864371, "num_steps_trained_this_iter": 7418, "agent_timesteps_total": 864371, "timers": {"training_iteration_time_ms": 45724.295, "sample_time_ms": 32944.935, "load_time_ms": 1185.039, "load_throughput": 7783.54, "learn_time_ms": 11095.34, "learn_throughput": 831.322, "synch_weights_time_ms": 431.745}, "counters": {"num_env_steps_sampled": 864371, "num_env_steps_trained": 864371, "num_agent_steps_sampled": 864371, "num_agent_steps_trained": 864371}, "done": false, "episodes_total": 1320, "training_iteration": 94, "trial_id": "32ccc_00000", "date": "2025-06-07_13-13-14", "timestamp": 1749294794, "time_this_iter_s": 37.40432953834534, "time_total_s": 4312.68258190155, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4312.68258190155, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 54.7840909090909, "ram_util_percent": 86.25454545454546, "gpu_util_percent0": 0.06431818181818182, "vram_util_percent0": 0.9650065104166664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.135629000000004e-05, "total_loss": -0.09313453167866867, "policy_loss": -0.02291842659553942, "vf_loss": 0.07273767755955066, "vf_explained_var": 0.9268984527964341, "kl": 0.014437348921909078, "entropy": 16.52688946723938, "entropy_coeff": 0.005678145000000002}, "model": {}, "num_grad_updates_lifetime": 30640.5, "diff_num_grad_updates_vs_sampler_policy": 189.5}}, "num_env_steps_sampled": 875077, "num_env_steps_trained": 875077, "num_agent_steps_sampled": 875077, "num_agent_steps_trained": 875077}, "sampler_results": {"episode_reward_max": 122.53573005865213, "episode_reward_min": -48.28354222846745, "episode_reward_mean": 28.42983613447519, "episode_len_mean": 664.64, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.549528921968317, 23.591662563100414, 17.02728639227176, 26.521080788338658, 10.47529356639313, 39.63204381957158, 122.53573005865213, 6.597955031415104, 111.81716021505576, 90.64738947380803, 16.032071772288592, 15.81977630226067, 58.78173358747623, 20.754183316891055, 40.9971414669148, 15.009170086387293, 17.245720901796886, 13.327298231119912, 7.274853823835279, 25.217406331835345, 67.53031001482535, 16.32665985667749, 21.487922910871532, 14.184575610172026, 12.21555377661706, 88.2622656105404, 16.26935178672073, 17.868839495273054, 16.637221961353415, 23.303988630341458, 14.304520867524815, 67.97546620856437, 70.1965046062452, 24.60676098064042, 18.784638353334888, -24.31773689789669, 18.821997531567863, 17.637829096772123, 31.64809298550321, -48.28354222846745, 16.58472989802512, 17.11252463037066, 26.222004733810778, 63.47712045870514, 53.63976207164808, 17.087642579357663, 17.59909786471196, 26.13121576330237, 14.932200556032747, 17.78162148463524, 23.42649180432289, 0.2794773280105287, 16.502720711580114, 89.97990129720641, 15.49893752992492, -16.613199135985106, 13.899078333994373, 17.134257215398495, 18.796266056471495, 34.61965933228716, 54.9494100492209, 26.42229668412626, 24.206593756108024, 66.23106434300234, 28.465807968489056, 19.08291538936619, 41.34591738879345, -5.341893577500461, 15.323823268275511, 19.664521795783546, 17.997380385957094, 12.430218951986506, 66.28548416728091, 22.306669226952213, -3.7414055397612156, 84.96942229588879, 14.258218512883102, 14.775752655405537, 23.613643654890264, 27.66974421453455, 12.839360005400653, 19.423883323763288, 17.730455134265434, 19.0014851816483, 13.467181812870496, 16.352731656874575, 16.87199552472753, 108.55826413293224, 14.613059622945954, 14.68441444193339, 15.731998368934413, 17.37685354420884, 24.163409934867314, 54.43009273777445, 36.43520958173033, -32.7478617126863, 66.01418936120082, 79.02894935784055, 57.44546110766359, 30.23967641456699], "episode_lengths": [1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 269, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1004507463605755, "mean_inference_ms": 6.810164173525217, "mean_action_processing_ms": 0.4697327434519536, "mean_env_wait_ms": 20.574785158657143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04070782661437988, "StateBufferConnector_ms": 0.0329279899597168, "ViewRequirementAgentConnector_ms": 0.8041234016418457}}, "episode_reward_max": 122.53573005865213, "episode_reward_min": -48.28354222846745, "episode_reward_mean": 28.42983613447519, "episode_len_mean": 664.64, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.549528921968317, 23.591662563100414, 17.02728639227176, 26.521080788338658, 10.47529356639313, 39.63204381957158, 122.53573005865213, 6.597955031415104, 111.81716021505576, 90.64738947380803, 16.032071772288592, 15.81977630226067, 58.78173358747623, 20.754183316891055, 40.9971414669148, 15.009170086387293, 17.245720901796886, 13.327298231119912, 7.274853823835279, 25.217406331835345, 67.53031001482535, 16.32665985667749, 21.487922910871532, 14.184575610172026, 12.21555377661706, 88.2622656105404, 16.26935178672073, 17.868839495273054, 16.637221961353415, 23.303988630341458, 14.304520867524815, 67.97546620856437, 70.1965046062452, 24.60676098064042, 18.784638353334888, -24.31773689789669, 18.821997531567863, 17.637829096772123, 31.64809298550321, -48.28354222846745, 16.58472989802512, 17.11252463037066, 26.222004733810778, 63.47712045870514, 53.63976207164808, 17.087642579357663, 17.59909786471196, 26.13121576330237, 14.932200556032747, 17.78162148463524, 23.42649180432289, 0.2794773280105287, 16.502720711580114, 89.97990129720641, 15.49893752992492, -16.613199135985106, 13.899078333994373, 17.134257215398495, 18.796266056471495, 34.61965933228716, 54.9494100492209, 26.42229668412626, 24.206593756108024, 66.23106434300234, 28.465807968489056, 19.08291538936619, 41.34591738879345, -5.341893577500461, 15.323823268275511, 19.664521795783546, 17.997380385957094, 12.430218951986506, 66.28548416728091, 22.306669226952213, -3.7414055397612156, 84.96942229588879, 14.258218512883102, 14.775752655405537, 23.613643654890264, 27.66974421453455, 12.839360005400653, 19.423883323763288, 17.730455134265434, 19.0014851816483, 13.467181812870496, 16.352731656874575, 16.87199552472753, 108.55826413293224, 14.613059622945954, 14.68441444193339, 15.731998368934413, 17.37685354420884, 24.163409934867314, 54.43009273777445, 36.43520958173033, -32.7478617126863, 66.01418936120082, 79.02894935784055, 57.44546110766359, 30.23967641456699], "episode_lengths": [1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 269, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1004507463605755, "mean_inference_ms": 6.810164173525217, "mean_action_processing_ms": 0.4697327434519536, "mean_env_wait_ms": 20.574785158657143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04070782661437988, "StateBufferConnector_ms": 0.0329279899597168, "ViewRequirementAgentConnector_ms": 0.8041234016418457}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 875077, "num_agent_steps_trained": 875077, "num_env_steps_sampled": 875077, "num_env_steps_trained": 875077, "num_env_steps_sampled_this_iter": 10706, "num_env_steps_trained_this_iter": 10706, "num_env_steps_sampled_throughput_per_sec": 210.91755120222442, "num_env_steps_trained_throughput_per_sec": 210.91755120222442, "timesteps_total": 875077, "num_steps_trained_this_iter": 10706, "agent_timesteps_total": 875077, "timers": {"training_iteration_time_ms": 46326.358, "sample_time_ms": 33197.345, "load_time_ms": 1209.321, "load_throughput": 7831.174, "learn_time_ms": 11421.689, "learn_throughput": 829.159, "synch_weights_time_ms": 428.869}, "counters": {"num_env_steps_sampled": 875077, "num_env_steps_trained": 875077, "num_agent_steps_sampled": 875077, "num_agent_steps_trained": 875077}, "done": false, "episodes_total": 1334, "training_iteration": 95, "trial_id": "32ccc_00000", "date": "2025-06-07_13-14-05", "timestamp": 1749294845, "time_this_iter_s": 50.778167963027954, "time_total_s": 4363.460749864578, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4363.460749864578, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 58.699999999999996, "ram_util_percent": 87.54590163934424, "gpu_util_percent0": 0.17491803278688528, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.124923000000001e-05, "total_loss": -0.11288691468374884, "policy_loss": -0.03849529876454693, "vf_loss": 0.05591978239624397, "vf_explained_var": 0.9503509495569312, "kl": 0.012284381887381998, "entropy": 16.48167843611344, "entropy_coeff": 0.005624615}, "model": {}, "num_grad_updates_lifetime": 30945.5, "diff_num_grad_updates_vs_sampler_policy": 114.5}}, "num_env_steps_sampled": 881673, "num_env_steps_trained": 881673, "num_agent_steps_sampled": 881673, "num_agent_steps_trained": 881673}, "sampler_results": {"episode_reward_max": 108.55826413293224, "episode_reward_min": -48.28354222846745, "episode_reward_mean": 25.50767444028596, "episode_len_mean": 623.54, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.9971414669148, 15.009170086387293, 17.245720901796886, 13.327298231119912, 7.274853823835279, 25.217406331835345, 67.53031001482535, 16.32665985667749, 21.487922910871532, 14.184575610172026, 12.21555377661706, 88.2622656105404, 16.26935178672073, 17.868839495273054, 16.637221961353415, 23.303988630341458, 14.304520867524815, 67.97546620856437, 70.1965046062452, 24.60676098064042, 18.784638353334888, -24.31773689789669, 18.821997531567863, 17.637829096772123, 31.64809298550321, -48.28354222846745, 16.58472989802512, 17.11252463037066, 26.222004733810778, 63.47712045870514, 53.63976207164808, 17.087642579357663, 17.59909786471196, 26.13121576330237, 14.932200556032747, 17.78162148463524, 23.42649180432289, 0.2794773280105287, 16.502720711580114, 89.97990129720641, 15.49893752992492, -16.613199135985106, 13.899078333994373, 17.134257215398495, 18.796266056471495, 34.61965933228716, 54.9494100492209, 26.42229668412626, 24.206593756108024, 66.23106434300234, 28.465807968489056, 19.08291538936619, 41.34591738879345, -5.341893577500461, 15.323823268275511, 19.664521795783546, 17.997380385957094, 12.430218951986506, 66.28548416728091, 22.306669226952213, -3.7414055397612156, 84.96942229588879, 14.258218512883102, 14.775752655405537, 23.613643654890264, 27.66974421453455, 12.839360005400653, 19.423883323763288, 17.730455134265434, 19.0014851816483, 13.467181812870496, 16.352731656874575, 16.87199552472753, 108.55826413293224, 14.613059622945954, 14.68441444193339, 15.731998368934413, 17.37685354420884, 24.163409934867314, 54.43009273777445, 36.43520958173033, -32.7478617126863, 66.01418936120082, 79.02894935784055, 57.44546110766359, 30.23967641456699, 10.086322971236124, 26.652819057293733, 14.387181135937116, 11.184018647359443, -7.646159134232108, 14.45816051642307, 21.534430834178167, 19.55780695944392, 18.254892935154036, 14.578533664969928, 16.375217831030206, 102.20634867528459, 14.783379589957265, 13.153772706533283], "episode_lengths": [1117, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 269, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.102918893984641, "mean_inference_ms": 6.813189433384449, "mean_action_processing_ms": 0.47000474328105596, "mean_env_wait_ms": 20.58086385726701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03870820999145508, "StateBufferConnector_ms": 0.03288006782531738, "ViewRequirementAgentConnector_ms": 0.8193364143371582}}, "episode_reward_max": 108.55826413293224, "episode_reward_min": -48.28354222846745, "episode_reward_mean": 25.50767444028596, "episode_len_mean": 623.54, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.9971414669148, 15.009170086387293, 17.245720901796886, 13.327298231119912, 7.274853823835279, 25.217406331835345, 67.53031001482535, 16.32665985667749, 21.487922910871532, 14.184575610172026, 12.21555377661706, 88.2622656105404, 16.26935178672073, 17.868839495273054, 16.637221961353415, 23.303988630341458, 14.304520867524815, 67.97546620856437, 70.1965046062452, 24.60676098064042, 18.784638353334888, -24.31773689789669, 18.821997531567863, 17.637829096772123, 31.64809298550321, -48.28354222846745, 16.58472989802512, 17.11252463037066, 26.222004733810778, 63.47712045870514, 53.63976207164808, 17.087642579357663, 17.59909786471196, 26.13121576330237, 14.932200556032747, 17.78162148463524, 23.42649180432289, 0.2794773280105287, 16.502720711580114, 89.97990129720641, 15.49893752992492, -16.613199135985106, 13.899078333994373, 17.134257215398495, 18.796266056471495, 34.61965933228716, 54.9494100492209, 26.42229668412626, 24.206593756108024, 66.23106434300234, 28.465807968489056, 19.08291538936619, 41.34591738879345, -5.341893577500461, 15.323823268275511, 19.664521795783546, 17.997380385957094, 12.430218951986506, 66.28548416728091, 22.306669226952213, -3.7414055397612156, 84.96942229588879, 14.258218512883102, 14.775752655405537, 23.613643654890264, 27.66974421453455, 12.839360005400653, 19.423883323763288, 17.730455134265434, 19.0014851816483, 13.467181812870496, 16.352731656874575, 16.87199552472753, 108.55826413293224, 14.613059622945954, 14.68441444193339, 15.731998368934413, 17.37685354420884, 24.163409934867314, 54.43009273777445, 36.43520958173033, -32.7478617126863, 66.01418936120082, 79.02894935784055, 57.44546110766359, 30.23967641456699, 10.086322971236124, 26.652819057293733, 14.387181135937116, 11.184018647359443, -7.646159134232108, 14.45816051642307, 21.534430834178167, 19.55780695944392, 18.254892935154036, 14.578533664969928, 16.375217831030206, 102.20634867528459, 14.783379589957265, 13.153772706533283], "episode_lengths": [1117, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 1117, 295, 295, 295, 269, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.102918893984641, "mean_inference_ms": 6.813189433384449, "mean_action_processing_ms": 0.47000474328105596, "mean_env_wait_ms": 20.58086385726701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03870820999145508, "StateBufferConnector_ms": 0.03288006782531738, "ViewRequirementAgentConnector_ms": 0.8193364143371582}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 881673, "num_agent_steps_trained": 881673, "num_env_steps_sampled": 881673, "num_env_steps_trained": 881673, "num_env_steps_sampled_this_iter": 6596, "num_env_steps_trained_this_iter": 6596, "num_env_steps_sampled_throughput_per_sec": 184.8144285822144, "num_env_steps_trained_throughput_per_sec": 184.8144285822144, "timesteps_total": 881673, "num_steps_trained_this_iter": 6596, "agent_timesteps_total": 881673, "timers": {"training_iteration_time_ms": 44795.412, "sample_time_ms": 32711.798, "load_time_ms": 1144.932, "load_throughput": 7912.61, "learn_time_ms": 10444.665, "learn_throughput": 867.371, "synch_weights_time_ms": 428.358}, "counters": {"num_env_steps_sampled": 881673, "num_env_steps_trained": 881673, "num_agent_steps_sampled": 881673, "num_agent_steps_trained": 881673}, "done": false, "episodes_total": 1348, "training_iteration": 96, "trial_id": "32ccc_00000", "date": "2025-06-07_13-14-41", "timestamp": 1749294881, "time_this_iter_s": 35.70585656166077, "time_total_s": 4399.166606426239, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4399.166606426239, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 50.75581395348837, "ram_util_percent": 86.18604651162791, "gpu_util_percent0": 0.06162790697674418, "vram_util_percent0": 0.9650065104166664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.118327e-05, "total_loss": -0.09819225848811429, "policy_loss": -0.027317653476010735, "vf_loss": 0.06646443052535377, "vf_explained_var": 0.9216584057342715, "kl": 0.012915640825584, "entropy": 16.529760121136178, "entropy_coeff": 0.005591634999999999}, "model": {}, "num_grad_updates_lifetime": 31265.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 893201, "num_env_steps_trained": 893201, "num_agent_steps_sampled": 893201, "num_agent_steps_trained": 893201}, "sampler_results": {"episode_reward_max": 113.88184257131452, "episode_reward_min": -68.17749946489809, "episode_reward_mean": 26.37950161613812, "episode_len_mean": 656.42, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.637221961353415, 23.303988630341458, 14.304520867524815, 67.97546620856437, 70.1965046062452, 24.60676098064042, 18.784638353334888, -24.31773689789669, 18.821997531567863, 17.637829096772123, 31.64809298550321, -48.28354222846745, 16.58472989802512, 17.11252463037066, 26.222004733810778, 63.47712045870514, 53.63976207164808, 17.087642579357663, 17.59909786471196, 26.13121576330237, 14.932200556032747, 17.78162148463524, 23.42649180432289, 0.2794773280105287, 16.502720711580114, 89.97990129720641, 15.49893752992492, -16.613199135985106, 13.899078333994373, 17.134257215398495, 18.796266056471495, 34.61965933228716, 54.9494100492209, 26.42229668412626, 24.206593756108024, 66.23106434300234, 28.465807968489056, 19.08291538936619, 41.34591738879345, -5.341893577500461, 15.323823268275511, 19.664521795783546, 17.997380385957094, 12.430218951986506, 66.28548416728091, 22.306669226952213, -3.7414055397612156, 84.96942229588879, 14.258218512883102, 14.775752655405537, 23.613643654890264, 27.66974421453455, 12.839360005400653, 19.423883323763288, 17.730455134265434, 19.0014851816483, 13.467181812870496, 16.352731656874575, 16.87199552472753, 108.55826413293224, 14.613059622945954, 14.68441444193339, 15.731998368934413, 17.37685354420884, 24.163409934867314, 54.43009273777445, 36.43520958173033, -32.7478617126863, 66.01418936120082, 79.02894935784055, 57.44546110766359, 30.23967641456699, 10.086322971236124, 26.652819057293733, 14.387181135937116, 11.184018647359443, -7.646159134232108, 14.45816051642307, 21.534430834178167, 19.55780695944392, 18.254892935154036, 14.578533664969928, 16.375217831030206, 102.20634867528459, 14.783379589957265, 13.153772706533283, 0.10657740897179513, 54.209442231804054, 9.364364309108431, 22.012939220229093, 81.69525559873853, 18.086161565224025, 68.47307454559095, 85.59375293951858, 22.37995087936452, 18.63211280947101, 14.247068214589937, 113.88184257131452, -68.17749946489809, 19.894744659776435], "episode_lengths": [295, 269, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.105551307075072, "mean_inference_ms": 6.816467594485539, "mean_action_processing_ms": 0.47027733721575726, "mean_env_wait_ms": 20.58799442057304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04172515869140625, "StateBufferConnector_ms": 0.03182506561279297, "ViewRequirementAgentConnector_ms": 0.8232421875}}, "episode_reward_max": 113.88184257131452, "episode_reward_min": -68.17749946489809, "episode_reward_mean": 26.37950161613812, "episode_len_mean": 656.42, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.637221961353415, 23.303988630341458, 14.304520867524815, 67.97546620856437, 70.1965046062452, 24.60676098064042, 18.784638353334888, -24.31773689789669, 18.821997531567863, 17.637829096772123, 31.64809298550321, -48.28354222846745, 16.58472989802512, 17.11252463037066, 26.222004733810778, 63.47712045870514, 53.63976207164808, 17.087642579357663, 17.59909786471196, 26.13121576330237, 14.932200556032747, 17.78162148463524, 23.42649180432289, 0.2794773280105287, 16.502720711580114, 89.97990129720641, 15.49893752992492, -16.613199135985106, 13.899078333994373, 17.134257215398495, 18.796266056471495, 34.61965933228716, 54.9494100492209, 26.42229668412626, 24.206593756108024, 66.23106434300234, 28.465807968489056, 19.08291538936619, 41.34591738879345, -5.341893577500461, 15.323823268275511, 19.664521795783546, 17.997380385957094, 12.430218951986506, 66.28548416728091, 22.306669226952213, -3.7414055397612156, 84.96942229588879, 14.258218512883102, 14.775752655405537, 23.613643654890264, 27.66974421453455, 12.839360005400653, 19.423883323763288, 17.730455134265434, 19.0014851816483, 13.467181812870496, 16.352731656874575, 16.87199552472753, 108.55826413293224, 14.613059622945954, 14.68441444193339, 15.731998368934413, 17.37685354420884, 24.163409934867314, 54.43009273777445, 36.43520958173033, -32.7478617126863, 66.01418936120082, 79.02894935784055, 57.44546110766359, 30.23967641456699, 10.086322971236124, 26.652819057293733, 14.387181135937116, 11.184018647359443, -7.646159134232108, 14.45816051642307, 21.534430834178167, 19.55780695944392, 18.254892935154036, 14.578533664969928, 16.375217831030206, 102.20634867528459, 14.783379589957265, 13.153772706533283, 0.10657740897179513, 54.209442231804054, 9.364364309108431, 22.012939220229093, 81.69525559873853, 18.086161565224025, 68.47307454559095, 85.59375293951858, 22.37995087936452, 18.63211280947101, 14.247068214589937, 113.88184257131452, -68.17749946489809, 19.894744659776435], "episode_lengths": [295, 269, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.105551307075072, "mean_inference_ms": 6.816467594485539, "mean_action_processing_ms": 0.47027733721575726, "mean_env_wait_ms": 20.58799442057304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04172515869140625, "StateBufferConnector_ms": 0.03182506561279297, "ViewRequirementAgentConnector_ms": 0.8232421875}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 893201, "num_agent_steps_trained": 893201, "num_env_steps_sampled": 893201, "num_env_steps_trained": 893201, "num_env_steps_sampled_this_iter": 11528, "num_env_steps_trained_this_iter": 11528, "num_env_steps_sampled_throughput_per_sec": 219.90993001017998, "num_env_steps_trained_throughput_per_sec": 219.90993001017998, "timesteps_total": 893201, "num_steps_trained_this_iter": 11528, "agent_timesteps_total": 893201, "timers": {"training_iteration_time_ms": 44893.964, "sample_time_ms": 32830.38, "load_time_ms": 1174.838, "load_throughput": 7781.156, "learn_time_ms": 10395.706, "learn_throughput": 879.363, "synch_weights_time_ms": 427.553}, "counters": {"num_env_steps_sampled": 893201, "num_env_steps_trained": 893201, "num_agent_steps_sampled": 893201, "num_agent_steps_trained": 893201}, "done": false, "episodes_total": 1362, "training_iteration": 97, "trial_id": "32ccc_00000", "date": "2025-06-07_13-15-33", "timestamp": 1749294933, "time_this_iter_s": 52.44049835205078, "time_total_s": 4451.60710477829, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4451.60710477829, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 61.182539682539684, "ram_util_percent": 87.82380952380949, "gpu_util_percent0": 0.16920634920634922, "vram_util_percent0": 0.9650065104166664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.106798999999998e-05, "total_loss": -0.09913994106945806, "policy_loss": -0.026911841403564504, "vf_loss": 0.060806904807044516, "vf_explained_var": 0.9328012139632784, "kl": 0.012987153291095605, "entropy": 16.641424902554217, "entropy_coeff": 0.005533995}, "model": {}, "num_grad_updates_lifetime": 31615.5, "diff_num_grad_updates_vs_sampler_policy": 144.5}}, "num_env_steps_sampled": 901441, "num_env_steps_trained": 901441, "num_agent_steps_sampled": 901441, "num_agent_steps_trained": 901441}, "sampler_results": {"episode_reward_max": 113.88184257131452, "episode_reward_min": -68.17749946489809, "episode_reward_mean": 26.98282387027607, "episode_len_mean": 632.02, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.222004733810778, 63.47712045870514, 53.63976207164808, 17.087642579357663, 17.59909786471196, 26.13121576330237, 14.932200556032747, 17.78162148463524, 23.42649180432289, 0.2794773280105287, 16.502720711580114, 89.97990129720641, 15.49893752992492, -16.613199135985106, 13.899078333994373, 17.134257215398495, 18.796266056471495, 34.61965933228716, 54.9494100492209, 26.42229668412626, 24.206593756108024, 66.23106434300234, 28.465807968489056, 19.08291538936619, 41.34591738879345, -5.341893577500461, 15.323823268275511, 19.664521795783546, 17.997380385957094, 12.430218951986506, 66.28548416728091, 22.306669226952213, -3.7414055397612156, 84.96942229588879, 14.258218512883102, 14.775752655405537, 23.613643654890264, 27.66974421453455, 12.839360005400653, 19.423883323763288, 17.730455134265434, 19.0014851816483, 13.467181812870496, 16.352731656874575, 16.87199552472753, 108.55826413293224, 14.613059622945954, 14.68441444193339, 15.731998368934413, 17.37685354420884, 24.163409934867314, 54.43009273777445, 36.43520958173033, -32.7478617126863, 66.01418936120082, 79.02894935784055, 57.44546110766359, 30.23967641456699, 10.086322971236124, 26.652819057293733, 14.387181135937116, 11.184018647359443, -7.646159134232108, 14.45816051642307, 21.534430834178167, 19.55780695944392, 18.254892935154036, 14.578533664969928, 16.375217831030206, 102.20634867528459, 14.783379589957265, 13.153772706533283, 0.10657740897179513, 54.209442231804054, 9.364364309108431, 22.012939220229093, 81.69525559873853, 18.086161565224025, 68.47307454559095, 85.59375293951858, 22.37995087936452, 18.63211280947101, 14.247068214589937, 113.88184257131452, -68.17749946489809, 19.894744659776435, 41.83903760331378, 50.603241385253654, 12.585054213522856, 22.703724426720413, 1.84032306566218, 17.433919220541974, 26.048938528739047, 14.222869250108905, 16.86336955331044, 17.783509880144454, 55.47032523297128, 20.690583185956754, 10.307748725918639, 16.952577765508984], "episode_lengths": [1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.107514070884008, "mean_inference_ms": 6.818790929009052, "mean_action_processing_ms": 0.47052658562949295, "mean_env_wait_ms": 20.592452599483657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042700767517089844, "StateBufferConnector_ms": 0.030801057815551758, "ViewRequirementAgentConnector_ms": 0.8123860359191895}}, "episode_reward_max": 113.88184257131452, "episode_reward_min": -68.17749946489809, "episode_reward_mean": 26.98282387027607, "episode_len_mean": 632.02, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.222004733810778, 63.47712045870514, 53.63976207164808, 17.087642579357663, 17.59909786471196, 26.13121576330237, 14.932200556032747, 17.78162148463524, 23.42649180432289, 0.2794773280105287, 16.502720711580114, 89.97990129720641, 15.49893752992492, -16.613199135985106, 13.899078333994373, 17.134257215398495, 18.796266056471495, 34.61965933228716, 54.9494100492209, 26.42229668412626, 24.206593756108024, 66.23106434300234, 28.465807968489056, 19.08291538936619, 41.34591738879345, -5.341893577500461, 15.323823268275511, 19.664521795783546, 17.997380385957094, 12.430218951986506, 66.28548416728091, 22.306669226952213, -3.7414055397612156, 84.96942229588879, 14.258218512883102, 14.775752655405537, 23.613643654890264, 27.66974421453455, 12.839360005400653, 19.423883323763288, 17.730455134265434, 19.0014851816483, 13.467181812870496, 16.352731656874575, 16.87199552472753, 108.55826413293224, 14.613059622945954, 14.68441444193339, 15.731998368934413, 17.37685354420884, 24.163409934867314, 54.43009273777445, 36.43520958173033, -32.7478617126863, 66.01418936120082, 79.02894935784055, 57.44546110766359, 30.23967641456699, 10.086322971236124, 26.652819057293733, 14.387181135937116, 11.184018647359443, -7.646159134232108, 14.45816051642307, 21.534430834178167, 19.55780695944392, 18.254892935154036, 14.578533664969928, 16.375217831030206, 102.20634867528459, 14.783379589957265, 13.153772706533283, 0.10657740897179513, 54.209442231804054, 9.364364309108431, 22.012939220229093, 81.69525559873853, 18.086161565224025, 68.47307454559095, 85.59375293951858, 22.37995087936452, 18.63211280947101, 14.247068214589937, 113.88184257131452, -68.17749946489809, 19.894744659776435, 41.83903760331378, 50.603241385253654, 12.585054213522856, 22.703724426720413, 1.84032306566218, 17.433919220541974, 26.048938528739047, 14.222869250108905, 16.86336955331044, 17.783509880144454, 55.47032523297128, 20.690583185956754, 10.307748725918639, 16.952577765508984], "episode_lengths": [1117, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.107514070884008, "mean_inference_ms": 6.818790929009052, "mean_action_processing_ms": 0.47052658562949295, "mean_env_wait_ms": 20.592452599483657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042700767517089844, "StateBufferConnector_ms": 0.030801057815551758, "ViewRequirementAgentConnector_ms": 0.8123860359191895}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 901441, "num_agent_steps_trained": 901441, "num_env_steps_sampled": 901441, "num_env_steps_trained": 901441, "num_env_steps_sampled_this_iter": 8240, "num_env_steps_trained_this_iter": 8240, "num_env_steps_sampled_throughput_per_sec": 190.25413249409183, "num_env_steps_trained_throughput_per_sec": 190.25413249409183, "timesteps_total": 901441, "num_steps_trained_this_iter": 8240, "agent_timesteps_total": 901441, "timers": {"training_iteration_time_ms": 44870.831, "sample_time_ms": 32796.541, "load_time_ms": 1182.54, "load_throughput": 7730.479, "learn_time_ms": 10397.126, "learn_throughput": 879.243, "synch_weights_time_ms": 429.088}, "counters": {"num_env_steps_sampled": 901441, "num_env_steps_trained": 901441, "num_agent_steps_sampled": 901441, "num_agent_steps_trained": 901441}, "done": false, "episodes_total": 1376, "training_iteration": 98, "trial_id": "32ccc_00000", "date": "2025-06-07_13-16-17", "timestamp": 1749294977, "time_this_iter_s": 43.32849168777466, "time_total_s": 4494.935596466064, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4494.935596466064, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 52.750980392156855, "ram_util_percent": 87.06862745098036, "gpu_util_percent0": 0.1511764705882353, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.098559000000001e-05, "total_loss": -0.07511297304600734, "policy_loss": -0.005648022687769142, "vf_loss": 0.06983954339320289, "vf_explained_var": 0.9284951565594509, "kl": 0.013625520932566422, "entropy": 16.7710627029682, "entropy_coeff": 0.005492795000000001}, "model": {}, "num_grad_updates_lifetime": 31905.5, "diff_num_grad_updates_vs_sampler_policy": 144.5}}, "num_env_steps_sampled": 909681, "num_env_steps_trained": 909681, "num_agent_steps_sampled": 909681, "num_agent_steps_trained": 909681}, "sampler_results": {"episode_reward_max": 113.88184257131452, "episode_reward_min": -68.17749946489809, "episode_reward_mean": 26.37217782280986, "episode_len_mean": 623.8, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.899078333994373, 17.134257215398495, 18.796266056471495, 34.61965933228716, 54.9494100492209, 26.42229668412626, 24.206593756108024, 66.23106434300234, 28.465807968489056, 19.08291538936619, 41.34591738879345, -5.341893577500461, 15.323823268275511, 19.664521795783546, 17.997380385957094, 12.430218951986506, 66.28548416728091, 22.306669226952213, -3.7414055397612156, 84.96942229588879, 14.258218512883102, 14.775752655405537, 23.613643654890264, 27.66974421453455, 12.839360005400653, 19.423883323763288, 17.730455134265434, 19.0014851816483, 13.467181812870496, 16.352731656874575, 16.87199552472753, 108.55826413293224, 14.613059622945954, 14.68441444193339, 15.731998368934413, 17.37685354420884, 24.163409934867314, 54.43009273777445, 36.43520958173033, -32.7478617126863, 66.01418936120082, 79.02894935784055, 57.44546110766359, 30.23967641456699, 10.086322971236124, 26.652819057293733, 14.387181135937116, 11.184018647359443, -7.646159134232108, 14.45816051642307, 21.534430834178167, 19.55780695944392, 18.254892935154036, 14.578533664969928, 16.375217831030206, 102.20634867528459, 14.783379589957265, 13.153772706533283, 0.10657740897179513, 54.209442231804054, 9.364364309108431, 22.012939220229093, 81.69525559873853, 18.086161565224025, 68.47307454559095, 85.59375293951858, 22.37995087936452, 18.63211280947101, 14.247068214589937, 113.88184257131452, -68.17749946489809, 19.894744659776435, 41.83903760331378, 50.603241385253654, 12.585054213522856, 22.703724426720413, 1.84032306566218, 17.433919220541974, 26.048938528739047, 14.222869250108905, 16.86336955331044, 17.783509880144454, 55.47032523297128, 20.690583185956754, 10.307748725918639, 16.952577765508984, 48.810743059463576, 20.60132526743948, 16.444119143575612, 26.42550111289354, 18.50856531905584, 11.751458064118006, 19.623835790518765, 97.65418142938286, 21.76748146494076, 21.415148601544306, 17.076679259646035, 21.35144181357021, 14.506846348830509, -51.05693637433642], "episode_lengths": [295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1093319295119644, "mean_inference_ms": 6.8213155372585526, "mean_action_processing_ms": 0.47081556884512693, "mean_env_wait_ms": 20.596959819645107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04438972473144531, "StateBufferConnector_ms": 0.028867244720458984, "ViewRequirementAgentConnector_ms": 0.8060271739959717}}, "episode_reward_max": 113.88184257131452, "episode_reward_min": -68.17749946489809, "episode_reward_mean": 26.37217782280986, "episode_len_mean": 623.8, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.899078333994373, 17.134257215398495, 18.796266056471495, 34.61965933228716, 54.9494100492209, 26.42229668412626, 24.206593756108024, 66.23106434300234, 28.465807968489056, 19.08291538936619, 41.34591738879345, -5.341893577500461, 15.323823268275511, 19.664521795783546, 17.997380385957094, 12.430218951986506, 66.28548416728091, 22.306669226952213, -3.7414055397612156, 84.96942229588879, 14.258218512883102, 14.775752655405537, 23.613643654890264, 27.66974421453455, 12.839360005400653, 19.423883323763288, 17.730455134265434, 19.0014851816483, 13.467181812870496, 16.352731656874575, 16.87199552472753, 108.55826413293224, 14.613059622945954, 14.68441444193339, 15.731998368934413, 17.37685354420884, 24.163409934867314, 54.43009273777445, 36.43520958173033, -32.7478617126863, 66.01418936120082, 79.02894935784055, 57.44546110766359, 30.23967641456699, 10.086322971236124, 26.652819057293733, 14.387181135937116, 11.184018647359443, -7.646159134232108, 14.45816051642307, 21.534430834178167, 19.55780695944392, 18.254892935154036, 14.578533664969928, 16.375217831030206, 102.20634867528459, 14.783379589957265, 13.153772706533283, 0.10657740897179513, 54.209442231804054, 9.364364309108431, 22.012939220229093, 81.69525559873853, 18.086161565224025, 68.47307454559095, 85.59375293951858, 22.37995087936452, 18.63211280947101, 14.247068214589937, 113.88184257131452, -68.17749946489809, 19.894744659776435, 41.83903760331378, 50.603241385253654, 12.585054213522856, 22.703724426720413, 1.84032306566218, 17.433919220541974, 26.048938528739047, 14.222869250108905, 16.86336955331044, 17.783509880144454, 55.47032523297128, 20.690583185956754, 10.307748725918639, 16.952577765508984, 48.810743059463576, 20.60132526743948, 16.444119143575612, 26.42550111289354, 18.50856531905584, 11.751458064118006, 19.623835790518765, 97.65418142938286, 21.76748146494076, 21.415148601544306, 17.076679259646035, 21.35144181357021, 14.506846348830509, -51.05693637433642], "episode_lengths": [295, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1093319295119644, "mean_inference_ms": 6.8213155372585526, "mean_action_processing_ms": 0.47081556884512693, "mean_env_wait_ms": 20.596959819645107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04438972473144531, "StateBufferConnector_ms": 0.028867244720458984, "ViewRequirementAgentConnector_ms": 0.8060271739959717}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 909681, "num_agent_steps_trained": 909681, "num_env_steps_sampled": 909681, "num_env_steps_trained": 909681, "num_env_steps_sampled_this_iter": 8240, "num_env_steps_trained_this_iter": 8240, "num_env_steps_sampled_throughput_per_sec": 185.7203834070571, "num_env_steps_trained_throughput_per_sec": 185.7203834070571, "timesteps_total": 909681, "num_steps_trained_this_iter": 8240, "agent_timesteps_total": 909681, "timers": {"training_iteration_time_ms": 44215.13, "sample_time_ms": 32535.319, "load_time_ms": 1141.433, "load_throughput": 7792.838, "learn_time_ms": 10042.49, "learn_throughput": 885.736, "synch_weights_time_ms": 431.8}, "counters": {"num_env_steps_sampled": 909681, "num_env_steps_trained": 909681, "num_agent_steps_sampled": 909681, "num_agent_steps_trained": 909681}, "done": false, "episodes_total": 1390, "training_iteration": 99, "trial_id": "32ccc_00000", "date": "2025-06-07_13-17-01", "timestamp": 1749295021, "time_this_iter_s": 44.38786339759827, "time_total_s": 4539.323459863663, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4539.323459863663, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 52.67777777777777, "ram_util_percent": 86.64074074074077, "gpu_util_percent0": 0.1633333333333333, "vram_util_percent0": 0.9650065104166664}}
{"evaluation": {"sampler_results": {"episode_reward_max": -2.5237121660599655, "episode_reward_min": -52.72176266227906, "episode_reward_mean": -18.232308576145947, "episode_len_mean": 107.8, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-52.72176266227906, -24.830929540308357, -6.800646721038001, -4.284491791044345, -2.5237121660599655], "episode_lengths": [184, 108, 85, 82, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6612343236702638, "mean_inference_ms": 3.6963009509910534, "mean_action_processing_ms": 0.2747483534607487, "mean_env_wait_ms": 11.386451131902856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020122528076171875, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4042625427246094}}, "episode_reward_max": -2.5237121660599655, "episode_reward_min": -52.72176266227906, "episode_reward_mean": -18.232308576145947, "episode_len_mean": 107.8, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-52.72176266227906, -24.830929540308357, -6.800646721038001, -4.284491791044345, -2.5237121660599655], "episode_lengths": [184, 108, 85, 82, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6612343236702638, "mean_inference_ms": 3.6963009509910534, "mean_action_processing_ms": 0.2747483534607487, "mean_env_wait_ms": 11.386451131902856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020122528076171875, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4042625427246094}, "num_agent_steps_sampled_this_iter": 539, "num_env_steps_sampled_this_iter": 539, "timesteps_this_iter": 539, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.090319000000002e-05, "total_loss": -0.07976475031048591, "policy_loss": -0.012771415592038206, "vf_loss": 0.06823430812518512, "vf_explained_var": 0.9298251892839159, "kl": 0.014459335675429818, "entropy": 16.375216078077045, "entropy_coeff": 0.005451595000000001}, "model": {}, "num_grad_updates_lifetime": 32225.5, "diff_num_grad_updates_vs_sampler_policy": 174.5}}, "num_env_steps_sampled": 919565, "num_env_steps_trained": 919565, "num_agent_steps_sampled": 919565, "num_agent_steps_trained": 919565}, "sampler_results": {"episode_reward_max": 115.67648916808317, "episode_reward_min": -68.17749946489809, "episode_reward_mean": 28.096257734484308, "episode_len_mean": 632.02, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.997380385957094, 12.430218951986506, 66.28548416728091, 22.306669226952213, -3.7414055397612156, 84.96942229588879, 14.258218512883102, 14.775752655405537, 23.613643654890264, 27.66974421453455, 12.839360005400653, 19.423883323763288, 17.730455134265434, 19.0014851816483, 13.467181812870496, 16.352731656874575, 16.87199552472753, 108.55826413293224, 14.613059622945954, 14.68441444193339, 15.731998368934413, 17.37685354420884, 24.163409934867314, 54.43009273777445, 36.43520958173033, -32.7478617126863, 66.01418936120082, 79.02894935784055, 57.44546110766359, 30.23967641456699, 10.086322971236124, 26.652819057293733, 14.387181135937116, 11.184018647359443, -7.646159134232108, 14.45816051642307, 21.534430834178167, 19.55780695944392, 18.254892935154036, 14.578533664969928, 16.375217831030206, 102.20634867528459, 14.783379589957265, 13.153772706533283, 0.10657740897179513, 54.209442231804054, 9.364364309108431, 22.012939220229093, 81.69525559873853, 18.086161565224025, 68.47307454559095, 85.59375293951858, 22.37995087936452, 18.63211280947101, 14.247068214589937, 113.88184257131452, -68.17749946489809, 19.894744659776435, 41.83903760331378, 50.603241385253654, 12.585054213522856, 22.703724426720413, 1.84032306566218, 17.433919220541974, 26.048938528739047, 14.222869250108905, 16.86336955331044, 17.783509880144454, 55.47032523297128, 20.690583185956754, 10.307748725918639, 16.952577765508984, 48.810743059463576, 20.60132526743948, 16.444119143575612, 26.42550111289354, 18.50856531905584, 11.751458064118006, 19.623835790518765, 97.65418142938286, 21.76748146494076, 21.415148601544306, 17.076679259646035, 21.35144181357021, 14.506846348830509, -51.05693637433642, 7.728973416409907, 115.67648916808317, 84.00496967056866, 60.309248986261174, 16.31481749303626, 88.04953140231052, 69.04927409980252, 43.5832981913662, 15.612229488522225, 20.56758593256541, -28.95656011981679, 16.979940303625767, 18.887237894244564, 19.400673244281418], "episode_lengths": [295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1109516407443594, "mean_inference_ms": 6.823670881834988, "mean_action_processing_ms": 0.4711030415308876, "mean_env_wait_ms": 20.6009804482431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03536653518676758, "StateBufferConnector_ms": 0.027356863021850586, "ViewRequirementAgentConnector_ms": 0.7935073375701904}}, "episode_reward_max": 115.67648916808317, "episode_reward_min": -68.17749946489809, "episode_reward_mean": 28.096257734484308, "episode_len_mean": 632.02, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.997380385957094, 12.430218951986506, 66.28548416728091, 22.306669226952213, -3.7414055397612156, 84.96942229588879, 14.258218512883102, 14.775752655405537, 23.613643654890264, 27.66974421453455, 12.839360005400653, 19.423883323763288, 17.730455134265434, 19.0014851816483, 13.467181812870496, 16.352731656874575, 16.87199552472753, 108.55826413293224, 14.613059622945954, 14.68441444193339, 15.731998368934413, 17.37685354420884, 24.163409934867314, 54.43009273777445, 36.43520958173033, -32.7478617126863, 66.01418936120082, 79.02894935784055, 57.44546110766359, 30.23967641456699, 10.086322971236124, 26.652819057293733, 14.387181135937116, 11.184018647359443, -7.646159134232108, 14.45816051642307, 21.534430834178167, 19.55780695944392, 18.254892935154036, 14.578533664969928, 16.375217831030206, 102.20634867528459, 14.783379589957265, 13.153772706533283, 0.10657740897179513, 54.209442231804054, 9.364364309108431, 22.012939220229093, 81.69525559873853, 18.086161565224025, 68.47307454559095, 85.59375293951858, 22.37995087936452, 18.63211280947101, 14.247068214589937, 113.88184257131452, -68.17749946489809, 19.894744659776435, 41.83903760331378, 50.603241385253654, 12.585054213522856, 22.703724426720413, 1.84032306566218, 17.433919220541974, 26.048938528739047, 14.222869250108905, 16.86336955331044, 17.783509880144454, 55.47032523297128, 20.690583185956754, 10.307748725918639, 16.952577765508984, 48.810743059463576, 20.60132526743948, 16.444119143575612, 26.42550111289354, 18.50856531905584, 11.751458064118006, 19.623835790518765, 97.65418142938286, 21.76748146494076, 21.415148601544306, 17.076679259646035, 21.35144181357021, 14.506846348830509, -51.05693637433642, 7.728973416409907, 115.67648916808317, 84.00496967056866, 60.309248986261174, 16.31481749303626, 88.04953140231052, 69.04927409980252, 43.5832981913662, 15.612229488522225, 20.56758593256541, -28.95656011981679, 16.979940303625767, 18.887237894244564, 19.400673244281418], "episode_lengths": [295, 295, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1109516407443594, "mean_inference_ms": 6.823670881834988, "mean_action_processing_ms": 0.4711030415308876, "mean_env_wait_ms": 20.6009804482431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03536653518676758, "StateBufferConnector_ms": 0.027356863021850586, "ViewRequirementAgentConnector_ms": 0.7935073375701904}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 919565, "num_agent_steps_trained": 919565, "num_env_steps_sampled": 919565, "num_env_steps_trained": 919565, "num_env_steps_sampled_this_iter": 9884, "num_env_steps_trained_this_iter": 9884, "num_env_steps_sampled_throughput_per_sec": 206.87010399029327, "num_env_steps_trained_throughput_per_sec": 206.87010399029327, "timesteps_total": 919565, "num_steps_trained_this_iter": 9884, "agent_timesteps_total": 919565, "timers": {"training_iteration_time_ms": 45141.235, "sample_time_ms": 32729.908, "load_time_ms": 1188.616, "load_throughput": 7693.148, "learn_time_ms": 10730.214, "learn_throughput": 852.192, "synch_weights_time_ms": 426.715}, "counters": {"num_env_steps_sampled": 919565, "num_env_steps_trained": 919565, "num_agent_steps_sampled": 919565, "num_agent_steps_trained": 919565}, "done": false, "episodes_total": 1404, "training_iteration": 100, "trial_id": "32ccc_00000", "date": "2025-06-07_13-17-59", "timestamp": 1749295079, "time_this_iter_s": 58.04268527030945, "time_total_s": 4597.366145133972, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4597.366145133972, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 51.23000000000001, "ram_util_percent": 87.58, "gpu_util_percent0": 0.1367142857142857, "vram_util_percent0": 0.965006510416667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.080434999999999e-05, "total_loss": -0.09865653813375454, "policy_loss": -0.027256501324805678, "vf_loss": 0.05227496645315305, "vf_explained_var": 0.9296025784392106, "kl": 0.013241568081751833, "entropy": 16.426295970615588, "entropy_coeff": 0.005402175}, "model": {}, "num_grad_updates_lifetime": 32590.5, "diff_num_grad_updates_vs_sampler_policy": 189.5}}, "num_env_steps_sampled": 930271, "num_env_steps_trained": 930271, "num_agent_steps_sampled": 930271, "num_agent_steps_trained": 930271}, "sampler_results": {"episode_reward_max": 115.67648916808317, "episode_reward_min": -68.17749946489809, "episode_reward_mean": 30.15832465743785, "episode_len_mean": 664.9, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.467181812870496, 16.352731656874575, 16.87199552472753, 108.55826413293224, 14.613059622945954, 14.68441444193339, 15.731998368934413, 17.37685354420884, 24.163409934867314, 54.43009273777445, 36.43520958173033, -32.7478617126863, 66.01418936120082, 79.02894935784055, 57.44546110766359, 30.23967641456699, 10.086322971236124, 26.652819057293733, 14.387181135937116, 11.184018647359443, -7.646159134232108, 14.45816051642307, 21.534430834178167, 19.55780695944392, 18.254892935154036, 14.578533664969928, 16.375217831030206, 102.20634867528459, 14.783379589957265, 13.153772706533283, 0.10657740897179513, 54.209442231804054, 9.364364309108431, 22.012939220229093, 81.69525559873853, 18.086161565224025, 68.47307454559095, 85.59375293951858, 22.37995087936452, 18.63211280947101, 14.247068214589937, 113.88184257131452, -68.17749946489809, 19.894744659776435, 41.83903760331378, 50.603241385253654, 12.585054213522856, 22.703724426720413, 1.84032306566218, 17.433919220541974, 26.048938528739047, 14.222869250108905, 16.86336955331044, 17.783509880144454, 55.47032523297128, 20.690583185956754, 10.307748725918639, 16.952577765508984, 48.810743059463576, 20.60132526743948, 16.444119143575612, 26.42550111289354, 18.50856531905584, 11.751458064118006, 19.623835790518765, 97.65418142938286, 21.76748146494076, 21.415148601544306, 17.076679259646035, 21.35144181357021, 14.506846348830509, -51.05693637433642, 7.728973416409907, 115.67648916808317, 84.00496967056866, 60.309248986261174, 16.31481749303626, 88.04953140231052, 69.04927409980252, 43.5832981913662, 15.612229488522225, 20.56758593256541, -28.95656011981679, 16.979940303625767, 18.887237894244564, 19.400673244281418, 84.9566694876425, 16.821353987699002, 42.56355629989586, 20.893004243109157, 15.921883527968461, 59.098979516331404, 37.611681857989936, 19.061083583578636, -9.189464112737914, 105.53760875483948, 31.970113737587123, 96.79756528949805, 16.51009787174794, 17.212870421299844], "episode_lengths": [295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.112498914225876, "mean_inference_ms": 6.8259864881531, "mean_action_processing_ms": 0.471338935613238, "mean_env_wait_ms": 20.60527525307387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03083014488220215, "StateBufferConnector_ms": 0.030365467071533203, "ViewRequirementAgentConnector_ms": 0.7835516929626465}}, "episode_reward_max": 115.67648916808317, "episode_reward_min": -68.17749946489809, "episode_reward_mean": 30.15832465743785, "episode_len_mean": 664.9, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.467181812870496, 16.352731656874575, 16.87199552472753, 108.55826413293224, 14.613059622945954, 14.68441444193339, 15.731998368934413, 17.37685354420884, 24.163409934867314, 54.43009273777445, 36.43520958173033, -32.7478617126863, 66.01418936120082, 79.02894935784055, 57.44546110766359, 30.23967641456699, 10.086322971236124, 26.652819057293733, 14.387181135937116, 11.184018647359443, -7.646159134232108, 14.45816051642307, 21.534430834178167, 19.55780695944392, 18.254892935154036, 14.578533664969928, 16.375217831030206, 102.20634867528459, 14.783379589957265, 13.153772706533283, 0.10657740897179513, 54.209442231804054, 9.364364309108431, 22.012939220229093, 81.69525559873853, 18.086161565224025, 68.47307454559095, 85.59375293951858, 22.37995087936452, 18.63211280947101, 14.247068214589937, 113.88184257131452, -68.17749946489809, 19.894744659776435, 41.83903760331378, 50.603241385253654, 12.585054213522856, 22.703724426720413, 1.84032306566218, 17.433919220541974, 26.048938528739047, 14.222869250108905, 16.86336955331044, 17.783509880144454, 55.47032523297128, 20.690583185956754, 10.307748725918639, 16.952577765508984, 48.810743059463576, 20.60132526743948, 16.444119143575612, 26.42550111289354, 18.50856531905584, 11.751458064118006, 19.623835790518765, 97.65418142938286, 21.76748146494076, 21.415148601544306, 17.076679259646035, 21.35144181357021, 14.506846348830509, -51.05693637433642, 7.728973416409907, 115.67648916808317, 84.00496967056866, 60.309248986261174, 16.31481749303626, 88.04953140231052, 69.04927409980252, 43.5832981913662, 15.612229488522225, 20.56758593256541, -28.95656011981679, 16.979940303625767, 18.887237894244564, 19.400673244281418, 84.9566694876425, 16.821353987699002, 42.56355629989586, 20.893004243109157, 15.921883527968461, 59.098979516331404, 37.611681857989936, 19.061083583578636, -9.189464112737914, 105.53760875483948, 31.970113737587123, 96.79756528949805, 16.51009787174794, 17.212870421299844], "episode_lengths": [295, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.112498914225876, "mean_inference_ms": 6.8259864881531, "mean_action_processing_ms": 0.471338935613238, "mean_env_wait_ms": 20.60527525307387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03083014488220215, "StateBufferConnector_ms": 0.030365467071533203, "ViewRequirementAgentConnector_ms": 0.7835516929626465}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 930271, "num_agent_steps_trained": 930271, "num_env_steps_sampled": 930271, "num_env_steps_trained": 930271, "num_env_steps_sampled_this_iter": 10706, "num_env_steps_trained_this_iter": 10706, "num_env_steps_sampled_throughput_per_sec": 208.145935956481, "num_env_steps_trained_throughput_per_sec": 208.145935956481, "timesteps_total": 930271, "num_steps_trained_this_iter": 10706, "agent_timesteps_total": 930271, "timers": {"training_iteration_time_ms": 44816.81, "sample_time_ms": 32444.426, "load_time_ms": 1170.07, "load_throughput": 7674.586, "learn_time_ms": 10709.75, "learn_throughput": 838.47, "synch_weights_time_ms": 427.071}, "counters": {"num_env_steps_sampled": 930271, "num_env_steps_trained": 930271, "num_agent_steps_sampled": 930271, "num_agent_steps_trained": 930271}, "done": false, "episodes_total": 1418, "training_iteration": 101, "trial_id": "32ccc_00000", "date": "2025-06-07_13-18-51", "timestamp": 1749295131, "time_this_iter_s": 51.451021671295166, "time_total_s": 4648.817166805267, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4648.817166805267, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 57.64032258064517, "ram_util_percent": 88.09354838709675, "gpu_util_percent0": 0.19564516129032256, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.069729e-05, "total_loss": -0.09418269893159793, "policy_loss": -0.02343034050176026, "vf_loss": 0.05322979229333048, "vf_explained_var": 0.8671699878844348, "kl": 0.014155063543482527, "entropy": 16.544504007426177, "entropy_coeff": 0.005348644999999999}, "model": {}, "num_grad_updates_lifetime": 33000.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 942621, "num_env_steps_trained": 942621, "num_agent_steps_sampled": 942621, "num_agent_steps_trained": 942621}, "sampler_results": {"episode_reward_max": 115.67648916808317, "episode_reward_min": -68.17749946489809, "episode_reward_mean": 31.40416266403659, "episode_len_mean": 697.78, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.44546110766359, 30.23967641456699, 10.086322971236124, 26.652819057293733, 14.387181135937116, 11.184018647359443, -7.646159134232108, 14.45816051642307, 21.534430834178167, 19.55780695944392, 18.254892935154036, 14.578533664969928, 16.375217831030206, 102.20634867528459, 14.783379589957265, 13.153772706533283, 0.10657740897179513, 54.209442231804054, 9.364364309108431, 22.012939220229093, 81.69525559873853, 18.086161565224025, 68.47307454559095, 85.59375293951858, 22.37995087936452, 18.63211280947101, 14.247068214589937, 113.88184257131452, -68.17749946489809, 19.894744659776435, 41.83903760331378, 50.603241385253654, 12.585054213522856, 22.703724426720413, 1.84032306566218, 17.433919220541974, 26.048938528739047, 14.222869250108905, 16.86336955331044, 17.783509880144454, 55.47032523297128, 20.690583185956754, 10.307748725918639, 16.952577765508984, 48.810743059463576, 20.60132526743948, 16.444119143575612, 26.42550111289354, 18.50856531905584, 11.751458064118006, 19.623835790518765, 97.65418142938286, 21.76748146494076, 21.415148601544306, 17.076679259646035, 21.35144181357021, 14.506846348830509, -51.05693637433642, 7.728973416409907, 115.67648916808317, 84.00496967056866, 60.309248986261174, 16.31481749303626, 88.04953140231052, 69.04927409980252, 43.5832981913662, 15.612229488522225, 20.56758593256541, -28.95656011981679, 16.979940303625767, 18.887237894244564, 19.400673244281418, 84.9566694876425, 16.821353987699002, 42.56355629989586, 20.893004243109157, 15.921883527968461, 59.098979516331404, 37.611681857989936, 19.061083583578636, -9.189464112737914, 105.53760875483948, 31.970113737587123, 96.79756528949805, 16.51009787174794, 17.212870421299844, 64.74540727731163, 69.54333039867744, 14.111637225137379, 22.05114007420082, 18.12158853620565, 42.93753470603384, 41.698733662206344, 11.148114447354002, 64.33260107866852, 21.550378970779605, 10.663431095621172, 57.72247825276396, 25.134596801822905, 105.80331649924564], "episode_lengths": [1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1143442397458863, "mean_inference_ms": 6.828784150522696, "mean_action_processing_ms": 0.4715924193023616, "mean_env_wait_ms": 20.610194171928985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02877664566040039, "StateBufferConnector_ms": 0.022450685501098633, "ViewRequirementAgentConnector_ms": 0.7914042472839355}}, "episode_reward_max": 115.67648916808317, "episode_reward_min": -68.17749946489809, "episode_reward_mean": 31.40416266403659, "episode_len_mean": 697.78, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [57.44546110766359, 30.23967641456699, 10.086322971236124, 26.652819057293733, 14.387181135937116, 11.184018647359443, -7.646159134232108, 14.45816051642307, 21.534430834178167, 19.55780695944392, 18.254892935154036, 14.578533664969928, 16.375217831030206, 102.20634867528459, 14.783379589957265, 13.153772706533283, 0.10657740897179513, 54.209442231804054, 9.364364309108431, 22.012939220229093, 81.69525559873853, 18.086161565224025, 68.47307454559095, 85.59375293951858, 22.37995087936452, 18.63211280947101, 14.247068214589937, 113.88184257131452, -68.17749946489809, 19.894744659776435, 41.83903760331378, 50.603241385253654, 12.585054213522856, 22.703724426720413, 1.84032306566218, 17.433919220541974, 26.048938528739047, 14.222869250108905, 16.86336955331044, 17.783509880144454, 55.47032523297128, 20.690583185956754, 10.307748725918639, 16.952577765508984, 48.810743059463576, 20.60132526743948, 16.444119143575612, 26.42550111289354, 18.50856531905584, 11.751458064118006, 19.623835790518765, 97.65418142938286, 21.76748146494076, 21.415148601544306, 17.076679259646035, 21.35144181357021, 14.506846348830509, -51.05693637433642, 7.728973416409907, 115.67648916808317, 84.00496967056866, 60.309248986261174, 16.31481749303626, 88.04953140231052, 69.04927409980252, 43.5832981913662, 15.612229488522225, 20.56758593256541, -28.95656011981679, 16.979940303625767, 18.887237894244564, 19.400673244281418, 84.9566694876425, 16.821353987699002, 42.56355629989586, 20.893004243109157, 15.921883527968461, 59.098979516331404, 37.611681857989936, 19.061083583578636, -9.189464112737914, 105.53760875483948, 31.970113737587123, 96.79756528949805, 16.51009787174794, 17.212870421299844, 64.74540727731163, 69.54333039867744, 14.111637225137379, 22.05114007420082, 18.12158853620565, 42.93753470603384, 41.698733662206344, 11.148114447354002, 64.33260107866852, 21.550378970779605, 10.663431095621172, 57.72247825276396, 25.134596801822905, 105.80331649924564], "episode_lengths": [1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1143442397458863, "mean_inference_ms": 6.828784150522696, "mean_action_processing_ms": 0.4715924193023616, "mean_env_wait_ms": 20.610194171928985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02877664566040039, "StateBufferConnector_ms": 0.022450685501098633, "ViewRequirementAgentConnector_ms": 0.7914042472839355}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 942621, "num_agent_steps_trained": 942621, "num_env_steps_sampled": 942621, "num_env_steps_trained": 942621, "num_env_steps_sampled_this_iter": 12350, "num_env_steps_trained_this_iter": 12350, "num_env_steps_sampled_throughput_per_sec": 223.9628438493569, "num_env_steps_trained_throughput_per_sec": 223.9628438493569, "timesteps_total": 942621, "num_steps_trained_this_iter": 12350, "agent_timesteps_total": 942621, "timers": {"training_iteration_time_ms": 46548.928, "sample_time_ms": 33073.831, "load_time_ms": 1241.693, "load_throughput": 7629.1, "learn_time_ms": 11735.493, "learn_throughput": 807.209, "synch_weights_time_ms": 428.537}, "counters": {"num_env_steps_sampled": 942621, "num_env_steps_trained": 942621, "num_agent_steps_sampled": 942621, "num_agent_steps_trained": 942621}, "done": false, "episodes_total": 1432, "training_iteration": 102, "trial_id": "32ccc_00000", "date": "2025-06-07_13-19-46", "timestamp": 1749295186, "time_this_iter_s": 55.15511989593506, "time_total_s": 4703.972286701202, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4703.972286701202, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 63.516923076923085, "ram_util_percent": 87.92615384615382, "gpu_util_percent0": 0.1815384615384615, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.057379e-05, "total_loss": -0.06816910677057292, "policy_loss": 0.0014813522801601462, "vf_loss": 0.056069525360528914, "vf_explained_var": 0.9430274973596845, "kl": 0.014403650465792197, "entropy": 16.696335032326836, "entropy_coeff": 0.005286895}, "model": {}, "num_grad_updates_lifetime": 33395.5, "diff_num_grad_updates_vs_sampler_policy": 174.5}}, "num_env_steps_sampled": 952505, "num_env_steps_trained": 952505, "num_agent_steps_sampled": 952505, "num_agent_steps_trained": 952505}, "sampler_results": {"episode_reward_max": 115.67648916808317, "episode_reward_min": -68.17749946489809, "episode_reward_mean": 32.904305003078925, "episode_len_mean": 714.22, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.783379589957265, 13.153772706533283, 0.10657740897179513, 54.209442231804054, 9.364364309108431, 22.012939220229093, 81.69525559873853, 18.086161565224025, 68.47307454559095, 85.59375293951858, 22.37995087936452, 18.63211280947101, 14.247068214589937, 113.88184257131452, -68.17749946489809, 19.894744659776435, 41.83903760331378, 50.603241385253654, 12.585054213522856, 22.703724426720413, 1.84032306566218, 17.433919220541974, 26.048938528739047, 14.222869250108905, 16.86336955331044, 17.783509880144454, 55.47032523297128, 20.690583185956754, 10.307748725918639, 16.952577765508984, 48.810743059463576, 20.60132526743948, 16.444119143575612, 26.42550111289354, 18.50856531905584, 11.751458064118006, 19.623835790518765, 97.65418142938286, 21.76748146494076, 21.415148601544306, 17.076679259646035, 21.35144181357021, 14.506846348830509, -51.05693637433642, 7.728973416409907, 115.67648916808317, 84.00496967056866, 60.309248986261174, 16.31481749303626, 88.04953140231052, 69.04927409980252, 43.5832981913662, 15.612229488522225, 20.56758593256541, -28.95656011981679, 16.979940303625767, 18.887237894244564, 19.400673244281418, 84.9566694876425, 16.821353987699002, 42.56355629989586, 20.893004243109157, 15.921883527968461, 59.098979516331404, 37.611681857989936, 19.061083583578636, -9.189464112737914, 105.53760875483948, 31.970113737587123, 96.79756528949805, 16.51009787174794, 17.212870421299844, 64.74540727731163, 69.54333039867744, 14.111637225137379, 22.05114007420082, 18.12158853620565, 42.93753470603384, 41.698733662206344, 11.148114447354002, 64.33260107866852, 21.550378970779605, 10.663431095621172, 57.72247825276396, 25.134596801822905, 105.80331649924564, 17.147384164493467, 25.560729994321395, 60.41115093470389, 24.99314495465695, -0.47317394861202955, 14.011654945547228, 31.93513228954466, 22.28730624668808, 69.10915148970126, 14.114646260772798, 84.66540725606129, 37.70058570296913, 14.86627861843817, 82.99954661125633], "episode_lengths": [295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.116056231154044, "mean_inference_ms": 6.8316552662941055, "mean_action_processing_ms": 0.4718011706458068, "mean_env_wait_ms": 20.615510996816642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029795408248901367, "StateBufferConnector_ms": 0.021262168884277344, "ViewRequirementAgentConnector_ms": 0.765049934387207}}, "episode_reward_max": 115.67648916808317, "episode_reward_min": -68.17749946489809, "episode_reward_mean": 32.904305003078925, "episode_len_mean": 714.22, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.783379589957265, 13.153772706533283, 0.10657740897179513, 54.209442231804054, 9.364364309108431, 22.012939220229093, 81.69525559873853, 18.086161565224025, 68.47307454559095, 85.59375293951858, 22.37995087936452, 18.63211280947101, 14.247068214589937, 113.88184257131452, -68.17749946489809, 19.894744659776435, 41.83903760331378, 50.603241385253654, 12.585054213522856, 22.703724426720413, 1.84032306566218, 17.433919220541974, 26.048938528739047, 14.222869250108905, 16.86336955331044, 17.783509880144454, 55.47032523297128, 20.690583185956754, 10.307748725918639, 16.952577765508984, 48.810743059463576, 20.60132526743948, 16.444119143575612, 26.42550111289354, 18.50856531905584, 11.751458064118006, 19.623835790518765, 97.65418142938286, 21.76748146494076, 21.415148601544306, 17.076679259646035, 21.35144181357021, 14.506846348830509, -51.05693637433642, 7.728973416409907, 115.67648916808317, 84.00496967056866, 60.309248986261174, 16.31481749303626, 88.04953140231052, 69.04927409980252, 43.5832981913662, 15.612229488522225, 20.56758593256541, -28.95656011981679, 16.979940303625767, 18.887237894244564, 19.400673244281418, 84.9566694876425, 16.821353987699002, 42.56355629989586, 20.893004243109157, 15.921883527968461, 59.098979516331404, 37.611681857989936, 19.061083583578636, -9.189464112737914, 105.53760875483948, 31.970113737587123, 96.79756528949805, 16.51009787174794, 17.212870421299844, 64.74540727731163, 69.54333039867744, 14.111637225137379, 22.05114007420082, 18.12158853620565, 42.93753470603384, 41.698733662206344, 11.148114447354002, 64.33260107866852, 21.550378970779605, 10.663431095621172, 57.72247825276396, 25.134596801822905, 105.80331649924564, 17.147384164493467, 25.560729994321395, 60.41115093470389, 24.99314495465695, -0.47317394861202955, 14.011654945547228, 31.93513228954466, 22.28730624668808, 69.10915148970126, 14.114646260772798, 84.66540725606129, 37.70058570296913, 14.86627861843817, 82.99954661125633], "episode_lengths": [295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.116056231154044, "mean_inference_ms": 6.8316552662941055, "mean_action_processing_ms": 0.4718011706458068, "mean_env_wait_ms": 20.615510996816642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029795408248901367, "StateBufferConnector_ms": 0.021262168884277344, "ViewRequirementAgentConnector_ms": 0.765049934387207}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 952505, "num_agent_steps_trained": 952505, "num_env_steps_sampled": 952505, "num_env_steps_trained": 952505, "num_env_steps_sampled_this_iter": 9884, "num_env_steps_trained_this_iter": 9884, "num_env_steps_sampled_throughput_per_sec": 201.76540423703983, "num_env_steps_trained_throughput_per_sec": 201.76540423703983, "timesteps_total": 952505, "num_steps_trained_this_iter": 9884, "agent_timesteps_total": 952505, "timers": {"training_iteration_time_ms": 46726.353, "sample_time_ms": 33104.288, "load_time_ms": 1255.078, "load_throughput": 7613.23, "learn_time_ms": 11866.12, "learn_throughput": 805.251, "synch_weights_time_ms": 430.884}, "counters": {"num_env_steps_sampled": 952505, "num_env_steps_trained": 952505, "num_agent_steps_sampled": 952505, "num_agent_steps_trained": 952505}, "done": false, "episodes_total": 1446, "training_iteration": 103, "trial_id": "32ccc_00000", "date": "2025-06-07_13-20-35", "timestamp": 1749295235, "time_this_iter_s": 49.0613374710083, "time_total_s": 4753.033624172211, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4753.033624172211, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 55.516949152542374, "ram_util_percent": 87.03050847457627, "gpu_util_percent0": 0.17661016949152544, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.047495e-05, "total_loss": -0.08904364346393517, "policy_loss": -0.021369165810091156, "vf_loss": 0.05526364981595959, "vf_explained_var": 0.9446822610923222, "kl": 0.01509786258236105, "entropy": 16.447010244641984, "entropy_coeff": 0.005237474999999999}, "model": {}, "num_grad_updates_lifetime": 33745.5, "diff_num_grad_updates_vs_sampler_policy": 174.5}}, "num_env_steps_sampled": 962389, "num_env_steps_trained": 962389, "num_agent_steps_sampled": 962389, "num_agent_steps_trained": 962389}, "sampler_results": {"episode_reward_max": 143.2183005862588, "episode_reward_min": -68.17749946489809, "episode_reward_mean": 34.4659442705028, "episode_len_mean": 706.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-68.17749946489809, 19.894744659776435, 41.83903760331378, 50.603241385253654, 12.585054213522856, 22.703724426720413, 1.84032306566218, 17.433919220541974, 26.048938528739047, 14.222869250108905, 16.86336955331044, 17.783509880144454, 55.47032523297128, 20.690583185956754, 10.307748725918639, 16.952577765508984, 48.810743059463576, 20.60132526743948, 16.444119143575612, 26.42550111289354, 18.50856531905584, 11.751458064118006, 19.623835790518765, 97.65418142938286, 21.76748146494076, 21.415148601544306, 17.076679259646035, 21.35144181357021, 14.506846348830509, -51.05693637433642, 7.728973416409907, 115.67648916808317, 84.00496967056866, 60.309248986261174, 16.31481749303626, 88.04953140231052, 69.04927409980252, 43.5832981913662, 15.612229488522225, 20.56758593256541, -28.95656011981679, 16.979940303625767, 18.887237894244564, 19.400673244281418, 84.9566694876425, 16.821353987699002, 42.56355629989586, 20.893004243109157, 15.921883527968461, 59.098979516331404, 37.611681857989936, 19.061083583578636, -9.189464112737914, 105.53760875483948, 31.970113737587123, 96.79756528949805, 16.51009787174794, 17.212870421299844, 64.74540727731163, 69.54333039867744, 14.111637225137379, 22.05114007420082, 18.12158853620565, 42.93753470603384, 41.698733662206344, 11.148114447354002, 64.33260107866852, 21.550378970779605, 10.663431095621172, 57.72247825276396, 25.134596801822905, 105.80331649924564, 17.147384164493467, 25.560729994321395, 60.41115093470389, 24.99314495465695, -0.47317394861202955, 14.011654945547228, 31.93513228954466, 22.28730624668808, 69.10915148970126, 14.114646260772798, 84.66540725606129, 37.70058570296913, 14.86627861843817, 82.99954661125633, 65.23088997335292, 143.2183005862588, 17.665384107812926, 21.292077044970327, 18.54868152073618, 31.232629300241467, 63.76388608245177, 17.690953596651873, 21.65844033530168, 112.30598824724814, 51.61019113039676, 19.524972583779146, 93.78419580048451, 15.257031023116642], "episode_lengths": [1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1175055739875988, "mean_inference_ms": 6.833906244864894, "mean_action_processing_ms": 0.47196959720167164, "mean_env_wait_ms": 20.61958413047653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028823375701904297, "StateBufferConnector_ms": 0.01979804039001465, "ViewRequirementAgentConnector_ms": 0.7644710540771484}}, "episode_reward_max": 143.2183005862588, "episode_reward_min": -68.17749946489809, "episode_reward_mean": 34.4659442705028, "episode_len_mean": 706.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-68.17749946489809, 19.894744659776435, 41.83903760331378, 50.603241385253654, 12.585054213522856, 22.703724426720413, 1.84032306566218, 17.433919220541974, 26.048938528739047, 14.222869250108905, 16.86336955331044, 17.783509880144454, 55.47032523297128, 20.690583185956754, 10.307748725918639, 16.952577765508984, 48.810743059463576, 20.60132526743948, 16.444119143575612, 26.42550111289354, 18.50856531905584, 11.751458064118006, 19.623835790518765, 97.65418142938286, 21.76748146494076, 21.415148601544306, 17.076679259646035, 21.35144181357021, 14.506846348830509, -51.05693637433642, 7.728973416409907, 115.67648916808317, 84.00496967056866, 60.309248986261174, 16.31481749303626, 88.04953140231052, 69.04927409980252, 43.5832981913662, 15.612229488522225, 20.56758593256541, -28.95656011981679, 16.979940303625767, 18.887237894244564, 19.400673244281418, 84.9566694876425, 16.821353987699002, 42.56355629989586, 20.893004243109157, 15.921883527968461, 59.098979516331404, 37.611681857989936, 19.061083583578636, -9.189464112737914, 105.53760875483948, 31.970113737587123, 96.79756528949805, 16.51009787174794, 17.212870421299844, 64.74540727731163, 69.54333039867744, 14.111637225137379, 22.05114007420082, 18.12158853620565, 42.93753470603384, 41.698733662206344, 11.148114447354002, 64.33260107866852, 21.550378970779605, 10.663431095621172, 57.72247825276396, 25.134596801822905, 105.80331649924564, 17.147384164493467, 25.560729994321395, 60.41115093470389, 24.99314495465695, -0.47317394861202955, 14.011654945547228, 31.93513228954466, 22.28730624668808, 69.10915148970126, 14.114646260772798, 84.66540725606129, 37.70058570296913, 14.86627861843817, 82.99954661125633, 65.23088997335292, 143.2183005862588, 17.665384107812926, 21.292077044970327, 18.54868152073618, 31.232629300241467, 63.76388608245177, 17.690953596651873, 21.65844033530168, 112.30598824724814, 51.61019113039676, 19.524972583779146, 93.78419580048451, 15.257031023116642], "episode_lengths": [1117, 295, 1117, 1117, 295, 295, 1117, 295, 295, 295, 295, 295, 1117, 295, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1175055739875988, "mean_inference_ms": 6.833906244864894, "mean_action_processing_ms": 0.47196959720167164, "mean_env_wait_ms": 20.61958413047653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028823375701904297, "StateBufferConnector_ms": 0.01979804039001465, "ViewRequirementAgentConnector_ms": 0.7644710540771484}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 962389, "num_agent_steps_trained": 962389, "num_env_steps_sampled": 962389, "num_env_steps_trained": 962389, "num_env_steps_sampled_this_iter": 9884, "num_env_steps_trained_this_iter": 9884, "num_env_steps_sampled_throughput_per_sec": 199.42779852736356, "num_env_steps_trained_throughput_per_sec": 199.42779852736356, "timesteps_total": 962389, "num_steps_trained_this_iter": 9884, "agent_timesteps_total": 962389, "timers": {"training_iteration_time_ms": 47943.698, "sample_time_ms": 33415.027, "load_time_ms": 1302.189, "load_throughput": 7527.173, "learn_time_ms": 12718.779, "learn_throughput": 770.656, "synch_weights_time_ms": 436.17}, "counters": {"num_env_steps_sampled": 962389, "num_env_steps_trained": 962389, "num_agent_steps_sampled": 962389, "num_agent_steps_trained": 962389}, "done": false, "episodes_total": 1460, "training_iteration": 104, "trial_id": "32ccc_00000", "date": "2025-06-07_13-21-25", "timestamp": 1749295285, "time_this_iter_s": 49.581796169281006, "time_total_s": 4802.615420341492, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4802.615420341492, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 55.82203389830509, "ram_util_percent": 86.11864406779664, "gpu_util_percent0": 0.18271186440677967, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.037611e-05, "total_loss": -0.09359927414348576, "policy_loss": -0.025094285079600324, "vf_loss": 0.04241847084358153, "vf_explained_var": 0.8713401208563549, "kl": 0.015057990704980513, "entropy": 16.02002693734518, "entropy_coeff": 0.005188054999999999}, "model": {}, "num_grad_updates_lifetime": 34125.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 973917, "num_env_steps_trained": 973917, "num_agent_steps_sampled": 973917, "num_agent_steps_trained": 973917}, "sampler_results": {"episode_reward_max": 143.2183005862588, "episode_reward_min": -51.05693637433642, "episode_reward_mean": 39.91047658204374, "episode_len_mean": 738.88, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.307748725918639, 16.952577765508984, 48.810743059463576, 20.60132526743948, 16.444119143575612, 26.42550111289354, 18.50856531905584, 11.751458064118006, 19.623835790518765, 97.65418142938286, 21.76748146494076, 21.415148601544306, 17.076679259646035, 21.35144181357021, 14.506846348830509, -51.05693637433642, 7.728973416409907, 115.67648916808317, 84.00496967056866, 60.309248986261174, 16.31481749303626, 88.04953140231052, 69.04927409980252, 43.5832981913662, 15.612229488522225, 20.56758593256541, -28.95656011981679, 16.979940303625767, 18.887237894244564, 19.400673244281418, 84.9566694876425, 16.821353987699002, 42.56355629989586, 20.893004243109157, 15.921883527968461, 59.098979516331404, 37.611681857989936, 19.061083583578636, -9.189464112737914, 105.53760875483948, 31.970113737587123, 96.79756528949805, 16.51009787174794, 17.212870421299844, 64.74540727731163, 69.54333039867744, 14.111637225137379, 22.05114007420082, 18.12158853620565, 42.93753470603384, 41.698733662206344, 11.148114447354002, 64.33260107866852, 21.550378970779605, 10.663431095621172, 57.72247825276396, 25.134596801822905, 105.80331649924564, 17.147384164493467, 25.560729994321395, 60.41115093470389, 24.99314495465695, -0.47317394861202955, 14.011654945547228, 31.93513228954466, 22.28730624668808, 69.10915148970126, 14.114646260772798, 84.66540725606129, 37.70058570296913, 14.86627861843817, 82.99954661125633, 65.23088997335292, 143.2183005862588, 17.665384107812926, 21.292077044970327, 18.54868152073618, 31.232629300241467, 63.76388608245177, 17.690953596651873, 21.65844033530168, 112.30598824724814, 51.61019113039676, 19.524972583779146, 93.78419580048451, 15.257031023116642, 104.76886897981403, 71.83018956888853, 16.195100557552614, 21.846947222166243, 102.15368640046987, 94.52751939668327, 85.8449348349768, 18.077992577729038, 13.715205886295548, 28.402326237288538, 90.22048554766901, 23.507648989221366, 77.3663500428985, 45.79811565356541], "episode_lengths": [1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.119245922823911, "mean_inference_ms": 6.836416307104397, "mean_action_processing_ms": 0.4721483970154391, "mean_env_wait_ms": 20.62430147696388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03238940238952637, "StateBufferConnector_ms": 0.01778697967529297, "ViewRequirementAgentConnector_ms": 0.7638583183288574}}, "episode_reward_max": 143.2183005862588, "episode_reward_min": -51.05693637433642, "episode_reward_mean": 39.91047658204374, "episode_len_mean": 738.88, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.307748725918639, 16.952577765508984, 48.810743059463576, 20.60132526743948, 16.444119143575612, 26.42550111289354, 18.50856531905584, 11.751458064118006, 19.623835790518765, 97.65418142938286, 21.76748146494076, 21.415148601544306, 17.076679259646035, 21.35144181357021, 14.506846348830509, -51.05693637433642, 7.728973416409907, 115.67648916808317, 84.00496967056866, 60.309248986261174, 16.31481749303626, 88.04953140231052, 69.04927409980252, 43.5832981913662, 15.612229488522225, 20.56758593256541, -28.95656011981679, 16.979940303625767, 18.887237894244564, 19.400673244281418, 84.9566694876425, 16.821353987699002, 42.56355629989586, 20.893004243109157, 15.921883527968461, 59.098979516331404, 37.611681857989936, 19.061083583578636, -9.189464112737914, 105.53760875483948, 31.970113737587123, 96.79756528949805, 16.51009787174794, 17.212870421299844, 64.74540727731163, 69.54333039867744, 14.111637225137379, 22.05114007420082, 18.12158853620565, 42.93753470603384, 41.698733662206344, 11.148114447354002, 64.33260107866852, 21.550378970779605, 10.663431095621172, 57.72247825276396, 25.134596801822905, 105.80331649924564, 17.147384164493467, 25.560729994321395, 60.41115093470389, 24.99314495465695, -0.47317394861202955, 14.011654945547228, 31.93513228954466, 22.28730624668808, 69.10915148970126, 14.114646260772798, 84.66540725606129, 37.70058570296913, 14.86627861843817, 82.99954661125633, 65.23088997335292, 143.2183005862588, 17.665384107812926, 21.292077044970327, 18.54868152073618, 31.232629300241467, 63.76388608245177, 17.690953596651873, 21.65844033530168, 112.30598824724814, 51.61019113039676, 19.524972583779146, 93.78419580048451, 15.257031023116642, 104.76886897981403, 71.83018956888853, 16.195100557552614, 21.846947222166243, 102.15368640046987, 94.52751939668327, 85.8449348349768, 18.077992577729038, 13.715205886295548, 28.402326237288538, 90.22048554766901, 23.507648989221366, 77.3663500428985, 45.79811565356541], "episode_lengths": [1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 1117, 295, 295, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.119245922823911, "mean_inference_ms": 6.836416307104397, "mean_action_processing_ms": 0.4721483970154391, "mean_env_wait_ms": 20.62430147696388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03238940238952637, "StateBufferConnector_ms": 0.01778697967529297, "ViewRequirementAgentConnector_ms": 0.7638583183288574}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 973917, "num_agent_steps_trained": 973917, "num_env_steps_sampled": 973917, "num_env_steps_trained": 973917, "num_env_steps_sampled_this_iter": 11528, "num_env_steps_trained_this_iter": 11528, "num_env_steps_sampled_throughput_per_sec": 220.17689123555118, "num_env_steps_trained_throughput_per_sec": 220.17689123555118, "timesteps_total": 973917, "num_steps_trained_this_iter": 11528, "agent_timesteps_total": 973917, "timers": {"training_iteration_time_ms": 48103.572, "sample_time_ms": 33515.536, "load_time_ms": 1333.579, "load_throughput": 7411.635, "learn_time_ms": 12742.309, "learn_throughput": 775.684, "synch_weights_time_ms": 440.4}, "counters": {"num_env_steps_sampled": 973917, "num_env_steps_trained": 973917, "num_agent_steps_sampled": 973917, "num_agent_steps_trained": 973917}, "done": false, "episodes_total": 1474, "training_iteration": 105, "trial_id": "32ccc_00000", "date": "2025-06-07_13-22-17", "timestamp": 1749295337, "time_this_iter_s": 52.373902797698975, "time_total_s": 4854.989323139191, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4854.989323139191, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 62.48064516129032, "ram_util_percent": 87.39677419354838, "gpu_util_percent0": 0.1762903225806452, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.026083e-05, "total_loss": -0.10585664546560132, "policy_loss": -0.040776724316585786, "vf_loss": 0.05185146546672757, "vf_explained_var": 0.9358291059005551, "kl": 0.014091612116925629, "entropy": 16.060458453108623, "entropy_coeff": 0.005130415}, "model": {}, "num_grad_updates_lifetime": 34535.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 985445, "num_env_steps_trained": 985445, "num_agent_steps_sampled": 985445, "num_agent_steps_trained": 985445}, "sampler_results": {"episode_reward_max": 147.80176957801515, "episode_reward_min": -51.05693637433642, "episode_reward_mean": 44.35040479767256, "episode_len_mean": 771.76, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.506846348830509, -51.05693637433642, 7.728973416409907, 115.67648916808317, 84.00496967056866, 60.309248986261174, 16.31481749303626, 88.04953140231052, 69.04927409980252, 43.5832981913662, 15.612229488522225, 20.56758593256541, -28.95656011981679, 16.979940303625767, 18.887237894244564, 19.400673244281418, 84.9566694876425, 16.821353987699002, 42.56355629989586, 20.893004243109157, 15.921883527968461, 59.098979516331404, 37.611681857989936, 19.061083583578636, -9.189464112737914, 105.53760875483948, 31.970113737587123, 96.79756528949805, 16.51009787174794, 17.212870421299844, 64.74540727731163, 69.54333039867744, 14.111637225137379, 22.05114007420082, 18.12158853620565, 42.93753470603384, 41.698733662206344, 11.148114447354002, 64.33260107866852, 21.550378970779605, 10.663431095621172, 57.72247825276396, 25.134596801822905, 105.80331649924564, 17.147384164493467, 25.560729994321395, 60.41115093470389, 24.99314495465695, -0.47317394861202955, 14.011654945547228, 31.93513228954466, 22.28730624668808, 69.10915148970126, 14.114646260772798, 84.66540725606129, 37.70058570296913, 14.86627861843817, 82.99954661125633, 65.23088997335292, 143.2183005862588, 17.665384107812926, 21.292077044970327, 18.54868152073618, 31.232629300241467, 63.76388608245177, 17.690953596651873, 21.65844033530168, 112.30598824724814, 51.61019113039676, 19.524972583779146, 93.78419580048451, 15.257031023116642, 104.76886897981403, 71.83018956888853, 16.195100557552614, 21.846947222166243, 102.15368640046987, 94.52751939668327, 85.8449348349768, 18.077992577729038, 13.715205886295548, 28.402326237288538, 90.22048554766901, 23.507648989221366, 77.3663500428985, 45.79811565356541, 102.78824375980852, 27.820284113895696, 61.03649037304493, 22.549085227942633, 20.487463125685093, 17.066128702585264, 147.80176957801515, 105.90199403318351, 16.15354473316374, 99.66780891933334, 64.44526248673765, 19.307431431855008, 81.16178659073702, 26.496335304471252], "episode_lengths": [295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1210249063516007, "mean_inference_ms": 6.838918347856846, "mean_action_processing_ms": 0.47228152272905805, "mean_env_wait_ms": 20.62974971031722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03583192825317383, "StateBufferConnector_ms": 0.01676034927368164, "ViewRequirementAgentConnector_ms": 0.7536382675170898}}, "episode_reward_max": 147.80176957801515, "episode_reward_min": -51.05693637433642, "episode_reward_mean": 44.35040479767256, "episode_len_mean": 771.76, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.506846348830509, -51.05693637433642, 7.728973416409907, 115.67648916808317, 84.00496967056866, 60.309248986261174, 16.31481749303626, 88.04953140231052, 69.04927409980252, 43.5832981913662, 15.612229488522225, 20.56758593256541, -28.95656011981679, 16.979940303625767, 18.887237894244564, 19.400673244281418, 84.9566694876425, 16.821353987699002, 42.56355629989586, 20.893004243109157, 15.921883527968461, 59.098979516331404, 37.611681857989936, 19.061083583578636, -9.189464112737914, 105.53760875483948, 31.970113737587123, 96.79756528949805, 16.51009787174794, 17.212870421299844, 64.74540727731163, 69.54333039867744, 14.111637225137379, 22.05114007420082, 18.12158853620565, 42.93753470603384, 41.698733662206344, 11.148114447354002, 64.33260107866852, 21.550378970779605, 10.663431095621172, 57.72247825276396, 25.134596801822905, 105.80331649924564, 17.147384164493467, 25.560729994321395, 60.41115093470389, 24.99314495465695, -0.47317394861202955, 14.011654945547228, 31.93513228954466, 22.28730624668808, 69.10915148970126, 14.114646260772798, 84.66540725606129, 37.70058570296913, 14.86627861843817, 82.99954661125633, 65.23088997335292, 143.2183005862588, 17.665384107812926, 21.292077044970327, 18.54868152073618, 31.232629300241467, 63.76388608245177, 17.690953596651873, 21.65844033530168, 112.30598824724814, 51.61019113039676, 19.524972583779146, 93.78419580048451, 15.257031023116642, 104.76886897981403, 71.83018956888853, 16.195100557552614, 21.846947222166243, 102.15368640046987, 94.52751939668327, 85.8449348349768, 18.077992577729038, 13.715205886295548, 28.402326237288538, 90.22048554766901, 23.507648989221366, 77.3663500428985, 45.79811565356541, 102.78824375980852, 27.820284113895696, 61.03649037304493, 22.549085227942633, 20.487463125685093, 17.066128702585264, 147.80176957801515, 105.90199403318351, 16.15354473316374, 99.66780891933334, 64.44526248673765, 19.307431431855008, 81.16178659073702, 26.496335304471252], "episode_lengths": [295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1210249063516007, "mean_inference_ms": 6.838918347856846, "mean_action_processing_ms": 0.47228152272905805, "mean_env_wait_ms": 20.62974971031722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03583192825317383, "StateBufferConnector_ms": 0.01676034927368164, "ViewRequirementAgentConnector_ms": 0.7536382675170898}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 985445, "num_agent_steps_trained": 985445, "num_env_steps_sampled": 985445, "num_env_steps_trained": 985445, "num_env_steps_sampled_this_iter": 11528, "num_env_steps_trained_this_iter": 11528, "num_env_steps_sampled_throughput_per_sec": 219.8567425916406, "num_env_steps_trained_throughput_per_sec": 219.8567425916406, "timesteps_total": 985445, "num_steps_trained_this_iter": 11528, "agent_timesteps_total": 985445, "timers": {"training_iteration_time_ms": 49779.606, "sample_time_ms": 34113.624, "load_time_ms": 1412.626, "load_throughput": 7346.034, "learn_time_ms": 13706.751, "learn_throughput": 757.087, "synch_weights_time_ms": 470.777}, "counters": {"num_env_steps_sampled": 985445, "num_env_steps_trained": 985445, "num_agent_steps_sampled": 985445, "num_agent_steps_trained": 985445}, "done": false, "episodes_total": 1488, "training_iteration": 106, "trial_id": "32ccc_00000", "date": "2025-06-07_13-23-10", "timestamp": 1749295390, "time_this_iter_s": 52.45217800140381, "time_total_s": 4907.4415011405945, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4907.4415011405945, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 61.379032258064505, "ram_util_percent": 88.03548387096772, "gpu_util_percent0": 0.17177419354838708, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.014555000000001e-05, "total_loss": -0.09694459238728485, "policy_loss": -0.03247123332410233, "vf_loss": 0.0509202086116846, "vf_explained_var": 0.9059750825893588, "kl": 0.014603810175964684, "entropy": 16.080923236288676, "entropy_coeff": 0.005072775000000001}, "model": {}, "num_grad_updates_lifetime": 34945.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 996973, "num_env_steps_trained": 996973, "num_agent_steps_sampled": 996973, "num_agent_steps_trained": 996973}, "sampler_results": {"episode_reward_max": 147.80176957801515, "episode_reward_min": -9.189464112737914, "episode_reward_mean": 47.14070903054643, "episode_len_mean": 779.98, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.887237894244564, 19.400673244281418, 84.9566694876425, 16.821353987699002, 42.56355629989586, 20.893004243109157, 15.921883527968461, 59.098979516331404, 37.611681857989936, 19.061083583578636, -9.189464112737914, 105.53760875483948, 31.970113737587123, 96.79756528949805, 16.51009787174794, 17.212870421299844, 64.74540727731163, 69.54333039867744, 14.111637225137379, 22.05114007420082, 18.12158853620565, 42.93753470603384, 41.698733662206344, 11.148114447354002, 64.33260107866852, 21.550378970779605, 10.663431095621172, 57.72247825276396, 25.134596801822905, 105.80331649924564, 17.147384164493467, 25.560729994321395, 60.41115093470389, 24.99314495465695, -0.47317394861202955, 14.011654945547228, 31.93513228954466, 22.28730624668808, 69.10915148970126, 14.114646260772798, 84.66540725606129, 37.70058570296913, 14.86627861843817, 82.99954661125633, 65.23088997335292, 143.2183005862588, 17.665384107812926, 21.292077044970327, 18.54868152073618, 31.232629300241467, 63.76388608245177, 17.690953596651873, 21.65844033530168, 112.30598824724814, 51.61019113039676, 19.524972583779146, 93.78419580048451, 15.257031023116642, 104.76886897981403, 71.83018956888853, 16.195100557552614, 21.846947222166243, 102.15368640046987, 94.52751939668327, 85.8449348349768, 18.077992577729038, 13.715205886295548, 28.402326237288538, 90.22048554766901, 23.507648989221366, 77.3663500428985, 45.79811565356541, 102.78824375980852, 27.820284113895696, 61.03649037304493, 22.549085227942633, 20.487463125685093, 17.066128702585264, 147.80176957801515, 105.90199403318351, 16.15354473316374, 99.66780891933334, 64.44526248673765, 19.307431431855008, 81.16178659073702, 26.496335304471252, 39.43011942176073, 25.980319601145766, 27.95130473071699, 72.72556867779957, 10.582046961765533, 105.40994473537422, 89.66745831099317, 40.17430763555466, 47.51487744238394, 19.262674081470603, 18.180309692842496, 129.71200153031268, 16.61471045586378, 108.19448801663093], "episode_lengths": [295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1230572180746834, "mean_inference_ms": 6.841787431277637, "mean_action_processing_ms": 0.47241989569812953, "mean_env_wait_ms": 20.635965406382343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03881955146789551, "StateBufferConnector_ms": 0.014346837997436523, "ViewRequirementAgentConnector_ms": 0.7442381381988525}}, "episode_reward_max": 147.80176957801515, "episode_reward_min": -9.189464112737914, "episode_reward_mean": 47.14070903054643, "episode_len_mean": 779.98, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.887237894244564, 19.400673244281418, 84.9566694876425, 16.821353987699002, 42.56355629989586, 20.893004243109157, 15.921883527968461, 59.098979516331404, 37.611681857989936, 19.061083583578636, -9.189464112737914, 105.53760875483948, 31.970113737587123, 96.79756528949805, 16.51009787174794, 17.212870421299844, 64.74540727731163, 69.54333039867744, 14.111637225137379, 22.05114007420082, 18.12158853620565, 42.93753470603384, 41.698733662206344, 11.148114447354002, 64.33260107866852, 21.550378970779605, 10.663431095621172, 57.72247825276396, 25.134596801822905, 105.80331649924564, 17.147384164493467, 25.560729994321395, 60.41115093470389, 24.99314495465695, -0.47317394861202955, 14.011654945547228, 31.93513228954466, 22.28730624668808, 69.10915148970126, 14.114646260772798, 84.66540725606129, 37.70058570296913, 14.86627861843817, 82.99954661125633, 65.23088997335292, 143.2183005862588, 17.665384107812926, 21.292077044970327, 18.54868152073618, 31.232629300241467, 63.76388608245177, 17.690953596651873, 21.65844033530168, 112.30598824724814, 51.61019113039676, 19.524972583779146, 93.78419580048451, 15.257031023116642, 104.76886897981403, 71.83018956888853, 16.195100557552614, 21.846947222166243, 102.15368640046987, 94.52751939668327, 85.8449348349768, 18.077992577729038, 13.715205886295548, 28.402326237288538, 90.22048554766901, 23.507648989221366, 77.3663500428985, 45.79811565356541, 102.78824375980852, 27.820284113895696, 61.03649037304493, 22.549085227942633, 20.487463125685093, 17.066128702585264, 147.80176957801515, 105.90199403318351, 16.15354473316374, 99.66780891933334, 64.44526248673765, 19.307431431855008, 81.16178659073702, 26.496335304471252, 39.43011942176073, 25.980319601145766, 27.95130473071699, 72.72556867779957, 10.582046961765533, 105.40994473537422, 89.66745831099317, 40.17430763555466, 47.51487744238394, 19.262674081470603, 18.180309692842496, 129.71200153031268, 16.61471045586378, 108.19448801663093], "episode_lengths": [295, 295, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1230572180746834, "mean_inference_ms": 6.841787431277637, "mean_action_processing_ms": 0.47241989569812953, "mean_env_wait_ms": 20.635965406382343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03881955146789551, "StateBufferConnector_ms": 0.014346837997436523, "ViewRequirementAgentConnector_ms": 0.7442381381988525}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996973, "num_agent_steps_trained": 996973, "num_env_steps_sampled": 996973, "num_env_steps_trained": 996973, "num_env_steps_sampled_this_iter": 11528, "num_env_steps_trained_this_iter": 11528, "num_env_steps_sampled_throughput_per_sec": 225.69379186102083, "num_env_steps_trained_throughput_per_sec": 225.69379186102083, "timesteps_total": 996973, "num_steps_trained_this_iter": 11528, "agent_timesteps_total": 996973, "timers": {"training_iteration_time_ms": 49645.265, "sample_time_ms": 34032.725, "load_time_ms": 1410.037, "load_throughput": 7359.522, "learn_time_ms": 13655.84, "learn_throughput": 759.909, "synch_weights_time_ms": 469.572}, "counters": {"num_env_steps_sampled": 996973, "num_env_steps_trained": 996973, "num_agent_steps_sampled": 996973, "num_agent_steps_trained": 996973}, "done": false, "episodes_total": 1502, "training_iteration": 107, "trial_id": "32ccc_00000", "date": "2025-06-07_13-24-01", "timestamp": 1749295441, "time_this_iter_s": 51.09379053115845, "time_total_s": 4958.535291671753, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4958.535291671753, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 62.36229508196722, "ram_util_percent": 87.75081967213113, "gpu_util_percent0": 0.15901639344262294, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.003027000000002e-05, "total_loss": -0.08911947950946342, "policy_loss": -0.023160860307143594, "vf_loss": 0.04649067677964922, "vf_explained_var": 0.9713047064840794, "kl": 0.012926983774383647, "entropy": 16.255136105418206, "entropy_coeff": 0.005015135000000001}, "model": {}, "num_grad_updates_lifetime": 35310.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 1006035, "num_env_steps_trained": 1006035, "num_agent_steps_sampled": 1006035, "num_agent_steps_trained": 1006035}, "sampler_results": {"episode_reward_max": 147.80176957801515, "episode_reward_min": -0.47317394861202955, "episode_reward_mean": 46.86248017363765, "episode_len_mean": 763.54, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.51009787174794, 17.212870421299844, 64.74540727731163, 69.54333039867744, 14.111637225137379, 22.05114007420082, 18.12158853620565, 42.93753470603384, 41.698733662206344, 11.148114447354002, 64.33260107866852, 21.550378970779605, 10.663431095621172, 57.72247825276396, 25.134596801822905, 105.80331649924564, 17.147384164493467, 25.560729994321395, 60.41115093470389, 24.99314495465695, -0.47317394861202955, 14.011654945547228, 31.93513228954466, 22.28730624668808, 69.10915148970126, 14.114646260772798, 84.66540725606129, 37.70058570296913, 14.86627861843817, 82.99954661125633, 65.23088997335292, 143.2183005862588, 17.665384107812926, 21.292077044970327, 18.54868152073618, 31.232629300241467, 63.76388608245177, 17.690953596651873, 21.65844033530168, 112.30598824724814, 51.61019113039676, 19.524972583779146, 93.78419580048451, 15.257031023116642, 104.76886897981403, 71.83018956888853, 16.195100557552614, 21.846947222166243, 102.15368640046987, 94.52751939668327, 85.8449348349768, 18.077992577729038, 13.715205886295548, 28.402326237288538, 90.22048554766901, 23.507648989221366, 77.3663500428985, 45.79811565356541, 102.78824375980852, 27.820284113895696, 61.03649037304493, 22.549085227942633, 20.487463125685093, 17.066128702585264, 147.80176957801515, 105.90199403318351, 16.15354473316374, 99.66780891933334, 64.44526248673765, 19.307431431855008, 81.16178659073702, 26.496335304471252, 39.43011942176073, 25.980319601145766, 27.95130473071699, 72.72556867779957, 10.582046961765533, 105.40994473537422, 89.66745831099317, 40.17430763555466, 47.51487744238394, 19.262674081470603, 18.180309692842496, 129.71200153031268, 16.61471045586378, 108.19448801663093, 15.053478138385213, 19.71539079879199, 17.353387104096708, 92.51529574761678, 18.467537468585014, 18.806666400551297, 22.469765198718953, 40.53787563956489, 29.503973503851526, 32.19142199852806, 16.62723418937411, 98.37350967442926, 13.81272246643792, 97.08080329211836], "episode_lengths": [295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1249764541125185, "mean_inference_ms": 6.844341155103937, "mean_action_processing_ms": 0.47255319342440727, "mean_env_wait_ms": 20.641778521443012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036815643310546875, "StateBufferConnector_ms": 0.015350341796875, "ViewRequirementAgentConnector_ms": 0.7453052997589111}}, "episode_reward_max": 147.80176957801515, "episode_reward_min": -0.47317394861202955, "episode_reward_mean": 46.86248017363765, "episode_len_mean": 763.54, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.51009787174794, 17.212870421299844, 64.74540727731163, 69.54333039867744, 14.111637225137379, 22.05114007420082, 18.12158853620565, 42.93753470603384, 41.698733662206344, 11.148114447354002, 64.33260107866852, 21.550378970779605, 10.663431095621172, 57.72247825276396, 25.134596801822905, 105.80331649924564, 17.147384164493467, 25.560729994321395, 60.41115093470389, 24.99314495465695, -0.47317394861202955, 14.011654945547228, 31.93513228954466, 22.28730624668808, 69.10915148970126, 14.114646260772798, 84.66540725606129, 37.70058570296913, 14.86627861843817, 82.99954661125633, 65.23088997335292, 143.2183005862588, 17.665384107812926, 21.292077044970327, 18.54868152073618, 31.232629300241467, 63.76388608245177, 17.690953596651873, 21.65844033530168, 112.30598824724814, 51.61019113039676, 19.524972583779146, 93.78419580048451, 15.257031023116642, 104.76886897981403, 71.83018956888853, 16.195100557552614, 21.846947222166243, 102.15368640046987, 94.52751939668327, 85.8449348349768, 18.077992577729038, 13.715205886295548, 28.402326237288538, 90.22048554766901, 23.507648989221366, 77.3663500428985, 45.79811565356541, 102.78824375980852, 27.820284113895696, 61.03649037304493, 22.549085227942633, 20.487463125685093, 17.066128702585264, 147.80176957801515, 105.90199403318351, 16.15354473316374, 99.66780891933334, 64.44526248673765, 19.307431431855008, 81.16178659073702, 26.496335304471252, 39.43011942176073, 25.980319601145766, 27.95130473071699, 72.72556867779957, 10.582046961765533, 105.40994473537422, 89.66745831099317, 40.17430763555466, 47.51487744238394, 19.262674081470603, 18.180309692842496, 129.71200153031268, 16.61471045586378, 108.19448801663093, 15.053478138385213, 19.71539079879199, 17.353387104096708, 92.51529574761678, 18.467537468585014, 18.806666400551297, 22.469765198718953, 40.53787563956489, 29.503973503851526, 32.19142199852806, 16.62723418937411, 98.37350967442926, 13.81272246643792, 97.08080329211836], "episode_lengths": [295, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1249764541125185, "mean_inference_ms": 6.844341155103937, "mean_action_processing_ms": 0.47255319342440727, "mean_env_wait_ms": 20.641778521443012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036815643310546875, "StateBufferConnector_ms": 0.015350341796875, "ViewRequirementAgentConnector_ms": 0.7453052997589111}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1006035, "num_agent_steps_trained": 1006035, "num_env_steps_sampled": 1006035, "num_env_steps_trained": 1006035, "num_env_steps_sampled_this_iter": 9062, "num_env_steps_trained_this_iter": 9062, "num_env_steps_sampled_throughput_per_sec": 195.47444451594185, "num_env_steps_trained_throughput_per_sec": 195.47444451594185, "timesteps_total": 1006035, "num_steps_trained_this_iter": 9062, "agent_timesteps_total": 1006035, "timers": {"training_iteration_time_ms": 49950.116, "sample_time_ms": 34116.894, "load_time_ms": 1465.756, "load_throughput": 7135.839, "learn_time_ms": 13814.64, "learn_throughput": 757.124, "synch_weights_time_ms": 474.343}, "counters": {"num_env_steps_sampled": 1006035, "num_env_steps_trained": 1006035, "num_agent_steps_sampled": 1006035, "num_agent_steps_trained": 1006035}, "done": false, "episodes_total": 1516, "training_iteration": 108, "trial_id": "32ccc_00000", "date": "2025-06-07_13-24-47", "timestamp": 1749295487, "time_this_iter_s": 46.376829385757446, "time_total_s": 5004.91212105751, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5004.91212105751, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 54.26181818181818, "ram_util_percent": 86.97272727272727, "gpu_util_percent0": 0.15600000000000003, "vram_util_percent0": 0.9650065104166664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 8.993965000000001e-05, "total_loss": -0.08568848870927467, "policy_loss": -0.025589148946892237, "vf_loss": 0.06574221388727892, "vf_explained_var": 0.9543974805623293, "kl": 0.011844995288998558, "entropy": 16.29001910984516, "entropy_coeff": 0.004990947500000001}, "model": {}, "num_grad_updates_lifetime": 35630.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 1015097, "num_env_steps_trained": 1015097, "num_agent_steps_sampled": 1015097, "num_agent_steps_trained": 1015097}, "sampler_results": {"episode_reward_max": 147.80176957801515, "episode_reward_min": -60.744130475064225, "episode_reward_mean": 46.113307962512216, "episode_len_mean": 747.1, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.134596801822905, 105.80331649924564, 17.147384164493467, 25.560729994321395, 60.41115093470389, 24.99314495465695, -0.47317394861202955, 14.011654945547228, 31.93513228954466, 22.28730624668808, 69.10915148970126, 14.114646260772798, 84.66540725606129, 37.70058570296913, 14.86627861843817, 82.99954661125633, 65.23088997335292, 143.2183005862588, 17.665384107812926, 21.292077044970327, 18.54868152073618, 31.232629300241467, 63.76388608245177, 17.690953596651873, 21.65844033530168, 112.30598824724814, 51.61019113039676, 19.524972583779146, 93.78419580048451, 15.257031023116642, 104.76886897981403, 71.83018956888853, 16.195100557552614, 21.846947222166243, 102.15368640046987, 94.52751939668327, 85.8449348349768, 18.077992577729038, 13.715205886295548, 28.402326237288538, 90.22048554766901, 23.507648989221366, 77.3663500428985, 45.79811565356541, 102.78824375980852, 27.820284113895696, 61.03649037304493, 22.549085227942633, 20.487463125685093, 17.066128702585264, 147.80176957801515, 105.90199403318351, 16.15354473316374, 99.66780891933334, 64.44526248673765, 19.307431431855008, 81.16178659073702, 26.496335304471252, 39.43011942176073, 25.980319601145766, 27.95130473071699, 72.72556867779957, 10.582046961765533, 105.40994473537422, 89.66745831099317, 40.17430763555466, 47.51487744238394, 19.262674081470603, 18.180309692842496, 129.71200153031268, 16.61471045586378, 108.19448801663093, 15.053478138385213, 19.71539079879199, 17.353387104096708, 92.51529574761678, 18.467537468585014, 18.806666400551297, 22.469765198718953, 40.53787563956489, 29.503973503851526, 32.19142199852806, 16.62723418937411, 98.37350967442926, 13.81272246643792, 97.08080329211836, 16.947737050699264, -60.744130475064225, 56.26479111319336, 85.17292005271239, 19.31547829889945, 17.447629348453976, 20.41019997002698, 50.91552563153769, 17.412131108950675, 11.311900106673324, 83.18111621329709, 23.511750728717484, 41.54974336342521, 14.735330393940533], "episode_lengths": [1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 1117, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1263860912599135, "mean_inference_ms": 6.8461271842411495, "mean_action_processing_ms": 0.4726621830379579, "mean_env_wait_ms": 20.64622370277208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037822723388671875, "StateBufferConnector_ms": 0.013562440872192383, "ViewRequirementAgentConnector_ms": 0.7641453742980957}}, "episode_reward_max": 147.80176957801515, "episode_reward_min": -60.744130475064225, "episode_reward_mean": 46.113307962512216, "episode_len_mean": 747.1, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.134596801822905, 105.80331649924564, 17.147384164493467, 25.560729994321395, 60.41115093470389, 24.99314495465695, -0.47317394861202955, 14.011654945547228, 31.93513228954466, 22.28730624668808, 69.10915148970126, 14.114646260772798, 84.66540725606129, 37.70058570296913, 14.86627861843817, 82.99954661125633, 65.23088997335292, 143.2183005862588, 17.665384107812926, 21.292077044970327, 18.54868152073618, 31.232629300241467, 63.76388608245177, 17.690953596651873, 21.65844033530168, 112.30598824724814, 51.61019113039676, 19.524972583779146, 93.78419580048451, 15.257031023116642, 104.76886897981403, 71.83018956888853, 16.195100557552614, 21.846947222166243, 102.15368640046987, 94.52751939668327, 85.8449348349768, 18.077992577729038, 13.715205886295548, 28.402326237288538, 90.22048554766901, 23.507648989221366, 77.3663500428985, 45.79811565356541, 102.78824375980852, 27.820284113895696, 61.03649037304493, 22.549085227942633, 20.487463125685093, 17.066128702585264, 147.80176957801515, 105.90199403318351, 16.15354473316374, 99.66780891933334, 64.44526248673765, 19.307431431855008, 81.16178659073702, 26.496335304471252, 39.43011942176073, 25.980319601145766, 27.95130473071699, 72.72556867779957, 10.582046961765533, 105.40994473537422, 89.66745831099317, 40.17430763555466, 47.51487744238394, 19.262674081470603, 18.180309692842496, 129.71200153031268, 16.61471045586378, 108.19448801663093, 15.053478138385213, 19.71539079879199, 17.353387104096708, 92.51529574761678, 18.467537468585014, 18.806666400551297, 22.469765198718953, 40.53787563956489, 29.503973503851526, 32.19142199852806, 16.62723418937411, 98.37350967442926, 13.81272246643792, 97.08080329211836, 16.947737050699264, -60.744130475064225, 56.26479111319336, 85.17292005271239, 19.31547829889945, 17.447629348453976, 20.41019997002698, 50.91552563153769, 17.412131108950675, 11.311900106673324, 83.18111621329709, 23.511750728717484, 41.54974336342521, 14.735330393940533], "episode_lengths": [1117, 1117, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 1117, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1263860912599135, "mean_inference_ms": 6.8461271842411495, "mean_action_processing_ms": 0.4726621830379579, "mean_env_wait_ms": 20.64622370277208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037822723388671875, "StateBufferConnector_ms": 0.013562440872192383, "ViewRequirementAgentConnector_ms": 0.7641453742980957}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1015097, "num_agent_steps_trained": 1015097, "num_env_steps_sampled": 1015097, "num_env_steps_trained": 1015097, "num_env_steps_sampled_this_iter": 9062, "num_env_steps_trained_this_iter": 9062, "num_env_steps_sampled_throughput_per_sec": 195.04185494654016, "num_env_steps_trained_throughput_per_sec": 195.04185494654016, "timesteps_total": 1015097, "num_steps_trained_this_iter": 9062, "agent_timesteps_total": 1015097, "timers": {"training_iteration_time_ms": 50159.521, "sample_time_ms": 34232.57, "load_time_ms": 1489.53, "load_throughput": 7077.13, "learn_time_ms": 13885.412, "learn_throughput": 759.185, "synch_weights_time_ms": 473.424}, "counters": {"num_env_steps_sampled": 1015097, "num_env_steps_trained": 1015097, "num_agent_steps_sampled": 1015097, "num_agent_steps_trained": 1015097}, "done": false, "episodes_total": 1530, "training_iteration": 109, "trial_id": "32ccc_00000", "date": "2025-06-07_13-25-34", "timestamp": 1749295534, "time_this_iter_s": 46.47935676574707, "time_total_s": 5051.391477823257, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5051.391477823257, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 55.36428571428571, "ram_util_percent": 86.46428571428571, "gpu_util_percent0": 0.15178571428571427, "vram_util_percent0": 0.9650065104166667}}
{"evaluation": {"sampler_results": {"episode_reward_max": -4.736050874191239, "episode_reward_min": -28.42037175644841, "episode_reward_mean": -20.741305289116205, "episode_len_mean": 149.2, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.147304969170467, -28.029338122958478, -28.42037175644841, -14.373460722812457, -4.736050874191239], "episode_lengths": [184, 184, 184, 108, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6798350991949538, "mean_inference_ms": 3.715992646812521, "mean_action_processing_ms": 0.274821527079511, "mean_env_wait_ms": 11.46350227438105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.24044513702392578}}, "episode_reward_max": -4.736050874191239, "episode_reward_min": -28.42037175644841, "episode_reward_mean": -20.741305289116205, "episode_len_mean": 149.2, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.147304969170467, -28.029338122958478, -28.42037175644841, -14.373460722812457, -4.736050874191239], "episode_lengths": [184, 184, 184, 108, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6798350991949538, "mean_inference_ms": 3.715992646812521, "mean_action_processing_ms": 0.274821527079511, "mean_env_wait_ms": 11.46350227438105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.24044513702392578}, "num_agent_steps_sampled_this_iter": 746, "num_env_steps_sampled_this_iter": 746, "timesteps_this_iter": 746, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 8.984903000000002e-05, "total_loss": -0.09082041816225021, "policy_loss": -0.03211052767649314, "vf_loss": 0.06481986567378044, "vf_explained_var": 0.8943254339424047, "kl": 0.014112547681427466, "entropy": 16.05670670379292, "entropy_coeff": 0.0049773545}, "model": {}, "num_grad_updates_lifetime": 36010.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 1027447, "num_env_steps_trained": 1027447, "num_agent_steps_sampled": 1027447, "num_agent_steps_trained": 1027447}, "sampler_results": {"episode_reward_max": 147.80176957801515, "episode_reward_min": -60.744130475064225, "episode_reward_mean": 47.9497664231381, "episode_len_mean": 763.54, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.86627861843817, 82.99954661125633, 65.23088997335292, 143.2183005862588, 17.665384107812926, 21.292077044970327, 18.54868152073618, 31.232629300241467, 63.76388608245177, 17.690953596651873, 21.65844033530168, 112.30598824724814, 51.61019113039676, 19.524972583779146, 93.78419580048451, 15.257031023116642, 104.76886897981403, 71.83018956888853, 16.195100557552614, 21.846947222166243, 102.15368640046987, 94.52751939668327, 85.8449348349768, 18.077992577729038, 13.715205886295548, 28.402326237288538, 90.22048554766901, 23.507648989221366, 77.3663500428985, 45.79811565356541, 102.78824375980852, 27.820284113895696, 61.03649037304493, 22.549085227942633, 20.487463125685093, 17.066128702585264, 147.80176957801515, 105.90199403318351, 16.15354473316374, 99.66780891933334, 64.44526248673765, 19.307431431855008, 81.16178659073702, 26.496335304471252, 39.43011942176073, 25.980319601145766, 27.95130473071699, 72.72556867779957, 10.582046961765533, 105.40994473537422, 89.66745831099317, 40.17430763555466, 47.51487744238394, 19.262674081470603, 18.180309692842496, 129.71200153031268, 16.61471045586378, 108.19448801663093, 15.053478138385213, 19.71539079879199, 17.353387104096708, 92.51529574761678, 18.467537468585014, 18.806666400551297, 22.469765198718953, 40.53787563956489, 29.503973503851526, 32.19142199852806, 16.62723418937411, 98.37350967442926, 13.81272246643792, 97.08080329211836, 16.947737050699264, -60.744130475064225, 56.26479111319336, 85.17292005271239, 19.31547829889945, 17.447629348453976, 20.41019997002698, 50.91552563153769, 17.412131108950675, 11.311900106673324, 83.18111621329709, 23.511750728717484, 41.54974336342521, 14.735330393940533, 18.84407372615985, 20.563156087784872, -3.102249269074065, 108.21728227371258, 25.809916274881363, 95.28221382980912, 76.36469288946749, 52.60443570279186, 110.78293210939404, 15.433791867197879, 78.07811709056833, 51.08086034866168, 16.89218127504045, 49.19547544810929], "episode_lengths": [295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.128177952905987, "mean_inference_ms": 6.848205899082449, "mean_action_processing_ms": 0.47283170081538445, "mean_env_wait_ms": 20.65123396754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03676891326904297, "StateBufferConnector_ms": 0.012767553329467773, "ViewRequirementAgentConnector_ms": 0.7772800922393799}}, "episode_reward_max": 147.80176957801515, "episode_reward_min": -60.744130475064225, "episode_reward_mean": 47.9497664231381, "episode_len_mean": 763.54, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.86627861843817, 82.99954661125633, 65.23088997335292, 143.2183005862588, 17.665384107812926, 21.292077044970327, 18.54868152073618, 31.232629300241467, 63.76388608245177, 17.690953596651873, 21.65844033530168, 112.30598824724814, 51.61019113039676, 19.524972583779146, 93.78419580048451, 15.257031023116642, 104.76886897981403, 71.83018956888853, 16.195100557552614, 21.846947222166243, 102.15368640046987, 94.52751939668327, 85.8449348349768, 18.077992577729038, 13.715205886295548, 28.402326237288538, 90.22048554766901, 23.507648989221366, 77.3663500428985, 45.79811565356541, 102.78824375980852, 27.820284113895696, 61.03649037304493, 22.549085227942633, 20.487463125685093, 17.066128702585264, 147.80176957801515, 105.90199403318351, 16.15354473316374, 99.66780891933334, 64.44526248673765, 19.307431431855008, 81.16178659073702, 26.496335304471252, 39.43011942176073, 25.980319601145766, 27.95130473071699, 72.72556867779957, 10.582046961765533, 105.40994473537422, 89.66745831099317, 40.17430763555466, 47.51487744238394, 19.262674081470603, 18.180309692842496, 129.71200153031268, 16.61471045586378, 108.19448801663093, 15.053478138385213, 19.71539079879199, 17.353387104096708, 92.51529574761678, 18.467537468585014, 18.806666400551297, 22.469765198718953, 40.53787563956489, 29.503973503851526, 32.19142199852806, 16.62723418937411, 98.37350967442926, 13.81272246643792, 97.08080329211836, 16.947737050699264, -60.744130475064225, 56.26479111319336, 85.17292005271239, 19.31547829889945, 17.447629348453976, 20.41019997002698, 50.91552563153769, 17.412131108950675, 11.311900106673324, 83.18111621329709, 23.511750728717484, 41.54974336342521, 14.735330393940533, 18.84407372615985, 20.563156087784872, -3.102249269074065, 108.21728227371258, 25.809916274881363, 95.28221382980912, 76.36469288946749, 52.60443570279186, 110.78293210939404, 15.433791867197879, 78.07811709056833, 51.08086034866168, 16.89218127504045, 49.19547544810929], "episode_lengths": [295, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.128177952905987, "mean_inference_ms": 6.848205899082449, "mean_action_processing_ms": 0.47283170081538445, "mean_env_wait_ms": 20.65123396754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03676891326904297, "StateBufferConnector_ms": 0.012767553329467773, "ViewRequirementAgentConnector_ms": 0.7772800922393799}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1027447, "num_agent_steps_trained": 1027447, "num_env_steps_sampled": 1027447, "num_env_steps_trained": 1027447, "num_env_steps_sampled_this_iter": 12350, "num_env_steps_trained_this_iter": 12350, "num_env_steps_sampled_throughput_per_sec": 229.28791546755036, "num_env_steps_trained_throughput_per_sec": 229.28791546755036, "timesteps_total": 1027447, "num_steps_trained_this_iter": 12350, "agent_timesteps_total": 1027447, "timers": {"training_iteration_time_ms": 50767.885, "sample_time_ms": 34555.861, "load_time_ms": 1535.425, "load_throughput": 7026.196, "learn_time_ms": 14112.444, "learn_throughput": 764.446, "synch_weights_time_ms": 478.13}, "counters": {"num_env_steps_sampled": 1027447, "num_env_steps_trained": 1027447, "num_agent_steps_sampled": 1027447, "num_agent_steps_trained": 1027447}, "done": false, "episodes_total": 1544, "training_iteration": 110, "trial_id": "32ccc_00000", "date": "2025-06-07_13-26-42", "timestamp": 1749295602, "time_this_iter_s": 67.78665471076965, "time_total_s": 5119.178132534027, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5119.178132534027, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 54.59876543209878, "ram_util_percent": 87.39629629629628, "gpu_util_percent0": 0.1385185185185185, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 8.972552999999998e-05, "total_loss": -0.08754789149255625, "policy_loss": -0.024491410010627337, "vf_loss": 0.051553846254412616, "vf_explained_var": 0.9255528475557054, "kl": 0.013204773523367288, "entropy": 16.16777363368443, "entropy_coeff": 0.004958829499999999}, "model": {}, "num_grad_updates_lifetime": 36405.5, "diff_num_grad_updates_vs_sampler_policy": 174.5}}, "num_env_steps_sampled": 1037331, "num_env_steps_trained": 1037331, "num_agent_steps_sampled": 1037331, "num_agent_steps_trained": 1037331}, "sampler_results": {"episode_reward_max": 147.80176957801515, "episode_reward_min": -60.744130475064225, "episode_reward_mean": 46.378570830893935, "episode_len_mean": 763.54, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.78419580048451, 15.257031023116642, 104.76886897981403, 71.83018956888853, 16.195100557552614, 21.846947222166243, 102.15368640046987, 94.52751939668327, 85.8449348349768, 18.077992577729038, 13.715205886295548, 28.402326237288538, 90.22048554766901, 23.507648989221366, 77.3663500428985, 45.79811565356541, 102.78824375980852, 27.820284113895696, 61.03649037304493, 22.549085227942633, 20.487463125685093, 17.066128702585264, 147.80176957801515, 105.90199403318351, 16.15354473316374, 99.66780891933334, 64.44526248673765, 19.307431431855008, 81.16178659073702, 26.496335304471252, 39.43011942176073, 25.980319601145766, 27.95130473071699, 72.72556867779957, 10.582046961765533, 105.40994473537422, 89.66745831099317, 40.17430763555466, 47.51487744238394, 19.262674081470603, 18.180309692842496, 129.71200153031268, 16.61471045586378, 108.19448801663093, 15.053478138385213, 19.71539079879199, 17.353387104096708, 92.51529574761678, 18.467537468585014, 18.806666400551297, 22.469765198718953, 40.53787563956489, 29.503973503851526, 32.19142199852806, 16.62723418937411, 98.37350967442926, 13.81272246643792, 97.08080329211836, 16.947737050699264, -60.744130475064225, 56.26479111319336, 85.17292005271239, 19.31547829889945, 17.447629348453976, 20.41019997002698, 50.91552563153769, 17.412131108950675, 11.311900106673324, 83.18111621329709, 23.511750728717484, 41.54974336342521, 14.735330393940533, 18.84407372615985, 20.563156087784872, -3.102249269074065, 108.21728227371258, 25.809916274881363, 95.28221382980912, 76.36469288946749, 52.60443570279186, 110.78293210939404, 15.433791867197879, 78.07811709056833, 51.08086034866168, 16.89218127504045, 49.19547544810929, 102.60230468391129, 56.98872653592099, 15.1361541194205, 67.73858892124662, 17.655788255792924, 84.01118250236135, 29.277764998662438, -13.948945272419317, 19.409231566496835, 36.06500068381699, 15.142955173452467, 59.01856883709531, 18.046118166261806, 17.34522134246045], "episode_lengths": [1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.130007700923416, "mean_inference_ms": 6.850293193332212, "mean_action_processing_ms": 0.4729928544074973, "mean_env_wait_ms": 20.65598510562009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03372621536254883, "StateBufferConnector_ms": 0.013799667358398438, "ViewRequirementAgentConnector_ms": 0.7929947376251221}}, "episode_reward_max": 147.80176957801515, "episode_reward_min": -60.744130475064225, "episode_reward_mean": 46.378570830893935, "episode_len_mean": 763.54, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [93.78419580048451, 15.257031023116642, 104.76886897981403, 71.83018956888853, 16.195100557552614, 21.846947222166243, 102.15368640046987, 94.52751939668327, 85.8449348349768, 18.077992577729038, 13.715205886295548, 28.402326237288538, 90.22048554766901, 23.507648989221366, 77.3663500428985, 45.79811565356541, 102.78824375980852, 27.820284113895696, 61.03649037304493, 22.549085227942633, 20.487463125685093, 17.066128702585264, 147.80176957801515, 105.90199403318351, 16.15354473316374, 99.66780891933334, 64.44526248673765, 19.307431431855008, 81.16178659073702, 26.496335304471252, 39.43011942176073, 25.980319601145766, 27.95130473071699, 72.72556867779957, 10.582046961765533, 105.40994473537422, 89.66745831099317, 40.17430763555466, 47.51487744238394, 19.262674081470603, 18.180309692842496, 129.71200153031268, 16.61471045586378, 108.19448801663093, 15.053478138385213, 19.71539079879199, 17.353387104096708, 92.51529574761678, 18.467537468585014, 18.806666400551297, 22.469765198718953, 40.53787563956489, 29.503973503851526, 32.19142199852806, 16.62723418937411, 98.37350967442926, 13.81272246643792, 97.08080329211836, 16.947737050699264, -60.744130475064225, 56.26479111319336, 85.17292005271239, 19.31547829889945, 17.447629348453976, 20.41019997002698, 50.91552563153769, 17.412131108950675, 11.311900106673324, 83.18111621329709, 23.511750728717484, 41.54974336342521, 14.735330393940533, 18.84407372615985, 20.563156087784872, -3.102249269074065, 108.21728227371258, 25.809916274881363, 95.28221382980912, 76.36469288946749, 52.60443570279186, 110.78293210939404, 15.433791867197879, 78.07811709056833, 51.08086034866168, 16.89218127504045, 49.19547544810929, 102.60230468391129, 56.98872653592099, 15.1361541194205, 67.73858892124662, 17.655788255792924, 84.01118250236135, 29.277764998662438, -13.948945272419317, 19.409231566496835, 36.06500068381699, 15.142955173452467, 59.01856883709531, 18.046118166261806, 17.34522134246045], "episode_lengths": [1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.130007700923416, "mean_inference_ms": 6.850293193332212, "mean_action_processing_ms": 0.4729928544074973, "mean_env_wait_ms": 20.65598510562009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03372621536254883, "StateBufferConnector_ms": 0.013799667358398438, "ViewRequirementAgentConnector_ms": 0.7929947376251221}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1037331, "num_agent_steps_trained": 1037331, "num_env_steps_sampled": 1037331, "num_env_steps_trained": 1037331, "num_env_steps_sampled_this_iter": 9884, "num_env_steps_trained_this_iter": 9884, "num_env_steps_sampled_throughput_per_sec": 202.71682017902256, "num_env_steps_trained_throughput_per_sec": 202.71682017902256, "timesteps_total": 1037331, "num_steps_trained_this_iter": 9884, "agent_timesteps_total": 1037331, "timers": {"training_iteration_time_ms": 50500.145, "sample_time_ms": 34483.519, "load_time_ms": 1505.414, "load_throughput": 7111.667, "learn_time_ms": 13945.834, "learn_throughput": 767.684, "synch_weights_time_ms": 480.086}, "counters": {"num_env_steps_sampled": 1037331, "num_env_steps_trained": 1037331, "num_agent_steps_sampled": 1037331, "num_agent_steps_trained": 1037331}, "done": false, "episodes_total": 1558, "training_iteration": 111, "trial_id": "32ccc_00000", "date": "2025-06-07_13-27-31", "timestamp": 1749295651, "time_this_iter_s": 48.78010153770447, "time_total_s": 5167.958234071732, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5167.958234071732, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 55.62413793103449, "ram_util_percent": 87.35344827586206, "gpu_util_percent0": 0.17224137931034483, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 8.962669000000003e-05, "total_loss": -0.08122514018860574, "policy_loss": -0.017825843741257605, "vf_loss": 0.04857955955936072, "vf_explained_var": 0.967100018950609, "kl": 0.014838805387606326, "entropy": 16.146431922912598, "entropy_coeff": 0.004944003500000001}, "model": {}, "num_grad_updates_lifetime": 36710.5, "diff_num_grad_updates_vs_sampler_policy": 129.5}}, "num_env_steps_sampled": 1044749, "num_env_steps_trained": 1044749, "num_agent_steps_sampled": 1044749, "num_agent_steps_trained": 1044749}, "sampler_results": {"episode_reward_max": 147.80176957801515, "episode_reward_min": -60.744130475064225, "episode_reward_mean": 42.89049181593478, "episode_len_mean": 730.66, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.3663500428985, 45.79811565356541, 102.78824375980852, 27.820284113895696, 61.03649037304493, 22.549085227942633, 20.487463125685093, 17.066128702585264, 147.80176957801515, 105.90199403318351, 16.15354473316374, 99.66780891933334, 64.44526248673765, 19.307431431855008, 81.16178659073702, 26.496335304471252, 39.43011942176073, 25.980319601145766, 27.95130473071699, 72.72556867779957, 10.582046961765533, 105.40994473537422, 89.66745831099317, 40.17430763555466, 47.51487744238394, 19.262674081470603, 18.180309692842496, 129.71200153031268, 16.61471045586378, 108.19448801663093, 15.053478138385213, 19.71539079879199, 17.353387104096708, 92.51529574761678, 18.467537468585014, 18.806666400551297, 22.469765198718953, 40.53787563956489, 29.503973503851526, 32.19142199852806, 16.62723418937411, 98.37350967442926, 13.81272246643792, 97.08080329211836, 16.947737050699264, -60.744130475064225, 56.26479111319336, 85.17292005271239, 19.31547829889945, 17.447629348453976, 20.41019997002698, 50.91552563153769, 17.412131108950675, 11.311900106673324, 83.18111621329709, 23.511750728717484, 41.54974336342521, 14.735330393940533, 18.84407372615985, 20.563156087784872, -3.102249269074065, 108.21728227371258, 25.809916274881363, 95.28221382980912, 76.36469288946749, 52.60443570279186, 110.78293210939404, 15.433791867197879, 78.07811709056833, 51.08086034866168, 16.89218127504045, 49.19547544810929, 102.60230468391129, 56.98872653592099, 15.1361541194205, 67.73858892124662, 17.655788255792924, 84.01118250236135, 29.277764998662438, -13.948945272419317, 19.409231566496835, 36.06500068381699, 15.142955173452467, 59.01856883709531, 18.046118166261806, 17.34522134246045, 23.333990025904942, 21.49476455716504, 12.626850706790641, 23.655406133667803, 19.38131506340076, 81.7914185834965, 99.43403645038046, 13.876584485188127, 57.273851404416895, 19.03763667880425, 11.827566077258936, 15.627142331857751, 17.237831893089297, 14.725837135020564], "episode_lengths": [1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 295, 1117, 295, 295, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.131544907703722, "mean_inference_ms": 6.852124811298096, "mean_action_processing_ms": 0.4731349010426952, "mean_env_wait_ms": 20.66011915068673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030205488204956055, "StateBufferConnector_ms": 0.013279199600219727, "ViewRequirementAgentConnector_ms": 0.8390722274780273}}, "episode_reward_max": 147.80176957801515, "episode_reward_min": -60.744130475064225, "episode_reward_mean": 42.89049181593478, "episode_len_mean": 730.66, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [77.3663500428985, 45.79811565356541, 102.78824375980852, 27.820284113895696, 61.03649037304493, 22.549085227942633, 20.487463125685093, 17.066128702585264, 147.80176957801515, 105.90199403318351, 16.15354473316374, 99.66780891933334, 64.44526248673765, 19.307431431855008, 81.16178659073702, 26.496335304471252, 39.43011942176073, 25.980319601145766, 27.95130473071699, 72.72556867779957, 10.582046961765533, 105.40994473537422, 89.66745831099317, 40.17430763555466, 47.51487744238394, 19.262674081470603, 18.180309692842496, 129.71200153031268, 16.61471045586378, 108.19448801663093, 15.053478138385213, 19.71539079879199, 17.353387104096708, 92.51529574761678, 18.467537468585014, 18.806666400551297, 22.469765198718953, 40.53787563956489, 29.503973503851526, 32.19142199852806, 16.62723418937411, 98.37350967442926, 13.81272246643792, 97.08080329211836, 16.947737050699264, -60.744130475064225, 56.26479111319336, 85.17292005271239, 19.31547829889945, 17.447629348453976, 20.41019997002698, 50.91552563153769, 17.412131108950675, 11.311900106673324, 83.18111621329709, 23.511750728717484, 41.54974336342521, 14.735330393940533, 18.84407372615985, 20.563156087784872, -3.102249269074065, 108.21728227371258, 25.809916274881363, 95.28221382980912, 76.36469288946749, 52.60443570279186, 110.78293210939404, 15.433791867197879, 78.07811709056833, 51.08086034866168, 16.89218127504045, 49.19547544810929, 102.60230468391129, 56.98872653592099, 15.1361541194205, 67.73858892124662, 17.655788255792924, 84.01118250236135, 29.277764998662438, -13.948945272419317, 19.409231566496835, 36.06500068381699, 15.142955173452467, 59.01856883709531, 18.046118166261806, 17.34522134246045, 23.333990025904942, 21.49476455716504, 12.626850706790641, 23.655406133667803, 19.38131506340076, 81.7914185834965, 99.43403645038046, 13.876584485188127, 57.273851404416895, 19.03763667880425, 11.827566077258936, 15.627142331857751, 17.237831893089297, 14.725837135020564], "episode_lengths": [1117, 1117, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 295, 1117, 295, 295, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.131544907703722, "mean_inference_ms": 6.852124811298096, "mean_action_processing_ms": 0.4731349010426952, "mean_env_wait_ms": 20.66011915068673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030205488204956055, "StateBufferConnector_ms": 0.013279199600219727, "ViewRequirementAgentConnector_ms": 0.8390722274780273}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044749, "num_agent_steps_trained": 1044749, "num_env_steps_sampled": 1044749, "num_env_steps_trained": 1044749, "num_env_steps_sampled_this_iter": 7418, "num_env_steps_trained_this_iter": 7418, "num_env_steps_sampled_throughput_per_sec": 196.0656156167946, "num_env_steps_trained_throughput_per_sec": 196.0656156167946, "timesteps_total": 1044749, "num_steps_trained_this_iter": 7418, "agent_timesteps_total": 1044749, "timers": {"training_iteration_time_ms": 48769.466, "sample_time_ms": 33844.328, "load_time_ms": 1425.307, "load_throughput": 7165.335, "learn_time_ms": 12939.348, "learn_throughput": 789.282, "synch_weights_time_ms": 479.667}, "counters": {"num_env_steps_sampled": 1044749, "num_env_steps_trained": 1044749, "num_agent_steps_sampled": 1044749, "num_agent_steps_trained": 1044749}, "done": false, "episodes_total": 1572, "training_iteration": 112, "trial_id": "32ccc_00000", "date": "2025-06-07_13-28-09", "timestamp": 1749295689, "time_this_iter_s": 37.88426351547241, "time_total_s": 5205.842497587204, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5205.842497587204, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 53.408695652173904, "ram_util_percent": 86.33260869565218, "gpu_util_percent0": 0.06347826086956522, "vram_util_percent0": 0.9650065104166663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 8.955251000000002e-05, "total_loss": -0.10137876652210871, "policy_loss": -0.03958363521576641, "vf_loss": 0.044249209166167584, "vf_explained_var": 0.8522121779462124, "kl": 0.014729641271918911, "entropy": 15.591530958135078, "entropy_coeff": 0.0049328765}, "model": {}, "num_grad_updates_lifetime": 37075.5, "diff_num_grad_updates_vs_sampler_policy": 234.5}}, "num_env_steps_sampled": 1057921, "num_env_steps_trained": 1057921, "num_agent_steps_sampled": 1057921, "num_agent_steps_trained": 1057921}, "sampler_results": {"episode_reward_max": 139.3085555498888, "episode_reward_min": -60.744130475064225, "episode_reward_mean": 45.83375687060012, "episode_len_mean": 747.1, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [81.16178659073702, 26.496335304471252, 39.43011942176073, 25.980319601145766, 27.95130473071699, 72.72556867779957, 10.582046961765533, 105.40994473537422, 89.66745831099317, 40.17430763555466, 47.51487744238394, 19.262674081470603, 18.180309692842496, 129.71200153031268, 16.61471045586378, 108.19448801663093, 15.053478138385213, 19.71539079879199, 17.353387104096708, 92.51529574761678, 18.467537468585014, 18.806666400551297, 22.469765198718953, 40.53787563956489, 29.503973503851526, 32.19142199852806, 16.62723418937411, 98.37350967442926, 13.81272246643792, 97.08080329211836, 16.947737050699264, -60.744130475064225, 56.26479111319336, 85.17292005271239, 19.31547829889945, 17.447629348453976, 20.41019997002698, 50.91552563153769, 17.412131108950675, 11.311900106673324, 83.18111621329709, 23.511750728717484, 41.54974336342521, 14.735330393940533, 18.84407372615985, 20.563156087784872, -3.102249269074065, 108.21728227371258, 25.809916274881363, 95.28221382980912, 76.36469288946749, 52.60443570279186, 110.78293210939404, 15.433791867197879, 78.07811709056833, 51.08086034866168, 16.89218127504045, 49.19547544810929, 102.60230468391129, 56.98872653592099, 15.1361541194205, 67.73858892124662, 17.655788255792924, 84.01118250236135, 29.277764998662438, -13.948945272419317, 19.409231566496835, 36.06500068381699, 15.142955173452467, 59.01856883709531, 18.046118166261806, 17.34522134246045, 23.333990025904942, 21.49476455716504, 12.626850706790641, 23.655406133667803, 19.38131506340076, 81.7914185834965, 99.43403645038046, 13.876584485188127, 57.273851404416895, 19.03763667880425, 11.827566077258936, 15.627142331857751, 17.237831893089297, 14.725837135020564, 111.32620543106877, 26.055322327572206, 13.658548571163385, 121.52311421589553, 41.23261446717519, 18.01216807126844, 139.3085555498888, 89.79010164152156, 121.47518049357016, 94.51054789746321, 102.8901631898898, 115.3992839630005, 38.85377142944004, 88.48090039933032], "episode_lengths": [1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 295, 1117, 295, 295, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.133443473134892, "mean_inference_ms": 6.854622740498339, "mean_action_processing_ms": 0.4733187348894185, "mean_env_wait_ms": 20.665529064317333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027744770050048828, "StateBufferConnector_ms": 0.011298418045043945, "ViewRequirementAgentConnector_ms": 0.8503155708312988}}, "episode_reward_max": 139.3085555498888, "episode_reward_min": -60.744130475064225, "episode_reward_mean": 45.83375687060012, "episode_len_mean": 747.1, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [81.16178659073702, 26.496335304471252, 39.43011942176073, 25.980319601145766, 27.95130473071699, 72.72556867779957, 10.582046961765533, 105.40994473537422, 89.66745831099317, 40.17430763555466, 47.51487744238394, 19.262674081470603, 18.180309692842496, 129.71200153031268, 16.61471045586378, 108.19448801663093, 15.053478138385213, 19.71539079879199, 17.353387104096708, 92.51529574761678, 18.467537468585014, 18.806666400551297, 22.469765198718953, 40.53787563956489, 29.503973503851526, 32.19142199852806, 16.62723418937411, 98.37350967442926, 13.81272246643792, 97.08080329211836, 16.947737050699264, -60.744130475064225, 56.26479111319336, 85.17292005271239, 19.31547829889945, 17.447629348453976, 20.41019997002698, 50.91552563153769, 17.412131108950675, 11.311900106673324, 83.18111621329709, 23.511750728717484, 41.54974336342521, 14.735330393940533, 18.84407372615985, 20.563156087784872, -3.102249269074065, 108.21728227371258, 25.809916274881363, 95.28221382980912, 76.36469288946749, 52.60443570279186, 110.78293210939404, 15.433791867197879, 78.07811709056833, 51.08086034866168, 16.89218127504045, 49.19547544810929, 102.60230468391129, 56.98872653592099, 15.1361541194205, 67.73858892124662, 17.655788255792924, 84.01118250236135, 29.277764998662438, -13.948945272419317, 19.409231566496835, 36.06500068381699, 15.142955173452467, 59.01856883709531, 18.046118166261806, 17.34522134246045, 23.333990025904942, 21.49476455716504, 12.626850706790641, 23.655406133667803, 19.38131506340076, 81.7914185834965, 99.43403645038046, 13.876584485188127, 57.273851404416895, 19.03763667880425, 11.827566077258936, 15.627142331857751, 17.237831893089297, 14.725837135020564, 111.32620543106877, 26.055322327572206, 13.658548571163385, 121.52311421589553, 41.23261446717519, 18.01216807126844, 139.3085555498888, 89.79010164152156, 121.47518049357016, 94.51054789746321, 102.8901631898898, 115.3992839630005, 38.85377142944004, 88.48090039933032], "episode_lengths": [1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 295, 295, 1117, 295, 295, 1117, 295, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 295, 1117, 295, 295, 295, 295, 1117, 1117, 295, 1117, 295, 295, 295, 295, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.133443473134892, "mean_inference_ms": 6.854622740498339, "mean_action_processing_ms": 0.4733187348894185, "mean_env_wait_ms": 20.665529064317333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027744770050048828, "StateBufferConnector_ms": 0.011298418045043945, "ViewRequirementAgentConnector_ms": 0.8503155708312988}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1057921, "num_agent_steps_trained": 1057921, "num_env_steps_sampled": 1057921, "num_env_steps_trained": 1057921, "num_env_steps_sampled_this_iter": 13172, "num_env_steps_trained_this_iter": 13172, "num_env_steps_sampled_throughput_per_sec": 226.87227452560148, "num_env_steps_trained_throughput_per_sec": 226.87227452560148, "timesteps_total": 1057921, "num_steps_trained_this_iter": 13172, "agent_timesteps_total": 1057921, "timers": {"training_iteration_time_ms": 49676.618, "sample_time_ms": 34273.306, "load_time_ms": 1483.96, "load_throughput": 7103.698, "learn_time_ms": 13360.4, "learn_throughput": 789.018, "synch_weights_time_ms": 473.662}, "counters": {"num_env_steps_sampled": 1057921, "num_env_steps_trained": 1057921, "num_agent_steps_sampled": 1057921, "num_agent_steps_trained": 1057921}, "done": false, "episodes_total": 1586, "training_iteration": 113, "trial_id": "32ccc_00000", "date": "2025-06-07_13-29-07", "timestamp": 1749295747, "time_this_iter_s": 58.07810401916504, "time_total_s": 5263.920601606369, "pid": 103892, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002E45001F640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5263.920601606369, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 65.33880597014924, "ram_util_percent": 88.47164179104477, "gpu_util_percent0": 0.19582089552238804, "vram_util_percent0": 0.9650065104166667}}
