{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09375, "cur_lr": 0.00010000000000000002, "total_loss": -0.1551042988422242, "policy_loss": 0.015721428445302246, "vf_loss": 0.07367344649677927, "vf_explained_var": 0.40422521298581904, "kl": 0.12656364610759943, "entropy": 20.479311162775215, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5381558, "num_env_steps_trained": 5381558, "num_agent_steps_sampled": 5381558, "num_agent_steps_trained": 5381558}, "sampler_results": {"episode_reward_max": 11.244997666131477, "episode_reward_min": 1.7463087404911926, "episode_reward_mean": 5.49882788455107, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.998056074203013, 3.1043528982585324, 6.815582989184383, 11.244997666131477, 5.439533167578824, 6.462272371283426, 4.91205496082248, 6.8974046867659355, 1.7463087404911926, 8.36063813778793, 2.1849769666002996, 4.221521283806634, 6.2774803705997275, 6.3184100702011206], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7647562993325265, "mean_inference_ms": 7.962746721321807, "mean_action_processing_ms": 0.5467022711317343, "mean_env_wait_ms": 24.25375141330975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00736032213483538, "StateBufferConnector_ms": 0.05727325166974749, "ViewRequirementAgentConnector_ms": 1.0856969015938895}}, "episode_reward_max": 11.244997666131477, "episode_reward_min": 1.7463087404911926, "episode_reward_mean": 5.49882788455107, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.998056074203013, 3.1043528982585324, 6.815582989184383, 11.244997666131477, 5.439533167578824, 6.462272371283426, 4.91205496082248, 6.8974046867659355, 1.7463087404911926, 8.36063813778793, 2.1849769666002996, 4.221521283806634, 6.2774803705997275, 6.3184100702011206], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7647562993325265, "mean_inference_ms": 7.962746721321807, "mean_action_processing_ms": 0.5467022711317343, "mean_env_wait_ms": 24.25375141330975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00736032213483538, "StateBufferConnector_ms": 0.05727325166974749, "ViewRequirementAgentConnector_ms": 1.0856969015938895}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5381558, "num_agent_steps_trained": 5381558, "num_env_steps_sampled": 5381558, "num_env_steps_trained": 5381558, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 276.72023459713756, "num_env_steps_trained_throughput_per_sec": 276.72023459713756, "timesteps_total": 5381558, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5381558, "timers": {"training_iteration_time_ms": 56511.95, "sample_time_ms": 42342.939, "load_time_ms": 2766.006, "load_throughput": 5653.64, "learn_time_ms": 10817.669, "learn_throughput": 1445.598, "synch_weights_time_ms": 465.77}, "counters": {"num_env_steps_sampled": 5381558, "num_env_steps_trained": 5381558, "num_agent_steps_sampled": 5381558, "num_agent_steps_trained": 5381558}, "done": false, "episodes_total": 14, "training_iteration": 349, "trial_id": "2f030_00000", "date": "2025-06-07_07-37-15", "timestamp": 1749274635, "time_this_iter_s": 56.52995753288269, "time_total_s": 56.52995753288269, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 56.52995753288269, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 74.8969696969697, "ram_util_percent": 63.446969696969695, "gpu_util_percent0": 0.07166666666666666, "vram_util_percent0": 0.12721946022727273}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3.3318507963534434, "episode_reward_min": -8.3472136044399, "episode_reward_mean": -5.517728770943213, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.639218362858786, -4.324610719469447, -8.3472136044399, -3.3318507963534434, -4.945750371594488], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.705543743800392, "mean_inference_ms": 4.0710050042366746, "mean_action_processing_ms": 0.3069125350471687, "mean_env_wait_ms": 11.82888902877493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04010200500488281, "StateBufferConnector_ms": 0.020384788513183594, "ViewRequirementAgentConnector_ms": 0.07981300354003906}}, "episode_reward_max": -3.3318507963534434, "episode_reward_min": -8.3472136044399, "episode_reward_mean": -5.517728770943213, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.639218362858786, -4.324610719469447, -8.3472136044399, -3.3318507963534434, -4.945750371594488], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.705543743800392, "mean_inference_ms": 4.0710050042366746, "mean_action_processing_ms": 0.3069125350471687, "mean_env_wait_ms": 11.82888902877493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04010200500488281, "StateBufferConnector_ms": 0.020384788513183594, "ViewRequirementAgentConnector_ms": 0.07981300354003906}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.140625, "cur_lr": 5.6600338709677405e-05, "total_loss": -0.10358457547316158, "policy_loss": -0.010730806769094091, "vf_loss": 0.046518446552482516, "vf_explained_var": 0.47617015849460254, "kl": 0.06759275368968146, "entropy": 20.55014859633012, "entropy_coeff": 0.0056600338709677425}, "model": {}, "num_grad_updates_lifetime": 825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5397196, "num_env_steps_trained": 5397196, "num_agent_steps_sampled": 5397196, "num_agent_steps_trained": 5397196}, "sampler_results": {"episode_reward_max": 11.244997666131477, "episode_reward_min": 1.341895420321228, "episode_reward_mean": 5.454467566869986, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.998056074203013, 3.1043528982585324, 6.815582989184383, 11.244997666131477, 5.439533167578824, 6.462272371283426, 4.91205496082248, 6.8974046867659355, 1.7463087404911926, 8.36063813778793, 2.1849769666002996, 4.221521283806634, 6.2774803705997275, 6.3184100702011206, 5.803635491370871, 4.191337301137139, 3.7491215854821864, 5.371360571098304, 7.060112079663207, 7.438260007400526, 4.978290378306663, 8.269563856981565, 3.5338734479104694, 5.325687785332021, 6.423522319509915, 1.341895420321228, 6.418827042350532, 5.836014201779977], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.870710522431029, "mean_inference_ms": 7.961911202978354, "mean_action_processing_ms": 0.5425484179028742, "mean_env_wait_ms": 24.058014760226364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035690409796578546, "StateBufferConnector_ms": 0.03916961806161063, "ViewRequirementAgentConnector_ms": 1.071958030973162}}, "episode_reward_max": 11.244997666131477, "episode_reward_min": 1.341895420321228, "episode_reward_mean": 5.454467566869986, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.998056074203013, 3.1043528982585324, 6.815582989184383, 11.244997666131477, 5.439533167578824, 6.462272371283426, 4.91205496082248, 6.8974046867659355, 1.7463087404911926, 8.36063813778793, 2.1849769666002996, 4.221521283806634, 6.2774803705997275, 6.3184100702011206, 5.803635491370871, 4.191337301137139, 3.7491215854821864, 5.371360571098304, 7.060112079663207, 7.438260007400526, 4.978290378306663, 8.269563856981565, 3.5338734479104694, 5.325687785332021, 6.423522319509915, 1.341895420321228, 6.418827042350532, 5.836014201779977], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.870710522431029, "mean_inference_ms": 7.961911202978354, "mean_action_processing_ms": 0.5425484179028742, "mean_env_wait_ms": 24.058014760226364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035690409796578546, "StateBufferConnector_ms": 0.03916961806161063, "ViewRequirementAgentConnector_ms": 1.071958030973162}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5397196, "num_agent_steps_trained": 5397196, "num_env_steps_sampled": 5397196, "num_env_steps_trained": 5397196, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 275.3509997157304, "num_env_steps_trained_throughput_per_sec": 275.3509997157304, "timesteps_total": 5397196, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5397196, "timers": {"training_iteration_time_ms": 56652.458, "sample_time_ms": 41983.392, "load_time_ms": 2253.379, "load_throughput": 6939.799, "learn_time_ms": 11742.074, "learn_throughput": 1331.792, "synch_weights_time_ms": 535.273}, "counters": {"num_env_steps_sampled": 5397196, "num_env_steps_trained": 5397196, "num_agent_steps_sampled": 5397196, "num_agent_steps_trained": 5397196}, "done": false, "episodes_total": 28, "training_iteration": 350, "trial_id": "2f030_00000", "date": "2025-06-07_07-38-29", "timestamp": 1749274709, "time_this_iter_s": 73.51069784164429, "time_total_s": 130.04065537452698, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 130.04065537452698, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 65.79186046511627, "ram_util_percent": 70.5941860465116, "gpu_util_percent0": 0.06918604651162791, "vram_util_percent0": 0.6306511930717056}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2109375, "cur_lr": 5.64742258064516e-05, "total_loss": -0.1185235681685365, "policy_loss": -0.021717895066937092, "vf_loss": 0.033086458734151995, "vf_explained_var": 0.49078111496838656, "kl": 0.0457353373325031, "entropy": 20.607436974265358, "entropy_coeff": 0.005647422580645163}, "model": {}, "num_grad_updates_lifetime": 1375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5412834, "num_env_steps_trained": 5412834, "num_agent_steps_sampled": 5412834, "num_agent_steps_trained": 5412834}, "sampler_results": {"episode_reward_max": 11.244997666131477, "episode_reward_min": 1.341895420321228, "episode_reward_mean": 5.721300820128901, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.998056074203013, 3.1043528982585324, 6.815582989184383, 11.244997666131477, 5.439533167578824, 6.462272371283426, 4.91205496082248, 6.8974046867659355, 1.7463087404911926, 8.36063813778793, 2.1849769666002996, 4.221521283806634, 6.2774803705997275, 6.3184100702011206, 5.803635491370871, 4.191337301137139, 3.7491215854821864, 5.371360571098304, 7.060112079663207, 7.438260007400526, 4.978290378306663, 8.269563856981565, 3.5338734479104694, 5.325687785332021, 6.423522319509915, 1.341895420321228, 6.418827042350532, 5.836014201779977, 7.325249281895349, 9.636956965741408, 5.848710596276518, 4.816098705082098, 6.108087052264357, 9.150712840284427, 5.401483200901139, 6.570165132970069, 6.893495018917494, 7.960537501970593, 4.805336893464921, 3.335720722827586, 4.438413384499795, 5.27857527595849], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.939632985871231, "mean_inference_ms": 8.014669106064275, "mean_action_processing_ms": 0.5458754212196525, "mean_env_wait_ms": 24.15725495397676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040545350029355005, "StateBufferConnector_ms": 0.02611307870774042, "ViewRequirementAgentConnector_ms": 1.0121050335112072}}, "episode_reward_max": 11.244997666131477, "episode_reward_min": 1.341895420321228, "episode_reward_mean": 5.721300820128901, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.998056074203013, 3.1043528982585324, 6.815582989184383, 11.244997666131477, 5.439533167578824, 6.462272371283426, 4.91205496082248, 6.8974046867659355, 1.7463087404911926, 8.36063813778793, 2.1849769666002996, 4.221521283806634, 6.2774803705997275, 6.3184100702011206, 5.803635491370871, 4.191337301137139, 3.7491215854821864, 5.371360571098304, 7.060112079663207, 7.438260007400526, 4.978290378306663, 8.269563856981565, 3.5338734479104694, 5.325687785332021, 6.423522319509915, 1.341895420321228, 6.418827042350532, 5.836014201779977, 7.325249281895349, 9.636956965741408, 5.848710596276518, 4.816098705082098, 6.108087052264357, 9.150712840284427, 5.401483200901139, 6.570165132970069, 6.893495018917494, 7.960537501970593, 4.805336893464921, 3.335720722827586, 4.438413384499795, 5.27857527595849], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.939632985871231, "mean_inference_ms": 8.014669106064275, "mean_action_processing_ms": 0.5458754212196525, "mean_env_wait_ms": 24.15725495397676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040545350029355005, "StateBufferConnector_ms": 0.02611307870774042, "ViewRequirementAgentConnector_ms": 1.0121050335112072}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5412834, "num_agent_steps_trained": 5412834, "num_env_steps_sampled": 5412834, "num_env_steps_trained": 5412834, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 271.92262372159405, "num_env_steps_trained_throughput_per_sec": 271.92262372159405, "timesteps_total": 5412834, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5412834, "timers": {"training_iteration_time_ms": 56937.974, "sample_time_ms": 42701.486, "load_time_ms": 2078.1, "load_throughput": 7525.144, "learn_time_ms": 11537.575, "learn_throughput": 1355.397, "synch_weights_time_ms": 496.414}, "counters": {"num_env_steps_sampled": 5412834, "num_env_steps_trained": 5412834, "num_agent_steps_sampled": 5412834, "num_agent_steps_trained": 5412834}, "done": false, "episodes_total": 42, "training_iteration": 351, "trial_id": "2f030_00000", "date": "2025-06-07_07-39-26", "timestamp": 1749274766, "time_this_iter_s": 57.519007444381714, "time_total_s": 187.5596628189087, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 187.5596628189087, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 78.12615384615384, "ram_util_percent": 70.11846153846155, "gpu_util_percent0": 0.07246153846153847, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.31640625, "cur_lr": 5.6348112903225814e-05, "total_loss": -0.11472852356393229, "policy_loss": -0.018690526066063532, "vf_loss": 0.026901847039434042, "vf_explained_var": 0.5458360680666837, "kl": 0.0393096763452261, "entropy": 20.683279975544323, "entropy_coeff": 0.005634811290322581}, "model": {}, "num_grad_updates_lifetime": 1925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5428472, "num_env_steps_trained": 5428472, "num_agent_steps_sampled": 5428472, "num_agent_steps_trained": 5428472}, "sampler_results": {"episode_reward_max": 11.244997666131477, "episode_reward_min": 1.0036113285551473, "episode_reward_mean": 5.644619369806986, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.998056074203013, 3.1043528982585324, 6.815582989184383, 11.244997666131477, 5.439533167578824, 6.462272371283426, 4.91205496082248, 6.8974046867659355, 1.7463087404911926, 8.36063813778793, 2.1849769666002996, 4.221521283806634, 6.2774803705997275, 6.3184100702011206, 5.803635491370871, 4.191337301137139, 3.7491215854821864, 5.371360571098304, 7.060112079663207, 7.438260007400526, 4.978290378306663, 8.269563856981565, 3.5338734479104694, 5.325687785332021, 6.423522319509915, 1.341895420321228, 6.418827042350532, 5.836014201779977, 7.325249281895349, 9.636956965741408, 5.848710596276518, 4.816098705082098, 6.108087052264357, 9.150712840284427, 5.401483200901139, 6.570165132970069, 6.893495018917494, 7.960537501970593, 4.805336893464921, 3.335720722827586, 4.438413384499795, 5.27857527595849, 8.772855391599354, 7.823587674330493, 5.72508644769574, 8.269100404746563, 1.0036113285551473, 1.3249628198031598, 5.649834641835296, 6.1586062163782085, 6.303052510994767, 4.109955894974139, 4.401462737948447, 7.460376612707664, 5.39594085507637, 3.4056167271320423], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.971409691779505, "mean_inference_ms": 8.029702260009485, "mean_action_processing_ms": 0.5459443078328945, "mean_env_wait_ms": 24.17586605974833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03752708435058594, "StateBufferConnector_ms": 0.028596179825919017, "ViewRequirementAgentConnector_ms": 0.9556923593793597}}, "episode_reward_max": 11.244997666131477, "episode_reward_min": 1.0036113285551473, "episode_reward_mean": 5.644619369806986, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.998056074203013, 3.1043528982585324, 6.815582989184383, 11.244997666131477, 5.439533167578824, 6.462272371283426, 4.91205496082248, 6.8974046867659355, 1.7463087404911926, 8.36063813778793, 2.1849769666002996, 4.221521283806634, 6.2774803705997275, 6.3184100702011206, 5.803635491370871, 4.191337301137139, 3.7491215854821864, 5.371360571098304, 7.060112079663207, 7.438260007400526, 4.978290378306663, 8.269563856981565, 3.5338734479104694, 5.325687785332021, 6.423522319509915, 1.341895420321228, 6.418827042350532, 5.836014201779977, 7.325249281895349, 9.636956965741408, 5.848710596276518, 4.816098705082098, 6.108087052264357, 9.150712840284427, 5.401483200901139, 6.570165132970069, 6.893495018917494, 7.960537501970593, 4.805336893464921, 3.335720722827586, 4.438413384499795, 5.27857527595849, 8.772855391599354, 7.823587674330493, 5.72508644769574, 8.269100404746563, 1.0036113285551473, 1.3249628198031598, 5.649834641835296, 6.1586062163782085, 6.303052510994767, 4.109955894974139, 4.401462737948447, 7.460376612707664, 5.39594085507637, 3.4056167271320423], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.971409691779505, "mean_inference_ms": 8.029702260009485, "mean_action_processing_ms": 0.5459443078328945, "mean_env_wait_ms": 24.17586605974833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03752708435058594, "StateBufferConnector_ms": 0.028596179825919017, "ViewRequirementAgentConnector_ms": 0.9556923593793597}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5428472, "num_agent_steps_trained": 5428472, "num_env_steps_sampled": 5428472, "num_env_steps_trained": 5428472, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.08439765726916, "num_env_steps_trained_throughput_per_sec": 285.08439765726916, "timesteps_total": 5428472, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5428472, "timers": {"training_iteration_time_ms": 56416.964, "sample_time_ms": 42447.383, "load_time_ms": 1945.057, "load_throughput": 8039.868, "learn_time_ms": 11335.857, "learn_throughput": 1379.516, "synch_weights_time_ms": 558.223}, "counters": {"num_env_steps_sampled": 5428472, "num_env_steps_trained": 5428472, "num_agent_steps_sampled": 5428472, "num_agent_steps_trained": 5428472}, "done": false, "episodes_total": 56, "training_iteration": 352, "trial_id": "2f030_00000", "date": "2025-06-07_07-40-21", "timestamp": 1749274821, "time_this_iter_s": 54.87391138076782, "time_total_s": 242.4335741996765, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 242.4335741996765, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 75.93437499999999, "ram_util_percent": 70.2125, "gpu_util_percent0": 0.07796875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.474609375, "cur_lr": 5.622199999999999e-05, "total_loss": -0.1127483430267735, "policy_loss": -0.018378042769195004, "vf_loss": 0.023180779012089425, "vf_explained_var": 0.5437725475701419, "kl": 0.031673815037493086, "entropy": 20.696030054959383, "entropy_coeff": 0.005622200000000001}, "model": {}, "num_grad_updates_lifetime": 2475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5444110, "num_env_steps_trained": 5444110, "num_agent_steps_sampled": 5444110, "num_agent_steps_trained": 5444110}, "sampler_results": {"episode_reward_max": 11.244997666131477, "episode_reward_min": 1.0036113285551473, "episode_reward_mean": 5.719069229726306, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.998056074203013, 3.1043528982585324, 6.815582989184383, 11.244997666131477, 5.439533167578824, 6.462272371283426, 4.91205496082248, 6.8974046867659355, 1.7463087404911926, 8.36063813778793, 2.1849769666002996, 4.221521283806634, 6.2774803705997275, 6.3184100702011206, 5.803635491370871, 4.191337301137139, 3.7491215854821864, 5.371360571098304, 7.060112079663207, 7.438260007400526, 4.978290378306663, 8.269563856981565, 3.5338734479104694, 5.325687785332021, 6.423522319509915, 1.341895420321228, 6.418827042350532, 5.836014201779977, 7.325249281895349, 9.636956965741408, 5.848710596276518, 4.816098705082098, 6.108087052264357, 9.150712840284427, 5.401483200901139, 6.570165132970069, 6.893495018917494, 7.960537501970593, 4.805336893464921, 3.335720722827586, 4.438413384499795, 5.27857527595849, 8.772855391599354, 7.823587674330493, 5.72508644769574, 8.269100404746563, 1.0036113285551473, 1.3249628198031598, 5.649834641835296, 6.1586062163782085, 6.303052510994767, 4.109955894974139, 4.401462737948447, 7.460376612707664, 5.39594085507637, 3.4056167271320423, 7.166062472739148, 1.195157655132488, 2.249788987655396, 4.285810020985186, 4.904083042425305, 6.574739491241937, 8.735623762261534, 8.913175913854841, 5.6000149506074015, 7.596762485735814, 5.020224296291765, 5.536300186186111, 9.600813243714478, 6.857604862818799], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.990576887394684, "mean_inference_ms": 8.029512586980045, "mean_action_processing_ms": 0.5447573303421928, "mean_env_wait_ms": 24.148645249211217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033271653311593194, "StateBufferConnector_ms": 0.031129973275320872, "ViewRequirementAgentConnector_ms": 0.9396083014351981}}, "episode_reward_max": 11.244997666131477, "episode_reward_min": 1.0036113285551473, "episode_reward_mean": 5.719069229726306, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.998056074203013, 3.1043528982585324, 6.815582989184383, 11.244997666131477, 5.439533167578824, 6.462272371283426, 4.91205496082248, 6.8974046867659355, 1.7463087404911926, 8.36063813778793, 2.1849769666002996, 4.221521283806634, 6.2774803705997275, 6.3184100702011206, 5.803635491370871, 4.191337301137139, 3.7491215854821864, 5.371360571098304, 7.060112079663207, 7.438260007400526, 4.978290378306663, 8.269563856981565, 3.5338734479104694, 5.325687785332021, 6.423522319509915, 1.341895420321228, 6.418827042350532, 5.836014201779977, 7.325249281895349, 9.636956965741408, 5.848710596276518, 4.816098705082098, 6.108087052264357, 9.150712840284427, 5.401483200901139, 6.570165132970069, 6.893495018917494, 7.960537501970593, 4.805336893464921, 3.335720722827586, 4.438413384499795, 5.27857527595849, 8.772855391599354, 7.823587674330493, 5.72508644769574, 8.269100404746563, 1.0036113285551473, 1.3249628198031598, 5.649834641835296, 6.1586062163782085, 6.303052510994767, 4.109955894974139, 4.401462737948447, 7.460376612707664, 5.39594085507637, 3.4056167271320423, 7.166062472739148, 1.195157655132488, 2.249788987655396, 4.285810020985186, 4.904083042425305, 6.574739491241937, 8.735623762261534, 8.913175913854841, 5.6000149506074015, 7.596762485735814, 5.020224296291765, 5.536300186186111, 9.600813243714478, 6.857604862818799], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.990576887394684, "mean_inference_ms": 8.029512586980045, "mean_action_processing_ms": 0.5447573303421928, "mean_env_wait_ms": 24.148645249211217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033271653311593194, "StateBufferConnector_ms": 0.031129973275320872, "ViewRequirementAgentConnector_ms": 0.9396083014351981}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5444110, "num_agent_steps_trained": 5444110, "num_env_steps_sampled": 5444110, "num_env_steps_trained": 5444110, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 289.42985600571956, "num_env_steps_trained_throughput_per_sec": 289.42985600571956, "timesteps_total": 5444110, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5444110, "timers": {"training_iteration_time_ms": 55939.443, "sample_time_ms": 42143.109, "load_time_ms": 1890.435, "load_throughput": 8272.169, "learn_time_ms": 11245.331, "learn_throughput": 1390.622, "synch_weights_time_ms": 533.908}, "counters": {"num_env_steps_sampled": 5444110, "num_env_steps_trained": 5444110, "num_agent_steps_sampled": 5444110, "num_agent_steps_trained": 5444110}, "done": false, "episodes_total": 70, "training_iteration": 353, "trial_id": "2f030_00000", "date": "2025-06-07_07-41-16", "timestamp": 1749274876, "time_this_iter_s": 54.04688858985901, "time_total_s": 296.4804627895355, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 296.4804627895355, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 77.14677419354841, "ram_util_percent": 70.3193548387097, "gpu_util_percent0": 0.07967741935483871, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.6095887096774216e-05, "total_loss": -0.11203183181075888, "policy_loss": -0.02217805178100455, "vf_loss": 0.02345435705035925, "vf_explained_var": 0.5828297592293132, "kl": 0.027107781445480546, "entropy": 20.712480656016957, "entropy_coeff": 0.0056095887096774205}, "model": {}, "num_grad_updates_lifetime": 3025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5459748, "num_env_steps_trained": 5459748, "num_agent_steps_sampled": 5459748, "num_agent_steps_trained": 5459748}, "sampler_results": {"episode_reward_max": 11.244997666131477, "episode_reward_min": 1.0036113285551473, "episode_reward_mean": 5.634753391274883, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.998056074203013, 3.1043528982585324, 6.815582989184383, 11.244997666131477, 5.439533167578824, 6.462272371283426, 4.91205496082248, 6.8974046867659355, 1.7463087404911926, 8.36063813778793, 2.1849769666002996, 4.221521283806634, 6.2774803705997275, 6.3184100702011206, 5.803635491370871, 4.191337301137139, 3.7491215854821864, 5.371360571098304, 7.060112079663207, 7.438260007400526, 4.978290378306663, 8.269563856981565, 3.5338734479104694, 5.325687785332021, 6.423522319509915, 1.341895420321228, 6.418827042350532, 5.836014201779977, 7.325249281895349, 9.636956965741408, 5.848710596276518, 4.816098705082098, 6.108087052264357, 9.150712840284427, 5.401483200901139, 6.570165132970069, 6.893495018917494, 7.960537501970593, 4.805336893464921, 3.335720722827586, 4.438413384499795, 5.27857527595849, 8.772855391599354, 7.823587674330493, 5.72508644769574, 8.269100404746563, 1.0036113285551473, 1.3249628198031598, 5.649834641835296, 6.1586062163782085, 6.303052510994767, 4.109955894974139, 4.401462737948447, 7.460376612707664, 5.39594085507637, 3.4056167271320423, 7.166062472739148, 1.195157655132488, 2.249788987655396, 4.285810020985186, 4.904083042425305, 6.574739491241937, 8.735623762261534, 8.913175913854841, 5.6000149506074015, 7.596762485735814, 5.020224296291765, 5.536300186186111, 9.600813243714478, 6.857604862818799, 1.4467868928258185, 9.334244991915565, 3.1739150146640887, 1.869149793637164, 7.131501293319314, 2.052365152484057, 8.732847624523364, 3.002658686390335, 5.592986060243556, 7.3341412962680765, 4.962247878542253, 6.246274498802693, 5.155581667035112, 6.949737935597287], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0082778543900366, "mean_inference_ms": 8.02177973835854, "mean_action_processing_ms": 0.5433660627650562, "mean_env_wait_ms": 24.10969556223414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0410045896257673, "StateBufferConnector_ms": 0.03441061292375837, "ViewRequirementAgentConnector_ms": 0.9108046690622965}}, "episode_reward_max": 11.244997666131477, "episode_reward_min": 1.0036113285551473, "episode_reward_mean": 5.634753391274883, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.998056074203013, 3.1043528982585324, 6.815582989184383, 11.244997666131477, 5.439533167578824, 6.462272371283426, 4.91205496082248, 6.8974046867659355, 1.7463087404911926, 8.36063813778793, 2.1849769666002996, 4.221521283806634, 6.2774803705997275, 6.3184100702011206, 5.803635491370871, 4.191337301137139, 3.7491215854821864, 5.371360571098304, 7.060112079663207, 7.438260007400526, 4.978290378306663, 8.269563856981565, 3.5338734479104694, 5.325687785332021, 6.423522319509915, 1.341895420321228, 6.418827042350532, 5.836014201779977, 7.325249281895349, 9.636956965741408, 5.848710596276518, 4.816098705082098, 6.108087052264357, 9.150712840284427, 5.401483200901139, 6.570165132970069, 6.893495018917494, 7.960537501970593, 4.805336893464921, 3.335720722827586, 4.438413384499795, 5.27857527595849, 8.772855391599354, 7.823587674330493, 5.72508644769574, 8.269100404746563, 1.0036113285551473, 1.3249628198031598, 5.649834641835296, 6.1586062163782085, 6.303052510994767, 4.109955894974139, 4.401462737948447, 7.460376612707664, 5.39594085507637, 3.4056167271320423, 7.166062472739148, 1.195157655132488, 2.249788987655396, 4.285810020985186, 4.904083042425305, 6.574739491241937, 8.735623762261534, 8.913175913854841, 5.6000149506074015, 7.596762485735814, 5.020224296291765, 5.536300186186111, 9.600813243714478, 6.857604862818799, 1.4467868928258185, 9.334244991915565, 3.1739150146640887, 1.869149793637164, 7.131501293319314, 2.052365152484057, 8.732847624523364, 3.002658686390335, 5.592986060243556, 7.3341412962680765, 4.962247878542253, 6.246274498802693, 5.155581667035112, 6.949737935597287], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0082778543900366, "mean_inference_ms": 8.02177973835854, "mean_action_processing_ms": 0.5433660627650562, "mean_env_wait_ms": 24.10969556223414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0410045896257673, "StateBufferConnector_ms": 0.03441061292375837, "ViewRequirementAgentConnector_ms": 0.9108046690622965}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5459748, "num_agent_steps_trained": 5459748, "num_env_steps_sampled": 5459748, "num_env_steps_trained": 5459748, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 292.3614241452192, "num_env_steps_trained_throughput_per_sec": 292.3614241452192, "timesteps_total": 5459748, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5459748, "timers": {"training_iteration_time_ms": 55530.967, "sample_time_ms": 41920.401, "load_time_ms": 1831.751, "load_throughput": 8537.188, "learn_time_ms": 11143.872, "learn_throughput": 1403.282, "synch_weights_time_ms": 511.631}, "counters": {"num_env_steps_sampled": 5459748, "num_env_steps_trained": 5459748, "num_agent_steps_sampled": 5459748, "num_agent_steps_trained": 5459748}, "done": false, "episodes_total": 84, "training_iteration": 354, "trial_id": "2f030_00000", "date": "2025-06-07_07-42-09", "timestamp": 1749274929, "time_this_iter_s": 53.50312304496765, "time_total_s": 349.9835858345032, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 349.9835858345032, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 78.14918032786886, "ram_util_percent": 70.39836065573769, "gpu_util_percent0": 0.07934426229508199, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.5969774193548393e-05, "total_loss": -0.10281023052267053, "policy_loss": -0.012417530585764986, "vf_loss": 0.021037702562118118, "vf_explained_var": 0.6356354640830647, "kl": 0.026660059957042365, "entropy": 20.668957034024324, "entropy_coeff": 0.005596977419354838}, "model": {}, "num_grad_updates_lifetime": 3575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5475386, "num_env_steps_trained": 5475386, "num_agent_steps_sampled": 5475386, "num_agent_steps_trained": 5475386}, "sampler_results": {"episode_reward_max": 11.244997666131477, "episode_reward_min": 1.0036113285551473, "episode_reward_mean": 5.5494071241822445, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.998056074203013, 3.1043528982585324, 6.815582989184383, 11.244997666131477, 5.439533167578824, 6.462272371283426, 4.91205496082248, 6.8974046867659355, 1.7463087404911926, 8.36063813778793, 2.1849769666002996, 4.221521283806634, 6.2774803705997275, 6.3184100702011206, 5.803635491370871, 4.191337301137139, 3.7491215854821864, 5.371360571098304, 7.060112079663207, 7.438260007400526, 4.978290378306663, 8.269563856981565, 3.5338734479104694, 5.325687785332021, 6.423522319509915, 1.341895420321228, 6.418827042350532, 5.836014201779977, 7.325249281895349, 9.636956965741408, 5.848710596276518, 4.816098705082098, 6.108087052264357, 9.150712840284427, 5.401483200901139, 6.570165132970069, 6.893495018917494, 7.960537501970593, 4.805336893464921, 3.335720722827586, 4.438413384499795, 5.27857527595849, 8.772855391599354, 7.823587674330493, 5.72508644769574, 8.269100404746563, 1.0036113285551473, 1.3249628198031598, 5.649834641835296, 6.1586062163782085, 6.303052510994767, 4.109955894974139, 4.401462737948447, 7.460376612707664, 5.39594085507637, 3.4056167271320423, 7.166062472739148, 1.195157655132488, 2.249788987655396, 4.285810020985186, 4.904083042425305, 6.574739491241937, 8.735623762261534, 8.913175913854841, 5.6000149506074015, 7.596762485735814, 5.020224296291765, 5.536300186186111, 9.600813243714478, 6.857604862818799, 1.4467868928258185, 9.334244991915565, 3.1739150146640887, 1.869149793637164, 7.131501293319314, 2.052365152484057, 8.732847624523364, 3.002658686390335, 5.592986060243556, 7.3341412962680765, 4.962247878542253, 6.246274498802693, 5.155581667035112, 6.949737935597287, 6.169991607966256, 2.283743953959674, 6.988179818740411, 3.907771494140991, 3.6696302388618847, 6.9411304000441625, 3.5096054705418234, 4.276265566776392, 5.168355122495956, 7.20909234778232, 6.241120534713374, 2.747263024083197, 4.3641331542998705, 7.046330568363458], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0222420380967283, "mean_inference_ms": 8.012176779337132, "mean_action_processing_ms": 0.5420478122062855, "mean_env_wait_ms": 24.074746910672165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044252921123893896, "StateBufferConnector_ms": 0.035671068697559594, "ViewRequirementAgentConnector_ms": 0.9508473532540458}}, "episode_reward_max": 11.244997666131477, "episode_reward_min": 1.0036113285551473, "episode_reward_mean": 5.5494071241822445, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.998056074203013, 3.1043528982585324, 6.815582989184383, 11.244997666131477, 5.439533167578824, 6.462272371283426, 4.91205496082248, 6.8974046867659355, 1.7463087404911926, 8.36063813778793, 2.1849769666002996, 4.221521283806634, 6.2774803705997275, 6.3184100702011206, 5.803635491370871, 4.191337301137139, 3.7491215854821864, 5.371360571098304, 7.060112079663207, 7.438260007400526, 4.978290378306663, 8.269563856981565, 3.5338734479104694, 5.325687785332021, 6.423522319509915, 1.341895420321228, 6.418827042350532, 5.836014201779977, 7.325249281895349, 9.636956965741408, 5.848710596276518, 4.816098705082098, 6.108087052264357, 9.150712840284427, 5.401483200901139, 6.570165132970069, 6.893495018917494, 7.960537501970593, 4.805336893464921, 3.335720722827586, 4.438413384499795, 5.27857527595849, 8.772855391599354, 7.823587674330493, 5.72508644769574, 8.269100404746563, 1.0036113285551473, 1.3249628198031598, 5.649834641835296, 6.1586062163782085, 6.303052510994767, 4.109955894974139, 4.401462737948447, 7.460376612707664, 5.39594085507637, 3.4056167271320423, 7.166062472739148, 1.195157655132488, 2.249788987655396, 4.285810020985186, 4.904083042425305, 6.574739491241937, 8.735623762261534, 8.913175913854841, 5.6000149506074015, 7.596762485735814, 5.020224296291765, 5.536300186186111, 9.600813243714478, 6.857604862818799, 1.4467868928258185, 9.334244991915565, 3.1739150146640887, 1.869149793637164, 7.131501293319314, 2.052365152484057, 8.732847624523364, 3.002658686390335, 5.592986060243556, 7.3341412962680765, 4.962247878542253, 6.246274498802693, 5.155581667035112, 6.949737935597287, 6.169991607966256, 2.283743953959674, 6.988179818740411, 3.907771494140991, 3.6696302388618847, 6.9411304000441625, 3.5096054705418234, 4.276265566776392, 5.168355122495956, 7.20909234778232, 6.241120534713374, 2.747263024083197, 4.3641331542998705, 7.046330568363458], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0222420380967283, "mean_inference_ms": 8.012176779337132, "mean_action_processing_ms": 0.5420478122062855, "mean_env_wait_ms": 24.074746910672165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044252921123893896, "StateBufferConnector_ms": 0.035671068697559594, "ViewRequirementAgentConnector_ms": 0.9508473532540458}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5475386, "num_agent_steps_trained": 5475386, "num_env_steps_sampled": 5475386, "num_env_steps_trained": 5475386, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 289.1407455815436, "num_env_steps_trained_throughput_per_sec": 289.1407455815436, "timesteps_total": 5475386, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5475386, "timers": {"training_iteration_time_ms": 55324.313, "sample_time_ms": 41809.857, "load_time_ms": 1806.736, "load_throughput": 8655.386, "learn_time_ms": 11085.783, "learn_throughput": 1410.636, "synch_weights_time_ms": 499.588}, "counters": {"num_env_steps_sampled": 5475386, "num_env_steps_trained": 5475386, "num_agent_steps_sampled": 5475386, "num_agent_steps_trained": 5475386}, "done": false, "episodes_total": 98, "training_iteration": 355, "trial_id": "2f030_00000", "date": "2025-06-07_07-43-03", "timestamp": 1749274983, "time_this_iter_s": 54.10141110420227, "time_total_s": 404.08499693870544, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 404.08499693870544, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 76.48888888888888, "ram_util_percent": 70.61111111111111, "gpu_util_percent0": 0.08158730158730158, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.584366129032259e-05, "total_loss": -0.10643680716272105, "policy_loss": -0.015861212763570207, "vf_loss": 0.01928680421276526, "vf_explained_var": 0.6211450123786926, "kl": 0.027063448566926815, "entropy": 20.705749246423895, "entropy_coeff": 0.005584366129032257}, "model": {}, "num_grad_updates_lifetime": 4125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5491024, "num_env_steps_trained": 5491024, "num_agent_steps_sampled": 5491024, "num_agent_steps_trained": 5491024}, "sampler_results": {"episode_reward_max": 9.781838077103044, "episode_reward_min": 1.0036113285551473, "episode_reward_mean": 5.631444881590715, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.2774803705997275, 6.3184100702011206, 5.803635491370871, 4.191337301137139, 3.7491215854821864, 5.371360571098304, 7.060112079663207, 7.438260007400526, 4.978290378306663, 8.269563856981565, 3.5338734479104694, 5.325687785332021, 6.423522319509915, 1.341895420321228, 6.418827042350532, 5.836014201779977, 7.325249281895349, 9.636956965741408, 5.848710596276518, 4.816098705082098, 6.108087052264357, 9.150712840284427, 5.401483200901139, 6.570165132970069, 6.893495018917494, 7.960537501970593, 4.805336893464921, 3.335720722827586, 4.438413384499795, 5.27857527595849, 8.772855391599354, 7.823587674330493, 5.72508644769574, 8.269100404746563, 1.0036113285551473, 1.3249628198031598, 5.649834641835296, 6.1586062163782085, 6.303052510994767, 4.109955894974139, 4.401462737948447, 7.460376612707664, 5.39594085507637, 3.4056167271320423, 7.166062472739148, 1.195157655132488, 2.249788987655396, 4.285810020985186, 4.904083042425305, 6.574739491241937, 8.735623762261534, 8.913175913854841, 5.6000149506074015, 7.596762485735814, 5.020224296291765, 5.536300186186111, 9.600813243714478, 6.857604862818799, 1.4467868928258185, 9.334244991915565, 3.1739150146640887, 1.869149793637164, 7.131501293319314, 2.052365152484057, 8.732847624523364, 3.002658686390335, 5.592986060243556, 7.3341412962680765, 4.962247878542253, 6.246274498802693, 5.155581667035112, 6.949737935597287, 6.169991607966256, 2.283743953959674, 6.988179818740411, 3.907771494140991, 3.6696302388618847, 6.9411304000441625, 3.5096054705418234, 4.276265566776392, 5.168355122495956, 7.20909234778232, 6.241120534713374, 2.747263024083197, 4.3641331542998705, 7.046330568363458, 3.760312978040797, 4.563420408394078, 9.550619486623033, 7.226403225348129, 9.781838077103044, 5.3586670412543524, 9.21249298460544, 5.813739967404808, 4.0419322505504365, 3.4960018729883076, 5.588323448264514, 8.204420809690978, 4.927952717773955, 2.164164664083952], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0600165892408095, "mean_inference_ms": 8.021684264012887, "mean_action_processing_ms": 0.5407428519910665, "mean_env_wait_ms": 24.021426151214822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050374746322631836, "StateBufferConnector_ms": 0.030937671661376953, "ViewRequirementAgentConnector_ms": 0.9656031131744385}}, "episode_reward_max": 9.781838077103044, "episode_reward_min": 1.0036113285551473, "episode_reward_mean": 5.631444881590715, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.2774803705997275, 6.3184100702011206, 5.803635491370871, 4.191337301137139, 3.7491215854821864, 5.371360571098304, 7.060112079663207, 7.438260007400526, 4.978290378306663, 8.269563856981565, 3.5338734479104694, 5.325687785332021, 6.423522319509915, 1.341895420321228, 6.418827042350532, 5.836014201779977, 7.325249281895349, 9.636956965741408, 5.848710596276518, 4.816098705082098, 6.108087052264357, 9.150712840284427, 5.401483200901139, 6.570165132970069, 6.893495018917494, 7.960537501970593, 4.805336893464921, 3.335720722827586, 4.438413384499795, 5.27857527595849, 8.772855391599354, 7.823587674330493, 5.72508644769574, 8.269100404746563, 1.0036113285551473, 1.3249628198031598, 5.649834641835296, 6.1586062163782085, 6.303052510994767, 4.109955894974139, 4.401462737948447, 7.460376612707664, 5.39594085507637, 3.4056167271320423, 7.166062472739148, 1.195157655132488, 2.249788987655396, 4.285810020985186, 4.904083042425305, 6.574739491241937, 8.735623762261534, 8.913175913854841, 5.6000149506074015, 7.596762485735814, 5.020224296291765, 5.536300186186111, 9.600813243714478, 6.857604862818799, 1.4467868928258185, 9.334244991915565, 3.1739150146640887, 1.869149793637164, 7.131501293319314, 2.052365152484057, 8.732847624523364, 3.002658686390335, 5.592986060243556, 7.3341412962680765, 4.962247878542253, 6.246274498802693, 5.155581667035112, 6.949737935597287, 6.169991607966256, 2.283743953959674, 6.988179818740411, 3.907771494140991, 3.6696302388618847, 6.9411304000441625, 3.5096054705418234, 4.276265566776392, 5.168355122495956, 7.20909234778232, 6.241120534713374, 2.747263024083197, 4.3641331542998705, 7.046330568363458, 3.760312978040797, 4.563420408394078, 9.550619486623033, 7.226403225348129, 9.781838077103044, 5.3586670412543524, 9.21249298460544, 5.813739967404808, 4.0419322505504365, 3.4960018729883076, 5.588323448264514, 8.204420809690978, 4.927952717773955, 2.164164664083952], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0600165892408095, "mean_inference_ms": 8.021684264012887, "mean_action_processing_ms": 0.5407428519910665, "mean_env_wait_ms": 24.021426151214822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050374746322631836, "StateBufferConnector_ms": 0.030937671661376953, "ViewRequirementAgentConnector_ms": 0.9656031131744385}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5491024, "num_agent_steps_trained": 5491024, "num_env_steps_sampled": 5491024, "num_env_steps_trained": 5491024, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 288.8577839284209, "num_env_steps_trained_throughput_per_sec": 288.8577839284209, "timesteps_total": 5491024, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5491024, "timers": {"training_iteration_time_ms": 55175.945, "sample_time_ms": 41775.334, "load_time_ms": 1776.91, "load_throughput": 8800.672, "learn_time_ms": 11010.244, "learn_throughput": 1420.314, "synch_weights_time_ms": 487.76}, "counters": {"num_env_steps_sampled": 5491024, "num_env_steps_trained": 5491024, "num_agent_steps_sampled": 5491024, "num_agent_steps_trained": 5491024}, "done": false, "episodes_total": 112, "training_iteration": 356, "trial_id": "2f030_00000", "date": "2025-06-07_07-43-58", "timestamp": 1749275038, "time_this_iter_s": 54.15235114097595, "time_total_s": 458.2373480796814, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 458.2373480796814, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 76.76349206349205, "ram_util_percent": 70.26349206349208, "gpu_util_percent0": 0.08190476190476191, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.571754838709678e-05, "total_loss": -0.116627591479231, "policy_loss": -0.024978323625400662, "vf_loss": 0.017985525509681213, "vf_explained_var": 0.644477958462455, "kl": 0.026117427770752964, "entropy": 20.754375811490146, "entropy_coeff": 0.005571754838709677}, "model": {}, "num_grad_updates_lifetime": 4675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5506662, "num_env_steps_trained": 5506662, "num_agent_steps_sampled": 5506662, "num_agent_steps_trained": 5506662}, "sampler_results": {"episode_reward_max": 9.781838077103044, "episode_reward_min": -0.020577670098954216, "episode_reward_mean": 5.570169650023485, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.418827042350532, 5.836014201779977, 7.325249281895349, 9.636956965741408, 5.848710596276518, 4.816098705082098, 6.108087052264357, 9.150712840284427, 5.401483200901139, 6.570165132970069, 6.893495018917494, 7.960537501970593, 4.805336893464921, 3.335720722827586, 4.438413384499795, 5.27857527595849, 8.772855391599354, 7.823587674330493, 5.72508644769574, 8.269100404746563, 1.0036113285551473, 1.3249628198031598, 5.649834641835296, 6.1586062163782085, 6.303052510994767, 4.109955894974139, 4.401462737948447, 7.460376612707664, 5.39594085507637, 3.4056167271320423, 7.166062472739148, 1.195157655132488, 2.249788987655396, 4.285810020985186, 4.904083042425305, 6.574739491241937, 8.735623762261534, 8.913175913854841, 5.6000149506074015, 7.596762485735814, 5.020224296291765, 5.536300186186111, 9.600813243714478, 6.857604862818799, 1.4467868928258185, 9.334244991915565, 3.1739150146640887, 1.869149793637164, 7.131501293319314, 2.052365152484057, 8.732847624523364, 3.002658686390335, 5.592986060243556, 7.3341412962680765, 4.962247878542253, 6.246274498802693, 5.155581667035112, 6.949737935597287, 6.169991607966256, 2.283743953959674, 6.988179818740411, 3.907771494140991, 3.6696302388618847, 6.9411304000441625, 3.5096054705418234, 4.276265566776392, 5.168355122495956, 7.20909234778232, 6.241120534713374, 2.747263024083197, 4.3641331542998705, 7.046330568363458, 3.760312978040797, 4.563420408394078, 9.550619486623033, 7.226403225348129, 9.781838077103044, 5.3586670412543524, 9.21249298460544, 5.813739967404808, 4.0419322505504365, 3.4960018729883076, 5.588323448264514, 8.204420809690978, 4.927952717773955, 2.164164664083952, -0.020577670098954216, 6.007613141747923, 4.768514925322695, 4.935082889361645, 3.673636809850732, 5.906487741005914, 2.121727314799621, 2.3540499752164843, 3.5109448456702617, 6.160910459661835, 8.227493398576547, 5.798838760171459, 8.192025621623861, 8.318279315681862], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.080265579933926, "mean_inference_ms": 8.019193779854, "mean_action_processing_ms": 0.5400681017955775, "mean_env_wait_ms": 23.999473079483124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04441118240356445, "StateBufferConnector_ms": 0.030977725982666016, "ViewRequirementAgentConnector_ms": 0.9414918422698975}}, "episode_reward_max": 9.781838077103044, "episode_reward_min": -0.020577670098954216, "episode_reward_mean": 5.570169650023485, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.418827042350532, 5.836014201779977, 7.325249281895349, 9.636956965741408, 5.848710596276518, 4.816098705082098, 6.108087052264357, 9.150712840284427, 5.401483200901139, 6.570165132970069, 6.893495018917494, 7.960537501970593, 4.805336893464921, 3.335720722827586, 4.438413384499795, 5.27857527595849, 8.772855391599354, 7.823587674330493, 5.72508644769574, 8.269100404746563, 1.0036113285551473, 1.3249628198031598, 5.649834641835296, 6.1586062163782085, 6.303052510994767, 4.109955894974139, 4.401462737948447, 7.460376612707664, 5.39594085507637, 3.4056167271320423, 7.166062472739148, 1.195157655132488, 2.249788987655396, 4.285810020985186, 4.904083042425305, 6.574739491241937, 8.735623762261534, 8.913175913854841, 5.6000149506074015, 7.596762485735814, 5.020224296291765, 5.536300186186111, 9.600813243714478, 6.857604862818799, 1.4467868928258185, 9.334244991915565, 3.1739150146640887, 1.869149793637164, 7.131501293319314, 2.052365152484057, 8.732847624523364, 3.002658686390335, 5.592986060243556, 7.3341412962680765, 4.962247878542253, 6.246274498802693, 5.155581667035112, 6.949737935597287, 6.169991607966256, 2.283743953959674, 6.988179818740411, 3.907771494140991, 3.6696302388618847, 6.9411304000441625, 3.5096054705418234, 4.276265566776392, 5.168355122495956, 7.20909234778232, 6.241120534713374, 2.747263024083197, 4.3641331542998705, 7.046330568363458, 3.760312978040797, 4.563420408394078, 9.550619486623033, 7.226403225348129, 9.781838077103044, 5.3586670412543524, 9.21249298460544, 5.813739967404808, 4.0419322505504365, 3.4960018729883076, 5.588323448264514, 8.204420809690978, 4.927952717773955, 2.164164664083952, -0.020577670098954216, 6.007613141747923, 4.768514925322695, 4.935082889361645, 3.673636809850732, 5.906487741005914, 2.121727314799621, 2.3540499752164843, 3.5109448456702617, 6.160910459661835, 8.227493398576547, 5.798838760171459, 8.192025621623861, 8.318279315681862], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.080265579933926, "mean_inference_ms": 8.019193779854, "mean_action_processing_ms": 0.5400681017955775, "mean_env_wait_ms": 23.999473079483124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04441118240356445, "StateBufferConnector_ms": 0.030977725982666016, "ViewRequirementAgentConnector_ms": 0.9414918422698975}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5506662, "num_agent_steps_trained": 5506662, "num_env_steps_sampled": 5506662, "num_env_steps_trained": 5506662, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 288.1120984011901, "num_env_steps_trained_throughput_per_sec": 288.1120984011901, "timesteps_total": 5506662, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5506662, "timers": {"training_iteration_time_ms": 55076.116, "sample_time_ms": 41708.986, "load_time_ms": 1768.702, "load_throughput": 8841.511, "learn_time_ms": 10993.24, "learn_throughput": 1422.511, "synch_weights_time_ms": 480.839}, "counters": {"num_env_steps_sampled": 5506662, "num_env_steps_trained": 5506662, "num_agent_steps_sampled": 5506662, "num_agent_steps_trained": 5506662}, "done": false, "episodes_total": 126, "training_iteration": 357, "trial_id": "2f030_00000", "date": "2025-06-07_07-44-52", "timestamp": 1749275092, "time_this_iter_s": 54.29347848892212, "time_total_s": 512.5308265686035, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 512.5308265686035, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 77.74193548387096, "ram_util_percent": 70.26129032258065, "gpu_util_percent0": 0.07467741935483871, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.559143548387097e-05, "total_loss": -0.10122944068756293, "policy_loss": -0.010639525083944053, "vf_loss": 0.017788217755203898, "vf_explained_var": 0.6513551541891965, "kl": 0.02680699449029963, "entropy": 20.688556783849542, "entropy_coeff": 0.005559143548387096}, "model": {}, "num_grad_updates_lifetime": 5225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5522300, "num_env_steps_trained": 5522300, "num_agent_steps_sampled": 5522300, "num_agent_steps_trained": 5522300}, "sampler_results": {"episode_reward_max": 9.781838077103044, "episode_reward_min": -0.020577670098954216, "episode_reward_mean": 5.39940433682133, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.438413384499795, 5.27857527595849, 8.772855391599354, 7.823587674330493, 5.72508644769574, 8.269100404746563, 1.0036113285551473, 1.3249628198031598, 5.649834641835296, 6.1586062163782085, 6.303052510994767, 4.109955894974139, 4.401462737948447, 7.460376612707664, 5.39594085507637, 3.4056167271320423, 7.166062472739148, 1.195157655132488, 2.249788987655396, 4.285810020985186, 4.904083042425305, 6.574739491241937, 8.735623762261534, 8.913175913854841, 5.6000149506074015, 7.596762485735814, 5.020224296291765, 5.536300186186111, 9.600813243714478, 6.857604862818799, 1.4467868928258185, 9.334244991915565, 3.1739150146640887, 1.869149793637164, 7.131501293319314, 2.052365152484057, 8.732847624523364, 3.002658686390335, 5.592986060243556, 7.3341412962680765, 4.962247878542253, 6.246274498802693, 5.155581667035112, 6.949737935597287, 6.169991607966256, 2.283743953959674, 6.988179818740411, 3.907771494140991, 3.6696302388618847, 6.9411304000441625, 3.5096054705418234, 4.276265566776392, 5.168355122495956, 7.20909234778232, 6.241120534713374, 2.747263024083197, 4.3641331542998705, 7.046330568363458, 3.760312978040797, 4.563420408394078, 9.550619486623033, 7.226403225348129, 9.781838077103044, 5.3586670412543524, 9.21249298460544, 5.813739967404808, 4.0419322505504365, 3.4960018729883076, 5.588323448264514, 8.204420809690978, 4.927952717773955, 2.164164664083952, -0.020577670098954216, 6.007613141747923, 4.768514925322695, 4.935082889361645, 3.673636809850732, 5.906487741005914, 2.121727314799621, 2.3540499752164843, 3.5109448456702617, 6.160910459661835, 8.227493398576547, 5.798838760171459, 8.192025621623861, 8.318279315681862, 3.3398075631407096, 7.51852180367492, 3.08874414806459, 8.75666130784771, 3.1498116352741965, 2.6265488982148297, 3.9524943783173843, 7.199543471349595, 5.922469361320495, 4.957906040759433, 5.647359655553608, 4.29297623032064, 7.10581045542241, 5.472208887250268], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0803415044680666, "mean_inference_ms": 7.996896387422493, "mean_action_processing_ms": 0.537963636145662, "mean_env_wait_ms": 23.928399962298318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046529531478881836, "StateBufferConnector_ms": 0.03266406059265137, "ViewRequirementAgentConnector_ms": 0.940913200378418}}, "episode_reward_max": 9.781838077103044, "episode_reward_min": -0.020577670098954216, "episode_reward_mean": 5.39940433682133, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.438413384499795, 5.27857527595849, 8.772855391599354, 7.823587674330493, 5.72508644769574, 8.269100404746563, 1.0036113285551473, 1.3249628198031598, 5.649834641835296, 6.1586062163782085, 6.303052510994767, 4.109955894974139, 4.401462737948447, 7.460376612707664, 5.39594085507637, 3.4056167271320423, 7.166062472739148, 1.195157655132488, 2.249788987655396, 4.285810020985186, 4.904083042425305, 6.574739491241937, 8.735623762261534, 8.913175913854841, 5.6000149506074015, 7.596762485735814, 5.020224296291765, 5.536300186186111, 9.600813243714478, 6.857604862818799, 1.4467868928258185, 9.334244991915565, 3.1739150146640887, 1.869149793637164, 7.131501293319314, 2.052365152484057, 8.732847624523364, 3.002658686390335, 5.592986060243556, 7.3341412962680765, 4.962247878542253, 6.246274498802693, 5.155581667035112, 6.949737935597287, 6.169991607966256, 2.283743953959674, 6.988179818740411, 3.907771494140991, 3.6696302388618847, 6.9411304000441625, 3.5096054705418234, 4.276265566776392, 5.168355122495956, 7.20909234778232, 6.241120534713374, 2.747263024083197, 4.3641331542998705, 7.046330568363458, 3.760312978040797, 4.563420408394078, 9.550619486623033, 7.226403225348129, 9.781838077103044, 5.3586670412543524, 9.21249298460544, 5.813739967404808, 4.0419322505504365, 3.4960018729883076, 5.588323448264514, 8.204420809690978, 4.927952717773955, 2.164164664083952, -0.020577670098954216, 6.007613141747923, 4.768514925322695, 4.935082889361645, 3.673636809850732, 5.906487741005914, 2.121727314799621, 2.3540499752164843, 3.5109448456702617, 6.160910459661835, 8.227493398576547, 5.798838760171459, 8.192025621623861, 8.318279315681862, 3.3398075631407096, 7.51852180367492, 3.08874414806459, 8.75666130784771, 3.1498116352741965, 2.6265488982148297, 3.9524943783173843, 7.199543471349595, 5.922469361320495, 4.957906040759433, 5.647359655553608, 4.29297623032064, 7.10581045542241, 5.472208887250268], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0803415044680666, "mean_inference_ms": 7.996896387422493, "mean_action_processing_ms": 0.537963636145662, "mean_env_wait_ms": 23.928399962298318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046529531478881836, "StateBufferConnector_ms": 0.03266406059265137, "ViewRequirementAgentConnector_ms": 0.940913200378418}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5522300, "num_agent_steps_trained": 5522300, "num_env_steps_sampled": 5522300, "num_env_steps_trained": 5522300, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 290.39310304953835, "num_env_steps_trained_throughput_per_sec": 290.39310304953835, "timesteps_total": 5522300, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5522300, "timers": {"training_iteration_time_ms": 54953.516, "sample_time_ms": 41656.585, "load_time_ms": 1752.156, "load_throughput": 8925.005, "learn_time_ms": 10942.098, "learn_throughput": 1429.159, "synch_weights_time_ms": 478.745}, "counters": {"num_env_steps_sampled": 5522300, "num_env_steps_trained": 5522300, "num_agent_steps_sampled": 5522300, "num_agent_steps_trained": 5522300}, "done": false, "episodes_total": 140, "training_iteration": 358, "trial_id": "2f030_00000", "date": "2025-06-07_07-45-46", "timestamp": 1749275146, "time_this_iter_s": 53.86701321601868, "time_total_s": 566.3978397846222, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 566.3978397846222, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 77.17419354838708, "ram_util_percent": 70.47258064516127, "gpu_util_percent0": 0.07870967741935482, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.546532258064518e-05, "total_loss": -0.1163922323430465, "policy_loss": -0.024483241408359557, "vf_loss": 0.017230649306862193, "vf_explained_var": 0.6643223365870389, "kl": 0.02426448827791749, "entropy": 20.61692128614946, "entropy_coeff": 0.005546532258064515}, "model": {}, "num_grad_updates_lifetime": 5775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5537938, "num_env_steps_trained": 5537938, "num_agent_steps_sampled": 5537938, "num_agent_steps_trained": 5537938}, "sampler_results": {"episode_reward_max": 9.781838077103044, "episode_reward_min": -0.020577670098954216, "episode_reward_mean": 5.480881873086771, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.39594085507637, 3.4056167271320423, 7.166062472739148, 1.195157655132488, 2.249788987655396, 4.285810020985186, 4.904083042425305, 6.574739491241937, 8.735623762261534, 8.913175913854841, 5.6000149506074015, 7.596762485735814, 5.020224296291765, 5.536300186186111, 9.600813243714478, 6.857604862818799, 1.4467868928258185, 9.334244991915565, 3.1739150146640887, 1.869149793637164, 7.131501293319314, 2.052365152484057, 8.732847624523364, 3.002658686390335, 5.592986060243556, 7.3341412962680765, 4.962247878542253, 6.246274498802693, 5.155581667035112, 6.949737935597287, 6.169991607966256, 2.283743953959674, 6.988179818740411, 3.907771494140991, 3.6696302388618847, 6.9411304000441625, 3.5096054705418234, 4.276265566776392, 5.168355122495956, 7.20909234778232, 6.241120534713374, 2.747263024083197, 4.3641331542998705, 7.046330568363458, 3.760312978040797, 4.563420408394078, 9.550619486623033, 7.226403225348129, 9.781838077103044, 5.3586670412543524, 9.21249298460544, 5.813739967404808, 4.0419322505504365, 3.4960018729883076, 5.588323448264514, 8.204420809690978, 4.927952717773955, 2.164164664083952, -0.020577670098954216, 6.007613141747923, 4.768514925322695, 4.935082889361645, 3.673636809850732, 5.906487741005914, 2.121727314799621, 2.3540499752164843, 3.5109448456702617, 6.160910459661835, 8.227493398576547, 5.798838760171459, 8.192025621623861, 8.318279315681862, 3.3398075631407096, 7.51852180367492, 3.08874414806459, 8.75666130784771, 3.1498116352741965, 2.6265488982148297, 3.9524943783173843, 7.199543471349595, 5.922469361320495, 4.957906040759433, 5.647359655553608, 4.29297623032064, 7.10581045542241, 5.472208887250268, 8.39013698968387, 7.679693171811563, 7.026319107475512, 6.077381708917722, 8.918878555206133, 4.380013097158774, 3.9988146511055906, 4.375635642976223, 5.9980709427643575, 3.3620949513166067, 5.706514769163091, 8.645754140456301, 4.9891811473002265, 5.318746093235563], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.081983014003425, "mean_inference_ms": 7.977952879474628, "mean_action_processing_ms": 0.5361390076063182, "mean_env_wait_ms": 23.858056431981638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04657793045043945, "StateBufferConnector_ms": 0.034639596939086914, "ViewRequirementAgentConnector_ms": 0.9508492946624756}}, "episode_reward_max": 9.781838077103044, "episode_reward_min": -0.020577670098954216, "episode_reward_mean": 5.480881873086771, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.39594085507637, 3.4056167271320423, 7.166062472739148, 1.195157655132488, 2.249788987655396, 4.285810020985186, 4.904083042425305, 6.574739491241937, 8.735623762261534, 8.913175913854841, 5.6000149506074015, 7.596762485735814, 5.020224296291765, 5.536300186186111, 9.600813243714478, 6.857604862818799, 1.4467868928258185, 9.334244991915565, 3.1739150146640887, 1.869149793637164, 7.131501293319314, 2.052365152484057, 8.732847624523364, 3.002658686390335, 5.592986060243556, 7.3341412962680765, 4.962247878542253, 6.246274498802693, 5.155581667035112, 6.949737935597287, 6.169991607966256, 2.283743953959674, 6.988179818740411, 3.907771494140991, 3.6696302388618847, 6.9411304000441625, 3.5096054705418234, 4.276265566776392, 5.168355122495956, 7.20909234778232, 6.241120534713374, 2.747263024083197, 4.3641331542998705, 7.046330568363458, 3.760312978040797, 4.563420408394078, 9.550619486623033, 7.226403225348129, 9.781838077103044, 5.3586670412543524, 9.21249298460544, 5.813739967404808, 4.0419322505504365, 3.4960018729883076, 5.588323448264514, 8.204420809690978, 4.927952717773955, 2.164164664083952, -0.020577670098954216, 6.007613141747923, 4.768514925322695, 4.935082889361645, 3.673636809850732, 5.906487741005914, 2.121727314799621, 2.3540499752164843, 3.5109448456702617, 6.160910459661835, 8.227493398576547, 5.798838760171459, 8.192025621623861, 8.318279315681862, 3.3398075631407096, 7.51852180367492, 3.08874414806459, 8.75666130784771, 3.1498116352741965, 2.6265488982148297, 3.9524943783173843, 7.199543471349595, 5.922469361320495, 4.957906040759433, 5.647359655553608, 4.29297623032064, 7.10581045542241, 5.472208887250268, 8.39013698968387, 7.679693171811563, 7.026319107475512, 6.077381708917722, 8.918878555206133, 4.380013097158774, 3.9988146511055906, 4.375635642976223, 5.9980709427643575, 3.3620949513166067, 5.706514769163091, 8.645754140456301, 4.9891811473002265, 5.318746093235563], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.081983014003425, "mean_inference_ms": 7.977952879474628, "mean_action_processing_ms": 0.5361390076063182, "mean_env_wait_ms": 23.858056431981638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04657793045043945, "StateBufferConnector_ms": 0.034639596939086914, "ViewRequirementAgentConnector_ms": 0.9508492946624756}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5537938, "num_agent_steps_trained": 5537938, "num_env_steps_sampled": 5537938, "num_env_steps_trained": 5537938, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 288.5476025247515, "num_env_steps_trained_throughput_per_sec": 288.5476025247515, "timesteps_total": 5537938, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5537938, "timers": {"training_iteration_time_ms": 54721.877, "sample_time_ms": 41538.192, "load_time_ms": 1645.21, "load_throughput": 9505.168, "learn_time_ms": 10940.559, "learn_throughput": 1429.36, "synch_weights_time_ms": 476.563}, "counters": {"num_env_steps_sampled": 5537938, "num_env_steps_trained": 5537938, "num_agent_steps_sampled": 5537938, "num_agent_steps_trained": 5537938}, "done": false, "episodes_total": 154, "training_iteration": 359, "trial_id": "2f030_00000", "date": "2025-06-07_07-46-40", "timestamp": 1749275200, "time_this_iter_s": 54.22109580039978, "time_total_s": 620.618935585022, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 620.618935585022, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 77.96774193548389, "ram_util_percent": 70.8532258064516, "gpu_util_percent0": 0.0785483870967742, "vram_util_percent0": 0.8592122395833335}}
{"evaluation": {"sampler_results": {"episode_reward_max": -2.4520289898478946, "episode_reward_min": -9.003145821823654, "episode_reward_mean": -4.469379043707742, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.7186519191152474, -5.068065788270239, -2.4520289898478946, -9.003145821823654, -3.1050026994816764], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7380176971037709, "mean_inference_ms": 3.792264550875737, "mean_action_processing_ms": 0.2934931413690918, "mean_env_wait_ms": 11.171114438257419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.24001598358154297}}, "episode_reward_max": -2.4520289898478946, "episode_reward_min": -9.003145821823654, "episode_reward_mean": -4.469379043707742, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.7186519191152474, -5.068065788270239, -2.4520289898478946, -9.003145821823654, -3.1050026994816764], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7380176971037709, "mean_inference_ms": 3.792264550875737, "mean_action_processing_ms": 0.2934931413690918, "mean_env_wait_ms": 11.171114438257419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.24001598358154297}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.533920967741936e-05, "total_loss": -0.09955983492376452, "policy_loss": -0.006989648511993106, "vf_loss": 0.016452088457616892, "vf_explained_var": 0.6921656514297833, "kl": 0.024260949299124392, "entropy": 20.74072294928811, "entropy_coeff": 0.005533920967741934}, "model": {}, "num_grad_updates_lifetime": 6325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5553576, "num_env_steps_trained": 5553576, "num_agent_steps_sampled": 5553576, "num_agent_steps_trained": 5553576}, "sampler_results": {"episode_reward_max": 9.781838077103044, "episode_reward_min": -0.020577670098954216, "episode_reward_mean": 5.536923902913137, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.600813243714478, 6.857604862818799, 1.4467868928258185, 9.334244991915565, 3.1739150146640887, 1.869149793637164, 7.131501293319314, 2.052365152484057, 8.732847624523364, 3.002658686390335, 5.592986060243556, 7.3341412962680765, 4.962247878542253, 6.246274498802693, 5.155581667035112, 6.949737935597287, 6.169991607966256, 2.283743953959674, 6.988179818740411, 3.907771494140991, 3.6696302388618847, 6.9411304000441625, 3.5096054705418234, 4.276265566776392, 5.168355122495956, 7.20909234778232, 6.241120534713374, 2.747263024083197, 4.3641331542998705, 7.046330568363458, 3.760312978040797, 4.563420408394078, 9.550619486623033, 7.226403225348129, 9.781838077103044, 5.3586670412543524, 9.21249298460544, 5.813739967404808, 4.0419322505504365, 3.4960018729883076, 5.588323448264514, 8.204420809690978, 4.927952717773955, 2.164164664083952, -0.020577670098954216, 6.007613141747923, 4.768514925322695, 4.935082889361645, 3.673636809850732, 5.906487741005914, 2.121727314799621, 2.3540499752164843, 3.5109448456702617, 6.160910459661835, 8.227493398576547, 5.798838760171459, 8.192025621623861, 8.318279315681862, 3.3398075631407096, 7.51852180367492, 3.08874414806459, 8.75666130784771, 3.1498116352741965, 2.6265488982148297, 3.9524943783173843, 7.199543471349595, 5.922469361320495, 4.957906040759433, 5.647359655553608, 4.29297623032064, 7.10581045542241, 5.472208887250268, 8.39013698968387, 7.679693171811563, 7.026319107475512, 6.077381708917722, 8.918878555206133, 4.380013097158774, 3.9988146511055906, 4.375635642976223, 5.9980709427643575, 3.3620949513166067, 5.706514769163091, 8.645754140456301, 4.9891811473002265, 5.318746093235563, 5.3773055999059, 6.632903356554597, 5.341917149942854, 6.074482563734394, 5.80868953720937, 3.4913648913347317, 7.9942090003905255, 3.790199067870436, 8.167983958334808, 5.115715061185131, 7.235766652443506, 4.402228004854599, 4.824808162303474, 7.925930823897575], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.08289230153817, "mean_inference_ms": 7.9627559347674355, "mean_action_processing_ms": 0.535333027058131, "mean_env_wait_ms": 23.80987162902113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049245357513427734, "StateBufferConnector_ms": 0.03185606002807617, "ViewRequirementAgentConnector_ms": 0.950793981552124}}, "episode_reward_max": 9.781838077103044, "episode_reward_min": -0.020577670098954216, "episode_reward_mean": 5.536923902913137, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.600813243714478, 6.857604862818799, 1.4467868928258185, 9.334244991915565, 3.1739150146640887, 1.869149793637164, 7.131501293319314, 2.052365152484057, 8.732847624523364, 3.002658686390335, 5.592986060243556, 7.3341412962680765, 4.962247878542253, 6.246274498802693, 5.155581667035112, 6.949737935597287, 6.169991607966256, 2.283743953959674, 6.988179818740411, 3.907771494140991, 3.6696302388618847, 6.9411304000441625, 3.5096054705418234, 4.276265566776392, 5.168355122495956, 7.20909234778232, 6.241120534713374, 2.747263024083197, 4.3641331542998705, 7.046330568363458, 3.760312978040797, 4.563420408394078, 9.550619486623033, 7.226403225348129, 9.781838077103044, 5.3586670412543524, 9.21249298460544, 5.813739967404808, 4.0419322505504365, 3.4960018729883076, 5.588323448264514, 8.204420809690978, 4.927952717773955, 2.164164664083952, -0.020577670098954216, 6.007613141747923, 4.768514925322695, 4.935082889361645, 3.673636809850732, 5.906487741005914, 2.121727314799621, 2.3540499752164843, 3.5109448456702617, 6.160910459661835, 8.227493398576547, 5.798838760171459, 8.192025621623861, 8.318279315681862, 3.3398075631407096, 7.51852180367492, 3.08874414806459, 8.75666130784771, 3.1498116352741965, 2.6265488982148297, 3.9524943783173843, 7.199543471349595, 5.922469361320495, 4.957906040759433, 5.647359655553608, 4.29297623032064, 7.10581045542241, 5.472208887250268, 8.39013698968387, 7.679693171811563, 7.026319107475512, 6.077381708917722, 8.918878555206133, 4.380013097158774, 3.9988146511055906, 4.375635642976223, 5.9980709427643575, 3.3620949513166067, 5.706514769163091, 8.645754140456301, 4.9891811473002265, 5.318746093235563, 5.3773055999059, 6.632903356554597, 5.341917149942854, 6.074482563734394, 5.80868953720937, 3.4913648913347317, 7.9942090003905255, 3.790199067870436, 8.167983958334808, 5.115715061185131, 7.235766652443506, 4.402228004854599, 4.824808162303474, 7.925930823897575], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.08289230153817, "mean_inference_ms": 7.9627559347674355, "mean_action_processing_ms": 0.535333027058131, "mean_env_wait_ms": 23.80987162902113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049245357513427734, "StateBufferConnector_ms": 0.03185606002807617, "ViewRequirementAgentConnector_ms": 0.950793981552124}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5553576, "num_agent_steps_trained": 5553576, "num_env_steps_sampled": 5553576, "num_env_steps_trained": 5553576, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 291.7626295218408, "num_env_steps_trained_throughput_per_sec": 291.7626295218408, "timesteps_total": 5553576, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5553576, "timers": {"training_iteration_time_ms": 54402.417, "sample_time_ms": 41442.405, "load_time_ms": 1645.043, "load_throughput": 9506.135, "learn_time_ms": 10739.522, "learn_throughput": 1456.117, "synch_weights_time_ms": 458.951}, "counters": {"num_env_steps_sampled": 5553576, "num_env_steps_trained": 5553576, "num_agent_steps_sampled": 5553576, "num_agent_steps_trained": 5553576}, "done": false, "episodes_total": 168, "training_iteration": 360, "trial_id": "2f030_00000", "date": "2025-06-07_07-47-49", "timestamp": 1749275269, "time_this_iter_s": 68.54470419883728, "time_total_s": 689.1636397838593, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 689.1636397838593, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 63.8625, "ram_util_percent": 70.62375, "gpu_util_percent0": 0.06425, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.521309677419355e-05, "total_loss": -0.10939608781005848, "policy_loss": -0.01660959698736075, "vf_loss": 0.01673488535494967, "vf_explained_var": 0.7053917150063949, "kl": 0.023627598186695076, "entropy": 20.760976035378196, "entropy_coeff": 0.005521309677419355}, "model": {}, "num_grad_updates_lifetime": 6875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5569214, "num_env_steps_trained": 5569214, "num_agent_steps_sampled": 5569214, "num_agent_steps_trained": 5569214}, "sampler_results": {"episode_reward_max": 10.43247313589109, "episode_reward_min": -0.020577670098954216, "episode_reward_mean": 5.560043066936486, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.155581667035112, 6.949737935597287, 6.169991607966256, 2.283743953959674, 6.988179818740411, 3.907771494140991, 3.6696302388618847, 6.9411304000441625, 3.5096054705418234, 4.276265566776392, 5.168355122495956, 7.20909234778232, 6.241120534713374, 2.747263024083197, 4.3641331542998705, 7.046330568363458, 3.760312978040797, 4.563420408394078, 9.550619486623033, 7.226403225348129, 9.781838077103044, 5.3586670412543524, 9.21249298460544, 5.813739967404808, 4.0419322505504365, 3.4960018729883076, 5.588323448264514, 8.204420809690978, 4.927952717773955, 2.164164664083952, -0.020577670098954216, 6.007613141747923, 4.768514925322695, 4.935082889361645, 3.673636809850732, 5.906487741005914, 2.121727314799621, 2.3540499752164843, 3.5109448456702617, 6.160910459661835, 8.227493398576547, 5.798838760171459, 8.192025621623861, 8.318279315681862, 3.3398075631407096, 7.51852180367492, 3.08874414806459, 8.75666130784771, 3.1498116352741965, 2.6265488982148297, 3.9524943783173843, 7.199543471349595, 5.922469361320495, 4.957906040759433, 5.647359655553608, 4.29297623032064, 7.10581045542241, 5.472208887250268, 8.39013698968387, 7.679693171811563, 7.026319107475512, 6.077381708917722, 8.918878555206133, 4.380013097158774, 3.9988146511055906, 4.375635642976223, 5.9980709427643575, 3.3620949513166067, 5.706514769163091, 8.645754140456301, 4.9891811473002265, 5.318746093235563, 5.3773055999059, 6.632903356554597, 5.341917149942854, 6.074482563734394, 5.80868953720937, 3.4913648913347317, 7.9942090003905255, 3.790199067870436, 8.167983958334808, 5.115715061185131, 7.235766652443506, 4.402228004854599, 4.824808162303474, 7.925930823897575, 7.141663184988694, 3.3969538962135224, 6.711425992520849, 1.7966704298933522, 9.274263178000666, 4.427439761629476, 5.997482960589888, 3.895274656244849, 3.8177619924104262, 7.319233900707282, 5.3833228448099035, 5.272991982256731, 10.43247313589109, 4.78249577632782], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0777694245505813, "mean_inference_ms": 7.95490062960059, "mean_action_processing_ms": 0.5350603482494725, "mean_env_wait_ms": 23.781377660670998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04515480995178223, "StateBufferConnector_ms": 0.027711868286132812, "ViewRequirementAgentConnector_ms": 0.988959789276123}}, "episode_reward_max": 10.43247313589109, "episode_reward_min": -0.020577670098954216, "episode_reward_mean": 5.560043066936486, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.155581667035112, 6.949737935597287, 6.169991607966256, 2.283743953959674, 6.988179818740411, 3.907771494140991, 3.6696302388618847, 6.9411304000441625, 3.5096054705418234, 4.276265566776392, 5.168355122495956, 7.20909234778232, 6.241120534713374, 2.747263024083197, 4.3641331542998705, 7.046330568363458, 3.760312978040797, 4.563420408394078, 9.550619486623033, 7.226403225348129, 9.781838077103044, 5.3586670412543524, 9.21249298460544, 5.813739967404808, 4.0419322505504365, 3.4960018729883076, 5.588323448264514, 8.204420809690978, 4.927952717773955, 2.164164664083952, -0.020577670098954216, 6.007613141747923, 4.768514925322695, 4.935082889361645, 3.673636809850732, 5.906487741005914, 2.121727314799621, 2.3540499752164843, 3.5109448456702617, 6.160910459661835, 8.227493398576547, 5.798838760171459, 8.192025621623861, 8.318279315681862, 3.3398075631407096, 7.51852180367492, 3.08874414806459, 8.75666130784771, 3.1498116352741965, 2.6265488982148297, 3.9524943783173843, 7.199543471349595, 5.922469361320495, 4.957906040759433, 5.647359655553608, 4.29297623032064, 7.10581045542241, 5.472208887250268, 8.39013698968387, 7.679693171811563, 7.026319107475512, 6.077381708917722, 8.918878555206133, 4.380013097158774, 3.9988146511055906, 4.375635642976223, 5.9980709427643575, 3.3620949513166067, 5.706514769163091, 8.645754140456301, 4.9891811473002265, 5.318746093235563, 5.3773055999059, 6.632903356554597, 5.341917149942854, 6.074482563734394, 5.80868953720937, 3.4913648913347317, 7.9942090003905255, 3.790199067870436, 8.167983958334808, 5.115715061185131, 7.235766652443506, 4.402228004854599, 4.824808162303474, 7.925930823897575, 7.141663184988694, 3.3969538962135224, 6.711425992520849, 1.7966704298933522, 9.274263178000666, 4.427439761629476, 5.997482960589888, 3.895274656244849, 3.8177619924104262, 7.319233900707282, 5.3833228448099035, 5.272991982256731, 10.43247313589109, 4.78249577632782], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0777694245505813, "mean_inference_ms": 7.95490062960059, "mean_action_processing_ms": 0.5350603482494725, "mean_env_wait_ms": 23.781377660670998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04515480995178223, "StateBufferConnector_ms": 0.027711868286132812, "ViewRequirementAgentConnector_ms": 0.988959789276123}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5569214, "num_agent_steps_trained": 5569214, "num_env_steps_sampled": 5569214, "num_env_steps_trained": 5569214, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 287.42840630364395, "num_env_steps_trained_throughput_per_sec": 287.42840630364395, "timesteps_total": 5569214, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5569214, "timers": {"training_iteration_time_ms": 54092.176, "sample_time_ms": 41194.41, "load_time_ms": 1640.527, "load_throughput": 9532.306, "learn_time_ms": 10681.097, "learn_throughput": 1464.082, "synch_weights_time_ms": 459.648}, "counters": {"num_env_steps_sampled": 5569214, "num_env_steps_trained": 5569214, "num_agent_steps_sampled": 5569214, "num_agent_steps_trained": 5569214}, "done": false, "episodes_total": 182, "training_iteration": 361, "trial_id": "2f030_00000", "date": "2025-06-07_07-48-43", "timestamp": 1749275323, "time_this_iter_s": 54.43871188163757, "time_total_s": 743.6023516654968, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 743.6023516654968, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 77.40793650793653, "ram_util_percent": 71.03333333333336, "gpu_util_percent0": 0.07349206349206351, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.5086983870967737e-05, "total_loss": -0.10462221218188378, "policy_loss": -0.012936030097493627, "vf_loss": 0.015649083365093578, "vf_explained_var": 0.7115885482051155, "kl": 0.0249513226250306, "entropy": 20.72070284236561, "entropy_coeff": 0.005508698387096774}, "model": {}, "num_grad_updates_lifetime": 7425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5584852, "num_env_steps_trained": 5584852, "num_agent_steps_sampled": 5584852, "num_agent_steps_trained": 5584852}, "sampler_results": {"episode_reward_max": 10.43247313589109, "episode_reward_min": -1.6627319745119744, "episode_reward_mean": 5.552383157137591, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.3641331542998705, 7.046330568363458, 3.760312978040797, 4.563420408394078, 9.550619486623033, 7.226403225348129, 9.781838077103044, 5.3586670412543524, 9.21249298460544, 5.813739967404808, 4.0419322505504365, 3.4960018729883076, 5.588323448264514, 8.204420809690978, 4.927952717773955, 2.164164664083952, -0.020577670098954216, 6.007613141747923, 4.768514925322695, 4.935082889361645, 3.673636809850732, 5.906487741005914, 2.121727314799621, 2.3540499752164843, 3.5109448456702617, 6.160910459661835, 8.227493398576547, 5.798838760171459, 8.192025621623861, 8.318279315681862, 3.3398075631407096, 7.51852180367492, 3.08874414806459, 8.75666130784771, 3.1498116352741965, 2.6265488982148297, 3.9524943783173843, 7.199543471349595, 5.922469361320495, 4.957906040759433, 5.647359655553608, 4.29297623032064, 7.10581045542241, 5.472208887250268, 8.39013698968387, 7.679693171811563, 7.026319107475512, 6.077381708917722, 8.918878555206133, 4.380013097158774, 3.9988146511055906, 4.375635642976223, 5.9980709427643575, 3.3620949513166067, 5.706514769163091, 8.645754140456301, 4.9891811473002265, 5.318746093235563, 5.3773055999059, 6.632903356554597, 5.341917149942854, 6.074482563734394, 5.80868953720937, 3.4913648913347317, 7.9942090003905255, 3.790199067870436, 8.167983958334808, 5.115715061185131, 7.235766652443506, 4.402228004854599, 4.824808162303474, 7.925930823897575, 7.141663184988694, 3.3969538962135224, 6.711425992520849, 1.7966704298933522, 9.274263178000666, 4.427439761629476, 5.997482960589888, 3.895274656244849, 3.8177619924104262, 7.319233900707282, 5.3833228448099035, 5.272991982256731, 10.43247313589109, 4.78249577632782, 4.624507017838212, 3.1830506583741545, 7.458351661857844, 4.4166243718954, 6.964165459313208, 3.0527517628292693, 7.595930099343981, 6.172275211117663, 2.8745257479558903, -1.6627319745119744, 5.784890949770557, 6.10509327390415, 7.214105959726992, 6.667938003433961], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.068818093216781, "mean_inference_ms": 7.952256522746245, "mean_action_processing_ms": 0.5351732491116714, "mean_env_wait_ms": 23.76180473547532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039211273193359375, "StateBufferConnector_ms": 0.03065180778503418, "ViewRequirementAgentConnector_ms": 0.9756479263305664}}, "episode_reward_max": 10.43247313589109, "episode_reward_min": -1.6627319745119744, "episode_reward_mean": 5.552383157137591, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.3641331542998705, 7.046330568363458, 3.760312978040797, 4.563420408394078, 9.550619486623033, 7.226403225348129, 9.781838077103044, 5.3586670412543524, 9.21249298460544, 5.813739967404808, 4.0419322505504365, 3.4960018729883076, 5.588323448264514, 8.204420809690978, 4.927952717773955, 2.164164664083952, -0.020577670098954216, 6.007613141747923, 4.768514925322695, 4.935082889361645, 3.673636809850732, 5.906487741005914, 2.121727314799621, 2.3540499752164843, 3.5109448456702617, 6.160910459661835, 8.227493398576547, 5.798838760171459, 8.192025621623861, 8.318279315681862, 3.3398075631407096, 7.51852180367492, 3.08874414806459, 8.75666130784771, 3.1498116352741965, 2.6265488982148297, 3.9524943783173843, 7.199543471349595, 5.922469361320495, 4.957906040759433, 5.647359655553608, 4.29297623032064, 7.10581045542241, 5.472208887250268, 8.39013698968387, 7.679693171811563, 7.026319107475512, 6.077381708917722, 8.918878555206133, 4.380013097158774, 3.9988146511055906, 4.375635642976223, 5.9980709427643575, 3.3620949513166067, 5.706514769163091, 8.645754140456301, 4.9891811473002265, 5.318746093235563, 5.3773055999059, 6.632903356554597, 5.341917149942854, 6.074482563734394, 5.80868953720937, 3.4913648913347317, 7.9942090003905255, 3.790199067870436, 8.167983958334808, 5.115715061185131, 7.235766652443506, 4.402228004854599, 4.824808162303474, 7.925930823897575, 7.141663184988694, 3.3969538962135224, 6.711425992520849, 1.7966704298933522, 9.274263178000666, 4.427439761629476, 5.997482960589888, 3.895274656244849, 3.8177619924104262, 7.319233900707282, 5.3833228448099035, 5.272991982256731, 10.43247313589109, 4.78249577632782, 4.624507017838212, 3.1830506583741545, 7.458351661857844, 4.4166243718954, 6.964165459313208, 3.0527517628292693, 7.595930099343981, 6.172275211117663, 2.8745257479558903, -1.6627319745119744, 5.784890949770557, 6.10509327390415, 7.214105959726992, 6.667938003433961], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.068818093216781, "mean_inference_ms": 7.952256522746245, "mean_action_processing_ms": 0.5351732491116714, "mean_env_wait_ms": 23.76180473547532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039211273193359375, "StateBufferConnector_ms": 0.03065180778503418, "ViewRequirementAgentConnector_ms": 0.9756479263305664}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5584852, "num_agent_steps_trained": 5584852, "num_env_steps_sampled": 5584852, "num_env_steps_trained": 5584852, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 288.90942584176264, "num_env_steps_trained_throughput_per_sec": 288.90942584176264, "timesteps_total": 5584852, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5584852, "timers": {"training_iteration_time_ms": 54019.552, "sample_time_ms": 41148.048, "load_time_ms": 1664.344, "load_throughput": 9395.892, "learn_time_ms": 10664.232, "learn_throughput": 1466.397, "synch_weights_time_ms": 425.885}, "counters": {"num_env_steps_sampled": 5584852, "num_env_steps_trained": 5584852, "num_agent_steps_sampled": 5584852, "num_agent_steps_trained": 5584852}, "done": false, "episodes_total": 196, "training_iteration": 362, "trial_id": "2f030_00000", "date": "2025-06-07_07-49-38", "timestamp": 1749275378, "time_this_iter_s": 54.14269256591797, "time_total_s": 797.7450442314148, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 797.7450442314148, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 76.89047619047619, "ram_util_percent": 70.30000000000001, "gpu_util_percent0": 0.07619047619047618, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.496087096774194e-05, "total_loss": -0.10334314361976629, "policy_loss": -0.01161749349229715, "vf_loss": 0.01599849437532777, "vf_explained_var": 0.7115905755216425, "kl": 0.02387198400069875, "entropy": 20.654694770466197, "entropy_coeff": 0.005496087096774195}, "model": {}, "num_grad_updates_lifetime": 7975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5600490, "num_env_steps_trained": 5600490, "num_agent_steps_sampled": 5600490, "num_agent_steps_trained": 5600490}, "sampler_results": {"episode_reward_max": 10.43247313589109, "episode_reward_min": -1.6627319745119744, "episode_reward_mean": 5.543115318074345, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.927952717773955, 2.164164664083952, -0.020577670098954216, 6.007613141747923, 4.768514925322695, 4.935082889361645, 3.673636809850732, 5.906487741005914, 2.121727314799621, 2.3540499752164843, 3.5109448456702617, 6.160910459661835, 8.227493398576547, 5.798838760171459, 8.192025621623861, 8.318279315681862, 3.3398075631407096, 7.51852180367492, 3.08874414806459, 8.75666130784771, 3.1498116352741965, 2.6265488982148297, 3.9524943783173843, 7.199543471349595, 5.922469361320495, 4.957906040759433, 5.647359655553608, 4.29297623032064, 7.10581045542241, 5.472208887250268, 8.39013698968387, 7.679693171811563, 7.026319107475512, 6.077381708917722, 8.918878555206133, 4.380013097158774, 3.9988146511055906, 4.375635642976223, 5.9980709427643575, 3.3620949513166067, 5.706514769163091, 8.645754140456301, 4.9891811473002265, 5.318746093235563, 5.3773055999059, 6.632903356554597, 5.341917149942854, 6.074482563734394, 5.80868953720937, 3.4913648913347317, 7.9942090003905255, 3.790199067870436, 8.167983958334808, 5.115715061185131, 7.235766652443506, 4.402228004854599, 4.824808162303474, 7.925930823897575, 7.141663184988694, 3.3969538962135224, 6.711425992520849, 1.7966704298933522, 9.274263178000666, 4.427439761629476, 5.997482960589888, 3.895274656244849, 3.8177619924104262, 7.319233900707282, 5.3833228448099035, 5.272991982256731, 10.43247313589109, 4.78249577632782, 4.624507017838212, 3.1830506583741545, 7.458351661857844, 4.4166243718954, 6.964165459313208, 3.0527517628292693, 7.595930099343981, 6.172275211117663, 2.8745257479558903, -1.6627319745119744, 5.784890949770557, 6.10509327390415, 7.214105959726992, 6.667938003433961, 6.081559790094541, 5.954692989232814, 5.20209167163546, 5.224501606804193, 9.081648496943254, 5.598366780820115, 7.4718448300458125, 2.6837960802405, 7.677267566317851, 8.780782279858082, 7.857005328668907, 4.204229710995979, 4.925606633323763, 6.3384586016252396], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0621827918620794, "mean_inference_ms": 7.950544734458249, "mean_action_processing_ms": 0.5353740034671566, "mean_env_wait_ms": 23.744870721886073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03159189224243164, "StateBufferConnector_ms": 0.030923843383789062, "ViewRequirementAgentConnector_ms": 0.9577083587646484}}, "episode_reward_max": 10.43247313589109, "episode_reward_min": -1.6627319745119744, "episode_reward_mean": 5.543115318074345, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.927952717773955, 2.164164664083952, -0.020577670098954216, 6.007613141747923, 4.768514925322695, 4.935082889361645, 3.673636809850732, 5.906487741005914, 2.121727314799621, 2.3540499752164843, 3.5109448456702617, 6.160910459661835, 8.227493398576547, 5.798838760171459, 8.192025621623861, 8.318279315681862, 3.3398075631407096, 7.51852180367492, 3.08874414806459, 8.75666130784771, 3.1498116352741965, 2.6265488982148297, 3.9524943783173843, 7.199543471349595, 5.922469361320495, 4.957906040759433, 5.647359655553608, 4.29297623032064, 7.10581045542241, 5.472208887250268, 8.39013698968387, 7.679693171811563, 7.026319107475512, 6.077381708917722, 8.918878555206133, 4.380013097158774, 3.9988146511055906, 4.375635642976223, 5.9980709427643575, 3.3620949513166067, 5.706514769163091, 8.645754140456301, 4.9891811473002265, 5.318746093235563, 5.3773055999059, 6.632903356554597, 5.341917149942854, 6.074482563734394, 5.80868953720937, 3.4913648913347317, 7.9942090003905255, 3.790199067870436, 8.167983958334808, 5.115715061185131, 7.235766652443506, 4.402228004854599, 4.824808162303474, 7.925930823897575, 7.141663184988694, 3.3969538962135224, 6.711425992520849, 1.7966704298933522, 9.274263178000666, 4.427439761629476, 5.997482960589888, 3.895274656244849, 3.8177619924104262, 7.319233900707282, 5.3833228448099035, 5.272991982256731, 10.43247313589109, 4.78249577632782, 4.624507017838212, 3.1830506583741545, 7.458351661857844, 4.4166243718954, 6.964165459313208, 3.0527517628292693, 7.595930099343981, 6.172275211117663, 2.8745257479558903, -1.6627319745119744, 5.784890949770557, 6.10509327390415, 7.214105959726992, 6.667938003433961, 6.081559790094541, 5.954692989232814, 5.20209167163546, 5.224501606804193, 9.081648496943254, 5.598366780820115, 7.4718448300458125, 2.6837960802405, 7.677267566317851, 8.780782279858082, 7.857005328668907, 4.204229710995979, 4.925606633323763, 6.3384586016252396], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0621827918620794, "mean_inference_ms": 7.950544734458249, "mean_action_processing_ms": 0.5353740034671566, "mean_env_wait_ms": 23.744870721886073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03159189224243164, "StateBufferConnector_ms": 0.030923843383789062, "ViewRequirementAgentConnector_ms": 0.9577083587646484}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5600490, "num_agent_steps_trained": 5600490, "num_env_steps_sampled": 5600490, "num_env_steps_trained": 5600490, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 291.71073718483626, "num_env_steps_trained_throughput_per_sec": 291.71073718483626, "timesteps_total": 5600490, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5600490, "timers": {"training_iteration_time_ms": 53977.406, "sample_time_ms": 41142.972, "load_time_ms": 1663.793, "load_throughput": 9399.007, "learn_time_ms": 10630.523, "learn_throughput": 1471.047, "synch_weights_time_ms": 421.31}, "counters": {"num_env_steps_sampled": 5600490, "num_env_steps_trained": 5600490, "num_agent_steps_sampled": 5600490, "num_agent_steps_trained": 5600490}, "done": false, "episodes_total": 210, "training_iteration": 363, "trial_id": "2f030_00000", "date": "2025-06-07_07-50-31", "timestamp": 1749275431, "time_this_iter_s": 53.63751220703125, "time_total_s": 851.382556438446, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 851.382556438446, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 77.46065573770494, "ram_util_percent": 70.80000000000001, "gpu_util_percent0": 0.08032786885245902, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.4834758064516125e-05, "total_loss": -0.11058743667788803, "policy_loss": -0.01860052443162369, "vf_loss": 0.017167974358255213, "vf_explained_var": 0.7072534436529333, "kl": 0.02374397856757283, "entropy": 20.797205543518068, "entropy_coeff": 0.005483475806451614}, "model": {}, "num_grad_updates_lifetime": 8525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5616128, "num_env_steps_trained": 5616128, "num_agent_steps_sampled": 5616128, "num_agent_steps_trained": 5616128}, "sampler_results": {"episode_reward_max": 10.43247313589109, "episode_reward_min": -1.6627319745119744, "episode_reward_mean": 5.675424411932657, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.192025621623861, 8.318279315681862, 3.3398075631407096, 7.51852180367492, 3.08874414806459, 8.75666130784771, 3.1498116352741965, 2.6265488982148297, 3.9524943783173843, 7.199543471349595, 5.922469361320495, 4.957906040759433, 5.647359655553608, 4.29297623032064, 7.10581045542241, 5.472208887250268, 8.39013698968387, 7.679693171811563, 7.026319107475512, 6.077381708917722, 8.918878555206133, 4.380013097158774, 3.9988146511055906, 4.375635642976223, 5.9980709427643575, 3.3620949513166067, 5.706514769163091, 8.645754140456301, 4.9891811473002265, 5.318746093235563, 5.3773055999059, 6.632903356554597, 5.341917149942854, 6.074482563734394, 5.80868953720937, 3.4913648913347317, 7.9942090003905255, 3.790199067870436, 8.167983958334808, 5.115715061185131, 7.235766652443506, 4.402228004854599, 4.824808162303474, 7.925930823897575, 7.141663184988694, 3.3969538962135224, 6.711425992520849, 1.7966704298933522, 9.274263178000666, 4.427439761629476, 5.997482960589888, 3.895274656244849, 3.8177619924104262, 7.319233900707282, 5.3833228448099035, 5.272991982256731, 10.43247313589109, 4.78249577632782, 4.624507017838212, 3.1830506583741545, 7.458351661857844, 4.4166243718954, 6.964165459313208, 3.0527517628292693, 7.595930099343981, 6.172275211117663, 2.8745257479558903, -1.6627319745119744, 5.784890949770557, 6.10509327390415, 7.214105959726992, 6.667938003433961, 6.081559790094541, 5.954692989232814, 5.20209167163546, 5.224501606804193, 9.081648496943254, 5.598366780820115, 7.4718448300458125, 2.6837960802405, 7.677267566317851, 8.780782279858082, 7.857005328668907, 4.204229710995979, 4.925606633323763, 6.3384586016252396, 1.9987841120023673, 1.9707361442742213, 4.9802488171976105, 3.5402241775819387, 4.6893519148565925, 7.210737757431194, 5.154756984256521, 8.140627957402527, 5.869708630152237, 4.683982747289531, 6.27511258033256, 8.350672987319745, 5.322894571016627, 5.579909977861753], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0566560285639635, "mean_inference_ms": 7.949252734318639, "mean_action_processing_ms": 0.535400197812165, "mean_env_wait_ms": 23.736471032705623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0385746955871582, "StateBufferConnector_ms": 0.036004066467285156, "ViewRequirementAgentConnector_ms": 0.9539411067962646}}, "episode_reward_max": 10.43247313589109, "episode_reward_min": -1.6627319745119744, "episode_reward_mean": 5.675424411932657, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.192025621623861, 8.318279315681862, 3.3398075631407096, 7.51852180367492, 3.08874414806459, 8.75666130784771, 3.1498116352741965, 2.6265488982148297, 3.9524943783173843, 7.199543471349595, 5.922469361320495, 4.957906040759433, 5.647359655553608, 4.29297623032064, 7.10581045542241, 5.472208887250268, 8.39013698968387, 7.679693171811563, 7.026319107475512, 6.077381708917722, 8.918878555206133, 4.380013097158774, 3.9988146511055906, 4.375635642976223, 5.9980709427643575, 3.3620949513166067, 5.706514769163091, 8.645754140456301, 4.9891811473002265, 5.318746093235563, 5.3773055999059, 6.632903356554597, 5.341917149942854, 6.074482563734394, 5.80868953720937, 3.4913648913347317, 7.9942090003905255, 3.790199067870436, 8.167983958334808, 5.115715061185131, 7.235766652443506, 4.402228004854599, 4.824808162303474, 7.925930823897575, 7.141663184988694, 3.3969538962135224, 6.711425992520849, 1.7966704298933522, 9.274263178000666, 4.427439761629476, 5.997482960589888, 3.895274656244849, 3.8177619924104262, 7.319233900707282, 5.3833228448099035, 5.272991982256731, 10.43247313589109, 4.78249577632782, 4.624507017838212, 3.1830506583741545, 7.458351661857844, 4.4166243718954, 6.964165459313208, 3.0527517628292693, 7.595930099343981, 6.172275211117663, 2.8745257479558903, -1.6627319745119744, 5.784890949770557, 6.10509327390415, 7.214105959726992, 6.667938003433961, 6.081559790094541, 5.954692989232814, 5.20209167163546, 5.224501606804193, 9.081648496943254, 5.598366780820115, 7.4718448300458125, 2.6837960802405, 7.677267566317851, 8.780782279858082, 7.857005328668907, 4.204229710995979, 4.925606633323763, 6.3384586016252396, 1.9987841120023673, 1.9707361442742213, 4.9802488171976105, 3.5402241775819387, 4.6893519148565925, 7.210737757431194, 5.154756984256521, 8.140627957402527, 5.869708630152237, 4.683982747289531, 6.27511258033256, 8.350672987319745, 5.322894571016627, 5.579909977861753], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0566560285639635, "mean_inference_ms": 7.949252734318639, "mean_action_processing_ms": 0.535400197812165, "mean_env_wait_ms": 23.736471032705623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0385746955871582, "StateBufferConnector_ms": 0.036004066467285156, "ViewRequirementAgentConnector_ms": 0.9539411067962646}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5616128, "num_agent_steps_trained": 5616128, "num_env_steps_sampled": 5616128, "num_env_steps_trained": 5616128, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 288.29556279457756, "num_env_steps_trained_throughput_per_sec": 288.29556279457756, "timesteps_total": 5616128, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5616128, "timers": {"training_iteration_time_ms": 54052.841, "sample_time_ms": 41202.128, "load_time_ms": 1680.813, "load_throughput": 9303.831, "learn_time_ms": 10627.974, "learn_throughput": 1471.4, "synch_weights_time_ms": 422.169}, "counters": {"num_env_steps_sampled": 5616128, "num_env_steps_trained": 5616128, "num_agent_steps_sampled": 5616128, "num_agent_steps_trained": 5616128}, "done": false, "episodes_total": 224, "training_iteration": 364, "trial_id": "2f030_00000", "date": "2025-06-07_07-51-26", "timestamp": 1749275486, "time_this_iter_s": 54.25793099403381, "time_total_s": 905.6404874324799, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 905.6404874324799, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 78.17377049180328, "ram_util_percent": 71.10655737704917, "gpu_util_percent0": 0.07573770491803279, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.470864516129033e-05, "total_loss": -0.11839183748107066, "policy_loss": -0.02599729567543942, "vf_loss": 0.01711889339356937, "vf_explained_var": 0.702924747467041, "kl": 0.022828582669838747, "entropy": 20.797846697027033, "entropy_coeff": 0.005470864516129033}, "model": {}, "num_grad_updates_lifetime": 9075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5631766, "num_env_steps_trained": 5631766, "num_agent_steps_sampled": 5631766, "num_agent_steps_trained": 5631766}, "sampler_results": {"episode_reward_max": 10.43247313589109, "episode_reward_min": -1.6627319745119744, "episode_reward_mean": 5.6265385062382824, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.10581045542241, 5.472208887250268, 8.39013698968387, 7.679693171811563, 7.026319107475512, 6.077381708917722, 8.918878555206133, 4.380013097158774, 3.9988146511055906, 4.375635642976223, 5.9980709427643575, 3.3620949513166067, 5.706514769163091, 8.645754140456301, 4.9891811473002265, 5.318746093235563, 5.3773055999059, 6.632903356554597, 5.341917149942854, 6.074482563734394, 5.80868953720937, 3.4913648913347317, 7.9942090003905255, 3.790199067870436, 8.167983958334808, 5.115715061185131, 7.235766652443506, 4.402228004854599, 4.824808162303474, 7.925930823897575, 7.141663184988694, 3.3969538962135224, 6.711425992520849, 1.7966704298933522, 9.274263178000666, 4.427439761629476, 5.997482960589888, 3.895274656244849, 3.8177619924104262, 7.319233900707282, 5.3833228448099035, 5.272991982256731, 10.43247313589109, 4.78249577632782, 4.624507017838212, 3.1830506583741545, 7.458351661857844, 4.4166243718954, 6.964165459313208, 3.0527517628292693, 7.595930099343981, 6.172275211117663, 2.8745257479558903, -1.6627319745119744, 5.784890949770557, 6.10509327390415, 7.214105959726992, 6.667938003433961, 6.081559790094541, 5.954692989232814, 5.20209167163546, 5.224501606804193, 9.081648496943254, 5.598366780820115, 7.4718448300458125, 2.6837960802405, 7.677267566317851, 8.780782279858082, 7.857005328668907, 4.204229710995979, 4.925606633323763, 6.3384586016252396, 1.9987841120023673, 1.9707361442742213, 4.9802488171976105, 3.5402241775819387, 4.6893519148565925, 7.210737757431194, 5.154756984256521, 8.140627957402527, 5.869708630152237, 4.683982747289531, 6.27511258033256, 8.350672987319745, 5.322894571016627, 5.579909977861753, 3.8807370748946233, 3.7136464202098285, 7.350592238919443, 4.450008105300252, 7.181196335573617, 9.63295994964777, 6.310942416424339, 5.831434938530929, 2.123361698281934, 7.346008287819263, 5.370618255001533, 4.697797186323254, -0.8960400652632492, 5.081296020042982], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0523401012691886, "mean_inference_ms": 7.947830287591603, "mean_action_processing_ms": 0.5353220467763237, "mean_env_wait_ms": 23.72747966401151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0374453067779541, "StateBufferConnector_ms": 0.041298866271972656, "ViewRequirementAgentConnector_ms": 0.9544322490692139}}, "episode_reward_max": 10.43247313589109, "episode_reward_min": -1.6627319745119744, "episode_reward_mean": 5.6265385062382824, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.10581045542241, 5.472208887250268, 8.39013698968387, 7.679693171811563, 7.026319107475512, 6.077381708917722, 8.918878555206133, 4.380013097158774, 3.9988146511055906, 4.375635642976223, 5.9980709427643575, 3.3620949513166067, 5.706514769163091, 8.645754140456301, 4.9891811473002265, 5.318746093235563, 5.3773055999059, 6.632903356554597, 5.341917149942854, 6.074482563734394, 5.80868953720937, 3.4913648913347317, 7.9942090003905255, 3.790199067870436, 8.167983958334808, 5.115715061185131, 7.235766652443506, 4.402228004854599, 4.824808162303474, 7.925930823897575, 7.141663184988694, 3.3969538962135224, 6.711425992520849, 1.7966704298933522, 9.274263178000666, 4.427439761629476, 5.997482960589888, 3.895274656244849, 3.8177619924104262, 7.319233900707282, 5.3833228448099035, 5.272991982256731, 10.43247313589109, 4.78249577632782, 4.624507017838212, 3.1830506583741545, 7.458351661857844, 4.4166243718954, 6.964165459313208, 3.0527517628292693, 7.595930099343981, 6.172275211117663, 2.8745257479558903, -1.6627319745119744, 5.784890949770557, 6.10509327390415, 7.214105959726992, 6.667938003433961, 6.081559790094541, 5.954692989232814, 5.20209167163546, 5.224501606804193, 9.081648496943254, 5.598366780820115, 7.4718448300458125, 2.6837960802405, 7.677267566317851, 8.780782279858082, 7.857005328668907, 4.204229710995979, 4.925606633323763, 6.3384586016252396, 1.9987841120023673, 1.9707361442742213, 4.9802488171976105, 3.5402241775819387, 4.6893519148565925, 7.210737757431194, 5.154756984256521, 8.140627957402527, 5.869708630152237, 4.683982747289531, 6.27511258033256, 8.350672987319745, 5.322894571016627, 5.579909977861753, 3.8807370748946233, 3.7136464202098285, 7.350592238919443, 4.450008105300252, 7.181196335573617, 9.63295994964777, 6.310942416424339, 5.831434938530929, 2.123361698281934, 7.346008287819263, 5.370618255001533, 4.697797186323254, -0.8960400652632492, 5.081296020042982], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0523401012691886, "mean_inference_ms": 7.947830287591603, "mean_action_processing_ms": 0.5353220467763237, "mean_env_wait_ms": 23.72747966401151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0374453067779541, "StateBufferConnector_ms": 0.041298866271972656, "ViewRequirementAgentConnector_ms": 0.9544322490692139}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5631766, "num_agent_steps_trained": 5631766, "num_env_steps_sampled": 5631766, "num_env_steps_trained": 5631766, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 290.6403250951915, "num_env_steps_trained_throughput_per_sec": 290.6403250951915, "timesteps_total": 5631766, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5631766, "timers": {"training_iteration_time_ms": 54024.836, "sample_time_ms": 41161.673, "load_time_ms": 1702.018, "load_throughput": 9187.916, "learn_time_ms": 10617.876, "learn_throughput": 1472.799, "synch_weights_time_ms": 421.851}, "counters": {"num_env_steps_sampled": 5631766, "num_env_steps_trained": 5631766, "num_agent_steps_sampled": 5631766, "num_agent_steps_trained": 5631766}, "done": false, "episodes_total": 238, "training_iteration": 365, "trial_id": "2f030_00000", "date": "2025-06-07_07-52-20", "timestamp": 1749275540, "time_this_iter_s": 53.82233953475952, "time_total_s": 959.4628269672394, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 959.4628269672394, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 76.99193548387096, "ram_util_percent": 70.90806451612903, "gpu_util_percent0": 0.08612903225806451, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.458253225806452e-05, "total_loss": -0.11244412235746329, "policy_loss": -0.019978633117805823, "vf_loss": 0.016739848778075116, "vf_explained_var": 0.6668998808210547, "kl": 0.022098008274016055, "entropy": 20.742775923989036, "entropy_coeff": 0.005458253225806452}, "model": {}, "num_grad_updates_lifetime": 9625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5647404, "num_env_steps_trained": 5647404, "num_agent_steps_sampled": 5647404, "num_agent_steps_trained": 5647404}, "sampler_results": {"episode_reward_max": 10.43247313589109, "episode_reward_min": -1.6627319745119744, "episode_reward_mean": 5.63808058885579, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.9891811473002265, 5.318746093235563, 5.3773055999059, 6.632903356554597, 5.341917149942854, 6.074482563734394, 5.80868953720937, 3.4913648913347317, 7.9942090003905255, 3.790199067870436, 8.167983958334808, 5.115715061185131, 7.235766652443506, 4.402228004854599, 4.824808162303474, 7.925930823897575, 7.141663184988694, 3.3969538962135224, 6.711425992520849, 1.7966704298933522, 9.274263178000666, 4.427439761629476, 5.997482960589888, 3.895274656244849, 3.8177619924104262, 7.319233900707282, 5.3833228448099035, 5.272991982256731, 10.43247313589109, 4.78249577632782, 4.624507017838212, 3.1830506583741545, 7.458351661857844, 4.4166243718954, 6.964165459313208, 3.0527517628292693, 7.595930099343981, 6.172275211117663, 2.8745257479558903, -1.6627319745119744, 5.784890949770557, 6.10509327390415, 7.214105959726992, 6.667938003433961, 6.081559790094541, 5.954692989232814, 5.20209167163546, 5.224501606804193, 9.081648496943254, 5.598366780820115, 7.4718448300458125, 2.6837960802405, 7.677267566317851, 8.780782279858082, 7.857005328668907, 4.204229710995979, 4.925606633323763, 6.3384586016252396, 1.9987841120023673, 1.9707361442742213, 4.9802488171976105, 3.5402241775819387, 4.6893519148565925, 7.210737757431194, 5.154756984256521, 8.140627957402527, 5.869708630152237, 4.683982747289531, 6.27511258033256, 8.350672987319745, 5.322894571016627, 5.579909977861753, 3.8807370748946233, 3.7136464202098285, 7.350592238919443, 4.450008105300252, 7.181196335573617, 9.63295994964777, 6.310942416424339, 5.831434938530929, 2.123361698281934, 7.346008287819263, 5.370618255001533, 4.697797186323254, -0.8960400652632492, 5.081296020042982, 6.387442048541803, 7.248289570628484, 5.583606162325579, 7.5127013031981855, 8.978937634249254, 8.320670203652488, 2.793727885011145, 2.3777915947719444, 7.948389552664664, 4.406126016193685, 8.342095881207479, 4.242879439892493, 6.448148656390397, 7.700729383731515], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0452445961634065, "mean_inference_ms": 7.946655706050327, "mean_action_processing_ms": 0.5352524401913691, "mean_env_wait_ms": 23.72036929700045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03737974166870117, "StateBufferConnector_ms": 0.038304805755615234, "ViewRequirementAgentConnector_ms": 0.9609732627868652}}, "episode_reward_max": 10.43247313589109, "episode_reward_min": -1.6627319745119744, "episode_reward_mean": 5.63808058885579, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.9891811473002265, 5.318746093235563, 5.3773055999059, 6.632903356554597, 5.341917149942854, 6.074482563734394, 5.80868953720937, 3.4913648913347317, 7.9942090003905255, 3.790199067870436, 8.167983958334808, 5.115715061185131, 7.235766652443506, 4.402228004854599, 4.824808162303474, 7.925930823897575, 7.141663184988694, 3.3969538962135224, 6.711425992520849, 1.7966704298933522, 9.274263178000666, 4.427439761629476, 5.997482960589888, 3.895274656244849, 3.8177619924104262, 7.319233900707282, 5.3833228448099035, 5.272991982256731, 10.43247313589109, 4.78249577632782, 4.624507017838212, 3.1830506583741545, 7.458351661857844, 4.4166243718954, 6.964165459313208, 3.0527517628292693, 7.595930099343981, 6.172275211117663, 2.8745257479558903, -1.6627319745119744, 5.784890949770557, 6.10509327390415, 7.214105959726992, 6.667938003433961, 6.081559790094541, 5.954692989232814, 5.20209167163546, 5.224501606804193, 9.081648496943254, 5.598366780820115, 7.4718448300458125, 2.6837960802405, 7.677267566317851, 8.780782279858082, 7.857005328668907, 4.204229710995979, 4.925606633323763, 6.3384586016252396, 1.9987841120023673, 1.9707361442742213, 4.9802488171976105, 3.5402241775819387, 4.6893519148565925, 7.210737757431194, 5.154756984256521, 8.140627957402527, 5.869708630152237, 4.683982747289531, 6.27511258033256, 8.350672987319745, 5.322894571016627, 5.579909977861753, 3.8807370748946233, 3.7136464202098285, 7.350592238919443, 4.450008105300252, 7.181196335573617, 9.63295994964777, 6.310942416424339, 5.831434938530929, 2.123361698281934, 7.346008287819263, 5.370618255001533, 4.697797186323254, -0.8960400652632492, 5.081296020042982, 6.387442048541803, 7.248289570628484, 5.583606162325579, 7.5127013031981855, 8.978937634249254, 8.320670203652488, 2.793727885011145, 2.3777915947719444, 7.948389552664664, 4.406126016193685, 8.342095881207479, 4.242879439892493, 6.448148656390397, 7.700729383731515], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0452445961634065, "mean_inference_ms": 7.946655706050327, "mean_action_processing_ms": 0.5352524401913691, "mean_env_wait_ms": 23.72036929700045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03737974166870117, "StateBufferConnector_ms": 0.038304805755615234, "ViewRequirementAgentConnector_ms": 0.9609732627868652}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5647404, "num_agent_steps_trained": 5647404, "num_env_steps_sampled": 5647404, "num_env_steps_trained": 5647404, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 288.7674638890245, "num_env_steps_trained_throughput_per_sec": 288.7674638890245, "timesteps_total": 5647404, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5647404, "timers": {"training_iteration_time_ms": 54026.529, "sample_time_ms": 41129.662, "load_time_ms": 1718.581, "load_throughput": 9099.366, "learn_time_ms": 10637.614, "learn_throughput": 1470.067, "synch_weights_time_ms": 423.016}, "counters": {"num_env_steps_sampled": 5647404, "num_env_steps_trained": 5647404, "num_agent_steps_sampled": 5647404, "num_agent_steps_trained": 5647404}, "done": false, "episodes_total": 252, "training_iteration": 366, "trial_id": "2f030_00000", "date": "2025-06-07_07-53-14", "timestamp": 1749275594, "time_this_iter_s": 54.17028784751892, "time_total_s": 1013.6331148147583, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1013.6331148147583, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 77.3225806451613, "ram_util_percent": 70.55322580645164, "gpu_util_percent0": 0.07838709677419356, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.445641935483871e-05, "total_loss": -0.11686444331468507, "policy_loss": -0.02427928844953633, "vf_loss": 0.01653910179622471, "vf_explained_var": 0.7004805094545538, "kl": 0.02216614628942385, "entropy": 20.810636915727095, "entropy_coeff": 0.005445641935483871}, "model": {}, "num_grad_updates_lifetime": 10175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5663042, "num_env_steps_trained": 5663042, "num_agent_steps_sampled": 5663042, "num_agent_steps_trained": 5663042}, "sampler_results": {"episode_reward_max": 10.43247313589109, "episode_reward_min": -1.6627319745119744, "episode_reward_mean": 5.695563119019663, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.824808162303474, 7.925930823897575, 7.141663184988694, 3.3969538962135224, 6.711425992520849, 1.7966704298933522, 9.274263178000666, 4.427439761629476, 5.997482960589888, 3.895274656244849, 3.8177619924104262, 7.319233900707282, 5.3833228448099035, 5.272991982256731, 10.43247313589109, 4.78249577632782, 4.624507017838212, 3.1830506583741545, 7.458351661857844, 4.4166243718954, 6.964165459313208, 3.0527517628292693, 7.595930099343981, 6.172275211117663, 2.8745257479558903, -1.6627319745119744, 5.784890949770557, 6.10509327390415, 7.214105959726992, 6.667938003433961, 6.081559790094541, 5.954692989232814, 5.20209167163546, 5.224501606804193, 9.081648496943254, 5.598366780820115, 7.4718448300458125, 2.6837960802405, 7.677267566317851, 8.780782279858082, 7.857005328668907, 4.204229710995979, 4.925606633323763, 6.3384586016252396, 1.9987841120023673, 1.9707361442742213, 4.9802488171976105, 3.5402241775819387, 4.6893519148565925, 7.210737757431194, 5.154756984256521, 8.140627957402527, 5.869708630152237, 4.683982747289531, 6.27511258033256, 8.350672987319745, 5.322894571016627, 5.579909977861753, 3.8807370748946233, 3.7136464202098285, 7.350592238919443, 4.450008105300252, 7.181196335573617, 9.63295994964777, 6.310942416424339, 5.831434938530929, 2.123361698281934, 7.346008287819263, 5.370618255001533, 4.697797186323254, -0.8960400652632492, 5.081296020042982, 6.387442048541803, 7.248289570628484, 5.583606162325579, 7.5127013031981855, 8.978937634249254, 8.320670203652488, 2.793727885011145, 2.3777915947719444, 7.948389552664664, 4.406126016193685, 8.342095881207479, 4.242879439892493, 6.448148656390397, 7.700729383731515, 7.348072008082465, 6.929480399988162, 5.250910974500274, 4.320760746657362, 6.405935364486464, 6.589588062958916, 1.2402227600344171, 6.907400603930768, 6.572789037489253, 8.886776085225975, 7.956700376749652, 3.8174206970652413, 9.172979279625363, 4.089908703889593], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0384182686529853, "mean_inference_ms": 7.947588737557948, "mean_action_processing_ms": 0.5353191259110304, "mean_env_wait_ms": 23.718963451510998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044466495513916016, "StateBufferConnector_ms": 0.036251068115234375, "ViewRequirementAgentConnector_ms": 0.9609687328338623}}, "episode_reward_max": 10.43247313589109, "episode_reward_min": -1.6627319745119744, "episode_reward_mean": 5.695563119019663, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.824808162303474, 7.925930823897575, 7.141663184988694, 3.3969538962135224, 6.711425992520849, 1.7966704298933522, 9.274263178000666, 4.427439761629476, 5.997482960589888, 3.895274656244849, 3.8177619924104262, 7.319233900707282, 5.3833228448099035, 5.272991982256731, 10.43247313589109, 4.78249577632782, 4.624507017838212, 3.1830506583741545, 7.458351661857844, 4.4166243718954, 6.964165459313208, 3.0527517628292693, 7.595930099343981, 6.172275211117663, 2.8745257479558903, -1.6627319745119744, 5.784890949770557, 6.10509327390415, 7.214105959726992, 6.667938003433961, 6.081559790094541, 5.954692989232814, 5.20209167163546, 5.224501606804193, 9.081648496943254, 5.598366780820115, 7.4718448300458125, 2.6837960802405, 7.677267566317851, 8.780782279858082, 7.857005328668907, 4.204229710995979, 4.925606633323763, 6.3384586016252396, 1.9987841120023673, 1.9707361442742213, 4.9802488171976105, 3.5402241775819387, 4.6893519148565925, 7.210737757431194, 5.154756984256521, 8.140627957402527, 5.869708630152237, 4.683982747289531, 6.27511258033256, 8.350672987319745, 5.322894571016627, 5.579909977861753, 3.8807370748946233, 3.7136464202098285, 7.350592238919443, 4.450008105300252, 7.181196335573617, 9.63295994964777, 6.310942416424339, 5.831434938530929, 2.123361698281934, 7.346008287819263, 5.370618255001533, 4.697797186323254, -0.8960400652632492, 5.081296020042982, 6.387442048541803, 7.248289570628484, 5.583606162325579, 7.5127013031981855, 8.978937634249254, 8.320670203652488, 2.793727885011145, 2.3777915947719444, 7.948389552664664, 4.406126016193685, 8.342095881207479, 4.242879439892493, 6.448148656390397, 7.700729383731515, 7.348072008082465, 6.929480399988162, 5.250910974500274, 4.320760746657362, 6.405935364486464, 6.589588062958916, 1.2402227600344171, 6.907400603930768, 6.572789037489253, 8.886776085225975, 7.956700376749652, 3.8174206970652413, 9.172979279625363, 4.089908703889593], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0384182686529853, "mean_inference_ms": 7.947588737557948, "mean_action_processing_ms": 0.5353191259110304, "mean_env_wait_ms": 23.718963451510998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044466495513916016, "StateBufferConnector_ms": 0.036251068115234375, "ViewRequirementAgentConnector_ms": 0.9609687328338623}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5663042, "num_agent_steps_trained": 5663042, "num_env_steps_sampled": 5663042, "num_env_steps_trained": 5663042, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 287.42753217286986, "num_env_steps_trained_throughput_per_sec": 287.42753217286986, "timesteps_total": 5663042, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5663042, "timers": {"training_iteration_time_ms": 54039.456, "sample_time_ms": 41151.513, "load_time_ms": 1723.887, "load_throughput": 9071.362, "learn_time_ms": 10624.006, "learn_throughput": 1471.949, "synch_weights_time_ms": 421.794}, "counters": {"num_env_steps_sampled": 5663042, "num_env_steps_trained": 5663042, "num_agent_steps_sampled": 5663042, "num_agent_steps_trained": 5663042}, "done": false, "episodes_total": 266, "training_iteration": 367, "trial_id": "2f030_00000", "date": "2025-06-07_07-54-08", "timestamp": 1749275648, "time_this_iter_s": 54.423750162124634, "time_total_s": 1068.056864976883, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1068.056864976883, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 76.96031746031746, "ram_util_percent": 70.8888888888889, "gpu_util_percent0": 0.08476190476190476, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.433030645161291e-05, "total_loss": -0.12019171751273626, "policy_loss": -0.028547961939845913, "vf_loss": 0.016333003066141497, "vf_explained_var": 0.6822631136937575, "kl": 0.023035257547607168, "entropy": 20.788173887079413, "entropy_coeff": 0.00543303064516129}, "model": {}, "num_grad_updates_lifetime": 10725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5678680, "num_env_steps_trained": 5678680, "num_agent_steps_sampled": 5678680, "num_agent_steps_trained": 5678680}, "sampler_results": {"episode_reward_max": 10.43247313589109, "episode_reward_min": -1.6627319745119744, "episode_reward_mean": 5.63935996739516, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.43247313589109, 4.78249577632782, 4.624507017838212, 3.1830506583741545, 7.458351661857844, 4.4166243718954, 6.964165459313208, 3.0527517628292693, 7.595930099343981, 6.172275211117663, 2.8745257479558903, -1.6627319745119744, 5.784890949770557, 6.10509327390415, 7.214105959726992, 6.667938003433961, 6.081559790094541, 5.954692989232814, 5.20209167163546, 5.224501606804193, 9.081648496943254, 5.598366780820115, 7.4718448300458125, 2.6837960802405, 7.677267566317851, 8.780782279858082, 7.857005328668907, 4.204229710995979, 4.925606633323763, 6.3384586016252396, 1.9987841120023673, 1.9707361442742213, 4.9802488171976105, 3.5402241775819387, 4.6893519148565925, 7.210737757431194, 5.154756984256521, 8.140627957402527, 5.869708630152237, 4.683982747289531, 6.27511258033256, 8.350672987319745, 5.322894571016627, 5.579909977861753, 3.8807370748946233, 3.7136464202098285, 7.350592238919443, 4.450008105300252, 7.181196335573617, 9.63295994964777, 6.310942416424339, 5.831434938530929, 2.123361698281934, 7.346008287819263, 5.370618255001533, 4.697797186323254, -0.8960400652632492, 5.081296020042982, 6.387442048541803, 7.248289570628484, 5.583606162325579, 7.5127013031981855, 8.978937634249254, 8.320670203652488, 2.793727885011145, 2.3777915947719444, 7.948389552664664, 4.406126016193685, 8.342095881207479, 4.242879439892493, 6.448148656390397, 7.700729383731515, 7.348072008082465, 6.929480399988162, 5.250910974500274, 4.320760746657362, 6.405935364486464, 6.589588062958916, 1.2402227600344171, 6.907400603930768, 6.572789037489253, 8.886776085225975, 7.956700376749652, 3.8174206970652413, 9.172979279625363, 4.089908703889593, 3.8072180447929624, 2.4702382047728, 5.108387044465443, 2.9741294156308125, 4.415862851555437, 7.477619817483657, 6.67904809274113, 1.5465529786572443, 7.796355128713589, 9.368114939337463, 4.574879198077739, 3.16958718327582, 7.718037762474914, 4.4588779420373665], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0311991398533906, "mean_inference_ms": 7.949843629369903, "mean_action_processing_ms": 0.5353008029741964, "mean_env_wait_ms": 23.716369396246137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04548788070678711, "StateBufferConnector_ms": 0.0383448600769043, "ViewRequirementAgentConnector_ms": 0.9529104232788086}}, "episode_reward_max": 10.43247313589109, "episode_reward_min": -1.6627319745119744, "episode_reward_mean": 5.63935996739516, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.43247313589109, 4.78249577632782, 4.624507017838212, 3.1830506583741545, 7.458351661857844, 4.4166243718954, 6.964165459313208, 3.0527517628292693, 7.595930099343981, 6.172275211117663, 2.8745257479558903, -1.6627319745119744, 5.784890949770557, 6.10509327390415, 7.214105959726992, 6.667938003433961, 6.081559790094541, 5.954692989232814, 5.20209167163546, 5.224501606804193, 9.081648496943254, 5.598366780820115, 7.4718448300458125, 2.6837960802405, 7.677267566317851, 8.780782279858082, 7.857005328668907, 4.204229710995979, 4.925606633323763, 6.3384586016252396, 1.9987841120023673, 1.9707361442742213, 4.9802488171976105, 3.5402241775819387, 4.6893519148565925, 7.210737757431194, 5.154756984256521, 8.140627957402527, 5.869708630152237, 4.683982747289531, 6.27511258033256, 8.350672987319745, 5.322894571016627, 5.579909977861753, 3.8807370748946233, 3.7136464202098285, 7.350592238919443, 4.450008105300252, 7.181196335573617, 9.63295994964777, 6.310942416424339, 5.831434938530929, 2.123361698281934, 7.346008287819263, 5.370618255001533, 4.697797186323254, -0.8960400652632492, 5.081296020042982, 6.387442048541803, 7.248289570628484, 5.583606162325579, 7.5127013031981855, 8.978937634249254, 8.320670203652488, 2.793727885011145, 2.3777915947719444, 7.948389552664664, 4.406126016193685, 8.342095881207479, 4.242879439892493, 6.448148656390397, 7.700729383731515, 7.348072008082465, 6.929480399988162, 5.250910974500274, 4.320760746657362, 6.405935364486464, 6.589588062958916, 1.2402227600344171, 6.907400603930768, 6.572789037489253, 8.886776085225975, 7.956700376749652, 3.8174206970652413, 9.172979279625363, 4.089908703889593, 3.8072180447929624, 2.4702382047728, 5.108387044465443, 2.9741294156308125, 4.415862851555437, 7.477619817483657, 6.67904809274113, 1.5465529786572443, 7.796355128713589, 9.368114939337463, 4.574879198077739, 3.16958718327582, 7.718037762474914, 4.4588779420373665], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0311991398533906, "mean_inference_ms": 7.949843629369903, "mean_action_processing_ms": 0.5353008029741964, "mean_env_wait_ms": 23.716369396246137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04548788070678711, "StateBufferConnector_ms": 0.0383448600769043, "ViewRequirementAgentConnector_ms": 0.9529104232788086}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5678680, "num_agent_steps_trained": 5678680, "num_env_steps_sampled": 5678680, "num_env_steps_trained": 5678680, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.56118613552513, "num_env_steps_trained_throughput_per_sec": 286.56118613552513, "timesteps_total": 5678680, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5678680, "timers": {"training_iteration_time_ms": 54111.569, "sample_time_ms": 41193.718, "load_time_ms": 1739.81, "load_throughput": 8988.337, "learn_time_ms": 10641.159, "learn_throughput": 1469.577, "synch_weights_time_ms": 419.586}, "counters": {"num_env_steps_sampled": 5678680, "num_env_steps_trained": 5678680, "num_agent_steps_sampled": 5678680, "num_agent_steps_trained": 5678680}, "done": false, "episodes_total": 280, "training_iteration": 368, "trial_id": "2f030_00000", "date": "2025-06-07_07-55-03", "timestamp": 1749275703, "time_this_iter_s": 54.58522629737854, "time_total_s": 1122.6420912742615, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1122.6420912742615, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 76.54920634920636, "ram_util_percent": 71.40634920634925, "gpu_util_percent0": 0.0784126984126984, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.4204193548387087e-05, "total_loss": -0.11038574650333348, "policy_loss": -0.018569504419347967, "vf_loss": 0.017117349753494968, "vf_explained_var": 0.7006683779846539, "kl": 0.02261584595512514, "entropy": 20.856686123934658, "entropy_coeff": 0.005420419354838711}, "model": {}, "num_grad_updates_lifetime": 11275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5694318, "num_env_steps_trained": 5694318, "num_agent_steps_sampled": 5694318, "num_agent_steps_trained": 5694318}, "sampler_results": {"episode_reward_max": 9.63295994964777, "episode_reward_min": -0.8960400652632492, "episode_reward_mean": 5.690101115161173, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.214105959726992, 6.667938003433961, 6.081559790094541, 5.954692989232814, 5.20209167163546, 5.224501606804193, 9.081648496943254, 5.598366780820115, 7.4718448300458125, 2.6837960802405, 7.677267566317851, 8.780782279858082, 7.857005328668907, 4.204229710995979, 4.925606633323763, 6.3384586016252396, 1.9987841120023673, 1.9707361442742213, 4.9802488171976105, 3.5402241775819387, 4.6893519148565925, 7.210737757431194, 5.154756984256521, 8.140627957402527, 5.869708630152237, 4.683982747289531, 6.27511258033256, 8.350672987319745, 5.322894571016627, 5.579909977861753, 3.8807370748946233, 3.7136464202098285, 7.350592238919443, 4.450008105300252, 7.181196335573617, 9.63295994964777, 6.310942416424339, 5.831434938530929, 2.123361698281934, 7.346008287819263, 5.370618255001533, 4.697797186323254, -0.8960400652632492, 5.081296020042982, 6.387442048541803, 7.248289570628484, 5.583606162325579, 7.5127013031981855, 8.978937634249254, 8.320670203652488, 2.793727885011145, 2.3777915947719444, 7.948389552664664, 4.406126016193685, 8.342095881207479, 4.242879439892493, 6.448148656390397, 7.700729383731515, 7.348072008082465, 6.929480399988162, 5.250910974500274, 4.320760746657362, 6.405935364486464, 6.589588062958916, 1.2402227600344171, 6.907400603930768, 6.572789037489253, 8.886776085225975, 7.956700376749652, 3.8174206970652413, 9.172979279625363, 4.089908703889593, 3.8072180447929624, 2.4702382047728, 5.108387044465443, 2.9741294156308125, 4.415862851555437, 7.477619817483657, 6.67904809274113, 1.5465529786572443, 7.796355128713589, 9.368114939337463, 4.574879198077739, 3.16958718327582, 7.718037762474914, 4.4588779420373665, 6.00578661981104, 3.1417861060634, 7.959473067361639, 5.918307567780698, 4.551850498468225, 5.776060676261714, 2.4794521269108456, 3.4538799670292377, 6.436002046661016, 5.6055169913485985, 4.592097330026948, 7.729674592420585, 6.276131766227555, 6.932498572137115], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0256459238195488, "mean_inference_ms": 7.95030362115334, "mean_action_processing_ms": 0.5352007181526405, "mean_env_wait_ms": 23.7115977643992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045439958572387695, "StateBufferConnector_ms": 0.037343740463256836, "ViewRequirementAgentConnector_ms": 0.9338419437408447}}, "episode_reward_max": 9.63295994964777, "episode_reward_min": -0.8960400652632492, "episode_reward_mean": 5.690101115161173, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.214105959726992, 6.667938003433961, 6.081559790094541, 5.954692989232814, 5.20209167163546, 5.224501606804193, 9.081648496943254, 5.598366780820115, 7.4718448300458125, 2.6837960802405, 7.677267566317851, 8.780782279858082, 7.857005328668907, 4.204229710995979, 4.925606633323763, 6.3384586016252396, 1.9987841120023673, 1.9707361442742213, 4.9802488171976105, 3.5402241775819387, 4.6893519148565925, 7.210737757431194, 5.154756984256521, 8.140627957402527, 5.869708630152237, 4.683982747289531, 6.27511258033256, 8.350672987319745, 5.322894571016627, 5.579909977861753, 3.8807370748946233, 3.7136464202098285, 7.350592238919443, 4.450008105300252, 7.181196335573617, 9.63295994964777, 6.310942416424339, 5.831434938530929, 2.123361698281934, 7.346008287819263, 5.370618255001533, 4.697797186323254, -0.8960400652632492, 5.081296020042982, 6.387442048541803, 7.248289570628484, 5.583606162325579, 7.5127013031981855, 8.978937634249254, 8.320670203652488, 2.793727885011145, 2.3777915947719444, 7.948389552664664, 4.406126016193685, 8.342095881207479, 4.242879439892493, 6.448148656390397, 7.700729383731515, 7.348072008082465, 6.929480399988162, 5.250910974500274, 4.320760746657362, 6.405935364486464, 6.589588062958916, 1.2402227600344171, 6.907400603930768, 6.572789037489253, 8.886776085225975, 7.956700376749652, 3.8174206970652413, 9.172979279625363, 4.089908703889593, 3.8072180447929624, 2.4702382047728, 5.108387044465443, 2.9741294156308125, 4.415862851555437, 7.477619817483657, 6.67904809274113, 1.5465529786572443, 7.796355128713589, 9.368114939337463, 4.574879198077739, 3.16958718327582, 7.718037762474914, 4.4588779420373665, 6.00578661981104, 3.1417861060634, 7.959473067361639, 5.918307567780698, 4.551850498468225, 5.776060676261714, 2.4794521269108456, 3.4538799670292377, 6.436002046661016, 5.6055169913485985, 4.592097330026948, 7.729674592420585, 6.276131766227555, 6.932498572137115], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0256459238195488, "mean_inference_ms": 7.95030362115334, "mean_action_processing_ms": 0.5352007181526405, "mean_env_wait_ms": 23.7115977643992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045439958572387695, "StateBufferConnector_ms": 0.037343740463256836, "ViewRequirementAgentConnector_ms": 0.9338419437408447}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5694318, "num_agent_steps_trained": 5694318, "num_env_steps_sampled": 5694318, "num_env_steps_trained": 5694318, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 290.39226736264976, "num_env_steps_trained_throughput_per_sec": 290.39226736264976, "timesteps_total": 5694318, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5694318, "timers": {"training_iteration_time_ms": 54077.142, "sample_time_ms": 41164.728, "load_time_ms": 1747.546, "load_throughput": 8948.546, "learn_time_ms": 10628.161, "learn_throughput": 1471.374, "synch_weights_time_ms": 417.84}, "counters": {"num_env_steps_sampled": 5694318, "num_env_steps_trained": 5694318, "num_agent_steps_sampled": 5694318, "num_agent_steps_trained": 5694318}, "done": false, "episodes_total": 294, "training_iteration": 369, "trial_id": "2f030_00000", "date": "2025-06-07_07-55-57", "timestamp": 1749275757, "time_this_iter_s": 53.95655798912048, "time_total_s": 1176.598649263382, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1176.598649263382, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 77.58709677419354, "ram_util_percent": 71.3983870967742, "gpu_util_percent0": 0.07612903225806453, "vram_util_percent0": 0.8592122395833335}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3.494561389279632, "episode_reward_min": -10.483946778337053, "episode_reward_mean": -6.739351851148461, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.483946778337053, -10.072597806538674, -3.7662816626462714, -3.494561389279632, -5.879371618940679], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6133567640117357, "mean_inference_ms": 3.866723981813778, "mean_action_processing_ms": 0.29682879947053054, "mean_env_wait_ms": 10.808031872449169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.25087833404541016}}, "episode_reward_max": -3.494561389279632, "episode_reward_min": -10.483946778337053, "episode_reward_mean": -6.739351851148461, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.483946778337053, -10.072597806538674, -3.7662816626462714, -3.494561389279632, -5.879371618940679], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6133567640117357, "mean_inference_ms": 3.866723981813778, "mean_action_processing_ms": 0.29682879947053054, "mean_env_wait_ms": 10.808031872449169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.25087833404541016}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.4078080645161284e-05, "total_loss": -0.10611354874108325, "policy_loss": -0.014247401289493693, "vf_loss": 0.015574867191978476, "vf_explained_var": 0.6956563347036189, "kl": 0.022694619485092434, "entropy": 20.839354639920323, "entropy_coeff": 0.0054078080645161295}, "model": {}, "num_grad_updates_lifetime": 11825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5709956, "num_env_steps_trained": 5709956, "num_agent_steps_sampled": 5709956, "num_agent_steps_trained": 5709956}, "sampler_results": {"episode_reward_max": 9.63295994964777, "episode_reward_min": -0.8960400652632492, "episode_reward_mean": 5.598304021731941, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.925606633323763, 6.3384586016252396, 1.9987841120023673, 1.9707361442742213, 4.9802488171976105, 3.5402241775819387, 4.6893519148565925, 7.210737757431194, 5.154756984256521, 8.140627957402527, 5.869708630152237, 4.683982747289531, 6.27511258033256, 8.350672987319745, 5.322894571016627, 5.579909977861753, 3.8807370748946233, 3.7136464202098285, 7.350592238919443, 4.450008105300252, 7.181196335573617, 9.63295994964777, 6.310942416424339, 5.831434938530929, 2.123361698281934, 7.346008287819263, 5.370618255001533, 4.697797186323254, -0.8960400652632492, 5.081296020042982, 6.387442048541803, 7.248289570628484, 5.583606162325579, 7.5127013031981855, 8.978937634249254, 8.320670203652488, 2.793727885011145, 2.3777915947719444, 7.948389552664664, 4.406126016193685, 8.342095881207479, 4.242879439892493, 6.448148656390397, 7.700729383731515, 7.348072008082465, 6.929480399988162, 5.250910974500274, 4.320760746657362, 6.405935364486464, 6.589588062958916, 1.2402227600344171, 6.907400603930768, 6.572789037489253, 8.886776085225975, 7.956700376749652, 3.8174206970652413, 9.172979279625363, 4.089908703889593, 3.8072180447929624, 2.4702382047728, 5.108387044465443, 2.9741294156308125, 4.415862851555437, 7.477619817483657, 6.67904809274113, 1.5465529786572443, 7.796355128713589, 9.368114939337463, 4.574879198077739, 3.16958718327582, 7.718037762474914, 4.4588779420373665, 6.00578661981104, 3.1417861060634, 7.959473067361639, 5.918307567780698, 4.551850498468225, 5.776060676261714, 2.4794521269108456, 3.4538799670292377, 6.436002046661016, 5.6055169913485985, 4.592097330026948, 7.729674592420585, 6.276131766227555, 6.932498572137115, 4.346763703847379, 8.424954230958656, 9.314273654797004, 3.1547500311014045, 5.484022317677318, 4.115132877293342, 4.976745324862656, 3.8853024047864637, 6.585147195601726, 9.218246839262372, 4.788078524894604, 7.215259597389532, 2.621277938377479, 6.390167111045212], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0192544956358645, "mean_inference_ms": 7.950911672277748, "mean_action_processing_ms": 0.5351443278541617, "mean_env_wait_ms": 23.712250705676073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05060577392578125, "StateBufferConnector_ms": 0.03401923179626465, "ViewRequirementAgentConnector_ms": 0.9635574817657471}}, "episode_reward_max": 9.63295994964777, "episode_reward_min": -0.8960400652632492, "episode_reward_mean": 5.598304021731941, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.925606633323763, 6.3384586016252396, 1.9987841120023673, 1.9707361442742213, 4.9802488171976105, 3.5402241775819387, 4.6893519148565925, 7.210737757431194, 5.154756984256521, 8.140627957402527, 5.869708630152237, 4.683982747289531, 6.27511258033256, 8.350672987319745, 5.322894571016627, 5.579909977861753, 3.8807370748946233, 3.7136464202098285, 7.350592238919443, 4.450008105300252, 7.181196335573617, 9.63295994964777, 6.310942416424339, 5.831434938530929, 2.123361698281934, 7.346008287819263, 5.370618255001533, 4.697797186323254, -0.8960400652632492, 5.081296020042982, 6.387442048541803, 7.248289570628484, 5.583606162325579, 7.5127013031981855, 8.978937634249254, 8.320670203652488, 2.793727885011145, 2.3777915947719444, 7.948389552664664, 4.406126016193685, 8.342095881207479, 4.242879439892493, 6.448148656390397, 7.700729383731515, 7.348072008082465, 6.929480399988162, 5.250910974500274, 4.320760746657362, 6.405935364486464, 6.589588062958916, 1.2402227600344171, 6.907400603930768, 6.572789037489253, 8.886776085225975, 7.956700376749652, 3.8174206970652413, 9.172979279625363, 4.089908703889593, 3.8072180447929624, 2.4702382047728, 5.108387044465443, 2.9741294156308125, 4.415862851555437, 7.477619817483657, 6.67904809274113, 1.5465529786572443, 7.796355128713589, 9.368114939337463, 4.574879198077739, 3.16958718327582, 7.718037762474914, 4.4588779420373665, 6.00578661981104, 3.1417861060634, 7.959473067361639, 5.918307567780698, 4.551850498468225, 5.776060676261714, 2.4794521269108456, 3.4538799670292377, 6.436002046661016, 5.6055169913485985, 4.592097330026948, 7.729674592420585, 6.276131766227555, 6.932498572137115, 4.346763703847379, 8.424954230958656, 9.314273654797004, 3.1547500311014045, 5.484022317677318, 4.115132877293342, 4.976745324862656, 3.8853024047864637, 6.585147195601726, 9.218246839262372, 4.788078524894604, 7.215259597389532, 2.621277938377479, 6.390167111045212], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0192544956358645, "mean_inference_ms": 7.950911672277748, "mean_action_processing_ms": 0.5351443278541617, "mean_env_wait_ms": 23.712250705676073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05060577392578125, "StateBufferConnector_ms": 0.03401923179626465, "ViewRequirementAgentConnector_ms": 0.9635574817657471}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5709956, "num_agent_steps_trained": 5709956, "num_env_steps_sampled": 5709956, "num_env_steps_trained": 5709956, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.7216909477843, "num_env_steps_trained_throughput_per_sec": 285.7216909477843, "timesteps_total": 5709956, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5709956, "timers": {"training_iteration_time_ms": 54190.464, "sample_time_ms": 41269.195, "load_time_ms": 1743.834, "load_throughput": 8967.595, "learn_time_ms": 10639.126, "learn_throughput": 1469.858, "synch_weights_time_ms": 417.843}, "counters": {"num_env_steps_sampled": 5709956, "num_env_steps_trained": 5709956, "num_agent_steps_sampled": 5709956, "num_agent_steps_trained": 5709956}, "done": false, "episodes_total": 308, "training_iteration": 370, "trial_id": "2f030_00000", "date": "2025-06-07_07-57-07", "timestamp": 1749275827, "time_this_iter_s": 69.39448690414429, "time_total_s": 1245.9931361675262, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1245.9931361675262, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 64.35432098765432, "ram_util_percent": 70.90246913580248, "gpu_util_percent0": 0.06246913580246914, "vram_util_percent0": 0.8592122395833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.3951967741935475e-05, "total_loss": -0.11444075990891592, "policy_loss": -0.02175212691818491, "vf_loss": 0.0173016742693091, "vf_explained_var": 0.6973419073494997, "kl": 0.021087423700133636, "entropy": 20.924457706104626, "entropy_coeff": 0.005395196774193548}, "model": {}, "num_grad_updates_lifetime": 12375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5725594, "num_env_steps_trained": 5725594, "num_agent_steps_sampled": 5725594, "num_agent_steps_trained": 5725594}, "sampler_results": {"episode_reward_max": 10.242438252158012, "episode_reward_min": -0.8960400652632492, "episode_reward_mean": 5.593868649301641, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.322894571016627, 5.579909977861753, 3.8807370748946233, 3.7136464202098285, 7.350592238919443, 4.450008105300252, 7.181196335573617, 9.63295994964777, 6.310942416424339, 5.831434938530929, 2.123361698281934, 7.346008287819263, 5.370618255001533, 4.697797186323254, -0.8960400652632492, 5.081296020042982, 6.387442048541803, 7.248289570628484, 5.583606162325579, 7.5127013031981855, 8.978937634249254, 8.320670203652488, 2.793727885011145, 2.3777915947719444, 7.948389552664664, 4.406126016193685, 8.342095881207479, 4.242879439892493, 6.448148656390397, 7.700729383731515, 7.348072008082465, 6.929480399988162, 5.250910974500274, 4.320760746657362, 6.405935364486464, 6.589588062958916, 1.2402227600344171, 6.907400603930768, 6.572789037489253, 8.886776085225975, 7.956700376749652, 3.8174206970652413, 9.172979279625363, 4.089908703889593, 3.8072180447929624, 2.4702382047728, 5.108387044465443, 2.9741294156308125, 4.415862851555437, 7.477619817483657, 6.67904809274113, 1.5465529786572443, 7.796355128713589, 9.368114939337463, 4.574879198077739, 3.16958718327582, 7.718037762474914, 4.4588779420373665, 6.00578661981104, 3.1417861060634, 7.959473067361639, 5.918307567780698, 4.551850498468225, 5.776060676261714, 2.4794521269108456, 3.4538799670292377, 6.436002046661016, 5.6055169913485985, 4.592097330026948, 7.729674592420585, 6.276131766227555, 6.932498572137115, 4.346763703847379, 8.424954230958656, 9.314273654797004, 3.1547500311014045, 5.484022317677318, 4.115132877293342, 4.976745324862656, 3.8853024047864637, 6.585147195601726, 9.218246839262372, 4.788078524894604, 7.215259597389532, 2.621277938377479, 6.390167111045212, 2.312208641703327, 4.643459235511279, 3.415694936931875, 5.706935191247422, 5.140520123403092, 7.752075649442204, 6.203747253693618, 0.6772412614565262, 10.242438252158012, 8.118671672992798, 9.024342089133551, -0.6055712310938677, 6.343679976457697, 4.710029748978642], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0120494465967242, "mean_inference_ms": 7.952240316176444, "mean_action_processing_ms": 0.5351833470838155, "mean_env_wait_ms": 23.71229172933761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04505753517150879, "StateBufferConnector_ms": 0.02797865867614746, "ViewRequirementAgentConnector_ms": 0.9838230609893799}}, "episode_reward_max": 10.242438252158012, "episode_reward_min": -0.8960400652632492, "episode_reward_mean": 5.593868649301641, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.322894571016627, 5.579909977861753, 3.8807370748946233, 3.7136464202098285, 7.350592238919443, 4.450008105300252, 7.181196335573617, 9.63295994964777, 6.310942416424339, 5.831434938530929, 2.123361698281934, 7.346008287819263, 5.370618255001533, 4.697797186323254, -0.8960400652632492, 5.081296020042982, 6.387442048541803, 7.248289570628484, 5.583606162325579, 7.5127013031981855, 8.978937634249254, 8.320670203652488, 2.793727885011145, 2.3777915947719444, 7.948389552664664, 4.406126016193685, 8.342095881207479, 4.242879439892493, 6.448148656390397, 7.700729383731515, 7.348072008082465, 6.929480399988162, 5.250910974500274, 4.320760746657362, 6.405935364486464, 6.589588062958916, 1.2402227600344171, 6.907400603930768, 6.572789037489253, 8.886776085225975, 7.956700376749652, 3.8174206970652413, 9.172979279625363, 4.089908703889593, 3.8072180447929624, 2.4702382047728, 5.108387044465443, 2.9741294156308125, 4.415862851555437, 7.477619817483657, 6.67904809274113, 1.5465529786572443, 7.796355128713589, 9.368114939337463, 4.574879198077739, 3.16958718327582, 7.718037762474914, 4.4588779420373665, 6.00578661981104, 3.1417861060634, 7.959473067361639, 5.918307567780698, 4.551850498468225, 5.776060676261714, 2.4794521269108456, 3.4538799670292377, 6.436002046661016, 5.6055169913485985, 4.592097330026948, 7.729674592420585, 6.276131766227555, 6.932498572137115, 4.346763703847379, 8.424954230958656, 9.314273654797004, 3.1547500311014045, 5.484022317677318, 4.115132877293342, 4.976745324862656, 3.8853024047864637, 6.585147195601726, 9.218246839262372, 4.788078524894604, 7.215259597389532, 2.621277938377479, 6.390167111045212, 2.312208641703327, 4.643459235511279, 3.415694936931875, 5.706935191247422, 5.140520123403092, 7.752075649442204, 6.203747253693618, 0.6772412614565262, 10.242438252158012, 8.118671672992798, 9.024342089133551, -0.6055712310938677, 6.343679976457697, 4.710029748978642], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0120494465967242, "mean_inference_ms": 7.952240316176444, "mean_action_processing_ms": 0.5351833470838155, "mean_env_wait_ms": 23.71229172933761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04505753517150879, "StateBufferConnector_ms": 0.02797865867614746, "ViewRequirementAgentConnector_ms": 0.9838230609893799}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5725594, "num_agent_steps_trained": 5725594, "num_env_steps_sampled": 5725594, "num_env_steps_trained": 5725594, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.98900954231897, "num_env_steps_trained_throughput_per_sec": 286.98900954231897, "timesteps_total": 5725594, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5725594, "timers": {"training_iteration_time_ms": 54198.794, "sample_time_ms": 41255.104, "load_time_ms": 1755.955, "load_throughput": 8905.696, "learn_time_ms": 10649.913, "learn_throughput": 1468.369, "synch_weights_time_ms": 417.001}, "counters": {"num_env_steps_sampled": 5725594, "num_env_steps_trained": 5725594, "num_agent_steps_sampled": 5725594, "num_agent_steps_trained": 5725594}, "done": false, "episodes_total": 322, "training_iteration": 371, "trial_id": "2f030_00000", "date": "2025-06-07_07-58-01", "timestamp": 1749275881, "time_this_iter_s": 54.50574541091919, "time_total_s": 1300.4988815784454, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1300.4988815784454, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 77.25645161290323, "ram_util_percent": 71.40967741935485, "gpu_util_percent0": 0.07822580645161291, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.382585483870968e-05, "total_loss": -0.10064006556968459, "policy_loss": -0.007966477197438837, "vf_loss": 0.01663548395291648, "vf_explained_var": 0.6765667969530279, "kl": 0.02093756822744829, "entropy": 20.913738616596568, "entropy_coeff": 0.005382585483870967}, "model": {}, "num_grad_updates_lifetime": 12925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5741232, "num_env_steps_trained": 5741232, "num_agent_steps_sampled": 5741232, "num_agent_steps_trained": 5741232}, "sampler_results": {"episode_reward_max": 10.242438252158012, "episode_reward_min": -0.8960400652632492, "episode_reward_mean": 5.511619217325273, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.8960400652632492, 5.081296020042982, 6.387442048541803, 7.248289570628484, 5.583606162325579, 7.5127013031981855, 8.978937634249254, 8.320670203652488, 2.793727885011145, 2.3777915947719444, 7.948389552664664, 4.406126016193685, 8.342095881207479, 4.242879439892493, 6.448148656390397, 7.700729383731515, 7.348072008082465, 6.929480399988162, 5.250910974500274, 4.320760746657362, 6.405935364486464, 6.589588062958916, 1.2402227600344171, 6.907400603930768, 6.572789037489253, 8.886776085225975, 7.956700376749652, 3.8174206970652413, 9.172979279625363, 4.089908703889593, 3.8072180447929624, 2.4702382047728, 5.108387044465443, 2.9741294156308125, 4.415862851555437, 7.477619817483657, 6.67904809274113, 1.5465529786572443, 7.796355128713589, 9.368114939337463, 4.574879198077739, 3.16958718327582, 7.718037762474914, 4.4588779420373665, 6.00578661981104, 3.1417861060634, 7.959473067361639, 5.918307567780698, 4.551850498468225, 5.776060676261714, 2.4794521269108456, 3.4538799670292377, 6.436002046661016, 5.6055169913485985, 4.592097330026948, 7.729674592420585, 6.276131766227555, 6.932498572137115, 4.346763703847379, 8.424954230958656, 9.314273654797004, 3.1547500311014045, 5.484022317677318, 4.115132877293342, 4.976745324862656, 3.8853024047864637, 6.585147195601726, 9.218246839262372, 4.788078524894604, 7.215259597389532, 2.621277938377479, 6.390167111045212, 2.312208641703327, 4.643459235511279, 3.415694936931875, 5.706935191247422, 5.140520123403092, 7.752075649442204, 6.203747253693618, 0.6772412614565262, 10.242438252158012, 8.118671672992798, 9.024342089133551, -0.6055712310938677, 6.343679976457697, 4.710029748978642, 1.7130138490565747, 2.778053052064415, 3.9415081129067664, 0.4376672077389513, 7.669794159929226, 9.85241269265971, 5.330399006073121, 5.418054171555358, 3.9217000797377284, 3.32036123814187, 7.335631828273052, 8.025846208632707, 3.551388880413855, 7.271333770984815], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.004770017035117, "mean_inference_ms": 7.954514065047123, "mean_action_processing_ms": 0.5352099824317892, "mean_env_wait_ms": 23.71354690796397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042021989822387695, "StateBufferConnector_ms": 0.0299832820892334, "ViewRequirementAgentConnector_ms": 0.9681947231292725}}, "episode_reward_max": 10.242438252158012, "episode_reward_min": -0.8960400652632492, "episode_reward_mean": 5.511619217325273, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-0.8960400652632492, 5.081296020042982, 6.387442048541803, 7.248289570628484, 5.583606162325579, 7.5127013031981855, 8.978937634249254, 8.320670203652488, 2.793727885011145, 2.3777915947719444, 7.948389552664664, 4.406126016193685, 8.342095881207479, 4.242879439892493, 6.448148656390397, 7.700729383731515, 7.348072008082465, 6.929480399988162, 5.250910974500274, 4.320760746657362, 6.405935364486464, 6.589588062958916, 1.2402227600344171, 6.907400603930768, 6.572789037489253, 8.886776085225975, 7.956700376749652, 3.8174206970652413, 9.172979279625363, 4.089908703889593, 3.8072180447929624, 2.4702382047728, 5.108387044465443, 2.9741294156308125, 4.415862851555437, 7.477619817483657, 6.67904809274113, 1.5465529786572443, 7.796355128713589, 9.368114939337463, 4.574879198077739, 3.16958718327582, 7.718037762474914, 4.4588779420373665, 6.00578661981104, 3.1417861060634, 7.959473067361639, 5.918307567780698, 4.551850498468225, 5.776060676261714, 2.4794521269108456, 3.4538799670292377, 6.436002046661016, 5.6055169913485985, 4.592097330026948, 7.729674592420585, 6.276131766227555, 6.932498572137115, 4.346763703847379, 8.424954230958656, 9.314273654797004, 3.1547500311014045, 5.484022317677318, 4.115132877293342, 4.976745324862656, 3.8853024047864637, 6.585147195601726, 9.218246839262372, 4.788078524894604, 7.215259597389532, 2.621277938377479, 6.390167111045212, 2.312208641703327, 4.643459235511279, 3.415694936931875, 5.706935191247422, 5.140520123403092, 7.752075649442204, 6.203747253693618, 0.6772412614565262, 10.242438252158012, 8.118671672992798, 9.024342089133551, -0.6055712310938677, 6.343679976457697, 4.710029748978642, 1.7130138490565747, 2.778053052064415, 3.9415081129067664, 0.4376672077389513, 7.669794159929226, 9.85241269265971, 5.330399006073121, 5.418054171555358, 3.9217000797377284, 3.32036123814187, 7.335631828273052, 8.025846208632707, 3.551388880413855, 7.271333770984815], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.004770017035117, "mean_inference_ms": 7.954514065047123, "mean_action_processing_ms": 0.5352099824317892, "mean_env_wait_ms": 23.71354690796397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042021989822387695, "StateBufferConnector_ms": 0.0299832820892334, "ViewRequirementAgentConnector_ms": 0.9681947231292725}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5741232, "num_agent_steps_trained": 5741232, "num_env_steps_sampled": 5741232, "num_env_steps_trained": 5741232, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.1630068418524, "num_env_steps_trained_throughput_per_sec": 283.1630068418524, "timesteps_total": 5741232, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5741232, "timers": {"training_iteration_time_ms": 54308.639, "sample_time_ms": 41266.284, "load_time_ms": 1777.3, "load_throughput": 8798.741, "learn_time_ms": 10729.268, "learn_throughput": 1457.509, "synch_weights_time_ms": 418.421}, "counters": {"num_env_steps_sampled": 5741232, "num_env_steps_trained": 5741232, "num_agent_steps_sampled": 5741232, "num_agent_steps_trained": 5741232}, "done": false, "episodes_total": 336, "training_iteration": 372, "trial_id": "2f030_00000", "date": "2025-06-07_07-58-56", "timestamp": 1749275936, "time_this_iter_s": 55.24216628074646, "time_total_s": 1355.741047859192, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1355.741047859192, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 77.56093750000001, "ram_util_percent": 70.0421875, "gpu_util_percent0": 0.08515624999999999, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.3699741935483864e-05, "total_loss": -0.11324784342284229, "policy_loss": -0.02042743019399826, "vf_loss": 0.015071226744489236, "vf_explained_var": 0.7014668597958305, "kl": 0.020813508214249106, "entropy": 20.886358746615322, "entropy_coeff": 0.005369974193548386}, "model": {}, "num_grad_updates_lifetime": 13475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5756870, "num_env_steps_trained": 5756870, "num_agent_steps_sampled": 5756870, "num_agent_steps_trained": 5756870}, "sampler_results": {"episode_reward_max": 10.242438252158012, "episode_reward_min": -0.6055712310938677, "episode_reward_mean": 5.494466776808331, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.448148656390397, 7.700729383731515, 7.348072008082465, 6.929480399988162, 5.250910974500274, 4.320760746657362, 6.405935364486464, 6.589588062958916, 1.2402227600344171, 6.907400603930768, 6.572789037489253, 8.886776085225975, 7.956700376749652, 3.8174206970652413, 9.172979279625363, 4.089908703889593, 3.8072180447929624, 2.4702382047728, 5.108387044465443, 2.9741294156308125, 4.415862851555437, 7.477619817483657, 6.67904809274113, 1.5465529786572443, 7.796355128713589, 9.368114939337463, 4.574879198077739, 3.16958718327582, 7.718037762474914, 4.4588779420373665, 6.00578661981104, 3.1417861060634, 7.959473067361639, 5.918307567780698, 4.551850498468225, 5.776060676261714, 2.4794521269108456, 3.4538799670292377, 6.436002046661016, 5.6055169913485985, 4.592097330026948, 7.729674592420585, 6.276131766227555, 6.932498572137115, 4.346763703847379, 8.424954230958656, 9.314273654797004, 3.1547500311014045, 5.484022317677318, 4.115132877293342, 4.976745324862656, 3.8853024047864637, 6.585147195601726, 9.218246839262372, 4.788078524894604, 7.215259597389532, 2.621277938377479, 6.390167111045212, 2.312208641703327, 4.643459235511279, 3.415694936931875, 5.706935191247422, 5.140520123403092, 7.752075649442204, 6.203747253693618, 0.6772412614565262, 10.242438252158012, 8.118671672992798, 9.024342089133551, -0.6055712310938677, 6.343679976457697, 4.710029748978642, 1.7130138490565747, 2.778053052064415, 3.9415081129067664, 0.4376672077389513, 7.669794159929226, 9.85241269265971, 5.330399006073121, 5.418054171555358, 3.9217000797377284, 3.32036123814187, 7.335631828273052, 8.025846208632707, 3.551388880413855, 7.271333770984815, 5.520806215363867, 8.356921874272578, 3.0824384875936577, 7.013141467163473, 5.7045038489784226, 2.567648587397797, 5.579877993170302, 4.139568124092876, 5.521999968525225, 8.303163766656775, 7.7967683320104, 3.6972713072327923, 3.864690763357155, 5.463868459607415], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9961590959761213, "mean_inference_ms": 7.959005122631709, "mean_action_processing_ms": 0.5354572060720693, "mean_env_wait_ms": 23.720906919352302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0370488166809082, "StateBufferConnector_ms": 0.02953505516052246, "ViewRequirementAgentConnector_ms": 0.9627487659454346}}, "episode_reward_max": 10.242438252158012, "episode_reward_min": -0.6055712310938677, "episode_reward_mean": 5.494466776808331, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.448148656390397, 7.700729383731515, 7.348072008082465, 6.929480399988162, 5.250910974500274, 4.320760746657362, 6.405935364486464, 6.589588062958916, 1.2402227600344171, 6.907400603930768, 6.572789037489253, 8.886776085225975, 7.956700376749652, 3.8174206970652413, 9.172979279625363, 4.089908703889593, 3.8072180447929624, 2.4702382047728, 5.108387044465443, 2.9741294156308125, 4.415862851555437, 7.477619817483657, 6.67904809274113, 1.5465529786572443, 7.796355128713589, 9.368114939337463, 4.574879198077739, 3.16958718327582, 7.718037762474914, 4.4588779420373665, 6.00578661981104, 3.1417861060634, 7.959473067361639, 5.918307567780698, 4.551850498468225, 5.776060676261714, 2.4794521269108456, 3.4538799670292377, 6.436002046661016, 5.6055169913485985, 4.592097330026948, 7.729674592420585, 6.276131766227555, 6.932498572137115, 4.346763703847379, 8.424954230958656, 9.314273654797004, 3.1547500311014045, 5.484022317677318, 4.115132877293342, 4.976745324862656, 3.8853024047864637, 6.585147195601726, 9.218246839262372, 4.788078524894604, 7.215259597389532, 2.621277938377479, 6.390167111045212, 2.312208641703327, 4.643459235511279, 3.415694936931875, 5.706935191247422, 5.140520123403092, 7.752075649442204, 6.203747253693618, 0.6772412614565262, 10.242438252158012, 8.118671672992798, 9.024342089133551, -0.6055712310938677, 6.343679976457697, 4.710029748978642, 1.7130138490565747, 2.778053052064415, 3.9415081129067664, 0.4376672077389513, 7.669794159929226, 9.85241269265971, 5.330399006073121, 5.418054171555358, 3.9217000797377284, 3.32036123814187, 7.335631828273052, 8.025846208632707, 3.551388880413855, 7.271333770984815, 5.520806215363867, 8.356921874272578, 3.0824384875936577, 7.013141467163473, 5.7045038489784226, 2.567648587397797, 5.579877993170302, 4.139568124092876, 5.521999968525225, 8.303163766656775, 7.7967683320104, 3.6972713072327923, 3.864690763357155, 5.463868459607415], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9961590959761213, "mean_inference_ms": 7.959005122631709, "mean_action_processing_ms": 0.5354572060720693, "mean_env_wait_ms": 23.720906919352302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0370488166809082, "StateBufferConnector_ms": 0.02953505516052246, "ViewRequirementAgentConnector_ms": 0.9627487659454346}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5756870, "num_agent_steps_trained": 5756870, "num_env_steps_sampled": 5756870, "num_env_steps_trained": 5756870, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.470906456784, "num_env_steps_trained_throughput_per_sec": 280.470906456784, "timesteps_total": 5756870, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5756870, "timers": {"training_iteration_time_ms": 54523.472, "sample_time_ms": 41411.458, "load_time_ms": 1818.06, "load_throughput": 8601.476, "learn_time_ms": 10759.504, "learn_throughput": 1453.413, "synch_weights_time_ms": 418.946}, "counters": {"num_env_steps_sampled": 5756870, "num_env_steps_trained": 5756870, "num_agent_steps_sampled": 5756870, "num_agent_steps_trained": 5756870}, "done": false, "episodes_total": 350, "training_iteration": 373, "trial_id": "2f030_00000", "date": "2025-06-07_07-59-52", "timestamp": 1749275992, "time_this_iter_s": 55.89761996269226, "time_total_s": 1411.6386678218842, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1411.6386678218842, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 76.796875, "ram_util_percent": 64.5640625, "gpu_util_percent0": 0.080625, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.3573629032258055e-05, "total_loss": -0.11753459067422559, "policy_loss": -0.02463572340815517, "vf_loss": 0.014897004039958119, "vf_explained_var": 0.6940734245560386, "kl": 0.0209673838079272, "entropy": 20.96086248918013, "entropy_coeff": 0.005357362903225806}, "model": {}, "num_grad_updates_lifetime": 14025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5772508, "num_env_steps_trained": 5772508, "num_agent_steps_sampled": 5772508, "num_agent_steps_trained": 5772508}, "sampler_results": {"episode_reward_max": 10.242438252158012, "episode_reward_min": -0.6055712310938677, "episode_reward_mean": 5.318300754162071, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.172979279625363, 4.089908703889593, 3.8072180447929624, 2.4702382047728, 5.108387044465443, 2.9741294156308125, 4.415862851555437, 7.477619817483657, 6.67904809274113, 1.5465529786572443, 7.796355128713589, 9.368114939337463, 4.574879198077739, 3.16958718327582, 7.718037762474914, 4.4588779420373665, 6.00578661981104, 3.1417861060634, 7.959473067361639, 5.918307567780698, 4.551850498468225, 5.776060676261714, 2.4794521269108456, 3.4538799670292377, 6.436002046661016, 5.6055169913485985, 4.592097330026948, 7.729674592420585, 6.276131766227555, 6.932498572137115, 4.346763703847379, 8.424954230958656, 9.314273654797004, 3.1547500311014045, 5.484022317677318, 4.115132877293342, 4.976745324862656, 3.8853024047864637, 6.585147195601726, 9.218246839262372, 4.788078524894604, 7.215259597389532, 2.621277938377479, 6.390167111045212, 2.312208641703327, 4.643459235511279, 3.415694936931875, 5.706935191247422, 5.140520123403092, 7.752075649442204, 6.203747253693618, 0.6772412614565262, 10.242438252158012, 8.118671672992798, 9.024342089133551, -0.6055712310938677, 6.343679976457697, 4.710029748978642, 1.7130138490565747, 2.778053052064415, 3.9415081129067664, 0.4376672077389513, 7.669794159929226, 9.85241269265971, 5.330399006073121, 5.418054171555358, 3.9217000797377284, 3.32036123814187, 7.335631828273052, 8.025846208632707, 3.551388880413855, 7.271333770984815, 5.520806215363867, 8.356921874272578, 3.0824384875936577, 7.013141467163473, 5.7045038489784226, 2.567648587397797, 5.579877993170302, 4.139568124092876, 5.521999968525225, 8.303163766656775, 7.7967683320104, 3.6972713072327923, 3.864690763357155, 5.463868459607415, 3.9171301674775205, 6.969418397603116, 4.681383692596398, 6.97332552133482, 5.395643506577608, 1.6827088174853995, 3.4251493350919633, 5.337933956265546, 6.6121825155413205, 4.499436705829931, 4.145399369114848, 3.3992906360802753, 5.283056656014503, 6.436273615651687], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9875846655069536, "mean_inference_ms": 7.964265228538003, "mean_action_processing_ms": 0.535692871727752, "mean_env_wait_ms": 23.73032167698149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03183412551879883, "StateBufferConnector_ms": 0.029116153717041016, "ViewRequirementAgentConnector_ms": 0.9781081676483154}}, "episode_reward_max": 10.242438252158012, "episode_reward_min": -0.6055712310938677, "episode_reward_mean": 5.318300754162071, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.172979279625363, 4.089908703889593, 3.8072180447929624, 2.4702382047728, 5.108387044465443, 2.9741294156308125, 4.415862851555437, 7.477619817483657, 6.67904809274113, 1.5465529786572443, 7.796355128713589, 9.368114939337463, 4.574879198077739, 3.16958718327582, 7.718037762474914, 4.4588779420373665, 6.00578661981104, 3.1417861060634, 7.959473067361639, 5.918307567780698, 4.551850498468225, 5.776060676261714, 2.4794521269108456, 3.4538799670292377, 6.436002046661016, 5.6055169913485985, 4.592097330026948, 7.729674592420585, 6.276131766227555, 6.932498572137115, 4.346763703847379, 8.424954230958656, 9.314273654797004, 3.1547500311014045, 5.484022317677318, 4.115132877293342, 4.976745324862656, 3.8853024047864637, 6.585147195601726, 9.218246839262372, 4.788078524894604, 7.215259597389532, 2.621277938377479, 6.390167111045212, 2.312208641703327, 4.643459235511279, 3.415694936931875, 5.706935191247422, 5.140520123403092, 7.752075649442204, 6.203747253693618, 0.6772412614565262, 10.242438252158012, 8.118671672992798, 9.024342089133551, -0.6055712310938677, 6.343679976457697, 4.710029748978642, 1.7130138490565747, 2.778053052064415, 3.9415081129067664, 0.4376672077389513, 7.669794159929226, 9.85241269265971, 5.330399006073121, 5.418054171555358, 3.9217000797377284, 3.32036123814187, 7.335631828273052, 8.025846208632707, 3.551388880413855, 7.271333770984815, 5.520806215363867, 8.356921874272578, 3.0824384875936577, 7.013141467163473, 5.7045038489784226, 2.567648587397797, 5.579877993170302, 4.139568124092876, 5.521999968525225, 8.303163766656775, 7.7967683320104, 3.6972713072327923, 3.864690763357155, 5.463868459607415, 3.9171301674775205, 6.969418397603116, 4.681383692596398, 6.97332552133482, 5.395643506577608, 1.6827088174853995, 3.4251493350919633, 5.337933956265546, 6.6121825155413205, 4.499436705829931, 4.145399369114848, 3.3992906360802753, 5.283056656014503, 6.436273615651687], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9875846655069536, "mean_inference_ms": 7.964265228538003, "mean_action_processing_ms": 0.535692871727752, "mean_env_wait_ms": 23.73032167698149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03183412551879883, "StateBufferConnector_ms": 0.029116153717041016, "ViewRequirementAgentConnector_ms": 0.9781081676483154}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5772508, "num_agent_steps_trained": 5772508, "num_env_steps_sampled": 5772508, "num_env_steps_trained": 5772508, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.6205423496493, "num_env_steps_trained_throughput_per_sec": 283.6205423496493, "timesteps_total": 5772508, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5772508, "timers": {"training_iteration_time_ms": 54612.882, "sample_time_ms": 41473.428, "load_time_ms": 1840.513, "load_throughput": 8496.544, "learn_time_ms": 10762.14, "learn_throughput": 1453.057, "synch_weights_time_ms": 420.539}, "counters": {"num_env_steps_sampled": 5772508, "num_env_steps_trained": 5772508, "num_agent_steps_sampled": 5772508, "num_agent_steps_trained": 5772508}, "done": false, "episodes_total": 364, "training_iteration": 374, "trial_id": "2f030_00000", "date": "2025-06-07_08-00-48", "timestamp": 1749276048, "time_this_iter_s": 55.166056632995605, "time_total_s": 1466.8047244548798, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1466.8047244548798, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 77.46031746031744, "ram_util_percent": 64.59365079365078, "gpu_util_percent0": 0.07666666666666667, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.344751612903228e-05, "total_loss": -0.12002008078535172, "policy_loss": -0.026964012035486203, "vf_loss": 0.016564036095514892, "vf_explained_var": 0.6783400756662542, "kl": 0.019864148311546845, "entropy": 20.98635309392756, "entropy_coeff": 0.005344751612903225}, "model": {}, "num_grad_updates_lifetime": 14575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5788146, "num_env_steps_trained": 5788146, "num_agent_steps_sampled": 5788146, "num_agent_steps_trained": 5788146}, "sampler_results": {"episode_reward_max": 10.242438252158012, "episode_reward_min": -0.6055712310938677, "episode_reward_mean": 5.2577852354919425, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.718037762474914, 4.4588779420373665, 6.00578661981104, 3.1417861060634, 7.959473067361639, 5.918307567780698, 4.551850498468225, 5.776060676261714, 2.4794521269108456, 3.4538799670292377, 6.436002046661016, 5.6055169913485985, 4.592097330026948, 7.729674592420585, 6.276131766227555, 6.932498572137115, 4.346763703847379, 8.424954230958656, 9.314273654797004, 3.1547500311014045, 5.484022317677318, 4.115132877293342, 4.976745324862656, 3.8853024047864637, 6.585147195601726, 9.218246839262372, 4.788078524894604, 7.215259597389532, 2.621277938377479, 6.390167111045212, 2.312208641703327, 4.643459235511279, 3.415694936931875, 5.706935191247422, 5.140520123403092, 7.752075649442204, 6.203747253693618, 0.6772412614565262, 10.242438252158012, 8.118671672992798, 9.024342089133551, -0.6055712310938677, 6.343679976457697, 4.710029748978642, 1.7130138490565747, 2.778053052064415, 3.9415081129067664, 0.4376672077389513, 7.669794159929226, 9.85241269265971, 5.330399006073121, 5.418054171555358, 3.9217000797377284, 3.32036123814187, 7.335631828273052, 8.025846208632707, 3.551388880413855, 7.271333770984815, 5.520806215363867, 8.356921874272578, 3.0824384875936577, 7.013141467163473, 5.7045038489784226, 2.567648587397797, 5.579877993170302, 4.139568124092876, 5.521999968525225, 8.303163766656775, 7.7967683320104, 3.6972713072327923, 3.864690763357155, 5.463868459607415, 3.9171301674775205, 6.969418397603116, 4.681383692596398, 6.97332552133482, 5.395643506577608, 1.6827088174853995, 3.4251493350919633, 5.337933956265546, 6.6121825155413205, 4.499436705829931, 4.145399369114848, 3.3992906360802753, 5.283056656014503, 6.436273615651687, 7.691033889574015, 2.6758707475724726, 4.5554725249451105, 5.568069072802617, 4.360142725986061, 6.419588660581907, 4.600482497911144, 1.9310570368169608, 6.479350294444645, 6.56978348597985, 5.391920037054532, 0.12209668286241836, 6.01284370850279, 4.221617650971625], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9801936294543108, "mean_inference_ms": 7.968477547675106, "mean_action_processing_ms": 0.535877689043722, "mean_env_wait_ms": 23.73775394785564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03084540367126465, "StateBufferConnector_ms": 0.031005144119262695, "ViewRequirementAgentConnector_ms": 0.9674646854400635}}, "episode_reward_max": 10.242438252158012, "episode_reward_min": -0.6055712310938677, "episode_reward_mean": 5.2577852354919425, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.718037762474914, 4.4588779420373665, 6.00578661981104, 3.1417861060634, 7.959473067361639, 5.918307567780698, 4.551850498468225, 5.776060676261714, 2.4794521269108456, 3.4538799670292377, 6.436002046661016, 5.6055169913485985, 4.592097330026948, 7.729674592420585, 6.276131766227555, 6.932498572137115, 4.346763703847379, 8.424954230958656, 9.314273654797004, 3.1547500311014045, 5.484022317677318, 4.115132877293342, 4.976745324862656, 3.8853024047864637, 6.585147195601726, 9.218246839262372, 4.788078524894604, 7.215259597389532, 2.621277938377479, 6.390167111045212, 2.312208641703327, 4.643459235511279, 3.415694936931875, 5.706935191247422, 5.140520123403092, 7.752075649442204, 6.203747253693618, 0.6772412614565262, 10.242438252158012, 8.118671672992798, 9.024342089133551, -0.6055712310938677, 6.343679976457697, 4.710029748978642, 1.7130138490565747, 2.778053052064415, 3.9415081129067664, 0.4376672077389513, 7.669794159929226, 9.85241269265971, 5.330399006073121, 5.418054171555358, 3.9217000797377284, 3.32036123814187, 7.335631828273052, 8.025846208632707, 3.551388880413855, 7.271333770984815, 5.520806215363867, 8.356921874272578, 3.0824384875936577, 7.013141467163473, 5.7045038489784226, 2.567648587397797, 5.579877993170302, 4.139568124092876, 5.521999968525225, 8.303163766656775, 7.7967683320104, 3.6972713072327923, 3.864690763357155, 5.463868459607415, 3.9171301674775205, 6.969418397603116, 4.681383692596398, 6.97332552133482, 5.395643506577608, 1.6827088174853995, 3.4251493350919633, 5.337933956265546, 6.6121825155413205, 4.499436705829931, 4.145399369114848, 3.3992906360802753, 5.283056656014503, 6.436273615651687, 7.691033889574015, 2.6758707475724726, 4.5554725249451105, 5.568069072802617, 4.360142725986061, 6.419588660581907, 4.600482497911144, 1.9310570368169608, 6.479350294444645, 6.56978348597985, 5.391920037054532, 0.12209668286241836, 6.01284370850279, 4.221617650971625], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9801936294543108, "mean_inference_ms": 7.968477547675106, "mean_action_processing_ms": 0.535877689043722, "mean_env_wait_ms": 23.73775394785564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03084540367126465, "StateBufferConnector_ms": 0.031005144119262695, "ViewRequirementAgentConnector_ms": 0.9674646854400635}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5788146, "num_agent_steps_trained": 5788146, "num_env_steps_sampled": 5788146, "num_env_steps_trained": 5788146, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 288.73104003665514, "num_env_steps_trained_throughput_per_sec": 288.73104003665514, "timesteps_total": 5788146, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5788146, "timers": {"training_iteration_time_ms": 54648.562, "sample_time_ms": 41504.873, "load_time_ms": 1837.012, "load_throughput": 8512.738, "learn_time_ms": 10774.592, "learn_throughput": 1451.377, "synch_weights_time_ms": 418.075}, "counters": {"num_env_steps_sampled": 5788146, "num_env_steps_trained": 5788146, "num_agent_steps_sampled": 5788146, "num_agent_steps_trained": 5788146}, "done": false, "episodes_total": 378, "training_iteration": 375, "trial_id": "2f030_00000", "date": "2025-06-07_08-01-42", "timestamp": 1749276102, "time_this_iter_s": 54.21399259567261, "time_total_s": 1521.0187170505524, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1521.0187170505524, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 77.16935483870971, "ram_util_percent": 64.73064516129034, "gpu_util_percent0": 0.08306451612903226, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.332140322580647e-05, "total_loss": -0.12338467380539937, "policy_loss": -0.031125209602998274, "vf_loss": 0.01529475485059348, "vf_explained_var": 0.6967174448750236, "kl": 0.020971264383772916, "entropy": 20.962995019392533, "entropy_coeff": 0.005332140322580645}, "model": {}, "num_grad_updates_lifetime": 15125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5803784, "num_env_steps_trained": 5803784, "num_agent_steps_sampled": 5803784, "num_agent_steps_trained": 5803784}, "sampler_results": {"episode_reward_max": 10.242438252158012, "episode_reward_min": -0.6055712310938677, "episode_reward_mean": 5.175750591403156, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.276131766227555, 6.932498572137115, 4.346763703847379, 8.424954230958656, 9.314273654797004, 3.1547500311014045, 5.484022317677318, 4.115132877293342, 4.976745324862656, 3.8853024047864637, 6.585147195601726, 9.218246839262372, 4.788078524894604, 7.215259597389532, 2.621277938377479, 6.390167111045212, 2.312208641703327, 4.643459235511279, 3.415694936931875, 5.706935191247422, 5.140520123403092, 7.752075649442204, 6.203747253693618, 0.6772412614565262, 10.242438252158012, 8.118671672992798, 9.024342089133551, -0.6055712310938677, 6.343679976457697, 4.710029748978642, 1.7130138490565747, 2.778053052064415, 3.9415081129067664, 0.4376672077389513, 7.669794159929226, 9.85241269265971, 5.330399006073121, 5.418054171555358, 3.9217000797377284, 3.32036123814187, 7.335631828273052, 8.025846208632707, 3.551388880413855, 7.271333770984815, 5.520806215363867, 8.356921874272578, 3.0824384875936577, 7.013141467163473, 5.7045038489784226, 2.567648587397797, 5.579877993170302, 4.139568124092876, 5.521999968525225, 8.303163766656775, 7.7967683320104, 3.6972713072327923, 3.864690763357155, 5.463868459607415, 3.9171301674775205, 6.969418397603116, 4.681383692596398, 6.97332552133482, 5.395643506577608, 1.6827088174853995, 3.4251493350919633, 5.337933956265546, 6.6121825155413205, 4.499436705829931, 4.145399369114848, 3.3992906360802753, 5.283056656014503, 6.436273615651687, 7.691033889574015, 2.6758707475724726, 4.5554725249451105, 5.568069072802617, 4.360142725986061, 6.419588660581907, 4.600482497911144, 1.9310570368169608, 6.479350294444645, 6.56978348597985, 5.391920037054532, 0.12209668286241836, 6.01284370850279, 4.221617650971625, 5.575598224884379, 7.548730911686539, -0.4934651218146746, 5.589173013519815, 5.229347312094933, 5.5687987650885225, 3.2186370881892055, 6.466942943484538, 7.160838473032978, 4.421999161385246, 6.249703163336673, 3.8632344908935465, 6.9743277887601645, 0.2494726712356648], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.974296162100905, "mean_inference_ms": 7.973169149463185, "mean_action_processing_ms": 0.5361405465255147, "mean_env_wait_ms": 23.746068781447033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03292393684387207, "StateBufferConnector_ms": 0.03363537788391113, "ViewRequirementAgentConnector_ms": 0.9714398384094238}}, "episode_reward_max": 10.242438252158012, "episode_reward_min": -0.6055712310938677, "episode_reward_mean": 5.175750591403156, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.276131766227555, 6.932498572137115, 4.346763703847379, 8.424954230958656, 9.314273654797004, 3.1547500311014045, 5.484022317677318, 4.115132877293342, 4.976745324862656, 3.8853024047864637, 6.585147195601726, 9.218246839262372, 4.788078524894604, 7.215259597389532, 2.621277938377479, 6.390167111045212, 2.312208641703327, 4.643459235511279, 3.415694936931875, 5.706935191247422, 5.140520123403092, 7.752075649442204, 6.203747253693618, 0.6772412614565262, 10.242438252158012, 8.118671672992798, 9.024342089133551, -0.6055712310938677, 6.343679976457697, 4.710029748978642, 1.7130138490565747, 2.778053052064415, 3.9415081129067664, 0.4376672077389513, 7.669794159929226, 9.85241269265971, 5.330399006073121, 5.418054171555358, 3.9217000797377284, 3.32036123814187, 7.335631828273052, 8.025846208632707, 3.551388880413855, 7.271333770984815, 5.520806215363867, 8.356921874272578, 3.0824384875936577, 7.013141467163473, 5.7045038489784226, 2.567648587397797, 5.579877993170302, 4.139568124092876, 5.521999968525225, 8.303163766656775, 7.7967683320104, 3.6972713072327923, 3.864690763357155, 5.463868459607415, 3.9171301674775205, 6.969418397603116, 4.681383692596398, 6.97332552133482, 5.395643506577608, 1.6827088174853995, 3.4251493350919633, 5.337933956265546, 6.6121825155413205, 4.499436705829931, 4.145399369114848, 3.3992906360802753, 5.283056656014503, 6.436273615651687, 7.691033889574015, 2.6758707475724726, 4.5554725249451105, 5.568069072802617, 4.360142725986061, 6.419588660581907, 4.600482497911144, 1.9310570368169608, 6.479350294444645, 6.56978348597985, 5.391920037054532, 0.12209668286241836, 6.01284370850279, 4.221617650971625, 5.575598224884379, 7.548730911686539, -0.4934651218146746, 5.589173013519815, 5.229347312094933, 5.5687987650885225, 3.2186370881892055, 6.466942943484538, 7.160838473032978, 4.421999161385246, 6.249703163336673, 3.8632344908935465, 6.9743277887601645, 0.2494726712356648], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.974296162100905, "mean_inference_ms": 7.973169149463185, "mean_action_processing_ms": 0.5361405465255147, "mean_env_wait_ms": 23.746068781447033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03292393684387207, "StateBufferConnector_ms": 0.03363537788391113, "ViewRequirementAgentConnector_ms": 0.9714398384094238}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5803784, "num_agent_steps_trained": 5803784, "num_env_steps_sampled": 5803784, "num_env_steps_trained": 5803784, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 287.3486039615824, "num_env_steps_trained_throughput_per_sec": 287.3486039615824, "timesteps_total": 5803784, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5803784, "timers": {"training_iteration_time_ms": 54675.302, "sample_time_ms": 41518.855, "load_time_ms": 1841.434, "load_throughput": 8492.293, "learn_time_ms": 10780.059, "learn_throughput": 1450.641, "synch_weights_time_ms": 421.041}, "counters": {"num_env_steps_sampled": 5803784, "num_env_steps_trained": 5803784, "num_agent_steps_sampled": 5803784, "num_agent_steps_trained": 5803784}, "done": false, "episodes_total": 392, "training_iteration": 376, "trial_id": "2f030_00000", "date": "2025-06-07_08-02-37", "timestamp": 1749276157, "time_this_iter_s": 54.43770456314087, "time_total_s": 1575.4564216136932, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1575.4564216136932, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 77.47258064516129, "ram_util_percent": 65.42096774193548, "gpu_util_percent0": 0.07741935483870968, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.3195290322580654e-05, "total_loss": -0.10774305141022937, "policy_loss": -0.015691198521156118, "vf_loss": 0.01565998022021218, "vf_explained_var": 0.7150277156179602, "kl": 0.020540228232080494, "entropy": 20.93657552025535, "entropy_coeff": 0.005319529032258067}, "model": {}, "num_grad_updates_lifetime": 15675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5819422, "num_env_steps_trained": 5819422, "num_agent_steps_sampled": 5819422, "num_agent_steps_trained": 5819422}, "sampler_results": {"episode_reward_max": 10.242438252158012, "episode_reward_min": -0.6055712310938677, "episode_reward_mean": 5.136248301256453, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.621277938377479, 6.390167111045212, 2.312208641703327, 4.643459235511279, 3.415694936931875, 5.706935191247422, 5.140520123403092, 7.752075649442204, 6.203747253693618, 0.6772412614565262, 10.242438252158012, 8.118671672992798, 9.024342089133551, -0.6055712310938677, 6.343679976457697, 4.710029748978642, 1.7130138490565747, 2.778053052064415, 3.9415081129067664, 0.4376672077389513, 7.669794159929226, 9.85241269265971, 5.330399006073121, 5.418054171555358, 3.9217000797377284, 3.32036123814187, 7.335631828273052, 8.025846208632707, 3.551388880413855, 7.271333770984815, 5.520806215363867, 8.356921874272578, 3.0824384875936577, 7.013141467163473, 5.7045038489784226, 2.567648587397797, 5.579877993170302, 4.139568124092876, 5.521999968525225, 8.303163766656775, 7.7967683320104, 3.6972713072327923, 3.864690763357155, 5.463868459607415, 3.9171301674775205, 6.969418397603116, 4.681383692596398, 6.97332552133482, 5.395643506577608, 1.6827088174853995, 3.4251493350919633, 5.337933956265546, 6.6121825155413205, 4.499436705829931, 4.145399369114848, 3.3992906360802753, 5.283056656014503, 6.436273615651687, 7.691033889574015, 2.6758707475724726, 4.5554725249451105, 5.568069072802617, 4.360142725986061, 6.419588660581907, 4.600482497911144, 1.9310570368169608, 6.479350294444645, 6.56978348597985, 5.391920037054532, 0.12209668286241836, 6.01284370850279, 4.221617650971625, 5.575598224884379, 7.548730911686539, -0.4934651218146746, 5.589173013519815, 5.229347312094933, 5.5687987650885225, 3.2186370881892055, 6.466942943484538, 7.160838473032978, 4.421999161385246, 6.249703163336673, 3.8632344908935465, 6.9743277887601645, 0.2494726712356648, 8.909756910604026, 6.442066482420908, 5.923848806083653, 7.867757013210781, 7.4318586979875265, 6.582111568442942, 9.193895441534691, 7.217600368305265, 6.691111163874288, 4.813168246560915, 3.1285296890401932, 1.2930658793449916, 2.6060637627599617, 2.666243995996886], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.96986956599907, "mean_inference_ms": 7.977211911413602, "mean_action_processing_ms": 0.5363020951969618, "mean_env_wait_ms": 23.752972995183946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0346226692199707, "StateBufferConnector_ms": 0.03472137451171875, "ViewRequirementAgentConnector_ms": 0.9645838737487793}}, "episode_reward_max": 10.242438252158012, "episode_reward_min": -0.6055712310938677, "episode_reward_mean": 5.136248301256453, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.621277938377479, 6.390167111045212, 2.312208641703327, 4.643459235511279, 3.415694936931875, 5.706935191247422, 5.140520123403092, 7.752075649442204, 6.203747253693618, 0.6772412614565262, 10.242438252158012, 8.118671672992798, 9.024342089133551, -0.6055712310938677, 6.343679976457697, 4.710029748978642, 1.7130138490565747, 2.778053052064415, 3.9415081129067664, 0.4376672077389513, 7.669794159929226, 9.85241269265971, 5.330399006073121, 5.418054171555358, 3.9217000797377284, 3.32036123814187, 7.335631828273052, 8.025846208632707, 3.551388880413855, 7.271333770984815, 5.520806215363867, 8.356921874272578, 3.0824384875936577, 7.013141467163473, 5.7045038489784226, 2.567648587397797, 5.579877993170302, 4.139568124092876, 5.521999968525225, 8.303163766656775, 7.7967683320104, 3.6972713072327923, 3.864690763357155, 5.463868459607415, 3.9171301674775205, 6.969418397603116, 4.681383692596398, 6.97332552133482, 5.395643506577608, 1.6827088174853995, 3.4251493350919633, 5.337933956265546, 6.6121825155413205, 4.499436705829931, 4.145399369114848, 3.3992906360802753, 5.283056656014503, 6.436273615651687, 7.691033889574015, 2.6758707475724726, 4.5554725249451105, 5.568069072802617, 4.360142725986061, 6.419588660581907, 4.600482497911144, 1.9310570368169608, 6.479350294444645, 6.56978348597985, 5.391920037054532, 0.12209668286241836, 6.01284370850279, 4.221617650971625, 5.575598224884379, 7.548730911686539, -0.4934651218146746, 5.589173013519815, 5.229347312094933, 5.5687987650885225, 3.2186370881892055, 6.466942943484538, 7.160838473032978, 4.421999161385246, 6.249703163336673, 3.8632344908935465, 6.9743277887601645, 0.2494726712356648, 8.909756910604026, 6.442066482420908, 5.923848806083653, 7.867757013210781, 7.4318586979875265, 6.582111568442942, 9.193895441534691, 7.217600368305265, 6.691111163874288, 4.813168246560915, 3.1285296890401932, 1.2930658793449916, 2.6060637627599617, 2.666243995996886], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.96986956599907, "mean_inference_ms": 7.977211911413602, "mean_action_processing_ms": 0.5363020951969618, "mean_env_wait_ms": 23.752972995183946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0346226692199707, "StateBufferConnector_ms": 0.03472137451171875, "ViewRequirementAgentConnector_ms": 0.9645838737487793}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5819422, "num_agent_steps_trained": 5819422, "num_env_steps_sampled": 5819422, "num_env_steps_trained": 5819422, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.890721108195, "num_env_steps_trained_throughput_per_sec": 286.890721108195, "timesteps_total": 5819422, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5819422, "timers": {"training_iteration_time_ms": 54685.482, "sample_time_ms": 41517.56, "load_time_ms": 1847.287, "load_throughput": 8465.387, "learn_time_ms": 10780.806, "learn_throughput": 1450.541, "synch_weights_time_ms": 426.668}, "counters": {"num_env_steps_sampled": 5819422, "num_env_steps_trained": 5819422, "num_agent_steps_sampled": 5819422, "num_agent_steps_trained": 5819422}, "done": false, "episodes_total": 406, "training_iteration": 377, "trial_id": "2f030_00000", "date": "2025-06-07_08-03-31", "timestamp": 1749276211, "time_this_iter_s": 54.52566599845886, "time_total_s": 1629.982087612152, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1629.982087612152, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 76.7952380952381, "ram_util_percent": 65.32063492063492, "gpu_util_percent0": 0.08031746031746033, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.306917741935485e-05, "total_loss": -0.11038220892660319, "policy_loss": -0.018299719709268008, "vf_loss": 0.0155647324338894, "vf_explained_var": 0.7011969397284767, "kl": 0.020622675708214258, "entropy": 20.997778218009255, "entropy_coeff": 0.005306917741935485}, "model": {}, "num_grad_updates_lifetime": 16225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5835060, "num_env_steps_trained": 5835060, "num_agent_steps_sampled": 5835060, "num_agent_steps_trained": 5835060}, "sampler_results": {"episode_reward_max": 9.85241269265971, "episode_reward_min": -0.4934651218146746, "episode_reward_mean": 5.077256590155434, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.343679976457697, 4.710029748978642, 1.7130138490565747, 2.778053052064415, 3.9415081129067664, 0.4376672077389513, 7.669794159929226, 9.85241269265971, 5.330399006073121, 5.418054171555358, 3.9217000797377284, 3.32036123814187, 7.335631828273052, 8.025846208632707, 3.551388880413855, 7.271333770984815, 5.520806215363867, 8.356921874272578, 3.0824384875936577, 7.013141467163473, 5.7045038489784226, 2.567648587397797, 5.579877993170302, 4.139568124092876, 5.521999968525225, 8.303163766656775, 7.7967683320104, 3.6972713072327923, 3.864690763357155, 5.463868459607415, 3.9171301674775205, 6.969418397603116, 4.681383692596398, 6.97332552133482, 5.395643506577608, 1.6827088174853995, 3.4251493350919633, 5.337933956265546, 6.6121825155413205, 4.499436705829931, 4.145399369114848, 3.3992906360802753, 5.283056656014503, 6.436273615651687, 7.691033889574015, 2.6758707475724726, 4.5554725249451105, 5.568069072802617, 4.360142725986061, 6.419588660581907, 4.600482497911144, 1.9310570368169608, 6.479350294444645, 6.56978348597985, 5.391920037054532, 0.12209668286241836, 6.01284370850279, 4.221617650971625, 5.575598224884379, 7.548730911686539, -0.4934651218146746, 5.589173013519815, 5.229347312094933, 5.5687987650885225, 3.2186370881892055, 6.466942943484538, 7.160838473032978, 4.421999161385246, 6.249703163336673, 3.8632344908935465, 6.9743277887601645, 0.2494726712356648, 8.909756910604026, 6.442066482420908, 5.923848806083653, 7.867757013210781, 7.4318586979875265, 6.582111568442942, 9.193895441534691, 7.217600368305265, 6.691111163874288, 4.813168246560915, 3.1285296890401932, 1.2930658793449916, 2.6060637627599617, 2.666243995996886, 6.54601099738856, 7.036964311226677, 6.972018771110697, 5.139062726641509, 2.1621400686824455, 0.3782381511831131, 5.418317607062198, 0.5126014643983892, 4.301296787590288, 5.1975601466137284, 7.0554098712569635, 4.09824995595908, 4.095889612626187, 6.830276544160681], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.966433221918786, "mean_inference_ms": 7.979957295387299, "mean_action_processing_ms": 0.5364087832285243, "mean_env_wait_ms": 23.75799380293334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03168535232543945, "StateBufferConnector_ms": 0.03879404067993164, "ViewRequirementAgentConnector_ms": 0.9258573055267334}}, "episode_reward_max": 9.85241269265971, "episode_reward_min": -0.4934651218146746, "episode_reward_mean": 5.077256590155434, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.343679976457697, 4.710029748978642, 1.7130138490565747, 2.778053052064415, 3.9415081129067664, 0.4376672077389513, 7.669794159929226, 9.85241269265971, 5.330399006073121, 5.418054171555358, 3.9217000797377284, 3.32036123814187, 7.335631828273052, 8.025846208632707, 3.551388880413855, 7.271333770984815, 5.520806215363867, 8.356921874272578, 3.0824384875936577, 7.013141467163473, 5.7045038489784226, 2.567648587397797, 5.579877993170302, 4.139568124092876, 5.521999968525225, 8.303163766656775, 7.7967683320104, 3.6972713072327923, 3.864690763357155, 5.463868459607415, 3.9171301674775205, 6.969418397603116, 4.681383692596398, 6.97332552133482, 5.395643506577608, 1.6827088174853995, 3.4251493350919633, 5.337933956265546, 6.6121825155413205, 4.499436705829931, 4.145399369114848, 3.3992906360802753, 5.283056656014503, 6.436273615651687, 7.691033889574015, 2.6758707475724726, 4.5554725249451105, 5.568069072802617, 4.360142725986061, 6.419588660581907, 4.600482497911144, 1.9310570368169608, 6.479350294444645, 6.56978348597985, 5.391920037054532, 0.12209668286241836, 6.01284370850279, 4.221617650971625, 5.575598224884379, 7.548730911686539, -0.4934651218146746, 5.589173013519815, 5.229347312094933, 5.5687987650885225, 3.2186370881892055, 6.466942943484538, 7.160838473032978, 4.421999161385246, 6.249703163336673, 3.8632344908935465, 6.9743277887601645, 0.2494726712356648, 8.909756910604026, 6.442066482420908, 5.923848806083653, 7.867757013210781, 7.4318586979875265, 6.582111568442942, 9.193895441534691, 7.217600368305265, 6.691111163874288, 4.813168246560915, 3.1285296890401932, 1.2930658793449916, 2.6060637627599617, 2.666243995996886, 6.54601099738856, 7.036964311226677, 6.972018771110697, 5.139062726641509, 2.1621400686824455, 0.3782381511831131, 5.418317607062198, 0.5126014643983892, 4.301296787590288, 5.1975601466137284, 7.0554098712569635, 4.09824995595908, 4.095889612626187, 6.830276544160681], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.966433221918786, "mean_inference_ms": 7.979957295387299, "mean_action_processing_ms": 0.5364087832285243, "mean_env_wait_ms": 23.75799380293334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03168535232543945, "StateBufferConnector_ms": 0.03879404067993164, "ViewRequirementAgentConnector_ms": 0.9258573055267334}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5835060, "num_agent_steps_trained": 5835060, "num_env_steps_sampled": 5835060, "num_env_steps_trained": 5835060, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.7224315336017, "num_env_steps_trained_throughput_per_sec": 286.7224315336017, "timesteps_total": 5835060, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5835060, "timers": {"training_iteration_time_ms": 54682.413, "sample_time_ms": 41474.253, "load_time_ms": 1850.699, "load_throughput": 8449.78, "learn_time_ms": 10785.553, "learn_throughput": 1449.902, "synch_weights_time_ms": 458.635}, "counters": {"num_env_steps_sampled": 5835060, "num_env_steps_trained": 5835060, "num_agent_steps_sampled": 5835060, "num_agent_steps_trained": 5835060}, "done": false, "episodes_total": 420, "training_iteration": 378, "trial_id": "2f030_00000", "date": "2025-06-07_08-04-26", "timestamp": 1749276266, "time_this_iter_s": 54.55637717247009, "time_total_s": 1684.5384647846222, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1684.5384647846222, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 77.03225806451613, "ram_util_percent": 65.12903225806451, "gpu_util_percent0": 0.07919354838709677, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.294306451612905e-05, "total_loss": -0.12337034037167376, "policy_loss": -0.031498978470468, "vf_loss": 0.014968149838122455, "vf_explained_var": 0.7228803490508686, "kl": 0.02013328567361015, "entropy": 20.90830430464311, "entropy_coeff": 0.005294306451612904}, "model": {}, "num_grad_updates_lifetime": 16775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5850698, "num_env_steps_trained": 5850698, "num_agent_steps_sampled": 5850698, "num_agent_steps_trained": 5850698}, "sampler_results": {"episode_reward_max": 9.39706791440718, "episode_reward_min": -0.4934651218146746, "episode_reward_mean": 5.19079726298691, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.551388880413855, 7.271333770984815, 5.520806215363867, 8.356921874272578, 3.0824384875936577, 7.013141467163473, 5.7045038489784226, 2.567648587397797, 5.579877993170302, 4.139568124092876, 5.521999968525225, 8.303163766656775, 7.7967683320104, 3.6972713072327923, 3.864690763357155, 5.463868459607415, 3.9171301674775205, 6.969418397603116, 4.681383692596398, 6.97332552133482, 5.395643506577608, 1.6827088174853995, 3.4251493350919633, 5.337933956265546, 6.6121825155413205, 4.499436705829931, 4.145399369114848, 3.3992906360802753, 5.283056656014503, 6.436273615651687, 7.691033889574015, 2.6758707475724726, 4.5554725249451105, 5.568069072802617, 4.360142725986061, 6.419588660581907, 4.600482497911144, 1.9310570368169608, 6.479350294444645, 6.56978348597985, 5.391920037054532, 0.12209668286241836, 6.01284370850279, 4.221617650971625, 5.575598224884379, 7.548730911686539, -0.4934651218146746, 5.589173013519815, 5.229347312094933, 5.5687987650885225, 3.2186370881892055, 6.466942943484538, 7.160838473032978, 4.421999161385246, 6.249703163336673, 3.8632344908935465, 6.9743277887601645, 0.2494726712356648, 8.909756910604026, 6.442066482420908, 5.923848806083653, 7.867757013210781, 7.4318586979875265, 6.582111568442942, 9.193895441534691, 7.217600368305265, 6.691111163874288, 4.813168246560915, 3.1285296890401932, 1.2930658793449916, 2.6060637627599617, 2.666243995996886, 6.54601099738856, 7.036964311226677, 6.972018771110697, 5.139062726641509, 2.1621400686824455, 0.3782381511831131, 5.418317607062198, 0.5126014643983892, 4.301296787590288, 5.1975601466137284, 7.0554098712569635, 4.09824995595908, 4.095889612626187, 6.830276544160681, 3.1484442945458033, 6.796295589142853, 5.691173663903955, 5.796165310470863, 9.39706791440718, 5.878722335582554, 5.547895583522349, 6.8380723810370885, 7.098568983681901, 5.023241960082483, 5.734898524345171, 7.362426373105276, 5.597653692675246, 2.2415920088508345], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.962717541285088, "mean_inference_ms": 7.9834512246330345, "mean_action_processing_ms": 0.5366208754041848, "mean_env_wait_ms": 23.765208644310718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03229999542236328, "StateBufferConnector_ms": 0.03684687614440918, "ViewRequirementAgentConnector_ms": 0.959775447845459}}, "episode_reward_max": 9.39706791440718, "episode_reward_min": -0.4934651218146746, "episode_reward_mean": 5.19079726298691, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.551388880413855, 7.271333770984815, 5.520806215363867, 8.356921874272578, 3.0824384875936577, 7.013141467163473, 5.7045038489784226, 2.567648587397797, 5.579877993170302, 4.139568124092876, 5.521999968525225, 8.303163766656775, 7.7967683320104, 3.6972713072327923, 3.864690763357155, 5.463868459607415, 3.9171301674775205, 6.969418397603116, 4.681383692596398, 6.97332552133482, 5.395643506577608, 1.6827088174853995, 3.4251493350919633, 5.337933956265546, 6.6121825155413205, 4.499436705829931, 4.145399369114848, 3.3992906360802753, 5.283056656014503, 6.436273615651687, 7.691033889574015, 2.6758707475724726, 4.5554725249451105, 5.568069072802617, 4.360142725986061, 6.419588660581907, 4.600482497911144, 1.9310570368169608, 6.479350294444645, 6.56978348597985, 5.391920037054532, 0.12209668286241836, 6.01284370850279, 4.221617650971625, 5.575598224884379, 7.548730911686539, -0.4934651218146746, 5.589173013519815, 5.229347312094933, 5.5687987650885225, 3.2186370881892055, 6.466942943484538, 7.160838473032978, 4.421999161385246, 6.249703163336673, 3.8632344908935465, 6.9743277887601645, 0.2494726712356648, 8.909756910604026, 6.442066482420908, 5.923848806083653, 7.867757013210781, 7.4318586979875265, 6.582111568442942, 9.193895441534691, 7.217600368305265, 6.691111163874288, 4.813168246560915, 3.1285296890401932, 1.2930658793449916, 2.6060637627599617, 2.666243995996886, 6.54601099738856, 7.036964311226677, 6.972018771110697, 5.139062726641509, 2.1621400686824455, 0.3782381511831131, 5.418317607062198, 0.5126014643983892, 4.301296787590288, 5.1975601466137284, 7.0554098712569635, 4.09824995595908, 4.095889612626187, 6.830276544160681, 3.1484442945458033, 6.796295589142853, 5.691173663903955, 5.796165310470863, 9.39706791440718, 5.878722335582554, 5.547895583522349, 6.8380723810370885, 7.098568983681901, 5.023241960082483, 5.734898524345171, 7.362426373105276, 5.597653692675246, 2.2415920088508345], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.962717541285088, "mean_inference_ms": 7.9834512246330345, "mean_action_processing_ms": 0.5366208754041848, "mean_env_wait_ms": 23.765208644310718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03229999542236328, "StateBufferConnector_ms": 0.03684687614440918, "ViewRequirementAgentConnector_ms": 0.959775447845459}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5850698, "num_agent_steps_trained": 5850698, "num_env_steps_sampled": 5850698, "num_env_steps_trained": 5850698, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.9562321641757, "num_env_steps_trained_throughput_per_sec": 284.9562321641757, "timesteps_total": 5850698, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5850698, "timers": {"training_iteration_time_ms": 54785.144, "sample_time_ms": 41567.182, "load_time_ms": 1841.108, "load_throughput": 8493.798, "learn_time_ms": 10803.293, "learn_throughput": 1447.522, "synch_weights_time_ms": 459.764}, "counters": {"num_env_steps_sampled": 5850698, "num_env_steps_trained": 5850698, "num_agent_steps_sampled": 5850698, "num_agent_steps_trained": 5850698}, "done": false, "episodes_total": 434, "training_iteration": 379, "trial_id": "2f030_00000", "date": "2025-06-07_08-05-21", "timestamp": 1749276321, "time_this_iter_s": 54.893086671829224, "time_total_s": 1739.4315514564514, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1739.4315514564514, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 77.97619047619048, "ram_util_percent": 64.96984126984125, "gpu_util_percent0": 0.07746031746031747, "vram_util_percent0": 0.8592122395833336}}
{"evaluation": {"sampler_results": {"episode_reward_max": -1.0324102699291153, "episode_reward_min": -4.8250509670073, "episode_reward_mean": -3.475689704838614, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.278584696774243, -3.622997486302051, -1.0324102699291153, -4.8250509670073, -3.6194051041803625], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5181780703460934, "mean_inference_ms": 3.982505342358644, "mean_action_processing_ms": 0.3032280808717976, "mean_env_wait_ms": 10.56677794462959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04021644592285156, "StateBufferConnector_ms": 0.020008087158203125, "ViewRequirementAgentConnector_ms": 0.2514505386352539}}, "episode_reward_max": -1.0324102699291153, "episode_reward_min": -4.8250509670073, "episode_reward_mean": -3.475689704838614, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.278584696774243, -3.622997486302051, -1.0324102699291153, -4.8250509670073, -3.6194051041803625], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5181780703460934, "mean_inference_ms": 3.982505342358644, "mean_action_processing_ms": 0.3032280808717976, "mean_env_wait_ms": 10.56677794462959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04021644592285156, "StateBufferConnector_ms": 0.020008087158203125, "ViewRequirementAgentConnector_ms": 0.2514505386352539}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.281695161290323e-05, "total_loss": -0.11713968597860498, "policy_loss": -0.02476666610862594, "vf_loss": 0.015736690531061453, "vf_explained_var": 0.6970151375640522, "kl": 0.019641159226800056, "entropy": 21.030529306585137, "entropy_coeff": 0.005281695161290324}, "model": {}, "num_grad_updates_lifetime": 17325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5866336, "num_env_steps_trained": 5866336, "num_agent_steps_sampled": 5866336, "num_agent_steps_trained": 5866336}, "sampler_results": {"episode_reward_max": 9.39706791440718, "episode_reward_min": -0.4934651218146746, "episode_reward_mean": 5.030162044786025, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.864690763357155, 5.463868459607415, 3.9171301674775205, 6.969418397603116, 4.681383692596398, 6.97332552133482, 5.395643506577608, 1.6827088174853995, 3.4251493350919633, 5.337933956265546, 6.6121825155413205, 4.499436705829931, 4.145399369114848, 3.3992906360802753, 5.283056656014503, 6.436273615651687, 7.691033889574015, 2.6758707475724726, 4.5554725249451105, 5.568069072802617, 4.360142725986061, 6.419588660581907, 4.600482497911144, 1.9310570368169608, 6.479350294444645, 6.56978348597985, 5.391920037054532, 0.12209668286241836, 6.01284370850279, 4.221617650971625, 5.575598224884379, 7.548730911686539, -0.4934651218146746, 5.589173013519815, 5.229347312094933, 5.5687987650885225, 3.2186370881892055, 6.466942943484538, 7.160838473032978, 4.421999161385246, 6.249703163336673, 3.8632344908935465, 6.9743277887601645, 0.2494726712356648, 8.909756910604026, 6.442066482420908, 5.923848806083653, 7.867757013210781, 7.4318586979875265, 6.582111568442942, 9.193895441534691, 7.217600368305265, 6.691111163874288, 4.813168246560915, 3.1285296890401932, 1.2930658793449916, 2.6060637627599617, 2.666243995996886, 6.54601099738856, 7.036964311226677, 6.972018771110697, 5.139062726641509, 2.1621400686824455, 0.3782381511831131, 5.418317607062198, 0.5126014643983892, 4.301296787590288, 5.1975601466137284, 7.0554098712569635, 4.09824995595908, 4.095889612626187, 6.830276544160681, 3.1484442945458033, 6.796295589142853, 5.691173663903955, 5.796165310470863, 9.39706791440718, 5.878722335582554, 5.547895583522349, 6.8380723810370885, 7.098568983681901, 5.023241960082483, 5.734898524345171, 7.362426373105276, 5.597653692675246, 2.2415920088508345, 9.215273742859395, 6.350933255656576, 2.492417990997376, 2.611150254995543, 6.57095884534993, 5.61639927945532, 6.811242483284282, 0.6752690437797458, 4.404904015056502, 5.991649393314989, 0.19194166246238875, 5.215421284045687, 0.5712538260715339, 5.324495726438961], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9604099329283717, "mean_inference_ms": 7.986100294716087, "mean_action_processing_ms": 0.5366428003347824, "mean_env_wait_ms": 23.772564636531573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0332798957824707, "StateBufferConnector_ms": 0.03733015060424805, "ViewRequirementAgentConnector_ms": 0.9471101760864258}}, "episode_reward_max": 9.39706791440718, "episode_reward_min": -0.4934651218146746, "episode_reward_mean": 5.030162044786025, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.864690763357155, 5.463868459607415, 3.9171301674775205, 6.969418397603116, 4.681383692596398, 6.97332552133482, 5.395643506577608, 1.6827088174853995, 3.4251493350919633, 5.337933956265546, 6.6121825155413205, 4.499436705829931, 4.145399369114848, 3.3992906360802753, 5.283056656014503, 6.436273615651687, 7.691033889574015, 2.6758707475724726, 4.5554725249451105, 5.568069072802617, 4.360142725986061, 6.419588660581907, 4.600482497911144, 1.9310570368169608, 6.479350294444645, 6.56978348597985, 5.391920037054532, 0.12209668286241836, 6.01284370850279, 4.221617650971625, 5.575598224884379, 7.548730911686539, -0.4934651218146746, 5.589173013519815, 5.229347312094933, 5.5687987650885225, 3.2186370881892055, 6.466942943484538, 7.160838473032978, 4.421999161385246, 6.249703163336673, 3.8632344908935465, 6.9743277887601645, 0.2494726712356648, 8.909756910604026, 6.442066482420908, 5.923848806083653, 7.867757013210781, 7.4318586979875265, 6.582111568442942, 9.193895441534691, 7.217600368305265, 6.691111163874288, 4.813168246560915, 3.1285296890401932, 1.2930658793449916, 2.6060637627599617, 2.666243995996886, 6.54601099738856, 7.036964311226677, 6.972018771110697, 5.139062726641509, 2.1621400686824455, 0.3782381511831131, 5.418317607062198, 0.5126014643983892, 4.301296787590288, 5.1975601466137284, 7.0554098712569635, 4.09824995595908, 4.095889612626187, 6.830276544160681, 3.1484442945458033, 6.796295589142853, 5.691173663903955, 5.796165310470863, 9.39706791440718, 5.878722335582554, 5.547895583522349, 6.8380723810370885, 7.098568983681901, 5.023241960082483, 5.734898524345171, 7.362426373105276, 5.597653692675246, 2.2415920088508345, 9.215273742859395, 6.350933255656576, 2.492417990997376, 2.611150254995543, 6.57095884534993, 5.61639927945532, 6.811242483284282, 0.6752690437797458, 4.404904015056502, 5.991649393314989, 0.19194166246238875, 5.215421284045687, 0.5712538260715339, 5.324495726438961], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9604099329283717, "mean_inference_ms": 7.986100294716087, "mean_action_processing_ms": 0.5366428003347824, "mean_env_wait_ms": 23.772564636531573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0332798957824707, "StateBufferConnector_ms": 0.03733015060424805, "ViewRequirementAgentConnector_ms": 0.9471101760864258}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5866336, "num_agent_steps_trained": 5866336, "num_env_steps_sampled": 5866336, "num_env_steps_trained": 5866336, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.8249942778255, "num_env_steps_trained_throughput_per_sec": 281.8249942778255, "timesteps_total": 5866336, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5866336, "timers": {"training_iteration_time_ms": 54860.82, "sample_time_ms": 41660.256, "load_time_ms": 1843.287, "load_throughput": 8483.757, "learn_time_ms": 10786.12, "learn_throughput": 1449.826, "synch_weights_time_ms": 458.761}, "counters": {"num_env_steps_sampled": 5866336, "num_env_steps_trained": 5866336, "num_agent_steps_sampled": 5866336, "num_agent_steps_trained": 5866336}, "done": false, "episodes_total": 448, "training_iteration": 380, "trial_id": "2f030_00000", "date": "2025-06-07_08-06-31", "timestamp": 1749276391, "time_this_iter_s": 70.13981127738953, "time_total_s": 1809.571362733841, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1809.571362733841, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 65.73414634146343, "ram_util_percent": 64.74024390243903, "gpu_util_percent0": 0.05926829268292682, "vram_util_percent0": 0.8592122395833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.2690838709677425e-05, "total_loss": -0.10635625168342482, "policy_loss": -0.014369334281787318, "vf_loss": 0.015618309673260559, "vf_explained_var": 0.7037177921425213, "kl": 0.019332410921889736, "entropy": 20.959133118716153, "entropy_coeff": 0.005269083870967742}, "model": {}, "num_grad_updates_lifetime": 17875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5881974, "num_env_steps_trained": 5881974, "num_agent_steps_sampled": 5881974, "num_agent_steps_trained": 5881974}, "sampler_results": {"episode_reward_max": 9.39706791440718, "episode_reward_min": -0.4934651218146746, "episode_reward_mean": 5.099736090663817, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.283056656014503, 6.436273615651687, 7.691033889574015, 2.6758707475724726, 4.5554725249451105, 5.568069072802617, 4.360142725986061, 6.419588660581907, 4.600482497911144, 1.9310570368169608, 6.479350294444645, 6.56978348597985, 5.391920037054532, 0.12209668286241836, 6.01284370850279, 4.221617650971625, 5.575598224884379, 7.548730911686539, -0.4934651218146746, 5.589173013519815, 5.229347312094933, 5.5687987650885225, 3.2186370881892055, 6.466942943484538, 7.160838473032978, 4.421999161385246, 6.249703163336673, 3.8632344908935465, 6.9743277887601645, 0.2494726712356648, 8.909756910604026, 6.442066482420908, 5.923848806083653, 7.867757013210781, 7.4318586979875265, 6.582111568442942, 9.193895441534691, 7.217600368305265, 6.691111163874288, 4.813168246560915, 3.1285296890401932, 1.2930658793449916, 2.6060637627599617, 2.666243995996886, 6.54601099738856, 7.036964311226677, 6.972018771110697, 5.139062726641509, 2.1621400686824455, 0.3782381511831131, 5.418317607062198, 0.5126014643983892, 4.301296787590288, 5.1975601466137284, 7.0554098712569635, 4.09824995595908, 4.095889612626187, 6.830276544160681, 3.1484442945458033, 6.796295589142853, 5.691173663903955, 5.796165310470863, 9.39706791440718, 5.878722335582554, 5.547895583522349, 6.8380723810370885, 7.098568983681901, 5.023241960082483, 5.734898524345171, 7.362426373105276, 5.597653692675246, 2.2415920088508345, 9.215273742859395, 6.350933255656576, 2.492417990997376, 2.611150254995543, 6.57095884534993, 5.61639927945532, 6.811242483284282, 0.6752690437797458, 4.404904015056502, 5.991649393314989, 0.19194166246238875, 5.215421284045687, 0.5712538260715339, 5.324495726438961, 8.118889217652113, 8.65350369879165, 7.517578005960269, 4.989338238614186, 1.107134184900857, 5.591886400623367, 6.551494130260887, 4.5897649981696444, 4.27821652754534, 4.006813981293457, 5.182792859380319, 2.4309680999959924, 1.621705662132354, 8.684880426422103], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.959027112819717, "mean_inference_ms": 7.987926769785453, "mean_action_processing_ms": 0.5365873630190978, "mean_env_wait_ms": 23.77691729881849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03246140480041504, "StateBufferConnector_ms": 0.03676891326904297, "ViewRequirementAgentConnector_ms": 0.9886980056762695}}, "episode_reward_max": 9.39706791440718, "episode_reward_min": -0.4934651218146746, "episode_reward_mean": 5.099736090663817, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.283056656014503, 6.436273615651687, 7.691033889574015, 2.6758707475724726, 4.5554725249451105, 5.568069072802617, 4.360142725986061, 6.419588660581907, 4.600482497911144, 1.9310570368169608, 6.479350294444645, 6.56978348597985, 5.391920037054532, 0.12209668286241836, 6.01284370850279, 4.221617650971625, 5.575598224884379, 7.548730911686539, -0.4934651218146746, 5.589173013519815, 5.229347312094933, 5.5687987650885225, 3.2186370881892055, 6.466942943484538, 7.160838473032978, 4.421999161385246, 6.249703163336673, 3.8632344908935465, 6.9743277887601645, 0.2494726712356648, 8.909756910604026, 6.442066482420908, 5.923848806083653, 7.867757013210781, 7.4318586979875265, 6.582111568442942, 9.193895441534691, 7.217600368305265, 6.691111163874288, 4.813168246560915, 3.1285296890401932, 1.2930658793449916, 2.6060637627599617, 2.666243995996886, 6.54601099738856, 7.036964311226677, 6.972018771110697, 5.139062726641509, 2.1621400686824455, 0.3782381511831131, 5.418317607062198, 0.5126014643983892, 4.301296787590288, 5.1975601466137284, 7.0554098712569635, 4.09824995595908, 4.095889612626187, 6.830276544160681, 3.1484442945458033, 6.796295589142853, 5.691173663903955, 5.796165310470863, 9.39706791440718, 5.878722335582554, 5.547895583522349, 6.8380723810370885, 7.098568983681901, 5.023241960082483, 5.734898524345171, 7.362426373105276, 5.597653692675246, 2.2415920088508345, 9.215273742859395, 6.350933255656576, 2.492417990997376, 2.611150254995543, 6.57095884534993, 5.61639927945532, 6.811242483284282, 0.6752690437797458, 4.404904015056502, 5.991649393314989, 0.19194166246238875, 5.215421284045687, 0.5712538260715339, 5.324495726438961, 8.118889217652113, 8.65350369879165, 7.517578005960269, 4.989338238614186, 1.107134184900857, 5.591886400623367, 6.551494130260887, 4.5897649981696444, 4.27821652754534, 4.006813981293457, 5.182792859380319, 2.4309680999959924, 1.621705662132354, 8.684880426422103], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.959027112819717, "mean_inference_ms": 7.987926769785453, "mean_action_processing_ms": 0.5365873630190978, "mean_env_wait_ms": 23.77691729881849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03246140480041504, "StateBufferConnector_ms": 0.03676891326904297, "ViewRequirementAgentConnector_ms": 0.9886980056762695}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5881974, "num_agent_steps_trained": 5881974, "num_env_steps_sampled": 5881974, "num_env_steps_trained": 5881974, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.84293215895116, "num_env_steps_trained_throughput_per_sec": 285.84293215895116, "timesteps_total": 5881974, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5881974, "timers": {"training_iteration_time_ms": 54882.667, "sample_time_ms": 41663.298, "load_time_ms": 1845.286, "load_throughput": 8474.565, "learn_time_ms": 10798.338, "learn_throughput": 1448.186, "synch_weights_time_ms": 457.728}, "counters": {"num_env_steps_sampled": 5881974, "num_env_steps_trained": 5881974, "num_agent_steps_sampled": 5881974, "num_agent_steps_trained": 5881974}, "done": false, "episodes_total": 462, "training_iteration": 381, "trial_id": "2f030_00000", "date": "2025-06-07_08-07-26", "timestamp": 1749276446, "time_this_iter_s": 54.720345973968506, "time_total_s": 1864.2917087078094, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1864.2917087078094, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 76.90634920634919, "ram_util_percent": 65.31746031746034, "gpu_util_percent0": 0.07809523809523809, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.256472580645162e-05, "total_loss": -0.12138563915579156, "policy_loss": -0.030303220279271376, "vf_loss": 0.01677792751568962, "vf_explained_var": 0.6925973984328183, "kl": 0.019285543922840778, "entropy": 20.89717867937955, "entropy_coeff": 0.005256472580645161}, "model": {}, "num_grad_updates_lifetime": 18425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5897612, "num_env_steps_trained": 5897612, "num_agent_steps_sampled": 5897612, "num_agent_steps_trained": 5897612}, "sampler_results": {"episode_reward_max": 9.39706791440718, "episode_reward_min": -1.2492496329901968, "episode_reward_mean": 5.1248271584679275, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.01284370850279, 4.221617650971625, 5.575598224884379, 7.548730911686539, -0.4934651218146746, 5.589173013519815, 5.229347312094933, 5.5687987650885225, 3.2186370881892055, 6.466942943484538, 7.160838473032978, 4.421999161385246, 6.249703163336673, 3.8632344908935465, 6.9743277887601645, 0.2494726712356648, 8.909756910604026, 6.442066482420908, 5.923848806083653, 7.867757013210781, 7.4318586979875265, 6.582111568442942, 9.193895441534691, 7.217600368305265, 6.691111163874288, 4.813168246560915, 3.1285296890401932, 1.2930658793449916, 2.6060637627599617, 2.666243995996886, 6.54601099738856, 7.036964311226677, 6.972018771110697, 5.139062726641509, 2.1621400686824455, 0.3782381511831131, 5.418317607062198, 0.5126014643983892, 4.301296787590288, 5.1975601466137284, 7.0554098712569635, 4.09824995595908, 4.095889612626187, 6.830276544160681, 3.1484442945458033, 6.796295589142853, 5.691173663903955, 5.796165310470863, 9.39706791440718, 5.878722335582554, 5.547895583522349, 6.8380723810370885, 7.098568983681901, 5.023241960082483, 5.734898524345171, 7.362426373105276, 5.597653692675246, 2.2415920088508345, 9.215273742859395, 6.350933255656576, 2.492417990997376, 2.611150254995543, 6.57095884534993, 5.61639927945532, 6.811242483284282, 0.6752690437797458, 4.404904015056502, 5.991649393314989, 0.19194166246238875, 5.215421284045687, 0.5712538260715339, 5.324495726438961, 8.118889217652113, 8.65350369879165, 7.517578005960269, 4.989338238614186, 1.107134184900857, 5.591886400623367, 6.551494130260887, 4.5897649981696444, 4.27821652754534, 4.006813981293457, 5.182792859380319, 2.4309680999959924, 1.621705662132354, 8.684880426422103, 8.04441935199064, 2.926528140934248, 7.281474901640272, 2.088900360896689, 4.4534652461560835, 3.6039762647417395, 4.813132070922558, 7.316911013013455, 6.976924857246672, 7.373988629953904, 5.591185338915789, -1.2492496329901968, 4.503947079034146, 6.8677010861529455], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9570676445035313, "mean_inference_ms": 7.990826125687083, "mean_action_processing_ms": 0.536656626661228, "mean_env_wait_ms": 23.78216852632644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037207841873168945, "StateBufferConnector_ms": 0.03159379959106445, "ViewRequirementAgentConnector_ms": 1.0066423416137695}}, "episode_reward_max": 9.39706791440718, "episode_reward_min": -1.2492496329901968, "episode_reward_mean": 5.1248271584679275, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.01284370850279, 4.221617650971625, 5.575598224884379, 7.548730911686539, -0.4934651218146746, 5.589173013519815, 5.229347312094933, 5.5687987650885225, 3.2186370881892055, 6.466942943484538, 7.160838473032978, 4.421999161385246, 6.249703163336673, 3.8632344908935465, 6.9743277887601645, 0.2494726712356648, 8.909756910604026, 6.442066482420908, 5.923848806083653, 7.867757013210781, 7.4318586979875265, 6.582111568442942, 9.193895441534691, 7.217600368305265, 6.691111163874288, 4.813168246560915, 3.1285296890401932, 1.2930658793449916, 2.6060637627599617, 2.666243995996886, 6.54601099738856, 7.036964311226677, 6.972018771110697, 5.139062726641509, 2.1621400686824455, 0.3782381511831131, 5.418317607062198, 0.5126014643983892, 4.301296787590288, 5.1975601466137284, 7.0554098712569635, 4.09824995595908, 4.095889612626187, 6.830276544160681, 3.1484442945458033, 6.796295589142853, 5.691173663903955, 5.796165310470863, 9.39706791440718, 5.878722335582554, 5.547895583522349, 6.8380723810370885, 7.098568983681901, 5.023241960082483, 5.734898524345171, 7.362426373105276, 5.597653692675246, 2.2415920088508345, 9.215273742859395, 6.350933255656576, 2.492417990997376, 2.611150254995543, 6.57095884534993, 5.61639927945532, 6.811242483284282, 0.6752690437797458, 4.404904015056502, 5.991649393314989, 0.19194166246238875, 5.215421284045687, 0.5712538260715339, 5.324495726438961, 8.118889217652113, 8.65350369879165, 7.517578005960269, 4.989338238614186, 1.107134184900857, 5.591886400623367, 6.551494130260887, 4.5897649981696444, 4.27821652754534, 4.006813981293457, 5.182792859380319, 2.4309680999959924, 1.621705662132354, 8.684880426422103, 8.04441935199064, 2.926528140934248, 7.281474901640272, 2.088900360896689, 4.4534652461560835, 3.6039762647417395, 4.813132070922558, 7.316911013013455, 6.976924857246672, 7.373988629953904, 5.591185338915789, -1.2492496329901968, 4.503947079034146, 6.8677010861529455], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9570676445035313, "mean_inference_ms": 7.990826125687083, "mean_action_processing_ms": 0.536656626661228, "mean_env_wait_ms": 23.78216852632644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037207841873168945, "StateBufferConnector_ms": 0.03159379959106445, "ViewRequirementAgentConnector_ms": 1.0066423416137695}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5897612, "num_agent_steps_trained": 5897612, "num_env_steps_sampled": 5897612, "num_env_steps_trained": 5897612, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.1786162944216, "num_env_steps_trained_throughput_per_sec": 286.1786162944216, "timesteps_total": 5897612, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5897612, "timers": {"training_iteration_time_ms": 54824.473, "sample_time_ms": 41713.053, "load_time_ms": 1803.23, "load_throughput": 8672.217, "learn_time_ms": 10730.693, "learn_throughput": 1457.315, "synch_weights_time_ms": 458.717}, "counters": {"num_env_steps_sampled": 5897612, "num_env_steps_trained": 5897612, "num_agent_steps_sampled": 5897612, "num_agent_steps_trained": 5897612}, "done": false, "episodes_total": 476, "training_iteration": 382, "trial_id": "2f030_00000", "date": "2025-06-07_08-08-21", "timestamp": 1749276501, "time_this_iter_s": 54.66010046005249, "time_total_s": 1918.951809167862, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1918.951809167862, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 77.57903225806453, "ram_util_percent": 65.30806451612901, "gpu_util_percent0": 0.07403225806451613, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.24386129032258e-05, "total_loss": -0.09910321897488426, "policy_loss": -0.008096208858425432, "vf_loss": 0.014730878513814374, "vf_explained_var": 0.696943664225665, "kl": 0.01941519503219036, "entropy": 20.833546069752085, "entropy_coeff": 0.005243861290322581}, "model": {}, "num_grad_updates_lifetime": 18975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5913250, "num_env_steps_trained": 5913250, "num_agent_steps_sampled": 5913250, "num_agent_steps_trained": 5913250}, "sampler_results": {"episode_reward_max": 9.39706791440718, "episode_reward_min": -1.2492496329901968, "episode_reward_mean": 5.22508089487654, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.9743277887601645, 0.2494726712356648, 8.909756910604026, 6.442066482420908, 5.923848806083653, 7.867757013210781, 7.4318586979875265, 6.582111568442942, 9.193895441534691, 7.217600368305265, 6.691111163874288, 4.813168246560915, 3.1285296890401932, 1.2930658793449916, 2.6060637627599617, 2.666243995996886, 6.54601099738856, 7.036964311226677, 6.972018771110697, 5.139062726641509, 2.1621400686824455, 0.3782381511831131, 5.418317607062198, 0.5126014643983892, 4.301296787590288, 5.1975601466137284, 7.0554098712569635, 4.09824995595908, 4.095889612626187, 6.830276544160681, 3.1484442945458033, 6.796295589142853, 5.691173663903955, 5.796165310470863, 9.39706791440718, 5.878722335582554, 5.547895583522349, 6.8380723810370885, 7.098568983681901, 5.023241960082483, 5.734898524345171, 7.362426373105276, 5.597653692675246, 2.2415920088508345, 9.215273742859395, 6.350933255656576, 2.492417990997376, 2.611150254995543, 6.57095884534993, 5.61639927945532, 6.811242483284282, 0.6752690437797458, 4.404904015056502, 5.991649393314989, 0.19194166246238875, 5.215421284045687, 0.5712538260715339, 5.324495726438961, 8.118889217652113, 8.65350369879165, 7.517578005960269, 4.989338238614186, 1.107134184900857, 5.591886400623367, 6.551494130260887, 4.5897649981696444, 4.27821652754534, 4.006813981293457, 5.182792859380319, 2.4309680999959924, 1.621705662132354, 8.684880426422103, 8.04441935199064, 2.926528140934248, 7.281474901640272, 2.088900360896689, 4.4534652461560835, 3.6039762647417395, 4.813132070922558, 7.316911013013455, 6.976924857246672, 7.373988629953904, 5.591185338915789, -1.2492496329901968, 4.503947079034146, 6.8677010861529455, 8.463194429869267, 8.81518715920643, 6.984735597367901, 7.078923173014812, 5.097432484450295, 5.515364169270324, 0.8664661118660788, 6.514133235261774, 4.084729912247503, 3.1463535865165873, 2.622968842003083, 6.2854782733889865, 7.236875267330461, 7.947531184323837], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.954168033381147, "mean_inference_ms": 7.993579115479271, "mean_action_processing_ms": 0.5367109057158913, "mean_env_wait_ms": 23.787891195252975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0291135311126709, "StateBufferConnector_ms": 0.030057191848754883, "ViewRequirementAgentConnector_ms": 1.0177361965179443}}, "episode_reward_max": 9.39706791440718, "episode_reward_min": -1.2492496329901968, "episode_reward_mean": 5.22508089487654, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.9743277887601645, 0.2494726712356648, 8.909756910604026, 6.442066482420908, 5.923848806083653, 7.867757013210781, 7.4318586979875265, 6.582111568442942, 9.193895441534691, 7.217600368305265, 6.691111163874288, 4.813168246560915, 3.1285296890401932, 1.2930658793449916, 2.6060637627599617, 2.666243995996886, 6.54601099738856, 7.036964311226677, 6.972018771110697, 5.139062726641509, 2.1621400686824455, 0.3782381511831131, 5.418317607062198, 0.5126014643983892, 4.301296787590288, 5.1975601466137284, 7.0554098712569635, 4.09824995595908, 4.095889612626187, 6.830276544160681, 3.1484442945458033, 6.796295589142853, 5.691173663903955, 5.796165310470863, 9.39706791440718, 5.878722335582554, 5.547895583522349, 6.8380723810370885, 7.098568983681901, 5.023241960082483, 5.734898524345171, 7.362426373105276, 5.597653692675246, 2.2415920088508345, 9.215273742859395, 6.350933255656576, 2.492417990997376, 2.611150254995543, 6.57095884534993, 5.61639927945532, 6.811242483284282, 0.6752690437797458, 4.404904015056502, 5.991649393314989, 0.19194166246238875, 5.215421284045687, 0.5712538260715339, 5.324495726438961, 8.118889217652113, 8.65350369879165, 7.517578005960269, 4.989338238614186, 1.107134184900857, 5.591886400623367, 6.551494130260887, 4.5897649981696444, 4.27821652754534, 4.006813981293457, 5.182792859380319, 2.4309680999959924, 1.621705662132354, 8.684880426422103, 8.04441935199064, 2.926528140934248, 7.281474901640272, 2.088900360896689, 4.4534652461560835, 3.6039762647417395, 4.813132070922558, 7.316911013013455, 6.976924857246672, 7.373988629953904, 5.591185338915789, -1.2492496329901968, 4.503947079034146, 6.8677010861529455, 8.463194429869267, 8.81518715920643, 6.984735597367901, 7.078923173014812, 5.097432484450295, 5.515364169270324, 0.8664661118660788, 6.514133235261774, 4.084729912247503, 3.1463535865165873, 2.622968842003083, 6.2854782733889865, 7.236875267330461, 7.947531184323837], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.954168033381147, "mean_inference_ms": 7.993579115479271, "mean_action_processing_ms": 0.5367109057158913, "mean_env_wait_ms": 23.787891195252975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0291135311126709, "StateBufferConnector_ms": 0.030057191848754883, "ViewRequirementAgentConnector_ms": 1.0177361965179443}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5913250, "num_agent_steps_trained": 5913250, "num_env_steps_sampled": 5913250, "num_env_steps_trained": 5913250, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 287.7646250777713, "num_env_steps_trained_throughput_per_sec": 287.7646250777713, "timesteps_total": 5913250, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5913250, "timers": {"training_iteration_time_ms": 54683.152, "sample_time_ms": 41615.334, "load_time_ms": 1776.633, "load_throughput": 8802.041, "learn_time_ms": 10710.696, "learn_throughput": 1460.036, "synch_weights_time_ms": 461.333}, "counters": {"num_env_steps_sampled": 5913250, "num_env_steps_trained": 5913250, "num_agent_steps_sampled": 5913250, "num_agent_steps_trained": 5913250}, "done": false, "episodes_total": 490, "training_iteration": 383, "trial_id": "2f030_00000", "date": "2025-06-07_08-09-15", "timestamp": 1749276555, "time_this_iter_s": 54.35687780380249, "time_total_s": 1973.3086869716644, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1973.3086869716644, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 77.2126984126984, "ram_util_percent": 65.36984126984127, "gpu_util_percent0": 0.08634920634920634, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.2312500000000004e-05, "total_loss": -0.11050839908971366, "policy_loss": -0.01956314631452022, "vf_loss": 0.015799091267822817, "vf_explained_var": 0.7041592647812583, "kl": 0.019118946062906407, "entropy": 20.892908124056728, "entropy_coeff": 0.00523125}, "model": {}, "num_grad_updates_lifetime": 19525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5928888, "num_env_steps_trained": 5928888, "num_agent_steps_sampled": 5928888, "num_agent_steps_trained": 5928888}, "sampler_results": {"episode_reward_max": 9.750052023907376, "episode_reward_min": -1.2492496329901968, "episode_reward_mean": 5.101317155822164, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.6060637627599617, 2.666243995996886, 6.54601099738856, 7.036964311226677, 6.972018771110697, 5.139062726641509, 2.1621400686824455, 0.3782381511831131, 5.418317607062198, 0.5126014643983892, 4.301296787590288, 5.1975601466137284, 7.0554098712569635, 4.09824995595908, 4.095889612626187, 6.830276544160681, 3.1484442945458033, 6.796295589142853, 5.691173663903955, 5.796165310470863, 9.39706791440718, 5.878722335582554, 5.547895583522349, 6.8380723810370885, 7.098568983681901, 5.023241960082483, 5.734898524345171, 7.362426373105276, 5.597653692675246, 2.2415920088508345, 9.215273742859395, 6.350933255656576, 2.492417990997376, 2.611150254995543, 6.57095884534993, 5.61639927945532, 6.811242483284282, 0.6752690437797458, 4.404904015056502, 5.991649393314989, 0.19194166246238875, 5.215421284045687, 0.5712538260715339, 5.324495726438961, 8.118889217652113, 8.65350369879165, 7.517578005960269, 4.989338238614186, 1.107134184900857, 5.591886400623367, 6.551494130260887, 4.5897649981696444, 4.27821652754534, 4.006813981293457, 5.182792859380319, 2.4309680999959924, 1.621705662132354, 8.684880426422103, 8.04441935199064, 2.926528140934248, 7.281474901640272, 2.088900360896689, 4.4534652461560835, 3.6039762647417395, 4.813132070922558, 7.316911013013455, 6.976924857246672, 7.373988629953904, 5.591185338915789, -1.2492496329901968, 4.503947079034146, 6.8677010861529455, 8.463194429869267, 8.81518715920643, 6.984735597367901, 7.078923173014812, 5.097432484450295, 5.515364169270324, 0.8664661118660788, 6.514133235261774, 4.084729912247503, 3.1463535865165873, 2.622968842003083, 6.2854782733889865, 7.236875267330461, 7.947531184323837, 7.4548189668081335, 3.7539920838527334, 6.635122563728912, 4.7432599506330515, 7.041250668113663, 3.9001902526712695, 2.08168564499069, 2.4738400871318573, 5.354458847438491, 7.895064250829957, 9.750052023907376, 0.6550575806923247, 4.8106870053674795, 3.792716895802502], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9518159900806586, "mean_inference_ms": 7.9961816575205855, "mean_action_processing_ms": 0.536773848532012, "mean_env_wait_ms": 23.79231666031299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03346824645996094, "StateBufferConnector_ms": 0.029061079025268555, "ViewRequirementAgentConnector_ms": 0.9832901954650879}}, "episode_reward_max": 9.750052023907376, "episode_reward_min": -1.2492496329901968, "episode_reward_mean": 5.101317155822164, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.6060637627599617, 2.666243995996886, 6.54601099738856, 7.036964311226677, 6.972018771110697, 5.139062726641509, 2.1621400686824455, 0.3782381511831131, 5.418317607062198, 0.5126014643983892, 4.301296787590288, 5.1975601466137284, 7.0554098712569635, 4.09824995595908, 4.095889612626187, 6.830276544160681, 3.1484442945458033, 6.796295589142853, 5.691173663903955, 5.796165310470863, 9.39706791440718, 5.878722335582554, 5.547895583522349, 6.8380723810370885, 7.098568983681901, 5.023241960082483, 5.734898524345171, 7.362426373105276, 5.597653692675246, 2.2415920088508345, 9.215273742859395, 6.350933255656576, 2.492417990997376, 2.611150254995543, 6.57095884534993, 5.61639927945532, 6.811242483284282, 0.6752690437797458, 4.404904015056502, 5.991649393314989, 0.19194166246238875, 5.215421284045687, 0.5712538260715339, 5.324495726438961, 8.118889217652113, 8.65350369879165, 7.517578005960269, 4.989338238614186, 1.107134184900857, 5.591886400623367, 6.551494130260887, 4.5897649981696444, 4.27821652754534, 4.006813981293457, 5.182792859380319, 2.4309680999959924, 1.621705662132354, 8.684880426422103, 8.04441935199064, 2.926528140934248, 7.281474901640272, 2.088900360896689, 4.4534652461560835, 3.6039762647417395, 4.813132070922558, 7.316911013013455, 6.976924857246672, 7.373988629953904, 5.591185338915789, -1.2492496329901968, 4.503947079034146, 6.8677010861529455, 8.463194429869267, 8.81518715920643, 6.984735597367901, 7.078923173014812, 5.097432484450295, 5.515364169270324, 0.8664661118660788, 6.514133235261774, 4.084729912247503, 3.1463535865165873, 2.622968842003083, 6.2854782733889865, 7.236875267330461, 7.947531184323837, 7.4548189668081335, 3.7539920838527334, 6.635122563728912, 4.7432599506330515, 7.041250668113663, 3.9001902526712695, 2.08168564499069, 2.4738400871318573, 5.354458847438491, 7.895064250829957, 9.750052023907376, 0.6550575806923247, 4.8106870053674795, 3.792716895802502], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9518159900806586, "mean_inference_ms": 7.9961816575205855, "mean_action_processing_ms": 0.536773848532012, "mean_env_wait_ms": 23.79231666031299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03346824645996094, "StateBufferConnector_ms": 0.029061079025268555, "ViewRequirementAgentConnector_ms": 0.9832901954650879}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5928888, "num_agent_steps_trained": 5928888, "num_env_steps_sampled": 5928888, "num_env_steps_trained": 5928888, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 289.73549133994453, "num_env_steps_trained_throughput_per_sec": 289.73549133994453, "timesteps_total": 5928888, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5928888, "timers": {"training_iteration_time_ms": 54566.784, "sample_time_ms": 41510.59, "load_time_ms": 1760.557, "load_throughput": 8882.417, "learn_time_ms": 10718.239, "learn_throughput": 1459.008, "synch_weights_time_ms": 460.985}, "counters": {"num_env_steps_sampled": 5928888, "num_env_steps_trained": 5928888, "num_agent_steps_sampled": 5928888, "num_agent_steps_trained": 5928888}, "done": false, "episodes_total": 504, "training_iteration": 384, "trial_id": "2f030_00000", "date": "2025-06-07_08-10-09", "timestamp": 1749276609, "time_this_iter_s": 53.989439249038696, "time_total_s": 2027.2981262207031, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2027.2981262207031, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 77.66721311475409, "ram_util_percent": 65.49180327868851, "gpu_util_percent0": 0.07573770491803279, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.2186387096774195e-05, "total_loss": -0.11297430706718428, "policy_loss": -0.022370578293603928, "vf_loss": 0.01563458254391497, "vf_explained_var": 0.7084982906688343, "kl": 0.019296106723056504, "entropy": 20.892666263580324, "entropy_coeff": 0.0052186387096774195}, "model": {}, "num_grad_updates_lifetime": 20075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5944526, "num_env_steps_trained": 5944526, "num_agent_steps_sampled": 5944526, "num_agent_steps_trained": 5944526}, "sampler_results": {"episode_reward_max": 9.750052023907376, "episode_reward_min": -1.2492496329901968, "episode_reward_mean": 5.282965787472392, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.095889612626187, 6.830276544160681, 3.1484442945458033, 6.796295589142853, 5.691173663903955, 5.796165310470863, 9.39706791440718, 5.878722335582554, 5.547895583522349, 6.8380723810370885, 7.098568983681901, 5.023241960082483, 5.734898524345171, 7.362426373105276, 5.597653692675246, 2.2415920088508345, 9.215273742859395, 6.350933255656576, 2.492417990997376, 2.611150254995543, 6.57095884534993, 5.61639927945532, 6.811242483284282, 0.6752690437797458, 4.404904015056502, 5.991649393314989, 0.19194166246238875, 5.215421284045687, 0.5712538260715339, 5.324495726438961, 8.118889217652113, 8.65350369879165, 7.517578005960269, 4.989338238614186, 1.107134184900857, 5.591886400623367, 6.551494130260887, 4.5897649981696444, 4.27821652754534, 4.006813981293457, 5.182792859380319, 2.4309680999959924, 1.621705662132354, 8.684880426422103, 8.04441935199064, 2.926528140934248, 7.281474901640272, 2.088900360896689, 4.4534652461560835, 3.6039762647417395, 4.813132070922558, 7.316911013013455, 6.976924857246672, 7.373988629953904, 5.591185338915789, -1.2492496329901968, 4.503947079034146, 6.8677010861529455, 8.463194429869267, 8.81518715920643, 6.984735597367901, 7.078923173014812, 5.097432484450295, 5.515364169270324, 0.8664661118660788, 6.514133235261774, 4.084729912247503, 3.1463535865165873, 2.622968842003083, 6.2854782733889865, 7.236875267330461, 7.947531184323837, 7.4548189668081335, 3.7539920838527334, 6.635122563728912, 4.7432599506330515, 7.041250668113663, 3.9001902526712695, 2.08168564499069, 2.4738400871318573, 5.354458847438491, 7.895064250829957, 9.750052023907376, 0.6550575806923247, 4.8106870053674795, 3.792716895802502, 9.415335119233132, 2.475094551530634, 5.26795716369581, 3.828149737566215, 5.605712611084498, 7.461800590905854, 5.770261144399681, 8.34334144514186, 5.326850671979887, 0.46346168930440496, 4.831316575817543, 6.324967456521724, 6.313828319708511, 6.82696470600351], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.949351513795078, "mean_inference_ms": 7.998604268867584, "mean_action_processing_ms": 0.5368882915299499, "mean_env_wait_ms": 23.79646664106406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03591728210449219, "StateBufferConnector_ms": 0.031967878341674805, "ViewRequirementAgentConnector_ms": 0.9800441265106201}}, "episode_reward_max": 9.750052023907376, "episode_reward_min": -1.2492496329901968, "episode_reward_mean": 5.282965787472392, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.095889612626187, 6.830276544160681, 3.1484442945458033, 6.796295589142853, 5.691173663903955, 5.796165310470863, 9.39706791440718, 5.878722335582554, 5.547895583522349, 6.8380723810370885, 7.098568983681901, 5.023241960082483, 5.734898524345171, 7.362426373105276, 5.597653692675246, 2.2415920088508345, 9.215273742859395, 6.350933255656576, 2.492417990997376, 2.611150254995543, 6.57095884534993, 5.61639927945532, 6.811242483284282, 0.6752690437797458, 4.404904015056502, 5.991649393314989, 0.19194166246238875, 5.215421284045687, 0.5712538260715339, 5.324495726438961, 8.118889217652113, 8.65350369879165, 7.517578005960269, 4.989338238614186, 1.107134184900857, 5.591886400623367, 6.551494130260887, 4.5897649981696444, 4.27821652754534, 4.006813981293457, 5.182792859380319, 2.4309680999959924, 1.621705662132354, 8.684880426422103, 8.04441935199064, 2.926528140934248, 7.281474901640272, 2.088900360896689, 4.4534652461560835, 3.6039762647417395, 4.813132070922558, 7.316911013013455, 6.976924857246672, 7.373988629953904, 5.591185338915789, -1.2492496329901968, 4.503947079034146, 6.8677010861529455, 8.463194429869267, 8.81518715920643, 6.984735597367901, 7.078923173014812, 5.097432484450295, 5.515364169270324, 0.8664661118660788, 6.514133235261774, 4.084729912247503, 3.1463535865165873, 2.622968842003083, 6.2854782733889865, 7.236875267330461, 7.947531184323837, 7.4548189668081335, 3.7539920838527334, 6.635122563728912, 4.7432599506330515, 7.041250668113663, 3.9001902526712695, 2.08168564499069, 2.4738400871318573, 5.354458847438491, 7.895064250829957, 9.750052023907376, 0.6550575806923247, 4.8106870053674795, 3.792716895802502, 9.415335119233132, 2.475094551530634, 5.26795716369581, 3.828149737566215, 5.605712611084498, 7.461800590905854, 5.770261144399681, 8.34334144514186, 5.326850671979887, 0.46346168930440496, 4.831316575817543, 6.324967456521724, 6.313828319708511, 6.82696470600351], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.949351513795078, "mean_inference_ms": 7.998604268867584, "mean_action_processing_ms": 0.5368882915299499, "mean_env_wait_ms": 23.79646664106406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03591728210449219, "StateBufferConnector_ms": 0.031967878341674805, "ViewRequirementAgentConnector_ms": 0.9800441265106201}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5944526, "num_agent_steps_trained": 5944526, "num_env_steps_sampled": 5944526, "num_env_steps_trained": 5944526, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 289.233642262137, "num_env_steps_trained_throughput_per_sec": 289.233642262137, "timesteps_total": 5944526, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5944526, "timers": {"training_iteration_time_ms": 54557.372, "sample_time_ms": 41515.362, "load_time_ms": 1746.743, "load_throughput": 8952.661, "learn_time_ms": 10712.264, "learn_throughput": 1459.822, "synch_weights_time_ms": 465.76}, "counters": {"num_env_steps_sampled": 5944526, "num_env_steps_trained": 5944526, "num_agent_steps_sampled": 5944526, "num_agent_steps_trained": 5944526}, "done": false, "episodes_total": 518, "training_iteration": 385, "trial_id": "2f030_00000", "date": "2025-06-07_08-11-03", "timestamp": 1749276663, "time_this_iter_s": 54.08278226852417, "time_total_s": 2081.3809084892273, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2081.3809084892273, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 76.82741935483872, "ram_util_percent": 65.75806451612904, "gpu_util_percent0": 0.07790322580645162, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.206027419354839e-05, "total_loss": -0.13053879551081496, "policy_loss": -0.039568612587172536, "vf_loss": 0.015209699855609373, "vf_explained_var": 0.7176566316864708, "kl": 0.01862142327973893, "entropy": 20.896920923753218, "entropy_coeff": 0.005206027419354838}, "model": {}, "num_grad_updates_lifetime": 20625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5960164, "num_env_steps_trained": 5960164, "num_agent_steps_sampled": 5960164, "num_agent_steps_trained": 5960164}, "sampler_results": {"episode_reward_max": 11.329953207556171, "episode_reward_min": -1.2492496329901968, "episode_reward_mean": 5.218662495866958, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.597653692675246, 2.2415920088508345, 9.215273742859395, 6.350933255656576, 2.492417990997376, 2.611150254995543, 6.57095884534993, 5.61639927945532, 6.811242483284282, 0.6752690437797458, 4.404904015056502, 5.991649393314989, 0.19194166246238875, 5.215421284045687, 0.5712538260715339, 5.324495726438961, 8.118889217652113, 8.65350369879165, 7.517578005960269, 4.989338238614186, 1.107134184900857, 5.591886400623367, 6.551494130260887, 4.5897649981696444, 4.27821652754534, 4.006813981293457, 5.182792859380319, 2.4309680999959924, 1.621705662132354, 8.684880426422103, 8.04441935199064, 2.926528140934248, 7.281474901640272, 2.088900360896689, 4.4534652461560835, 3.6039762647417395, 4.813132070922558, 7.316911013013455, 6.976924857246672, 7.373988629953904, 5.591185338915789, -1.2492496329901968, 4.503947079034146, 6.8677010861529455, 8.463194429869267, 8.81518715920643, 6.984735597367901, 7.078923173014812, 5.097432484450295, 5.515364169270324, 0.8664661118660788, 6.514133235261774, 4.084729912247503, 3.1463535865165873, 2.622968842003083, 6.2854782733889865, 7.236875267330461, 7.947531184323837, 7.4548189668081335, 3.7539920838527334, 6.635122563728912, 4.7432599506330515, 7.041250668113663, 3.9001902526712695, 2.08168564499069, 2.4738400871318573, 5.354458847438491, 7.895064250829957, 9.750052023907376, 0.6550575806923247, 4.8106870053674795, 3.792716895802502, 9.415335119233132, 2.475094551530634, 5.26795716369581, 3.828149737566215, 5.605712611084498, 7.461800590905854, 5.770261144399681, 8.34334144514186, 5.326850671979887, 0.46346168930440496, 4.831316575817543, 6.324967456521724, 6.313828319708511, 6.82696470600351, 6.374372404253558, 2.872154167982792, 11.329953207556171, 2.639330919376112, 4.407976590610122, 4.066858442837578, 5.5257238337926236, 2.3726732545193525, 6.170821213272903, 9.949517956853306, 7.621078170269017, 5.388453243953169, 5.457974756698009, 4.631921748096315], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9472542098486993, "mean_inference_ms": 8.000644755064746, "mean_action_processing_ms": 0.5369923474678396, "mean_env_wait_ms": 23.801733320581544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03527426719665527, "StateBufferConnector_ms": 0.03389716148376465, "ViewRequirementAgentConnector_ms": 0.9948749542236328}}, "episode_reward_max": 11.329953207556171, "episode_reward_min": -1.2492496329901968, "episode_reward_mean": 5.218662495866958, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.597653692675246, 2.2415920088508345, 9.215273742859395, 6.350933255656576, 2.492417990997376, 2.611150254995543, 6.57095884534993, 5.61639927945532, 6.811242483284282, 0.6752690437797458, 4.404904015056502, 5.991649393314989, 0.19194166246238875, 5.215421284045687, 0.5712538260715339, 5.324495726438961, 8.118889217652113, 8.65350369879165, 7.517578005960269, 4.989338238614186, 1.107134184900857, 5.591886400623367, 6.551494130260887, 4.5897649981696444, 4.27821652754534, 4.006813981293457, 5.182792859380319, 2.4309680999959924, 1.621705662132354, 8.684880426422103, 8.04441935199064, 2.926528140934248, 7.281474901640272, 2.088900360896689, 4.4534652461560835, 3.6039762647417395, 4.813132070922558, 7.316911013013455, 6.976924857246672, 7.373988629953904, 5.591185338915789, -1.2492496329901968, 4.503947079034146, 6.8677010861529455, 8.463194429869267, 8.81518715920643, 6.984735597367901, 7.078923173014812, 5.097432484450295, 5.515364169270324, 0.8664661118660788, 6.514133235261774, 4.084729912247503, 3.1463535865165873, 2.622968842003083, 6.2854782733889865, 7.236875267330461, 7.947531184323837, 7.4548189668081335, 3.7539920838527334, 6.635122563728912, 4.7432599506330515, 7.041250668113663, 3.9001902526712695, 2.08168564499069, 2.4738400871318573, 5.354458847438491, 7.895064250829957, 9.750052023907376, 0.6550575806923247, 4.8106870053674795, 3.792716895802502, 9.415335119233132, 2.475094551530634, 5.26795716369581, 3.828149737566215, 5.605712611084498, 7.461800590905854, 5.770261144399681, 8.34334144514186, 5.326850671979887, 0.46346168930440496, 4.831316575817543, 6.324967456521724, 6.313828319708511, 6.82696470600351, 6.374372404253558, 2.872154167982792, 11.329953207556171, 2.639330919376112, 4.407976590610122, 4.066858442837578, 5.5257238337926236, 2.3726732545193525, 6.170821213272903, 9.949517956853306, 7.621078170269017, 5.388453243953169, 5.457974756698009, 4.631921748096315], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9472542098486993, "mean_inference_ms": 8.000644755064746, "mean_action_processing_ms": 0.5369923474678396, "mean_env_wait_ms": 23.801733320581544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03527426719665527, "StateBufferConnector_ms": 0.03389716148376465, "ViewRequirementAgentConnector_ms": 0.9948749542236328}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5960164, "num_agent_steps_trained": 5960164, "num_env_steps_sampled": 5960164, "num_env_steps_trained": 5960164, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.70862687215697, "num_env_steps_trained_throughput_per_sec": 283.70862687215697, "timesteps_total": 5960164, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5960164, "timers": {"training_iteration_time_ms": 54627.195, "sample_time_ms": 41578.996, "load_time_ms": 1746.689, "load_throughput": 8952.937, "learn_time_ms": 10721.354, "learn_throughput": 1458.584, "synch_weights_time_ms": 462.639}, "counters": {"num_env_steps_sampled": 5960164, "num_env_steps_trained": 5960164, "num_agent_steps_sampled": 5960164, "num_agent_steps_trained": 5960164}, "done": false, "episodes_total": 532, "training_iteration": 386, "trial_id": "2f030_00000", "date": "2025-06-07_08-11-58", "timestamp": 1749276718, "time_this_iter_s": 55.133450508117676, "time_total_s": 2136.514358997345, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2136.514358997345, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 78.7031746031746, "ram_util_percent": 65.42063492063494, "gpu_util_percent0": 0.07793650793650793, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.193416129032258e-05, "total_loss": -0.1069265013742684, "policy_loss": -0.016678505536930805, "vf_loss": 0.014740270793607289, "vf_explained_var": 0.7308844487233596, "kl": 0.0191810412691451, "entropy": 20.858203636516226, "entropy_coeff": 0.005193416129032256}, "model": {}, "num_grad_updates_lifetime": 21175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5975802, "num_env_steps_trained": 5975802, "num_agent_steps_sampled": 5975802, "num_agent_steps_trained": 5975802}, "sampler_results": {"episode_reward_max": 11.329953207556171, "episode_reward_min": -1.2492496329901968, "episode_reward_mean": 5.399802361855441, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5712538260715339, 5.324495726438961, 8.118889217652113, 8.65350369879165, 7.517578005960269, 4.989338238614186, 1.107134184900857, 5.591886400623367, 6.551494130260887, 4.5897649981696444, 4.27821652754534, 4.006813981293457, 5.182792859380319, 2.4309680999959924, 1.621705662132354, 8.684880426422103, 8.04441935199064, 2.926528140934248, 7.281474901640272, 2.088900360896689, 4.4534652461560835, 3.6039762647417395, 4.813132070922558, 7.316911013013455, 6.976924857246672, 7.373988629953904, 5.591185338915789, -1.2492496329901968, 4.503947079034146, 6.8677010861529455, 8.463194429869267, 8.81518715920643, 6.984735597367901, 7.078923173014812, 5.097432484450295, 5.515364169270324, 0.8664661118660788, 6.514133235261774, 4.084729912247503, 3.1463535865165873, 2.622968842003083, 6.2854782733889865, 7.236875267330461, 7.947531184323837, 7.4548189668081335, 3.7539920838527334, 6.635122563728912, 4.7432599506330515, 7.041250668113663, 3.9001902526712695, 2.08168564499069, 2.4738400871318573, 5.354458847438491, 7.895064250829957, 9.750052023907376, 0.6550575806923247, 4.8106870053674795, 3.792716895802502, 9.415335119233132, 2.475094551530634, 5.26795716369581, 3.828149737566215, 5.605712611084498, 7.461800590905854, 5.770261144399681, 8.34334144514186, 5.326850671979887, 0.46346168930440496, 4.831316575817543, 6.324967456521724, 6.313828319708511, 6.82696470600351, 6.374372404253558, 2.872154167982792, 11.329953207556171, 2.639330919376112, 4.407976590610122, 4.066858442837578, 5.5257238337926236, 2.3726732545193525, 6.170821213272903, 9.949517956853306, 7.621078170269017, 5.388453243953169, 5.457974756698009, 4.631921748096315, 6.473180926405409, 4.347156152894222, 8.054289570408264, 8.90037606696868, 5.990802527082399, 6.688602685389503, 6.625886898448774, 4.380940617680684, 2.0307060327221627, 7.960656424229217, 7.379160295955843, 2.606798288151147, 5.686972016875998, 4.975265048419655], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9448641380748524, "mean_inference_ms": 8.00191010245478, "mean_action_processing_ms": 0.537111670919871, "mean_env_wait_ms": 23.803080443871337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04138827323913574, "StateBufferConnector_ms": 0.03302359580993652, "ViewRequirementAgentConnector_ms": 0.9823043346405029}}, "episode_reward_max": 11.329953207556171, "episode_reward_min": -1.2492496329901968, "episode_reward_mean": 5.399802361855441, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5712538260715339, 5.324495726438961, 8.118889217652113, 8.65350369879165, 7.517578005960269, 4.989338238614186, 1.107134184900857, 5.591886400623367, 6.551494130260887, 4.5897649981696444, 4.27821652754534, 4.006813981293457, 5.182792859380319, 2.4309680999959924, 1.621705662132354, 8.684880426422103, 8.04441935199064, 2.926528140934248, 7.281474901640272, 2.088900360896689, 4.4534652461560835, 3.6039762647417395, 4.813132070922558, 7.316911013013455, 6.976924857246672, 7.373988629953904, 5.591185338915789, -1.2492496329901968, 4.503947079034146, 6.8677010861529455, 8.463194429869267, 8.81518715920643, 6.984735597367901, 7.078923173014812, 5.097432484450295, 5.515364169270324, 0.8664661118660788, 6.514133235261774, 4.084729912247503, 3.1463535865165873, 2.622968842003083, 6.2854782733889865, 7.236875267330461, 7.947531184323837, 7.4548189668081335, 3.7539920838527334, 6.635122563728912, 4.7432599506330515, 7.041250668113663, 3.9001902526712695, 2.08168564499069, 2.4738400871318573, 5.354458847438491, 7.895064250829957, 9.750052023907376, 0.6550575806923247, 4.8106870053674795, 3.792716895802502, 9.415335119233132, 2.475094551530634, 5.26795716369581, 3.828149737566215, 5.605712611084498, 7.461800590905854, 5.770261144399681, 8.34334144514186, 5.326850671979887, 0.46346168930440496, 4.831316575817543, 6.324967456521724, 6.313828319708511, 6.82696470600351, 6.374372404253558, 2.872154167982792, 11.329953207556171, 2.639330919376112, 4.407976590610122, 4.066858442837578, 5.5257238337926236, 2.3726732545193525, 6.170821213272903, 9.949517956853306, 7.621078170269017, 5.388453243953169, 5.457974756698009, 4.631921748096315, 6.473180926405409, 4.347156152894222, 8.054289570408264, 8.90037606696868, 5.990802527082399, 6.688602685389503, 6.625886898448774, 4.380940617680684, 2.0307060327221627, 7.960656424229217, 7.379160295955843, 2.606798288151147, 5.686972016875998, 4.975265048419655], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9448641380748524, "mean_inference_ms": 8.00191010245478, "mean_action_processing_ms": 0.537111670919871, "mean_env_wait_ms": 23.803080443871337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04138827323913574, "StateBufferConnector_ms": 0.03302359580993652, "ViewRequirementAgentConnector_ms": 0.9823043346405029}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5975802, "num_agent_steps_trained": 5975802, "num_env_steps_sampled": 5975802, "num_env_steps_trained": 5975802, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 287.52656822161475, "num_env_steps_trained_throughput_per_sec": 287.52656822161475, "timesteps_total": 5975802, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5975802, "timers": {"training_iteration_time_ms": 54615.141, "sample_time_ms": 41590.345, "load_time_ms": 1738.853, "load_throughput": 8993.286, "learn_time_ms": 10707.457, "learn_throughput": 1460.478, "synch_weights_time_ms": 459.519}, "counters": {"num_env_steps_sampled": 5975802, "num_env_steps_trained": 5975802, "num_agent_steps_sampled": 5975802, "num_agent_steps_trained": 5975802}, "done": false, "episodes_total": 546, "training_iteration": 387, "trial_id": "2f030_00000", "date": "2025-06-07_08-12-53", "timestamp": 1749276773, "time_this_iter_s": 54.404011487960815, "time_total_s": 2190.918370485306, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2190.918370485306, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 76.68888888888888, "ram_util_percent": 65.5269841269841, "gpu_util_percent0": 0.08015873015873014, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.1808048387096775e-05, "total_loss": -0.11404180727899074, "policy_loss": -0.024271190865653228, "vf_loss": 0.015235490296036006, "vf_explained_var": 0.7269706778092818, "kl": 0.018984890737807795, "entropy": 20.81855497013439, "entropy_coeff": 0.005180804838709676}, "model": {}, "num_grad_updates_lifetime": 21725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 5991440, "num_env_steps_trained": 5991440, "num_agent_steps_sampled": 5991440, "num_agent_steps_trained": 5991440}, "sampler_results": {"episode_reward_max": 11.329953207556171, "episode_reward_min": -1.2492496329901968, "episode_reward_mean": 5.5559614881829695, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.621705662132354, 8.684880426422103, 8.04441935199064, 2.926528140934248, 7.281474901640272, 2.088900360896689, 4.4534652461560835, 3.6039762647417395, 4.813132070922558, 7.316911013013455, 6.976924857246672, 7.373988629953904, 5.591185338915789, -1.2492496329901968, 4.503947079034146, 6.8677010861529455, 8.463194429869267, 8.81518715920643, 6.984735597367901, 7.078923173014812, 5.097432484450295, 5.515364169270324, 0.8664661118660788, 6.514133235261774, 4.084729912247503, 3.1463535865165873, 2.622968842003083, 6.2854782733889865, 7.236875267330461, 7.947531184323837, 7.4548189668081335, 3.7539920838527334, 6.635122563728912, 4.7432599506330515, 7.041250668113663, 3.9001902526712695, 2.08168564499069, 2.4738400871318573, 5.354458847438491, 7.895064250829957, 9.750052023907376, 0.6550575806923247, 4.8106870053674795, 3.792716895802502, 9.415335119233132, 2.475094551530634, 5.26795716369581, 3.828149737566215, 5.605712611084498, 7.461800590905854, 5.770261144399681, 8.34334144514186, 5.326850671979887, 0.46346168930440496, 4.831316575817543, 6.324967456521724, 6.313828319708511, 6.82696470600351, 6.374372404253558, 2.872154167982792, 11.329953207556171, 2.639330919376112, 4.407976590610122, 4.066858442837578, 5.5257238337926236, 2.3726732545193525, 6.170821213272903, 9.949517956853306, 7.621078170269017, 5.388453243953169, 5.457974756698009, 4.631921748096315, 6.473180926405409, 4.347156152894222, 8.054289570408264, 8.90037606696868, 5.990802527082399, 6.688602685389503, 6.625886898448774, 4.380940617680684, 2.0307060327221627, 7.960656424229217, 7.379160295955843, 2.606798288151147, 5.686972016875998, 4.975265048419655, 5.487910592075976, 7.6617467546616576, 5.392406965656914, 5.5726710691099886, 3.5743170601797107, 6.11445988729641, 3.2870532053497494, 5.414956354996522, 9.947937655245367, 3.6508437410445445, 7.298618908756739, 3.8185669692865054, 8.495201751167297, 8.813351613624011], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9416660126797094, "mean_inference_ms": 8.003104773163221, "mean_action_processing_ms": 0.5372510419707812, "mean_env_wait_ms": 23.804731056393248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04239463806152344, "StateBufferConnector_ms": 0.03604602813720703, "ViewRequirementAgentConnector_ms": 0.9779670238494873}}, "episode_reward_max": 11.329953207556171, "episode_reward_min": -1.2492496329901968, "episode_reward_mean": 5.5559614881829695, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.621705662132354, 8.684880426422103, 8.04441935199064, 2.926528140934248, 7.281474901640272, 2.088900360896689, 4.4534652461560835, 3.6039762647417395, 4.813132070922558, 7.316911013013455, 6.976924857246672, 7.373988629953904, 5.591185338915789, -1.2492496329901968, 4.503947079034146, 6.8677010861529455, 8.463194429869267, 8.81518715920643, 6.984735597367901, 7.078923173014812, 5.097432484450295, 5.515364169270324, 0.8664661118660788, 6.514133235261774, 4.084729912247503, 3.1463535865165873, 2.622968842003083, 6.2854782733889865, 7.236875267330461, 7.947531184323837, 7.4548189668081335, 3.7539920838527334, 6.635122563728912, 4.7432599506330515, 7.041250668113663, 3.9001902526712695, 2.08168564499069, 2.4738400871318573, 5.354458847438491, 7.895064250829957, 9.750052023907376, 0.6550575806923247, 4.8106870053674795, 3.792716895802502, 9.415335119233132, 2.475094551530634, 5.26795716369581, 3.828149737566215, 5.605712611084498, 7.461800590905854, 5.770261144399681, 8.34334144514186, 5.326850671979887, 0.46346168930440496, 4.831316575817543, 6.324967456521724, 6.313828319708511, 6.82696470600351, 6.374372404253558, 2.872154167982792, 11.329953207556171, 2.639330919376112, 4.407976590610122, 4.066858442837578, 5.5257238337926236, 2.3726732545193525, 6.170821213272903, 9.949517956853306, 7.621078170269017, 5.388453243953169, 5.457974756698009, 4.631921748096315, 6.473180926405409, 4.347156152894222, 8.054289570408264, 8.90037606696868, 5.990802527082399, 6.688602685389503, 6.625886898448774, 4.380940617680684, 2.0307060327221627, 7.960656424229217, 7.379160295955843, 2.606798288151147, 5.686972016875998, 4.975265048419655, 5.487910592075976, 7.6617467546616576, 5.392406965656914, 5.5726710691099886, 3.5743170601797107, 6.11445988729641, 3.2870532053497494, 5.414956354996522, 9.947937655245367, 3.6508437410445445, 7.298618908756739, 3.8185669692865054, 8.495201751167297, 8.813351613624011], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9416660126797094, "mean_inference_ms": 8.003104773163221, "mean_action_processing_ms": 0.5372510419707812, "mean_env_wait_ms": 23.804731056393248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04239463806152344, "StateBufferConnector_ms": 0.03604602813720703, "ViewRequirementAgentConnector_ms": 0.9779670238494873}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5991440, "num_agent_steps_trained": 5991440, "num_env_steps_sampled": 5991440, "num_env_steps_trained": 5991440, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 287.5894415700176, "num_env_steps_trained_throughput_per_sec": 287.5894415700176, "timesteps_total": 5991440, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 5991440, "timers": {"training_iteration_time_ms": 54598.698, "sample_time_ms": 41632.82, "load_time_ms": 1720.753, "load_throughput": 9087.882, "learn_time_ms": 10700.958, "learn_throughput": 1461.364, "synch_weights_time_ms": 424.902}, "counters": {"num_env_steps_sampled": 5991440, "num_env_steps_trained": 5991440, "num_agent_steps_sampled": 5991440, "num_agent_steps_trained": 5991440}, "done": false, "episodes_total": 560, "training_iteration": 388, "trial_id": "2f030_00000", "date": "2025-06-07_08-13-47", "timestamp": 1749276827, "time_this_iter_s": 54.39412069320679, "time_total_s": 2245.3124911785126, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2245.3124911785126, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 77.61774193548388, "ram_util_percent": 65.72580645161288, "gpu_util_percent0": 0.07854838709677418, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.168193548387097e-05, "total_loss": -0.12081322856501422, "policy_loss": -0.030978146947507577, "vf_loss": 0.01582988156090406, "vf_explained_var": 0.7022722491351041, "kl": 0.01818596345118501, "entropy": 20.806281847520307, "entropy_coeff": 0.005168193548387096}, "model": {}, "num_grad_updates_lifetime": 22275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6007078, "num_env_steps_trained": 6007078, "num_agent_steps_sampled": 6007078, "num_agent_steps_trained": 6007078}, "sampler_results": {"episode_reward_max": 11.329953207556171, "episode_reward_min": -3.595043716315884, "episode_reward_mean": 5.730138612842215, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.503947079034146, 6.8677010861529455, 8.463194429869267, 8.81518715920643, 6.984735597367901, 7.078923173014812, 5.097432484450295, 5.515364169270324, 0.8664661118660788, 6.514133235261774, 4.084729912247503, 3.1463535865165873, 2.622968842003083, 6.2854782733889865, 7.236875267330461, 7.947531184323837, 7.4548189668081335, 3.7539920838527334, 6.635122563728912, 4.7432599506330515, 7.041250668113663, 3.9001902526712695, 2.08168564499069, 2.4738400871318573, 5.354458847438491, 7.895064250829957, 9.750052023907376, 0.6550575806923247, 4.8106870053674795, 3.792716895802502, 9.415335119233132, 2.475094551530634, 5.26795716369581, 3.828149737566215, 5.605712611084498, 7.461800590905854, 5.770261144399681, 8.34334144514186, 5.326850671979887, 0.46346168930440496, 4.831316575817543, 6.324967456521724, 6.313828319708511, 6.82696470600351, 6.374372404253558, 2.872154167982792, 11.329953207556171, 2.639330919376112, 4.407976590610122, 4.066858442837578, 5.5257238337926236, 2.3726732545193525, 6.170821213272903, 9.949517956853306, 7.621078170269017, 5.388453243953169, 5.457974756698009, 4.631921748096315, 6.473180926405409, 4.347156152894222, 8.054289570408264, 8.90037606696868, 5.990802527082399, 6.688602685389503, 6.625886898448774, 4.380940617680684, 2.0307060327221627, 7.960656424229217, 7.379160295955843, 2.606798288151147, 5.686972016875998, 4.975265048419655, 5.487910592075976, 7.6617467546616576, 5.392406965656914, 5.5726710691099886, 3.5743170601797107, 6.11445988729641, 3.2870532053497494, 5.414956354996522, 9.947937655245367, 3.6508437410445445, 7.298618908756739, 3.8185669692865054, 8.495201751167297, 8.813351613624011, -3.595043716315884, 7.44640986106414, 6.468856339731363, 6.419724790199297, 9.97526376546175, 6.842764458679552, 5.5798860601730444, 4.283847256613313, 6.004836275545134, 7.656786815237374, 7.005164189356467, 9.753150201493705, 6.99049910928522, 6.113809691376455], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9386762132524633, "mean_inference_ms": 8.003361567555748, "mean_action_processing_ms": 0.5372949924159609, "mean_env_wait_ms": 23.806831373824224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0396580696105957, "StateBufferConnector_ms": 0.04114174842834473, "ViewRequirementAgentConnector_ms": 0.9492769241333008}}, "episode_reward_max": 11.329953207556171, "episode_reward_min": -3.595043716315884, "episode_reward_mean": 5.730138612842215, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.503947079034146, 6.8677010861529455, 8.463194429869267, 8.81518715920643, 6.984735597367901, 7.078923173014812, 5.097432484450295, 5.515364169270324, 0.8664661118660788, 6.514133235261774, 4.084729912247503, 3.1463535865165873, 2.622968842003083, 6.2854782733889865, 7.236875267330461, 7.947531184323837, 7.4548189668081335, 3.7539920838527334, 6.635122563728912, 4.7432599506330515, 7.041250668113663, 3.9001902526712695, 2.08168564499069, 2.4738400871318573, 5.354458847438491, 7.895064250829957, 9.750052023907376, 0.6550575806923247, 4.8106870053674795, 3.792716895802502, 9.415335119233132, 2.475094551530634, 5.26795716369581, 3.828149737566215, 5.605712611084498, 7.461800590905854, 5.770261144399681, 8.34334144514186, 5.326850671979887, 0.46346168930440496, 4.831316575817543, 6.324967456521724, 6.313828319708511, 6.82696470600351, 6.374372404253558, 2.872154167982792, 11.329953207556171, 2.639330919376112, 4.407976590610122, 4.066858442837578, 5.5257238337926236, 2.3726732545193525, 6.170821213272903, 9.949517956853306, 7.621078170269017, 5.388453243953169, 5.457974756698009, 4.631921748096315, 6.473180926405409, 4.347156152894222, 8.054289570408264, 8.90037606696868, 5.990802527082399, 6.688602685389503, 6.625886898448774, 4.380940617680684, 2.0307060327221627, 7.960656424229217, 7.379160295955843, 2.606798288151147, 5.686972016875998, 4.975265048419655, 5.487910592075976, 7.6617467546616576, 5.392406965656914, 5.5726710691099886, 3.5743170601797107, 6.11445988729641, 3.2870532053497494, 5.414956354996522, 9.947937655245367, 3.6508437410445445, 7.298618908756739, 3.8185669692865054, 8.495201751167297, 8.813351613624011, -3.595043716315884, 7.44640986106414, 6.468856339731363, 6.419724790199297, 9.97526376546175, 6.842764458679552, 5.5798860601730444, 4.283847256613313, 6.004836275545134, 7.656786815237374, 7.005164189356467, 9.753150201493705, 6.99049910928522, 6.113809691376455], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9386762132524633, "mean_inference_ms": 8.003361567555748, "mean_action_processing_ms": 0.5372949924159609, "mean_env_wait_ms": 23.806831373824224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0396580696105957, "StateBufferConnector_ms": 0.04114174842834473, "ViewRequirementAgentConnector_ms": 0.9492769241333008}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6007078, "num_agent_steps_trained": 6007078, "num_env_steps_sampled": 6007078, "num_env_steps_trained": 6007078, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.4107859367275, "num_env_steps_trained_throughput_per_sec": 286.4107859367275, "timesteps_total": 6007078, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6007078, "timers": {"training_iteration_time_ms": 54570.828, "sample_time_ms": 41619.572, "load_time_ms": 1728.716, "load_throughput": 9046.02, "learn_time_ms": 10679.94, "learn_throughput": 1464.24, "synch_weights_time_ms": 423.337}, "counters": {"num_env_steps_sampled": 6007078, "num_env_steps_trained": 6007078, "num_agent_steps_sampled": 6007078, "num_agent_steps_trained": 6007078}, "done": false, "episodes_total": 574, "training_iteration": 389, "trial_id": "2f030_00000", "date": "2025-06-07_08-14-42", "timestamp": 1749276882, "time_this_iter_s": 54.612740993499756, "time_total_s": 2299.9252321720123, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2299.9252321720123, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 77.31587301587302, "ram_util_percent": 65.84285714285711, "gpu_util_percent0": 0.07317460317460317, "vram_util_percent0": 0.8592122395833336}}
{"evaluation": {"sampler_results": {"episode_reward_max": -2.438515563438788, "episode_reward_min": -9.319367735439744, "episode_reward_mean": -5.788182232668888, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.805470784239019, -2.438515563438788, -6.215425517561648, -9.319367735439744, -4.162131562665236], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4924386407312842, "mean_inference_ms": 3.9225064575918287, "mean_action_processing_ms": 0.28971406952812995, "mean_env_wait_ms": 10.522062481550828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.46806812286376953}}, "episode_reward_max": -2.438515563438788, "episode_reward_min": -9.319367735439744, "episode_reward_mean": -5.788182232668888, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.805470784239019, -2.438515563438788, -6.215425517561648, -9.319367735439744, -4.162131562665236], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4924386407312842, "mean_inference_ms": 3.9225064575918287, "mean_action_processing_ms": 0.28971406952812995, "mean_env_wait_ms": 10.522062481550828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.46806812286376953}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.1555822580645163e-05, "total_loss": -0.11284792726351456, "policy_loss": -0.023024500891915524, "vf_loss": 0.015507936056872661, "vf_explained_var": 0.708530972329053, "kl": 0.01832858468788774, "entropy": 20.855875190388073, "entropy_coeff": 0.005155582258064516}, "model": {}, "num_grad_updates_lifetime": 22825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6022716, "num_env_steps_trained": 6022716, "num_agent_steps_sampled": 6022716, "num_agent_steps_trained": 6022716}, "sampler_results": {"episode_reward_max": 11.329953207556171, "episode_reward_min": -3.595043716315884, "episode_reward_mean": 5.710219389661706, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.236875267330461, 7.947531184323837, 7.4548189668081335, 3.7539920838527334, 6.635122563728912, 4.7432599506330515, 7.041250668113663, 3.9001902526712695, 2.08168564499069, 2.4738400871318573, 5.354458847438491, 7.895064250829957, 9.750052023907376, 0.6550575806923247, 4.8106870053674795, 3.792716895802502, 9.415335119233132, 2.475094551530634, 5.26795716369581, 3.828149737566215, 5.605712611084498, 7.461800590905854, 5.770261144399681, 8.34334144514186, 5.326850671979887, 0.46346168930440496, 4.831316575817543, 6.324967456521724, 6.313828319708511, 6.82696470600351, 6.374372404253558, 2.872154167982792, 11.329953207556171, 2.639330919376112, 4.407976590610122, 4.066858442837578, 5.5257238337926236, 2.3726732545193525, 6.170821213272903, 9.949517956853306, 7.621078170269017, 5.388453243953169, 5.457974756698009, 4.631921748096315, 6.473180926405409, 4.347156152894222, 8.054289570408264, 8.90037606696868, 5.990802527082399, 6.688602685389503, 6.625886898448774, 4.380940617680684, 2.0307060327221627, 7.960656424229217, 7.379160295955843, 2.606798288151147, 5.686972016875998, 4.975265048419655, 5.487910592075976, 7.6617467546616576, 5.392406965656914, 5.5726710691099886, 3.5743170601797107, 6.11445988729641, 3.2870532053497494, 5.414956354996522, 9.947937655245367, 3.6508437410445445, 7.298618908756739, 3.8185669692865054, 8.495201751167297, 8.813351613624011, -3.595043716315884, 7.44640986106414, 6.468856339731363, 6.419724790199297, 9.97526376546175, 6.842764458679552, 5.5798860601730444, 4.283847256613313, 6.004836275545134, 7.656786815237374, 7.005164189356467, 9.753150201493705, 6.99049910928522, 6.113809691376455, 5.883279000409264, 7.991100990696599, 5.518478511917628, 5.939093289659136, 6.303589302737479, 4.765286896990447, 4.256324260933051, -1.0869537527782775, 7.6436464313352905, 7.740881950388586, 3.3624523643309168, 9.923960921926218, 2.9271401107138804, 3.686412542339007], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.935228319816286, "mean_inference_ms": 8.00401709878691, "mean_action_processing_ms": 0.5373155023758449, "mean_env_wait_ms": 23.809490652611192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04067826271057129, "StateBufferConnector_ms": 0.039154052734375, "ViewRequirementAgentConnector_ms": 0.958960771560669}}, "episode_reward_max": 11.329953207556171, "episode_reward_min": -3.595043716315884, "episode_reward_mean": 5.710219389661706, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.236875267330461, 7.947531184323837, 7.4548189668081335, 3.7539920838527334, 6.635122563728912, 4.7432599506330515, 7.041250668113663, 3.9001902526712695, 2.08168564499069, 2.4738400871318573, 5.354458847438491, 7.895064250829957, 9.750052023907376, 0.6550575806923247, 4.8106870053674795, 3.792716895802502, 9.415335119233132, 2.475094551530634, 5.26795716369581, 3.828149737566215, 5.605712611084498, 7.461800590905854, 5.770261144399681, 8.34334144514186, 5.326850671979887, 0.46346168930440496, 4.831316575817543, 6.324967456521724, 6.313828319708511, 6.82696470600351, 6.374372404253558, 2.872154167982792, 11.329953207556171, 2.639330919376112, 4.407976590610122, 4.066858442837578, 5.5257238337926236, 2.3726732545193525, 6.170821213272903, 9.949517956853306, 7.621078170269017, 5.388453243953169, 5.457974756698009, 4.631921748096315, 6.473180926405409, 4.347156152894222, 8.054289570408264, 8.90037606696868, 5.990802527082399, 6.688602685389503, 6.625886898448774, 4.380940617680684, 2.0307060327221627, 7.960656424229217, 7.379160295955843, 2.606798288151147, 5.686972016875998, 4.975265048419655, 5.487910592075976, 7.6617467546616576, 5.392406965656914, 5.5726710691099886, 3.5743170601797107, 6.11445988729641, 3.2870532053497494, 5.414956354996522, 9.947937655245367, 3.6508437410445445, 7.298618908756739, 3.8185669692865054, 8.495201751167297, 8.813351613624011, -3.595043716315884, 7.44640986106414, 6.468856339731363, 6.419724790199297, 9.97526376546175, 6.842764458679552, 5.5798860601730444, 4.283847256613313, 6.004836275545134, 7.656786815237374, 7.005164189356467, 9.753150201493705, 6.99049910928522, 6.113809691376455, 5.883279000409264, 7.991100990696599, 5.518478511917628, 5.939093289659136, 6.303589302737479, 4.765286896990447, 4.256324260933051, -1.0869537527782775, 7.6436464313352905, 7.740881950388586, 3.3624523643309168, 9.923960921926218, 2.9271401107138804, 3.686412542339007], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.935228319816286, "mean_inference_ms": 8.00401709878691, "mean_action_processing_ms": 0.5373155023758449, "mean_env_wait_ms": 23.809490652611192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04067826271057129, "StateBufferConnector_ms": 0.039154052734375, "ViewRequirementAgentConnector_ms": 0.958960771560669}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6022716, "num_agent_steps_trained": 6022716, "num_env_steps_sampled": 6022716, "num_env_steps_trained": 6022716, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 287.1877703178639, "num_env_steps_trained_throughput_per_sec": 287.1877703178639, "timesteps_total": 6022716, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6022716, "timers": {"training_iteration_time_ms": 54467.212, "sample_time_ms": 41513.15, "load_time_ms": 1728.705, "load_throughput": 9046.078, "learn_time_ms": 10683.592, "learn_throughput": 1463.74, "synch_weights_time_ms": 422.396}, "counters": {"num_env_steps_sampled": 6022716, "num_env_steps_trained": 6022716, "num_agent_steps_sampled": 6022716, "num_agent_steps_trained": 6022716}, "done": false, "episodes_total": 588, "training_iteration": 390, "trial_id": "2f030_00000", "date": "2025-06-07_08-15-51", "timestamp": 1749276951, "time_this_iter_s": 69.00635075569153, "time_total_s": 2368.931582927704, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2368.931582927704, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 64.2679012345679, "ram_util_percent": 65.49876543209878, "gpu_util_percent0": 0.06999999999999999, "vram_util_percent0": 0.8592122395833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.142970967741935e-05, "total_loss": -0.11521685368593104, "policy_loss": -0.026664327930299228, "vf_loss": 0.016991410776126113, "vf_explained_var": 0.7336263564499942, "kl": 0.018672507823741233, "entropy": 20.794045302651146, "entropy_coeff": 0.005142970967741935}, "model": {}, "num_grad_updates_lifetime": 23375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6038354, "num_env_steps_trained": 6038354, "num_agent_steps_sampled": 6038354, "num_agent_steps_trained": 6038354}, "sampler_results": {"episode_reward_max": 11.329953207556171, "episode_reward_min": -3.595043716315884, "episode_reward_mean": 5.714926267045353, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.8106870053674795, 3.792716895802502, 9.415335119233132, 2.475094551530634, 5.26795716369581, 3.828149737566215, 5.605712611084498, 7.461800590905854, 5.770261144399681, 8.34334144514186, 5.326850671979887, 0.46346168930440496, 4.831316575817543, 6.324967456521724, 6.313828319708511, 6.82696470600351, 6.374372404253558, 2.872154167982792, 11.329953207556171, 2.639330919376112, 4.407976590610122, 4.066858442837578, 5.5257238337926236, 2.3726732545193525, 6.170821213272903, 9.949517956853306, 7.621078170269017, 5.388453243953169, 5.457974756698009, 4.631921748096315, 6.473180926405409, 4.347156152894222, 8.054289570408264, 8.90037606696868, 5.990802527082399, 6.688602685389503, 6.625886898448774, 4.380940617680684, 2.0307060327221627, 7.960656424229217, 7.379160295955843, 2.606798288151147, 5.686972016875998, 4.975265048419655, 5.487910592075976, 7.6617467546616576, 5.392406965656914, 5.5726710691099886, 3.5743170601797107, 6.11445988729641, 3.2870532053497494, 5.414956354996522, 9.947937655245367, 3.6508437410445445, 7.298618908756739, 3.8185669692865054, 8.495201751167297, 8.813351613624011, -3.595043716315884, 7.44640986106414, 6.468856339731363, 6.419724790199297, 9.97526376546175, 6.842764458679552, 5.5798860601730444, 4.283847256613313, 6.004836275545134, 7.656786815237374, 7.005164189356467, 9.753150201493705, 6.99049910928522, 6.113809691376455, 5.883279000409264, 7.991100990696599, 5.518478511917628, 5.939093289659136, 6.303589302737479, 4.765286896990447, 4.256324260933051, -1.0869537527782775, 7.6436464313352905, 7.740881950388586, 3.3624523643309168, 9.923960921926218, 2.9271401107138804, 3.686412542339007, 6.370362743728203, 6.716786780978371, 4.513603577523233, -1.2773858478752858, 9.156480344581597, 2.45356452753693, 6.564372099342771, 4.88161616333966, 5.436576098321693, 5.812542859935066, 5.904518001445619, 6.696467676650691, 7.4494210264582605, 6.7149610588506485], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9314334316352193, "mean_inference_ms": 8.005306928446704, "mean_action_processing_ms": 0.5374074310127472, "mean_env_wait_ms": 23.813190070240374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03947806358337402, "StateBufferConnector_ms": 0.03716897964477539, "ViewRequirementAgentConnector_ms": 0.9728999137878418}}, "episode_reward_max": 11.329953207556171, "episode_reward_min": -3.595043716315884, "episode_reward_mean": 5.714926267045353, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.8106870053674795, 3.792716895802502, 9.415335119233132, 2.475094551530634, 5.26795716369581, 3.828149737566215, 5.605712611084498, 7.461800590905854, 5.770261144399681, 8.34334144514186, 5.326850671979887, 0.46346168930440496, 4.831316575817543, 6.324967456521724, 6.313828319708511, 6.82696470600351, 6.374372404253558, 2.872154167982792, 11.329953207556171, 2.639330919376112, 4.407976590610122, 4.066858442837578, 5.5257238337926236, 2.3726732545193525, 6.170821213272903, 9.949517956853306, 7.621078170269017, 5.388453243953169, 5.457974756698009, 4.631921748096315, 6.473180926405409, 4.347156152894222, 8.054289570408264, 8.90037606696868, 5.990802527082399, 6.688602685389503, 6.625886898448774, 4.380940617680684, 2.0307060327221627, 7.960656424229217, 7.379160295955843, 2.606798288151147, 5.686972016875998, 4.975265048419655, 5.487910592075976, 7.6617467546616576, 5.392406965656914, 5.5726710691099886, 3.5743170601797107, 6.11445988729641, 3.2870532053497494, 5.414956354996522, 9.947937655245367, 3.6508437410445445, 7.298618908756739, 3.8185669692865054, 8.495201751167297, 8.813351613624011, -3.595043716315884, 7.44640986106414, 6.468856339731363, 6.419724790199297, 9.97526376546175, 6.842764458679552, 5.5798860601730444, 4.283847256613313, 6.004836275545134, 7.656786815237374, 7.005164189356467, 9.753150201493705, 6.99049910928522, 6.113809691376455, 5.883279000409264, 7.991100990696599, 5.518478511917628, 5.939093289659136, 6.303589302737479, 4.765286896990447, 4.256324260933051, -1.0869537527782775, 7.6436464313352905, 7.740881950388586, 3.3624523643309168, 9.923960921926218, 2.9271401107138804, 3.686412542339007, 6.370362743728203, 6.716786780978371, 4.513603577523233, -1.2773858478752858, 9.156480344581597, 2.45356452753693, 6.564372099342771, 4.88161616333966, 5.436576098321693, 5.812542859935066, 5.904518001445619, 6.696467676650691, 7.4494210264582605, 6.7149610588506485], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9314334316352193, "mean_inference_ms": 8.005306928446704, "mean_action_processing_ms": 0.5374074310127472, "mean_env_wait_ms": 23.813190070240374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03947806358337402, "StateBufferConnector_ms": 0.03716897964477539, "ViewRequirementAgentConnector_ms": 0.9728999137878418}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6038354, "num_agent_steps_trained": 6038354, "num_env_steps_sampled": 6038354, "num_env_steps_trained": 6038354, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.5195617052059, "num_env_steps_trained_throughput_per_sec": 286.5195617052059, "timesteps_total": 6038354, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6038354, "timers": {"training_iteration_time_ms": 54454.293, "sample_time_ms": 41516.199, "load_time_ms": 1729.538, "load_throughput": 9041.719, "learn_time_ms": 10667.115, "learn_throughput": 1466.001, "synch_weights_time_ms": 425.948}, "counters": {"num_env_steps_sampled": 6038354, "num_env_steps_trained": 6038354, "num_agent_steps_sampled": 6038354, "num_agent_steps_trained": 6038354}, "done": false, "episodes_total": 602, "training_iteration": 391, "trial_id": "2f030_00000", "date": "2025-06-07_08-16-46", "timestamp": 1749277006, "time_this_iter_s": 54.59717535972595, "time_total_s": 2423.52875828743, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2423.52875828743, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 77.384126984127, "ram_util_percent": 65.96666666666667, "gpu_util_percent0": 0.07841269841269842, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.1303596774193545e-05, "total_loss": -0.11033989373255859, "policy_loss": -0.021425241277373226, "vf_loss": 0.01626731544648382, "vf_explained_var": 0.7090954673290253, "kl": 0.017900902804579923, "entropy": 20.766330937472258, "entropy_coeff": 0.005130359677419356}, "model": {}, "num_grad_updates_lifetime": 23925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6053992, "num_env_steps_trained": 6053992, "num_agent_steps_sampled": 6053992, "num_agent_steps_trained": 6053992}, "sampler_results": {"episode_reward_max": 11.329953207556171, "episode_reward_min": -3.595043716315884, "episode_reward_mean": 5.808754038545122, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.313828319708511, 6.82696470600351, 6.374372404253558, 2.872154167982792, 11.329953207556171, 2.639330919376112, 4.407976590610122, 4.066858442837578, 5.5257238337926236, 2.3726732545193525, 6.170821213272903, 9.949517956853306, 7.621078170269017, 5.388453243953169, 5.457974756698009, 4.631921748096315, 6.473180926405409, 4.347156152894222, 8.054289570408264, 8.90037606696868, 5.990802527082399, 6.688602685389503, 6.625886898448774, 4.380940617680684, 2.0307060327221627, 7.960656424229217, 7.379160295955843, 2.606798288151147, 5.686972016875998, 4.975265048419655, 5.487910592075976, 7.6617467546616576, 5.392406965656914, 5.5726710691099886, 3.5743170601797107, 6.11445988729641, 3.2870532053497494, 5.414956354996522, 9.947937655245367, 3.6508437410445445, 7.298618908756739, 3.8185669692865054, 8.495201751167297, 8.813351613624011, -3.595043716315884, 7.44640986106414, 6.468856339731363, 6.419724790199297, 9.97526376546175, 6.842764458679552, 5.5798860601730444, 4.283847256613313, 6.004836275545134, 7.656786815237374, 7.005164189356467, 9.753150201493705, 6.99049910928522, 6.113809691376455, 5.883279000409264, 7.991100990696599, 5.518478511917628, 5.939093289659136, 6.303589302737479, 4.765286896990447, 4.256324260933051, -1.0869537527782775, 7.6436464313352905, 7.740881950388586, 3.3624523643309168, 9.923960921926218, 2.9271401107138804, 3.686412542339007, 6.370362743728203, 6.716786780978371, 4.513603577523233, -1.2773858478752858, 9.156480344581597, 2.45356452753693, 6.564372099342771, 4.88161616333966, 5.436576098321693, 5.812542859935066, 5.904518001445619, 6.696467676650691, 7.4494210264582605, 6.7149610588506485, 9.366710465597198, 6.273409470588928, 7.655973813262045, 7.679481217590855, 1.2097705038162327, 4.126588206145066, 4.033953657195094, 8.586912911492572, 2.2971413368667988, 7.187593595164558, 4.787966274995731, 4.5628727168360905, 9.586443520819271, 5.7456121179578385], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.926977397163898, "mean_inference_ms": 8.006596576113527, "mean_action_processing_ms": 0.5374785703538955, "mean_env_wait_ms": 23.81802920163087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033370256423950195, "StateBufferConnector_ms": 0.03313946723937988, "ViewRequirementAgentConnector_ms": 0.9793920516967773}}, "episode_reward_max": 11.329953207556171, "episode_reward_min": -3.595043716315884, "episode_reward_mean": 5.808754038545122, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.313828319708511, 6.82696470600351, 6.374372404253558, 2.872154167982792, 11.329953207556171, 2.639330919376112, 4.407976590610122, 4.066858442837578, 5.5257238337926236, 2.3726732545193525, 6.170821213272903, 9.949517956853306, 7.621078170269017, 5.388453243953169, 5.457974756698009, 4.631921748096315, 6.473180926405409, 4.347156152894222, 8.054289570408264, 8.90037606696868, 5.990802527082399, 6.688602685389503, 6.625886898448774, 4.380940617680684, 2.0307060327221627, 7.960656424229217, 7.379160295955843, 2.606798288151147, 5.686972016875998, 4.975265048419655, 5.487910592075976, 7.6617467546616576, 5.392406965656914, 5.5726710691099886, 3.5743170601797107, 6.11445988729641, 3.2870532053497494, 5.414956354996522, 9.947937655245367, 3.6508437410445445, 7.298618908756739, 3.8185669692865054, 8.495201751167297, 8.813351613624011, -3.595043716315884, 7.44640986106414, 6.468856339731363, 6.419724790199297, 9.97526376546175, 6.842764458679552, 5.5798860601730444, 4.283847256613313, 6.004836275545134, 7.656786815237374, 7.005164189356467, 9.753150201493705, 6.99049910928522, 6.113809691376455, 5.883279000409264, 7.991100990696599, 5.518478511917628, 5.939093289659136, 6.303589302737479, 4.765286896990447, 4.256324260933051, -1.0869537527782775, 7.6436464313352905, 7.740881950388586, 3.3624523643309168, 9.923960921926218, 2.9271401107138804, 3.686412542339007, 6.370362743728203, 6.716786780978371, 4.513603577523233, -1.2773858478752858, 9.156480344581597, 2.45356452753693, 6.564372099342771, 4.88161616333966, 5.436576098321693, 5.812542859935066, 5.904518001445619, 6.696467676650691, 7.4494210264582605, 6.7149610588506485, 9.366710465597198, 6.273409470588928, 7.655973813262045, 7.679481217590855, 1.2097705038162327, 4.126588206145066, 4.033953657195094, 8.586912911492572, 2.2971413368667988, 7.187593595164558, 4.787966274995731, 4.5628727168360905, 9.586443520819271, 5.7456121179578385], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.926977397163898, "mean_inference_ms": 8.006596576113527, "mean_action_processing_ms": 0.5374785703538955, "mean_env_wait_ms": 23.81802920163087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033370256423950195, "StateBufferConnector_ms": 0.03313946723937988, "ViewRequirementAgentConnector_ms": 0.9793920516967773}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6053992, "num_agent_steps_trained": 6053992, "num_env_steps_sampled": 6053992, "num_env_steps_trained": 6053992, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 287.7471871292869, "num_env_steps_trained_throughput_per_sec": 287.7471871292869, "timesteps_total": 6053992, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6053992, "timers": {"training_iteration_time_ms": 54424.505, "sample_time_ms": 41470.014, "load_time_ms": 1750.403, "load_throughput": 8933.942, "learn_time_ms": 10658.509, "learn_throughput": 1467.185, "synch_weights_time_ms": 429.534}, "counters": {"num_env_steps_sampled": 6053992, "num_env_steps_trained": 6053992, "num_agent_steps_sampled": 6053992, "num_agent_steps_trained": 6053992}, "done": false, "episodes_total": 616, "training_iteration": 392, "trial_id": "2f030_00000", "date": "2025-06-07_08-17-40", "timestamp": 1749277060, "time_this_iter_s": 54.35826635360718, "time_total_s": 2477.887024641037, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2477.887024641037, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 77.50952380952381, "ram_util_percent": 65.6126984126984, "gpu_util_percent0": 0.07777777777777778, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.117748387096774e-05, "total_loss": -0.1080475813167339, "policy_loss": -0.019197764819840483, "vf_loss": 0.015292783796109936, "vf_explained_var": 0.7005609997836026, "kl": 0.018040997939288424, "entropy": 20.767197634957054, "entropy_coeff": 0.005117748387096776}, "model": {}, "num_grad_updates_lifetime": 24475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6069630, "num_env_steps_trained": 6069630, "num_agent_steps_sampled": 6069630, "num_agent_steps_trained": 6069630}, "sampler_results": {"episode_reward_max": 9.97526376546175, "episode_reward_min": -3.595043716315884, "episode_reward_mean": 5.706102079297307, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.457974756698009, 4.631921748096315, 6.473180926405409, 4.347156152894222, 8.054289570408264, 8.90037606696868, 5.990802527082399, 6.688602685389503, 6.625886898448774, 4.380940617680684, 2.0307060327221627, 7.960656424229217, 7.379160295955843, 2.606798288151147, 5.686972016875998, 4.975265048419655, 5.487910592075976, 7.6617467546616576, 5.392406965656914, 5.5726710691099886, 3.5743170601797107, 6.11445988729641, 3.2870532053497494, 5.414956354996522, 9.947937655245367, 3.6508437410445445, 7.298618908756739, 3.8185669692865054, 8.495201751167297, 8.813351613624011, -3.595043716315884, 7.44640986106414, 6.468856339731363, 6.419724790199297, 9.97526376546175, 6.842764458679552, 5.5798860601730444, 4.283847256613313, 6.004836275545134, 7.656786815237374, 7.005164189356467, 9.753150201493705, 6.99049910928522, 6.113809691376455, 5.883279000409264, 7.991100990696599, 5.518478511917628, 5.939093289659136, 6.303589302737479, 4.765286896990447, 4.256324260933051, -1.0869537527782775, 7.6436464313352905, 7.740881950388586, 3.3624523643309168, 9.923960921926218, 2.9271401107138804, 3.686412542339007, 6.370362743728203, 6.716786780978371, 4.513603577523233, -1.2773858478752858, 9.156480344581597, 2.45356452753693, 6.564372099342771, 4.88161616333966, 5.436576098321693, 5.812542859935066, 5.904518001445619, 6.696467676650691, 7.4494210264582605, 6.7149610588506485, 9.366710465597198, 6.273409470588928, 7.655973813262045, 7.679481217590855, 1.2097705038162327, 4.126588206145066, 4.033953657195094, 8.586912911492572, 2.2971413368667988, 7.187593595164558, 4.787966274995731, 4.5628727168360905, 9.586443520819271, 5.7456121179578385, 2.6922745305788043, 6.635526922953059, 2.6605973850945595, -1.5533619327202461, 5.32356300399478, 4.731271348568003, 9.796677572313863, 3.2936842829447333, 9.148147208418528, 7.177722488549763, 4.630271395405884, 5.736148750181501, 4.299694749303112, 7.022292800620947], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.923093951841705, "mean_inference_ms": 8.007645224568455, "mean_action_processing_ms": 0.5375658953406718, "mean_env_wait_ms": 23.820816969833196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035416603088378906, "StateBufferConnector_ms": 0.03217434883117676, "ViewRequirementAgentConnector_ms": 0.9486846923828125}}, "episode_reward_max": 9.97526376546175, "episode_reward_min": -3.595043716315884, "episode_reward_mean": 5.706102079297307, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.457974756698009, 4.631921748096315, 6.473180926405409, 4.347156152894222, 8.054289570408264, 8.90037606696868, 5.990802527082399, 6.688602685389503, 6.625886898448774, 4.380940617680684, 2.0307060327221627, 7.960656424229217, 7.379160295955843, 2.606798288151147, 5.686972016875998, 4.975265048419655, 5.487910592075976, 7.6617467546616576, 5.392406965656914, 5.5726710691099886, 3.5743170601797107, 6.11445988729641, 3.2870532053497494, 5.414956354996522, 9.947937655245367, 3.6508437410445445, 7.298618908756739, 3.8185669692865054, 8.495201751167297, 8.813351613624011, -3.595043716315884, 7.44640986106414, 6.468856339731363, 6.419724790199297, 9.97526376546175, 6.842764458679552, 5.5798860601730444, 4.283847256613313, 6.004836275545134, 7.656786815237374, 7.005164189356467, 9.753150201493705, 6.99049910928522, 6.113809691376455, 5.883279000409264, 7.991100990696599, 5.518478511917628, 5.939093289659136, 6.303589302737479, 4.765286896990447, 4.256324260933051, -1.0869537527782775, 7.6436464313352905, 7.740881950388586, 3.3624523643309168, 9.923960921926218, 2.9271401107138804, 3.686412542339007, 6.370362743728203, 6.716786780978371, 4.513603577523233, -1.2773858478752858, 9.156480344581597, 2.45356452753693, 6.564372099342771, 4.88161616333966, 5.436576098321693, 5.812542859935066, 5.904518001445619, 6.696467676650691, 7.4494210264582605, 6.7149610588506485, 9.366710465597198, 6.273409470588928, 7.655973813262045, 7.679481217590855, 1.2097705038162327, 4.126588206145066, 4.033953657195094, 8.586912911492572, 2.2971413368667988, 7.187593595164558, 4.787966274995731, 4.5628727168360905, 9.586443520819271, 5.7456121179578385, 2.6922745305788043, 6.635526922953059, 2.6605973850945595, -1.5533619327202461, 5.32356300399478, 4.731271348568003, 9.796677572313863, 3.2936842829447333, 9.148147208418528, 7.177722488549763, 4.630271395405884, 5.736148750181501, 4.299694749303112, 7.022292800620947], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.923093951841705, "mean_inference_ms": 8.007645224568455, "mean_action_processing_ms": 0.5375658953406718, "mean_env_wait_ms": 23.820816969833196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035416603088378906, "StateBufferConnector_ms": 0.03217434883117676, "ViewRequirementAgentConnector_ms": 0.9486846923828125}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6069630, "num_agent_steps_trained": 6069630, "num_env_steps_sampled": 6069630, "num_env_steps_trained": 6069630, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 290.25788337452997, "num_env_steps_trained_throughput_per_sec": 290.25788337452997, "timesteps_total": 6069630, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6069630, "timers": {"training_iteration_time_ms": 54377.825, "sample_time_ms": 41445.661, "load_time_ms": 1731.734, "load_throughput": 9030.253, "learn_time_ms": 10652.595, "learn_throughput": 1467.999, "synch_weights_time_ms": 428.108}, "counters": {"num_env_steps_sampled": 6069630, "num_env_steps_trained": 6069630, "num_agent_steps_sampled": 6069630, "num_agent_steps_trained": 6069630}, "done": false, "episodes_total": 630, "training_iteration": 393, "trial_id": "2f030_00000", "date": "2025-06-07_08-18-34", "timestamp": 1749277114, "time_this_iter_s": 53.891199350357056, "time_total_s": 2531.778223991394, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2531.778223991394, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 77.38387096774194, "ram_util_percent": 65.75322580645162, "gpu_util_percent0": 0.07870967741935483, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.1051370967741954e-05, "total_loss": -0.11097065646455369, "policy_loss": -0.022819629287911414, "vf_loss": 0.015847490301609715, "vf_explained_var": 0.6963587907227603, "kl": 0.01834439509338462, "entropy": 20.7565264563127, "entropy_coeff": 0.005105137096774194}, "model": {}, "num_grad_updates_lifetime": 25025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6085268, "num_env_steps_trained": 6085268, "num_agent_steps_sampled": 6085268, "num_agent_steps_trained": 6085268}, "sampler_results": {"episode_reward_max": 10.934730210604963, "episode_reward_min": -3.595043716315884, "episode_reward_mean": 5.66751544212731, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.686972016875998, 4.975265048419655, 5.487910592075976, 7.6617467546616576, 5.392406965656914, 5.5726710691099886, 3.5743170601797107, 6.11445988729641, 3.2870532053497494, 5.414956354996522, 9.947937655245367, 3.6508437410445445, 7.298618908756739, 3.8185669692865054, 8.495201751167297, 8.813351613624011, -3.595043716315884, 7.44640986106414, 6.468856339731363, 6.419724790199297, 9.97526376546175, 6.842764458679552, 5.5798860601730444, 4.283847256613313, 6.004836275545134, 7.656786815237374, 7.005164189356467, 9.753150201493705, 6.99049910928522, 6.113809691376455, 5.883279000409264, 7.991100990696599, 5.518478511917628, 5.939093289659136, 6.303589302737479, 4.765286896990447, 4.256324260933051, -1.0869537527782775, 7.6436464313352905, 7.740881950388586, 3.3624523643309168, 9.923960921926218, 2.9271401107138804, 3.686412542339007, 6.370362743728203, 6.716786780978371, 4.513603577523233, -1.2773858478752858, 9.156480344581597, 2.45356452753693, 6.564372099342771, 4.88161616333966, 5.436576098321693, 5.812542859935066, 5.904518001445619, 6.696467676650691, 7.4494210264582605, 6.7149610588506485, 9.366710465597198, 6.273409470588928, 7.655973813262045, 7.679481217590855, 1.2097705038162327, 4.126588206145066, 4.033953657195094, 8.586912911492572, 2.2971413368667988, 7.187593595164558, 4.787966274995731, 4.5628727168360905, 9.586443520819271, 5.7456121179578385, 2.6922745305788043, 6.635526922953059, 2.6605973850945595, -1.5533619327202461, 5.32356300399478, 4.731271348568003, 9.796677572313863, 3.2936842829447333, 9.148147208418528, 7.177722488549763, 4.630271395405884, 5.736148750181501, 4.299694749303112, 7.022292800620947, 6.425480156595538, 2.2383588521995814, 10.934730210604963, 5.353167582247637, 4.355909124256514, 3.679561846588712, 4.214123505591081, 9.607527704059818, 6.8444961436486285, 3.754424420025874, 6.153224133095745, 5.830604713973019, 5.262249400245301, 3.015931480998472], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.919387554176505, "mean_inference_ms": 8.008275623827217, "mean_action_processing_ms": 0.5376098104279801, "mean_env_wait_ms": 23.822396486930174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03434634208679199, "StateBufferConnector_ms": 0.03406262397766113, "ViewRequirementAgentConnector_ms": 0.9464683532714844}}, "episode_reward_max": 10.934730210604963, "episode_reward_min": -3.595043716315884, "episode_reward_mean": 5.66751544212731, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.686972016875998, 4.975265048419655, 5.487910592075976, 7.6617467546616576, 5.392406965656914, 5.5726710691099886, 3.5743170601797107, 6.11445988729641, 3.2870532053497494, 5.414956354996522, 9.947937655245367, 3.6508437410445445, 7.298618908756739, 3.8185669692865054, 8.495201751167297, 8.813351613624011, -3.595043716315884, 7.44640986106414, 6.468856339731363, 6.419724790199297, 9.97526376546175, 6.842764458679552, 5.5798860601730444, 4.283847256613313, 6.004836275545134, 7.656786815237374, 7.005164189356467, 9.753150201493705, 6.99049910928522, 6.113809691376455, 5.883279000409264, 7.991100990696599, 5.518478511917628, 5.939093289659136, 6.303589302737479, 4.765286896990447, 4.256324260933051, -1.0869537527782775, 7.6436464313352905, 7.740881950388586, 3.3624523643309168, 9.923960921926218, 2.9271401107138804, 3.686412542339007, 6.370362743728203, 6.716786780978371, 4.513603577523233, -1.2773858478752858, 9.156480344581597, 2.45356452753693, 6.564372099342771, 4.88161616333966, 5.436576098321693, 5.812542859935066, 5.904518001445619, 6.696467676650691, 7.4494210264582605, 6.7149610588506485, 9.366710465597198, 6.273409470588928, 7.655973813262045, 7.679481217590855, 1.2097705038162327, 4.126588206145066, 4.033953657195094, 8.586912911492572, 2.2971413368667988, 7.187593595164558, 4.787966274995731, 4.5628727168360905, 9.586443520819271, 5.7456121179578385, 2.6922745305788043, 6.635526922953059, 2.6605973850945595, -1.5533619327202461, 5.32356300399478, 4.731271348568003, 9.796677572313863, 3.2936842829447333, 9.148147208418528, 7.177722488549763, 4.630271395405884, 5.736148750181501, 4.299694749303112, 7.022292800620947, 6.425480156595538, 2.2383588521995814, 10.934730210604963, 5.353167582247637, 4.355909124256514, 3.679561846588712, 4.214123505591081, 9.607527704059818, 6.8444961436486285, 3.754424420025874, 6.153224133095745, 5.830604713973019, 5.262249400245301, 3.015931480998472], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.919387554176505, "mean_inference_ms": 8.008275623827217, "mean_action_processing_ms": 0.5376098104279801, "mean_env_wait_ms": 23.822396486930174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03434634208679199, "StateBufferConnector_ms": 0.03406262397766113, "ViewRequirementAgentConnector_ms": 0.9464683532714844}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6085268, "num_agent_steps_trained": 6085268, "num_env_steps_sampled": 6085268, "num_env_steps_trained": 6085268, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 290.3162836743662, "num_env_steps_trained_throughput_per_sec": 290.3162836743662, "timesteps_total": 6085268, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6085268, "timers": {"training_iteration_time_ms": 54367.028, "sample_time_ms": 41440.547, "load_time_ms": 1730.697, "load_throughput": 9035.664, "learn_time_ms": 10643.562, "learn_throughput": 1469.245, "synch_weights_time_ms": 427.106}, "counters": {"num_env_steps_sampled": 6085268, "num_env_steps_trained": 6085268, "num_agent_steps_sampled": 6085268, "num_agent_steps_trained": 6085268}, "done": false, "episodes_total": 644, "training_iteration": 394, "trial_id": "2f030_00000", "date": "2025-06-07_08-19-28", "timestamp": 1749277168, "time_this_iter_s": 53.881361961364746, "time_total_s": 2585.659585952759, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2585.659585952759, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 77.62258064516128, "ram_util_percent": 66.08225806451613, "gpu_util_percent0": 0.07967741935483869, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.092525806451612e-05, "total_loss": -0.10838046910833907, "policy_loss": -0.01891112340247756, "vf_loss": 0.014990640660239892, "vf_explained_var": 0.7144231371446089, "kl": 0.016954407154294113, "entropy": 20.822008949626575, "entropy_coeff": 0.0050925258064516135}, "model": {}, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6100906, "num_env_steps_trained": 6100906, "num_agent_steps_sampled": 6100906, "num_agent_steps_trained": 6100906}, "sampler_results": {"episode_reward_max": 10.934730210604963, "episode_reward_min": -3.595043716315884, "episode_reward_mean": 5.630736120665416, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.495201751167297, 8.813351613624011, -3.595043716315884, 7.44640986106414, 6.468856339731363, 6.419724790199297, 9.97526376546175, 6.842764458679552, 5.5798860601730444, 4.283847256613313, 6.004836275545134, 7.656786815237374, 7.005164189356467, 9.753150201493705, 6.99049910928522, 6.113809691376455, 5.883279000409264, 7.991100990696599, 5.518478511917628, 5.939093289659136, 6.303589302737479, 4.765286896990447, 4.256324260933051, -1.0869537527782775, 7.6436464313352905, 7.740881950388586, 3.3624523643309168, 9.923960921926218, 2.9271401107138804, 3.686412542339007, 6.370362743728203, 6.716786780978371, 4.513603577523233, -1.2773858478752858, 9.156480344581597, 2.45356452753693, 6.564372099342771, 4.88161616333966, 5.436576098321693, 5.812542859935066, 5.904518001445619, 6.696467676650691, 7.4494210264582605, 6.7149610588506485, 9.366710465597198, 6.273409470588928, 7.655973813262045, 7.679481217590855, 1.2097705038162327, 4.126588206145066, 4.033953657195094, 8.586912911492572, 2.2971413368667988, 7.187593595164558, 4.787966274995731, 4.5628727168360905, 9.586443520819271, 5.7456121179578385, 2.6922745305788043, 6.635526922953059, 2.6605973850945595, -1.5533619327202461, 5.32356300399478, 4.731271348568003, 9.796677572313863, 3.2936842829447333, 9.148147208418528, 7.177722488549763, 4.630271395405884, 5.736148750181501, 4.299694749303112, 7.022292800620947, 6.425480156595538, 2.2383588521995814, 10.934730210604963, 5.353167582247637, 4.355909124256514, 3.679561846588712, 4.214123505591081, 9.607527704059818, 6.8444961436486285, 3.754424420025874, 6.153224133095745, 5.830604713973019, 5.262249400245301, 3.015931480998472, 2.8158090735286625, 7.2164205951878655, 6.828915417460135, 5.94665362200157, -2.3814149356286856, 9.767631676047628, 7.994098121341051, 5.246524763454126, 3.3064823348921126, 7.045275745195324, 3.025657072951859, 2.194021522212797, 9.691805746579185, 5.507913327542613], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9158856403844515, "mean_inference_ms": 8.008651186581583, "mean_action_processing_ms": 0.5376078219037566, "mean_env_wait_ms": 23.82345613864646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03036808967590332, "StateBufferConnector_ms": 0.03199005126953125, "ViewRequirementAgentConnector_ms": 0.9302995204925537}}, "episode_reward_max": 10.934730210604963, "episode_reward_min": -3.595043716315884, "episode_reward_mean": 5.630736120665416, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.495201751167297, 8.813351613624011, -3.595043716315884, 7.44640986106414, 6.468856339731363, 6.419724790199297, 9.97526376546175, 6.842764458679552, 5.5798860601730444, 4.283847256613313, 6.004836275545134, 7.656786815237374, 7.005164189356467, 9.753150201493705, 6.99049910928522, 6.113809691376455, 5.883279000409264, 7.991100990696599, 5.518478511917628, 5.939093289659136, 6.303589302737479, 4.765286896990447, 4.256324260933051, -1.0869537527782775, 7.6436464313352905, 7.740881950388586, 3.3624523643309168, 9.923960921926218, 2.9271401107138804, 3.686412542339007, 6.370362743728203, 6.716786780978371, 4.513603577523233, -1.2773858478752858, 9.156480344581597, 2.45356452753693, 6.564372099342771, 4.88161616333966, 5.436576098321693, 5.812542859935066, 5.904518001445619, 6.696467676650691, 7.4494210264582605, 6.7149610588506485, 9.366710465597198, 6.273409470588928, 7.655973813262045, 7.679481217590855, 1.2097705038162327, 4.126588206145066, 4.033953657195094, 8.586912911492572, 2.2971413368667988, 7.187593595164558, 4.787966274995731, 4.5628727168360905, 9.586443520819271, 5.7456121179578385, 2.6922745305788043, 6.635526922953059, 2.6605973850945595, -1.5533619327202461, 5.32356300399478, 4.731271348568003, 9.796677572313863, 3.2936842829447333, 9.148147208418528, 7.177722488549763, 4.630271395405884, 5.736148750181501, 4.299694749303112, 7.022292800620947, 6.425480156595538, 2.2383588521995814, 10.934730210604963, 5.353167582247637, 4.355909124256514, 3.679561846588712, 4.214123505591081, 9.607527704059818, 6.8444961436486285, 3.754424420025874, 6.153224133095745, 5.830604713973019, 5.262249400245301, 3.015931480998472, 2.8158090735286625, 7.2164205951878655, 6.828915417460135, 5.94665362200157, -2.3814149356286856, 9.767631676047628, 7.994098121341051, 5.246524763454126, 3.3064823348921126, 7.045275745195324, 3.025657072951859, 2.194021522212797, 9.691805746579185, 5.507913327542613], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9158856403844515, "mean_inference_ms": 8.008651186581583, "mean_action_processing_ms": 0.5376078219037566, "mean_env_wait_ms": 23.82345613864646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03036808967590332, "StateBufferConnector_ms": 0.03199005126953125, "ViewRequirementAgentConnector_ms": 0.9302995204925537}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6100906, "num_agent_steps_trained": 6100906, "num_env_steps_sampled": 6100906, "num_env_steps_trained": 6100906, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 288.0910904132663, "num_env_steps_trained_throughput_per_sec": 288.0910904132663, "timesteps_total": 6100906, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6100906, "timers": {"training_iteration_time_ms": 54388.47, "sample_time_ms": 41470.427, "load_time_ms": 1730.678, "load_throughput": 9035.764, "learn_time_ms": 10635.658, "learn_throughput": 1470.337, "synch_weights_time_ms": 426.364}, "counters": {"num_env_steps_sampled": 6100906, "num_env_steps_trained": 6100906, "num_agent_steps_sampled": 6100906, "num_agent_steps_trained": 6100906}, "done": false, "episodes_total": 658, "training_iteration": 395, "trial_id": "2f030_00000", "date": "2025-06-07_08-20-23", "timestamp": 1749277223, "time_this_iter_s": 54.297422885894775, "time_total_s": 2639.9570088386536, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2639.9570088386536, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 77.49032258064516, "ram_util_percent": 65.94838709677418, "gpu_util_percent0": 0.07725806451612904, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.079914516129033e-05, "total_loss": -0.118602709507739, "policy_loss": -0.0302210629199445, "vf_loss": 0.01476467137309638, "vf_explained_var": 0.7072294041243467, "kl": 0.01813573323509447, "entropy": 20.811794057325884, "entropy_coeff": 0.005079914516129032}, "model": {}, "num_grad_updates_lifetime": 26125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6116544, "num_env_steps_trained": 6116544, "num_agent_steps_sampled": 6116544, "num_agent_steps_trained": 6116544}, "sampler_results": {"episode_reward_max": 10.934730210604963, "episode_reward_min": -2.3814149356286856, "episode_reward_mean": 5.52950730179562, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.99049910928522, 6.113809691376455, 5.883279000409264, 7.991100990696599, 5.518478511917628, 5.939093289659136, 6.303589302737479, 4.765286896990447, 4.256324260933051, -1.0869537527782775, 7.6436464313352905, 7.740881950388586, 3.3624523643309168, 9.923960921926218, 2.9271401107138804, 3.686412542339007, 6.370362743728203, 6.716786780978371, 4.513603577523233, -1.2773858478752858, 9.156480344581597, 2.45356452753693, 6.564372099342771, 4.88161616333966, 5.436576098321693, 5.812542859935066, 5.904518001445619, 6.696467676650691, 7.4494210264582605, 6.7149610588506485, 9.366710465597198, 6.273409470588928, 7.655973813262045, 7.679481217590855, 1.2097705038162327, 4.126588206145066, 4.033953657195094, 8.586912911492572, 2.2971413368667988, 7.187593595164558, 4.787966274995731, 4.5628727168360905, 9.586443520819271, 5.7456121179578385, 2.6922745305788043, 6.635526922953059, 2.6605973850945595, -1.5533619327202461, 5.32356300399478, 4.731271348568003, 9.796677572313863, 3.2936842829447333, 9.148147208418528, 7.177722488549763, 4.630271395405884, 5.736148750181501, 4.299694749303112, 7.022292800620947, 6.425480156595538, 2.2383588521995814, 10.934730210604963, 5.353167582247637, 4.355909124256514, 3.679561846588712, 4.214123505591081, 9.607527704059818, 6.8444961436486285, 3.754424420025874, 6.153224133095745, 5.830604713973019, 5.262249400245301, 3.015931480998472, 2.8158090735286625, 7.2164205951878655, 6.828915417460135, 5.94665362200157, -2.3814149356286856, 9.767631676047628, 7.994098121341051, 5.246524763454126, 3.3064823348921126, 7.045275745195324, 3.025657072951859, 2.194021522212797, 9.691805746579185, 5.507913327542613, 5.8747882332466315, 2.649768765455655, 5.213585855789323, 2.798856332805389, 2.567387224578661, 5.375639921875027, 4.273950355954855, 5.329589598497905, 9.848206810351787, 5.515412934856578, 6.191983185389857, 10.261922351904673, 10.505252316288416, 4.620973888056242], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9123798546073134, "mean_inference_ms": 8.009224171912713, "mean_action_processing_ms": 0.5376413591427192, "mean_env_wait_ms": 23.8242249689283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03145241737365723, "StateBufferConnector_ms": 0.02511763572692871, "ViewRequirementAgentConnector_ms": 0.9281783103942871}}, "episode_reward_max": 10.934730210604963, "episode_reward_min": -2.3814149356286856, "episode_reward_mean": 5.52950730179562, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.99049910928522, 6.113809691376455, 5.883279000409264, 7.991100990696599, 5.518478511917628, 5.939093289659136, 6.303589302737479, 4.765286896990447, 4.256324260933051, -1.0869537527782775, 7.6436464313352905, 7.740881950388586, 3.3624523643309168, 9.923960921926218, 2.9271401107138804, 3.686412542339007, 6.370362743728203, 6.716786780978371, 4.513603577523233, -1.2773858478752858, 9.156480344581597, 2.45356452753693, 6.564372099342771, 4.88161616333966, 5.436576098321693, 5.812542859935066, 5.904518001445619, 6.696467676650691, 7.4494210264582605, 6.7149610588506485, 9.366710465597198, 6.273409470588928, 7.655973813262045, 7.679481217590855, 1.2097705038162327, 4.126588206145066, 4.033953657195094, 8.586912911492572, 2.2971413368667988, 7.187593595164558, 4.787966274995731, 4.5628727168360905, 9.586443520819271, 5.7456121179578385, 2.6922745305788043, 6.635526922953059, 2.6605973850945595, -1.5533619327202461, 5.32356300399478, 4.731271348568003, 9.796677572313863, 3.2936842829447333, 9.148147208418528, 7.177722488549763, 4.630271395405884, 5.736148750181501, 4.299694749303112, 7.022292800620947, 6.425480156595538, 2.2383588521995814, 10.934730210604963, 5.353167582247637, 4.355909124256514, 3.679561846588712, 4.214123505591081, 9.607527704059818, 6.8444961436486285, 3.754424420025874, 6.153224133095745, 5.830604713973019, 5.262249400245301, 3.015931480998472, 2.8158090735286625, 7.2164205951878655, 6.828915417460135, 5.94665362200157, -2.3814149356286856, 9.767631676047628, 7.994098121341051, 5.246524763454126, 3.3064823348921126, 7.045275745195324, 3.025657072951859, 2.194021522212797, 9.691805746579185, 5.507913327542613, 5.8747882332466315, 2.649768765455655, 5.213585855789323, 2.798856332805389, 2.567387224578661, 5.375639921875027, 4.273950355954855, 5.329589598497905, 9.848206810351787, 5.515412934856578, 6.191983185389857, 10.261922351904673, 10.505252316288416, 4.620973888056242], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9123798546073134, "mean_inference_ms": 8.009224171912713, "mean_action_processing_ms": 0.5376413591427192, "mean_env_wait_ms": 23.8242249689283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03145241737365723, "StateBufferConnector_ms": 0.02511763572692871, "ViewRequirementAgentConnector_ms": 0.9281783103942871}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6116544, "num_agent_steps_trained": 6116544, "num_env_steps_sampled": 6116544, "num_env_steps_trained": 6116544, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.30765403000197, "num_env_steps_trained_throughput_per_sec": 286.30765403000197, "timesteps_total": 6116544, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6116544, "timers": {"training_iteration_time_ms": 54338.434, "sample_time_ms": 41441.138, "load_time_ms": 1723.902, "load_throughput": 9071.28, "learn_time_ms": 10622.697, "learn_throughput": 1472.131, "synch_weights_time_ms": 425.563}, "counters": {"num_env_steps_sampled": 6116544, "num_env_steps_trained": 6116544, "num_agent_steps_sampled": 6116544, "num_agent_steps_trained": 6116544}, "done": false, "episodes_total": 672, "training_iteration": 396, "trial_id": "2f030_00000", "date": "2025-06-07_08-21-17", "timestamp": 1749277277, "time_this_iter_s": 54.63565373420715, "time_total_s": 2694.5926625728607, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2694.5926625728607, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 78.26129032258066, "ram_util_percent": 65.85806451612903, "gpu_util_percent0": 0.07451612903225807, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.067303225806453e-05, "total_loss": -0.11948179919357327, "policy_loss": -0.03059383990433575, "vf_loss": 0.014792349003255368, "vf_explained_var": 0.7145708301934329, "kl": 0.017228865614597858, "entropy": 20.83773760882291, "entropy_coeff": 0.00506730322580645}, "model": {}, "num_grad_updates_lifetime": 26675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6132182, "num_env_steps_trained": 6132182, "num_agent_steps_sampled": 6132182, "num_agent_steps_trained": 6132182}, "sampler_results": {"episode_reward_max": 10.934730210604963, "episode_reward_min": -2.3814149356286856, "episode_reward_mean": 5.4731696573019875, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.9271401107138804, 3.686412542339007, 6.370362743728203, 6.716786780978371, 4.513603577523233, -1.2773858478752858, 9.156480344581597, 2.45356452753693, 6.564372099342771, 4.88161616333966, 5.436576098321693, 5.812542859935066, 5.904518001445619, 6.696467676650691, 7.4494210264582605, 6.7149610588506485, 9.366710465597198, 6.273409470588928, 7.655973813262045, 7.679481217590855, 1.2097705038162327, 4.126588206145066, 4.033953657195094, 8.586912911492572, 2.2971413368667988, 7.187593595164558, 4.787966274995731, 4.5628727168360905, 9.586443520819271, 5.7456121179578385, 2.6922745305788043, 6.635526922953059, 2.6605973850945595, -1.5533619327202461, 5.32356300399478, 4.731271348568003, 9.796677572313863, 3.2936842829447333, 9.148147208418528, 7.177722488549763, 4.630271395405884, 5.736148750181501, 4.299694749303112, 7.022292800620947, 6.425480156595538, 2.2383588521995814, 10.934730210604963, 5.353167582247637, 4.355909124256514, 3.679561846588712, 4.214123505591081, 9.607527704059818, 6.8444961436486285, 3.754424420025874, 6.153224133095745, 5.830604713973019, 5.262249400245301, 3.015931480998472, 2.8158090735286625, 7.2164205951878655, 6.828915417460135, 5.94665362200157, -2.3814149356286856, 9.767631676047628, 7.994098121341051, 5.246524763454126, 3.3064823348921126, 7.045275745195324, 3.025657072951859, 2.194021522212797, 9.691805746579185, 5.507913327542613, 5.8747882332466315, 2.649768765455655, 5.213585855789323, 2.798856332805389, 2.567387224578661, 5.375639921875027, 4.273950355954855, 5.329589598497905, 9.848206810351787, 5.515412934856578, 6.191983185389857, 10.261922351904673, 10.505252316288416, 4.620973888056242, 7.555511836356364, 5.573163580038878, 4.222348701347125, 3.9257155755763438, 6.889053673517976, 7.575988683000798, 3.3143898561350853, 9.60316167117687, 6.014430660715158, -2.020418299682531, 8.480836876783025, 5.357535472028178, 3.411519952692172, 5.808446280159288], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.909880149862592, "mean_inference_ms": 8.009443008494516, "mean_action_processing_ms": 0.537673497757058, "mean_env_wait_ms": 23.823891549478212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031423330307006836, "StateBufferConnector_ms": 0.030108213424682617, "ViewRequirementAgentConnector_ms": 0.930997371673584}}, "episode_reward_max": 10.934730210604963, "episode_reward_min": -2.3814149356286856, "episode_reward_mean": 5.4731696573019875, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.9271401107138804, 3.686412542339007, 6.370362743728203, 6.716786780978371, 4.513603577523233, -1.2773858478752858, 9.156480344581597, 2.45356452753693, 6.564372099342771, 4.88161616333966, 5.436576098321693, 5.812542859935066, 5.904518001445619, 6.696467676650691, 7.4494210264582605, 6.7149610588506485, 9.366710465597198, 6.273409470588928, 7.655973813262045, 7.679481217590855, 1.2097705038162327, 4.126588206145066, 4.033953657195094, 8.586912911492572, 2.2971413368667988, 7.187593595164558, 4.787966274995731, 4.5628727168360905, 9.586443520819271, 5.7456121179578385, 2.6922745305788043, 6.635526922953059, 2.6605973850945595, -1.5533619327202461, 5.32356300399478, 4.731271348568003, 9.796677572313863, 3.2936842829447333, 9.148147208418528, 7.177722488549763, 4.630271395405884, 5.736148750181501, 4.299694749303112, 7.022292800620947, 6.425480156595538, 2.2383588521995814, 10.934730210604963, 5.353167582247637, 4.355909124256514, 3.679561846588712, 4.214123505591081, 9.607527704059818, 6.8444961436486285, 3.754424420025874, 6.153224133095745, 5.830604713973019, 5.262249400245301, 3.015931480998472, 2.8158090735286625, 7.2164205951878655, 6.828915417460135, 5.94665362200157, -2.3814149356286856, 9.767631676047628, 7.994098121341051, 5.246524763454126, 3.3064823348921126, 7.045275745195324, 3.025657072951859, 2.194021522212797, 9.691805746579185, 5.507913327542613, 5.8747882332466315, 2.649768765455655, 5.213585855789323, 2.798856332805389, 2.567387224578661, 5.375639921875027, 4.273950355954855, 5.329589598497905, 9.848206810351787, 5.515412934856578, 6.191983185389857, 10.261922351904673, 10.505252316288416, 4.620973888056242, 7.555511836356364, 5.573163580038878, 4.222348701347125, 3.9257155755763438, 6.889053673517976, 7.575988683000798, 3.3143898561350853, 9.60316167117687, 6.014430660715158, -2.020418299682531, 8.480836876783025, 5.357535472028178, 3.411519952692172, 5.808446280159288], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.909880149862592, "mean_inference_ms": 8.009443008494516, "mean_action_processing_ms": 0.537673497757058, "mean_env_wait_ms": 23.823891549478212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031423330307006836, "StateBufferConnector_ms": 0.030108213424682617, "ViewRequirementAgentConnector_ms": 0.930997371673584}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6132182, "num_agent_steps_trained": 6132182, "num_env_steps_sampled": 6132182, "num_env_steps_trained": 6132182, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 287.69342721891877, "num_env_steps_trained_throughput_per_sec": 287.69342721891877, "timesteps_total": 6132182, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6132182, "timers": {"training_iteration_time_ms": 54335.279, "sample_time_ms": 41438.951, "load_time_ms": 1718.956, "load_throughput": 9097.381, "learn_time_ms": 10627.25, "learn_throughput": 1471.5, "synch_weights_time_ms": 425.589}, "counters": {"num_env_steps_sampled": 6132182, "num_env_steps_trained": 6132182, "num_agent_steps_sampled": 6132182, "num_agent_steps_trained": 6132182}, "done": false, "episodes_total": 686, "training_iteration": 397, "trial_id": "2f030_00000", "date": "2025-06-07_08-22-12", "timestamp": 1749277332, "time_this_iter_s": 54.371461153030396, "time_total_s": 2748.964123725891, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2748.964123725891, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 76.5, "ram_util_percent": 66.09365079365081, "gpu_util_percent0": 0.08063492063492063, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.0546919354838725e-05, "total_loss": -0.10706860719841313, "policy_loss": -0.018642717223953116, "vf_loss": 0.015269724568352103, "vf_explained_var": 0.7350414806062525, "kl": 0.01754917398414395, "entropy": 20.871759345314718, "entropy_coeff": 0.005054691935483871}, "model": {}, "num_grad_updates_lifetime": 27225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6147820, "num_env_steps_trained": 6147820, "num_agent_steps_sampled": 6147820, "num_agent_steps_trained": 6147820}, "sampler_results": {"episode_reward_max": 10.934730210604963, "episode_reward_min": -2.3814149356286856, "episode_reward_mean": 5.682385335450399, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.4494210264582605, 6.7149610588506485, 9.366710465597198, 6.273409470588928, 7.655973813262045, 7.679481217590855, 1.2097705038162327, 4.126588206145066, 4.033953657195094, 8.586912911492572, 2.2971413368667988, 7.187593595164558, 4.787966274995731, 4.5628727168360905, 9.586443520819271, 5.7456121179578385, 2.6922745305788043, 6.635526922953059, 2.6605973850945595, -1.5533619327202461, 5.32356300399478, 4.731271348568003, 9.796677572313863, 3.2936842829447333, 9.148147208418528, 7.177722488549763, 4.630271395405884, 5.736148750181501, 4.299694749303112, 7.022292800620947, 6.425480156595538, 2.2383588521995814, 10.934730210604963, 5.353167582247637, 4.355909124256514, 3.679561846588712, 4.214123505591081, 9.607527704059818, 6.8444961436486285, 3.754424420025874, 6.153224133095745, 5.830604713973019, 5.262249400245301, 3.015931480998472, 2.8158090735286625, 7.2164205951878655, 6.828915417460135, 5.94665362200157, -2.3814149356286856, 9.767631676047628, 7.994098121341051, 5.246524763454126, 3.3064823348921126, 7.045275745195324, 3.025657072951859, 2.194021522212797, 9.691805746579185, 5.507913327542613, 5.8747882332466315, 2.649768765455655, 5.213585855789323, 2.798856332805389, 2.567387224578661, 5.375639921875027, 4.273950355954855, 5.329589598497905, 9.848206810351787, 5.515412934856578, 6.191983185389857, 10.261922351904673, 10.505252316288416, 4.620973888056242, 7.555511836356364, 5.573163580038878, 4.222348701347125, 3.9257155755763438, 6.889053673517976, 7.575988683000798, 3.3143898561350853, 9.60316167117687, 6.014430660715158, -2.020418299682531, 8.480836876783025, 5.357535472028178, 3.411519952692172, 5.808446280159288, 1.8444686180111063, 9.579864411279074, 2.664999071623152, 7.345530660750043, 6.935277030689847, 4.733379877140197, 9.943538759394716, 7.063367366257758, 7.820171670761397, 4.397919741168424, 8.238467404136896, 8.83382932815154, 4.638008240864384, 6.725803313174127], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9077306928533075, "mean_inference_ms": 8.009302617089586, "mean_action_processing_ms": 0.5377138036644789, "mean_env_wait_ms": 23.82377891309612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031714677810668945, "StateBufferConnector_ms": 0.029070615768432617, "ViewRequirementAgentConnector_ms": 0.9198970794677734}}, "episode_reward_max": 10.934730210604963, "episode_reward_min": -2.3814149356286856, "episode_reward_mean": 5.682385335450399, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.4494210264582605, 6.7149610588506485, 9.366710465597198, 6.273409470588928, 7.655973813262045, 7.679481217590855, 1.2097705038162327, 4.126588206145066, 4.033953657195094, 8.586912911492572, 2.2971413368667988, 7.187593595164558, 4.787966274995731, 4.5628727168360905, 9.586443520819271, 5.7456121179578385, 2.6922745305788043, 6.635526922953059, 2.6605973850945595, -1.5533619327202461, 5.32356300399478, 4.731271348568003, 9.796677572313863, 3.2936842829447333, 9.148147208418528, 7.177722488549763, 4.630271395405884, 5.736148750181501, 4.299694749303112, 7.022292800620947, 6.425480156595538, 2.2383588521995814, 10.934730210604963, 5.353167582247637, 4.355909124256514, 3.679561846588712, 4.214123505591081, 9.607527704059818, 6.8444961436486285, 3.754424420025874, 6.153224133095745, 5.830604713973019, 5.262249400245301, 3.015931480998472, 2.8158090735286625, 7.2164205951878655, 6.828915417460135, 5.94665362200157, -2.3814149356286856, 9.767631676047628, 7.994098121341051, 5.246524763454126, 3.3064823348921126, 7.045275745195324, 3.025657072951859, 2.194021522212797, 9.691805746579185, 5.507913327542613, 5.8747882332466315, 2.649768765455655, 5.213585855789323, 2.798856332805389, 2.567387224578661, 5.375639921875027, 4.273950355954855, 5.329589598497905, 9.848206810351787, 5.515412934856578, 6.191983185389857, 10.261922351904673, 10.505252316288416, 4.620973888056242, 7.555511836356364, 5.573163580038878, 4.222348701347125, 3.9257155755763438, 6.889053673517976, 7.575988683000798, 3.3143898561350853, 9.60316167117687, 6.014430660715158, -2.020418299682531, 8.480836876783025, 5.357535472028178, 3.411519952692172, 5.808446280159288, 1.8444686180111063, 9.579864411279074, 2.664999071623152, 7.345530660750043, 6.935277030689847, 4.733379877140197, 9.943538759394716, 7.063367366257758, 7.820171670761397, 4.397919741168424, 8.238467404136896, 8.83382932815154, 4.638008240864384, 6.725803313174127], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9077306928533075, "mean_inference_ms": 8.009302617089586, "mean_action_processing_ms": 0.5377138036644789, "mean_env_wait_ms": 23.82377891309612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031714677810668945, "StateBufferConnector_ms": 0.029070615768432617, "ViewRequirementAgentConnector_ms": 0.9198970794677734}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6147820, "num_agent_steps_trained": 6147820, "num_env_steps_sampled": 6147820, "num_env_steps_trained": 6147820, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.2170602353685, "num_env_steps_trained_throughput_per_sec": 285.2170602353685, "timesteps_total": 6147820, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6147820, "timers": {"training_iteration_time_ms": 54380.508, "sample_time_ms": 41438.919, "load_time_ms": 1731.107, "load_throughput": 9033.524, "learn_time_ms": 10657.87, "learn_throughput": 1467.273, "synch_weights_time_ms": 428.644}, "counters": {"num_env_steps_sampled": 6147820, "num_env_steps_trained": 6147820, "num_agent_steps_sampled": 6147820, "num_agent_steps_trained": 6147820}, "done": false, "episodes_total": 700, "training_iteration": 398, "trial_id": "2f030_00000", "date": "2025-06-07_08-23-07", "timestamp": 1749277387, "time_this_iter_s": 54.84445381164551, "time_total_s": 2803.8085775375366, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2803.8085775375366, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 77.14032258064519, "ram_util_percent": 66.11290322580646, "gpu_util_percent0": 0.07935483870967744, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.042080645161291e-05, "total_loss": -0.10687407665293325, "policy_loss": -0.019038629425499082, "vf_loss": 0.015754998771643096, "vf_explained_var": 0.7226986636898735, "kl": 0.0183284225232499, "entropy": 20.94575916637074, "entropy_coeff": 0.005042080645161291}, "model": {}, "num_grad_updates_lifetime": 27775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6163458, "num_env_steps_trained": 6163458, "num_agent_steps_sampled": 6163458, "num_agent_steps_trained": 6163458}, "sampler_results": {"episode_reward_max": 10.934730210604963, "episode_reward_min": -2.3814149356286856, "episode_reward_mean": 5.72924513935661, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.586443520819271, 5.7456121179578385, 2.6922745305788043, 6.635526922953059, 2.6605973850945595, -1.5533619327202461, 5.32356300399478, 4.731271348568003, 9.796677572313863, 3.2936842829447333, 9.148147208418528, 7.177722488549763, 4.630271395405884, 5.736148750181501, 4.299694749303112, 7.022292800620947, 6.425480156595538, 2.2383588521995814, 10.934730210604963, 5.353167582247637, 4.355909124256514, 3.679561846588712, 4.214123505591081, 9.607527704059818, 6.8444961436486285, 3.754424420025874, 6.153224133095745, 5.830604713973019, 5.262249400245301, 3.015931480998472, 2.8158090735286625, 7.2164205951878655, 6.828915417460135, 5.94665362200157, -2.3814149356286856, 9.767631676047628, 7.994098121341051, 5.246524763454126, 3.3064823348921126, 7.045275745195324, 3.025657072951859, 2.194021522212797, 9.691805746579185, 5.507913327542613, 5.8747882332466315, 2.649768765455655, 5.213585855789323, 2.798856332805389, 2.567387224578661, 5.375639921875027, 4.273950355954855, 5.329589598497905, 9.848206810351787, 5.515412934856578, 6.191983185389857, 10.261922351904673, 10.505252316288416, 4.620973888056242, 7.555511836356364, 5.573163580038878, 4.222348701347125, 3.9257155755763438, 6.889053673517976, 7.575988683000798, 3.3143898561350853, 9.60316167117687, 6.014430660715158, -2.020418299682531, 8.480836876783025, 5.357535472028178, 3.411519952692172, 5.808446280159288, 1.8444686180111063, 9.579864411279074, 2.664999071623152, 7.345530660750043, 6.935277030689847, 4.733379877140197, 9.943538759394716, 7.063367366257758, 7.820171670761397, 4.397919741168424, 8.238467404136896, 8.83382932815154, 4.638008240864384, 6.725803313174127, 4.436514414961384, 6.461637668965043, 7.6768368727974385, 7.16436144058507, 6.54313155129925, 7.540674173165709, 7.316449386316796, 5.692011675525828, 3.4272577762349443, 5.922104559670359, 4.717501470091862, 9.381943818857605, 6.052806033316382, 4.285505803693462], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.90598192937172, "mean_inference_ms": 8.009757499552606, "mean_action_processing_ms": 0.5377623735720215, "mean_env_wait_ms": 23.82443770597508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03797316551208496, "StateBufferConnector_ms": 0.026566028594970703, "ViewRequirementAgentConnector_ms": 0.9172961711883545}}, "episode_reward_max": 10.934730210604963, "episode_reward_min": -2.3814149356286856, "episode_reward_mean": 5.72924513935661, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.586443520819271, 5.7456121179578385, 2.6922745305788043, 6.635526922953059, 2.6605973850945595, -1.5533619327202461, 5.32356300399478, 4.731271348568003, 9.796677572313863, 3.2936842829447333, 9.148147208418528, 7.177722488549763, 4.630271395405884, 5.736148750181501, 4.299694749303112, 7.022292800620947, 6.425480156595538, 2.2383588521995814, 10.934730210604963, 5.353167582247637, 4.355909124256514, 3.679561846588712, 4.214123505591081, 9.607527704059818, 6.8444961436486285, 3.754424420025874, 6.153224133095745, 5.830604713973019, 5.262249400245301, 3.015931480998472, 2.8158090735286625, 7.2164205951878655, 6.828915417460135, 5.94665362200157, -2.3814149356286856, 9.767631676047628, 7.994098121341051, 5.246524763454126, 3.3064823348921126, 7.045275745195324, 3.025657072951859, 2.194021522212797, 9.691805746579185, 5.507913327542613, 5.8747882332466315, 2.649768765455655, 5.213585855789323, 2.798856332805389, 2.567387224578661, 5.375639921875027, 4.273950355954855, 5.329589598497905, 9.848206810351787, 5.515412934856578, 6.191983185389857, 10.261922351904673, 10.505252316288416, 4.620973888056242, 7.555511836356364, 5.573163580038878, 4.222348701347125, 3.9257155755763438, 6.889053673517976, 7.575988683000798, 3.3143898561350853, 9.60316167117687, 6.014430660715158, -2.020418299682531, 8.480836876783025, 5.357535472028178, 3.411519952692172, 5.808446280159288, 1.8444686180111063, 9.579864411279074, 2.664999071623152, 7.345530660750043, 6.935277030689847, 4.733379877140197, 9.943538759394716, 7.063367366257758, 7.820171670761397, 4.397919741168424, 8.238467404136896, 8.83382932815154, 4.638008240864384, 6.725803313174127, 4.436514414961384, 6.461637668965043, 7.6768368727974385, 7.16436144058507, 6.54313155129925, 7.540674173165709, 7.316449386316796, 5.692011675525828, 3.4272577762349443, 5.922104559670359, 4.717501470091862, 9.381943818857605, 6.052806033316382, 4.285505803693462], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.90598192937172, "mean_inference_ms": 8.009757499552606, "mean_action_processing_ms": 0.5377623735720215, "mean_env_wait_ms": 23.82443770597508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03797316551208496, "StateBufferConnector_ms": 0.026566028594970703, "ViewRequirementAgentConnector_ms": 0.9172961711883545}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6163458, "num_agent_steps_trained": 6163458, "num_env_steps_sampled": 6163458, "num_env_steps_trained": 6163458, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.6235384910638, "num_env_steps_trained_throughput_per_sec": 283.6235384910638, "timesteps_total": 6163458, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6163458, "timers": {"training_iteration_time_ms": 54434.165, "sample_time_ms": 41485.197, "load_time_ms": 1724.755, "load_throughput": 9066.794, "learn_time_ms": 10675.405, "learn_throughput": 1464.862, "synch_weights_time_ms": 426.055}, "counters": {"num_env_steps_sampled": 6163458, "num_env_steps_trained": 6163458, "num_agent_steps_sampled": 6163458, "num_agent_steps_trained": 6163458}, "done": false, "episodes_total": 714, "training_iteration": 399, "trial_id": "2f030_00000", "date": "2025-06-07_08-24-02", "timestamp": 1749277442, "time_this_iter_s": 55.15294051170349, "time_total_s": 2858.96151804924, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2858.96151804924, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 77.984126984127, "ram_util_percent": 66.22698412698414, "gpu_util_percent0": 0.07507936507936509, "vram_util_percent0": 0.8592122395833336}}
{"evaluation": {"sampler_results": {"episode_reward_max": -0.037765630837277575, "episode_reward_min": -7.600440825224407, "episode_reward_mean": -4.143822909118352, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.619504566489115, -7.600440825224407, -5.652028452036415, -0.037765630837277575, -1.8093750710045455], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.454281258509656, "mean_inference_ms": 4.006997244748014, "mean_action_processing_ms": 0.30184081446712074, "mean_env_wait_ms": 10.405291510846082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.04004478454589844, "ViewRequirementAgentConnector_ms": 0.24055957794189453}}, "episode_reward_max": -0.037765630837277575, "episode_reward_min": -7.600440825224407, "episode_reward_mean": -4.143822909118352, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.619504566489115, -7.600440825224407, -5.652028452036415, -0.037765630837277575, -1.8093750710045455], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.454281258509656, "mean_inference_ms": 4.006997244748014, "mean_action_processing_ms": 0.30184081446712074, "mean_env_wait_ms": 10.405291510846082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.04004478454589844, "ViewRequirementAgentConnector_ms": 0.24055957794189453}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.02946935483871e-05, "total_loss": -0.11664462242360142, "policy_loss": -0.028350465165408838, "vf_loss": 0.014927021814510227, "vf_explained_var": 0.7541523650559512, "kl": 0.017745899957892067, "entropy": 20.95764277718284, "entropy_coeff": 0.00502946935483871}, "model": {}, "num_grad_updates_lifetime": 28325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6179096, "num_env_steps_trained": 6179096, "num_agent_steps_sampled": 6179096, "num_agent_steps_trained": 6179096}, "sampler_results": {"episode_reward_max": 10.934730210604963, "episode_reward_min": -2.3814149356286856, "episode_reward_mean": 5.684675257724652, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.299694749303112, 7.022292800620947, 6.425480156595538, 2.2383588521995814, 10.934730210604963, 5.353167582247637, 4.355909124256514, 3.679561846588712, 4.214123505591081, 9.607527704059818, 6.8444961436486285, 3.754424420025874, 6.153224133095745, 5.830604713973019, 5.262249400245301, 3.015931480998472, 2.8158090735286625, 7.2164205951878655, 6.828915417460135, 5.94665362200157, -2.3814149356286856, 9.767631676047628, 7.994098121341051, 5.246524763454126, 3.3064823348921126, 7.045275745195324, 3.025657072951859, 2.194021522212797, 9.691805746579185, 5.507913327542613, 5.8747882332466315, 2.649768765455655, 5.213585855789323, 2.798856332805389, 2.567387224578661, 5.375639921875027, 4.273950355954855, 5.329589598497905, 9.848206810351787, 5.515412934856578, 6.191983185389857, 10.261922351904673, 10.505252316288416, 4.620973888056242, 7.555511836356364, 5.573163580038878, 4.222348701347125, 3.9257155755763438, 6.889053673517976, 7.575988683000798, 3.3143898561350853, 9.60316167117687, 6.014430660715158, -2.020418299682531, 8.480836876783025, 5.357535472028178, 3.411519952692172, 5.808446280159288, 1.8444686180111063, 9.579864411279074, 2.664999071623152, 7.345530660750043, 6.935277030689847, 4.733379877140197, 9.943538759394716, 7.063367366257758, 7.820171670761397, 4.397919741168424, 8.238467404136896, 8.83382932815154, 4.638008240864384, 6.725803313174127, 4.436514414961384, 6.461637668965043, 7.6768368727974385, 7.16436144058507, 6.54313155129925, 7.540674173165709, 7.316449386316796, 5.692011675525828, 3.4272577762349443, 5.922104559670359, 4.717501470091862, 9.381943818857605, 6.052806033316382, 4.285505803693462, 4.223086960779244, 3.572749099235123, 6.160668630538426, 7.8165206542604215, 6.338541924068631, 5.048809961170661, 1.9808729605620286, 5.899768379983788, 4.394798271988679, 3.180426179441853, 6.427253301753625, 7.893507611894342, 3.812440032118853, 4.398146464068756], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9038708305114374, "mean_inference_ms": 8.010453879089516, "mean_action_processing_ms": 0.5377981952995773, "mean_env_wait_ms": 23.826233969617125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032686710357666016, "StateBufferConnector_ms": 0.024574756622314453, "ViewRequirementAgentConnector_ms": 0.935250997543335}}, "episode_reward_max": 10.934730210604963, "episode_reward_min": -2.3814149356286856, "episode_reward_mean": 5.684675257724652, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.299694749303112, 7.022292800620947, 6.425480156595538, 2.2383588521995814, 10.934730210604963, 5.353167582247637, 4.355909124256514, 3.679561846588712, 4.214123505591081, 9.607527704059818, 6.8444961436486285, 3.754424420025874, 6.153224133095745, 5.830604713973019, 5.262249400245301, 3.015931480998472, 2.8158090735286625, 7.2164205951878655, 6.828915417460135, 5.94665362200157, -2.3814149356286856, 9.767631676047628, 7.994098121341051, 5.246524763454126, 3.3064823348921126, 7.045275745195324, 3.025657072951859, 2.194021522212797, 9.691805746579185, 5.507913327542613, 5.8747882332466315, 2.649768765455655, 5.213585855789323, 2.798856332805389, 2.567387224578661, 5.375639921875027, 4.273950355954855, 5.329589598497905, 9.848206810351787, 5.515412934856578, 6.191983185389857, 10.261922351904673, 10.505252316288416, 4.620973888056242, 7.555511836356364, 5.573163580038878, 4.222348701347125, 3.9257155755763438, 6.889053673517976, 7.575988683000798, 3.3143898561350853, 9.60316167117687, 6.014430660715158, -2.020418299682531, 8.480836876783025, 5.357535472028178, 3.411519952692172, 5.808446280159288, 1.8444686180111063, 9.579864411279074, 2.664999071623152, 7.345530660750043, 6.935277030689847, 4.733379877140197, 9.943538759394716, 7.063367366257758, 7.820171670761397, 4.397919741168424, 8.238467404136896, 8.83382932815154, 4.638008240864384, 6.725803313174127, 4.436514414961384, 6.461637668965043, 7.6768368727974385, 7.16436144058507, 6.54313155129925, 7.540674173165709, 7.316449386316796, 5.692011675525828, 3.4272577762349443, 5.922104559670359, 4.717501470091862, 9.381943818857605, 6.052806033316382, 4.285505803693462, 4.223086960779244, 3.572749099235123, 6.160668630538426, 7.8165206542604215, 6.338541924068631, 5.048809961170661, 1.9808729605620286, 5.899768379983788, 4.394798271988679, 3.180426179441853, 6.427253301753625, 7.893507611894342, 3.812440032118853, 4.398146464068756], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9038708305114374, "mean_inference_ms": 8.010453879089516, "mean_action_processing_ms": 0.5377981952995773, "mean_env_wait_ms": 23.826233969617125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032686710357666016, "StateBufferConnector_ms": 0.024574756622314453, "ViewRequirementAgentConnector_ms": 0.935250997543335}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6179096, "num_agent_steps_trained": 6179096, "num_env_steps_sampled": 6179096, "num_env_steps_trained": 6179096, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.6661571139006, "num_env_steps_trained_throughput_per_sec": 286.6661571139006, "timesteps_total": 6179096, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6179096, "timers": {"training_iteration_time_ms": 54444.073, "sample_time_ms": 41478.552, "load_time_ms": 1731.017, "load_throughput": 9033.998, "learn_time_ms": 10681.653, "learn_throughput": 1464.006, "synch_weights_time_ms": 430.204}, "counters": {"num_env_steps_sampled": 6179096, "num_env_steps_trained": 6179096, "num_agent_steps_sampled": 6179096, "num_agent_steps_trained": 6179096}, "done": false, "episodes_total": 728, "training_iteration": 400, "trial_id": "2f030_00000", "date": "2025-06-07_08-25-11", "timestamp": 1749277511, "time_this_iter_s": 69.29610776901245, "time_total_s": 2928.2576258182526, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2928.2576258182526, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 64.75555555555556, "ram_util_percent": 65.90370370370368, "gpu_util_percent0": 0.06444444444444444, "vram_util_percent0": 0.8592122395833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.0168580645161304e-05, "total_loss": -0.11132442474365234, "policy_loss": -0.022247379610621877, "vf_loss": 0.015025594888085669, "vf_explained_var": 0.7286333959752863, "kl": 0.016983553581839343, "entropy": 21.064090576171875, "entropy_coeff": 0.0050168580645161285}, "model": {}, "num_grad_updates_lifetime": 28875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6194734, "num_env_steps_trained": 6194734, "num_agent_steps_sampled": 6194734, "num_agent_steps_trained": 6194734}, "sampler_results": {"episode_reward_max": 10.505252316288416, "episode_reward_min": -3.9351595991405697, "episode_reward_mean": 5.403943898900379, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.262249400245301, 3.015931480998472, 2.8158090735286625, 7.2164205951878655, 6.828915417460135, 5.94665362200157, -2.3814149356286856, 9.767631676047628, 7.994098121341051, 5.246524763454126, 3.3064823348921126, 7.045275745195324, 3.025657072951859, 2.194021522212797, 9.691805746579185, 5.507913327542613, 5.8747882332466315, 2.649768765455655, 5.213585855789323, 2.798856332805389, 2.567387224578661, 5.375639921875027, 4.273950355954855, 5.329589598497905, 9.848206810351787, 5.515412934856578, 6.191983185389857, 10.261922351904673, 10.505252316288416, 4.620973888056242, 7.555511836356364, 5.573163580038878, 4.222348701347125, 3.9257155755763438, 6.889053673517976, 7.575988683000798, 3.3143898561350853, 9.60316167117687, 6.014430660715158, -2.020418299682531, 8.480836876783025, 5.357535472028178, 3.411519952692172, 5.808446280159288, 1.8444686180111063, 9.579864411279074, 2.664999071623152, 7.345530660750043, 6.935277030689847, 4.733379877140197, 9.943538759394716, 7.063367366257758, 7.820171670761397, 4.397919741168424, 8.238467404136896, 8.83382932815154, 4.638008240864384, 6.725803313174127, 4.436514414961384, 6.461637668965043, 7.6768368727974385, 7.16436144058507, 6.54313155129925, 7.540674173165709, 7.316449386316796, 5.692011675525828, 3.4272577762349443, 5.922104559670359, 4.717501470091862, 9.381943818857605, 6.052806033316382, 4.285505803693462, 4.223086960779244, 3.572749099235123, 6.160668630538426, 7.8165206542604215, 6.338541924068631, 5.048809961170661, 1.9808729605620286, 5.899768379983788, 4.394798271988679, 3.180426179441853, 6.427253301753625, 7.893507611894342, 3.812440032118853, 4.398146464068756, 3.6743104646390217, -3.9351595991405697, 3.8051448122087685, 1.199993821362167, -0.6005393280512271, 8.303469796694218, 4.350778839478319, 3.9920139373729184, 3.7232892538097713, 5.0771549724324965, 4.712837387661763, 9.118312842849656, 4.2331095204979805, 4.985743338568561], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9016462774139837, "mean_inference_ms": 8.01159142091098, "mean_action_processing_ms": 0.5378566087972668, "mean_env_wait_ms": 23.82911045720366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03171539306640625, "StateBufferConnector_ms": 0.021598100662231445, "ViewRequirementAgentConnector_ms": 0.91070556640625}}, "episode_reward_max": 10.505252316288416, "episode_reward_min": -3.9351595991405697, "episode_reward_mean": 5.403943898900379, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.262249400245301, 3.015931480998472, 2.8158090735286625, 7.2164205951878655, 6.828915417460135, 5.94665362200157, -2.3814149356286856, 9.767631676047628, 7.994098121341051, 5.246524763454126, 3.3064823348921126, 7.045275745195324, 3.025657072951859, 2.194021522212797, 9.691805746579185, 5.507913327542613, 5.8747882332466315, 2.649768765455655, 5.213585855789323, 2.798856332805389, 2.567387224578661, 5.375639921875027, 4.273950355954855, 5.329589598497905, 9.848206810351787, 5.515412934856578, 6.191983185389857, 10.261922351904673, 10.505252316288416, 4.620973888056242, 7.555511836356364, 5.573163580038878, 4.222348701347125, 3.9257155755763438, 6.889053673517976, 7.575988683000798, 3.3143898561350853, 9.60316167117687, 6.014430660715158, -2.020418299682531, 8.480836876783025, 5.357535472028178, 3.411519952692172, 5.808446280159288, 1.8444686180111063, 9.579864411279074, 2.664999071623152, 7.345530660750043, 6.935277030689847, 4.733379877140197, 9.943538759394716, 7.063367366257758, 7.820171670761397, 4.397919741168424, 8.238467404136896, 8.83382932815154, 4.638008240864384, 6.725803313174127, 4.436514414961384, 6.461637668965043, 7.6768368727974385, 7.16436144058507, 6.54313155129925, 7.540674173165709, 7.316449386316796, 5.692011675525828, 3.4272577762349443, 5.922104559670359, 4.717501470091862, 9.381943818857605, 6.052806033316382, 4.285505803693462, 4.223086960779244, 3.572749099235123, 6.160668630538426, 7.8165206542604215, 6.338541924068631, 5.048809961170661, 1.9808729605620286, 5.899768379983788, 4.394798271988679, 3.180426179441853, 6.427253301753625, 7.893507611894342, 3.812440032118853, 4.398146464068756, 3.6743104646390217, -3.9351595991405697, 3.8051448122087685, 1.199993821362167, -0.6005393280512271, 8.303469796694218, 4.350778839478319, 3.9920139373729184, 3.7232892538097713, 5.0771549724324965, 4.712837387661763, 9.118312842849656, 4.2331095204979805, 4.985743338568561], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9016462774139837, "mean_inference_ms": 8.01159142091098, "mean_action_processing_ms": 0.5378566087972668, "mean_env_wait_ms": 23.82911045720366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03171539306640625, "StateBufferConnector_ms": 0.021598100662231445, "ViewRequirementAgentConnector_ms": 0.91070556640625}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6194734, "num_agent_steps_trained": 6194734, "num_env_steps_sampled": 6194734, "num_env_steps_trained": 6194734, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.50532540069537, "num_env_steps_trained_throughput_per_sec": 286.50532540069537, "timesteps_total": 6194734, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6194734, "timers": {"training_iteration_time_ms": 54444.345, "sample_time_ms": 41480.972, "load_time_ms": 1721.866, "load_throughput": 9082.006, "learn_time_ms": 10687.826, "learn_throughput": 1463.16, "synch_weights_time_ms": 428.29}, "counters": {"num_env_steps_sampled": 6194734, "num_env_steps_trained": 6194734, "num_agent_steps_sampled": 6194734, "num_agent_steps_trained": 6194734}, "done": false, "episodes_total": 742, "training_iteration": 401, "trial_id": "2f030_00000", "date": "2025-06-07_08-26-06", "timestamp": 1749277566, "time_this_iter_s": 54.59903693199158, "time_total_s": 2982.856662750244, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2982.856662750244, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 77.14603174603175, "ram_util_percent": 66.08888888888886, "gpu_util_percent0": 0.07714285714285715, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 5.004246774193549e-05, "total_loss": -0.10337440378752283, "policy_loss": -0.015804880784694848, "vf_loss": 0.015468155445361679, "vf_explained_var": 0.7142458513650027, "kl": 0.017715801140100445, "entropy": 20.946628499464556, "entropy_coeff": 0.005004246774193547}, "model": {}, "num_grad_updates_lifetime": 29425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6210372, "num_env_steps_trained": 6210372, "num_agent_steps_sampled": 6210372, "num_agent_steps_trained": 6210372}, "sampler_results": {"episode_reward_max": 10.505252316288416, "episode_reward_min": -3.9351595991405697, "episode_reward_mean": 5.554776781343801, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.691805746579185, 5.507913327542613, 5.8747882332466315, 2.649768765455655, 5.213585855789323, 2.798856332805389, 2.567387224578661, 5.375639921875027, 4.273950355954855, 5.329589598497905, 9.848206810351787, 5.515412934856578, 6.191983185389857, 10.261922351904673, 10.505252316288416, 4.620973888056242, 7.555511836356364, 5.573163580038878, 4.222348701347125, 3.9257155755763438, 6.889053673517976, 7.575988683000798, 3.3143898561350853, 9.60316167117687, 6.014430660715158, -2.020418299682531, 8.480836876783025, 5.357535472028178, 3.411519952692172, 5.808446280159288, 1.8444686180111063, 9.579864411279074, 2.664999071623152, 7.345530660750043, 6.935277030689847, 4.733379877140197, 9.943538759394716, 7.063367366257758, 7.820171670761397, 4.397919741168424, 8.238467404136896, 8.83382932815154, 4.638008240864384, 6.725803313174127, 4.436514414961384, 6.461637668965043, 7.6768368727974385, 7.16436144058507, 6.54313155129925, 7.540674173165709, 7.316449386316796, 5.692011675525828, 3.4272577762349443, 5.922104559670359, 4.717501470091862, 9.381943818857605, 6.052806033316382, 4.285505803693462, 4.223086960779244, 3.572749099235123, 6.160668630538426, 7.8165206542604215, 6.338541924068631, 5.048809961170661, 1.9808729605620286, 5.899768379983788, 4.394798271988679, 3.180426179441853, 6.427253301753625, 7.893507611894342, 3.812440032118853, 4.398146464068756, 3.6743104646390217, -3.9351595991405697, 3.8051448122087685, 1.199993821362167, -0.6005393280512271, 8.303469796694218, 4.350778839478319, 3.9920139373729184, 3.7232892538097713, 5.0771549724324965, 4.712837387661763, 9.118312842849656, 4.2331095204979805, 4.985743338568561, 7.868984621963809, 9.508225851299143, 7.833028775253252, 7.553149781456243, 4.355583710551816, 4.314192793838881, 7.326927887820128, 5.481182907455046, 6.381185380778163, 0.2983480568024052, 7.950388674361479, 4.724910710597677, 4.236188959873626, 4.535246022178754], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8999558539654533, "mean_inference_ms": 8.012943947990822, "mean_action_processing_ms": 0.5379651971405697, "mean_env_wait_ms": 23.832936556466848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031668901443481445, "StateBufferConnector_ms": 0.020581483840942383, "ViewRequirementAgentConnector_ms": 0.9307050704956055}}, "episode_reward_max": 10.505252316288416, "episode_reward_min": -3.9351595991405697, "episode_reward_mean": 5.554776781343801, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.691805746579185, 5.507913327542613, 5.8747882332466315, 2.649768765455655, 5.213585855789323, 2.798856332805389, 2.567387224578661, 5.375639921875027, 4.273950355954855, 5.329589598497905, 9.848206810351787, 5.515412934856578, 6.191983185389857, 10.261922351904673, 10.505252316288416, 4.620973888056242, 7.555511836356364, 5.573163580038878, 4.222348701347125, 3.9257155755763438, 6.889053673517976, 7.575988683000798, 3.3143898561350853, 9.60316167117687, 6.014430660715158, -2.020418299682531, 8.480836876783025, 5.357535472028178, 3.411519952692172, 5.808446280159288, 1.8444686180111063, 9.579864411279074, 2.664999071623152, 7.345530660750043, 6.935277030689847, 4.733379877140197, 9.943538759394716, 7.063367366257758, 7.820171670761397, 4.397919741168424, 8.238467404136896, 8.83382932815154, 4.638008240864384, 6.725803313174127, 4.436514414961384, 6.461637668965043, 7.6768368727974385, 7.16436144058507, 6.54313155129925, 7.540674173165709, 7.316449386316796, 5.692011675525828, 3.4272577762349443, 5.922104559670359, 4.717501470091862, 9.381943818857605, 6.052806033316382, 4.285505803693462, 4.223086960779244, 3.572749099235123, 6.160668630538426, 7.8165206542604215, 6.338541924068631, 5.048809961170661, 1.9808729605620286, 5.899768379983788, 4.394798271988679, 3.180426179441853, 6.427253301753625, 7.893507611894342, 3.812440032118853, 4.398146464068756, 3.6743104646390217, -3.9351595991405697, 3.8051448122087685, 1.199993821362167, -0.6005393280512271, 8.303469796694218, 4.350778839478319, 3.9920139373729184, 3.7232892538097713, 5.0771549724324965, 4.712837387661763, 9.118312842849656, 4.2331095204979805, 4.985743338568561, 7.868984621963809, 9.508225851299143, 7.833028775253252, 7.553149781456243, 4.355583710551816, 4.314192793838881, 7.326927887820128, 5.481182907455046, 6.381185380778163, 0.2983480568024052, 7.950388674361479, 4.724910710597677, 4.236188959873626, 4.535246022178754], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8999558539654533, "mean_inference_ms": 8.012943947990822, "mean_action_processing_ms": 0.5379651971405697, "mean_env_wait_ms": 23.832936556466848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031668901443481445, "StateBufferConnector_ms": 0.020581483840942383, "ViewRequirementAgentConnector_ms": 0.9307050704956055}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6210372, "num_agent_steps_trained": 6210372, "num_env_steps_sampled": 6210372, "num_env_steps_trained": 6210372, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.58490282909, "num_env_steps_trained_throughput_per_sec": 285.58490282909, "timesteps_total": 6210372, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6210372, "timers": {"training_iteration_time_ms": 54485.492, "sample_time_ms": 41533.272, "load_time_ms": 1708.047, "load_throughput": 9155.486, "learn_time_ms": 10695.073, "learn_throughput": 1462.169, "synch_weights_time_ms": 424.823}, "counters": {"num_env_steps_sampled": 6210372, "num_env_steps_trained": 6210372, "num_agent_steps_sampled": 6210372, "num_agent_steps_trained": 6210372}, "done": false, "episodes_total": 756, "training_iteration": 402, "trial_id": "2f030_00000", "date": "2025-06-07_08-27-01", "timestamp": 1749277621, "time_this_iter_s": 54.77578258514404, "time_total_s": 3037.632445335388, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3037.632445335388, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 78.21935483870968, "ram_util_percent": 66.36451612903228, "gpu_util_percent0": 0.0785483870967742, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.9918115789473684e-05, "total_loss": -0.11021370301361788, "policy_loss": -0.023688282334161075, "vf_loss": 0.014653063689951193, "vf_explained_var": 0.7034041487086903, "kl": 0.017938518390468366, "entropy": 20.900993300351228, "entropy_coeff": 0.004961105}, "model": {}, "num_grad_updates_lifetime": 29975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6226010, "num_env_steps_trained": 6226010, "num_agent_steps_sampled": 6226010, "num_agent_steps_trained": 6226010}, "sampler_results": {"episode_reward_max": 10.505252316288416, "episode_reward_min": -3.9351595991405697, "episode_reward_mean": 5.53193911427891, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.505252316288416, 4.620973888056242, 7.555511836356364, 5.573163580038878, 4.222348701347125, 3.9257155755763438, 6.889053673517976, 7.575988683000798, 3.3143898561350853, 9.60316167117687, 6.014430660715158, -2.020418299682531, 8.480836876783025, 5.357535472028178, 3.411519952692172, 5.808446280159288, 1.8444686180111063, 9.579864411279074, 2.664999071623152, 7.345530660750043, 6.935277030689847, 4.733379877140197, 9.943538759394716, 7.063367366257758, 7.820171670761397, 4.397919741168424, 8.238467404136896, 8.83382932815154, 4.638008240864384, 6.725803313174127, 4.436514414961384, 6.461637668965043, 7.6768368727974385, 7.16436144058507, 6.54313155129925, 7.540674173165709, 7.316449386316796, 5.692011675525828, 3.4272577762349443, 5.922104559670359, 4.717501470091862, 9.381943818857605, 6.052806033316382, 4.285505803693462, 4.223086960779244, 3.572749099235123, 6.160668630538426, 7.8165206542604215, 6.338541924068631, 5.048809961170661, 1.9808729605620286, 5.899768379983788, 4.394798271988679, 3.180426179441853, 6.427253301753625, 7.893507611894342, 3.812440032118853, 4.398146464068756, 3.6743104646390217, -3.9351595991405697, 3.8051448122087685, 1.199993821362167, -0.6005393280512271, 8.303469796694218, 4.350778839478319, 3.9920139373729184, 3.7232892538097713, 5.0771549724324965, 4.712837387661763, 9.118312842849656, 4.2331095204979805, 4.985743338568561, 7.868984621963809, 9.508225851299143, 7.833028775253252, 7.553149781456243, 4.355583710551816, 4.314192793838881, 7.326927887820128, 5.481182907455046, 6.381185380778163, 0.2983480568024052, 7.950388674361479, 4.724910710597677, 4.236188959873626, 4.535246022178754, 2.6810022884085174, 4.92876062111496, 10.378532139290451, 7.691124646655258, 5.33518519033429, 1.2275584190677546, 4.690632167386376, 6.885289462426973, 3.687189945754907, 7.449265942546631, 6.179915496564275, 6.0612041551725895, 5.190234395777278, 6.431149067838992], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8985334589190104, "mean_inference_ms": 8.01408522992131, "mean_action_processing_ms": 0.53804513049391, "mean_env_wait_ms": 23.835763706711187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03255581855773926, "StateBufferConnector_ms": 0.0215756893157959, "ViewRequirementAgentConnector_ms": 0.9558625221252441}}, "episode_reward_max": 10.505252316288416, "episode_reward_min": -3.9351595991405697, "episode_reward_mean": 5.53193911427891, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.505252316288416, 4.620973888056242, 7.555511836356364, 5.573163580038878, 4.222348701347125, 3.9257155755763438, 6.889053673517976, 7.575988683000798, 3.3143898561350853, 9.60316167117687, 6.014430660715158, -2.020418299682531, 8.480836876783025, 5.357535472028178, 3.411519952692172, 5.808446280159288, 1.8444686180111063, 9.579864411279074, 2.664999071623152, 7.345530660750043, 6.935277030689847, 4.733379877140197, 9.943538759394716, 7.063367366257758, 7.820171670761397, 4.397919741168424, 8.238467404136896, 8.83382932815154, 4.638008240864384, 6.725803313174127, 4.436514414961384, 6.461637668965043, 7.6768368727974385, 7.16436144058507, 6.54313155129925, 7.540674173165709, 7.316449386316796, 5.692011675525828, 3.4272577762349443, 5.922104559670359, 4.717501470091862, 9.381943818857605, 6.052806033316382, 4.285505803693462, 4.223086960779244, 3.572749099235123, 6.160668630538426, 7.8165206542604215, 6.338541924068631, 5.048809961170661, 1.9808729605620286, 5.899768379983788, 4.394798271988679, 3.180426179441853, 6.427253301753625, 7.893507611894342, 3.812440032118853, 4.398146464068756, 3.6743104646390217, -3.9351595991405697, 3.8051448122087685, 1.199993821362167, -0.6005393280512271, 8.303469796694218, 4.350778839478319, 3.9920139373729184, 3.7232892538097713, 5.0771549724324965, 4.712837387661763, 9.118312842849656, 4.2331095204979805, 4.985743338568561, 7.868984621963809, 9.508225851299143, 7.833028775253252, 7.553149781456243, 4.355583710551816, 4.314192793838881, 7.326927887820128, 5.481182907455046, 6.381185380778163, 0.2983480568024052, 7.950388674361479, 4.724910710597677, 4.236188959873626, 4.535246022178754, 2.6810022884085174, 4.92876062111496, 10.378532139290451, 7.691124646655258, 5.33518519033429, 1.2275584190677546, 4.690632167386376, 6.885289462426973, 3.687189945754907, 7.449265942546631, 6.179915496564275, 6.0612041551725895, 5.190234395777278, 6.431149067838992], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8985334589190104, "mean_inference_ms": 8.01408522992131, "mean_action_processing_ms": 0.53804513049391, "mean_env_wait_ms": 23.835763706711187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03255581855773926, "StateBufferConnector_ms": 0.0215756893157959, "ViewRequirementAgentConnector_ms": 0.9558625221252441}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6226010, "num_agent_steps_trained": 6226010, "num_env_steps_sampled": 6226010, "num_env_steps_trained": 6226010, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 289.3432763690587, "num_env_steps_trained_throughput_per_sec": 289.3432763690587, "timesteps_total": 6226010, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6226010, "timers": {"training_iteration_time_ms": 54502.523, "sample_time_ms": 41532.261, "load_time_ms": 1712.593, "load_throughput": 9131.185, "learn_time_ms": 10709.966, "learn_throughput": 1460.135, "synch_weights_time_ms": 427.189}, "counters": {"num_env_steps_sampled": 6226010, "num_env_steps_trained": 6226010, "num_agent_steps_sampled": 6226010, "num_agent_steps_trained": 6226010}, "done": false, "episodes_total": 770, "training_iteration": 403, "trial_id": "2f030_00000", "date": "2025-06-07_08-27-55", "timestamp": 1749277675, "time_this_iter_s": 54.06350326538086, "time_total_s": 3091.695948600769, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3091.695948600769, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 77.14838709677419, "ram_util_percent": 66.7048387096774, "gpu_util_percent0": 0.07951612903225808, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.9794657894736835e-05, "total_loss": -0.09827948772687126, "policy_loss": -0.012464766353686256, "vf_loss": 0.014839311877942898, "vf_explained_var": 0.7225155533443798, "kl": 0.01718742284798146, "entropy": 20.908366723494098, "entropy_coeff": 0.0049024625}, "model": {}, "num_grad_updates_lifetime": 30525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6241648, "num_env_steps_trained": 6241648, "num_agent_steps_sampled": 6241648, "num_agent_steps_trained": 6241648}, "sampler_results": {"episode_reward_max": 10.378532139290451, "episode_reward_min": -3.9351595991405697, "episode_reward_mean": 5.505701826592392, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.411519952692172, 5.808446280159288, 1.8444686180111063, 9.579864411279074, 2.664999071623152, 7.345530660750043, 6.935277030689847, 4.733379877140197, 9.943538759394716, 7.063367366257758, 7.820171670761397, 4.397919741168424, 8.238467404136896, 8.83382932815154, 4.638008240864384, 6.725803313174127, 4.436514414961384, 6.461637668965043, 7.6768368727974385, 7.16436144058507, 6.54313155129925, 7.540674173165709, 7.316449386316796, 5.692011675525828, 3.4272577762349443, 5.922104559670359, 4.717501470091862, 9.381943818857605, 6.052806033316382, 4.285505803693462, 4.223086960779244, 3.572749099235123, 6.160668630538426, 7.8165206542604215, 6.338541924068631, 5.048809961170661, 1.9808729605620286, 5.899768379983788, 4.394798271988679, 3.180426179441853, 6.427253301753625, 7.893507611894342, 3.812440032118853, 4.398146464068756, 3.6743104646390217, -3.9351595991405697, 3.8051448122087685, 1.199993821362167, -0.6005393280512271, 8.303469796694218, 4.350778839478319, 3.9920139373729184, 3.7232892538097713, 5.0771549724324965, 4.712837387661763, 9.118312842849656, 4.2331095204979805, 4.985743338568561, 7.868984621963809, 9.508225851299143, 7.833028775253252, 7.553149781456243, 4.355583710551816, 4.314192793838881, 7.326927887820128, 5.481182907455046, 6.381185380778163, 0.2983480568024052, 7.950388674361479, 4.724910710597677, 4.236188959873626, 4.535246022178754, 2.6810022884085174, 4.92876062111496, 10.378532139290451, 7.691124646655258, 5.33518519033429, 1.2275584190677546, 4.690632167386376, 6.885289462426973, 3.687189945754907, 7.449265942546631, 6.179915496564275, 6.0612041551725895, 5.190234395777278, 6.431149067838992, 5.750885386706607, 8.2047508437625, 4.91282032529817, 4.273948852684534, 5.827231082614661, 3.1063674944253012, 7.406022769337717, 7.946921029696854, 3.650476245170073, 7.802243812845591, 3.8365059971420554, 7.234906756833263, 5.034803823253383, 4.006331302915275], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.897515908064906, "mean_inference_ms": 8.01512770993233, "mean_action_processing_ms": 0.538097538486088, "mean_env_wait_ms": 23.83813405494258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03951621055603027, "StateBufferConnector_ms": 0.02151775360107422, "ViewRequirementAgentConnector_ms": 0.9291069507598877}}, "episode_reward_max": 10.378532139290451, "episode_reward_min": -3.9351595991405697, "episode_reward_mean": 5.505701826592392, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.411519952692172, 5.808446280159288, 1.8444686180111063, 9.579864411279074, 2.664999071623152, 7.345530660750043, 6.935277030689847, 4.733379877140197, 9.943538759394716, 7.063367366257758, 7.820171670761397, 4.397919741168424, 8.238467404136896, 8.83382932815154, 4.638008240864384, 6.725803313174127, 4.436514414961384, 6.461637668965043, 7.6768368727974385, 7.16436144058507, 6.54313155129925, 7.540674173165709, 7.316449386316796, 5.692011675525828, 3.4272577762349443, 5.922104559670359, 4.717501470091862, 9.381943818857605, 6.052806033316382, 4.285505803693462, 4.223086960779244, 3.572749099235123, 6.160668630538426, 7.8165206542604215, 6.338541924068631, 5.048809961170661, 1.9808729605620286, 5.899768379983788, 4.394798271988679, 3.180426179441853, 6.427253301753625, 7.893507611894342, 3.812440032118853, 4.398146464068756, 3.6743104646390217, -3.9351595991405697, 3.8051448122087685, 1.199993821362167, -0.6005393280512271, 8.303469796694218, 4.350778839478319, 3.9920139373729184, 3.7232892538097713, 5.0771549724324965, 4.712837387661763, 9.118312842849656, 4.2331095204979805, 4.985743338568561, 7.868984621963809, 9.508225851299143, 7.833028775253252, 7.553149781456243, 4.355583710551816, 4.314192793838881, 7.326927887820128, 5.481182907455046, 6.381185380778163, 0.2983480568024052, 7.950388674361479, 4.724910710597677, 4.236188959873626, 4.535246022178754, 2.6810022884085174, 4.92876062111496, 10.378532139290451, 7.691124646655258, 5.33518519033429, 1.2275584190677546, 4.690632167386376, 6.885289462426973, 3.687189945754907, 7.449265942546631, 6.179915496564275, 6.0612041551725895, 5.190234395777278, 6.431149067838992, 5.750885386706607, 8.2047508437625, 4.91282032529817, 4.273948852684534, 5.827231082614661, 3.1063674944253012, 7.406022769337717, 7.946921029696854, 3.650476245170073, 7.802243812845591, 3.8365059971420554, 7.234906756833263, 5.034803823253383, 4.006331302915275], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.897515908064906, "mean_inference_ms": 8.01512770993233, "mean_action_processing_ms": 0.538097538486088, "mean_env_wait_ms": 23.83813405494258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03951621055603027, "StateBufferConnector_ms": 0.02151775360107422, "ViewRequirementAgentConnector_ms": 0.9291069507598877}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6241648, "num_agent_steps_trained": 6241648, "num_env_steps_sampled": 6241648, "num_env_steps_trained": 6241648, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 288.9904031898856, "num_env_steps_trained_throughput_per_sec": 288.9904031898856, "timesteps_total": 6241648, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6241648, "timers": {"training_iteration_time_ms": 54527.236, "sample_time_ms": 41557.283, "load_time_ms": 1709.899, "load_throughput": 9145.572, "learn_time_ms": 10710.298, "learn_throughput": 1460.09, "synch_weights_time_ms": 432.703}, "counters": {"num_env_steps_sampled": 6241648, "num_env_steps_trained": 6241648, "num_agent_steps_sampled": 6241648, "num_agent_steps_trained": 6241648}, "done": false, "episodes_total": 784, "training_iteration": 404, "trial_id": "2f030_00000", "date": "2025-06-07_08-28-49", "timestamp": 1749277729, "time_this_iter_s": 54.128483295440674, "time_total_s": 3145.8244318962097, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3145.8244318962097, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 77.25645161290323, "ram_util_percent": 66.54193548387097, "gpu_util_percent0": 0.07822580645161291, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.96712e-05, "total_loss": -0.11131489620036022, "policy_loss": -0.02656161894418553, "vf_loss": 0.014464076178317721, "vf_explained_var": 0.7243857643821022, "kl": 0.016759343136343245, "entropy": 20.856207842393356, "entropy_coeff": 0.0048438199999999995}, "model": {}, "num_grad_updates_lifetime": 31075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6257286, "num_env_steps_trained": 6257286, "num_agent_steps_sampled": 6257286, "num_agent_steps_trained": 6257286}, "sampler_results": {"episode_reward_max": 11.353064531550016, "episode_reward_min": -3.9351595991405697, "episode_reward_mean": 5.60044684343722, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.638008240864384, 6.725803313174127, 4.436514414961384, 6.461637668965043, 7.6768368727974385, 7.16436144058507, 6.54313155129925, 7.540674173165709, 7.316449386316796, 5.692011675525828, 3.4272577762349443, 5.922104559670359, 4.717501470091862, 9.381943818857605, 6.052806033316382, 4.285505803693462, 4.223086960779244, 3.572749099235123, 6.160668630538426, 7.8165206542604215, 6.338541924068631, 5.048809961170661, 1.9808729605620286, 5.899768379983788, 4.394798271988679, 3.180426179441853, 6.427253301753625, 7.893507611894342, 3.812440032118853, 4.398146464068756, 3.6743104646390217, -3.9351595991405697, 3.8051448122087685, 1.199993821362167, -0.6005393280512271, 8.303469796694218, 4.350778839478319, 3.9920139373729184, 3.7232892538097713, 5.0771549724324965, 4.712837387661763, 9.118312842849656, 4.2331095204979805, 4.985743338568561, 7.868984621963809, 9.508225851299143, 7.833028775253252, 7.553149781456243, 4.355583710551816, 4.314192793838881, 7.326927887820128, 5.481182907455046, 6.381185380778163, 0.2983480568024052, 7.950388674361479, 4.724910710597677, 4.236188959873626, 4.535246022178754, 2.6810022884085174, 4.92876062111496, 10.378532139290451, 7.691124646655258, 5.33518519033429, 1.2275584190677546, 4.690632167386376, 6.885289462426973, 3.687189945754907, 7.449265942546631, 6.179915496564275, 6.0612041551725895, 5.190234395777278, 6.431149067838992, 5.750885386706607, 8.2047508437625, 4.91282032529817, 4.273948852684534, 5.827231082614661, 3.1063674944253012, 7.406022769337717, 7.946921029696854, 3.650476245170073, 7.802243812845591, 3.8365059971420554, 7.234906756833263, 5.034803823253383, 4.006331302915275, 6.153802067807718, 6.63794450504591, 8.121884664980865, 7.6137651103901325, 6.068670241430688, 7.444921278409786, 6.652613007587312, 11.353064531550016, 7.891426061467812, 6.264252160075015, 7.545387280940594, 3.97729493397021, 6.61976018135003, 5.750495831692176], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.896487341009487, "mean_inference_ms": 8.015973555166841, "mean_action_processing_ms": 0.5381161662926573, "mean_env_wait_ms": 23.840542179584716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038982391357421875, "StateBufferConnector_ms": 0.025485992431640625, "ViewRequirementAgentConnector_ms": 0.9471206665039062}}, "episode_reward_max": 11.353064531550016, "episode_reward_min": -3.9351595991405697, "episode_reward_mean": 5.60044684343722, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.638008240864384, 6.725803313174127, 4.436514414961384, 6.461637668965043, 7.6768368727974385, 7.16436144058507, 6.54313155129925, 7.540674173165709, 7.316449386316796, 5.692011675525828, 3.4272577762349443, 5.922104559670359, 4.717501470091862, 9.381943818857605, 6.052806033316382, 4.285505803693462, 4.223086960779244, 3.572749099235123, 6.160668630538426, 7.8165206542604215, 6.338541924068631, 5.048809961170661, 1.9808729605620286, 5.899768379983788, 4.394798271988679, 3.180426179441853, 6.427253301753625, 7.893507611894342, 3.812440032118853, 4.398146464068756, 3.6743104646390217, -3.9351595991405697, 3.8051448122087685, 1.199993821362167, -0.6005393280512271, 8.303469796694218, 4.350778839478319, 3.9920139373729184, 3.7232892538097713, 5.0771549724324965, 4.712837387661763, 9.118312842849656, 4.2331095204979805, 4.985743338568561, 7.868984621963809, 9.508225851299143, 7.833028775253252, 7.553149781456243, 4.355583710551816, 4.314192793838881, 7.326927887820128, 5.481182907455046, 6.381185380778163, 0.2983480568024052, 7.950388674361479, 4.724910710597677, 4.236188959873626, 4.535246022178754, 2.6810022884085174, 4.92876062111496, 10.378532139290451, 7.691124646655258, 5.33518519033429, 1.2275584190677546, 4.690632167386376, 6.885289462426973, 3.687189945754907, 7.449265942546631, 6.179915496564275, 6.0612041551725895, 5.190234395777278, 6.431149067838992, 5.750885386706607, 8.2047508437625, 4.91282032529817, 4.273948852684534, 5.827231082614661, 3.1063674944253012, 7.406022769337717, 7.946921029696854, 3.650476245170073, 7.802243812845591, 3.8365059971420554, 7.234906756833263, 5.034803823253383, 4.006331302915275, 6.153802067807718, 6.63794450504591, 8.121884664980865, 7.6137651103901325, 6.068670241430688, 7.444921278409786, 6.652613007587312, 11.353064531550016, 7.891426061467812, 6.264252160075015, 7.545387280940594, 3.97729493397021, 6.61976018135003, 5.750495831692176], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.896487341009487, "mean_inference_ms": 8.015973555166841, "mean_action_processing_ms": 0.5381161662926573, "mean_env_wait_ms": 23.840542179584716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038982391357421875, "StateBufferConnector_ms": 0.025485992431640625, "ViewRequirementAgentConnector_ms": 0.9471206665039062}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6257286, "num_agent_steps_trained": 6257286, "num_env_steps_sampled": 6257286, "num_env_steps_trained": 6257286, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.0794446409877, "num_env_steps_trained_throughput_per_sec": 286.0794446409877, "timesteps_total": 6257286, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6257286, "timers": {"training_iteration_time_ms": 54565.405, "sample_time_ms": 41592.512, "load_time_ms": 1710.615, "load_throughput": 9141.74, "learn_time_ms": 10711.226, "learn_throughput": 1459.964, "synch_weights_time_ms": 434.067}, "counters": {"num_env_steps_sampled": 6257286, "num_env_steps_trained": 6257286, "num_agent_steps_sampled": 6257286, "num_agent_steps_trained": 6257286}, "done": false, "episodes_total": 798, "training_iteration": 405, "trial_id": "2f030_00000", "date": "2025-06-07_08-29-44", "timestamp": 1749277784, "time_this_iter_s": 54.680132150650024, "time_total_s": 3200.5045640468597, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3200.5045640468597, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 77.46507936507938, "ram_util_percent": 66.18253968253967, "gpu_util_percent0": 0.07269841269841269, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.954774210526315e-05, "total_loss": -0.10613528699190779, "policy_loss": -0.02175915983669587, "vf_loss": 0.014968072457916357, "vf_explained_var": 0.7217270715670152, "kl": 0.016346691680446716, "entropy": 21.003190179304642, "entropy_coeff": 0.0047851775000000004}, "model": {}, "num_grad_updates_lifetime": 31625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6272924, "num_env_steps_trained": 6272924, "num_agent_steps_sampled": 6272924, "num_agent_steps_trained": 6272924}, "sampler_results": {"episode_reward_max": 11.353064531550016, "episode_reward_min": -3.9351595991405697, "episode_reward_mean": 5.521040168587857, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.052806033316382, 4.285505803693462, 4.223086960779244, 3.572749099235123, 6.160668630538426, 7.8165206542604215, 6.338541924068631, 5.048809961170661, 1.9808729605620286, 5.899768379983788, 4.394798271988679, 3.180426179441853, 6.427253301753625, 7.893507611894342, 3.812440032118853, 4.398146464068756, 3.6743104646390217, -3.9351595991405697, 3.8051448122087685, 1.199993821362167, -0.6005393280512271, 8.303469796694218, 4.350778839478319, 3.9920139373729184, 3.7232892538097713, 5.0771549724324965, 4.712837387661763, 9.118312842849656, 4.2331095204979805, 4.985743338568561, 7.868984621963809, 9.508225851299143, 7.833028775253252, 7.553149781456243, 4.355583710551816, 4.314192793838881, 7.326927887820128, 5.481182907455046, 6.381185380778163, 0.2983480568024052, 7.950388674361479, 4.724910710597677, 4.236188959873626, 4.535246022178754, 2.6810022884085174, 4.92876062111496, 10.378532139290451, 7.691124646655258, 5.33518519033429, 1.2275584190677546, 4.690632167386376, 6.885289462426973, 3.687189945754907, 7.449265942546631, 6.179915496564275, 6.0612041551725895, 5.190234395777278, 6.431149067838992, 5.750885386706607, 8.2047508437625, 4.91282032529817, 4.273948852684534, 5.827231082614661, 3.1063674944253012, 7.406022769337717, 7.946921029696854, 3.650476245170073, 7.802243812845591, 3.8365059971420554, 7.234906756833263, 5.034803823253383, 4.006331302915275, 6.153802067807718, 6.63794450504591, 8.121884664980865, 7.6137651103901325, 6.068670241430688, 7.444921278409786, 6.652613007587312, 11.353064531550016, 7.891426061467812, 6.264252160075015, 7.545387280940594, 3.97729493397021, 6.61976018135003, 5.750495831692176, 5.207384711396632, 4.057928418739106, 5.400316675715565, 8.938047146526158, 5.710016382860835, 5.5313149585276955, 4.3084588040032745, 4.737568506878135, 8.744846714492372, 6.420555770628113, 6.127985586651391, 1.1950298517534559, 7.234562518538619, 6.0895528308622815], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.895582800919766, "mean_inference_ms": 8.016441141200003, "mean_action_processing_ms": 0.5381197071495558, "mean_env_wait_ms": 23.841611489617954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031968116760253906, "StateBufferConnector_ms": 0.028082609176635742, "ViewRequirementAgentConnector_ms": 0.9628760814666748}}, "episode_reward_max": 11.353064531550016, "episode_reward_min": -3.9351595991405697, "episode_reward_mean": 5.521040168587857, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.052806033316382, 4.285505803693462, 4.223086960779244, 3.572749099235123, 6.160668630538426, 7.8165206542604215, 6.338541924068631, 5.048809961170661, 1.9808729605620286, 5.899768379983788, 4.394798271988679, 3.180426179441853, 6.427253301753625, 7.893507611894342, 3.812440032118853, 4.398146464068756, 3.6743104646390217, -3.9351595991405697, 3.8051448122087685, 1.199993821362167, -0.6005393280512271, 8.303469796694218, 4.350778839478319, 3.9920139373729184, 3.7232892538097713, 5.0771549724324965, 4.712837387661763, 9.118312842849656, 4.2331095204979805, 4.985743338568561, 7.868984621963809, 9.508225851299143, 7.833028775253252, 7.553149781456243, 4.355583710551816, 4.314192793838881, 7.326927887820128, 5.481182907455046, 6.381185380778163, 0.2983480568024052, 7.950388674361479, 4.724910710597677, 4.236188959873626, 4.535246022178754, 2.6810022884085174, 4.92876062111496, 10.378532139290451, 7.691124646655258, 5.33518519033429, 1.2275584190677546, 4.690632167386376, 6.885289462426973, 3.687189945754907, 7.449265942546631, 6.179915496564275, 6.0612041551725895, 5.190234395777278, 6.431149067838992, 5.750885386706607, 8.2047508437625, 4.91282032529817, 4.273948852684534, 5.827231082614661, 3.1063674944253012, 7.406022769337717, 7.946921029696854, 3.650476245170073, 7.802243812845591, 3.8365059971420554, 7.234906756833263, 5.034803823253383, 4.006331302915275, 6.153802067807718, 6.63794450504591, 8.121884664980865, 7.6137651103901325, 6.068670241430688, 7.444921278409786, 6.652613007587312, 11.353064531550016, 7.891426061467812, 6.264252160075015, 7.545387280940594, 3.97729493397021, 6.61976018135003, 5.750495831692176, 5.207384711396632, 4.057928418739106, 5.400316675715565, 8.938047146526158, 5.710016382860835, 5.5313149585276955, 4.3084588040032745, 4.737568506878135, 8.744846714492372, 6.420555770628113, 6.127985586651391, 1.1950298517534559, 7.234562518538619, 6.0895528308622815], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.895582800919766, "mean_inference_ms": 8.016441141200003, "mean_action_processing_ms": 0.5381197071495558, "mean_env_wait_ms": 23.841611489617954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031968116760253906, "StateBufferConnector_ms": 0.028082609176635742, "ViewRequirementAgentConnector_ms": 0.9628760814666748}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6272924, "num_agent_steps_trained": 6272924, "num_env_steps_sampled": 6272924, "num_env_steps_trained": 6272924, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 287.3824939231402, "num_env_steps_trained_throughput_per_sec": 287.3824939231402, "timesteps_total": 6272924, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6272924, "timers": {"training_iteration_time_ms": 54544.977, "sample_time_ms": 41554.796, "load_time_ms": 1711.035, "load_throughput": 9139.497, "learn_time_ms": 10722.587, "learn_throughput": 1458.417, "synch_weights_time_ms": 439.443}, "counters": {"num_env_steps_sampled": 6272924, "num_env_steps_trained": 6272924, "num_agent_steps_sampled": 6272924, "num_agent_steps_trained": 6272924}, "done": false, "episodes_total": 812, "training_iteration": 406, "trial_id": "2f030_00000", "date": "2025-06-07_08-30-39", "timestamp": 1749277839, "time_this_iter_s": 54.430296421051025, "time_total_s": 3254.9348604679108, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3254.9348604679108, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 77.22903225806455, "ram_util_percent": 66.48225806451612, "gpu_util_percent0": 0.08870967741935486, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.9424284210526315e-05, "total_loss": -0.1023667475132441, "policy_loss": -0.020301645859739932, "vf_loss": 0.015228943972086365, "vf_explained_var": 0.7283095735853369, "kl": 0.01723782021102538, "entropy": 20.92560983657837, "entropy_coeff": 0.004726535}, "model": {}, "num_grad_updates_lifetime": 32175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6288562, "num_env_steps_trained": 6288562, "num_agent_steps_sampled": 6288562, "num_agent_steps_trained": 6288562}, "sampler_results": {"episode_reward_max": 11.353064531550016, "episode_reward_min": -3.9351595991405697, "episode_reward_mean": 5.61300940834014, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.812440032118853, 4.398146464068756, 3.6743104646390217, -3.9351595991405697, 3.8051448122087685, 1.199993821362167, -0.6005393280512271, 8.303469796694218, 4.350778839478319, 3.9920139373729184, 3.7232892538097713, 5.0771549724324965, 4.712837387661763, 9.118312842849656, 4.2331095204979805, 4.985743338568561, 7.868984621963809, 9.508225851299143, 7.833028775253252, 7.553149781456243, 4.355583710551816, 4.314192793838881, 7.326927887820128, 5.481182907455046, 6.381185380778163, 0.2983480568024052, 7.950388674361479, 4.724910710597677, 4.236188959873626, 4.535246022178754, 2.6810022884085174, 4.92876062111496, 10.378532139290451, 7.691124646655258, 5.33518519033429, 1.2275584190677546, 4.690632167386376, 6.885289462426973, 3.687189945754907, 7.449265942546631, 6.179915496564275, 6.0612041551725895, 5.190234395777278, 6.431149067838992, 5.750885386706607, 8.2047508437625, 4.91282032529817, 4.273948852684534, 5.827231082614661, 3.1063674944253012, 7.406022769337717, 7.946921029696854, 3.650476245170073, 7.802243812845591, 3.8365059971420554, 7.234906756833263, 5.034803823253383, 4.006331302915275, 6.153802067807718, 6.63794450504591, 8.121884664980865, 7.6137651103901325, 6.068670241430688, 7.444921278409786, 6.652613007587312, 11.353064531550016, 7.891426061467812, 6.264252160075015, 7.545387280940594, 3.97729493397021, 6.61976018135003, 5.750495831692176, 5.207384711396632, 4.057928418739106, 5.400316675715565, 8.938047146526158, 5.710016382860835, 5.5313149585276955, 4.3084588040032745, 4.737568506878135, 8.744846714492372, 6.420555770628113, 6.127985586651391, 1.1950298517534559, 7.234562518538619, 6.0895528308622815, 7.259357155721628, 7.25333402605924, 7.408152150395896, 4.676235264423668, 6.222293489484783, 5.460654099172623, 9.322396838157584, 5.128050831611656, 3.333160661173586, 7.906219460356939, 0.1340622919587314, 6.368039982696147, 6.630007700069032, 5.37027579663361], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.894763967907542, "mean_inference_ms": 8.017121394256156, "mean_action_processing_ms": 0.5381657971384474, "mean_env_wait_ms": 23.842775098724136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03394508361816406, "StateBufferConnector_ms": 0.031041860580444336, "ViewRequirementAgentConnector_ms": 0.9665729999542236}}, "episode_reward_max": 11.353064531550016, "episode_reward_min": -3.9351595991405697, "episode_reward_mean": 5.61300940834014, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.812440032118853, 4.398146464068756, 3.6743104646390217, -3.9351595991405697, 3.8051448122087685, 1.199993821362167, -0.6005393280512271, 8.303469796694218, 4.350778839478319, 3.9920139373729184, 3.7232892538097713, 5.0771549724324965, 4.712837387661763, 9.118312842849656, 4.2331095204979805, 4.985743338568561, 7.868984621963809, 9.508225851299143, 7.833028775253252, 7.553149781456243, 4.355583710551816, 4.314192793838881, 7.326927887820128, 5.481182907455046, 6.381185380778163, 0.2983480568024052, 7.950388674361479, 4.724910710597677, 4.236188959873626, 4.535246022178754, 2.6810022884085174, 4.92876062111496, 10.378532139290451, 7.691124646655258, 5.33518519033429, 1.2275584190677546, 4.690632167386376, 6.885289462426973, 3.687189945754907, 7.449265942546631, 6.179915496564275, 6.0612041551725895, 5.190234395777278, 6.431149067838992, 5.750885386706607, 8.2047508437625, 4.91282032529817, 4.273948852684534, 5.827231082614661, 3.1063674944253012, 7.406022769337717, 7.946921029696854, 3.650476245170073, 7.802243812845591, 3.8365059971420554, 7.234906756833263, 5.034803823253383, 4.006331302915275, 6.153802067807718, 6.63794450504591, 8.121884664980865, 7.6137651103901325, 6.068670241430688, 7.444921278409786, 6.652613007587312, 11.353064531550016, 7.891426061467812, 6.264252160075015, 7.545387280940594, 3.97729493397021, 6.61976018135003, 5.750495831692176, 5.207384711396632, 4.057928418739106, 5.400316675715565, 8.938047146526158, 5.710016382860835, 5.5313149585276955, 4.3084588040032745, 4.737568506878135, 8.744846714492372, 6.420555770628113, 6.127985586651391, 1.1950298517534559, 7.234562518538619, 6.0895528308622815, 7.259357155721628, 7.25333402605924, 7.408152150395896, 4.676235264423668, 6.222293489484783, 5.460654099172623, 9.322396838157584, 5.128050831611656, 3.333160661173586, 7.906219460356939, 0.1340622919587314, 6.368039982696147, 6.630007700069032, 5.37027579663361], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.894763967907542, "mean_inference_ms": 8.017121394256156, "mean_action_processing_ms": 0.5381657971384474, "mean_env_wait_ms": 23.842775098724136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03394508361816406, "StateBufferConnector_ms": 0.031041860580444336, "ViewRequirementAgentConnector_ms": 0.9665729999542236}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6288562, "num_agent_steps_trained": 6288562, "num_env_steps_sampled": 6288562, "num_env_steps_trained": 6288562, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.2217000930353, "num_env_steps_trained_throughput_per_sec": 285.2217000930353, "timesteps_total": 6288562, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6288562, "timers": {"training_iteration_time_ms": 54592.082, "sample_time_ms": 41596.468, "load_time_ms": 1715.54, "load_throughput": 9115.497, "learn_time_ms": 10724.55, "learn_throughput": 1458.15, "synch_weights_time_ms": 438.66}, "counters": {"num_env_steps_sampled": 6288562, "num_env_steps_trained": 6288562, "num_agent_steps_sampled": 6288562, "num_agent_steps_trained": 6288562}, "done": false, "episodes_total": 826, "training_iteration": 407, "trial_id": "2f030_00000", "date": "2025-06-07_08-31-33", "timestamp": 1749277893, "time_this_iter_s": 54.842549562454224, "time_total_s": 3309.777410030365, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3309.777410030365, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 77.89841269841271, "ram_util_percent": 66.62698412698411, "gpu_util_percent0": 0.07349206349206348, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.9300826315789467e-05, "total_loss": -0.09899801775813102, "policy_loss": -0.018399904587581246, "vf_loss": 0.015697080709717492, "vf_explained_var": 0.7043131738359278, "kl": 0.01799777295653935, "entropy": 21.020215194008568, "entropy_coeff": 0.0046678925000000005}, "model": {}, "num_grad_updates_lifetime": 32725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6304200, "num_env_steps_trained": 6304200, "num_agent_steps_sampled": 6304200, "num_agent_steps_trained": 6304200}, "sampler_results": {"episode_reward_max": 11.353064531550016, "episode_reward_min": -1.3919729689715477, "episode_reward_mean": 5.715097041012461, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.2331095204979805, 4.985743338568561, 7.868984621963809, 9.508225851299143, 7.833028775253252, 7.553149781456243, 4.355583710551816, 4.314192793838881, 7.326927887820128, 5.481182907455046, 6.381185380778163, 0.2983480568024052, 7.950388674361479, 4.724910710597677, 4.236188959873626, 4.535246022178754, 2.6810022884085174, 4.92876062111496, 10.378532139290451, 7.691124646655258, 5.33518519033429, 1.2275584190677546, 4.690632167386376, 6.885289462426973, 3.687189945754907, 7.449265942546631, 6.179915496564275, 6.0612041551725895, 5.190234395777278, 6.431149067838992, 5.750885386706607, 8.2047508437625, 4.91282032529817, 4.273948852684534, 5.827231082614661, 3.1063674944253012, 7.406022769337717, 7.946921029696854, 3.650476245170073, 7.802243812845591, 3.8365059971420554, 7.234906756833263, 5.034803823253383, 4.006331302915275, 6.153802067807718, 6.63794450504591, 8.121884664980865, 7.6137651103901325, 6.068670241430688, 7.444921278409786, 6.652613007587312, 11.353064531550016, 7.891426061467812, 6.264252160075015, 7.545387280940594, 3.97729493397021, 6.61976018135003, 5.750495831692176, 5.207384711396632, 4.057928418739106, 5.400316675715565, 8.938047146526158, 5.710016382860835, 5.5313149585276955, 4.3084588040032745, 4.737568506878135, 8.744846714492372, 6.420555770628113, 6.127985586651391, 1.1950298517534559, 7.234562518538619, 6.0895528308622815, 7.259357155721628, 7.25333402605924, 7.408152150395896, 4.676235264423668, 6.222293489484783, 5.460654099172623, 9.322396838157584, 5.128050831611656, 3.333160661173586, 7.906219460356939, 0.1340622919587314, 6.368039982696147, 6.630007700069032, 5.37027579663361, 6.337699749430172, 2.9033501416535112, 2.292485680535584, 4.062579639293644, 8.207690689366727, 3.256760338184235, 5.971516677839433, -1.3919729689715477, 3.975218790108167, 5.845408199006069, 6.580785905518655, 7.366414067733729, 4.66681397794872, 1.7662060770898351], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.894420541389453, "mean_inference_ms": 8.01762967358281, "mean_action_processing_ms": 0.5382271638111542, "mean_env_wait_ms": 23.844940349704917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032559871673583984, "StateBufferConnector_ms": 0.0310518741607666, "ViewRequirementAgentConnector_ms": 1.0005552768707275}}, "episode_reward_max": 11.353064531550016, "episode_reward_min": -1.3919729689715477, "episode_reward_mean": 5.715097041012461, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.2331095204979805, 4.985743338568561, 7.868984621963809, 9.508225851299143, 7.833028775253252, 7.553149781456243, 4.355583710551816, 4.314192793838881, 7.326927887820128, 5.481182907455046, 6.381185380778163, 0.2983480568024052, 7.950388674361479, 4.724910710597677, 4.236188959873626, 4.535246022178754, 2.6810022884085174, 4.92876062111496, 10.378532139290451, 7.691124646655258, 5.33518519033429, 1.2275584190677546, 4.690632167386376, 6.885289462426973, 3.687189945754907, 7.449265942546631, 6.179915496564275, 6.0612041551725895, 5.190234395777278, 6.431149067838992, 5.750885386706607, 8.2047508437625, 4.91282032529817, 4.273948852684534, 5.827231082614661, 3.1063674944253012, 7.406022769337717, 7.946921029696854, 3.650476245170073, 7.802243812845591, 3.8365059971420554, 7.234906756833263, 5.034803823253383, 4.006331302915275, 6.153802067807718, 6.63794450504591, 8.121884664980865, 7.6137651103901325, 6.068670241430688, 7.444921278409786, 6.652613007587312, 11.353064531550016, 7.891426061467812, 6.264252160075015, 7.545387280940594, 3.97729493397021, 6.61976018135003, 5.750495831692176, 5.207384711396632, 4.057928418739106, 5.400316675715565, 8.938047146526158, 5.710016382860835, 5.5313149585276955, 4.3084588040032745, 4.737568506878135, 8.744846714492372, 6.420555770628113, 6.127985586651391, 1.1950298517534559, 7.234562518538619, 6.0895528308622815, 7.259357155721628, 7.25333402605924, 7.408152150395896, 4.676235264423668, 6.222293489484783, 5.460654099172623, 9.322396838157584, 5.128050831611656, 3.333160661173586, 7.906219460356939, 0.1340622919587314, 6.368039982696147, 6.630007700069032, 5.37027579663361, 6.337699749430172, 2.9033501416535112, 2.292485680535584, 4.062579639293644, 8.207690689366727, 3.256760338184235, 5.971516677839433, -1.3919729689715477, 3.975218790108167, 5.845408199006069, 6.580785905518655, 7.366414067733729, 4.66681397794872, 1.7662060770898351], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.894420541389453, "mean_inference_ms": 8.01762967358281, "mean_action_processing_ms": 0.5382271638111542, "mean_env_wait_ms": 23.844940349704917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032559871673583984, "StateBufferConnector_ms": 0.0310518741607666, "ViewRequirementAgentConnector_ms": 1.0005552768707275}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6304200, "num_agent_steps_trained": 6304200, "num_env_steps_sampled": 6304200, "num_env_steps_trained": 6304200, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.35777484346954, "num_env_steps_trained_throughput_per_sec": 284.35777484346954, "timesteps_total": 6304200, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6304200, "timers": {"training_iteration_time_ms": 54608.651, "sample_time_ms": 41645.708, "load_time_ms": 1704.707, "load_throughput": 9173.424, "learn_time_ms": 10703.18, "learn_throughput": 1461.061, "synch_weights_time_ms": 438.043}, "counters": {"num_env_steps_sampled": 6304200, "num_env_steps_trained": 6304200, "num_agent_steps_sampled": 6304200, "num_agent_steps_trained": 6304200}, "done": false, "episodes_total": 840, "training_iteration": 408, "trial_id": "2f030_00000", "date": "2025-06-07_08-32-28", "timestamp": 1749277948, "time_this_iter_s": 55.01009917259216, "time_total_s": 3364.787509202957, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3364.787509202957, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 77.36031746031745, "ram_util_percent": 66.51587301587303, "gpu_util_percent0": 0.07888888888888888, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.9177368421052624e-05, "total_loss": -0.10476807553067126, "policy_loss": -0.024448329814999437, "vf_loss": 0.014465629725124348, "vf_explained_var": 0.7331588193503293, "kl": 0.016599491579175018, "entropy": 20.931137593009254, "entropy_coeff": 0.0046092500000000005}, "model": {}, "num_grad_updates_lifetime": 33275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6319838, "num_env_steps_trained": 6319838, "num_agent_steps_sampled": 6319838, "num_agent_steps_trained": 6319838}, "sampler_results": {"episode_reward_max": 11.353064531550016, "episode_reward_min": -1.3919729689715477, "episode_reward_mean": 5.622361001472034, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.236188959873626, 4.535246022178754, 2.6810022884085174, 4.92876062111496, 10.378532139290451, 7.691124646655258, 5.33518519033429, 1.2275584190677546, 4.690632167386376, 6.885289462426973, 3.687189945754907, 7.449265942546631, 6.179915496564275, 6.0612041551725895, 5.190234395777278, 6.431149067838992, 5.750885386706607, 8.2047508437625, 4.91282032529817, 4.273948852684534, 5.827231082614661, 3.1063674944253012, 7.406022769337717, 7.946921029696854, 3.650476245170073, 7.802243812845591, 3.8365059971420554, 7.234906756833263, 5.034803823253383, 4.006331302915275, 6.153802067807718, 6.63794450504591, 8.121884664980865, 7.6137651103901325, 6.068670241430688, 7.444921278409786, 6.652613007587312, 11.353064531550016, 7.891426061467812, 6.264252160075015, 7.545387280940594, 3.97729493397021, 6.61976018135003, 5.750495831692176, 5.207384711396632, 4.057928418739106, 5.400316675715565, 8.938047146526158, 5.710016382860835, 5.5313149585276955, 4.3084588040032745, 4.737568506878135, 8.744846714492372, 6.420555770628113, 6.127985586651391, 1.1950298517534559, 7.234562518538619, 6.0895528308622815, 7.259357155721628, 7.25333402605924, 7.408152150395896, 4.676235264423668, 6.222293489484783, 5.460654099172623, 9.322396838157584, 5.128050831611656, 3.333160661173586, 7.906219460356939, 0.1340622919587314, 6.368039982696147, 6.630007700069032, 5.37027579663361, 6.337699749430172, 2.9033501416535112, 2.292485680535584, 4.062579639293644, 8.207690689366727, 3.256760338184235, 5.971516677839433, -1.3919729689715477, 3.975218790108167, 5.845408199006069, 6.580785905518655, 7.366414067733729, 4.66681397794872, 1.7662060770898351, 4.097217465234249, 5.656678996129349, 4.058993872994783, 5.938102831130498, 8.576943179675418, 6.6964113149397635, 4.038928032138303, 5.664258427025991, 5.407882107941882, -0.4334018250544819, 8.972867821657696, 8.67133343619578, 5.311534129563524, 0.883608267629123], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8937606500335367, "mean_inference_ms": 8.017935724247561, "mean_action_processing_ms": 0.5382098419090423, "mean_env_wait_ms": 23.846250133346963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03055739402770996, "StateBufferConnector_ms": 0.033071279525756836, "ViewRequirementAgentConnector_ms": 0.9868426322937012}}, "episode_reward_max": 11.353064531550016, "episode_reward_min": -1.3919729689715477, "episode_reward_mean": 5.622361001472034, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.236188959873626, 4.535246022178754, 2.6810022884085174, 4.92876062111496, 10.378532139290451, 7.691124646655258, 5.33518519033429, 1.2275584190677546, 4.690632167386376, 6.885289462426973, 3.687189945754907, 7.449265942546631, 6.179915496564275, 6.0612041551725895, 5.190234395777278, 6.431149067838992, 5.750885386706607, 8.2047508437625, 4.91282032529817, 4.273948852684534, 5.827231082614661, 3.1063674944253012, 7.406022769337717, 7.946921029696854, 3.650476245170073, 7.802243812845591, 3.8365059971420554, 7.234906756833263, 5.034803823253383, 4.006331302915275, 6.153802067807718, 6.63794450504591, 8.121884664980865, 7.6137651103901325, 6.068670241430688, 7.444921278409786, 6.652613007587312, 11.353064531550016, 7.891426061467812, 6.264252160075015, 7.545387280940594, 3.97729493397021, 6.61976018135003, 5.750495831692176, 5.207384711396632, 4.057928418739106, 5.400316675715565, 8.938047146526158, 5.710016382860835, 5.5313149585276955, 4.3084588040032745, 4.737568506878135, 8.744846714492372, 6.420555770628113, 6.127985586651391, 1.1950298517534559, 7.234562518538619, 6.0895528308622815, 7.259357155721628, 7.25333402605924, 7.408152150395896, 4.676235264423668, 6.222293489484783, 5.460654099172623, 9.322396838157584, 5.128050831611656, 3.333160661173586, 7.906219460356939, 0.1340622919587314, 6.368039982696147, 6.630007700069032, 5.37027579663361, 6.337699749430172, 2.9033501416535112, 2.292485680535584, 4.062579639293644, 8.207690689366727, 3.256760338184235, 5.971516677839433, -1.3919729689715477, 3.975218790108167, 5.845408199006069, 6.580785905518655, 7.366414067733729, 4.66681397794872, 1.7662060770898351, 4.097217465234249, 5.656678996129349, 4.058993872994783, 5.938102831130498, 8.576943179675418, 6.6964113149397635, 4.038928032138303, 5.664258427025991, 5.407882107941882, -0.4334018250544819, 8.972867821657696, 8.67133343619578, 5.311534129563524, 0.883608267629123], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8937606500335367, "mean_inference_ms": 8.017935724247561, "mean_action_processing_ms": 0.5382098419090423, "mean_env_wait_ms": 23.846250133346963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03055739402770996, "StateBufferConnector_ms": 0.033071279525756836, "ViewRequirementAgentConnector_ms": 0.9868426322937012}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6319838, "num_agent_steps_trained": 6319838, "num_env_steps_sampled": 6319838, "num_env_steps_trained": 6319838, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 287.1527357444312, "num_env_steps_trained_throughput_per_sec": 287.1527357444312, "timesteps_total": 6319838, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6319838, "timers": {"training_iteration_time_ms": 54540.886, "sample_time_ms": 41577.348, "load_time_ms": 1714.053, "load_throughput": 9123.405, "learn_time_ms": 10692.257, "learn_throughput": 1462.554, "synch_weights_time_ms": 439.117}, "counters": {"num_env_steps_sampled": 6319838, "num_env_steps_trained": 6319838, "num_agent_steps_sampled": 6319838, "num_agent_steps_trained": 6319838}, "done": false, "episodes_total": 854, "training_iteration": 409, "trial_id": "2f030_00000", "date": "2025-06-07_08-33-23", "timestamp": 1749278003, "time_this_iter_s": 54.51290559768677, "time_total_s": 3419.300414800644, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3419.300414800644, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 76.86190476190478, "ram_util_percent": 66.58571428571427, "gpu_util_percent0": 0.07904761904761905, "vram_util_percent0": 0.8592122395833336}}
{"evaluation": {"sampler_results": {"episode_reward_max": -4.783170928589799, "episode_reward_min": -7.666918952530063, "episode_reward_mean": -6.367877400785003, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.783170928589799, -4.9710131096807, -7.379008270432372, -7.666918952530063, -7.03927574269208], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4550102884179779, "mean_inference_ms": 3.9889897975912745, "mean_action_processing_ms": 0.2984891783985694, "mean_env_wait_ms": 10.430347399392533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01995086669921875, "ViewRequirementAgentConnector_ms": 0.27988433837890625}}, "episode_reward_max": -4.783170928589799, "episode_reward_min": -7.666918952530063, "episode_reward_mean": -6.367877400785003, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.783170928589799, -4.9710131096807, -7.379008270432372, -7.666918952530063, -7.03927574269208], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4550102884179779, "mean_inference_ms": 3.9889897975912745, "mean_action_processing_ms": 0.2984891783985694, "mean_env_wait_ms": 10.430347399392533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01995086669921875, "ViewRequirementAgentConnector_ms": 0.27988433837890625}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.905391052631578e-05, "total_loss": -0.10537622880698605, "policy_loss": -0.025247867663433267, "vf_loss": 0.01447783380323513, "vf_explained_var": 0.7237522796067325, "kl": 0.015802436828750863, "entropy": 21.034925909909337, "entropy_coeff": 0.0045506075}, "model": {}, "num_grad_updates_lifetime": 33825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6335476, "num_env_steps_trained": 6335476, "num_agent_steps_sampled": 6335476, "num_agent_steps_trained": 6335476}, "sampler_results": {"episode_reward_max": 11.353064531550016, "episode_reward_min": -1.3919729689715477, "episode_reward_mean": 5.606733114715992, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.190234395777278, 6.431149067838992, 5.750885386706607, 8.2047508437625, 4.91282032529817, 4.273948852684534, 5.827231082614661, 3.1063674944253012, 7.406022769337717, 7.946921029696854, 3.650476245170073, 7.802243812845591, 3.8365059971420554, 7.234906756833263, 5.034803823253383, 4.006331302915275, 6.153802067807718, 6.63794450504591, 8.121884664980865, 7.6137651103901325, 6.068670241430688, 7.444921278409786, 6.652613007587312, 11.353064531550016, 7.891426061467812, 6.264252160075015, 7.545387280940594, 3.97729493397021, 6.61976018135003, 5.750495831692176, 5.207384711396632, 4.057928418739106, 5.400316675715565, 8.938047146526158, 5.710016382860835, 5.5313149585276955, 4.3084588040032745, 4.737568506878135, 8.744846714492372, 6.420555770628113, 6.127985586651391, 1.1950298517534559, 7.234562518538619, 6.0895528308622815, 7.259357155721628, 7.25333402605924, 7.408152150395896, 4.676235264423668, 6.222293489484783, 5.460654099172623, 9.322396838157584, 5.128050831611656, 3.333160661173586, 7.906219460356939, 0.1340622919587314, 6.368039982696147, 6.630007700069032, 5.37027579663361, 6.337699749430172, 2.9033501416535112, 2.292485680535584, 4.062579639293644, 8.207690689366727, 3.256760338184235, 5.971516677839433, -1.3919729689715477, 3.975218790108167, 5.845408199006069, 6.580785905518655, 7.366414067733729, 4.66681397794872, 1.7662060770898351, 4.097217465234249, 5.656678996129349, 4.058993872994783, 5.938102831130498, 8.576943179675418, 6.6964113149397635, 4.038928032138303, 5.664258427025991, 5.407882107941882, -0.4334018250544819, 8.972867821657696, 8.67133343619578, 5.311534129563524, 0.883608267629123, 7.002402354904073, 7.753085568007355, 8.091213739383583, 8.56902491660045, 1.8987972684692191, 4.089733302604256, 2.8960109521736883, 5.926729220128096, 6.471167545980129, 6.9678606114028705, 1.1083726812360213, 1.4891015904384715, 6.371570332893103, 5.769236696949708], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.893110332188779, "mean_inference_ms": 8.018217084981913, "mean_action_processing_ms": 0.5382011282684854, "mean_env_wait_ms": 23.848080116578263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03162074089050293, "StateBufferConnector_ms": 0.03558206558227539, "ViewRequirementAgentConnector_ms": 1.0227882862091064}}, "episode_reward_max": 11.353064531550016, "episode_reward_min": -1.3919729689715477, "episode_reward_mean": 5.606733114715992, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.190234395777278, 6.431149067838992, 5.750885386706607, 8.2047508437625, 4.91282032529817, 4.273948852684534, 5.827231082614661, 3.1063674944253012, 7.406022769337717, 7.946921029696854, 3.650476245170073, 7.802243812845591, 3.8365059971420554, 7.234906756833263, 5.034803823253383, 4.006331302915275, 6.153802067807718, 6.63794450504591, 8.121884664980865, 7.6137651103901325, 6.068670241430688, 7.444921278409786, 6.652613007587312, 11.353064531550016, 7.891426061467812, 6.264252160075015, 7.545387280940594, 3.97729493397021, 6.61976018135003, 5.750495831692176, 5.207384711396632, 4.057928418739106, 5.400316675715565, 8.938047146526158, 5.710016382860835, 5.5313149585276955, 4.3084588040032745, 4.737568506878135, 8.744846714492372, 6.420555770628113, 6.127985586651391, 1.1950298517534559, 7.234562518538619, 6.0895528308622815, 7.259357155721628, 7.25333402605924, 7.408152150395896, 4.676235264423668, 6.222293489484783, 5.460654099172623, 9.322396838157584, 5.128050831611656, 3.333160661173586, 7.906219460356939, 0.1340622919587314, 6.368039982696147, 6.630007700069032, 5.37027579663361, 6.337699749430172, 2.9033501416535112, 2.292485680535584, 4.062579639293644, 8.207690689366727, 3.256760338184235, 5.971516677839433, -1.3919729689715477, 3.975218790108167, 5.845408199006069, 6.580785905518655, 7.366414067733729, 4.66681397794872, 1.7662060770898351, 4.097217465234249, 5.656678996129349, 4.058993872994783, 5.938102831130498, 8.576943179675418, 6.6964113149397635, 4.038928032138303, 5.664258427025991, 5.407882107941882, -0.4334018250544819, 8.972867821657696, 8.67133343619578, 5.311534129563524, 0.883608267629123, 7.002402354904073, 7.753085568007355, 8.091213739383583, 8.56902491660045, 1.8987972684692191, 4.089733302604256, 2.8960109521736883, 5.926729220128096, 6.471167545980129, 6.9678606114028705, 1.1083726812360213, 1.4891015904384715, 6.371570332893103, 5.769236696949708], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.893110332188779, "mean_inference_ms": 8.018217084981913, "mean_action_processing_ms": 0.5382011282684854, "mean_env_wait_ms": 23.848080116578263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03162074089050293, "StateBufferConnector_ms": 0.03558206558227539, "ViewRequirementAgentConnector_ms": 1.0227882862091064}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6335476, "num_agent_steps_trained": 6335476, "num_env_steps_sampled": 6335476, "num_env_steps_trained": 6335476, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.24709361570586, "num_env_steps_trained_throughput_per_sec": 285.24709361570586, "timesteps_total": 6335476, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6335476, "timers": {"training_iteration_time_ms": 54568.025, "sample_time_ms": 41585.229, "load_time_ms": 1714.173, "load_throughput": 9122.766, "learn_time_ms": 10714.34, "learn_throughput": 1459.539, "synch_weights_time_ms": 434.731}, "counters": {"num_env_steps_sampled": 6335476, "num_env_steps_trained": 6335476, "num_agent_steps_sampled": 6335476, "num_agent_steps_trained": 6335476}, "done": false, "episodes_total": 868, "training_iteration": 410, "trial_id": "2f030_00000", "date": "2025-06-07_08-34-33", "timestamp": 1749278073, "time_this_iter_s": 69.92206692695618, "time_total_s": 3489.2224817276, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3489.2224817276, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 66.08271604938271, "ram_util_percent": 66.08271604938271, "gpu_util_percent0": 0.06098765432098765, "vram_util_percent0": 0.8592122395833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.893045263157895e-05, "total_loss": -0.0975311113436791, "policy_loss": -0.01938991114359603, "vf_loss": 0.015043991518799555, "vf_explained_var": 0.7245154545523903, "kl": 0.01641511102674035, "entropy": 21.002066969438033, "entropy_coeff": 0.004491965}, "model": {}, "num_grad_updates_lifetime": 34375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6351114, "num_env_steps_trained": 6351114, "num_agent_steps_sampled": 6351114, "num_agent_steps_trained": 6351114}, "sampler_results": {"episode_reward_max": 11.353064531550016, "episode_reward_min": -1.3919729689715477, "episode_reward_mean": 5.666381539995512, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.034803823253383, 4.006331302915275, 6.153802067807718, 6.63794450504591, 8.121884664980865, 7.6137651103901325, 6.068670241430688, 7.444921278409786, 6.652613007587312, 11.353064531550016, 7.891426061467812, 6.264252160075015, 7.545387280940594, 3.97729493397021, 6.61976018135003, 5.750495831692176, 5.207384711396632, 4.057928418739106, 5.400316675715565, 8.938047146526158, 5.710016382860835, 5.5313149585276955, 4.3084588040032745, 4.737568506878135, 8.744846714492372, 6.420555770628113, 6.127985586651391, 1.1950298517534559, 7.234562518538619, 6.0895528308622815, 7.259357155721628, 7.25333402605924, 7.408152150395896, 4.676235264423668, 6.222293489484783, 5.460654099172623, 9.322396838157584, 5.128050831611656, 3.333160661173586, 7.906219460356939, 0.1340622919587314, 6.368039982696147, 6.630007700069032, 5.37027579663361, 6.337699749430172, 2.9033501416535112, 2.292485680535584, 4.062579639293644, 8.207690689366727, 3.256760338184235, 5.971516677839433, -1.3919729689715477, 3.975218790108167, 5.845408199006069, 6.580785905518655, 7.366414067733729, 4.66681397794872, 1.7662060770898351, 4.097217465234249, 5.656678996129349, 4.058993872994783, 5.938102831130498, 8.576943179675418, 6.6964113149397635, 4.038928032138303, 5.664258427025991, 5.407882107941882, -0.4334018250544819, 8.972867821657696, 8.67133343619578, 5.311534129563524, 0.883608267629123, 7.002402354904073, 7.753085568007355, 8.091213739383583, 8.56902491660045, 1.8987972684692191, 4.089733302604256, 2.8960109521736883, 5.926729220128096, 6.471167545980129, 6.9678606114028705, 1.1083726812360213, 1.4891015904384715, 6.371570332893103, 5.769236696949708, 4.5524438141901085, 5.468372050819426, 4.544831332163462, 8.147633434932825, 6.332711194858243, 8.673156473283653, 10.420878441409936, 5.407342092635515, 6.2203560369194815, 1.9490799027622037, 5.498266583057605, 6.08156682738608, 5.923561005604466, 8.319107398062693], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8924298205585144, "mean_inference_ms": 8.018646562302683, "mean_action_processing_ms": 0.538226376055149, "mean_env_wait_ms": 23.850966589653684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023635149002075195, "StateBufferConnector_ms": 0.03366494178771973, "ViewRequirementAgentConnector_ms": 1.0318975448608398}}, "episode_reward_max": 11.353064531550016, "episode_reward_min": -1.3919729689715477, "episode_reward_mean": 5.666381539995512, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.034803823253383, 4.006331302915275, 6.153802067807718, 6.63794450504591, 8.121884664980865, 7.6137651103901325, 6.068670241430688, 7.444921278409786, 6.652613007587312, 11.353064531550016, 7.891426061467812, 6.264252160075015, 7.545387280940594, 3.97729493397021, 6.61976018135003, 5.750495831692176, 5.207384711396632, 4.057928418739106, 5.400316675715565, 8.938047146526158, 5.710016382860835, 5.5313149585276955, 4.3084588040032745, 4.737568506878135, 8.744846714492372, 6.420555770628113, 6.127985586651391, 1.1950298517534559, 7.234562518538619, 6.0895528308622815, 7.259357155721628, 7.25333402605924, 7.408152150395896, 4.676235264423668, 6.222293489484783, 5.460654099172623, 9.322396838157584, 5.128050831611656, 3.333160661173586, 7.906219460356939, 0.1340622919587314, 6.368039982696147, 6.630007700069032, 5.37027579663361, 6.337699749430172, 2.9033501416535112, 2.292485680535584, 4.062579639293644, 8.207690689366727, 3.256760338184235, 5.971516677839433, -1.3919729689715477, 3.975218790108167, 5.845408199006069, 6.580785905518655, 7.366414067733729, 4.66681397794872, 1.7662060770898351, 4.097217465234249, 5.656678996129349, 4.058993872994783, 5.938102831130498, 8.576943179675418, 6.6964113149397635, 4.038928032138303, 5.664258427025991, 5.407882107941882, -0.4334018250544819, 8.972867821657696, 8.67133343619578, 5.311534129563524, 0.883608267629123, 7.002402354904073, 7.753085568007355, 8.091213739383583, 8.56902491660045, 1.8987972684692191, 4.089733302604256, 2.8960109521736883, 5.926729220128096, 6.471167545980129, 6.9678606114028705, 1.1083726812360213, 1.4891015904384715, 6.371570332893103, 5.769236696949708, 4.5524438141901085, 5.468372050819426, 4.544831332163462, 8.147633434932825, 6.332711194858243, 8.673156473283653, 10.420878441409936, 5.407342092635515, 6.2203560369194815, 1.9490799027622037, 5.498266583057605, 6.08156682738608, 5.923561005604466, 8.319107398062693], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8924298205585144, "mean_inference_ms": 8.018646562302683, "mean_action_processing_ms": 0.538226376055149, "mean_env_wait_ms": 23.850966589653684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023635149002075195, "StateBufferConnector_ms": 0.03366494178771973, "ViewRequirementAgentConnector_ms": 1.0318975448608398}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6351114, "num_agent_steps_trained": 6351114, "num_env_steps_sampled": 6351114, "num_env_steps_trained": 6351114, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.9580000170044, "num_env_steps_trained_throughput_per_sec": 284.9580000170044, "timesteps_total": 6351114, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6351114, "timers": {"training_iteration_time_ms": 54597.663, "sample_time_ms": 41603.268, "load_time_ms": 1714.522, "load_throughput": 9120.912, "learn_time_ms": 10727.961, "learn_throughput": 1457.686, "synch_weights_time_ms": 435.901}, "counters": {"num_env_steps_sampled": 6351114, "num_env_steps_trained": 6351114, "num_agent_steps_sampled": 6351114, "num_agent_steps_trained": 6351114}, "done": false, "episodes_total": 882, "training_iteration": 411, "trial_id": "2f030_00000", "date": "2025-06-07_08-35-28", "timestamp": 1749278128, "time_this_iter_s": 54.89624857902527, "time_total_s": 3544.1187303066254, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3544.1187303066254, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 77.13492063492063, "ram_util_percent": 66.67619047619048, "gpu_util_percent0": 0.07619047619047618, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.8806994736842105e-05, "total_loss": -0.10689426493661648, "policy_loss": -0.029985336246265266, "vf_loss": 0.015381102114915848, "vf_explained_var": 0.702873235724189, "kl": 0.016436693334430715, "entropy": 21.028194880052045, "entropy_coeff": 0.0044333225000000006}, "model": {}, "num_grad_updates_lifetime": 34925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6366752, "num_env_steps_trained": 6366752, "num_agent_steps_sampled": 6366752, "num_agent_steps_trained": 6366752}, "sampler_results": {"episode_reward_max": 10.420878441409936, "episode_reward_min": -1.3919729689715477, "episode_reward_mean": 5.483539628358211, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.61976018135003, 5.750495831692176, 5.207384711396632, 4.057928418739106, 5.400316675715565, 8.938047146526158, 5.710016382860835, 5.5313149585276955, 4.3084588040032745, 4.737568506878135, 8.744846714492372, 6.420555770628113, 6.127985586651391, 1.1950298517534559, 7.234562518538619, 6.0895528308622815, 7.259357155721628, 7.25333402605924, 7.408152150395896, 4.676235264423668, 6.222293489484783, 5.460654099172623, 9.322396838157584, 5.128050831611656, 3.333160661173586, 7.906219460356939, 0.1340622919587314, 6.368039982696147, 6.630007700069032, 5.37027579663361, 6.337699749430172, 2.9033501416535112, 2.292485680535584, 4.062579639293644, 8.207690689366727, 3.256760338184235, 5.971516677839433, -1.3919729689715477, 3.975218790108167, 5.845408199006069, 6.580785905518655, 7.366414067733729, 4.66681397794872, 1.7662060770898351, 4.097217465234249, 5.656678996129349, 4.058993872994783, 5.938102831130498, 8.576943179675418, 6.6964113149397635, 4.038928032138303, 5.664258427025991, 5.407882107941882, -0.4334018250544819, 8.972867821657696, 8.67133343619578, 5.311534129563524, 0.883608267629123, 7.002402354904073, 7.753085568007355, 8.091213739383583, 8.56902491660045, 1.8987972684692191, 4.089733302604256, 2.8960109521736883, 5.926729220128096, 6.471167545980129, 6.9678606114028705, 1.1083726812360213, 1.4891015904384715, 6.371570332893103, 5.769236696949708, 4.5524438141901085, 5.468372050819426, 4.544831332163462, 8.147633434932825, 6.332711194858243, 8.673156473283653, 10.420878441409936, 5.407342092635515, 6.2203560369194815, 1.9490799027622037, 5.498266583057605, 6.08156682738608, 5.923561005604466, 8.319107398062693, 10.053804233301996, 2.679632243527191, 6.715355255408523, 6.269371707740958, 0.7066295036097002, -0.40968294320837056, 5.3316233925664225, 8.698643756415603, 8.52697231733399, 7.7471436146772845, 6.071114543376405, 6.836871702992939, 3.0910920582173738, 4.1633984201346195], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8918122784530236, "mean_inference_ms": 8.019558382722561, "mean_action_processing_ms": 0.5382770232998029, "mean_env_wait_ms": 23.85377520361184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023041963577270508, "StateBufferConnector_ms": 0.03088521957397461, "ViewRequirementAgentConnector_ms": 1.033097267150879}}, "episode_reward_max": 10.420878441409936, "episode_reward_min": -1.3919729689715477, "episode_reward_mean": 5.483539628358211, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.61976018135003, 5.750495831692176, 5.207384711396632, 4.057928418739106, 5.400316675715565, 8.938047146526158, 5.710016382860835, 5.5313149585276955, 4.3084588040032745, 4.737568506878135, 8.744846714492372, 6.420555770628113, 6.127985586651391, 1.1950298517534559, 7.234562518538619, 6.0895528308622815, 7.259357155721628, 7.25333402605924, 7.408152150395896, 4.676235264423668, 6.222293489484783, 5.460654099172623, 9.322396838157584, 5.128050831611656, 3.333160661173586, 7.906219460356939, 0.1340622919587314, 6.368039982696147, 6.630007700069032, 5.37027579663361, 6.337699749430172, 2.9033501416535112, 2.292485680535584, 4.062579639293644, 8.207690689366727, 3.256760338184235, 5.971516677839433, -1.3919729689715477, 3.975218790108167, 5.845408199006069, 6.580785905518655, 7.366414067733729, 4.66681397794872, 1.7662060770898351, 4.097217465234249, 5.656678996129349, 4.058993872994783, 5.938102831130498, 8.576943179675418, 6.6964113149397635, 4.038928032138303, 5.664258427025991, 5.407882107941882, -0.4334018250544819, 8.972867821657696, 8.67133343619578, 5.311534129563524, 0.883608267629123, 7.002402354904073, 7.753085568007355, 8.091213739383583, 8.56902491660045, 1.8987972684692191, 4.089733302604256, 2.8960109521736883, 5.926729220128096, 6.471167545980129, 6.9678606114028705, 1.1083726812360213, 1.4891015904384715, 6.371570332893103, 5.769236696949708, 4.5524438141901085, 5.468372050819426, 4.544831332163462, 8.147633434932825, 6.332711194858243, 8.673156473283653, 10.420878441409936, 5.407342092635515, 6.2203560369194815, 1.9490799027622037, 5.498266583057605, 6.08156682738608, 5.923561005604466, 8.319107398062693, 10.053804233301996, 2.679632243527191, 6.715355255408523, 6.269371707740958, 0.7066295036097002, -0.40968294320837056, 5.3316233925664225, 8.698643756415603, 8.52697231733399, 7.7471436146772845, 6.071114543376405, 6.836871702992939, 3.0910920582173738, 4.1633984201346195], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8918122784530236, "mean_inference_ms": 8.019558382722561, "mean_action_processing_ms": 0.5382770232998029, "mean_env_wait_ms": 23.85377520361184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023041963577270508, "StateBufferConnector_ms": 0.03088521957397461, "ViewRequirementAgentConnector_ms": 1.033097267150879}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6366752, "num_agent_steps_trained": 6366752, "num_env_steps_sampled": 6366752, "num_env_steps_trained": 6366752, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.6434425605053, "num_env_steps_trained_throughput_per_sec": 284.6434425605053, "timesteps_total": 6366752, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6366752, "timers": {"training_iteration_time_ms": 54615.774, "sample_time_ms": 41593.166, "load_time_ms": 1732.424, "load_throughput": 9026.66, "learn_time_ms": 10738.7, "learn_throughput": 1456.228, "synch_weights_time_ms": 436.371}, "counters": {"num_env_steps_sampled": 6366752, "num_env_steps_trained": 6366752, "num_agent_steps_sampled": 6366752, "num_agent_steps_trained": 6366752}, "done": false, "episodes_total": 896, "training_iteration": 412, "trial_id": "2f030_00000", "date": "2025-06-07_08-36-23", "timestamp": 1749278183, "time_this_iter_s": 54.95492124557495, "time_total_s": 3599.0736515522003, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3599.0736515522003, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 77.63174603174602, "ram_util_percent": 67.04126984126985, "gpu_util_percent0": 0.07857142857142857, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.868353684210526e-05, "total_loss": -0.10235616876151074, "policy_loss": -0.026830581745280968, "vf_loss": 0.014958926712755453, "vf_explained_var": 0.7496727332201871, "kl": 0.016283125692827374, "entropy": 20.939920250285756, "entropy_coeff": 0.004374680000000001}, "model": {}, "num_grad_updates_lifetime": 35475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6382390, "num_env_steps_trained": 6382390, "num_agent_steps_sampled": 6382390, "num_agent_steps_trained": 6382390}, "sampler_results": {"episode_reward_max": 10.420878441409936, "episode_reward_min": -1.3919729689715477, "episode_reward_mean": 5.525528375391371, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.234562518538619, 6.0895528308622815, 7.259357155721628, 7.25333402605924, 7.408152150395896, 4.676235264423668, 6.222293489484783, 5.460654099172623, 9.322396838157584, 5.128050831611656, 3.333160661173586, 7.906219460356939, 0.1340622919587314, 6.368039982696147, 6.630007700069032, 5.37027579663361, 6.337699749430172, 2.9033501416535112, 2.292485680535584, 4.062579639293644, 8.207690689366727, 3.256760338184235, 5.971516677839433, -1.3919729689715477, 3.975218790108167, 5.845408199006069, 6.580785905518655, 7.366414067733729, 4.66681397794872, 1.7662060770898351, 4.097217465234249, 5.656678996129349, 4.058993872994783, 5.938102831130498, 8.576943179675418, 6.6964113149397635, 4.038928032138303, 5.664258427025991, 5.407882107941882, -0.4334018250544819, 8.972867821657696, 8.67133343619578, 5.311534129563524, 0.883608267629123, 7.002402354904073, 7.753085568007355, 8.091213739383583, 8.56902491660045, 1.8987972684692191, 4.089733302604256, 2.8960109521736883, 5.926729220128096, 6.471167545980129, 6.9678606114028705, 1.1083726812360213, 1.4891015904384715, 6.371570332893103, 5.769236696949708, 4.5524438141901085, 5.468372050819426, 4.544831332163462, 8.147633434932825, 6.332711194858243, 8.673156473283653, 10.420878441409936, 5.407342092635515, 6.2203560369194815, 1.9490799027622037, 5.498266583057605, 6.08156682738608, 5.923561005604466, 8.319107398062693, 10.053804233301996, 2.679632243527191, 6.715355255408523, 6.269371707740958, 0.7066295036097002, -0.40968294320837056, 5.3316233925664225, 8.698643756415603, 8.52697231733399, 7.7471436146772845, 6.071114543376405, 6.836871702992939, 3.0910920582173738, 4.1633984201346195, 8.548211732030358, 5.88071242860367, 8.38529487539118, 6.054261989339138, 7.174139781510899, 0.2809469293833455, 3.813947640439681, 8.285590693702922, 6.267122866901539, 4.025870032002141, 6.4124753731872985, 5.498641812458809, 9.14540708890068, 3.175961000679322], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.891137051727676, "mean_inference_ms": 8.020542809449578, "mean_action_processing_ms": 0.5382976842317773, "mean_env_wait_ms": 23.856352885588095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03212380409240723, "StateBufferConnector_ms": 0.03282785415649414, "ViewRequirementAgentConnector_ms": 1.006208896636963}}, "episode_reward_max": 10.420878441409936, "episode_reward_min": -1.3919729689715477, "episode_reward_mean": 5.525528375391371, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.234562518538619, 6.0895528308622815, 7.259357155721628, 7.25333402605924, 7.408152150395896, 4.676235264423668, 6.222293489484783, 5.460654099172623, 9.322396838157584, 5.128050831611656, 3.333160661173586, 7.906219460356939, 0.1340622919587314, 6.368039982696147, 6.630007700069032, 5.37027579663361, 6.337699749430172, 2.9033501416535112, 2.292485680535584, 4.062579639293644, 8.207690689366727, 3.256760338184235, 5.971516677839433, -1.3919729689715477, 3.975218790108167, 5.845408199006069, 6.580785905518655, 7.366414067733729, 4.66681397794872, 1.7662060770898351, 4.097217465234249, 5.656678996129349, 4.058993872994783, 5.938102831130498, 8.576943179675418, 6.6964113149397635, 4.038928032138303, 5.664258427025991, 5.407882107941882, -0.4334018250544819, 8.972867821657696, 8.67133343619578, 5.311534129563524, 0.883608267629123, 7.002402354904073, 7.753085568007355, 8.091213739383583, 8.56902491660045, 1.8987972684692191, 4.089733302604256, 2.8960109521736883, 5.926729220128096, 6.471167545980129, 6.9678606114028705, 1.1083726812360213, 1.4891015904384715, 6.371570332893103, 5.769236696949708, 4.5524438141901085, 5.468372050819426, 4.544831332163462, 8.147633434932825, 6.332711194858243, 8.673156473283653, 10.420878441409936, 5.407342092635515, 6.2203560369194815, 1.9490799027622037, 5.498266583057605, 6.08156682738608, 5.923561005604466, 8.319107398062693, 10.053804233301996, 2.679632243527191, 6.715355255408523, 6.269371707740958, 0.7066295036097002, -0.40968294320837056, 5.3316233925664225, 8.698643756415603, 8.52697231733399, 7.7471436146772845, 6.071114543376405, 6.836871702992939, 3.0910920582173738, 4.1633984201346195, 8.548211732030358, 5.88071242860367, 8.38529487539118, 6.054261989339138, 7.174139781510899, 0.2809469293833455, 3.813947640439681, 8.285590693702922, 6.267122866901539, 4.025870032002141, 6.4124753731872985, 5.498641812458809, 9.14540708890068, 3.175961000679322], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.891137051727676, "mean_inference_ms": 8.020542809449578, "mean_action_processing_ms": 0.5382976842317773, "mean_env_wait_ms": 23.856352885588095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03212380409240723, "StateBufferConnector_ms": 0.03282785415649414, "ViewRequirementAgentConnector_ms": 1.006208896636963}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6382390, "num_agent_steps_trained": 6382390, "num_env_steps_sampled": 6382390, "num_env_steps_trained": 6382390, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.7431365366995, "num_env_steps_trained_throughput_per_sec": 285.7431365366995, "timesteps_total": 6382390, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6382390, "timers": {"training_iteration_time_ms": 54683.868, "sample_time_ms": 41618.072, "load_time_ms": 1739.939, "load_throughput": 8987.674, "learn_time_ms": 10738.214, "learn_throughput": 1456.294, "synch_weights_time_ms": 468.562}, "counters": {"num_env_steps_sampled": 6382390, "num_env_steps_trained": 6382390, "num_agent_steps_sampled": 6382390, "num_agent_steps_trained": 6382390}, "done": false, "episodes_total": 910, "training_iteration": 413, "trial_id": "2f030_00000", "date": "2025-06-07_08-37-18", "timestamp": 1749278238, "time_this_iter_s": 54.74144220352173, "time_total_s": 3653.815093755722, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3653.815093755722, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 77.27301587301588, "ram_util_percent": 66.96984126984128, "gpu_util_percent0": 0.07984126984126984, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.8560078947368414e-05, "total_loss": -0.08810678135688332, "policy_loss": -0.014518051351399415, "vf_loss": 0.016128903663801875, "vf_explained_var": 0.6877983642708172, "kl": 0.01710729323921932, "entropy": 20.992941376079212, "entropy_coeff": 0.0043160375}, "model": {}, "num_grad_updates_lifetime": 36025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6398028, "num_env_steps_trained": 6398028, "num_agent_steps_sampled": 6398028, "num_agent_steps_trained": 6398028}, "sampler_results": {"episode_reward_max": 10.420878441409936, "episode_reward_min": -1.3919729689715477, "episode_reward_mean": 5.4665740073908715, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.630007700069032, 5.37027579663361, 6.337699749430172, 2.9033501416535112, 2.292485680535584, 4.062579639293644, 8.207690689366727, 3.256760338184235, 5.971516677839433, -1.3919729689715477, 3.975218790108167, 5.845408199006069, 6.580785905518655, 7.366414067733729, 4.66681397794872, 1.7662060770898351, 4.097217465234249, 5.656678996129349, 4.058993872994783, 5.938102831130498, 8.576943179675418, 6.6964113149397635, 4.038928032138303, 5.664258427025991, 5.407882107941882, -0.4334018250544819, 8.972867821657696, 8.67133343619578, 5.311534129563524, 0.883608267629123, 7.002402354904073, 7.753085568007355, 8.091213739383583, 8.56902491660045, 1.8987972684692191, 4.089733302604256, 2.8960109521736883, 5.926729220128096, 6.471167545980129, 6.9678606114028705, 1.1083726812360213, 1.4891015904384715, 6.371570332893103, 5.769236696949708, 4.5524438141901085, 5.468372050819426, 4.544831332163462, 8.147633434932825, 6.332711194858243, 8.673156473283653, 10.420878441409936, 5.407342092635515, 6.2203560369194815, 1.9490799027622037, 5.498266583057605, 6.08156682738608, 5.923561005604466, 8.319107398062693, 10.053804233301996, 2.679632243527191, 6.715355255408523, 6.269371707740958, 0.7066295036097002, -0.40968294320837056, 5.3316233925664225, 8.698643756415603, 8.52697231733399, 7.7471436146772845, 6.071114543376405, 6.836871702992939, 3.0910920582173738, 4.1633984201346195, 8.548211732030358, 5.88071242860367, 8.38529487539118, 6.054261989339138, 7.174139781510899, 0.2809469293833455, 3.813947640439681, 8.285590693702922, 6.267122866901539, 4.025870032002141, 6.4124753731872985, 5.498641812458809, 9.14540708890068, 3.175961000679322, 2.9662867822989787, 3.7813047535140702, 5.132210168468107, 10.190726866699986, 6.417333060922165, 8.556255325070467, 6.88936849743133, 2.5204743431859793, 5.500668313834573, 4.855429499002873, 5.4592879272157795, 5.453836743581726, 9.037644528330059, 1.1398079910073564], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8902434960387815, "mean_inference_ms": 8.021268838523248, "mean_action_processing_ms": 0.5382883220298507, "mean_env_wait_ms": 23.85907887196561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039429426193237305, "StateBufferConnector_ms": 0.031420230865478516, "ViewRequirementAgentConnector_ms": 0.9953162670135498}}, "episode_reward_max": 10.420878441409936, "episode_reward_min": -1.3919729689715477, "episode_reward_mean": 5.4665740073908715, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.630007700069032, 5.37027579663361, 6.337699749430172, 2.9033501416535112, 2.292485680535584, 4.062579639293644, 8.207690689366727, 3.256760338184235, 5.971516677839433, -1.3919729689715477, 3.975218790108167, 5.845408199006069, 6.580785905518655, 7.366414067733729, 4.66681397794872, 1.7662060770898351, 4.097217465234249, 5.656678996129349, 4.058993872994783, 5.938102831130498, 8.576943179675418, 6.6964113149397635, 4.038928032138303, 5.664258427025991, 5.407882107941882, -0.4334018250544819, 8.972867821657696, 8.67133343619578, 5.311534129563524, 0.883608267629123, 7.002402354904073, 7.753085568007355, 8.091213739383583, 8.56902491660045, 1.8987972684692191, 4.089733302604256, 2.8960109521736883, 5.926729220128096, 6.471167545980129, 6.9678606114028705, 1.1083726812360213, 1.4891015904384715, 6.371570332893103, 5.769236696949708, 4.5524438141901085, 5.468372050819426, 4.544831332163462, 8.147633434932825, 6.332711194858243, 8.673156473283653, 10.420878441409936, 5.407342092635515, 6.2203560369194815, 1.9490799027622037, 5.498266583057605, 6.08156682738608, 5.923561005604466, 8.319107398062693, 10.053804233301996, 2.679632243527191, 6.715355255408523, 6.269371707740958, 0.7066295036097002, -0.40968294320837056, 5.3316233925664225, 8.698643756415603, 8.52697231733399, 7.7471436146772845, 6.071114543376405, 6.836871702992939, 3.0910920582173738, 4.1633984201346195, 8.548211732030358, 5.88071242860367, 8.38529487539118, 6.054261989339138, 7.174139781510899, 0.2809469293833455, 3.813947640439681, 8.285590693702922, 6.267122866901539, 4.025870032002141, 6.4124753731872985, 5.498641812458809, 9.14540708890068, 3.175961000679322, 2.9662867822989787, 3.7813047535140702, 5.132210168468107, 10.190726866699986, 6.417333060922165, 8.556255325070467, 6.88936849743133, 2.5204743431859793, 5.500668313834573, 4.855429499002873, 5.4592879272157795, 5.453836743581726, 9.037644528330059, 1.1398079910073564], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8902434960387815, "mean_inference_ms": 8.021268838523248, "mean_action_processing_ms": 0.5382883220298507, "mean_env_wait_ms": 23.85907887196561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039429426193237305, "StateBufferConnector_ms": 0.031420230865478516, "ViewRequirementAgentConnector_ms": 0.9953162670135498}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6398028, "num_agent_steps_trained": 6398028, "num_env_steps_sampled": 6398028, "num_env_steps_trained": 6398028, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.8966208278383, "num_env_steps_trained_throughput_per_sec": 284.8966208278383, "timesteps_total": 6398028, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6398028, "timers": {"training_iteration_time_ms": 54761.625, "sample_time_ms": 41686.196, "load_time_ms": 1738.173, "load_throughput": 8996.805, "learn_time_ms": 10744.762, "learn_throughput": 1455.407, "synch_weights_time_ms": 465.844}, "counters": {"num_env_steps_sampled": 6398028, "num_env_steps_trained": 6398028, "num_agent_steps_sampled": 6398028, "num_agent_steps_trained": 6398028}, "done": false, "episodes_total": 924, "training_iteration": 414, "trial_id": "2f030_00000", "date": "2025-06-07_08-38-13", "timestamp": 1749278293, "time_this_iter_s": 54.90808629989624, "time_total_s": 3708.7231800556183, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3708.7231800556183, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 77.89999999999999, "ram_util_percent": 66.84032258064514, "gpu_util_percent0": 0.07693548387096776, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.843662105263158e-05, "total_loss": -0.09300657397771085, "policy_loss": -0.020095817599953575, "vf_loss": 0.016074226817793465, "vf_explained_var": 0.7297243749011647, "kl": 0.016251551549454256, "entropy": 20.975909869454124, "entropy_coeff": 0.004257395}, "model": {}, "num_grad_updates_lifetime": 36575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6413666, "num_env_steps_trained": 6413666, "num_agent_steps_sampled": 6413666, "num_agent_steps_trained": 6413666}, "sampler_results": {"episode_reward_max": 11.007340309656922, "episode_reward_min": -0.4334018250544819, "episode_reward_mean": 5.631456374382567, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.66681397794872, 1.7662060770898351, 4.097217465234249, 5.656678996129349, 4.058993872994783, 5.938102831130498, 8.576943179675418, 6.6964113149397635, 4.038928032138303, 5.664258427025991, 5.407882107941882, -0.4334018250544819, 8.972867821657696, 8.67133343619578, 5.311534129563524, 0.883608267629123, 7.002402354904073, 7.753085568007355, 8.091213739383583, 8.56902491660045, 1.8987972684692191, 4.089733302604256, 2.8960109521736883, 5.926729220128096, 6.471167545980129, 6.9678606114028705, 1.1083726812360213, 1.4891015904384715, 6.371570332893103, 5.769236696949708, 4.5524438141901085, 5.468372050819426, 4.544831332163462, 8.147633434932825, 6.332711194858243, 8.673156473283653, 10.420878441409936, 5.407342092635515, 6.2203560369194815, 1.9490799027622037, 5.498266583057605, 6.08156682738608, 5.923561005604466, 8.319107398062693, 10.053804233301996, 2.679632243527191, 6.715355255408523, 6.269371707740958, 0.7066295036097002, -0.40968294320837056, 5.3316233925664225, 8.698643756415603, 8.52697231733399, 7.7471436146772845, 6.071114543376405, 6.836871702992939, 3.0910920582173738, 4.1633984201346195, 8.548211732030358, 5.88071242860367, 8.38529487539118, 6.054261989339138, 7.174139781510899, 0.2809469293833455, 3.813947640439681, 8.285590693702922, 6.267122866901539, 4.025870032002141, 6.4124753731872985, 5.498641812458809, 9.14540708890068, 3.175961000679322, 2.9662867822989787, 3.7813047535140702, 5.132210168468107, 10.190726866699986, 6.417333060922165, 8.556255325070467, 6.88936849743133, 2.5204743431859793, 5.500668313834573, 4.855429499002873, 5.4592879272157795, 5.453836743581726, 9.037644528330059, 1.1398079910073564, 4.148917477150728, 2.5045034121388032, 4.190982934930198, 11.007340309656922, 5.762266830207238, 8.052467669798505, 7.64496236963458, 2.835992085168288, 8.612495820608855, 4.9838325845811156, 5.9907635429641894, 10.412303304613994, 2.33881120566183, 5.41081755845531], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.889167372361439, "mean_inference_ms": 8.021874616799515, "mean_action_processing_ms": 0.5382842029298661, "mean_env_wait_ms": 23.860404336147297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05159401893615723, "StateBufferConnector_ms": 0.03047013282775879, "ViewRequirementAgentConnector_ms": 0.984703540802002}}, "episode_reward_max": 11.007340309656922, "episode_reward_min": -0.4334018250544819, "episode_reward_mean": 5.631456374382567, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.66681397794872, 1.7662060770898351, 4.097217465234249, 5.656678996129349, 4.058993872994783, 5.938102831130498, 8.576943179675418, 6.6964113149397635, 4.038928032138303, 5.664258427025991, 5.407882107941882, -0.4334018250544819, 8.972867821657696, 8.67133343619578, 5.311534129563524, 0.883608267629123, 7.002402354904073, 7.753085568007355, 8.091213739383583, 8.56902491660045, 1.8987972684692191, 4.089733302604256, 2.8960109521736883, 5.926729220128096, 6.471167545980129, 6.9678606114028705, 1.1083726812360213, 1.4891015904384715, 6.371570332893103, 5.769236696949708, 4.5524438141901085, 5.468372050819426, 4.544831332163462, 8.147633434932825, 6.332711194858243, 8.673156473283653, 10.420878441409936, 5.407342092635515, 6.2203560369194815, 1.9490799027622037, 5.498266583057605, 6.08156682738608, 5.923561005604466, 8.319107398062693, 10.053804233301996, 2.679632243527191, 6.715355255408523, 6.269371707740958, 0.7066295036097002, -0.40968294320837056, 5.3316233925664225, 8.698643756415603, 8.52697231733399, 7.7471436146772845, 6.071114543376405, 6.836871702992939, 3.0910920582173738, 4.1633984201346195, 8.548211732030358, 5.88071242860367, 8.38529487539118, 6.054261989339138, 7.174139781510899, 0.2809469293833455, 3.813947640439681, 8.285590693702922, 6.267122866901539, 4.025870032002141, 6.4124753731872985, 5.498641812458809, 9.14540708890068, 3.175961000679322, 2.9662867822989787, 3.7813047535140702, 5.132210168468107, 10.190726866699986, 6.417333060922165, 8.556255325070467, 6.88936849743133, 2.5204743431859793, 5.500668313834573, 4.855429499002873, 5.4592879272157795, 5.453836743581726, 9.037644528330059, 1.1398079910073564, 4.148917477150728, 2.5045034121388032, 4.190982934930198, 11.007340309656922, 5.762266830207238, 8.052467669798505, 7.64496236963458, 2.835992085168288, 8.612495820608855, 4.9838325845811156, 5.9907635429641894, 10.412303304613994, 2.33881120566183, 5.41081755845531], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.889167372361439, "mean_inference_ms": 8.021874616799515, "mean_action_processing_ms": 0.5382842029298661, "mean_env_wait_ms": 23.860404336147297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05159401893615723, "StateBufferConnector_ms": 0.03047013282775879, "ViewRequirementAgentConnector_ms": 0.984703540802002}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6413666, "num_agent_steps_trained": 6413666, "num_env_steps_sampled": 6413666, "num_env_steps_trained": 6413666, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.3772347860367, "num_env_steps_trained_throughput_per_sec": 286.3772347860367, "timesteps_total": 6413666, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6413666, "timers": {"training_iteration_time_ms": 54755.94, "sample_time_ms": 41667.858, "load_time_ms": 1745.237, "load_throughput": 8960.387, "learn_time_ms": 10748.809, "learn_throughput": 1454.859, "synch_weights_time_ms": 461.347}, "counters": {"num_env_steps_sampled": 6413666, "num_env_steps_trained": 6413666, "num_agent_steps_sampled": 6413666, "num_agent_steps_trained": 6413666}, "done": false, "episodes_total": 938, "training_iteration": 415, "trial_id": "2f030_00000", "date": "2025-06-07_08-39-08", "timestamp": 1749278348, "time_this_iter_s": 54.617268323898315, "time_total_s": 3763.3404483795166, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3763.3404483795166, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 77.84285714285714, "ram_util_percent": 67.21269841269842, "gpu_util_percent0": 0.0815873015873016, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.831316315789472e-05, "total_loss": -0.09606037264266475, "policy_loss": -0.024107197887973268, "vf_loss": 0.01587877221236175, "vf_explained_var": 0.727798044573177, "kl": 0.01535735342969102, "entropy": 20.875230412916704, "entropy_coeff": 0.0041987525}, "model": {}, "num_grad_updates_lifetime": 37125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6429304, "num_env_steps_trained": 6429304, "num_agent_steps_sampled": 6429304, "num_agent_steps_trained": 6429304}, "sampler_results": {"episode_reward_max": 11.953971337373455, "episode_reward_min": -0.40968294320837056, "episode_reward_mean": 5.881566081410385, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.311534129563524, 0.883608267629123, 7.002402354904073, 7.753085568007355, 8.091213739383583, 8.56902491660045, 1.8987972684692191, 4.089733302604256, 2.8960109521736883, 5.926729220128096, 6.471167545980129, 6.9678606114028705, 1.1083726812360213, 1.4891015904384715, 6.371570332893103, 5.769236696949708, 4.5524438141901085, 5.468372050819426, 4.544831332163462, 8.147633434932825, 6.332711194858243, 8.673156473283653, 10.420878441409936, 5.407342092635515, 6.2203560369194815, 1.9490799027622037, 5.498266583057605, 6.08156682738608, 5.923561005604466, 8.319107398062693, 10.053804233301996, 2.679632243527191, 6.715355255408523, 6.269371707740958, 0.7066295036097002, -0.40968294320837056, 5.3316233925664225, 8.698643756415603, 8.52697231733399, 7.7471436146772845, 6.071114543376405, 6.836871702992939, 3.0910920582173738, 4.1633984201346195, 8.548211732030358, 5.88071242860367, 8.38529487539118, 6.054261989339138, 7.174139781510899, 0.2809469293833455, 3.813947640439681, 8.285590693702922, 6.267122866901539, 4.025870032002141, 6.4124753731872985, 5.498641812458809, 9.14540708890068, 3.175961000679322, 2.9662867822989787, 3.7813047535140702, 5.132210168468107, 10.190726866699986, 6.417333060922165, 8.556255325070467, 6.88936849743133, 2.5204743431859793, 5.500668313834573, 4.855429499002873, 5.4592879272157795, 5.453836743581726, 9.037644528330059, 1.1398079910073564, 4.148917477150728, 2.5045034121388032, 4.190982934930198, 11.007340309656922, 5.762266830207238, 8.052467669798505, 7.64496236963458, 2.835992085168288, 8.612495820608855, 4.9838325845811156, 5.9907635429641894, 10.412303304613994, 2.33881120566183, 5.41081755845531, 9.840079326369132, 6.732491396616992, 3.2844925200915713, 4.994734727902421, -0.18144330409442708, 7.254801556161376, 8.413443334093243, 8.612206894756445, 11.953971337373455, 3.345465056774458, 8.04612704554641, 9.66611989166121, 8.488451277408323, 8.339265357169024], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.887999371837349, "mean_inference_ms": 8.022586203502152, "mean_action_processing_ms": 0.5383544785120636, "mean_env_wait_ms": 23.862113681287113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05237555503845215, "StateBufferConnector_ms": 0.029729127883911133, "ViewRequirementAgentConnector_ms": 0.9982609748840332}}, "episode_reward_max": 11.953971337373455, "episode_reward_min": -0.40968294320837056, "episode_reward_mean": 5.881566081410385, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.311534129563524, 0.883608267629123, 7.002402354904073, 7.753085568007355, 8.091213739383583, 8.56902491660045, 1.8987972684692191, 4.089733302604256, 2.8960109521736883, 5.926729220128096, 6.471167545980129, 6.9678606114028705, 1.1083726812360213, 1.4891015904384715, 6.371570332893103, 5.769236696949708, 4.5524438141901085, 5.468372050819426, 4.544831332163462, 8.147633434932825, 6.332711194858243, 8.673156473283653, 10.420878441409936, 5.407342092635515, 6.2203560369194815, 1.9490799027622037, 5.498266583057605, 6.08156682738608, 5.923561005604466, 8.319107398062693, 10.053804233301996, 2.679632243527191, 6.715355255408523, 6.269371707740958, 0.7066295036097002, -0.40968294320837056, 5.3316233925664225, 8.698643756415603, 8.52697231733399, 7.7471436146772845, 6.071114543376405, 6.836871702992939, 3.0910920582173738, 4.1633984201346195, 8.548211732030358, 5.88071242860367, 8.38529487539118, 6.054261989339138, 7.174139781510899, 0.2809469293833455, 3.813947640439681, 8.285590693702922, 6.267122866901539, 4.025870032002141, 6.4124753731872985, 5.498641812458809, 9.14540708890068, 3.175961000679322, 2.9662867822989787, 3.7813047535140702, 5.132210168468107, 10.190726866699986, 6.417333060922165, 8.556255325070467, 6.88936849743133, 2.5204743431859793, 5.500668313834573, 4.855429499002873, 5.4592879272157795, 5.453836743581726, 9.037644528330059, 1.1398079910073564, 4.148917477150728, 2.5045034121388032, 4.190982934930198, 11.007340309656922, 5.762266830207238, 8.052467669798505, 7.64496236963458, 2.835992085168288, 8.612495820608855, 4.9838325845811156, 5.9907635429641894, 10.412303304613994, 2.33881120566183, 5.41081755845531, 9.840079326369132, 6.732491396616992, 3.2844925200915713, 4.994734727902421, -0.18144330409442708, 7.254801556161376, 8.413443334093243, 8.612206894756445, 11.953971337373455, 3.345465056774458, 8.04612704554641, 9.66611989166121, 8.488451277408323, 8.339265357169024], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.887999371837349, "mean_inference_ms": 8.022586203502152, "mean_action_processing_ms": 0.5383544785120636, "mean_env_wait_ms": 23.862113681287113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05237555503845215, "StateBufferConnector_ms": 0.029729127883911133, "ViewRequirementAgentConnector_ms": 0.9982609748840332}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6429304, "num_agent_steps_trained": 6429304, "num_env_steps_sampled": 6429304, "num_env_steps_trained": 6429304, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.6098847416814, "num_env_steps_trained_throughput_per_sec": 285.6098847416814, "timesteps_total": 6429304, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6429304, "timers": {"training_iteration_time_ms": 54789.713, "sample_time_ms": 41703.854, "load_time_ms": 1747.456, "load_throughput": 8949.008, "learn_time_ms": 10749.802, "learn_throughput": 1454.724, "synch_weights_time_ms": 457.078}, "counters": {"num_env_steps_sampled": 6429304, "num_env_steps_trained": 6429304, "num_agent_steps_sampled": 6429304, "num_agent_steps_trained": 6429304}, "done": false, "episodes_total": 952, "training_iteration": 416, "trial_id": "2f030_00000", "date": "2025-06-07_08-40-03", "timestamp": 1749278403, "time_this_iter_s": 54.76907515525818, "time_total_s": 3818.109523534775, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3818.109523534775, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 78.19193548387098, "ram_util_percent": 67.18548387096774, "gpu_util_percent0": 0.0743548387096774, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.8189705263157894e-05, "total_loss": -0.10297206302215768, "policy_loss": -0.03305207645859231, "vf_loss": 0.01688443145291372, "vf_explained_var": 0.7237510526180267, "kl": 0.01670416277083572, "entropy": 20.984283228787508, "entropy_coeff": 0.004140110000000001}, "model": {}, "num_grad_updates_lifetime": 37675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6444942, "num_env_steps_trained": 6444942, "num_agent_steps_sampled": 6444942, "num_agent_steps_trained": 6444942}, "sampler_results": {"episode_reward_max": 11.953971337373455, "episode_reward_min": -0.49941780554613013, "episode_reward_mean": 5.976215530740195, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.371570332893103, 5.769236696949708, 4.5524438141901085, 5.468372050819426, 4.544831332163462, 8.147633434932825, 6.332711194858243, 8.673156473283653, 10.420878441409936, 5.407342092635515, 6.2203560369194815, 1.9490799027622037, 5.498266583057605, 6.08156682738608, 5.923561005604466, 8.319107398062693, 10.053804233301996, 2.679632243527191, 6.715355255408523, 6.269371707740958, 0.7066295036097002, -0.40968294320837056, 5.3316233925664225, 8.698643756415603, 8.52697231733399, 7.7471436146772845, 6.071114543376405, 6.836871702992939, 3.0910920582173738, 4.1633984201346195, 8.548211732030358, 5.88071242860367, 8.38529487539118, 6.054261989339138, 7.174139781510899, 0.2809469293833455, 3.813947640439681, 8.285590693702922, 6.267122866901539, 4.025870032002141, 6.4124753731872985, 5.498641812458809, 9.14540708890068, 3.175961000679322, 2.9662867822989787, 3.7813047535140702, 5.132210168468107, 10.190726866699986, 6.417333060922165, 8.556255325070467, 6.88936849743133, 2.5204743431859793, 5.500668313834573, 4.855429499002873, 5.4592879272157795, 5.453836743581726, 9.037644528330059, 1.1398079910073564, 4.148917477150728, 2.5045034121388032, 4.190982934930198, 11.007340309656922, 5.762266830207238, 8.052467669798505, 7.64496236963458, 2.835992085168288, 8.612495820608855, 4.9838325845811156, 5.9907635429641894, 10.412303304613994, 2.33881120566183, 5.41081755845531, 9.840079326369132, 6.732491396616992, 3.2844925200915713, 4.994734727902421, -0.18144330409442708, 7.254801556161376, 8.413443334093243, 8.612206894756445, 11.953971337373455, 3.345465056774458, 8.04612704554641, 9.66611989166121, 8.488451277408323, 8.339265357169024, 8.562468228348637, 6.1693883549367055, 5.480000865972639, 3.562144029491619, 4.9676403431397205, 7.285256714428133, 3.576507166154302, 7.733850747547287, 8.401820227561904, 4.954783436449674, 0.7483498619515853, -0.49941780554613013, 8.36248703239306, 8.618307878672642], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8869416900036464, "mean_inference_ms": 8.023223884124704, "mean_action_processing_ms": 0.5384379462321899, "mean_env_wait_ms": 23.864078996973614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05331873893737793, "StateBufferConnector_ms": 0.0252072811126709, "ViewRequirementAgentConnector_ms": 0.9816431999206543}}, "episode_reward_max": 11.953971337373455, "episode_reward_min": -0.49941780554613013, "episode_reward_mean": 5.976215530740195, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.371570332893103, 5.769236696949708, 4.5524438141901085, 5.468372050819426, 4.544831332163462, 8.147633434932825, 6.332711194858243, 8.673156473283653, 10.420878441409936, 5.407342092635515, 6.2203560369194815, 1.9490799027622037, 5.498266583057605, 6.08156682738608, 5.923561005604466, 8.319107398062693, 10.053804233301996, 2.679632243527191, 6.715355255408523, 6.269371707740958, 0.7066295036097002, -0.40968294320837056, 5.3316233925664225, 8.698643756415603, 8.52697231733399, 7.7471436146772845, 6.071114543376405, 6.836871702992939, 3.0910920582173738, 4.1633984201346195, 8.548211732030358, 5.88071242860367, 8.38529487539118, 6.054261989339138, 7.174139781510899, 0.2809469293833455, 3.813947640439681, 8.285590693702922, 6.267122866901539, 4.025870032002141, 6.4124753731872985, 5.498641812458809, 9.14540708890068, 3.175961000679322, 2.9662867822989787, 3.7813047535140702, 5.132210168468107, 10.190726866699986, 6.417333060922165, 8.556255325070467, 6.88936849743133, 2.5204743431859793, 5.500668313834573, 4.855429499002873, 5.4592879272157795, 5.453836743581726, 9.037644528330059, 1.1398079910073564, 4.148917477150728, 2.5045034121388032, 4.190982934930198, 11.007340309656922, 5.762266830207238, 8.052467669798505, 7.64496236963458, 2.835992085168288, 8.612495820608855, 4.9838325845811156, 5.9907635429641894, 10.412303304613994, 2.33881120566183, 5.41081755845531, 9.840079326369132, 6.732491396616992, 3.2844925200915713, 4.994734727902421, -0.18144330409442708, 7.254801556161376, 8.413443334093243, 8.612206894756445, 11.953971337373455, 3.345465056774458, 8.04612704554641, 9.66611989166121, 8.488451277408323, 8.339265357169024, 8.562468228348637, 6.1693883549367055, 5.480000865972639, 3.562144029491619, 4.9676403431397205, 7.285256714428133, 3.576507166154302, 7.733850747547287, 8.401820227561904, 4.954783436449674, 0.7483498619515853, -0.49941780554613013, 8.36248703239306, 8.618307878672642], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8869416900036464, "mean_inference_ms": 8.023223884124704, "mean_action_processing_ms": 0.5384379462321899, "mean_env_wait_ms": 23.864078996973614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05331873893737793, "StateBufferConnector_ms": 0.0252072811126709, "ViewRequirementAgentConnector_ms": 0.9816431999206543}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6444942, "num_agent_steps_trained": 6444942, "num_env_steps_sampled": 6444942, "num_env_steps_trained": 6444942, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.7207457494777, "num_env_steps_trained_throughput_per_sec": 286.7207457494777, "timesteps_total": 6444942, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6444942, "timers": {"training_iteration_time_ms": 54761.048, "sample_time_ms": 41676.532, "load_time_ms": 1749.237, "load_throughput": 8939.896, "learn_time_ms": 10749.538, "learn_throughput": 1454.76, "synch_weights_time_ms": 454.8}, "counters": {"num_env_steps_sampled": 6444942, "num_env_steps_trained": 6444942, "num_agent_steps_sampled": 6444942, "num_agent_steps_trained": 6444942}, "done": false, "episodes_total": 966, "training_iteration": 417, "trial_id": "2f030_00000", "date": "2025-06-07_08-40-57", "timestamp": 1749278457, "time_this_iter_s": 54.56023597717285, "time_total_s": 3872.6697595119476, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3872.6697595119476, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 77.14032258064518, "ram_util_percent": 66.96290322580644, "gpu_util_percent0": 0.07645161290322582, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.8066247368421045e-05, "total_loss": -0.10004220798780972, "policy_loss": -0.03058125338802876, "vf_loss": 0.014750312316993421, "vf_explained_var": 0.7369264839995991, "kl": 0.016300983845778477, "entropy": 20.946129356731067, "entropy_coeff": 0.004081467499999999}, "model": {}, "num_grad_updates_lifetime": 38225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6460580, "num_env_steps_trained": 6460580, "num_agent_steps_sampled": 6460580, "num_agent_steps_trained": 6460580}, "sampler_results": {"episode_reward_max": 11.953971337373455, "episode_reward_min": -0.49941780554613013, "episode_reward_mean": 5.98324561273641, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.923561005604466, 8.319107398062693, 10.053804233301996, 2.679632243527191, 6.715355255408523, 6.269371707740958, 0.7066295036097002, -0.40968294320837056, 5.3316233925664225, 8.698643756415603, 8.52697231733399, 7.7471436146772845, 6.071114543376405, 6.836871702992939, 3.0910920582173738, 4.1633984201346195, 8.548211732030358, 5.88071242860367, 8.38529487539118, 6.054261989339138, 7.174139781510899, 0.2809469293833455, 3.813947640439681, 8.285590693702922, 6.267122866901539, 4.025870032002141, 6.4124753731872985, 5.498641812458809, 9.14540708890068, 3.175961000679322, 2.9662867822989787, 3.7813047535140702, 5.132210168468107, 10.190726866699986, 6.417333060922165, 8.556255325070467, 6.88936849743133, 2.5204743431859793, 5.500668313834573, 4.855429499002873, 5.4592879272157795, 5.453836743581726, 9.037644528330059, 1.1398079910073564, 4.148917477150728, 2.5045034121388032, 4.190982934930198, 11.007340309656922, 5.762266830207238, 8.052467669798505, 7.64496236963458, 2.835992085168288, 8.612495820608855, 4.9838325845811156, 5.9907635429641894, 10.412303304613994, 2.33881120566183, 5.41081755845531, 9.840079326369132, 6.732491396616992, 3.2844925200915713, 4.994734727902421, -0.18144330409442708, 7.254801556161376, 8.413443334093243, 8.612206894756445, 11.953971337373455, 3.345465056774458, 8.04612704554641, 9.66611989166121, 8.488451277408323, 8.339265357169024, 8.562468228348637, 6.1693883549367055, 5.480000865972639, 3.562144029491619, 4.9676403431397205, 7.285256714428133, 3.576507166154302, 7.733850747547287, 8.401820227561904, 4.954783436449674, 0.7483498619515853, -0.49941780554613013, 8.36248703239306, 8.618307878672642, 7.9791390764415375, 5.049748411480918, 8.2727866024002, 4.374377917257031, 5.174048119377886, 5.695031570335208, 5.852365893080237, 4.734774822262392, 5.582921420390446, 9.21877779190935, 3.7331299802018485, 7.9843603674476675, 6.182416010523781, 6.306575430774218], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8858420579670456, "mean_inference_ms": 8.023999645142775, "mean_action_processing_ms": 0.5385201104080521, "mean_env_wait_ms": 23.86621734772861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05378842353820801, "StateBufferConnector_ms": 0.02615523338317871, "ViewRequirementAgentConnector_ms": 0.9864470958709717}}, "episode_reward_max": 11.953971337373455, "episode_reward_min": -0.49941780554613013, "episode_reward_mean": 5.98324561273641, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.923561005604466, 8.319107398062693, 10.053804233301996, 2.679632243527191, 6.715355255408523, 6.269371707740958, 0.7066295036097002, -0.40968294320837056, 5.3316233925664225, 8.698643756415603, 8.52697231733399, 7.7471436146772845, 6.071114543376405, 6.836871702992939, 3.0910920582173738, 4.1633984201346195, 8.548211732030358, 5.88071242860367, 8.38529487539118, 6.054261989339138, 7.174139781510899, 0.2809469293833455, 3.813947640439681, 8.285590693702922, 6.267122866901539, 4.025870032002141, 6.4124753731872985, 5.498641812458809, 9.14540708890068, 3.175961000679322, 2.9662867822989787, 3.7813047535140702, 5.132210168468107, 10.190726866699986, 6.417333060922165, 8.556255325070467, 6.88936849743133, 2.5204743431859793, 5.500668313834573, 4.855429499002873, 5.4592879272157795, 5.453836743581726, 9.037644528330059, 1.1398079910073564, 4.148917477150728, 2.5045034121388032, 4.190982934930198, 11.007340309656922, 5.762266830207238, 8.052467669798505, 7.64496236963458, 2.835992085168288, 8.612495820608855, 4.9838325845811156, 5.9907635429641894, 10.412303304613994, 2.33881120566183, 5.41081755845531, 9.840079326369132, 6.732491396616992, 3.2844925200915713, 4.994734727902421, -0.18144330409442708, 7.254801556161376, 8.413443334093243, 8.612206894756445, 11.953971337373455, 3.345465056774458, 8.04612704554641, 9.66611989166121, 8.488451277408323, 8.339265357169024, 8.562468228348637, 6.1693883549367055, 5.480000865972639, 3.562144029491619, 4.9676403431397205, 7.285256714428133, 3.576507166154302, 7.733850747547287, 8.401820227561904, 4.954783436449674, 0.7483498619515853, -0.49941780554613013, 8.36248703239306, 8.618307878672642, 7.9791390764415375, 5.049748411480918, 8.2727866024002, 4.374377917257031, 5.174048119377886, 5.695031570335208, 5.852365893080237, 4.734774822262392, 5.582921420390446, 9.21877779190935, 3.7331299802018485, 7.9843603674476675, 6.182416010523781, 6.306575430774218], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8858420579670456, "mean_inference_ms": 8.023999645142775, "mean_action_processing_ms": 0.5385201104080521, "mean_env_wait_ms": 23.86621734772861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05378842353820801, "StateBufferConnector_ms": 0.02615523338317871, "ViewRequirementAgentConnector_ms": 0.9864470958709717}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6460580, "num_agent_steps_trained": 6460580, "num_env_steps_sampled": 6460580, "num_env_steps_trained": 6460580, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.4923354362124, "num_env_steps_trained_throughput_per_sec": 283.4923354362124, "timesteps_total": 6460580, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6460580, "timers": {"training_iteration_time_ms": 54777.836, "sample_time_ms": 41681.633, "load_time_ms": 1760.842, "load_throughput": 8880.981, "learn_time_ms": 10748.434, "learn_throughput": 1454.91, "synch_weights_time_ms": 455.117}, "counters": {"num_env_steps_sampled": 6460580, "num_env_steps_trained": 6460580, "num_agent_steps_sampled": 6460580, "num_agent_steps_trained": 6460580}, "done": false, "episodes_total": 980, "training_iteration": 418, "trial_id": "2f030_00000", "date": "2025-06-07_08-41-52", "timestamp": 1749278512, "time_this_iter_s": 55.177430152893066, "time_total_s": 3927.8471896648407, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3927.8471896648407, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 77.14761904761905, "ram_util_percent": 66.74920634920635, "gpu_util_percent0": 0.08412698412698413, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.794278947368422e-05, "total_loss": -0.09423886868594722, "policy_loss": -0.025870551393467892, "vf_loss": 0.015261440751227465, "vf_explained_var": 0.7525861852819269, "kl": 0.016008361377560253, "entropy": 20.96619338642467, "entropy_coeff": 0.004022824999999999}, "model": {}, "num_grad_updates_lifetime": 38775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6476218, "num_env_steps_trained": 6476218, "num_agent_steps_sampled": 6476218, "num_agent_steps_trained": 6476218}, "sampler_results": {"episode_reward_max": 11.953971337373455, "episode_reward_min": -0.49941780554613013, "episode_reward_mean": 5.953727919670185, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0910920582173738, 4.1633984201346195, 8.548211732030358, 5.88071242860367, 8.38529487539118, 6.054261989339138, 7.174139781510899, 0.2809469293833455, 3.813947640439681, 8.285590693702922, 6.267122866901539, 4.025870032002141, 6.4124753731872985, 5.498641812458809, 9.14540708890068, 3.175961000679322, 2.9662867822989787, 3.7813047535140702, 5.132210168468107, 10.190726866699986, 6.417333060922165, 8.556255325070467, 6.88936849743133, 2.5204743431859793, 5.500668313834573, 4.855429499002873, 5.4592879272157795, 5.453836743581726, 9.037644528330059, 1.1398079910073564, 4.148917477150728, 2.5045034121388032, 4.190982934930198, 11.007340309656922, 5.762266830207238, 8.052467669798505, 7.64496236963458, 2.835992085168288, 8.612495820608855, 4.9838325845811156, 5.9907635429641894, 10.412303304613994, 2.33881120566183, 5.41081755845531, 9.840079326369132, 6.732491396616992, 3.2844925200915713, 4.994734727902421, -0.18144330409442708, 7.254801556161376, 8.413443334093243, 8.612206894756445, 11.953971337373455, 3.345465056774458, 8.04612704554641, 9.66611989166121, 8.488451277408323, 8.339265357169024, 8.562468228348637, 6.1693883549367055, 5.480000865972639, 3.562144029491619, 4.9676403431397205, 7.285256714428133, 3.576507166154302, 7.733850747547287, 8.401820227561904, 4.954783436449674, 0.7483498619515853, -0.49941780554613013, 8.36248703239306, 8.618307878672642, 7.9791390764415375, 5.049748411480918, 8.2727866024002, 4.374377917257031, 5.174048119377886, 5.695031570335208, 5.852365893080237, 4.734774822262392, 5.582921420390446, 9.21877779190935, 3.7331299802018485, 7.9843603674476675, 6.182416010523781, 6.306575430774218, 6.258643469239331, 8.092911478358877, 7.1497844931697925, 7.4691213735666295, 1.7591427870592644, 5.4245310942096285, 7.5806422329002325, 4.616063724249796, 7.193777108852462, 3.8338783961381915, 3.464668577483207, 9.230243222106212, 4.121928276791774, 4.323042190662009], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.884280571532305, "mean_inference_ms": 8.024909390075235, "mean_action_processing_ms": 0.5386138160406021, "mean_env_wait_ms": 23.868900495781418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05381631851196289, "StateBufferConnector_ms": 0.027036666870117188, "ViewRequirementAgentConnector_ms": 0.9800033569335938}}, "episode_reward_max": 11.953971337373455, "episode_reward_min": -0.49941780554613013, "episode_reward_mean": 5.953727919670185, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.0910920582173738, 4.1633984201346195, 8.548211732030358, 5.88071242860367, 8.38529487539118, 6.054261989339138, 7.174139781510899, 0.2809469293833455, 3.813947640439681, 8.285590693702922, 6.267122866901539, 4.025870032002141, 6.4124753731872985, 5.498641812458809, 9.14540708890068, 3.175961000679322, 2.9662867822989787, 3.7813047535140702, 5.132210168468107, 10.190726866699986, 6.417333060922165, 8.556255325070467, 6.88936849743133, 2.5204743431859793, 5.500668313834573, 4.855429499002873, 5.4592879272157795, 5.453836743581726, 9.037644528330059, 1.1398079910073564, 4.148917477150728, 2.5045034121388032, 4.190982934930198, 11.007340309656922, 5.762266830207238, 8.052467669798505, 7.64496236963458, 2.835992085168288, 8.612495820608855, 4.9838325845811156, 5.9907635429641894, 10.412303304613994, 2.33881120566183, 5.41081755845531, 9.840079326369132, 6.732491396616992, 3.2844925200915713, 4.994734727902421, -0.18144330409442708, 7.254801556161376, 8.413443334093243, 8.612206894756445, 11.953971337373455, 3.345465056774458, 8.04612704554641, 9.66611989166121, 8.488451277408323, 8.339265357169024, 8.562468228348637, 6.1693883549367055, 5.480000865972639, 3.562144029491619, 4.9676403431397205, 7.285256714428133, 3.576507166154302, 7.733850747547287, 8.401820227561904, 4.954783436449674, 0.7483498619515853, -0.49941780554613013, 8.36248703239306, 8.618307878672642, 7.9791390764415375, 5.049748411480918, 8.2727866024002, 4.374377917257031, 5.174048119377886, 5.695031570335208, 5.852365893080237, 4.734774822262392, 5.582921420390446, 9.21877779190935, 3.7331299802018485, 7.9843603674476675, 6.182416010523781, 6.306575430774218, 6.258643469239331, 8.092911478358877, 7.1497844931697925, 7.4691213735666295, 1.7591427870592644, 5.4245310942096285, 7.5806422329002325, 4.616063724249796, 7.193777108852462, 3.8338783961381915, 3.464668577483207, 9.230243222106212, 4.121928276791774, 4.323042190662009], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.884280571532305, "mean_inference_ms": 8.024909390075235, "mean_action_processing_ms": 0.5386138160406021, "mean_env_wait_ms": 23.868900495781418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05381631851196289, "StateBufferConnector_ms": 0.027036666870117188, "ViewRequirementAgentConnector_ms": 0.9800033569335938}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6476218, "num_agent_steps_trained": 6476218, "num_env_steps_sampled": 6476218, "num_env_steps_trained": 6476218, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.53642359274045, "num_env_steps_trained_throughput_per_sec": 283.53642359274045, "timesteps_total": 6476218, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6476218, "timers": {"training_iteration_time_ms": 54847.294, "sample_time_ms": 41765.855, "load_time_ms": 1754.138, "load_throughput": 8914.922, "learn_time_ms": 10739.603, "learn_throughput": 1456.106, "synch_weights_time_ms": 457.039}, "counters": {"num_env_steps_sampled": 6476218, "num_env_steps_trained": 6476218, "num_agent_steps_sampled": 6476218, "num_agent_steps_trained": 6476218}, "done": false, "episodes_total": 994, "training_iteration": 419, "trial_id": "2f030_00000", "date": "2025-06-07_08-42-48", "timestamp": 1749278568, "time_this_iter_s": 55.17424416542053, "time_total_s": 3983.0214338302612, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3983.0214338302612, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 77.2109375, "ram_util_percent": 66.884375, "gpu_util_percent0": 0.07765625, "vram_util_percent0": 0.8592122395833333}}
{"evaluation": {"sampler_results": {"episode_reward_max": -4.105465153896736, "episode_reward_min": -7.584168563805602, "episode_reward_mean": -6.068120204466679, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.127459320076601, -6.462773694604897, -7.060734289949553, -4.105465153896736, -7.584168563805602], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4536550488424698, "mean_inference_ms": 3.9495630216345874, "mean_action_processing_ms": 0.2863783500162484, "mean_env_wait_ms": 10.422403665684339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5042695999145508}}, "episode_reward_max": -4.105465153896736, "episode_reward_min": -7.584168563805602, "episode_reward_mean": -6.068120204466679, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.127459320076601, -6.462773694604897, -7.060734289949553, -4.105465153896736, -7.584168563805602], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4536550488424698, "mean_inference_ms": 3.9495630216345874, "mean_action_processing_ms": 0.2863783500162484, "mean_env_wait_ms": 10.422403665684339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5042695999145508}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.781933157894736e-05, "total_loss": -0.09751302716195245, "policy_loss": -0.030846763832854444, "vf_loss": 0.015417251982302827, "vf_explained_var": 0.7277165538614446, "kl": 0.016174637043056796, "entropy": 20.888642664822665, "entropy_coeff": 0.0039641825}, "model": {}, "num_grad_updates_lifetime": 39325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6491856, "num_env_steps_trained": 6491856, "num_agent_steps_sampled": 6491856, "num_agent_steps_trained": 6491856}, "sampler_results": {"episode_reward_max": 11.953971337373455, "episode_reward_min": -0.49941780554613013, "episode_reward_mean": 6.074654042765734, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.14540708890068, 3.175961000679322, 2.9662867822989787, 3.7813047535140702, 5.132210168468107, 10.190726866699986, 6.417333060922165, 8.556255325070467, 6.88936849743133, 2.5204743431859793, 5.500668313834573, 4.855429499002873, 5.4592879272157795, 5.453836743581726, 9.037644528330059, 1.1398079910073564, 4.148917477150728, 2.5045034121388032, 4.190982934930198, 11.007340309656922, 5.762266830207238, 8.052467669798505, 7.64496236963458, 2.835992085168288, 8.612495820608855, 4.9838325845811156, 5.9907635429641894, 10.412303304613994, 2.33881120566183, 5.41081755845531, 9.840079326369132, 6.732491396616992, 3.2844925200915713, 4.994734727902421, -0.18144330409442708, 7.254801556161376, 8.413443334093243, 8.612206894756445, 11.953971337373455, 3.345465056774458, 8.04612704554641, 9.66611989166121, 8.488451277408323, 8.339265357169024, 8.562468228348637, 6.1693883549367055, 5.480000865972639, 3.562144029491619, 4.9676403431397205, 7.285256714428133, 3.576507166154302, 7.733850747547287, 8.401820227561904, 4.954783436449674, 0.7483498619515853, -0.49941780554613013, 8.36248703239306, 8.618307878672642, 7.9791390764415375, 5.049748411480918, 8.2727866024002, 4.374377917257031, 5.174048119377886, 5.695031570335208, 5.852365893080237, 4.734774822262392, 5.582921420390446, 9.21877779190935, 3.7331299802018485, 7.9843603674476675, 6.182416010523781, 6.306575430774218, 6.258643469239331, 8.092911478358877, 7.1497844931697925, 7.4691213735666295, 1.7591427870592644, 5.4245310942096285, 7.5806422329002325, 4.616063724249796, 7.193777108852462, 3.8338783961381915, 3.464668577483207, 9.230243222106212, 4.121928276791774, 4.323042190662009, 4.3731518250192805, 8.711153408472258, 9.85522458969512, 8.175604278471756, 4.57492482471714, 5.782210918909018, 2.619572570643775, 1.7410309387250866, 6.783703752443114, 9.584593531815788, 4.967624819799724, 7.040045438492236, 9.225325830422422, 6.5401522152310045], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.882947837290709, "mean_inference_ms": 8.025872800535646, "mean_action_processing_ms": 0.5387291839301596, "mean_env_wait_ms": 23.87203623703333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0528411865234375, "StateBufferConnector_ms": 0.02404165267944336, "ViewRequirementAgentConnector_ms": 0.9878814220428467}}, "episode_reward_max": 11.953971337373455, "episode_reward_min": -0.49941780554613013, "episode_reward_mean": 6.074654042765734, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.14540708890068, 3.175961000679322, 2.9662867822989787, 3.7813047535140702, 5.132210168468107, 10.190726866699986, 6.417333060922165, 8.556255325070467, 6.88936849743133, 2.5204743431859793, 5.500668313834573, 4.855429499002873, 5.4592879272157795, 5.453836743581726, 9.037644528330059, 1.1398079910073564, 4.148917477150728, 2.5045034121388032, 4.190982934930198, 11.007340309656922, 5.762266830207238, 8.052467669798505, 7.64496236963458, 2.835992085168288, 8.612495820608855, 4.9838325845811156, 5.9907635429641894, 10.412303304613994, 2.33881120566183, 5.41081755845531, 9.840079326369132, 6.732491396616992, 3.2844925200915713, 4.994734727902421, -0.18144330409442708, 7.254801556161376, 8.413443334093243, 8.612206894756445, 11.953971337373455, 3.345465056774458, 8.04612704554641, 9.66611989166121, 8.488451277408323, 8.339265357169024, 8.562468228348637, 6.1693883549367055, 5.480000865972639, 3.562144029491619, 4.9676403431397205, 7.285256714428133, 3.576507166154302, 7.733850747547287, 8.401820227561904, 4.954783436449674, 0.7483498619515853, -0.49941780554613013, 8.36248703239306, 8.618307878672642, 7.9791390764415375, 5.049748411480918, 8.2727866024002, 4.374377917257031, 5.174048119377886, 5.695031570335208, 5.852365893080237, 4.734774822262392, 5.582921420390446, 9.21877779190935, 3.7331299802018485, 7.9843603674476675, 6.182416010523781, 6.306575430774218, 6.258643469239331, 8.092911478358877, 7.1497844931697925, 7.4691213735666295, 1.7591427870592644, 5.4245310942096285, 7.5806422329002325, 4.616063724249796, 7.193777108852462, 3.8338783961381915, 3.464668577483207, 9.230243222106212, 4.121928276791774, 4.323042190662009, 4.3731518250192805, 8.711153408472258, 9.85522458969512, 8.175604278471756, 4.57492482471714, 5.782210918909018, 2.619572570643775, 1.7410309387250866, 6.783703752443114, 9.584593531815788, 4.967624819799724, 7.040045438492236, 9.225325830422422, 6.5401522152310045], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.882947837290709, "mean_inference_ms": 8.025872800535646, "mean_action_processing_ms": 0.5387291839301596, "mean_env_wait_ms": 23.87203623703333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0528411865234375, "StateBufferConnector_ms": 0.02404165267944336, "ViewRequirementAgentConnector_ms": 0.9878814220428467}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6491856, "num_agent_steps_trained": 6491856, "num_env_steps_sampled": 6491856, "num_env_steps_trained": 6491856, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.49028875942474, "num_env_steps_trained_throughput_per_sec": 285.49028875942474, "timesteps_total": 6491856, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6491856, "timers": {"training_iteration_time_ms": 54842.624, "sample_time_ms": 41784.216, "load_time_ms": 1748.79, "load_throughput": 8942.182, "learn_time_ms": 10718.576, "learn_throughput": 1458.963, "synch_weights_time_ms": 462.074}, "counters": {"num_env_steps_sampled": 6491856, "num_env_steps_trained": 6491856, "num_agent_steps_sampled": 6491856, "num_agent_steps_trained": 6491856}, "done": false, "episodes_total": 1008, "training_iteration": 420, "trial_id": "2f030_00000", "date": "2025-06-07_08-43-57", "timestamp": 1749278637, "time_this_iter_s": 69.3860182762146, "time_total_s": 4052.407452106476, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4052.407452106476, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 65.02716049382715, "ram_util_percent": 66.97777777777777, "gpu_util_percent0": 0.0682716049382716, "vram_util_percent0": 0.8592122395833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.7695873684210526e-05, "total_loss": -0.09058395398780704, "policy_loss": -0.024477977721967775, "vf_loss": 0.015952595828778365, "vf_explained_var": 0.7097508477080952, "kl": 0.015593783120067185, "entropy": 20.994071769714356, "entropy_coeff": 0.00390554}, "model": {}, "num_grad_updates_lifetime": 39875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6507494, "num_env_steps_trained": 6507494, "num_agent_steps_sampled": 6507494, "num_agent_steps_trained": 6507494}, "sampler_results": {"episode_reward_max": 11.953971337373455, "episode_reward_min": -0.49941780554613013, "episode_reward_mean": 6.044642306665869, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.037644528330059, 1.1398079910073564, 4.148917477150728, 2.5045034121388032, 4.190982934930198, 11.007340309656922, 5.762266830207238, 8.052467669798505, 7.64496236963458, 2.835992085168288, 8.612495820608855, 4.9838325845811156, 5.9907635429641894, 10.412303304613994, 2.33881120566183, 5.41081755845531, 9.840079326369132, 6.732491396616992, 3.2844925200915713, 4.994734727902421, -0.18144330409442708, 7.254801556161376, 8.413443334093243, 8.612206894756445, 11.953971337373455, 3.345465056774458, 8.04612704554641, 9.66611989166121, 8.488451277408323, 8.339265357169024, 8.562468228348637, 6.1693883549367055, 5.480000865972639, 3.562144029491619, 4.9676403431397205, 7.285256714428133, 3.576507166154302, 7.733850747547287, 8.401820227561904, 4.954783436449674, 0.7483498619515853, -0.49941780554613013, 8.36248703239306, 8.618307878672642, 7.9791390764415375, 5.049748411480918, 8.2727866024002, 4.374377917257031, 5.174048119377886, 5.695031570335208, 5.852365893080237, 4.734774822262392, 5.582921420390446, 9.21877779190935, 3.7331299802018485, 7.9843603674476675, 6.182416010523781, 6.306575430774218, 6.258643469239331, 8.092911478358877, 7.1497844931697925, 7.4691213735666295, 1.7591427870592644, 5.4245310942096285, 7.5806422329002325, 4.616063724249796, 7.193777108852462, 3.8338783961381915, 3.464668577483207, 9.230243222106212, 4.121928276791774, 4.323042190662009, 4.3731518250192805, 8.711153408472258, 9.85522458969512, 8.175604278471756, 4.57492482471714, 5.782210918909018, 2.619572570643775, 1.7410309387250866, 6.783703752443114, 9.584593531815788, 4.967624819799724, 7.040045438492236, 9.225325830422422, 6.5401522152310045, 8.720808751906526, 4.111970375779068, 4.782513055482385, 6.051351317448613, 5.6853881007351195, 8.744127582126591, 7.328097797022062, 7.659669643701692, 1.9086189021895643, 0.5101285993838712, 2.363864344157503, 7.297572944981539, 6.943376316695626, 4.935889029209549], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.881900209733376, "mean_inference_ms": 8.026665991423535, "mean_action_processing_ms": 0.5388181878580559, "mean_env_wait_ms": 23.87489761092203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043579816818237305, "StateBufferConnector_ms": 0.019449234008789062, "ViewRequirementAgentConnector_ms": 0.9718837738037109}}, "episode_reward_max": 11.953971337373455, "episode_reward_min": -0.49941780554613013, "episode_reward_mean": 6.044642306665869, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.037644528330059, 1.1398079910073564, 4.148917477150728, 2.5045034121388032, 4.190982934930198, 11.007340309656922, 5.762266830207238, 8.052467669798505, 7.64496236963458, 2.835992085168288, 8.612495820608855, 4.9838325845811156, 5.9907635429641894, 10.412303304613994, 2.33881120566183, 5.41081755845531, 9.840079326369132, 6.732491396616992, 3.2844925200915713, 4.994734727902421, -0.18144330409442708, 7.254801556161376, 8.413443334093243, 8.612206894756445, 11.953971337373455, 3.345465056774458, 8.04612704554641, 9.66611989166121, 8.488451277408323, 8.339265357169024, 8.562468228348637, 6.1693883549367055, 5.480000865972639, 3.562144029491619, 4.9676403431397205, 7.285256714428133, 3.576507166154302, 7.733850747547287, 8.401820227561904, 4.954783436449674, 0.7483498619515853, -0.49941780554613013, 8.36248703239306, 8.618307878672642, 7.9791390764415375, 5.049748411480918, 8.2727866024002, 4.374377917257031, 5.174048119377886, 5.695031570335208, 5.852365893080237, 4.734774822262392, 5.582921420390446, 9.21877779190935, 3.7331299802018485, 7.9843603674476675, 6.182416010523781, 6.306575430774218, 6.258643469239331, 8.092911478358877, 7.1497844931697925, 7.4691213735666295, 1.7591427870592644, 5.4245310942096285, 7.5806422329002325, 4.616063724249796, 7.193777108852462, 3.8338783961381915, 3.464668577483207, 9.230243222106212, 4.121928276791774, 4.323042190662009, 4.3731518250192805, 8.711153408472258, 9.85522458969512, 8.175604278471756, 4.57492482471714, 5.782210918909018, 2.619572570643775, 1.7410309387250866, 6.783703752443114, 9.584593531815788, 4.967624819799724, 7.040045438492236, 9.225325830422422, 6.5401522152310045, 8.720808751906526, 4.111970375779068, 4.782513055482385, 6.051351317448613, 5.6853881007351195, 8.744127582126591, 7.328097797022062, 7.659669643701692, 1.9086189021895643, 0.5101285993838712, 2.363864344157503, 7.297572944981539, 6.943376316695626, 4.935889029209549], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.881900209733376, "mean_inference_ms": 8.026665991423535, "mean_action_processing_ms": 0.5388181878580559, "mean_env_wait_ms": 23.87489761092203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043579816818237305, "StateBufferConnector_ms": 0.019449234008789062, "ViewRequirementAgentConnector_ms": 0.9718837738037109}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6507494, "num_agent_steps_trained": 6507494, "num_env_steps_sampled": 6507494, "num_env_steps_trained": 6507494, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.0200833938743, "num_env_steps_trained_throughput_per_sec": 286.0200833938743, "timesteps_total": 6507494, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6507494, "timers": {"training_iteration_time_ms": 54822.246, "sample_time_ms": 41764.544, "load_time_ms": 1752.359, "load_throughput": 8923.971, "learn_time_ms": 10711.952, "learn_throughput": 1459.865, "synch_weights_time_ms": 459.664}, "counters": {"num_env_steps_sampled": 6507494, "num_env_steps_trained": 6507494, "num_agent_steps_sampled": 6507494, "num_agent_steps_trained": 6507494}, "done": false, "episodes_total": 1022, "training_iteration": 421, "trial_id": "2f030_00000", "date": "2025-06-07_08-44-52", "timestamp": 1749278692, "time_this_iter_s": 54.68848443031311, "time_total_s": 4107.095936536789, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4107.095936536789, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 77.07777777777777, "ram_util_percent": 67.45396825396824, "gpu_util_percent0": 0.07825396825396826, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.757241578947368e-05, "total_loss": -0.09180415312886576, "policy_loss": -0.02643989307132539, "vf_loss": 0.013696632573211735, "vf_explained_var": 0.7285431866212325, "kl": 0.015886222787473935, "entropy": 20.999487228393555, "entropy_coeff": 0.0038468975000000003}, "model": {}, "num_grad_updates_lifetime": 40425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6523132, "num_env_steps_trained": 6523132, "num_agent_steps_sampled": 6523132, "num_agent_steps_trained": 6523132}, "sampler_results": {"episode_reward_max": 11.953971337373455, "episode_reward_min": -0.49941780554613013, "episode_reward_mean": 6.000404787523815, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.33881120566183, 5.41081755845531, 9.840079326369132, 6.732491396616992, 3.2844925200915713, 4.994734727902421, -0.18144330409442708, 7.254801556161376, 8.413443334093243, 8.612206894756445, 11.953971337373455, 3.345465056774458, 8.04612704554641, 9.66611989166121, 8.488451277408323, 8.339265357169024, 8.562468228348637, 6.1693883549367055, 5.480000865972639, 3.562144029491619, 4.9676403431397205, 7.285256714428133, 3.576507166154302, 7.733850747547287, 8.401820227561904, 4.954783436449674, 0.7483498619515853, -0.49941780554613013, 8.36248703239306, 8.618307878672642, 7.9791390764415375, 5.049748411480918, 8.2727866024002, 4.374377917257031, 5.174048119377886, 5.695031570335208, 5.852365893080237, 4.734774822262392, 5.582921420390446, 9.21877779190935, 3.7331299802018485, 7.9843603674476675, 6.182416010523781, 6.306575430774218, 6.258643469239331, 8.092911478358877, 7.1497844931697925, 7.4691213735666295, 1.7591427870592644, 5.4245310942096285, 7.5806422329002325, 4.616063724249796, 7.193777108852462, 3.8338783961381915, 3.464668577483207, 9.230243222106212, 4.121928276791774, 4.323042190662009, 4.3731518250192805, 8.711153408472258, 9.85522458969512, 8.175604278471756, 4.57492482471714, 5.782210918909018, 2.619572570643775, 1.7410309387250866, 6.783703752443114, 9.584593531815788, 4.967624819799724, 7.040045438492236, 9.225325830422422, 6.5401522152310045, 8.720808751906526, 4.111970375779068, 4.782513055482385, 6.051351317448613, 5.6853881007351195, 8.744127582126591, 7.328097797022062, 7.659669643701692, 1.9086189021895643, 0.5101285993838712, 2.363864344157503, 7.297572944981539, 6.943376316695626, 4.935889029209549, 7.064769895042706, 6.055286236962337, 5.646376638917601, 6.217194689109895, 6.892949722380429, 4.1627384056202485, 5.446498259041172, 6.070648859390228, 6.862922749511409, 7.524832588926439, 3.795405681478845, 5.5297394856185775, 6.084661693648042, 4.546504040937324], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.880897713370916, "mean_inference_ms": 8.027312919520817, "mean_action_processing_ms": 0.538908835603174, "mean_env_wait_ms": 23.877705501929764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03393697738647461, "StateBufferConnector_ms": 0.0233917236328125, "ViewRequirementAgentConnector_ms": 0.9945952892303467}}, "episode_reward_max": 11.953971337373455, "episode_reward_min": -0.49941780554613013, "episode_reward_mean": 6.000404787523815, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.33881120566183, 5.41081755845531, 9.840079326369132, 6.732491396616992, 3.2844925200915713, 4.994734727902421, -0.18144330409442708, 7.254801556161376, 8.413443334093243, 8.612206894756445, 11.953971337373455, 3.345465056774458, 8.04612704554641, 9.66611989166121, 8.488451277408323, 8.339265357169024, 8.562468228348637, 6.1693883549367055, 5.480000865972639, 3.562144029491619, 4.9676403431397205, 7.285256714428133, 3.576507166154302, 7.733850747547287, 8.401820227561904, 4.954783436449674, 0.7483498619515853, -0.49941780554613013, 8.36248703239306, 8.618307878672642, 7.9791390764415375, 5.049748411480918, 8.2727866024002, 4.374377917257031, 5.174048119377886, 5.695031570335208, 5.852365893080237, 4.734774822262392, 5.582921420390446, 9.21877779190935, 3.7331299802018485, 7.9843603674476675, 6.182416010523781, 6.306575430774218, 6.258643469239331, 8.092911478358877, 7.1497844931697925, 7.4691213735666295, 1.7591427870592644, 5.4245310942096285, 7.5806422329002325, 4.616063724249796, 7.193777108852462, 3.8338783961381915, 3.464668577483207, 9.230243222106212, 4.121928276791774, 4.323042190662009, 4.3731518250192805, 8.711153408472258, 9.85522458969512, 8.175604278471756, 4.57492482471714, 5.782210918909018, 2.619572570643775, 1.7410309387250866, 6.783703752443114, 9.584593531815788, 4.967624819799724, 7.040045438492236, 9.225325830422422, 6.5401522152310045, 8.720808751906526, 4.111970375779068, 4.782513055482385, 6.051351317448613, 5.6853881007351195, 8.744127582126591, 7.328097797022062, 7.659669643701692, 1.9086189021895643, 0.5101285993838712, 2.363864344157503, 7.297572944981539, 6.943376316695626, 4.935889029209549, 7.064769895042706, 6.055286236962337, 5.646376638917601, 6.217194689109895, 6.892949722380429, 4.1627384056202485, 5.446498259041172, 6.070648859390228, 6.862922749511409, 7.524832588926439, 3.795405681478845, 5.5297394856185775, 6.084661693648042, 4.546504040937324], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.880897713370916, "mean_inference_ms": 8.027312919520817, "mean_action_processing_ms": 0.538908835603174, "mean_env_wait_ms": 23.877705501929764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03393697738647461, "StateBufferConnector_ms": 0.0233917236328125, "ViewRequirementAgentConnector_ms": 0.9945952892303467}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6523132, "num_agent_steps_trained": 6523132, "num_env_steps_sampled": 6523132, "num_env_steps_trained": 6523132, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 287.595182881139, "num_env_steps_trained_throughput_per_sec": 287.595182881139, "timesteps_total": 6523132, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6523132, "timers": {"training_iteration_time_ms": 54765.76, "sample_time_ms": 41714.86, "load_time_ms": 1745.541, "load_throughput": 8958.828, "learn_time_ms": 10712.845, "learn_throughput": 1459.743, "synch_weights_time_ms": 457.187}, "counters": {"num_env_steps_sampled": 6523132, "num_env_steps_trained": 6523132, "num_agent_steps_sampled": 6523132, "num_agent_steps_trained": 6523132}, "done": false, "episodes_total": 1036, "training_iteration": 422, "trial_id": "2f030_00000", "date": "2025-06-07_08-45-46", "timestamp": 1749278746, "time_this_iter_s": 54.397045612335205, "time_total_s": 4161.492982149124, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4161.492982149124, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 78.64516129032258, "ram_util_percent": 67.25806451612904, "gpu_util_percent0": 0.07935483870967744, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.7448957894736835e-05, "total_loss": -0.09256408500527455, "policy_loss": -0.029067226377665064, "vf_loss": 0.015970832922241905, "vf_explained_var": 0.7230818637934598, "kl": 0.015661225986934202, "entropy": 20.969432634873822, "entropy_coeff": 0.003788255000000001}, "model": {}, "num_grad_updates_lifetime": 40975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6538770, "num_env_steps_trained": 6538770, "num_agent_steps_sampled": 6538770, "num_agent_steps_trained": 6538770}, "sampler_results": {"episode_reward_max": 9.85522458969512, "episode_reward_min": -0.8056592577634418, "episode_reward_mean": 5.92320943490142, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.488451277408323, 8.339265357169024, 8.562468228348637, 6.1693883549367055, 5.480000865972639, 3.562144029491619, 4.9676403431397205, 7.285256714428133, 3.576507166154302, 7.733850747547287, 8.401820227561904, 4.954783436449674, 0.7483498619515853, -0.49941780554613013, 8.36248703239306, 8.618307878672642, 7.9791390764415375, 5.049748411480918, 8.2727866024002, 4.374377917257031, 5.174048119377886, 5.695031570335208, 5.852365893080237, 4.734774822262392, 5.582921420390446, 9.21877779190935, 3.7331299802018485, 7.9843603674476675, 6.182416010523781, 6.306575430774218, 6.258643469239331, 8.092911478358877, 7.1497844931697925, 7.4691213735666295, 1.7591427870592644, 5.4245310942096285, 7.5806422329002325, 4.616063724249796, 7.193777108852462, 3.8338783961381915, 3.464668577483207, 9.230243222106212, 4.121928276791774, 4.323042190662009, 4.3731518250192805, 8.711153408472258, 9.85522458969512, 8.175604278471756, 4.57492482471714, 5.782210918909018, 2.619572570643775, 1.7410309387250866, 6.783703752443114, 9.584593531815788, 4.967624819799724, 7.040045438492236, 9.225325830422422, 6.5401522152310045, 8.720808751906526, 4.111970375779068, 4.782513055482385, 6.051351317448613, 5.6853881007351195, 8.744127582126591, 7.328097797022062, 7.659669643701692, 1.9086189021895643, 0.5101285993838712, 2.363864344157503, 7.297572944981539, 6.943376316695626, 4.935889029209549, 7.064769895042706, 6.055286236962337, 5.646376638917601, 6.217194689109895, 6.892949722380429, 4.1627384056202485, 5.446498259041172, 6.070648859390228, 6.862922749511409, 7.524832588926439, 3.795405681478845, 5.5297394856185775, 6.084661693648042, 4.546504040937324, 4.192438063357491, -0.8056592577634418, 5.9708401532334525, 8.424730156088495, 7.018746871781076, 9.270307395687158, 6.475986017217127, 5.631480464208457, 2.4373883426813308, 8.327230311070505, 2.1142218835052096, 6.682843129903686, 9.677867278453062, 6.574162475706483], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.880213562334817, "mean_inference_ms": 8.027785899242089, "mean_action_processing_ms": 0.5389614604206586, "mean_env_wait_ms": 23.879629163774915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03515625, "StateBufferConnector_ms": 0.022100448608398438, "ViewRequirementAgentConnector_ms": 1.0019714832305908}}, "episode_reward_max": 9.85522458969512, "episode_reward_min": -0.8056592577634418, "episode_reward_mean": 5.92320943490142, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.488451277408323, 8.339265357169024, 8.562468228348637, 6.1693883549367055, 5.480000865972639, 3.562144029491619, 4.9676403431397205, 7.285256714428133, 3.576507166154302, 7.733850747547287, 8.401820227561904, 4.954783436449674, 0.7483498619515853, -0.49941780554613013, 8.36248703239306, 8.618307878672642, 7.9791390764415375, 5.049748411480918, 8.2727866024002, 4.374377917257031, 5.174048119377886, 5.695031570335208, 5.852365893080237, 4.734774822262392, 5.582921420390446, 9.21877779190935, 3.7331299802018485, 7.9843603674476675, 6.182416010523781, 6.306575430774218, 6.258643469239331, 8.092911478358877, 7.1497844931697925, 7.4691213735666295, 1.7591427870592644, 5.4245310942096285, 7.5806422329002325, 4.616063724249796, 7.193777108852462, 3.8338783961381915, 3.464668577483207, 9.230243222106212, 4.121928276791774, 4.323042190662009, 4.3731518250192805, 8.711153408472258, 9.85522458969512, 8.175604278471756, 4.57492482471714, 5.782210918909018, 2.619572570643775, 1.7410309387250866, 6.783703752443114, 9.584593531815788, 4.967624819799724, 7.040045438492236, 9.225325830422422, 6.5401522152310045, 8.720808751906526, 4.111970375779068, 4.782513055482385, 6.051351317448613, 5.6853881007351195, 8.744127582126591, 7.328097797022062, 7.659669643701692, 1.9086189021895643, 0.5101285993838712, 2.363864344157503, 7.297572944981539, 6.943376316695626, 4.935889029209549, 7.064769895042706, 6.055286236962337, 5.646376638917601, 6.217194689109895, 6.892949722380429, 4.1627384056202485, 5.446498259041172, 6.070648859390228, 6.862922749511409, 7.524832588926439, 3.795405681478845, 5.5297394856185775, 6.084661693648042, 4.546504040937324, 4.192438063357491, -0.8056592577634418, 5.9708401532334525, 8.424730156088495, 7.018746871781076, 9.270307395687158, 6.475986017217127, 5.631480464208457, 2.4373883426813308, 8.327230311070505, 2.1142218835052096, 6.682843129903686, 9.677867278453062, 6.574162475706483], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.880213562334817, "mean_inference_ms": 8.027785899242089, "mean_action_processing_ms": 0.5389614604206586, "mean_env_wait_ms": 23.879629163774915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03515625, "StateBufferConnector_ms": 0.022100448608398438, "ViewRequirementAgentConnector_ms": 1.0019714832305908}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6538770, "num_agent_steps_trained": 6538770, "num_env_steps_sampled": 6538770, "num_env_steps_trained": 6538770, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 287.96936237781006, "num_env_steps_trained_throughput_per_sec": 287.96936237781006, "timesteps_total": 6538770, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6538770, "timers": {"training_iteration_time_ms": 54723.451, "sample_time_ms": 41700.15, "load_time_ms": 1748.347, "load_throughput": 8944.447, "learn_time_ms": 10719.606, "learn_throughput": 1458.822, "synch_weights_time_ms": 424.463}, "counters": {"num_env_steps_sampled": 6538770, "num_env_steps_trained": 6538770, "num_agent_steps_sampled": 6538770, "num_agent_steps_trained": 6538770}, "done": false, "episodes_total": 1050, "training_iteration": 423, "trial_id": "2f030_00000", "date": "2025-06-07_08-46-41", "timestamp": 1749278801, "time_this_iter_s": 54.320374727249146, "time_total_s": 4215.813356876373, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4215.813356876373, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 77.13387096774193, "ram_util_percent": 67.35483870967744, "gpu_util_percent0": 0.07838709677419356, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.732549999999999e-05, "total_loss": -0.09134217002513734, "policy_loss": -0.028333490836243567, "vf_loss": 0.015024233851581812, "vf_explained_var": 0.7067607889392159, "kl": 0.015394308338387109, "entropy": 21.041160170815207, "entropy_coeff": 0.0037296124999999995}, "model": {}, "num_grad_updates_lifetime": 41525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6554408, "num_env_steps_trained": 6554408, "num_agent_steps_sampled": 6554408, "num_agent_steps_trained": 6554408}, "sampler_results": {"episode_reward_max": 9.85522458969512, "episode_reward_min": -2.131815413562229, "episode_reward_mean": 5.972943687752032, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.36248703239306, 8.618307878672642, 7.9791390764415375, 5.049748411480918, 8.2727866024002, 4.374377917257031, 5.174048119377886, 5.695031570335208, 5.852365893080237, 4.734774822262392, 5.582921420390446, 9.21877779190935, 3.7331299802018485, 7.9843603674476675, 6.182416010523781, 6.306575430774218, 6.258643469239331, 8.092911478358877, 7.1497844931697925, 7.4691213735666295, 1.7591427870592644, 5.4245310942096285, 7.5806422329002325, 4.616063724249796, 7.193777108852462, 3.8338783961381915, 3.464668577483207, 9.230243222106212, 4.121928276791774, 4.323042190662009, 4.3731518250192805, 8.711153408472258, 9.85522458969512, 8.175604278471756, 4.57492482471714, 5.782210918909018, 2.619572570643775, 1.7410309387250866, 6.783703752443114, 9.584593531815788, 4.967624819799724, 7.040045438492236, 9.225325830422422, 6.5401522152310045, 8.720808751906526, 4.111970375779068, 4.782513055482385, 6.051351317448613, 5.6853881007351195, 8.744127582126591, 7.328097797022062, 7.659669643701692, 1.9086189021895643, 0.5101285993838712, 2.363864344157503, 7.297572944981539, 6.943376316695626, 4.935889029209549, 7.064769895042706, 6.055286236962337, 5.646376638917601, 6.217194689109895, 6.892949722380429, 4.1627384056202485, 5.446498259041172, 6.070648859390228, 6.862922749511409, 7.524832588926439, 3.795405681478845, 5.5297394856185775, 6.084661693648042, 4.546504040937324, 4.192438063357491, -0.8056592577634418, 5.9708401532334525, 8.424730156088495, 7.018746871781076, 9.270307395687158, 6.475986017217127, 5.631480464208457, 2.4373883426813308, 8.327230311070505, 2.1142218835052096, 6.682843129903686, 9.677867278453062, 6.574162475706483, 4.164083081348449, 9.226936478435437, 7.453316624382393, 7.622842731977141, 5.689303399142585, 5.113537477647206, 6.333809608234524, 8.575831839801943, 4.168371889512774, 3.7710637992391343, 8.47491891779579, 7.58397296572782, -2.131815413562229, 6.697760690391495], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.879315016958843, "mean_inference_ms": 8.0285320067623, "mean_action_processing_ms": 0.5390265728783268, "mean_env_wait_ms": 23.881999828794363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03624105453491211, "StateBufferConnector_ms": 0.030199050903320312, "ViewRequirementAgentConnector_ms": 0.9756627082824707}}, "episode_reward_max": 9.85522458969512, "episode_reward_min": -2.131815413562229, "episode_reward_mean": 5.972943687752032, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.36248703239306, 8.618307878672642, 7.9791390764415375, 5.049748411480918, 8.2727866024002, 4.374377917257031, 5.174048119377886, 5.695031570335208, 5.852365893080237, 4.734774822262392, 5.582921420390446, 9.21877779190935, 3.7331299802018485, 7.9843603674476675, 6.182416010523781, 6.306575430774218, 6.258643469239331, 8.092911478358877, 7.1497844931697925, 7.4691213735666295, 1.7591427870592644, 5.4245310942096285, 7.5806422329002325, 4.616063724249796, 7.193777108852462, 3.8338783961381915, 3.464668577483207, 9.230243222106212, 4.121928276791774, 4.323042190662009, 4.3731518250192805, 8.711153408472258, 9.85522458969512, 8.175604278471756, 4.57492482471714, 5.782210918909018, 2.619572570643775, 1.7410309387250866, 6.783703752443114, 9.584593531815788, 4.967624819799724, 7.040045438492236, 9.225325830422422, 6.5401522152310045, 8.720808751906526, 4.111970375779068, 4.782513055482385, 6.051351317448613, 5.6853881007351195, 8.744127582126591, 7.328097797022062, 7.659669643701692, 1.9086189021895643, 0.5101285993838712, 2.363864344157503, 7.297572944981539, 6.943376316695626, 4.935889029209549, 7.064769895042706, 6.055286236962337, 5.646376638917601, 6.217194689109895, 6.892949722380429, 4.1627384056202485, 5.446498259041172, 6.070648859390228, 6.862922749511409, 7.524832588926439, 3.795405681478845, 5.5297394856185775, 6.084661693648042, 4.546504040937324, 4.192438063357491, -0.8056592577634418, 5.9708401532334525, 8.424730156088495, 7.018746871781076, 9.270307395687158, 6.475986017217127, 5.631480464208457, 2.4373883426813308, 8.327230311070505, 2.1142218835052096, 6.682843129903686, 9.677867278453062, 6.574162475706483, 4.164083081348449, 9.226936478435437, 7.453316624382393, 7.622842731977141, 5.689303399142585, 5.113537477647206, 6.333809608234524, 8.575831839801943, 4.168371889512774, 3.7710637992391343, 8.47491891779579, 7.58397296572782, -2.131815413562229, 6.697760690391495], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.879315016958843, "mean_inference_ms": 8.0285320067623, "mean_action_processing_ms": 0.5390265728783268, "mean_env_wait_ms": 23.881999828794363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03624105453491211, "StateBufferConnector_ms": 0.030199050903320312, "ViewRequirementAgentConnector_ms": 0.9756627082824707}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6554408, "num_agent_steps_trained": 6554408, "num_env_steps_sampled": 6554408, "num_env_steps_trained": 6554408, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.3026185711511, "num_env_steps_trained_throughput_per_sec": 283.3026185711511, "timesteps_total": 6554408, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6554408, "timers": {"training_iteration_time_ms": 54754.335, "sample_time_ms": 41743.081, "load_time_ms": 1740.791, "load_throughput": 8983.275, "learn_time_ms": 10723.636, "learn_throughput": 1458.274, "synch_weights_time_ms": 425.48}, "counters": {"num_env_steps_sampled": 6554408, "num_env_steps_trained": 6554408, "num_agent_steps_sampled": 6554408, "num_agent_steps_trained": 6554408}, "done": false, "episodes_total": 1064, "training_iteration": 424, "trial_id": "2f030_00000", "date": "2025-06-07_08-47-36", "timestamp": 1749278856, "time_this_iter_s": 55.218663454055786, "time_total_s": 4271.032020330429, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4271.032020330429, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 77.87142857142857, "ram_util_percent": 67.63809523809525, "gpu_util_percent0": 0.08047619047619047, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.720204210526315e-05, "total_loss": -0.08583823441866446, "policy_loss": -0.024501469505882018, "vf_loss": 0.013550434311513196, "vf_explained_var": 0.7336155013604597, "kl": 0.015808866897147646, "entropy": 20.881796918348833, "entropy_coeff": 0.00367097}, "model": {}, "num_grad_updates_lifetime": 42075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6570046, "num_env_steps_trained": 6570046, "num_agent_steps_sampled": 6570046, "num_agent_steps_trained": 6570046}, "sampler_results": {"episode_reward_max": 11.245372889952083, "episode_reward_min": -2.131815413562229, "episode_reward_mean": 6.050083944992444, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.182416010523781, 6.306575430774218, 6.258643469239331, 8.092911478358877, 7.1497844931697925, 7.4691213735666295, 1.7591427870592644, 5.4245310942096285, 7.5806422329002325, 4.616063724249796, 7.193777108852462, 3.8338783961381915, 3.464668577483207, 9.230243222106212, 4.121928276791774, 4.323042190662009, 4.3731518250192805, 8.711153408472258, 9.85522458969512, 8.175604278471756, 4.57492482471714, 5.782210918909018, 2.619572570643775, 1.7410309387250866, 6.783703752443114, 9.584593531815788, 4.967624819799724, 7.040045438492236, 9.225325830422422, 6.5401522152310045, 8.720808751906526, 4.111970375779068, 4.782513055482385, 6.051351317448613, 5.6853881007351195, 8.744127582126591, 7.328097797022062, 7.659669643701692, 1.9086189021895643, 0.5101285993838712, 2.363864344157503, 7.297572944981539, 6.943376316695626, 4.935889029209549, 7.064769895042706, 6.055286236962337, 5.646376638917601, 6.217194689109895, 6.892949722380429, 4.1627384056202485, 5.446498259041172, 6.070648859390228, 6.862922749511409, 7.524832588926439, 3.795405681478845, 5.5297394856185775, 6.084661693648042, 4.546504040937324, 4.192438063357491, -0.8056592577634418, 5.9708401532334525, 8.424730156088495, 7.018746871781076, 9.270307395687158, 6.475986017217127, 5.631480464208457, 2.4373883426813308, 8.327230311070505, 2.1142218835052096, 6.682843129903686, 9.677867278453062, 6.574162475706483, 4.164083081348449, 9.226936478435437, 7.453316624382393, 7.622842731977141, 5.689303399142585, 5.113537477647206, 6.333809608234524, 8.575831839801943, 4.168371889512774, 3.7710637992391343, 8.47491891779579, 7.58397296572782, -2.131815413562229, 6.697760690391495, 11.245372889952083, 8.720423325560445, 4.605832344281443, 7.8820235335722355, 3.6617972533029843, 5.591537846740317, 9.333474743414097, 6.671886041850372, 7.0276351018582535, 7.116974380203669, 7.237284090762255, 7.25288057672007, 6.2591791255141125, 5.739981353959452], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8783624333716324, "mean_inference_ms": 8.029333008923514, "mean_action_processing_ms": 0.5390553189983341, "mean_env_wait_ms": 23.883892303054402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032787322998046875, "StateBufferConnector_ms": 0.03218388557434082, "ViewRequirementAgentConnector_ms": 0.9716551303863525}}, "episode_reward_max": 11.245372889952083, "episode_reward_min": -2.131815413562229, "episode_reward_mean": 6.050083944992444, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.182416010523781, 6.306575430774218, 6.258643469239331, 8.092911478358877, 7.1497844931697925, 7.4691213735666295, 1.7591427870592644, 5.4245310942096285, 7.5806422329002325, 4.616063724249796, 7.193777108852462, 3.8338783961381915, 3.464668577483207, 9.230243222106212, 4.121928276791774, 4.323042190662009, 4.3731518250192805, 8.711153408472258, 9.85522458969512, 8.175604278471756, 4.57492482471714, 5.782210918909018, 2.619572570643775, 1.7410309387250866, 6.783703752443114, 9.584593531815788, 4.967624819799724, 7.040045438492236, 9.225325830422422, 6.5401522152310045, 8.720808751906526, 4.111970375779068, 4.782513055482385, 6.051351317448613, 5.6853881007351195, 8.744127582126591, 7.328097797022062, 7.659669643701692, 1.9086189021895643, 0.5101285993838712, 2.363864344157503, 7.297572944981539, 6.943376316695626, 4.935889029209549, 7.064769895042706, 6.055286236962337, 5.646376638917601, 6.217194689109895, 6.892949722380429, 4.1627384056202485, 5.446498259041172, 6.070648859390228, 6.862922749511409, 7.524832588926439, 3.795405681478845, 5.5297394856185775, 6.084661693648042, 4.546504040937324, 4.192438063357491, -0.8056592577634418, 5.9708401532334525, 8.424730156088495, 7.018746871781076, 9.270307395687158, 6.475986017217127, 5.631480464208457, 2.4373883426813308, 8.327230311070505, 2.1142218835052096, 6.682843129903686, 9.677867278453062, 6.574162475706483, 4.164083081348449, 9.226936478435437, 7.453316624382393, 7.622842731977141, 5.689303399142585, 5.113537477647206, 6.333809608234524, 8.575831839801943, 4.168371889512774, 3.7710637992391343, 8.47491891779579, 7.58397296572782, -2.131815413562229, 6.697760690391495, 11.245372889952083, 8.720423325560445, 4.605832344281443, 7.8820235335722355, 3.6617972533029843, 5.591537846740317, 9.333474743414097, 6.671886041850372, 7.0276351018582535, 7.116974380203669, 7.237284090762255, 7.25288057672007, 6.2591791255141125, 5.739981353959452], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8783624333716324, "mean_inference_ms": 8.029333008923514, "mean_action_processing_ms": 0.5390553189983341, "mean_env_wait_ms": 23.883892303054402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032787322998046875, "StateBufferConnector_ms": 0.03218388557434082, "ViewRequirementAgentConnector_ms": 0.9716551303863525}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6570046, "num_agent_steps_trained": 6570046, "num_env_steps_sampled": 6570046, "num_env_steps_trained": 6570046, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.59191234573063, "num_env_steps_trained_throughput_per_sec": 285.59191234573063, "timesteps_total": 6570046, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6570046, "timers": {"training_iteration_time_ms": 54769.351, "sample_time_ms": 41761.315, "load_time_ms": 1738.582, "load_throughput": 8994.685, "learn_time_ms": 10727.169, "learn_throughput": 1457.794, "synch_weights_time_ms": 427.676}, "counters": {"num_env_steps_sampled": 6570046, "num_env_steps_trained": 6570046, "num_agent_steps_sampled": 6570046, "num_agent_steps_trained": 6570046}, "done": false, "episodes_total": 1078, "training_iteration": 425, "trial_id": "2f030_00000", "date": "2025-06-07_08-48-31", "timestamp": 1749278911, "time_this_iter_s": 54.772438287734985, "time_total_s": 4325.804458618164, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4325.804458618164, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 77.57619047619049, "ram_util_percent": 67.75555555555557, "gpu_util_percent0": 0.08047619047619047, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.707858421052631e-05, "total_loss": -0.08608395158905875, "policy_loss": -0.0260442115476392, "vf_loss": 0.016429780173877424, "vf_explained_var": 0.7406297517906536, "kl": 0.015369688360916223, "entropy": 21.0143113118952, "entropy_coeff": 0.0036123274999999995}, "model": {}, "num_grad_updates_lifetime": 42625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6585684, "num_env_steps_trained": 6585684, "num_agent_steps_sampled": 6585684, "num_agent_steps_trained": 6585684}, "sampler_results": {"episode_reward_max": 11.245372889952083, "episode_reward_min": -2.131815413562229, "episode_reward_mean": 5.924504893493531, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.121928276791774, 4.323042190662009, 4.3731518250192805, 8.711153408472258, 9.85522458969512, 8.175604278471756, 4.57492482471714, 5.782210918909018, 2.619572570643775, 1.7410309387250866, 6.783703752443114, 9.584593531815788, 4.967624819799724, 7.040045438492236, 9.225325830422422, 6.5401522152310045, 8.720808751906526, 4.111970375779068, 4.782513055482385, 6.051351317448613, 5.6853881007351195, 8.744127582126591, 7.328097797022062, 7.659669643701692, 1.9086189021895643, 0.5101285993838712, 2.363864344157503, 7.297572944981539, 6.943376316695626, 4.935889029209549, 7.064769895042706, 6.055286236962337, 5.646376638917601, 6.217194689109895, 6.892949722380429, 4.1627384056202485, 5.446498259041172, 6.070648859390228, 6.862922749511409, 7.524832588926439, 3.795405681478845, 5.5297394856185775, 6.084661693648042, 4.546504040937324, 4.192438063357491, -0.8056592577634418, 5.9708401532334525, 8.424730156088495, 7.018746871781076, 9.270307395687158, 6.475986017217127, 5.631480464208457, 2.4373883426813308, 8.327230311070505, 2.1142218835052096, 6.682843129903686, 9.677867278453062, 6.574162475706483, 4.164083081348449, 9.226936478435437, 7.453316624382393, 7.622842731977141, 5.689303399142585, 5.113537477647206, 6.333809608234524, 8.575831839801943, 4.168371889512774, 3.7710637992391343, 8.47491891779579, 7.58397296572782, -2.131815413562229, 6.697760690391495, 11.245372889952083, 8.720423325560445, 4.605832344281443, 7.8820235335722355, 3.6617972533029843, 5.591537846740317, 9.333474743414097, 6.671886041850372, 7.0276351018582535, 7.116974380203669, 7.237284090762255, 7.25288057672007, 6.2591791255141125, 5.739981353959452, 6.333791468813237, 7.386898704534497, 6.631266764214994, -1.711179445214816, 9.482508732059367, 4.488056407128414, 6.565803148298955, 6.926814450232518, 4.722598133992947, 5.960346835636365, 7.388027194382268, 4.4602724365963295, 4.110275121996809, -0.7409857039316773], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8777480611688073, "mean_inference_ms": 8.029806900716322, "mean_action_processing_ms": 0.5390809990737714, "mean_env_wait_ms": 23.884737599829094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03764224052429199, "StateBufferConnector_ms": 0.035080671310424805, "ViewRequirementAgentConnector_ms": 0.9946811199188232}}, "episode_reward_max": 11.245372889952083, "episode_reward_min": -2.131815413562229, "episode_reward_mean": 5.924504893493531, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.121928276791774, 4.323042190662009, 4.3731518250192805, 8.711153408472258, 9.85522458969512, 8.175604278471756, 4.57492482471714, 5.782210918909018, 2.619572570643775, 1.7410309387250866, 6.783703752443114, 9.584593531815788, 4.967624819799724, 7.040045438492236, 9.225325830422422, 6.5401522152310045, 8.720808751906526, 4.111970375779068, 4.782513055482385, 6.051351317448613, 5.6853881007351195, 8.744127582126591, 7.328097797022062, 7.659669643701692, 1.9086189021895643, 0.5101285993838712, 2.363864344157503, 7.297572944981539, 6.943376316695626, 4.935889029209549, 7.064769895042706, 6.055286236962337, 5.646376638917601, 6.217194689109895, 6.892949722380429, 4.1627384056202485, 5.446498259041172, 6.070648859390228, 6.862922749511409, 7.524832588926439, 3.795405681478845, 5.5297394856185775, 6.084661693648042, 4.546504040937324, 4.192438063357491, -0.8056592577634418, 5.9708401532334525, 8.424730156088495, 7.018746871781076, 9.270307395687158, 6.475986017217127, 5.631480464208457, 2.4373883426813308, 8.327230311070505, 2.1142218835052096, 6.682843129903686, 9.677867278453062, 6.574162475706483, 4.164083081348449, 9.226936478435437, 7.453316624382393, 7.622842731977141, 5.689303399142585, 5.113537477647206, 6.333809608234524, 8.575831839801943, 4.168371889512774, 3.7710637992391343, 8.47491891779579, 7.58397296572782, -2.131815413562229, 6.697760690391495, 11.245372889952083, 8.720423325560445, 4.605832344281443, 7.8820235335722355, 3.6617972533029843, 5.591537846740317, 9.333474743414097, 6.671886041850372, 7.0276351018582535, 7.116974380203669, 7.237284090762255, 7.25288057672007, 6.2591791255141125, 5.739981353959452, 6.333791468813237, 7.386898704534497, 6.631266764214994, -1.711179445214816, 9.482508732059367, 4.488056407128414, 6.565803148298955, 6.926814450232518, 4.722598133992947, 5.960346835636365, 7.388027194382268, 4.4602724365963295, 4.110275121996809, -0.7409857039316773], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8777480611688073, "mean_inference_ms": 8.029806900716322, "mean_action_processing_ms": 0.5390809990737714, "mean_env_wait_ms": 23.884737599829094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03764224052429199, "StateBufferConnector_ms": 0.035080671310424805, "ViewRequirementAgentConnector_ms": 0.9946811199188232}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6585684, "num_agent_steps_trained": 6585684, "num_env_steps_sampled": 6585684, "num_env_steps_trained": 6585684, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 287.90611430121703, "num_env_steps_trained_throughput_per_sec": 287.90611430121703, "timesteps_total": 6585684, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6585684, "timers": {"training_iteration_time_ms": 54725.682, "sample_time_ms": 41738.523, "load_time_ms": 1736.684, "load_throughput": 9004.515, "learn_time_ms": 10709.67, "learn_throughput": 1460.176, "synch_weights_time_ms": 426.645}, "counters": {"num_env_steps_sampled": 6585684, "num_env_steps_trained": 6585684, "num_agent_steps_sampled": 6585684, "num_agent_steps_trained": 6585684}, "done": false, "episodes_total": 1092, "training_iteration": 426, "trial_id": "2f030_00000", "date": "2025-06-07_08-49-25", "timestamp": 1749278965, "time_this_iter_s": 54.334887742996216, "time_total_s": 4380.13934636116, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4380.13934636116, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 77.48387096774192, "ram_util_percent": 67.59516129032261, "gpu_util_percent0": 0.07758064516129033, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.695512631578947e-05, "total_loss": -0.0983268348373134, "policy_loss": -0.03951392333721742, "vf_loss": 0.01511321221816946, "vf_explained_var": 0.7236222471974113, "kl": 0.01553317587707446, "entropy": 20.93746636130593, "entropy_coeff": 0.0035536849999999996}, "model": {}, "num_grad_updates_lifetime": 43175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6601322, "num_env_steps_trained": 6601322, "num_agent_steps_sampled": 6601322, "num_agent_steps_trained": 6601322}, "sampler_results": {"episode_reward_max": 11.245372889952083, "episode_reward_min": -2.131815413562229, "episode_reward_mean": 5.885898286357734, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.225325830422422, 6.5401522152310045, 8.720808751906526, 4.111970375779068, 4.782513055482385, 6.051351317448613, 5.6853881007351195, 8.744127582126591, 7.328097797022062, 7.659669643701692, 1.9086189021895643, 0.5101285993838712, 2.363864344157503, 7.297572944981539, 6.943376316695626, 4.935889029209549, 7.064769895042706, 6.055286236962337, 5.646376638917601, 6.217194689109895, 6.892949722380429, 4.1627384056202485, 5.446498259041172, 6.070648859390228, 6.862922749511409, 7.524832588926439, 3.795405681478845, 5.5297394856185775, 6.084661693648042, 4.546504040937324, 4.192438063357491, -0.8056592577634418, 5.9708401532334525, 8.424730156088495, 7.018746871781076, 9.270307395687158, 6.475986017217127, 5.631480464208457, 2.4373883426813308, 8.327230311070505, 2.1142218835052096, 6.682843129903686, 9.677867278453062, 6.574162475706483, 4.164083081348449, 9.226936478435437, 7.453316624382393, 7.622842731977141, 5.689303399142585, 5.113537477647206, 6.333809608234524, 8.575831839801943, 4.168371889512774, 3.7710637992391343, 8.47491891779579, 7.58397296572782, -2.131815413562229, 6.697760690391495, 11.245372889952083, 8.720423325560445, 4.605832344281443, 7.8820235335722355, 3.6617972533029843, 5.591537846740317, 9.333474743414097, 6.671886041850372, 7.0276351018582535, 7.116974380203669, 7.237284090762255, 7.25288057672007, 6.2591791255141125, 5.739981353959452, 6.333791468813237, 7.386898704534497, 6.631266764214994, -1.711179445214816, 9.482508732059367, 4.488056407128414, 6.565803148298955, 6.926814450232518, 4.722598133992947, 5.960346835636365, 7.388027194382268, 4.4602724365963295, 4.110275121996809, -0.7409857039316773, 9.542036431240524, 5.31273914139512, 2.248992813889776, 6.7924948858251994, 4.980990264885925, 3.756164007323662, 6.207295134740685, 5.342654179410752, 4.459058184690544, 6.421220747335324, 5.052866574764901, 8.552104052899884, 6.621844734949541, 3.5026894977266814], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.876823109531177, "mean_inference_ms": 8.030685500815803, "mean_action_processing_ms": 0.5391833026427941, "mean_env_wait_ms": 23.887102894872715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03557729721069336, "StateBufferConnector_ms": 0.03303837776184082, "ViewRequirementAgentConnector_ms": 0.9743092060089111}}, "episode_reward_max": 11.245372889952083, "episode_reward_min": -2.131815413562229, "episode_reward_mean": 5.885898286357734, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.225325830422422, 6.5401522152310045, 8.720808751906526, 4.111970375779068, 4.782513055482385, 6.051351317448613, 5.6853881007351195, 8.744127582126591, 7.328097797022062, 7.659669643701692, 1.9086189021895643, 0.5101285993838712, 2.363864344157503, 7.297572944981539, 6.943376316695626, 4.935889029209549, 7.064769895042706, 6.055286236962337, 5.646376638917601, 6.217194689109895, 6.892949722380429, 4.1627384056202485, 5.446498259041172, 6.070648859390228, 6.862922749511409, 7.524832588926439, 3.795405681478845, 5.5297394856185775, 6.084661693648042, 4.546504040937324, 4.192438063357491, -0.8056592577634418, 5.9708401532334525, 8.424730156088495, 7.018746871781076, 9.270307395687158, 6.475986017217127, 5.631480464208457, 2.4373883426813308, 8.327230311070505, 2.1142218835052096, 6.682843129903686, 9.677867278453062, 6.574162475706483, 4.164083081348449, 9.226936478435437, 7.453316624382393, 7.622842731977141, 5.689303399142585, 5.113537477647206, 6.333809608234524, 8.575831839801943, 4.168371889512774, 3.7710637992391343, 8.47491891779579, 7.58397296572782, -2.131815413562229, 6.697760690391495, 11.245372889952083, 8.720423325560445, 4.605832344281443, 7.8820235335722355, 3.6617972533029843, 5.591537846740317, 9.333474743414097, 6.671886041850372, 7.0276351018582535, 7.116974380203669, 7.237284090762255, 7.25288057672007, 6.2591791255141125, 5.739981353959452, 6.333791468813237, 7.386898704534497, 6.631266764214994, -1.711179445214816, 9.482508732059367, 4.488056407128414, 6.565803148298955, 6.926814450232518, 4.722598133992947, 5.960346835636365, 7.388027194382268, 4.4602724365963295, 4.110275121996809, -0.7409857039316773, 9.542036431240524, 5.31273914139512, 2.248992813889776, 6.7924948858251994, 4.980990264885925, 3.756164007323662, 6.207295134740685, 5.342654179410752, 4.459058184690544, 6.421220747335324, 5.052866574764901, 8.552104052899884, 6.621844734949541, 3.5026894977266814], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.876823109531177, "mean_inference_ms": 8.030685500815803, "mean_action_processing_ms": 0.5391833026427941, "mean_env_wait_ms": 23.887102894872715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03557729721069336, "StateBufferConnector_ms": 0.03303837776184082, "ViewRequirementAgentConnector_ms": 0.9743092060089111}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6601322, "num_agent_steps_trained": 6601322, "num_env_steps_sampled": 6601322, "num_env_steps_trained": 6601322, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 279.7450899585864, "num_env_steps_trained_throughput_per_sec": 279.7450899585864, "timesteps_total": 6601322, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6601322, "timers": {"training_iteration_time_ms": 54861.683, "sample_time_ms": 41887.524, "load_time_ms": 1721.904, "load_throughput": 9081.805, "learn_time_ms": 10706.949, "learn_throughput": 1460.547, "synch_weights_time_ms": 428.131}, "counters": {"num_env_steps_sampled": 6601322, "num_env_steps_trained": 6601322, "num_agent_steps_sampled": 6601322, "num_agent_steps_trained": 6601322}, "done": false, "episodes_total": 1106, "training_iteration": 427, "trial_id": "2f030_00000", "date": "2025-06-07_08-50-21", "timestamp": 1749279021, "time_this_iter_s": 55.91656184196472, "time_total_s": 4436.055908203125, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4436.055908203125, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 77.24615384615385, "ram_util_percent": 67.32, "gpu_util_percent0": 0.07446153846153844, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.683166842105263e-05, "total_loss": -0.07425777217288586, "policy_loss": -0.016694108259610155, "vf_loss": 0.015166232812811029, "vf_explained_var": 0.7350133646618237, "kl": 0.015344048779237314, "entropy": 20.897364935441452, "entropy_coeff": 0.0034950425}, "model": {}, "num_grad_updates_lifetime": 43725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6616960, "num_env_steps_trained": 6616960, "num_agent_steps_sampled": 6616960, "num_agent_steps_trained": 6616960}, "sampler_results": {"episode_reward_max": 11.245372889952083, "episode_reward_min": -2.131815413562229, "episode_reward_mean": 5.985868381511749, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.943376316695626, 4.935889029209549, 7.064769895042706, 6.055286236962337, 5.646376638917601, 6.217194689109895, 6.892949722380429, 4.1627384056202485, 5.446498259041172, 6.070648859390228, 6.862922749511409, 7.524832588926439, 3.795405681478845, 5.5297394856185775, 6.084661693648042, 4.546504040937324, 4.192438063357491, -0.8056592577634418, 5.9708401532334525, 8.424730156088495, 7.018746871781076, 9.270307395687158, 6.475986017217127, 5.631480464208457, 2.4373883426813308, 8.327230311070505, 2.1142218835052096, 6.682843129903686, 9.677867278453062, 6.574162475706483, 4.164083081348449, 9.226936478435437, 7.453316624382393, 7.622842731977141, 5.689303399142585, 5.113537477647206, 6.333809608234524, 8.575831839801943, 4.168371889512774, 3.7710637992391343, 8.47491891779579, 7.58397296572782, -2.131815413562229, 6.697760690391495, 11.245372889952083, 8.720423325560445, 4.605832344281443, 7.8820235335722355, 3.6617972533029843, 5.591537846740317, 9.333474743414097, 6.671886041850372, 7.0276351018582535, 7.116974380203669, 7.237284090762255, 7.25288057672007, 6.2591791255141125, 5.739981353959452, 6.333791468813237, 7.386898704534497, 6.631266764214994, -1.711179445214816, 9.482508732059367, 4.488056407128414, 6.565803148298955, 6.926814450232518, 4.722598133992947, 5.960346835636365, 7.388027194382268, 4.4602724365963295, 4.110275121996809, -0.7409857039316773, 9.542036431240524, 5.31273914139512, 2.248992813889776, 6.7924948858251994, 4.980990264885925, 3.756164007323662, 6.207295134740685, 5.342654179410752, 4.459058184690544, 6.421220747335324, 5.052866574764901, 8.552104052899884, 6.621844734949541, 3.5026894977266814, 4.17990528060779, 1.0498034528129578, 7.985369597319314, 9.033381088304353, 7.341814889488428, 7.033905883591943, 5.868870634298592, 4.155455853658163, 3.6246418903032764, 10.239034942158353, 7.281588306086687, 5.000196431553295, 7.97146080387896, 10.161169921907307], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.876055696114093, "mean_inference_ms": 8.031530781371423, "mean_action_processing_ms": 0.5393039157336791, "mean_env_wait_ms": 23.889193064061846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03354597091674805, "StateBufferConnector_ms": 0.04033207893371582, "ViewRequirementAgentConnector_ms": 0.9960777759552002}}, "episode_reward_max": 11.245372889952083, "episode_reward_min": -2.131815413562229, "episode_reward_mean": 5.985868381511749, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.943376316695626, 4.935889029209549, 7.064769895042706, 6.055286236962337, 5.646376638917601, 6.217194689109895, 6.892949722380429, 4.1627384056202485, 5.446498259041172, 6.070648859390228, 6.862922749511409, 7.524832588926439, 3.795405681478845, 5.5297394856185775, 6.084661693648042, 4.546504040937324, 4.192438063357491, -0.8056592577634418, 5.9708401532334525, 8.424730156088495, 7.018746871781076, 9.270307395687158, 6.475986017217127, 5.631480464208457, 2.4373883426813308, 8.327230311070505, 2.1142218835052096, 6.682843129903686, 9.677867278453062, 6.574162475706483, 4.164083081348449, 9.226936478435437, 7.453316624382393, 7.622842731977141, 5.689303399142585, 5.113537477647206, 6.333809608234524, 8.575831839801943, 4.168371889512774, 3.7710637992391343, 8.47491891779579, 7.58397296572782, -2.131815413562229, 6.697760690391495, 11.245372889952083, 8.720423325560445, 4.605832344281443, 7.8820235335722355, 3.6617972533029843, 5.591537846740317, 9.333474743414097, 6.671886041850372, 7.0276351018582535, 7.116974380203669, 7.237284090762255, 7.25288057672007, 6.2591791255141125, 5.739981353959452, 6.333791468813237, 7.386898704534497, 6.631266764214994, -1.711179445214816, 9.482508732059367, 4.488056407128414, 6.565803148298955, 6.926814450232518, 4.722598133992947, 5.960346835636365, 7.388027194382268, 4.4602724365963295, 4.110275121996809, -0.7409857039316773, 9.542036431240524, 5.31273914139512, 2.248992813889776, 6.7924948858251994, 4.980990264885925, 3.756164007323662, 6.207295134740685, 5.342654179410752, 4.459058184690544, 6.421220747335324, 5.052866574764901, 8.552104052899884, 6.621844734949541, 3.5026894977266814, 4.17990528060779, 1.0498034528129578, 7.985369597319314, 9.033381088304353, 7.341814889488428, 7.033905883591943, 5.868870634298592, 4.155455853658163, 3.6246418903032764, 10.239034942158353, 7.281588306086687, 5.000196431553295, 7.97146080387896, 10.161169921907307], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.876055696114093, "mean_inference_ms": 8.031530781371423, "mean_action_processing_ms": 0.5393039157336791, "mean_env_wait_ms": 23.889193064061846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03354597091674805, "StateBufferConnector_ms": 0.04033207893371582, "ViewRequirementAgentConnector_ms": 0.9960777759552002}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6616960, "num_agent_steps_trained": 6616960, "num_env_steps_sampled": 6616960, "num_env_steps_trained": 6616960, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 288.9364705247803, "num_env_steps_trained_throughput_per_sec": 288.9364705247803, "timesteps_total": 6616960, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6616960, "timers": {"training_iteration_time_ms": 54757.747, "sample_time_ms": 41794.223, "load_time_ms": 1717.539, "load_throughput": 9104.885, "learn_time_ms": 10702.603, "learn_throughput": 1461.14, "synch_weights_time_ms": 426.461}, "counters": {"num_env_steps_sampled": 6616960, "num_env_steps_trained": 6616960, "num_agent_steps_sampled": 6616960, "num_agent_steps_trained": 6616960}, "done": false, "episodes_total": 1120, "training_iteration": 428, "trial_id": "2f030_00000", "date": "2025-06-07_08-51-16", "timestamp": 1749279076, "time_this_iter_s": 54.139155626297, "time_total_s": 4490.195063829422, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4490.195063829422, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 77.93278688524592, "ram_util_percent": 67.74262295081968, "gpu_util_percent0": 0.07377049180327869, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.670821052631579e-05, "total_loss": -0.08465278342620215, "policy_loss": -0.02767348006558181, "vf_loss": 0.01380700333805924, "vf_explained_var": 0.7528595254637979, "kl": 0.015085219979193383, "entropy": 20.911646818681195, "entropy_coeff": 0.0034363999999999996}, "model": {}, "num_grad_updates_lifetime": 44275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6632598, "num_env_steps_trained": 6632598, "num_agent_steps_sampled": 6632598, "num_agent_steps_trained": 6632598}, "sampler_results": {"episode_reward_max": 11.245372889952083, "episode_reward_min": -2.131815413562229, "episode_reward_mean": 5.953367660626423, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.084661693648042, 4.546504040937324, 4.192438063357491, -0.8056592577634418, 5.9708401532334525, 8.424730156088495, 7.018746871781076, 9.270307395687158, 6.475986017217127, 5.631480464208457, 2.4373883426813308, 8.327230311070505, 2.1142218835052096, 6.682843129903686, 9.677867278453062, 6.574162475706483, 4.164083081348449, 9.226936478435437, 7.453316624382393, 7.622842731977141, 5.689303399142585, 5.113537477647206, 6.333809608234524, 8.575831839801943, 4.168371889512774, 3.7710637992391343, 8.47491891779579, 7.58397296572782, -2.131815413562229, 6.697760690391495, 11.245372889952083, 8.720423325560445, 4.605832344281443, 7.8820235335722355, 3.6617972533029843, 5.591537846740317, 9.333474743414097, 6.671886041850372, 7.0276351018582535, 7.116974380203669, 7.237284090762255, 7.25288057672007, 6.2591791255141125, 5.739981353959452, 6.333791468813237, 7.386898704534497, 6.631266764214994, -1.711179445214816, 9.482508732059367, 4.488056407128414, 6.565803148298955, 6.926814450232518, 4.722598133992947, 5.960346835636365, 7.388027194382268, 4.4602724365963295, 4.110275121996809, -0.7409857039316773, 9.542036431240524, 5.31273914139512, 2.248992813889776, 6.7924948858251994, 4.980990264885925, 3.756164007323662, 6.207295134740685, 5.342654179410752, 4.459058184690544, 6.421220747335324, 5.052866574764901, 8.552104052899884, 6.621844734949541, 3.5026894977266814, 4.17990528060779, 1.0498034528129578, 7.985369597319314, 9.033381088304353, 7.341814889488428, 7.033905883591943, 5.868870634298592, 4.155455853658163, 3.6246418903032764, 10.239034942158353, 7.281588306086687, 5.000196431553295, 7.97146080387896, 10.161169921907307, 5.562864608092361, 5.204392288474886, 6.721401044560568, 2.875862650608062, 8.33264989256601, 2.5351258961028873, 6.431664930409868, 7.023434529481193, 5.662579410084551, 6.868151095666756, 2.8091546365982434, 6.861391942289938, 6.239099801505806, 6.770783742931233], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8754718931607695, "mean_inference_ms": 8.032699959872716, "mean_action_processing_ms": 0.539416987429715, "mean_env_wait_ms": 23.891761193532407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03104877471923828, "StateBufferConnector_ms": 0.033294677734375, "ViewRequirementAgentConnector_ms": 0.9710087776184082}}, "episode_reward_max": 11.245372889952083, "episode_reward_min": -2.131815413562229, "episode_reward_mean": 5.953367660626423, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.084661693648042, 4.546504040937324, 4.192438063357491, -0.8056592577634418, 5.9708401532334525, 8.424730156088495, 7.018746871781076, 9.270307395687158, 6.475986017217127, 5.631480464208457, 2.4373883426813308, 8.327230311070505, 2.1142218835052096, 6.682843129903686, 9.677867278453062, 6.574162475706483, 4.164083081348449, 9.226936478435437, 7.453316624382393, 7.622842731977141, 5.689303399142585, 5.113537477647206, 6.333809608234524, 8.575831839801943, 4.168371889512774, 3.7710637992391343, 8.47491891779579, 7.58397296572782, -2.131815413562229, 6.697760690391495, 11.245372889952083, 8.720423325560445, 4.605832344281443, 7.8820235335722355, 3.6617972533029843, 5.591537846740317, 9.333474743414097, 6.671886041850372, 7.0276351018582535, 7.116974380203669, 7.237284090762255, 7.25288057672007, 6.2591791255141125, 5.739981353959452, 6.333791468813237, 7.386898704534497, 6.631266764214994, -1.711179445214816, 9.482508732059367, 4.488056407128414, 6.565803148298955, 6.926814450232518, 4.722598133992947, 5.960346835636365, 7.388027194382268, 4.4602724365963295, 4.110275121996809, -0.7409857039316773, 9.542036431240524, 5.31273914139512, 2.248992813889776, 6.7924948858251994, 4.980990264885925, 3.756164007323662, 6.207295134740685, 5.342654179410752, 4.459058184690544, 6.421220747335324, 5.052866574764901, 8.552104052899884, 6.621844734949541, 3.5026894977266814, 4.17990528060779, 1.0498034528129578, 7.985369597319314, 9.033381088304353, 7.341814889488428, 7.033905883591943, 5.868870634298592, 4.155455853658163, 3.6246418903032764, 10.239034942158353, 7.281588306086687, 5.000196431553295, 7.97146080387896, 10.161169921907307, 5.562864608092361, 5.204392288474886, 6.721401044560568, 2.875862650608062, 8.33264989256601, 2.5351258961028873, 6.431664930409868, 7.023434529481193, 5.662579410084551, 6.868151095666756, 2.8091546365982434, 6.861391942289938, 6.239099801505806, 6.770783742931233], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8754718931607695, "mean_inference_ms": 8.032699959872716, "mean_action_processing_ms": 0.539416987429715, "mean_env_wait_ms": 23.891761193532407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03104877471923828, "StateBufferConnector_ms": 0.033294677734375, "ViewRequirementAgentConnector_ms": 0.9710087776184082}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6632598, "num_agent_steps_trained": 6632598, "num_env_steps_sampled": 6632598, "num_env_steps_trained": 6632598, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.2590026828419, "num_env_steps_trained_throughput_per_sec": 282.2590026828419, "timesteps_total": 6632598, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6632598, "timers": {"training_iteration_time_ms": 54782.708, "sample_time_ms": 41770.746, "load_time_ms": 1728.37, "load_throughput": 9047.831, "learn_time_ms": 10736.426, "learn_throughput": 1456.537, "synch_weights_time_ms": 427.701}, "counters": {"num_env_steps_sampled": 6632598, "num_env_steps_trained": 6632598, "num_agent_steps_sampled": 6632598, "num_agent_steps_trained": 6632598}, "done": false, "episodes_total": 1134, "training_iteration": 429, "trial_id": "2f030_00000", "date": "2025-06-07_08-52-11", "timestamp": 1749279131, "time_this_iter_s": 55.41883611679077, "time_total_s": 4545.613899946213, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4545.613899946213, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 77.6453125, "ram_util_percent": 67.87968749999999, "gpu_util_percent0": 0.0809375, "vram_util_percent0": 0.8592122395833333}}
{"evaluation": {"sampler_results": {"episode_reward_max": -2.731906428246625, "episode_reward_min": -5.692096301791265, "episode_reward_mean": -3.829977250209238, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.692096301791265, -3.372673298836783, -2.731906428246625, -3.3215019044914835, -4.03170831768003], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4377910292475369, "mean_inference_ms": 3.9644009565158305, "mean_action_processing_ms": 0.28790691713393707, "mean_env_wait_ms": 10.431167973137294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.04027366638183594, "ViewRequirementAgentConnector_ms": 0.14057636260986328}}, "episode_reward_max": -2.731906428246625, "episode_reward_min": -5.692096301791265, "episode_reward_mean": -3.829977250209238, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.692096301791265, -3.372673298836783, -2.731906428246625, -3.3215019044914835, -4.03170831768003], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4377910292475369, "mean_inference_ms": 3.9644009565158305, "mean_action_processing_ms": 0.28790691713393707, "mean_env_wait_ms": 10.431167973137294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.04027366638183594, "ViewRequirementAgentConnector_ms": 0.14057636260986328}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.658475263157894e-05, "total_loss": -0.08544602760494771, "policy_loss": -0.02951709702081809, "vf_loss": 0.013668442492965947, "vf_explained_var": 0.7408518808538264, "kl": 0.01480075955512637, "entropy": 20.89147374760021, "entropy_coeff": 0.003377757500000001}, "model": {}, "num_grad_updates_lifetime": 44825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6648236, "num_env_steps_trained": 6648236, "num_agent_steps_sampled": 6648236, "num_agent_steps_trained": 6648236}, "sampler_results": {"episode_reward_max": 11.245372889952083, "episode_reward_min": -2.131815413562229, "episode_reward_mean": 6.024127091584972, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.677867278453062, 6.574162475706483, 4.164083081348449, 9.226936478435437, 7.453316624382393, 7.622842731977141, 5.689303399142585, 5.113537477647206, 6.333809608234524, 8.575831839801943, 4.168371889512774, 3.7710637992391343, 8.47491891779579, 7.58397296572782, -2.131815413562229, 6.697760690391495, 11.245372889952083, 8.720423325560445, 4.605832344281443, 7.8820235335722355, 3.6617972533029843, 5.591537846740317, 9.333474743414097, 6.671886041850372, 7.0276351018582535, 7.116974380203669, 7.237284090762255, 7.25288057672007, 6.2591791255141125, 5.739981353959452, 6.333791468813237, 7.386898704534497, 6.631266764214994, -1.711179445214816, 9.482508732059367, 4.488056407128414, 6.565803148298955, 6.926814450232518, 4.722598133992947, 5.960346835636365, 7.388027194382268, 4.4602724365963295, 4.110275121996809, -0.7409857039316773, 9.542036431240524, 5.31273914139512, 2.248992813889776, 6.7924948858251994, 4.980990264885925, 3.756164007323662, 6.207295134740685, 5.342654179410752, 4.459058184690544, 6.421220747335324, 5.052866574764901, 8.552104052899884, 6.621844734949541, 3.5026894977266814, 4.17990528060779, 1.0498034528129578, 7.985369597319314, 9.033381088304353, 7.341814889488428, 7.033905883591943, 5.868870634298592, 4.155455853658163, 3.6246418903032764, 10.239034942158353, 7.281588306086687, 5.000196431553295, 7.97146080387896, 10.161169921907307, 5.562864608092361, 5.204392288474886, 6.721401044560568, 2.875862650608062, 8.33264989256601, 2.5351258961028873, 6.431664930409868, 7.023434529481193, 5.662579410084551, 6.868151095666756, 2.8091546365982434, 6.861391942289938, 6.239099801505806, 6.770783742931233, 4.160767333012575, 7.402289520173929, 8.63223387672069, 5.9206698988254844, 7.331477355880256, 3.521387709901707, 6.349288031855432, 7.552050354729887, 5.710012007006321, 1.9886164820204386, 5.8575253196012325, 9.168480952062515, 6.376375906080316, 3.4764876135401654], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.874796889122729, "mean_inference_ms": 8.034162331209592, "mean_action_processing_ms": 0.5395132192985593, "mean_env_wait_ms": 23.89546060656495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028024673461914062, "StateBufferConnector_ms": 0.036330223083496094, "ViewRequirementAgentConnector_ms": 0.9855210781097412}}, "episode_reward_max": 11.245372889952083, "episode_reward_min": -2.131815413562229, "episode_reward_mean": 6.024127091584972, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.677867278453062, 6.574162475706483, 4.164083081348449, 9.226936478435437, 7.453316624382393, 7.622842731977141, 5.689303399142585, 5.113537477647206, 6.333809608234524, 8.575831839801943, 4.168371889512774, 3.7710637992391343, 8.47491891779579, 7.58397296572782, -2.131815413562229, 6.697760690391495, 11.245372889952083, 8.720423325560445, 4.605832344281443, 7.8820235335722355, 3.6617972533029843, 5.591537846740317, 9.333474743414097, 6.671886041850372, 7.0276351018582535, 7.116974380203669, 7.237284090762255, 7.25288057672007, 6.2591791255141125, 5.739981353959452, 6.333791468813237, 7.386898704534497, 6.631266764214994, -1.711179445214816, 9.482508732059367, 4.488056407128414, 6.565803148298955, 6.926814450232518, 4.722598133992947, 5.960346835636365, 7.388027194382268, 4.4602724365963295, 4.110275121996809, -0.7409857039316773, 9.542036431240524, 5.31273914139512, 2.248992813889776, 6.7924948858251994, 4.980990264885925, 3.756164007323662, 6.207295134740685, 5.342654179410752, 4.459058184690544, 6.421220747335324, 5.052866574764901, 8.552104052899884, 6.621844734949541, 3.5026894977266814, 4.17990528060779, 1.0498034528129578, 7.985369597319314, 9.033381088304353, 7.341814889488428, 7.033905883591943, 5.868870634298592, 4.155455853658163, 3.6246418903032764, 10.239034942158353, 7.281588306086687, 5.000196431553295, 7.97146080387896, 10.161169921907307, 5.562864608092361, 5.204392288474886, 6.721401044560568, 2.875862650608062, 8.33264989256601, 2.5351258961028873, 6.431664930409868, 7.023434529481193, 5.662579410084551, 6.868151095666756, 2.8091546365982434, 6.861391942289938, 6.239099801505806, 6.770783742931233, 4.160767333012575, 7.402289520173929, 8.63223387672069, 5.9206698988254844, 7.331477355880256, 3.521387709901707, 6.349288031855432, 7.552050354729887, 5.710012007006321, 1.9886164820204386, 5.8575253196012325, 9.168480952062515, 6.376375906080316, 3.4764876135401654], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.874796889122729, "mean_inference_ms": 8.034162331209592, "mean_action_processing_ms": 0.5395132192985593, "mean_env_wait_ms": 23.89546060656495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028024673461914062, "StateBufferConnector_ms": 0.036330223083496094, "ViewRequirementAgentConnector_ms": 0.9855210781097412}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6648236, "num_agent_steps_trained": 6648236, "num_env_steps_sampled": 6648236, "num_env_steps_trained": 6648236, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.75275634789404, "num_env_steps_trained_throughput_per_sec": 284.75275634789404, "timesteps_total": 6648236, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6648236, "timers": {"training_iteration_time_ms": 54796.896, "sample_time_ms": 41789.443, "load_time_ms": 1724.902, "load_throughput": 9066.024, "learn_time_ms": 10737.114, "learn_throughput": 1456.444, "synch_weights_time_ms": 425.409}, "counters": {"num_env_steps_sampled": 6648236, "num_env_steps_trained": 6648236, "num_agent_steps_sampled": 6648236, "num_agent_steps_trained": 6648236}, "done": false, "episodes_total": 1148, "training_iteration": 430, "trial_id": "2f030_00000", "date": "2025-06-07_08-53-21", "timestamp": 1749279201, "time_this_iter_s": 69.95755743980408, "time_total_s": 4615.571457386017, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4615.571457386017, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 64.6231707317073, "ram_util_percent": 67.25731707317074, "gpu_util_percent0": 0.06268292682926829, "vram_util_percent0": 0.8592122395833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.64612947368421e-05, "total_loss": -0.08764476417902518, "policy_loss": -0.03348373788453252, "vf_loss": 0.015171056670898742, "vf_explained_var": 0.7444923063841733, "kl": 0.015028954882043748, "entropy": 20.912704419222745, "entropy_coeff": 0.003319115000000001}, "model": {}, "num_grad_updates_lifetime": 45375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6663874, "num_env_steps_trained": 6663874, "num_agent_steps_sampled": 6663874, "num_agent_steps_trained": 6663874}, "sampler_results": {"episode_reward_max": 11.245372889952083, "episode_reward_min": -2.131815413562229, "episode_reward_mean": 5.823209736834461, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.131815413562229, 6.697760690391495, 11.245372889952083, 8.720423325560445, 4.605832344281443, 7.8820235335722355, 3.6617972533029843, 5.591537846740317, 9.333474743414097, 6.671886041850372, 7.0276351018582535, 7.116974380203669, 7.237284090762255, 7.25288057672007, 6.2591791255141125, 5.739981353959452, 6.333791468813237, 7.386898704534497, 6.631266764214994, -1.711179445214816, 9.482508732059367, 4.488056407128414, 6.565803148298955, 6.926814450232518, 4.722598133992947, 5.960346835636365, 7.388027194382268, 4.4602724365963295, 4.110275121996809, -0.7409857039316773, 9.542036431240524, 5.31273914139512, 2.248992813889776, 6.7924948858251994, 4.980990264885925, 3.756164007323662, 6.207295134740685, 5.342654179410752, 4.459058184690544, 6.421220747335324, 5.052866574764901, 8.552104052899884, 6.621844734949541, 3.5026894977266814, 4.17990528060779, 1.0498034528129578, 7.985369597319314, 9.033381088304353, 7.341814889488428, 7.033905883591943, 5.868870634298592, 4.155455853658163, 3.6246418903032764, 10.239034942158353, 7.281588306086687, 5.000196431553295, 7.97146080387896, 10.161169921907307, 5.562864608092361, 5.204392288474886, 6.721401044560568, 2.875862650608062, 8.33264989256601, 2.5351258961028873, 6.431664930409868, 7.023434529481193, 5.662579410084551, 6.868151095666756, 2.8091546365982434, 6.861391942289938, 6.239099801505806, 6.770783742931233, 4.160767333012575, 7.402289520173929, 8.63223387672069, 5.9206698988254844, 7.331477355880256, 3.521387709901707, 6.349288031855432, 7.552050354729887, 5.710012007006321, 1.9886164820204386, 5.8575253196012325, 9.168480952062515, 6.376375906080316, 3.4764876135401654, 4.453661815465583, 8.93759177196305, 3.636063041427082, 7.601387182746694, 1.9621271322633766, 3.5722927490703853, 7.002877168769064, 4.053743167384222, 6.048520106732052, 6.75119182469251, 7.903376838592257, 5.5031066195213425, 4.205810521482221, 2.7065331522437317], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8744540518037085, "mean_inference_ms": 8.0356350314614, "mean_action_processing_ms": 0.5396052789407623, "mean_env_wait_ms": 23.89834392538553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024937152862548828, "StateBufferConnector_ms": 0.03228926658630371, "ViewRequirementAgentConnector_ms": 0.9625775814056396}}, "episode_reward_max": 11.245372889952083, "episode_reward_min": -2.131815413562229, "episode_reward_mean": 5.823209736834461, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.131815413562229, 6.697760690391495, 11.245372889952083, 8.720423325560445, 4.605832344281443, 7.8820235335722355, 3.6617972533029843, 5.591537846740317, 9.333474743414097, 6.671886041850372, 7.0276351018582535, 7.116974380203669, 7.237284090762255, 7.25288057672007, 6.2591791255141125, 5.739981353959452, 6.333791468813237, 7.386898704534497, 6.631266764214994, -1.711179445214816, 9.482508732059367, 4.488056407128414, 6.565803148298955, 6.926814450232518, 4.722598133992947, 5.960346835636365, 7.388027194382268, 4.4602724365963295, 4.110275121996809, -0.7409857039316773, 9.542036431240524, 5.31273914139512, 2.248992813889776, 6.7924948858251994, 4.980990264885925, 3.756164007323662, 6.207295134740685, 5.342654179410752, 4.459058184690544, 6.421220747335324, 5.052866574764901, 8.552104052899884, 6.621844734949541, 3.5026894977266814, 4.17990528060779, 1.0498034528129578, 7.985369597319314, 9.033381088304353, 7.341814889488428, 7.033905883591943, 5.868870634298592, 4.155455853658163, 3.6246418903032764, 10.239034942158353, 7.281588306086687, 5.000196431553295, 7.97146080387896, 10.161169921907307, 5.562864608092361, 5.204392288474886, 6.721401044560568, 2.875862650608062, 8.33264989256601, 2.5351258961028873, 6.431664930409868, 7.023434529481193, 5.662579410084551, 6.868151095666756, 2.8091546365982434, 6.861391942289938, 6.239099801505806, 6.770783742931233, 4.160767333012575, 7.402289520173929, 8.63223387672069, 5.9206698988254844, 7.331477355880256, 3.521387709901707, 6.349288031855432, 7.552050354729887, 5.710012007006321, 1.9886164820204386, 5.8575253196012325, 9.168480952062515, 6.376375906080316, 3.4764876135401654, 4.453661815465583, 8.93759177196305, 3.636063041427082, 7.601387182746694, 1.9621271322633766, 3.5722927490703853, 7.002877168769064, 4.053743167384222, 6.048520106732052, 6.75119182469251, 7.903376838592257, 5.5031066195213425, 4.205810521482221, 2.7065331522437317], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8744540518037085, "mean_inference_ms": 8.0356350314614, "mean_action_processing_ms": 0.5396052789407623, "mean_env_wait_ms": 23.89834392538553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024937152862548828, "StateBufferConnector_ms": 0.03228926658630371, "ViewRequirementAgentConnector_ms": 0.9625775814056396}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6663874, "num_agent_steps_trained": 6663874, "num_env_steps_sampled": 6663874, "num_env_steps_trained": 6663874, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.7567234239558, "num_env_steps_trained_throughput_per_sec": 284.7567234239558, "timesteps_total": 6663874, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6663874, "timers": {"training_iteration_time_ms": 54821.153, "sample_time_ms": 41820.633, "load_time_ms": 1716.223, "load_throughput": 9111.867, "learn_time_ms": 10737.401, "learn_throughput": 1456.405, "synch_weights_time_ms": 424.974}, "counters": {"num_env_steps_sampled": 6663874, "num_env_steps_trained": 6663874, "num_agent_steps_sampled": 6663874, "num_agent_steps_trained": 6663874}, "done": false, "episodes_total": 1162, "training_iteration": 431, "trial_id": "2f030_00000", "date": "2025-06-07_08-54-16", "timestamp": 1749279256, "time_this_iter_s": 54.93105220794678, "time_total_s": 4670.502509593964, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4670.502509593964, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 77.64761904761905, "ram_util_percent": 67.42222222222223, "gpu_util_percent0": 0.08253968253968255, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.6337836842105256e-05, "total_loss": -0.07127666025337848, "policy_loss": -0.018172131004235283, "vf_loss": 0.01395706788636744, "vf_explained_var": 0.7547653461586346, "kl": 0.014728812318819413, "entropy": 20.787568730441006, "entropy_coeff": 0.0032604725}, "model": {}, "num_grad_updates_lifetime": 45925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6679512, "num_env_steps_trained": 6679512, "num_agent_steps_sampled": 6679512, "num_agent_steps_trained": 6679512}, "sampler_results": {"episode_reward_max": 10.601265984939527, "episode_reward_min": -1.711179445214816, "episode_reward_mean": 5.925845672100445, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.2591791255141125, 5.739981353959452, 6.333791468813237, 7.386898704534497, 6.631266764214994, -1.711179445214816, 9.482508732059367, 4.488056407128414, 6.565803148298955, 6.926814450232518, 4.722598133992947, 5.960346835636365, 7.388027194382268, 4.4602724365963295, 4.110275121996809, -0.7409857039316773, 9.542036431240524, 5.31273914139512, 2.248992813889776, 6.7924948858251994, 4.980990264885925, 3.756164007323662, 6.207295134740685, 5.342654179410752, 4.459058184690544, 6.421220747335324, 5.052866574764901, 8.552104052899884, 6.621844734949541, 3.5026894977266814, 4.17990528060779, 1.0498034528129578, 7.985369597319314, 9.033381088304353, 7.341814889488428, 7.033905883591943, 5.868870634298592, 4.155455853658163, 3.6246418903032764, 10.239034942158353, 7.281588306086687, 5.000196431553295, 7.97146080387896, 10.161169921907307, 5.562864608092361, 5.204392288474886, 6.721401044560568, 2.875862650608062, 8.33264989256601, 2.5351258961028873, 6.431664930409868, 7.023434529481193, 5.662579410084551, 6.868151095666756, 2.8091546365982434, 6.861391942289938, 6.239099801505806, 6.770783742931233, 4.160767333012575, 7.402289520173929, 8.63223387672069, 5.9206698988254844, 7.331477355880256, 3.521387709901707, 6.349288031855432, 7.552050354729887, 5.710012007006321, 1.9886164820204386, 5.8575253196012325, 9.168480952062515, 6.376375906080316, 3.4764876135401654, 4.453661815465583, 8.93759177196305, 3.636063041427082, 7.601387182746694, 1.9621271322633766, 3.5722927490703853, 7.002877168769064, 4.053743167384222, 6.048520106732052, 6.75119182469251, 7.903376838592257, 5.5031066195213425, 4.205810521482221, 2.7065331522437317, 5.085559461391001, 7.018507263529978, 3.2475814561737546, 8.72628957675174, 6.625396911833818, 9.0452348402627, 6.070402241246481, 7.0494784059470845, 10.601265984939527, 7.959232059510012, 8.336675611881143, 6.954690314101993, 5.02280098282938, 9.433545821247323], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8738895103025484, "mean_inference_ms": 8.03695595656456, "mean_action_processing_ms": 0.5397280267157527, "mean_env_wait_ms": 23.90120621740882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024904727935791016, "StateBufferConnector_ms": 0.032354116439819336, "ViewRequirementAgentConnector_ms": 0.9660730361938477}}, "episode_reward_max": 10.601265984939527, "episode_reward_min": -1.711179445214816, "episode_reward_mean": 5.925845672100445, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.2591791255141125, 5.739981353959452, 6.333791468813237, 7.386898704534497, 6.631266764214994, -1.711179445214816, 9.482508732059367, 4.488056407128414, 6.565803148298955, 6.926814450232518, 4.722598133992947, 5.960346835636365, 7.388027194382268, 4.4602724365963295, 4.110275121996809, -0.7409857039316773, 9.542036431240524, 5.31273914139512, 2.248992813889776, 6.7924948858251994, 4.980990264885925, 3.756164007323662, 6.207295134740685, 5.342654179410752, 4.459058184690544, 6.421220747335324, 5.052866574764901, 8.552104052899884, 6.621844734949541, 3.5026894977266814, 4.17990528060779, 1.0498034528129578, 7.985369597319314, 9.033381088304353, 7.341814889488428, 7.033905883591943, 5.868870634298592, 4.155455853658163, 3.6246418903032764, 10.239034942158353, 7.281588306086687, 5.000196431553295, 7.97146080387896, 10.161169921907307, 5.562864608092361, 5.204392288474886, 6.721401044560568, 2.875862650608062, 8.33264989256601, 2.5351258961028873, 6.431664930409868, 7.023434529481193, 5.662579410084551, 6.868151095666756, 2.8091546365982434, 6.861391942289938, 6.239099801505806, 6.770783742931233, 4.160767333012575, 7.402289520173929, 8.63223387672069, 5.9206698988254844, 7.331477355880256, 3.521387709901707, 6.349288031855432, 7.552050354729887, 5.710012007006321, 1.9886164820204386, 5.8575253196012325, 9.168480952062515, 6.376375906080316, 3.4764876135401654, 4.453661815465583, 8.93759177196305, 3.636063041427082, 7.601387182746694, 1.9621271322633766, 3.5722927490703853, 7.002877168769064, 4.053743167384222, 6.048520106732052, 6.75119182469251, 7.903376838592257, 5.5031066195213425, 4.205810521482221, 2.7065331522437317, 5.085559461391001, 7.018507263529978, 3.2475814561737546, 8.72628957675174, 6.625396911833818, 9.0452348402627, 6.070402241246481, 7.0494784059470845, 10.601265984939527, 7.959232059510012, 8.336675611881143, 6.954690314101993, 5.02280098282938, 9.433545821247323], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8738895103025484, "mean_inference_ms": 8.03695595656456, "mean_action_processing_ms": 0.5397280267157527, "mean_env_wait_ms": 23.90120621740882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024904727935791016, "StateBufferConnector_ms": 0.032354116439819336, "ViewRequirementAgentConnector_ms": 0.9660730361938477}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6679512, "num_agent_steps_trained": 6679512, "num_env_steps_sampled": 6679512, "num_env_steps_trained": 6679512, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.3249012054682, "num_env_steps_trained_throughput_per_sec": 285.3249012054682, "timesteps_total": 6679512, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6679512, "timers": {"training_iteration_time_ms": 54864.518, "sample_time_ms": 41873.984, "load_time_ms": 1716.0, "load_throughput": 9113.051, "learn_time_ms": 10723.558, "learn_throughput": 1458.285, "synch_weights_time_ms": 432.174}, "counters": {"num_env_steps_sampled": 6679512, "num_env_steps_trained": 6679512, "num_agent_steps_sampled": 6679512, "num_agent_steps_trained": 6679512}, "done": false, "episodes_total": 1176, "training_iteration": 432, "trial_id": "2f030_00000", "date": "2025-06-07_08-55-11", "timestamp": 1749279311, "time_this_iter_s": 54.823458194732666, "time_total_s": 4725.325967788696, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4725.325967788696, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 78.4047619047619, "ram_util_percent": 67.83174603174602, "gpu_util_percent0": 0.07444444444444444, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.621437894736843e-05, "total_loss": -0.07859200383536517, "policy_loss": -0.026852061930310978, "vf_loss": 0.015709888773377645, "vf_explained_var": 0.7538980416818098, "kl": 0.01472678949042254, "entropy": 20.905894451141357, "entropy_coeff": 0.0032018299999999993}, "model": {}, "num_grad_updates_lifetime": 46475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6695150, "num_env_steps_trained": 6695150, "num_agent_steps_sampled": 6695150, "num_agent_steps_trained": 6695150}, "sampler_results": {"episode_reward_max": 10.601265984939527, "episode_reward_min": -0.7409857039316773, "episode_reward_mean": 6.03331336637464, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.110275121996809, -0.7409857039316773, 9.542036431240524, 5.31273914139512, 2.248992813889776, 6.7924948858251994, 4.980990264885925, 3.756164007323662, 6.207295134740685, 5.342654179410752, 4.459058184690544, 6.421220747335324, 5.052866574764901, 8.552104052899884, 6.621844734949541, 3.5026894977266814, 4.17990528060779, 1.0498034528129578, 7.985369597319314, 9.033381088304353, 7.341814889488428, 7.033905883591943, 5.868870634298592, 4.155455853658163, 3.6246418903032764, 10.239034942158353, 7.281588306086687, 5.000196431553295, 7.97146080387896, 10.161169921907307, 5.562864608092361, 5.204392288474886, 6.721401044560568, 2.875862650608062, 8.33264989256601, 2.5351258961028873, 6.431664930409868, 7.023434529481193, 5.662579410084551, 6.868151095666756, 2.8091546365982434, 6.861391942289938, 6.239099801505806, 6.770783742931233, 4.160767333012575, 7.402289520173929, 8.63223387672069, 5.9206698988254844, 7.331477355880256, 3.521387709901707, 6.349288031855432, 7.552050354729887, 5.710012007006321, 1.9886164820204386, 5.8575253196012325, 9.168480952062515, 6.376375906080316, 3.4764876135401654, 4.453661815465583, 8.93759177196305, 3.636063041427082, 7.601387182746694, 1.9621271322633766, 3.5722927490703853, 7.002877168769064, 4.053743167384222, 6.048520106732052, 6.75119182469251, 7.903376838592257, 5.5031066195213425, 4.205810521482221, 2.7065331522437317, 5.085559461391001, 7.018507263529978, 3.2475814561737546, 8.72628957675174, 6.625396911833818, 9.0452348402627, 6.070402241246481, 7.0494784059470845, 10.601265984939527, 7.959232059510012, 8.336675611881143, 6.954690314101993, 5.02280098282938, 9.433545821247323, 6.341911943405399, 4.852647637984383, 9.433160042770393, 5.001411227318422, 1.684089317682689, 6.124775350436197, 6.657116343352868, 10.171999496718083, 6.171141196941503, 5.605196392057382, 8.276223607572762, 3.7515454984452816, 9.829839604774044, 7.4800770781087405], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8732096721828158, "mean_inference_ms": 8.038216382414246, "mean_action_processing_ms": 0.5398319588406719, "mean_env_wait_ms": 23.90453375702913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024133920669555664, "StateBufferConnector_ms": 0.029221296310424805, "ViewRequirementAgentConnector_ms": 0.9351162910461426}}, "episode_reward_max": 10.601265984939527, "episode_reward_min": -0.7409857039316773, "episode_reward_mean": 6.03331336637464, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.110275121996809, -0.7409857039316773, 9.542036431240524, 5.31273914139512, 2.248992813889776, 6.7924948858251994, 4.980990264885925, 3.756164007323662, 6.207295134740685, 5.342654179410752, 4.459058184690544, 6.421220747335324, 5.052866574764901, 8.552104052899884, 6.621844734949541, 3.5026894977266814, 4.17990528060779, 1.0498034528129578, 7.985369597319314, 9.033381088304353, 7.341814889488428, 7.033905883591943, 5.868870634298592, 4.155455853658163, 3.6246418903032764, 10.239034942158353, 7.281588306086687, 5.000196431553295, 7.97146080387896, 10.161169921907307, 5.562864608092361, 5.204392288474886, 6.721401044560568, 2.875862650608062, 8.33264989256601, 2.5351258961028873, 6.431664930409868, 7.023434529481193, 5.662579410084551, 6.868151095666756, 2.8091546365982434, 6.861391942289938, 6.239099801505806, 6.770783742931233, 4.160767333012575, 7.402289520173929, 8.63223387672069, 5.9206698988254844, 7.331477355880256, 3.521387709901707, 6.349288031855432, 7.552050354729887, 5.710012007006321, 1.9886164820204386, 5.8575253196012325, 9.168480952062515, 6.376375906080316, 3.4764876135401654, 4.453661815465583, 8.93759177196305, 3.636063041427082, 7.601387182746694, 1.9621271322633766, 3.5722927490703853, 7.002877168769064, 4.053743167384222, 6.048520106732052, 6.75119182469251, 7.903376838592257, 5.5031066195213425, 4.205810521482221, 2.7065331522437317, 5.085559461391001, 7.018507263529978, 3.2475814561737546, 8.72628957675174, 6.625396911833818, 9.0452348402627, 6.070402241246481, 7.0494784059470845, 10.601265984939527, 7.959232059510012, 8.336675611881143, 6.954690314101993, 5.02280098282938, 9.433545821247323, 6.341911943405399, 4.852647637984383, 9.433160042770393, 5.001411227318422, 1.684089317682689, 6.124775350436197, 6.657116343352868, 10.171999496718083, 6.171141196941503, 5.605196392057382, 8.276223607572762, 3.7515454984452816, 9.829839604774044, 7.4800770781087405], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8732096721828158, "mean_inference_ms": 8.038216382414246, "mean_action_processing_ms": 0.5398319588406719, "mean_env_wait_ms": 23.90453375702913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024133920669555664, "StateBufferConnector_ms": 0.029221296310424805, "ViewRequirementAgentConnector_ms": 0.9351162910461426}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6695150, "num_agent_steps_trained": 6695150, "num_env_steps_sampled": 6695150, "num_env_steps_trained": 6695150, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.98268415820945, "num_env_steps_trained_throughput_per_sec": 284.98268415820945, "timesteps_total": 6695150, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6695150, "timers": {"training_iteration_time_ms": 54921.43, "sample_time_ms": 41938.18, "load_time_ms": 1712.095, "load_throughput": 9133.841, "learn_time_ms": 10716.981, "learn_throughput": 1459.18, "synch_weights_time_ms": 435.041}, "counters": {"num_env_steps_sampled": 6695150, "num_env_steps_trained": 6695150, "num_agent_steps_sampled": 6695150, "num_agent_steps_trained": 6695150}, "done": false, "episodes_total": 1190, "training_iteration": 433, "trial_id": "2f030_00000", "date": "2025-06-07_08-56-06", "timestamp": 1749279366, "time_this_iter_s": 54.88939690589905, "time_total_s": 4780.215364694595, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4780.215364694595, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 77.67619047619048, "ram_util_percent": 68.12063492063493, "gpu_util_percent0": 0.07761904761904763, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.6090921052631585e-05, "total_loss": -0.07724010679108853, "policy_loss": -0.026640749231922778, "vf_loss": 0.014300965902988206, "vf_explained_var": 0.7601495983383872, "kl": 0.015283244896528613, "entropy": 20.92461932962591, "entropy_coeff": 0.003143187499999999}, "model": {}, "num_grad_updates_lifetime": 47025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6710788, "num_env_steps_trained": 6710788, "num_agent_steps_sampled": 6710788, "num_agent_steps_trained": 6710788}, "sampler_results": {"episode_reward_max": 10.601265984939527, "episode_reward_min": 1.0498034528129578, "episode_reward_mean": 6.240475588975013, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.621844734949541, 3.5026894977266814, 4.17990528060779, 1.0498034528129578, 7.985369597319314, 9.033381088304353, 7.341814889488428, 7.033905883591943, 5.868870634298592, 4.155455853658163, 3.6246418903032764, 10.239034942158353, 7.281588306086687, 5.000196431553295, 7.97146080387896, 10.161169921907307, 5.562864608092361, 5.204392288474886, 6.721401044560568, 2.875862650608062, 8.33264989256601, 2.5351258961028873, 6.431664930409868, 7.023434529481193, 5.662579410084551, 6.868151095666756, 2.8091546365982434, 6.861391942289938, 6.239099801505806, 6.770783742931233, 4.160767333012575, 7.402289520173929, 8.63223387672069, 5.9206698988254844, 7.331477355880256, 3.521387709901707, 6.349288031855432, 7.552050354729887, 5.710012007006321, 1.9886164820204386, 5.8575253196012325, 9.168480952062515, 6.376375906080316, 3.4764876135401654, 4.453661815465583, 8.93759177196305, 3.636063041427082, 7.601387182746694, 1.9621271322633766, 3.5722927490703853, 7.002877168769064, 4.053743167384222, 6.048520106732052, 6.75119182469251, 7.903376838592257, 5.5031066195213425, 4.205810521482221, 2.7065331522437317, 5.085559461391001, 7.018507263529978, 3.2475814561737546, 8.72628957675174, 6.625396911833818, 9.0452348402627, 6.070402241246481, 7.0494784059470845, 10.601265984939527, 7.959232059510012, 8.336675611881143, 6.954690314101993, 5.02280098282938, 9.433545821247323, 6.341911943405399, 4.852647637984383, 9.433160042770393, 5.001411227318422, 1.684089317682689, 6.124775350436197, 6.657116343352868, 10.171999496718083, 6.171141196941503, 5.605196392057382, 8.276223607572762, 3.7515454984452816, 9.829839604774044, 7.4800770781087405, 5.156447974344685, 7.250689707241782, 7.984919465893799, 8.26234780417218, 8.642311615899008, 8.062278615630015, 4.835781464028989, 5.501732977715225, 5.857497357306507, 5.156244346447635, 5.0843349097748085, 8.312330899288911, 7.609931260413251, 5.0372796983478425], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.872473460085502, "mean_inference_ms": 8.03913538352642, "mean_action_processing_ms": 0.5399022943183425, "mean_env_wait_ms": 23.9069609344429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023111820220947266, "StateBufferConnector_ms": 0.051421403884887695, "ViewRequirementAgentConnector_ms": 0.953740119934082}}, "episode_reward_max": 10.601265984939527, "episode_reward_min": 1.0498034528129578, "episode_reward_mean": 6.240475588975013, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.621844734949541, 3.5026894977266814, 4.17990528060779, 1.0498034528129578, 7.985369597319314, 9.033381088304353, 7.341814889488428, 7.033905883591943, 5.868870634298592, 4.155455853658163, 3.6246418903032764, 10.239034942158353, 7.281588306086687, 5.000196431553295, 7.97146080387896, 10.161169921907307, 5.562864608092361, 5.204392288474886, 6.721401044560568, 2.875862650608062, 8.33264989256601, 2.5351258961028873, 6.431664930409868, 7.023434529481193, 5.662579410084551, 6.868151095666756, 2.8091546365982434, 6.861391942289938, 6.239099801505806, 6.770783742931233, 4.160767333012575, 7.402289520173929, 8.63223387672069, 5.9206698988254844, 7.331477355880256, 3.521387709901707, 6.349288031855432, 7.552050354729887, 5.710012007006321, 1.9886164820204386, 5.8575253196012325, 9.168480952062515, 6.376375906080316, 3.4764876135401654, 4.453661815465583, 8.93759177196305, 3.636063041427082, 7.601387182746694, 1.9621271322633766, 3.5722927490703853, 7.002877168769064, 4.053743167384222, 6.048520106732052, 6.75119182469251, 7.903376838592257, 5.5031066195213425, 4.205810521482221, 2.7065331522437317, 5.085559461391001, 7.018507263529978, 3.2475814561737546, 8.72628957675174, 6.625396911833818, 9.0452348402627, 6.070402241246481, 7.0494784059470845, 10.601265984939527, 7.959232059510012, 8.336675611881143, 6.954690314101993, 5.02280098282938, 9.433545821247323, 6.341911943405399, 4.852647637984383, 9.433160042770393, 5.001411227318422, 1.684089317682689, 6.124775350436197, 6.657116343352868, 10.171999496718083, 6.171141196941503, 5.605196392057382, 8.276223607572762, 3.7515454984452816, 9.829839604774044, 7.4800770781087405, 5.156447974344685, 7.250689707241782, 7.984919465893799, 8.26234780417218, 8.642311615899008, 8.062278615630015, 4.835781464028989, 5.501732977715225, 5.857497357306507, 5.156244346447635, 5.0843349097748085, 8.312330899288911, 7.609931260413251, 5.0372796983478425], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.872473460085502, "mean_inference_ms": 8.03913538352642, "mean_action_processing_ms": 0.5399022943183425, "mean_env_wait_ms": 23.9069609344429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023111820220947266, "StateBufferConnector_ms": 0.051421403884887695, "ViewRequirementAgentConnector_ms": 0.953740119934082}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6710788, "num_agent_steps_trained": 6710788, "num_env_steps_sampled": 6710788, "num_env_steps_trained": 6710788, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.69034477334594, "num_env_steps_trained_throughput_per_sec": 284.69034477334594, "timesteps_total": 6710788, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6710788, "timers": {"training_iteration_time_ms": 54894.523, "sample_time_ms": 41900.964, "load_time_ms": 1721.437, "load_throughput": 9084.274, "learn_time_ms": 10715.962, "learn_throughput": 1459.318, "synch_weights_time_ms": 433.933}, "counters": {"num_env_steps_sampled": 6710788, "num_env_steps_trained": 6710788, "num_agent_steps_sampled": 6710788, "num_agent_steps_trained": 6710788}, "done": false, "episodes_total": 1204, "training_iteration": 434, "trial_id": "2f030_00000", "date": "2025-06-07_08-57-01", "timestamp": 1749279421, "time_this_iter_s": 54.94570183753967, "time_total_s": 4835.161066532135, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4835.161066532135, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 77.4936507936508, "ram_util_percent": 67.7904761904762, "gpu_util_percent0": 0.07714285714285714, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.596746315789474e-05, "total_loss": -0.07413375336295841, "policy_loss": -0.024508315073630497, "vf_loss": 0.013943910404023799, "vf_explained_var": 0.743955617167733, "kl": 0.01496201667426662, "entropy": 20.897824410525235, "entropy_coeff": 0.0030845450000000006}, "model": {}, "num_grad_updates_lifetime": 47575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6726426, "num_env_steps_trained": 6726426, "num_agent_steps_sampled": 6726426, "num_agent_steps_trained": 6726426}, "sampler_results": {"episode_reward_max": 10.601265984939527, "episode_reward_min": 1.684089317682689, "episode_reward_mean": 6.287790339382766, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.97146080387896, 10.161169921907307, 5.562864608092361, 5.204392288474886, 6.721401044560568, 2.875862650608062, 8.33264989256601, 2.5351258961028873, 6.431664930409868, 7.023434529481193, 5.662579410084551, 6.868151095666756, 2.8091546365982434, 6.861391942289938, 6.239099801505806, 6.770783742931233, 4.160767333012575, 7.402289520173929, 8.63223387672069, 5.9206698988254844, 7.331477355880256, 3.521387709901707, 6.349288031855432, 7.552050354729887, 5.710012007006321, 1.9886164820204386, 5.8575253196012325, 9.168480952062515, 6.376375906080316, 3.4764876135401654, 4.453661815465583, 8.93759177196305, 3.636063041427082, 7.601387182746694, 1.9621271322633766, 3.5722927490703853, 7.002877168769064, 4.053743167384222, 6.048520106732052, 6.75119182469251, 7.903376838592257, 5.5031066195213425, 4.205810521482221, 2.7065331522437317, 5.085559461391001, 7.018507263529978, 3.2475814561737546, 8.72628957675174, 6.625396911833818, 9.0452348402627, 6.070402241246481, 7.0494784059470845, 10.601265984939527, 7.959232059510012, 8.336675611881143, 6.954690314101993, 5.02280098282938, 9.433545821247323, 6.341911943405399, 4.852647637984383, 9.433160042770393, 5.001411227318422, 1.684089317682689, 6.124775350436197, 6.657116343352868, 10.171999496718083, 6.171141196941503, 5.605196392057382, 8.276223607572762, 3.7515454984452816, 9.829839604774044, 7.4800770781087405, 5.156447974344685, 7.250689707241782, 7.984919465893799, 8.26234780417218, 8.642311615899008, 8.062278615630015, 4.835781464028989, 5.501732977715225, 5.857497357306507, 5.156244346447635, 5.0843349097748085, 8.312330899288911, 7.609931260413251, 5.0372796983478425, 5.97346284303147, 5.881106552611905, 6.2480442966131875, 7.9416400428336, 4.926960794311193, 3.8740686009325653, 7.188632739211815, 6.671356977652909, 6.336426011485187, 7.655126705917452, 2.7097128294313184, 7.192790498748204, 6.956716195002351, 8.093932435851602], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.871509357270602, "mean_inference_ms": 8.0400452608335, "mean_action_processing_ms": 0.5399348825330744, "mean_env_wait_ms": 23.90908729270744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02712535858154297, "StateBufferConnector_ms": 0.048348426818847656, "ViewRequirementAgentConnector_ms": 0.9511775970458984}}, "episode_reward_max": 10.601265984939527, "episode_reward_min": 1.684089317682689, "episode_reward_mean": 6.287790339382766, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.97146080387896, 10.161169921907307, 5.562864608092361, 5.204392288474886, 6.721401044560568, 2.875862650608062, 8.33264989256601, 2.5351258961028873, 6.431664930409868, 7.023434529481193, 5.662579410084551, 6.868151095666756, 2.8091546365982434, 6.861391942289938, 6.239099801505806, 6.770783742931233, 4.160767333012575, 7.402289520173929, 8.63223387672069, 5.9206698988254844, 7.331477355880256, 3.521387709901707, 6.349288031855432, 7.552050354729887, 5.710012007006321, 1.9886164820204386, 5.8575253196012325, 9.168480952062515, 6.376375906080316, 3.4764876135401654, 4.453661815465583, 8.93759177196305, 3.636063041427082, 7.601387182746694, 1.9621271322633766, 3.5722927490703853, 7.002877168769064, 4.053743167384222, 6.048520106732052, 6.75119182469251, 7.903376838592257, 5.5031066195213425, 4.205810521482221, 2.7065331522437317, 5.085559461391001, 7.018507263529978, 3.2475814561737546, 8.72628957675174, 6.625396911833818, 9.0452348402627, 6.070402241246481, 7.0494784059470845, 10.601265984939527, 7.959232059510012, 8.336675611881143, 6.954690314101993, 5.02280098282938, 9.433545821247323, 6.341911943405399, 4.852647637984383, 9.433160042770393, 5.001411227318422, 1.684089317682689, 6.124775350436197, 6.657116343352868, 10.171999496718083, 6.171141196941503, 5.605196392057382, 8.276223607572762, 3.7515454984452816, 9.829839604774044, 7.4800770781087405, 5.156447974344685, 7.250689707241782, 7.984919465893799, 8.26234780417218, 8.642311615899008, 8.062278615630015, 4.835781464028989, 5.501732977715225, 5.857497357306507, 5.156244346447635, 5.0843349097748085, 8.312330899288911, 7.609931260413251, 5.0372796983478425, 5.97346284303147, 5.881106552611905, 6.2480442966131875, 7.9416400428336, 4.926960794311193, 3.8740686009325653, 7.188632739211815, 6.671356977652909, 6.336426011485187, 7.655126705917452, 2.7097128294313184, 7.192790498748204, 6.956716195002351, 8.093932435851602], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.871509357270602, "mean_inference_ms": 8.0400452608335, "mean_action_processing_ms": 0.5399348825330744, "mean_env_wait_ms": 23.90908729270744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02712535858154297, "StateBufferConnector_ms": 0.048348426818847656, "ViewRequirementAgentConnector_ms": 0.9511775970458984}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6726426, "num_agent_steps_trained": 6726426, "num_env_steps_sampled": 6726426, "num_env_steps_trained": 6726426, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.95515406380696, "num_env_steps_trained_throughput_per_sec": 285.95515406380696, "timesteps_total": 6726426, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6726426, "timers": {"training_iteration_time_ms": 54887.568, "sample_time_ms": 41905.392, "load_time_ms": 1715.067, "load_throughput": 9118.01, "learn_time_ms": 10714.431, "learn_throughput": 1459.527, "synch_weights_time_ms": 431.41}, "counters": {"num_env_steps_sampled": 6726426, "num_env_steps_trained": 6726426, "num_agent_steps_sampled": 6726426, "num_agent_steps_trained": 6726426}, "done": false, "episodes_total": 1218, "training_iteration": 435, "trial_id": "2f030_00000", "date": "2025-06-07_08-57-56", "timestamp": 1749279476, "time_this_iter_s": 54.71310544013977, "time_total_s": 4889.874171972275, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4889.874171972275, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 77.5516129032258, "ram_util_percent": 67.74032258064517, "gpu_util_percent0": 0.08080645161290322, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.58440052631579e-05, "total_loss": -0.0632863923505118, "policy_loss": -0.015274557809832253, "vf_loss": 0.01655447743240405, "vf_explained_var": 0.7380056003007022, "kl": 0.014173356885228052, "entropy": 20.842836395610462, "entropy_coeff": 0.0030259025}, "model": {}, "num_grad_updates_lifetime": 48125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6742064, "num_env_steps_trained": 6742064, "num_agent_steps_sampled": 6742064, "num_agent_steps_trained": 6742064}, "sampler_results": {"episode_reward_max": 10.601265984939527, "episode_reward_min": 1.342791021489203, "episode_reward_mean": 6.23072884812525, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.239099801505806, 6.770783742931233, 4.160767333012575, 7.402289520173929, 8.63223387672069, 5.9206698988254844, 7.331477355880256, 3.521387709901707, 6.349288031855432, 7.552050354729887, 5.710012007006321, 1.9886164820204386, 5.8575253196012325, 9.168480952062515, 6.376375906080316, 3.4764876135401654, 4.453661815465583, 8.93759177196305, 3.636063041427082, 7.601387182746694, 1.9621271322633766, 3.5722927490703853, 7.002877168769064, 4.053743167384222, 6.048520106732052, 6.75119182469251, 7.903376838592257, 5.5031066195213425, 4.205810521482221, 2.7065331522437317, 5.085559461391001, 7.018507263529978, 3.2475814561737546, 8.72628957675174, 6.625396911833818, 9.0452348402627, 6.070402241246481, 7.0494784059470845, 10.601265984939527, 7.959232059510012, 8.336675611881143, 6.954690314101993, 5.02280098282938, 9.433545821247323, 6.341911943405399, 4.852647637984383, 9.433160042770393, 5.001411227318422, 1.684089317682689, 6.124775350436197, 6.657116343352868, 10.171999496718083, 6.171141196941503, 5.605196392057382, 8.276223607572762, 3.7515454984452816, 9.829839604774044, 7.4800770781087405, 5.156447974344685, 7.250689707241782, 7.984919465893799, 8.26234780417218, 8.642311615899008, 8.062278615630015, 4.835781464028989, 5.501732977715225, 5.857497357306507, 5.156244346447635, 5.0843349097748085, 8.312330899288911, 7.609931260413251, 5.0372796983478425, 5.97346284303147, 5.881106552611905, 6.2480442966131875, 7.9416400428336, 4.926960794311193, 3.8740686009325653, 7.188632739211815, 6.671356977652909, 6.336426011485187, 7.655126705917452, 2.7097128294313184, 7.192790498748204, 6.956716195002351, 8.093932435851602, 7.422398653568783, 1.342791021489203, 8.499218027924883, 5.442165128748276, 7.148919088602245, 1.7692601747219934, 7.964269629261002, 1.3790578264939322, 6.07646984783759, 4.0302863600347, 8.168054515513175, 7.377292790976741, 6.2321251640589015, 6.462846295738564], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.870091591565237, "mean_inference_ms": 8.040954233857217, "mean_action_processing_ms": 0.5399853953252285, "mean_env_wait_ms": 23.911726264126155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029042720794677734, "StateBufferConnector_ms": 0.05533194541931152, "ViewRequirementAgentConnector_ms": 0.9524149894714355}}, "episode_reward_max": 10.601265984939527, "episode_reward_min": 1.342791021489203, "episode_reward_mean": 6.23072884812525, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.239099801505806, 6.770783742931233, 4.160767333012575, 7.402289520173929, 8.63223387672069, 5.9206698988254844, 7.331477355880256, 3.521387709901707, 6.349288031855432, 7.552050354729887, 5.710012007006321, 1.9886164820204386, 5.8575253196012325, 9.168480952062515, 6.376375906080316, 3.4764876135401654, 4.453661815465583, 8.93759177196305, 3.636063041427082, 7.601387182746694, 1.9621271322633766, 3.5722927490703853, 7.002877168769064, 4.053743167384222, 6.048520106732052, 6.75119182469251, 7.903376838592257, 5.5031066195213425, 4.205810521482221, 2.7065331522437317, 5.085559461391001, 7.018507263529978, 3.2475814561737546, 8.72628957675174, 6.625396911833818, 9.0452348402627, 6.070402241246481, 7.0494784059470845, 10.601265984939527, 7.959232059510012, 8.336675611881143, 6.954690314101993, 5.02280098282938, 9.433545821247323, 6.341911943405399, 4.852647637984383, 9.433160042770393, 5.001411227318422, 1.684089317682689, 6.124775350436197, 6.657116343352868, 10.171999496718083, 6.171141196941503, 5.605196392057382, 8.276223607572762, 3.7515454984452816, 9.829839604774044, 7.4800770781087405, 5.156447974344685, 7.250689707241782, 7.984919465893799, 8.26234780417218, 8.642311615899008, 8.062278615630015, 4.835781464028989, 5.501732977715225, 5.857497357306507, 5.156244346447635, 5.0843349097748085, 8.312330899288911, 7.609931260413251, 5.0372796983478425, 5.97346284303147, 5.881106552611905, 6.2480442966131875, 7.9416400428336, 4.926960794311193, 3.8740686009325653, 7.188632739211815, 6.671356977652909, 6.336426011485187, 7.655126705917452, 2.7097128294313184, 7.192790498748204, 6.956716195002351, 8.093932435851602, 7.422398653568783, 1.342791021489203, 8.499218027924883, 5.442165128748276, 7.148919088602245, 1.7692601747219934, 7.964269629261002, 1.3790578264939322, 6.07646984783759, 4.0302863600347, 8.168054515513175, 7.377292790976741, 6.2321251640589015, 6.462846295738564], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.870091591565237, "mean_inference_ms": 8.040954233857217, "mean_action_processing_ms": 0.5399853953252285, "mean_env_wait_ms": 23.911726264126155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029042720794677734, "StateBufferConnector_ms": 0.05533194541931152, "ViewRequirementAgentConnector_ms": 0.9524149894714355}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6742064, "num_agent_steps_trained": 6742064, "num_env_steps_sampled": 6742064, "num_env_steps_trained": 6742064, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.11311736895027, "num_env_steps_trained_throughput_per_sec": 282.11311736895027, "timesteps_total": 6742064, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6742064, "timers": {"training_iteration_time_ms": 54999.103, "sample_time_ms": 41959.203, "load_time_ms": 1722.311, "load_throughput": 9079.661, "learn_time_ms": 10738.006, "learn_throughput": 1456.322, "synch_weights_time_ms": 456.493}, "counters": {"num_env_steps_sampled": 6742064, "num_env_steps_trained": 6742064, "num_agent_steps_sampled": 6742064, "num_agent_steps_trained": 6742064}, "done": false, "episodes_total": 1232, "training_iteration": 436, "trial_id": "2f030_00000", "date": "2025-06-07_08-58-51", "timestamp": 1749279531, "time_this_iter_s": 55.44866442680359, "time_total_s": 4945.322836399078, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4945.322836399078, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 76.534375, "ram_util_percent": 67.965625, "gpu_util_percent0": 0.08109374999999999, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.572054736842105e-05, "total_loss": -0.07520842235366051, "policy_loss": -0.02808424642713362, "vf_loss": 0.015132011059163647, "vf_explained_var": 0.7211667369712483, "kl": 0.014425440855980427, "entropy": 20.87227010380138, "entropy_coeff": 0.00296726}, "model": {}, "num_grad_updates_lifetime": 48675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6757702, "num_env_steps_trained": 6757702, "num_agent_steps_sampled": 6757702, "num_agent_steps_trained": 6757702}, "sampler_results": {"episode_reward_max": 10.601265984939527, "episode_reward_min": 1.342791021489203, "episode_reward_mean": 6.150397430900809, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.376375906080316, 3.4764876135401654, 4.453661815465583, 8.93759177196305, 3.636063041427082, 7.601387182746694, 1.9621271322633766, 3.5722927490703853, 7.002877168769064, 4.053743167384222, 6.048520106732052, 6.75119182469251, 7.903376838592257, 5.5031066195213425, 4.205810521482221, 2.7065331522437317, 5.085559461391001, 7.018507263529978, 3.2475814561737546, 8.72628957675174, 6.625396911833818, 9.0452348402627, 6.070402241246481, 7.0494784059470845, 10.601265984939527, 7.959232059510012, 8.336675611881143, 6.954690314101993, 5.02280098282938, 9.433545821247323, 6.341911943405399, 4.852647637984383, 9.433160042770393, 5.001411227318422, 1.684089317682689, 6.124775350436197, 6.657116343352868, 10.171999496718083, 6.171141196941503, 5.605196392057382, 8.276223607572762, 3.7515454984452816, 9.829839604774044, 7.4800770781087405, 5.156447974344685, 7.250689707241782, 7.984919465893799, 8.26234780417218, 8.642311615899008, 8.062278615630015, 4.835781464028989, 5.501732977715225, 5.857497357306507, 5.156244346447635, 5.0843349097748085, 8.312330899288911, 7.609931260413251, 5.0372796983478425, 5.97346284303147, 5.881106552611905, 6.2480442966131875, 7.9416400428336, 4.926960794311193, 3.8740686009325653, 7.188632739211815, 6.671356977652909, 6.336426011485187, 7.655126705917452, 2.7097128294313184, 7.192790498748204, 6.956716195002351, 8.093932435851602, 7.422398653568783, 1.342791021489203, 8.499218027924883, 5.442165128748276, 7.148919088602245, 1.7692601747219934, 7.964269629261002, 1.3790578264939322, 6.07646984783759, 4.0302863600347, 8.168054515513175, 7.377292790976741, 6.2321251640589015, 6.462846295738564, 5.775965613859789, 4.424173196353389, 5.185610894378171, 3.2394001728673576, 5.530513243155447, 5.034897636264909, 4.129565613857846, 5.717459008923094, 7.176770517052605, 7.457568209336604, 4.868886487585461, 7.961570027993158, 6.189717190517052, 5.879442851638631], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.868868524809666, "mean_inference_ms": 8.04153674644169, "mean_action_processing_ms": 0.5400586023338199, "mean_env_wait_ms": 23.913691425398373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200793266296387, "StateBufferConnector_ms": 0.05836319923400879, "ViewRequirementAgentConnector_ms": 0.9627673625946045}}, "episode_reward_max": 10.601265984939527, "episode_reward_min": 1.342791021489203, "episode_reward_mean": 6.150397430900809, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.376375906080316, 3.4764876135401654, 4.453661815465583, 8.93759177196305, 3.636063041427082, 7.601387182746694, 1.9621271322633766, 3.5722927490703853, 7.002877168769064, 4.053743167384222, 6.048520106732052, 6.75119182469251, 7.903376838592257, 5.5031066195213425, 4.205810521482221, 2.7065331522437317, 5.085559461391001, 7.018507263529978, 3.2475814561737546, 8.72628957675174, 6.625396911833818, 9.0452348402627, 6.070402241246481, 7.0494784059470845, 10.601265984939527, 7.959232059510012, 8.336675611881143, 6.954690314101993, 5.02280098282938, 9.433545821247323, 6.341911943405399, 4.852647637984383, 9.433160042770393, 5.001411227318422, 1.684089317682689, 6.124775350436197, 6.657116343352868, 10.171999496718083, 6.171141196941503, 5.605196392057382, 8.276223607572762, 3.7515454984452816, 9.829839604774044, 7.4800770781087405, 5.156447974344685, 7.250689707241782, 7.984919465893799, 8.26234780417218, 8.642311615899008, 8.062278615630015, 4.835781464028989, 5.501732977715225, 5.857497357306507, 5.156244346447635, 5.0843349097748085, 8.312330899288911, 7.609931260413251, 5.0372796983478425, 5.97346284303147, 5.881106552611905, 6.2480442966131875, 7.9416400428336, 4.926960794311193, 3.8740686009325653, 7.188632739211815, 6.671356977652909, 6.336426011485187, 7.655126705917452, 2.7097128294313184, 7.192790498748204, 6.956716195002351, 8.093932435851602, 7.422398653568783, 1.342791021489203, 8.499218027924883, 5.442165128748276, 7.148919088602245, 1.7692601747219934, 7.964269629261002, 1.3790578264939322, 6.07646984783759, 4.0302863600347, 8.168054515513175, 7.377292790976741, 6.2321251640589015, 6.462846295738564, 5.775965613859789, 4.424173196353389, 5.185610894378171, 3.2394001728673576, 5.530513243155447, 5.034897636264909, 4.129565613857846, 5.717459008923094, 7.176770517052605, 7.457568209336604, 4.868886487585461, 7.961570027993158, 6.189717190517052, 5.879442851638631], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.868868524809666, "mean_inference_ms": 8.04153674644169, "mean_action_processing_ms": 0.5400586023338199, "mean_env_wait_ms": 23.913691425398373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200793266296387, "StateBufferConnector_ms": 0.05836319923400879, "ViewRequirementAgentConnector_ms": 0.9627673625946045}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6757702, "num_agent_steps_trained": 6757702, "num_env_steps_sampled": 6757702, "num_env_steps_trained": 6757702, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.8048610983363, "num_env_steps_trained_throughput_per_sec": 286.8048610983363, "timesteps_total": 6757702, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6757702, "timers": {"training_iteration_time_ms": 54861.501, "sample_time_ms": 41805.105, "load_time_ms": 1735.97, "load_throughput": 9008.218, "learn_time_ms": 10744.371, "learn_throughput": 1455.46, "synch_weights_time_ms": 456.35}, "counters": {"num_env_steps_sampled": 6757702, "num_env_steps_trained": 6757702, "num_agent_steps_sampled": 6757702, "num_agent_steps_trained": 6757702}, "done": false, "episodes_total": 1246, "training_iteration": 437, "trial_id": "2f030_00000", "date": "2025-06-07_08-59-46", "timestamp": 1749279586, "time_this_iter_s": 54.54086518287659, "time_total_s": 4999.863701581955, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4999.863701581955, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 78.3590163934426, "ram_util_percent": 67.95737704918035, "gpu_util_percent0": 0.07295081967213116, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.55970894736842e-05, "total_loss": -0.07893931704911997, "policy_loss": -0.033362738042209954, "vf_loss": 0.014400472072037783, "vf_explained_var": 0.7528302102739161, "kl": 0.014798228105500806, "entropy": 20.776808291348544, "entropy_coeff": 0.0029086175000000002}, "model": {}, "num_grad_updates_lifetime": 49225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6773340, "num_env_steps_trained": 6773340, "num_agent_steps_sampled": 6773340, "num_agent_steps_trained": 6773340}, "sampler_results": {"episode_reward_max": 10.980174015011036, "episode_reward_min": 1.342791021489203, "episode_reward_mean": 6.376600324160442, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.205810521482221, 2.7065331522437317, 5.085559461391001, 7.018507263529978, 3.2475814561737546, 8.72628957675174, 6.625396911833818, 9.0452348402627, 6.070402241246481, 7.0494784059470845, 10.601265984939527, 7.959232059510012, 8.336675611881143, 6.954690314101993, 5.02280098282938, 9.433545821247323, 6.341911943405399, 4.852647637984383, 9.433160042770393, 5.001411227318422, 1.684089317682689, 6.124775350436197, 6.657116343352868, 10.171999496718083, 6.171141196941503, 5.605196392057382, 8.276223607572762, 3.7515454984452816, 9.829839604774044, 7.4800770781087405, 5.156447974344685, 7.250689707241782, 7.984919465893799, 8.26234780417218, 8.642311615899008, 8.062278615630015, 4.835781464028989, 5.501732977715225, 5.857497357306507, 5.156244346447635, 5.0843349097748085, 8.312330899288911, 7.609931260413251, 5.0372796983478425, 5.97346284303147, 5.881106552611905, 6.2480442966131875, 7.9416400428336, 4.926960794311193, 3.8740686009325653, 7.188632739211815, 6.671356977652909, 6.336426011485187, 7.655126705917452, 2.7097128294313184, 7.192790498748204, 6.956716195002351, 8.093932435851602, 7.422398653568783, 1.342791021489203, 8.499218027924883, 5.442165128748276, 7.148919088602245, 1.7692601747219934, 7.964269629261002, 1.3790578264939322, 6.07646984783759, 4.0302863600347, 8.168054515513175, 7.377292790976741, 6.2321251640589015, 6.462846295738564, 5.775965613859789, 4.424173196353389, 5.185610894378171, 3.2394001728673576, 5.530513243155447, 5.034897636264909, 4.129565613857846, 5.717459008923094, 7.176770517052605, 7.457568209336604, 4.868886487585461, 7.961570027993158, 6.189717190517052, 5.879442851638631, 6.1009162996293425, 6.441208758015688, 7.02394752027646, 9.906233601647113, 6.4570171948265775, 3.585165569109045, 7.4035827276616875, 6.769919655145247, 9.312052318194493, 6.536108813127177, 6.887732735161676, 10.980174015011036, 7.395093427787834, 5.099939628618016], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.86746423590869, "mean_inference_ms": 8.042140604997098, "mean_action_processing_ms": 0.5401176534282386, "mean_env_wait_ms": 23.915790938168115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03061389923095703, "StateBufferConnector_ms": 0.05527019500732422, "ViewRequirementAgentConnector_ms": 0.9842379093170166}}, "episode_reward_max": 10.980174015011036, "episode_reward_min": 1.342791021489203, "episode_reward_mean": 6.376600324160442, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.205810521482221, 2.7065331522437317, 5.085559461391001, 7.018507263529978, 3.2475814561737546, 8.72628957675174, 6.625396911833818, 9.0452348402627, 6.070402241246481, 7.0494784059470845, 10.601265984939527, 7.959232059510012, 8.336675611881143, 6.954690314101993, 5.02280098282938, 9.433545821247323, 6.341911943405399, 4.852647637984383, 9.433160042770393, 5.001411227318422, 1.684089317682689, 6.124775350436197, 6.657116343352868, 10.171999496718083, 6.171141196941503, 5.605196392057382, 8.276223607572762, 3.7515454984452816, 9.829839604774044, 7.4800770781087405, 5.156447974344685, 7.250689707241782, 7.984919465893799, 8.26234780417218, 8.642311615899008, 8.062278615630015, 4.835781464028989, 5.501732977715225, 5.857497357306507, 5.156244346447635, 5.0843349097748085, 8.312330899288911, 7.609931260413251, 5.0372796983478425, 5.97346284303147, 5.881106552611905, 6.2480442966131875, 7.9416400428336, 4.926960794311193, 3.8740686009325653, 7.188632739211815, 6.671356977652909, 6.336426011485187, 7.655126705917452, 2.7097128294313184, 7.192790498748204, 6.956716195002351, 8.093932435851602, 7.422398653568783, 1.342791021489203, 8.499218027924883, 5.442165128748276, 7.148919088602245, 1.7692601747219934, 7.964269629261002, 1.3790578264939322, 6.07646984783759, 4.0302863600347, 8.168054515513175, 7.377292790976741, 6.2321251640589015, 6.462846295738564, 5.775965613859789, 4.424173196353389, 5.185610894378171, 3.2394001728673576, 5.530513243155447, 5.034897636264909, 4.129565613857846, 5.717459008923094, 7.176770517052605, 7.457568209336604, 4.868886487585461, 7.961570027993158, 6.189717190517052, 5.879442851638631, 6.1009162996293425, 6.441208758015688, 7.02394752027646, 9.906233601647113, 6.4570171948265775, 3.585165569109045, 7.4035827276616875, 6.769919655145247, 9.312052318194493, 6.536108813127177, 6.887732735161676, 10.980174015011036, 7.395093427787834, 5.099939628618016], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.86746423590869, "mean_inference_ms": 8.042140604997098, "mean_action_processing_ms": 0.5401176534282386, "mean_env_wait_ms": 23.915790938168115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03061389923095703, "StateBufferConnector_ms": 0.05527019500732422, "ViewRequirementAgentConnector_ms": 0.9842379093170166}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6773340, "num_agent_steps_trained": 6773340, "num_env_steps_sampled": 6773340, "num_env_steps_trained": 6773340, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.74054551865845, "num_env_steps_trained_throughput_per_sec": 284.74054551865845, "timesteps_total": 6773340, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6773340, "timers": {"training_iteration_time_ms": 54941.256, "sample_time_ms": 41873.844, "load_time_ms": 1732.011, "load_throughput": 9028.813, "learn_time_ms": 10760.812, "learn_throughput": 1453.236, "synch_weights_time_ms": 455.395}, "counters": {"num_env_steps_sampled": 6773340, "num_env_steps_trained": 6773340, "num_agent_steps_sampled": 6773340, "num_agent_steps_trained": 6773340}, "done": false, "episodes_total": 1260, "training_iteration": 438, "trial_id": "2f030_00000", "date": "2025-06-07_09-00-41", "timestamp": 1749279641, "time_this_iter_s": 54.937153816223145, "time_total_s": 5054.800855398178, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5054.800855398178, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 77.5031746031746, "ram_util_percent": 68.07619047619049, "gpu_util_percent0": 0.07746031746031747, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.547363157894736e-05, "total_loss": -0.06833910474172708, "policy_loss": -0.02378576310080296, "vf_loss": 0.014500076919794082, "vf_explained_var": 0.7467797873236917, "kl": 0.014712635300820693, "entropy": 20.834393426721746, "entropy_coeff": 0.0028499750000000007}, "model": {}, "num_grad_updates_lifetime": 49775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6788978, "num_env_steps_trained": 6788978, "num_agent_steps_sampled": 6788978, "num_agent_steps_trained": 6788978}, "sampler_results": {"episode_reward_max": 11.500692749325829, "episode_reward_min": 1.342791021489203, "episode_reward_mean": 6.418097981549553, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.02280098282938, 9.433545821247323, 6.341911943405399, 4.852647637984383, 9.433160042770393, 5.001411227318422, 1.684089317682689, 6.124775350436197, 6.657116343352868, 10.171999496718083, 6.171141196941503, 5.605196392057382, 8.276223607572762, 3.7515454984452816, 9.829839604774044, 7.4800770781087405, 5.156447974344685, 7.250689707241782, 7.984919465893799, 8.26234780417218, 8.642311615899008, 8.062278615630015, 4.835781464028989, 5.501732977715225, 5.857497357306507, 5.156244346447635, 5.0843349097748085, 8.312330899288911, 7.609931260413251, 5.0372796983478425, 5.97346284303147, 5.881106552611905, 6.2480442966131875, 7.9416400428336, 4.926960794311193, 3.8740686009325653, 7.188632739211815, 6.671356977652909, 6.336426011485187, 7.655126705917452, 2.7097128294313184, 7.192790498748204, 6.956716195002351, 8.093932435851602, 7.422398653568783, 1.342791021489203, 8.499218027924883, 5.442165128748276, 7.148919088602245, 1.7692601747219934, 7.964269629261002, 1.3790578264939322, 6.07646984783759, 4.0302863600347, 8.168054515513175, 7.377292790976741, 6.2321251640589015, 6.462846295738564, 5.775965613859789, 4.424173196353389, 5.185610894378171, 3.2394001728673576, 5.530513243155447, 5.034897636264909, 4.129565613857846, 5.717459008923094, 7.176770517052605, 7.457568209336604, 4.868886487585461, 7.961570027993158, 6.189717190517052, 5.879442851638631, 6.1009162996293425, 6.441208758015688, 7.02394752027646, 9.906233601647113, 6.4570171948265775, 3.585165569109045, 7.4035827276616875, 6.769919655145247, 9.312052318194493, 6.536108813127177, 6.887732735161676, 10.980174015011036, 7.395093427787834, 5.099939628618016, 11.500692749325829, 8.523595802418573, 7.410272284365139, 7.784438609130094, 5.0036751201368315, 4.461787614407081, 8.839886503497993, 8.015974860891829, 5.404636333894967, 7.9019710379987025, 5.424364018566153, 7.24745639451928, 6.735293771295102, 3.5283784397584976], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.866239500223864, "mean_inference_ms": 8.042820707667406, "mean_action_processing_ms": 0.5401654258032021, "mean_env_wait_ms": 23.917713177133525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03560066223144531, "StateBufferConnector_ms": 0.05421161651611328, "ViewRequirementAgentConnector_ms": 0.9885056018829346}}, "episode_reward_max": 11.500692749325829, "episode_reward_min": 1.342791021489203, "episode_reward_mean": 6.418097981549553, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.02280098282938, 9.433545821247323, 6.341911943405399, 4.852647637984383, 9.433160042770393, 5.001411227318422, 1.684089317682689, 6.124775350436197, 6.657116343352868, 10.171999496718083, 6.171141196941503, 5.605196392057382, 8.276223607572762, 3.7515454984452816, 9.829839604774044, 7.4800770781087405, 5.156447974344685, 7.250689707241782, 7.984919465893799, 8.26234780417218, 8.642311615899008, 8.062278615630015, 4.835781464028989, 5.501732977715225, 5.857497357306507, 5.156244346447635, 5.0843349097748085, 8.312330899288911, 7.609931260413251, 5.0372796983478425, 5.97346284303147, 5.881106552611905, 6.2480442966131875, 7.9416400428336, 4.926960794311193, 3.8740686009325653, 7.188632739211815, 6.671356977652909, 6.336426011485187, 7.655126705917452, 2.7097128294313184, 7.192790498748204, 6.956716195002351, 8.093932435851602, 7.422398653568783, 1.342791021489203, 8.499218027924883, 5.442165128748276, 7.148919088602245, 1.7692601747219934, 7.964269629261002, 1.3790578264939322, 6.07646984783759, 4.0302863600347, 8.168054515513175, 7.377292790976741, 6.2321251640589015, 6.462846295738564, 5.775965613859789, 4.424173196353389, 5.185610894378171, 3.2394001728673576, 5.530513243155447, 5.034897636264909, 4.129565613857846, 5.717459008923094, 7.176770517052605, 7.457568209336604, 4.868886487585461, 7.961570027993158, 6.189717190517052, 5.879442851638631, 6.1009162996293425, 6.441208758015688, 7.02394752027646, 9.906233601647113, 6.4570171948265775, 3.585165569109045, 7.4035827276616875, 6.769919655145247, 9.312052318194493, 6.536108813127177, 6.887732735161676, 10.980174015011036, 7.395093427787834, 5.099939628618016, 11.500692749325829, 8.523595802418573, 7.410272284365139, 7.784438609130094, 5.0036751201368315, 4.461787614407081, 8.839886503497993, 8.015974860891829, 5.404636333894967, 7.9019710379987025, 5.424364018566153, 7.24745639451928, 6.735293771295102, 3.5283784397584976], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.866239500223864, "mean_inference_ms": 8.042820707667406, "mean_action_processing_ms": 0.5401654258032021, "mean_env_wait_ms": 23.917713177133525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03560066223144531, "StateBufferConnector_ms": 0.05421161651611328, "ViewRequirementAgentConnector_ms": 0.9885056018829346}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6788978, "num_agent_steps_trained": 6788978, "num_env_steps_sampled": 6788978, "num_env_steps_trained": 6788978, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.03136420175224, "num_env_steps_trained_throughput_per_sec": 285.03136420175224, "timesteps_total": 6788978, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6788978, "timers": {"training_iteration_time_ms": 54887.368, "sample_time_ms": 41842.791, "load_time_ms": 1730.248, "load_throughput": 9038.009, "learn_time_ms": 10744.74, "learn_throughput": 1455.41, "synch_weights_time_ms": 452.007}, "counters": {"num_env_steps_sampled": 6788978, "num_env_steps_trained": 6788978, "num_agent_steps_sampled": 6788978, "num_agent_steps_trained": 6788978}, "done": false, "episodes_total": 1274, "training_iteration": 439, "trial_id": "2f030_00000", "date": "2025-06-07_09-01-36", "timestamp": 1749279696, "time_this_iter_s": 54.88024163246155, "time_total_s": 5109.68109703064, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5109.68109703064, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 77.50952380952378, "ram_util_percent": 68.34126984126982, "gpu_util_percent0": 0.07809523809523808, "vram_util_percent0": 0.8592122395833336}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3.770189970253416, "episode_reward_min": -7.494966640059786, "episode_reward_mean": -5.892515806565155, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.3256053678578565, -5.836615568726771, -7.035201485927943, -7.494966640059786, -3.770189970253416], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.431179077725555, "mean_inference_ms": 3.93162360853144, "mean_action_processing_ms": 0.2804079492148362, "mean_env_wait_ms": 10.459940195886897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04017353057861328, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2817964553833008}}, "episode_reward_max": -3.770189970253416, "episode_reward_min": -7.494966640059786, "episode_reward_mean": -5.892515806565155, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.3256053678578565, -5.836615568726771, -7.035201485927943, -7.494966640059786, -3.770189970253416], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.431179077725555, "mean_inference_ms": 3.93162360853144, "mean_action_processing_ms": 0.2804079492148362, "mean_env_wait_ms": 10.459940195886897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04017353057861328, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2817964553833008}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.535017368421053e-05, "total_loss": -0.05592982949604365, "policy_loss": -0.013379486237165773, "vf_loss": 0.016204071234573018, "vf_explained_var": 0.7332156770879572, "kl": 0.015562610478653644, "entropy": 20.954437748302112, "entropy_coeff": 0.0027913325}, "model": {}, "num_grad_updates_lifetime": 50325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6804616, "num_env_steps_trained": 6804616, "num_agent_steps_sampled": 6804616, "num_agent_steps_trained": 6804616}, "sampler_results": {"episode_reward_max": 11.500692749325829, "episode_reward_min": 1.342791021489203, "episode_reward_mean": 6.414023692390898, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.829839604774044, 7.4800770781087405, 5.156447974344685, 7.250689707241782, 7.984919465893799, 8.26234780417218, 8.642311615899008, 8.062278615630015, 4.835781464028989, 5.501732977715225, 5.857497357306507, 5.156244346447635, 5.0843349097748085, 8.312330899288911, 7.609931260413251, 5.0372796983478425, 5.97346284303147, 5.881106552611905, 6.2480442966131875, 7.9416400428336, 4.926960794311193, 3.8740686009325653, 7.188632739211815, 6.671356977652909, 6.336426011485187, 7.655126705917452, 2.7097128294313184, 7.192790498748204, 6.956716195002351, 8.093932435851602, 7.422398653568783, 1.342791021489203, 8.499218027924883, 5.442165128748276, 7.148919088602245, 1.7692601747219934, 7.964269629261002, 1.3790578264939322, 6.07646984783759, 4.0302863600347, 8.168054515513175, 7.377292790976741, 6.2321251640589015, 6.462846295738564, 5.775965613859789, 4.424173196353389, 5.185610894378171, 3.2394001728673576, 5.530513243155447, 5.034897636264909, 4.129565613857846, 5.717459008923094, 7.176770517052605, 7.457568209336604, 4.868886487585461, 7.961570027993158, 6.189717190517052, 5.879442851638631, 6.1009162996293425, 6.441208758015688, 7.02394752027646, 9.906233601647113, 6.4570171948265775, 3.585165569109045, 7.4035827276616875, 6.769919655145247, 9.312052318194493, 6.536108813127177, 6.887732735161676, 10.980174015011036, 7.395093427787834, 5.099939628618016, 11.500692749325829, 8.523595802418573, 7.410272284365139, 7.784438609130094, 5.0036751201368315, 4.461787614407081, 8.839886503497993, 8.015974860891829, 5.404636333894967, 7.9019710379987025, 5.424364018566153, 7.24745639451928, 6.735293771295102, 3.5283784397584976, 3.966319911489409, 6.945393427355009, 3.6276210034855767, 7.06797611561838, 7.08555156845227, 7.691995686978927, 9.44495855328456, 4.820278626786902, 5.044142022409655, 7.287610080703558, 4.929428878513898, 4.373465944259664, 4.949657239314883, 10.885736884243945], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8647392366744797, "mean_inference_ms": 8.043765451828909, "mean_action_processing_ms": 0.5402189395186078, "mean_env_wait_ms": 23.92012222619636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03803443908691406, "StateBufferConnector_ms": 0.05802774429321289, "ViewRequirementAgentConnector_ms": 1.0023584365844727}}, "episode_reward_max": 11.500692749325829, "episode_reward_min": 1.342791021489203, "episode_reward_mean": 6.414023692390898, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.829839604774044, 7.4800770781087405, 5.156447974344685, 7.250689707241782, 7.984919465893799, 8.26234780417218, 8.642311615899008, 8.062278615630015, 4.835781464028989, 5.501732977715225, 5.857497357306507, 5.156244346447635, 5.0843349097748085, 8.312330899288911, 7.609931260413251, 5.0372796983478425, 5.97346284303147, 5.881106552611905, 6.2480442966131875, 7.9416400428336, 4.926960794311193, 3.8740686009325653, 7.188632739211815, 6.671356977652909, 6.336426011485187, 7.655126705917452, 2.7097128294313184, 7.192790498748204, 6.956716195002351, 8.093932435851602, 7.422398653568783, 1.342791021489203, 8.499218027924883, 5.442165128748276, 7.148919088602245, 1.7692601747219934, 7.964269629261002, 1.3790578264939322, 6.07646984783759, 4.0302863600347, 8.168054515513175, 7.377292790976741, 6.2321251640589015, 6.462846295738564, 5.775965613859789, 4.424173196353389, 5.185610894378171, 3.2394001728673576, 5.530513243155447, 5.034897636264909, 4.129565613857846, 5.717459008923094, 7.176770517052605, 7.457568209336604, 4.868886487585461, 7.961570027993158, 6.189717190517052, 5.879442851638631, 6.1009162996293425, 6.441208758015688, 7.02394752027646, 9.906233601647113, 6.4570171948265775, 3.585165569109045, 7.4035827276616875, 6.769919655145247, 9.312052318194493, 6.536108813127177, 6.887732735161676, 10.980174015011036, 7.395093427787834, 5.099939628618016, 11.500692749325829, 8.523595802418573, 7.410272284365139, 7.784438609130094, 5.0036751201368315, 4.461787614407081, 8.839886503497993, 8.015974860891829, 5.404636333894967, 7.9019710379987025, 5.424364018566153, 7.24745639451928, 6.735293771295102, 3.5283784397584976, 3.966319911489409, 6.945393427355009, 3.6276210034855767, 7.06797611561838, 7.08555156845227, 7.691995686978927, 9.44495855328456, 4.820278626786902, 5.044142022409655, 7.287610080703558, 4.929428878513898, 4.373465944259664, 4.949657239314883, 10.885736884243945], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8647392366744797, "mean_inference_ms": 8.043765451828909, "mean_action_processing_ms": 0.5402189395186078, "mean_env_wait_ms": 23.92012222619636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03803443908691406, "StateBufferConnector_ms": 0.05802774429321289, "ViewRequirementAgentConnector_ms": 1.0023584365844727}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6804616, "num_agent_steps_trained": 6804616, "num_env_steps_sampled": 6804616, "num_env_steps_trained": 6804616, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.46224549825905, "num_env_steps_trained_throughput_per_sec": 281.46224549825905, "timesteps_total": 6804616, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6804616, "timers": {"training_iteration_time_ms": 54951.571, "sample_time_ms": 41883.286, "load_time_ms": 1732.725, "load_throughput": 9025.089, "learn_time_ms": 10764.928, "learn_throughput": 1452.68, "synch_weights_time_ms": 453.752}, "counters": {"num_env_steps_sampled": 6804616, "num_env_steps_trained": 6804616, "num_agent_steps_sampled": 6804616, "num_agent_steps_trained": 6804616}, "done": false, "episodes_total": 1288, "training_iteration": 440, "trial_id": "2f030_00000", "date": "2025-06-07_09-02-46", "timestamp": 1749279766, "time_this_iter_s": 70.38639807701111, "time_total_s": 5180.067495107651, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5180.067495107651, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 64.99756097560976, "ram_util_percent": 67.4951219512195, "gpu_util_percent0": 0.061707317073170724, "vram_util_percent0": 0.8592122395833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.522671578947369e-05, "total_loss": -0.06685740802437067, "policy_loss": -0.02426326338699172, "vf_loss": 0.014948470745743675, "vf_explained_var": 0.7312782858718525, "kl": 0.014140271331538862, "entropy": 20.911755088459362, "entropy_coeff": 0.00273269}, "model": {}, "num_grad_updates_lifetime": 50875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6820254, "num_env_steps_trained": 6820254, "num_agent_steps_sampled": 6820254, "num_agent_steps_trained": 6820254}, "sampler_results": {"episode_reward_max": 11.500692749325829, "episode_reward_min": 1.342791021489203, "episode_reward_mean": 6.266910289867335, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.609931260413251, 5.0372796983478425, 5.97346284303147, 5.881106552611905, 6.2480442966131875, 7.9416400428336, 4.926960794311193, 3.8740686009325653, 7.188632739211815, 6.671356977652909, 6.336426011485187, 7.655126705917452, 2.7097128294313184, 7.192790498748204, 6.956716195002351, 8.093932435851602, 7.422398653568783, 1.342791021489203, 8.499218027924883, 5.442165128748276, 7.148919088602245, 1.7692601747219934, 7.964269629261002, 1.3790578264939322, 6.07646984783759, 4.0302863600347, 8.168054515513175, 7.377292790976741, 6.2321251640589015, 6.462846295738564, 5.775965613859789, 4.424173196353389, 5.185610894378171, 3.2394001728673576, 5.530513243155447, 5.034897636264909, 4.129565613857846, 5.717459008923094, 7.176770517052605, 7.457568209336604, 4.868886487585461, 7.961570027993158, 6.189717190517052, 5.879442851638631, 6.1009162996293425, 6.441208758015688, 7.02394752027646, 9.906233601647113, 6.4570171948265775, 3.585165569109045, 7.4035827276616875, 6.769919655145247, 9.312052318194493, 6.536108813127177, 6.887732735161676, 10.980174015011036, 7.395093427787834, 5.099939628618016, 11.500692749325829, 8.523595802418573, 7.410272284365139, 7.784438609130094, 5.0036751201368315, 4.461787614407081, 8.839886503497993, 8.015974860891829, 5.404636333894967, 7.9019710379987025, 5.424364018566153, 7.24745639451928, 6.735293771295102, 3.5283784397584976, 3.966319911489409, 6.945393427355009, 3.6276210034855767, 7.06797611561838, 7.08555156845227, 7.691995686978927, 9.44495855328456, 4.820278626786902, 5.044142022409655, 7.287610080703558, 4.929428878513898, 4.373465944259664, 4.949657239314883, 10.885736884243945, 6.738042248714324, 6.643866460570137, 3.2557846357254525, 3.730708757500138, 5.157030942362006, 4.634322779002721, 5.080892163217211, 8.692738477265491, 9.177193356243903, 3.86553922792714, 9.613964772886524, 6.432060401983939, 7.650985329699845, 2.032364015171181], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8630785259230396, "mean_inference_ms": 8.044786285606914, "mean_action_processing_ms": 0.540234356964067, "mean_env_wait_ms": 23.922059900050286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04105377197265625, "StateBufferConnector_ms": 0.03409433364868164, "ViewRequirementAgentConnector_ms": 1.0113675594329834}}, "episode_reward_max": 11.500692749325829, "episode_reward_min": 1.342791021489203, "episode_reward_mean": 6.266910289867335, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.609931260413251, 5.0372796983478425, 5.97346284303147, 5.881106552611905, 6.2480442966131875, 7.9416400428336, 4.926960794311193, 3.8740686009325653, 7.188632739211815, 6.671356977652909, 6.336426011485187, 7.655126705917452, 2.7097128294313184, 7.192790498748204, 6.956716195002351, 8.093932435851602, 7.422398653568783, 1.342791021489203, 8.499218027924883, 5.442165128748276, 7.148919088602245, 1.7692601747219934, 7.964269629261002, 1.3790578264939322, 6.07646984783759, 4.0302863600347, 8.168054515513175, 7.377292790976741, 6.2321251640589015, 6.462846295738564, 5.775965613859789, 4.424173196353389, 5.185610894378171, 3.2394001728673576, 5.530513243155447, 5.034897636264909, 4.129565613857846, 5.717459008923094, 7.176770517052605, 7.457568209336604, 4.868886487585461, 7.961570027993158, 6.189717190517052, 5.879442851638631, 6.1009162996293425, 6.441208758015688, 7.02394752027646, 9.906233601647113, 6.4570171948265775, 3.585165569109045, 7.4035827276616875, 6.769919655145247, 9.312052318194493, 6.536108813127177, 6.887732735161676, 10.980174015011036, 7.395093427787834, 5.099939628618016, 11.500692749325829, 8.523595802418573, 7.410272284365139, 7.784438609130094, 5.0036751201368315, 4.461787614407081, 8.839886503497993, 8.015974860891829, 5.404636333894967, 7.9019710379987025, 5.424364018566153, 7.24745639451928, 6.735293771295102, 3.5283784397584976, 3.966319911489409, 6.945393427355009, 3.6276210034855767, 7.06797611561838, 7.08555156845227, 7.691995686978927, 9.44495855328456, 4.820278626786902, 5.044142022409655, 7.287610080703558, 4.929428878513898, 4.373465944259664, 4.949657239314883, 10.885736884243945, 6.738042248714324, 6.643866460570137, 3.2557846357254525, 3.730708757500138, 5.157030942362006, 4.634322779002721, 5.080892163217211, 8.692738477265491, 9.177193356243903, 3.86553922792714, 9.613964772886524, 6.432060401983939, 7.650985329699845, 2.032364015171181], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8630785259230396, "mean_inference_ms": 8.044786285606914, "mean_action_processing_ms": 0.540234356964067, "mean_env_wait_ms": 23.922059900050286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04105377197265625, "StateBufferConnector_ms": 0.03409433364868164, "ViewRequirementAgentConnector_ms": 1.0113675594329834}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6820254, "num_agent_steps_trained": 6820254, "num_env_steps_sampled": 6820254, "num_env_steps_trained": 6820254, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 287.47270801620664, "num_env_steps_trained_throughput_per_sec": 287.47270801620664, "timesteps_total": 6820254, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6820254, "timers": {"training_iteration_time_ms": 54899.687, "sample_time_ms": 41833.515, "load_time_ms": 1728.726, "load_throughput": 9045.966, "learn_time_ms": 10765.461, "learn_throughput": 1452.608, "synch_weights_time_ms": 461.875}, "counters": {"num_env_steps_sampled": 6820254, "num_env_steps_trained": 6820254, "num_agent_steps_sampled": 6820254, "num_agent_steps_trained": 6820254}, "done": false, "episodes_total": 1302, "training_iteration": 441, "trial_id": "2f030_00000", "date": "2025-06-07_09-03-41", "timestamp": 1749279821, "time_this_iter_s": 54.413859128952026, "time_total_s": 5234.481354236603, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5234.481354236603, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 77.10952380952382, "ram_util_percent": 68.16031746031746, "gpu_util_percent0": 0.07650793650793651, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.510325789473684e-05, "total_loss": -0.06656176248649982, "policy_loss": -0.02473513200730932, "vf_loss": 0.013739474540237676, "vf_explained_var": 0.7775464726578105, "kl": 0.014165137682946145, "entropy": 20.9543141486428, "entropy_coeff": 0.0026740474999999994}, "model": {}, "num_grad_updates_lifetime": 51425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6835892, "num_env_steps_trained": 6835892, "num_agent_steps_sampled": 6835892, "num_agent_steps_trained": 6835892}, "sampler_results": {"episode_reward_max": 11.500692749325829, "episode_reward_min": 1.342791021489203, "episode_reward_mean": 6.24743450173085, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.956716195002351, 8.093932435851602, 7.422398653568783, 1.342791021489203, 8.499218027924883, 5.442165128748276, 7.148919088602245, 1.7692601747219934, 7.964269629261002, 1.3790578264939322, 6.07646984783759, 4.0302863600347, 8.168054515513175, 7.377292790976741, 6.2321251640589015, 6.462846295738564, 5.775965613859789, 4.424173196353389, 5.185610894378171, 3.2394001728673576, 5.530513243155447, 5.034897636264909, 4.129565613857846, 5.717459008923094, 7.176770517052605, 7.457568209336604, 4.868886487585461, 7.961570027993158, 6.189717190517052, 5.879442851638631, 6.1009162996293425, 6.441208758015688, 7.02394752027646, 9.906233601647113, 6.4570171948265775, 3.585165569109045, 7.4035827276616875, 6.769919655145247, 9.312052318194493, 6.536108813127177, 6.887732735161676, 10.980174015011036, 7.395093427787834, 5.099939628618016, 11.500692749325829, 8.523595802418573, 7.410272284365139, 7.784438609130094, 5.0036751201368315, 4.461787614407081, 8.839886503497993, 8.015974860891829, 5.404636333894967, 7.9019710379987025, 5.424364018566153, 7.24745639451928, 6.735293771295102, 3.5283784397584976, 3.966319911489409, 6.945393427355009, 3.6276210034855767, 7.06797611561838, 7.08555156845227, 7.691995686978927, 9.44495855328456, 4.820278626786902, 5.044142022409655, 7.287610080703558, 4.929428878513898, 4.373465944259664, 4.949657239314883, 10.885736884243945, 6.738042248714324, 6.643866460570137, 3.2557846357254525, 3.730708757500138, 5.157030942362006, 4.634322779002721, 5.080892163217211, 8.692738477265491, 9.177193356243903, 3.86553922792714, 9.613964772886524, 6.432060401983939, 7.650985329699845, 2.032364015171181, 8.058509490363141, 7.659749675896019, 7.136252347797597, 6.975189269032699, 5.742397860898623, 1.563066129789221, 8.711172819600586, 2.584753548096632, 2.958295990451879, 5.82985843595725, 6.180200730755636, 5.01570625228814, 6.027275555666724, 8.85653293129929], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8614445739711023, "mean_inference_ms": 8.04571142363295, "mean_action_processing_ms": 0.5402802328339319, "mean_env_wait_ms": 23.923944451540923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03804326057434082, "StateBufferConnector_ms": 0.032822370529174805, "ViewRequirementAgentConnector_ms": 1.0113472938537598}}, "episode_reward_max": 11.500692749325829, "episode_reward_min": 1.342791021489203, "episode_reward_mean": 6.24743450173085, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.956716195002351, 8.093932435851602, 7.422398653568783, 1.342791021489203, 8.499218027924883, 5.442165128748276, 7.148919088602245, 1.7692601747219934, 7.964269629261002, 1.3790578264939322, 6.07646984783759, 4.0302863600347, 8.168054515513175, 7.377292790976741, 6.2321251640589015, 6.462846295738564, 5.775965613859789, 4.424173196353389, 5.185610894378171, 3.2394001728673576, 5.530513243155447, 5.034897636264909, 4.129565613857846, 5.717459008923094, 7.176770517052605, 7.457568209336604, 4.868886487585461, 7.961570027993158, 6.189717190517052, 5.879442851638631, 6.1009162996293425, 6.441208758015688, 7.02394752027646, 9.906233601647113, 6.4570171948265775, 3.585165569109045, 7.4035827276616875, 6.769919655145247, 9.312052318194493, 6.536108813127177, 6.887732735161676, 10.980174015011036, 7.395093427787834, 5.099939628618016, 11.500692749325829, 8.523595802418573, 7.410272284365139, 7.784438609130094, 5.0036751201368315, 4.461787614407081, 8.839886503497993, 8.015974860891829, 5.404636333894967, 7.9019710379987025, 5.424364018566153, 7.24745639451928, 6.735293771295102, 3.5283784397584976, 3.966319911489409, 6.945393427355009, 3.6276210034855767, 7.06797611561838, 7.08555156845227, 7.691995686978927, 9.44495855328456, 4.820278626786902, 5.044142022409655, 7.287610080703558, 4.929428878513898, 4.373465944259664, 4.949657239314883, 10.885736884243945, 6.738042248714324, 6.643866460570137, 3.2557846357254525, 3.730708757500138, 5.157030942362006, 4.634322779002721, 5.080892163217211, 8.692738477265491, 9.177193356243903, 3.86553922792714, 9.613964772886524, 6.432060401983939, 7.650985329699845, 2.032364015171181, 8.058509490363141, 7.659749675896019, 7.136252347797597, 6.975189269032699, 5.742397860898623, 1.563066129789221, 8.711172819600586, 2.584753548096632, 2.958295990451879, 5.82985843595725, 6.180200730755636, 5.01570625228814, 6.027275555666724, 8.85653293129929], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8614445739711023, "mean_inference_ms": 8.04571142363295, "mean_action_processing_ms": 0.5402802328339319, "mean_env_wait_ms": 23.923944451540923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03804326057434082, "StateBufferConnector_ms": 0.032822370529174805, "ViewRequirementAgentConnector_ms": 1.0113472938537598}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6835892, "num_agent_steps_trained": 6835892, "num_env_steps_sampled": 6835892, "num_env_steps_trained": 6835892, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.31294284186214, "num_env_steps_trained_throughput_per_sec": 285.31294284186214, "timesteps_total": 6835892, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6835892, "timers": {"training_iteration_time_ms": 54899.917, "sample_time_ms": 41829.987, "load_time_ms": 1726.732, "load_throughput": 9056.414, "learn_time_ms": 10773.309, "learn_throughput": 1451.55, "synch_weights_time_ms": 458.678}, "counters": {"num_env_steps_sampled": 6835892, "num_env_steps_trained": 6835892, "num_agent_steps_sampled": 6835892, "num_agent_steps_trained": 6835892}, "done": false, "episodes_total": 1316, "training_iteration": 442, "trial_id": "2f030_00000", "date": "2025-06-07_09-04-36", "timestamp": 1749279876, "time_this_iter_s": 54.82583284378052, "time_total_s": 5289.307187080383, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5289.307187080383, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 77.55555555555557, "ram_util_percent": 68.53492063492067, "gpu_util_percent0": 0.07301587301587302, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.49798e-05, "total_loss": -0.06687326390507885, "policy_loss": -0.026482947911347518, "vf_loss": 0.01454546944661574, "vf_explained_var": 0.7387330968813463, "kl": 0.014381902363980088, "entropy": 21.026431522369386, "entropy_coeff": 0.0026154050000000003}, "model": {}, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6851530, "num_env_steps_trained": 6851530, "num_agent_steps_sampled": 6851530, "num_agent_steps_trained": 6851530}, "sampler_results": {"episode_reward_max": 11.500692749325829, "episode_reward_min": 1.563066129789221, "episode_reward_mean": 6.23846825243114, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.2321251640589015, 6.462846295738564, 5.775965613859789, 4.424173196353389, 5.185610894378171, 3.2394001728673576, 5.530513243155447, 5.034897636264909, 4.129565613857846, 5.717459008923094, 7.176770517052605, 7.457568209336604, 4.868886487585461, 7.961570027993158, 6.189717190517052, 5.879442851638631, 6.1009162996293425, 6.441208758015688, 7.02394752027646, 9.906233601647113, 6.4570171948265775, 3.585165569109045, 7.4035827276616875, 6.769919655145247, 9.312052318194493, 6.536108813127177, 6.887732735161676, 10.980174015011036, 7.395093427787834, 5.099939628618016, 11.500692749325829, 8.523595802418573, 7.410272284365139, 7.784438609130094, 5.0036751201368315, 4.461787614407081, 8.839886503497993, 8.015974860891829, 5.404636333894967, 7.9019710379987025, 5.424364018566153, 7.24745639451928, 6.735293771295102, 3.5283784397584976, 3.966319911489409, 6.945393427355009, 3.6276210034855767, 7.06797611561838, 7.08555156845227, 7.691995686978927, 9.44495855328456, 4.820278626786902, 5.044142022409655, 7.287610080703558, 4.929428878513898, 4.373465944259664, 4.949657239314883, 10.885736884243945, 6.738042248714324, 6.643866460570137, 3.2557846357254525, 3.730708757500138, 5.157030942362006, 4.634322779002721, 5.080892163217211, 8.692738477265491, 9.177193356243903, 3.86553922792714, 9.613964772886524, 6.432060401983939, 7.650985329699845, 2.032364015171181, 8.058509490363141, 7.659749675896019, 7.136252347797597, 6.975189269032699, 5.742397860898623, 1.563066129789221, 8.711172819600586, 2.584753548096632, 2.958295990451879, 5.82985843595725, 6.180200730755636, 5.01570625228814, 6.027275555666724, 8.85653293129929, 4.1242518032112905, 8.976921253768504, 6.349882747732656, 3.960582586262584, 2.290229913371035, 7.729103671535367, 6.891332345807513, 9.37147157136991, 5.2891666851599535, 5.761954074872024, 4.077062944035082, 2.600878448492959, 6.1419597831108605, 7.209408937325736], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.860105783051136, "mean_inference_ms": 8.046904861869086, "mean_action_processing_ms": 0.5403105702412853, "mean_env_wait_ms": 23.92599168112529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05063128471374512, "StateBufferConnector_ms": 0.0298306941986084, "ViewRequirementAgentConnector_ms": 0.9977693557739258}}, "episode_reward_max": 11.500692749325829, "episode_reward_min": 1.563066129789221, "episode_reward_mean": 6.23846825243114, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.2321251640589015, 6.462846295738564, 5.775965613859789, 4.424173196353389, 5.185610894378171, 3.2394001728673576, 5.530513243155447, 5.034897636264909, 4.129565613857846, 5.717459008923094, 7.176770517052605, 7.457568209336604, 4.868886487585461, 7.961570027993158, 6.189717190517052, 5.879442851638631, 6.1009162996293425, 6.441208758015688, 7.02394752027646, 9.906233601647113, 6.4570171948265775, 3.585165569109045, 7.4035827276616875, 6.769919655145247, 9.312052318194493, 6.536108813127177, 6.887732735161676, 10.980174015011036, 7.395093427787834, 5.099939628618016, 11.500692749325829, 8.523595802418573, 7.410272284365139, 7.784438609130094, 5.0036751201368315, 4.461787614407081, 8.839886503497993, 8.015974860891829, 5.404636333894967, 7.9019710379987025, 5.424364018566153, 7.24745639451928, 6.735293771295102, 3.5283784397584976, 3.966319911489409, 6.945393427355009, 3.6276210034855767, 7.06797611561838, 7.08555156845227, 7.691995686978927, 9.44495855328456, 4.820278626786902, 5.044142022409655, 7.287610080703558, 4.929428878513898, 4.373465944259664, 4.949657239314883, 10.885736884243945, 6.738042248714324, 6.643866460570137, 3.2557846357254525, 3.730708757500138, 5.157030942362006, 4.634322779002721, 5.080892163217211, 8.692738477265491, 9.177193356243903, 3.86553922792714, 9.613964772886524, 6.432060401983939, 7.650985329699845, 2.032364015171181, 8.058509490363141, 7.659749675896019, 7.136252347797597, 6.975189269032699, 5.742397860898623, 1.563066129789221, 8.711172819600586, 2.584753548096632, 2.958295990451879, 5.82985843595725, 6.180200730755636, 5.01570625228814, 6.027275555666724, 8.85653293129929, 4.1242518032112905, 8.976921253768504, 6.349882747732656, 3.960582586262584, 2.290229913371035, 7.729103671535367, 6.891332345807513, 9.37147157136991, 5.2891666851599535, 5.761954074872024, 4.077062944035082, 2.600878448492959, 6.1419597831108605, 7.209408937325736], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.860105783051136, "mean_inference_ms": 8.046904861869086, "mean_action_processing_ms": 0.5403105702412853, "mean_env_wait_ms": 23.92599168112529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05063128471374512, "StateBufferConnector_ms": 0.0298306941986084, "ViewRequirementAgentConnector_ms": 0.9977693557739258}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6851530, "num_agent_steps_trained": 6851530, "num_env_steps_sampled": 6851530, "num_env_steps_trained": 6851530, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.2480284630245, "num_env_steps_trained_throughput_per_sec": 280.2480284630245, "timesteps_total": 6851530, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6851530, "timers": {"training_iteration_time_ms": 54992.623, "sample_time_ms": 41922.854, "load_time_ms": 1720.863, "load_throughput": 9087.303, "learn_time_ms": 10775.705, "learn_throughput": 1451.228, "synch_weights_time_ms": 460.576}, "counters": {"num_env_steps_sampled": 6851530, "num_env_steps_trained": 6851530, "num_agent_steps_sampled": 6851530, "num_agent_steps_trained": 6851530}, "done": false, "episodes_total": 1330, "training_iteration": 443, "trial_id": "2f030_00000", "date": "2025-06-07_09-05-32", "timestamp": 1749279932, "time_this_iter_s": 55.82005548477173, "time_total_s": 5345.127242565155, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5345.127242565155, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 77.88095238095237, "ram_util_percent": 68.36349206349206, "gpu_util_percent0": 0.08111111111111112, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.485634210526315e-05, "total_loss": -0.07448825210629201, "policy_loss": -0.03479931574171959, "vf_loss": 0.01443592032163658, "vf_explained_var": 0.7253382890874689, "kl": 0.013898281062843165, "entropy": 21.086860982721504, "entropy_coeff": 0.0025567625}, "model": {}, "num_grad_updates_lifetime": 52525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6867168, "num_env_steps_trained": 6867168, "num_agent_steps_sampled": 6867168, "num_agent_steps_trained": 6867168}, "sampler_results": {"episode_reward_max": 11.500692749325829, "episode_reward_min": 0.48043844431604626, "episode_reward_mean": 6.087769572782744, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.189717190517052, 5.879442851638631, 6.1009162996293425, 6.441208758015688, 7.02394752027646, 9.906233601647113, 6.4570171948265775, 3.585165569109045, 7.4035827276616875, 6.769919655145247, 9.312052318194493, 6.536108813127177, 6.887732735161676, 10.980174015011036, 7.395093427787834, 5.099939628618016, 11.500692749325829, 8.523595802418573, 7.410272284365139, 7.784438609130094, 5.0036751201368315, 4.461787614407081, 8.839886503497993, 8.015974860891829, 5.404636333894967, 7.9019710379987025, 5.424364018566153, 7.24745639451928, 6.735293771295102, 3.5283784397584976, 3.966319911489409, 6.945393427355009, 3.6276210034855767, 7.06797611561838, 7.08555156845227, 7.691995686978927, 9.44495855328456, 4.820278626786902, 5.044142022409655, 7.287610080703558, 4.929428878513898, 4.373465944259664, 4.949657239314883, 10.885736884243945, 6.738042248714324, 6.643866460570137, 3.2557846357254525, 3.730708757500138, 5.157030942362006, 4.634322779002721, 5.080892163217211, 8.692738477265491, 9.177193356243903, 3.86553922792714, 9.613964772886524, 6.432060401983939, 7.650985329699845, 2.032364015171181, 8.058509490363141, 7.659749675896019, 7.136252347797597, 6.975189269032699, 5.742397860898623, 1.563066129789221, 8.711172819600586, 2.584753548096632, 2.958295990451879, 5.82985843595725, 6.180200730755636, 5.01570625228814, 6.027275555666724, 8.85653293129929, 4.1242518032112905, 8.976921253768504, 6.349882747732656, 3.960582586262584, 2.290229913371035, 7.729103671535367, 6.891332345807513, 9.37147157136991, 5.2891666851599535, 5.761954074872024, 4.077062944035082, 2.600878448492959, 6.1419597831108605, 7.209408937325736, 1.1353376356338698, 7.443028306519013, 4.054961325497869, 2.0288410253304328, 0.48043844431604626, 2.5963913806045493, 3.0518778728063247, 9.302327299519972, 5.882863424873584, 4.626742302603791, 4.610608093930531, 5.4885444402066135, 5.6707320308660805, 7.754790533876863], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.858794362017349, "mean_inference_ms": 8.048201847009345, "mean_action_processing_ms": 0.5403517989971567, "mean_env_wait_ms": 23.927904483114336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04563617706298828, "StateBufferConnector_ms": 0.030771255493164062, "ViewRequirementAgentConnector_ms": 1.0243251323699951}}, "episode_reward_max": 11.500692749325829, "episode_reward_min": 0.48043844431604626, "episode_reward_mean": 6.087769572782744, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.189717190517052, 5.879442851638631, 6.1009162996293425, 6.441208758015688, 7.02394752027646, 9.906233601647113, 6.4570171948265775, 3.585165569109045, 7.4035827276616875, 6.769919655145247, 9.312052318194493, 6.536108813127177, 6.887732735161676, 10.980174015011036, 7.395093427787834, 5.099939628618016, 11.500692749325829, 8.523595802418573, 7.410272284365139, 7.784438609130094, 5.0036751201368315, 4.461787614407081, 8.839886503497993, 8.015974860891829, 5.404636333894967, 7.9019710379987025, 5.424364018566153, 7.24745639451928, 6.735293771295102, 3.5283784397584976, 3.966319911489409, 6.945393427355009, 3.6276210034855767, 7.06797611561838, 7.08555156845227, 7.691995686978927, 9.44495855328456, 4.820278626786902, 5.044142022409655, 7.287610080703558, 4.929428878513898, 4.373465944259664, 4.949657239314883, 10.885736884243945, 6.738042248714324, 6.643866460570137, 3.2557846357254525, 3.730708757500138, 5.157030942362006, 4.634322779002721, 5.080892163217211, 8.692738477265491, 9.177193356243903, 3.86553922792714, 9.613964772886524, 6.432060401983939, 7.650985329699845, 2.032364015171181, 8.058509490363141, 7.659749675896019, 7.136252347797597, 6.975189269032699, 5.742397860898623, 1.563066129789221, 8.711172819600586, 2.584753548096632, 2.958295990451879, 5.82985843595725, 6.180200730755636, 5.01570625228814, 6.027275555666724, 8.85653293129929, 4.1242518032112905, 8.976921253768504, 6.349882747732656, 3.960582586262584, 2.290229913371035, 7.729103671535367, 6.891332345807513, 9.37147157136991, 5.2891666851599535, 5.761954074872024, 4.077062944035082, 2.600878448492959, 6.1419597831108605, 7.209408937325736, 1.1353376356338698, 7.443028306519013, 4.054961325497869, 2.0288410253304328, 0.48043844431604626, 2.5963913806045493, 3.0518778728063247, 9.302327299519972, 5.882863424873584, 4.626742302603791, 4.610608093930531, 5.4885444402066135, 5.6707320308660805, 7.754790533876863], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.858794362017349, "mean_inference_ms": 8.048201847009345, "mean_action_processing_ms": 0.5403517989971567, "mean_env_wait_ms": 23.927904483114336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04563617706298828, "StateBufferConnector_ms": 0.030771255493164062, "ViewRequirementAgentConnector_ms": 1.0243251323699951}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6867168, "num_agent_steps_trained": 6867168, "num_env_steps_sampled": 6867168, "num_env_steps_trained": 6867168, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 287.24475794673066, "num_env_steps_trained_throughput_per_sec": 287.24475794673066, "timesteps_total": 6867168, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6867168, "timers": {"training_iteration_time_ms": 54943.775, "sample_time_ms": 41888.188, "load_time_ms": 1718.725, "load_throughput": 9098.607, "learn_time_ms": 10768.519, "learn_throughput": 1452.196, "synch_weights_time_ms": 458.574}, "counters": {"num_env_steps_sampled": 6867168, "num_env_steps_trained": 6867168, "num_agent_steps_sampled": 6867168, "num_agent_steps_trained": 6867168}, "done": false, "episodes_total": 1344, "training_iteration": 444, "trial_id": "2f030_00000", "date": "2025-06-07_09-06-26", "timestamp": 1749279986, "time_this_iter_s": 54.45799970626831, "time_total_s": 5399.585242271423, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5399.585242271423, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 78.00161290322579, "ram_util_percent": 68.4483870967742, "gpu_util_percent0": 0.07451612903225807, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.4732884210526315e-05, "total_loss": -0.05872981442180886, "policy_loss": -0.02132318010061598, "vf_loss": 0.01442621509121223, "vf_explained_var": 0.716888178695332, "kl": 0.014915033594442139, "entropy": 20.956846956773237, "entropy_coeff": 0.0024981199999999995}, "model": {}, "num_grad_updates_lifetime": 53075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6882806, "num_env_steps_trained": 6882806, "num_agent_steps_sampled": 6882806, "num_agent_steps_trained": 6882806}, "sampler_results": {"episode_reward_max": 11.500692749325829, "episode_reward_min": 0.48043844431604626, "episode_reward_mean": 5.886423614333888, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.395093427787834, 5.099939628618016, 11.500692749325829, 8.523595802418573, 7.410272284365139, 7.784438609130094, 5.0036751201368315, 4.461787614407081, 8.839886503497993, 8.015974860891829, 5.404636333894967, 7.9019710379987025, 5.424364018566153, 7.24745639451928, 6.735293771295102, 3.5283784397584976, 3.966319911489409, 6.945393427355009, 3.6276210034855767, 7.06797611561838, 7.08555156845227, 7.691995686978927, 9.44495855328456, 4.820278626786902, 5.044142022409655, 7.287610080703558, 4.929428878513898, 4.373465944259664, 4.949657239314883, 10.885736884243945, 6.738042248714324, 6.643866460570137, 3.2557846357254525, 3.730708757500138, 5.157030942362006, 4.634322779002721, 5.080892163217211, 8.692738477265491, 9.177193356243903, 3.86553922792714, 9.613964772886524, 6.432060401983939, 7.650985329699845, 2.032364015171181, 8.058509490363141, 7.659749675896019, 7.136252347797597, 6.975189269032699, 5.742397860898623, 1.563066129789221, 8.711172819600586, 2.584753548096632, 2.958295990451879, 5.82985843595725, 6.180200730755636, 5.01570625228814, 6.027275555666724, 8.85653293129929, 4.1242518032112905, 8.976921253768504, 6.349882747732656, 3.960582586262584, 2.290229913371035, 7.729103671535367, 6.891332345807513, 9.37147157136991, 5.2891666851599535, 5.761954074872024, 4.077062944035082, 2.600878448492959, 6.1419597831108605, 7.209408937325736, 1.1353376356338698, 7.443028306519013, 4.054961325497869, 2.0288410253304328, 0.48043844431604626, 2.5963913806045493, 3.0518778728063247, 9.302327299519972, 5.882863424873584, 4.626742302603791, 4.610608093930531, 5.4885444402066135, 5.6707320308660805, 7.754790533876863, 3.096210664932628, 6.049313478405898, 6.893332105565721, 5.9643892104984015, 9.877309924046825, 6.5608728123050835, 7.357699217622776, 3.0845207268397385, 9.045062190060781, 5.202010193862204, 6.105613695266826, 2.983049076440846, 5.40835583804015, 1.7108842711880186], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8575523638175917, "mean_inference_ms": 8.049402446575199, "mean_action_processing_ms": 0.5404186393870061, "mean_env_wait_ms": 23.929710209963645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049700021743774414, "StateBufferConnector_ms": 0.024788856506347656, "ViewRequirementAgentConnector_ms": 1.0044283866882324}}, "episode_reward_max": 11.500692749325829, "episode_reward_min": 0.48043844431604626, "episode_reward_mean": 5.886423614333888, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.395093427787834, 5.099939628618016, 11.500692749325829, 8.523595802418573, 7.410272284365139, 7.784438609130094, 5.0036751201368315, 4.461787614407081, 8.839886503497993, 8.015974860891829, 5.404636333894967, 7.9019710379987025, 5.424364018566153, 7.24745639451928, 6.735293771295102, 3.5283784397584976, 3.966319911489409, 6.945393427355009, 3.6276210034855767, 7.06797611561838, 7.08555156845227, 7.691995686978927, 9.44495855328456, 4.820278626786902, 5.044142022409655, 7.287610080703558, 4.929428878513898, 4.373465944259664, 4.949657239314883, 10.885736884243945, 6.738042248714324, 6.643866460570137, 3.2557846357254525, 3.730708757500138, 5.157030942362006, 4.634322779002721, 5.080892163217211, 8.692738477265491, 9.177193356243903, 3.86553922792714, 9.613964772886524, 6.432060401983939, 7.650985329699845, 2.032364015171181, 8.058509490363141, 7.659749675896019, 7.136252347797597, 6.975189269032699, 5.742397860898623, 1.563066129789221, 8.711172819600586, 2.584753548096632, 2.958295990451879, 5.82985843595725, 6.180200730755636, 5.01570625228814, 6.027275555666724, 8.85653293129929, 4.1242518032112905, 8.976921253768504, 6.349882747732656, 3.960582586262584, 2.290229913371035, 7.729103671535367, 6.891332345807513, 9.37147157136991, 5.2891666851599535, 5.761954074872024, 4.077062944035082, 2.600878448492959, 6.1419597831108605, 7.209408937325736, 1.1353376356338698, 7.443028306519013, 4.054961325497869, 2.0288410253304328, 0.48043844431604626, 2.5963913806045493, 3.0518778728063247, 9.302327299519972, 5.882863424873584, 4.626742302603791, 4.610608093930531, 5.4885444402066135, 5.6707320308660805, 7.754790533876863, 3.096210664932628, 6.049313478405898, 6.893332105565721, 5.9643892104984015, 9.877309924046825, 6.5608728123050835, 7.357699217622776, 3.0845207268397385, 9.045062190060781, 5.202010193862204, 6.105613695266826, 2.983049076440846, 5.40835583804015, 1.7108842711880186], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8575523638175917, "mean_inference_ms": 8.049402446575199, "mean_action_processing_ms": 0.5404186393870061, "mean_env_wait_ms": 23.929710209963645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049700021743774414, "StateBufferConnector_ms": 0.024788856506347656, "ViewRequirementAgentConnector_ms": 1.0044283866882324}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6882806, "num_agent_steps_trained": 6882806, "num_env_steps_sampled": 6882806, "num_env_steps_trained": 6882806, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.9876544372822, "num_env_steps_trained_throughput_per_sec": 284.9876544372822, "timesteps_total": 6882806, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6882806, "timers": {"training_iteration_time_ms": 54962.34, "sample_time_ms": 41867.109, "load_time_ms": 1721.097, "load_throughput": 9086.066, "learn_time_ms": 10801.205, "learn_throughput": 1447.801, "synch_weights_time_ms": 462.759}, "counters": {"num_env_steps_sampled": 6882806, "num_env_steps_trained": 6882806, "num_agent_steps_sampled": 6882806, "num_agent_steps_trained": 6882806}, "done": false, "episodes_total": 1358, "training_iteration": 445, "trial_id": "2f030_00000", "date": "2025-06-07_09-07-21", "timestamp": 1749280041, "time_this_iter_s": 54.90127444267273, "time_total_s": 5454.486516714096, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5454.486516714096, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 76.62380952380951, "ram_util_percent": 68.8095238095238, "gpu_util_percent0": 0.07952380952380954, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.4609426315789466e-05, "total_loss": -0.06039642044935714, "policy_loss": -0.0241815161834926, "vf_loss": 0.014923542588102547, "vf_explained_var": 0.7377188729156148, "kl": 0.014623107944858944, "entropy": 20.948076967759565, "entropy_coeff": 0.0024394775}, "model": {}, "num_grad_updates_lifetime": 53625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6898444, "num_env_steps_trained": 6898444, "num_agent_steps_sampled": 6898444, "num_agent_steps_trained": 6898444}, "sampler_results": {"episode_reward_max": 10.933572327122992, "episode_reward_min": 0.48043844431604626, "episode_reward_mean": 5.898003369856069, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.735293771295102, 3.5283784397584976, 3.966319911489409, 6.945393427355009, 3.6276210034855767, 7.06797611561838, 7.08555156845227, 7.691995686978927, 9.44495855328456, 4.820278626786902, 5.044142022409655, 7.287610080703558, 4.929428878513898, 4.373465944259664, 4.949657239314883, 10.885736884243945, 6.738042248714324, 6.643866460570137, 3.2557846357254525, 3.730708757500138, 5.157030942362006, 4.634322779002721, 5.080892163217211, 8.692738477265491, 9.177193356243903, 3.86553922792714, 9.613964772886524, 6.432060401983939, 7.650985329699845, 2.032364015171181, 8.058509490363141, 7.659749675896019, 7.136252347797597, 6.975189269032699, 5.742397860898623, 1.563066129789221, 8.711172819600586, 2.584753548096632, 2.958295990451879, 5.82985843595725, 6.180200730755636, 5.01570625228814, 6.027275555666724, 8.85653293129929, 4.1242518032112905, 8.976921253768504, 6.349882747732656, 3.960582586262584, 2.290229913371035, 7.729103671535367, 6.891332345807513, 9.37147157136991, 5.2891666851599535, 5.761954074872024, 4.077062944035082, 2.600878448492959, 6.1419597831108605, 7.209408937325736, 1.1353376356338698, 7.443028306519013, 4.054961325497869, 2.0288410253304328, 0.48043844431604626, 2.5963913806045493, 3.0518778728063247, 9.302327299519972, 5.882863424873584, 4.626742302603791, 4.610608093930531, 5.4885444402066135, 5.6707320308660805, 7.754790533876863, 3.096210664932628, 6.049313478405898, 6.893332105565721, 5.9643892104984015, 9.877309924046825, 6.5608728123050835, 7.357699217622776, 3.0845207268397385, 9.045062190060781, 5.202010193862204, 6.105613695266826, 2.983049076440846, 5.40835583804015, 1.7108842711880186, 5.498864002856681, 8.104153862246159, 8.919860989489074, 5.990564265373261, 5.466582873216064, 1.9081590430693054, 10.343395420286631, 5.550608553809172, 7.290104208647156, 8.3252688650741, 9.31664098590463, 5.541719589007551, 10.933572327122992, 7.982264951673582], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8566488659242246, "mean_inference_ms": 8.050956054428738, "mean_action_processing_ms": 0.5405081107498766, "mean_env_wait_ms": 23.93317452590569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04910540580749512, "StateBufferConnector_ms": 0.027733564376831055, "ViewRequirementAgentConnector_ms": 0.9946184158325195}}, "episode_reward_max": 10.933572327122992, "episode_reward_min": 0.48043844431604626, "episode_reward_mean": 5.898003369856069, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.735293771295102, 3.5283784397584976, 3.966319911489409, 6.945393427355009, 3.6276210034855767, 7.06797611561838, 7.08555156845227, 7.691995686978927, 9.44495855328456, 4.820278626786902, 5.044142022409655, 7.287610080703558, 4.929428878513898, 4.373465944259664, 4.949657239314883, 10.885736884243945, 6.738042248714324, 6.643866460570137, 3.2557846357254525, 3.730708757500138, 5.157030942362006, 4.634322779002721, 5.080892163217211, 8.692738477265491, 9.177193356243903, 3.86553922792714, 9.613964772886524, 6.432060401983939, 7.650985329699845, 2.032364015171181, 8.058509490363141, 7.659749675896019, 7.136252347797597, 6.975189269032699, 5.742397860898623, 1.563066129789221, 8.711172819600586, 2.584753548096632, 2.958295990451879, 5.82985843595725, 6.180200730755636, 5.01570625228814, 6.027275555666724, 8.85653293129929, 4.1242518032112905, 8.976921253768504, 6.349882747732656, 3.960582586262584, 2.290229913371035, 7.729103671535367, 6.891332345807513, 9.37147157136991, 5.2891666851599535, 5.761954074872024, 4.077062944035082, 2.600878448492959, 6.1419597831108605, 7.209408937325736, 1.1353376356338698, 7.443028306519013, 4.054961325497869, 2.0288410253304328, 0.48043844431604626, 2.5963913806045493, 3.0518778728063247, 9.302327299519972, 5.882863424873584, 4.626742302603791, 4.610608093930531, 5.4885444402066135, 5.6707320308660805, 7.754790533876863, 3.096210664932628, 6.049313478405898, 6.893332105565721, 5.9643892104984015, 9.877309924046825, 6.5608728123050835, 7.357699217622776, 3.0845207268397385, 9.045062190060781, 5.202010193862204, 6.105613695266826, 2.983049076440846, 5.40835583804015, 1.7108842711880186, 5.498864002856681, 8.104153862246159, 8.919860989489074, 5.990564265373261, 5.466582873216064, 1.9081590430693054, 10.343395420286631, 5.550608553809172, 7.290104208647156, 8.3252688650741, 9.31664098590463, 5.541719589007551, 10.933572327122992, 7.982264951673582], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8566488659242246, "mean_inference_ms": 8.050956054428738, "mean_action_processing_ms": 0.5405081107498766, "mean_env_wait_ms": 23.93317452590569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04910540580749512, "StateBufferConnector_ms": 0.027733564376831055, "ViewRequirementAgentConnector_ms": 0.9946184158325195}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6898444, "num_agent_steps_trained": 6898444, "num_env_steps_sampled": 6898444, "num_env_steps_trained": 6898444, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 273.4956044450823, "num_env_steps_trained_throughput_per_sec": 273.4956044450823, "timesteps_total": 6898444, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6898444, "timers": {"training_iteration_time_ms": 55136.999, "sample_time_ms": 42051.694, "load_time_ms": 1729.816, "load_throughput": 9040.269, "learn_time_ms": 10801.469, "learn_throughput": 1447.766, "synch_weights_time_ms": 444.111}, "counters": {"num_env_steps_sampled": 6898444, "num_env_steps_trained": 6898444, "num_agent_steps_sampled": 6898444, "num_agent_steps_trained": 6898444}, "done": false, "episodes_total": 1372, "training_iteration": 446, "trial_id": "2f030_00000", "date": "2025-06-07_09-08-18", "timestamp": 1749280098, "time_this_iter_s": 57.20552611351013, "time_total_s": 5511.692042827606, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5511.692042827606, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 78.01230769230769, "ram_util_percent": 68.82153846153845, "gpu_util_percent0": 0.07753846153846154, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.448596842105264e-05, "total_loss": -0.0619590991506861, "policy_loss": -0.02688044723165645, "vf_loss": 0.015909230049530213, "vf_explained_var": 0.7279526463421908, "kl": 0.014195350305543065, "entropy": 20.983096937699752, "entropy_coeff": 0.0023808350000000004}, "model": {}, "num_grad_updates_lifetime": 54175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6914082, "num_env_steps_trained": 6914082, "num_agent_steps_sampled": 6914082, "num_agent_steps_trained": 6914082}, "sampler_results": {"episode_reward_max": 10.933572327122992, "episode_reward_min": 0.17321742161309395, "episode_reward_mean": 5.826823953877616, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.949657239314883, 10.885736884243945, 6.738042248714324, 6.643866460570137, 3.2557846357254525, 3.730708757500138, 5.157030942362006, 4.634322779002721, 5.080892163217211, 8.692738477265491, 9.177193356243903, 3.86553922792714, 9.613964772886524, 6.432060401983939, 7.650985329699845, 2.032364015171181, 8.058509490363141, 7.659749675896019, 7.136252347797597, 6.975189269032699, 5.742397860898623, 1.563066129789221, 8.711172819600586, 2.584753548096632, 2.958295990451879, 5.82985843595725, 6.180200730755636, 5.01570625228814, 6.027275555666724, 8.85653293129929, 4.1242518032112905, 8.976921253768504, 6.349882747732656, 3.960582586262584, 2.290229913371035, 7.729103671535367, 6.891332345807513, 9.37147157136991, 5.2891666851599535, 5.761954074872024, 4.077062944035082, 2.600878448492959, 6.1419597831108605, 7.209408937325736, 1.1353376356338698, 7.443028306519013, 4.054961325497869, 2.0288410253304328, 0.48043844431604626, 2.5963913806045493, 3.0518778728063247, 9.302327299519972, 5.882863424873584, 4.626742302603791, 4.610608093930531, 5.4885444402066135, 5.6707320308660805, 7.754790533876863, 3.096210664932628, 6.049313478405898, 6.893332105565721, 5.9643892104984015, 9.877309924046825, 6.5608728123050835, 7.357699217622776, 3.0845207268397385, 9.045062190060781, 5.202010193862204, 6.105613695266826, 2.983049076440846, 5.40835583804015, 1.7108842711880186, 5.498864002856681, 8.104153862246159, 8.919860989489074, 5.990564265373261, 5.466582873216064, 1.9081590430693054, 10.343395420286631, 5.550608553809172, 7.290104208647156, 8.3252688650741, 9.31664098590463, 5.541719589007551, 10.933572327122992, 7.982264951673582, 6.362231279202243, 2.295846093154655, 5.880579721997961, 7.870025879044424, 3.577537171277158, 6.93460789464384, 8.020678244510465, 3.9847741087095954, 6.586109500683966, 5.555772676985104, 7.91578835264148, 5.142215723370416, 5.131088364711631, 0.17321742161309395], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.856017449544146, "mean_inference_ms": 8.052268704421847, "mean_action_processing_ms": 0.540598442095527, "mean_env_wait_ms": 23.936131389120032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04676055908203125, "StateBufferConnector_ms": 0.028202295303344727, "ViewRequirementAgentConnector_ms": 1.0175323486328125}}, "episode_reward_max": 10.933572327122992, "episode_reward_min": 0.17321742161309395, "episode_reward_mean": 5.826823953877616, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.949657239314883, 10.885736884243945, 6.738042248714324, 6.643866460570137, 3.2557846357254525, 3.730708757500138, 5.157030942362006, 4.634322779002721, 5.080892163217211, 8.692738477265491, 9.177193356243903, 3.86553922792714, 9.613964772886524, 6.432060401983939, 7.650985329699845, 2.032364015171181, 8.058509490363141, 7.659749675896019, 7.136252347797597, 6.975189269032699, 5.742397860898623, 1.563066129789221, 8.711172819600586, 2.584753548096632, 2.958295990451879, 5.82985843595725, 6.180200730755636, 5.01570625228814, 6.027275555666724, 8.85653293129929, 4.1242518032112905, 8.976921253768504, 6.349882747732656, 3.960582586262584, 2.290229913371035, 7.729103671535367, 6.891332345807513, 9.37147157136991, 5.2891666851599535, 5.761954074872024, 4.077062944035082, 2.600878448492959, 6.1419597831108605, 7.209408937325736, 1.1353376356338698, 7.443028306519013, 4.054961325497869, 2.0288410253304328, 0.48043844431604626, 2.5963913806045493, 3.0518778728063247, 9.302327299519972, 5.882863424873584, 4.626742302603791, 4.610608093930531, 5.4885444402066135, 5.6707320308660805, 7.754790533876863, 3.096210664932628, 6.049313478405898, 6.893332105565721, 5.9643892104984015, 9.877309924046825, 6.5608728123050835, 7.357699217622776, 3.0845207268397385, 9.045062190060781, 5.202010193862204, 6.105613695266826, 2.983049076440846, 5.40835583804015, 1.7108842711880186, 5.498864002856681, 8.104153862246159, 8.919860989489074, 5.990564265373261, 5.466582873216064, 1.9081590430693054, 10.343395420286631, 5.550608553809172, 7.290104208647156, 8.3252688650741, 9.31664098590463, 5.541719589007551, 10.933572327122992, 7.982264951673582, 6.362231279202243, 2.295846093154655, 5.880579721997961, 7.870025879044424, 3.577537171277158, 6.93460789464384, 8.020678244510465, 3.9847741087095954, 6.586109500683966, 5.555772676985104, 7.91578835264148, 5.142215723370416, 5.131088364711631, 0.17321742161309395], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.856017449544146, "mean_inference_ms": 8.052268704421847, "mean_action_processing_ms": 0.540598442095527, "mean_env_wait_ms": 23.936131389120032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04676055908203125, "StateBufferConnector_ms": 0.028202295303344727, "ViewRequirementAgentConnector_ms": 1.0175323486328125}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6914082, "num_agent_steps_trained": 6914082, "num_env_steps_sampled": 6914082, "num_env_steps_trained": 6914082, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.1554950227527, "num_env_steps_trained_throughput_per_sec": 285.1554950227527, "timesteps_total": 6914082, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6914082, "timers": {"training_iteration_time_ms": 55168.536, "sample_time_ms": 42064.829, "load_time_ms": 1734.958, "load_throughput": 9013.473, "learn_time_ms": 10804.602, "learn_throughput": 1447.346, "synch_weights_time_ms": 452.245}, "counters": {"num_env_steps_sampled": 6914082, "num_env_steps_trained": 6914082, "num_agent_steps_sampled": 6914082, "num_agent_steps_trained": 6914082}, "done": false, "episodes_total": 1386, "training_iteration": 447, "trial_id": "2f030_00000", "date": "2025-06-07_09-09-13", "timestamp": 1749280153, "time_this_iter_s": 54.850040912628174, "time_total_s": 5566.542083740234, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5566.542083740234, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 77.85161290322583, "ram_util_percent": 68.7290322580645, "gpu_util_percent0": 0.08048387096774194, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.4362510526315795e-05, "total_loss": -0.05686337908137251, "policy_loss": -0.022398992646485566, "vf_loss": 0.014209526237100362, "vf_explained_var": 0.7187833294001492, "kl": 0.014020873508829862, "entropy": 20.97539357098666, "entropy_coeff": 0.0023221925}, "model": {}, "num_grad_updates_lifetime": 54725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6929720, "num_env_steps_trained": 6929720, "num_agent_steps_sampled": 6929720, "num_agent_steps_trained": 6929720}, "sampler_results": {"episode_reward_max": 10.933572327122992, "episode_reward_min": 0.17321742161309395, "episode_reward_mean": 5.794127623219995, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.650985329699845, 2.032364015171181, 8.058509490363141, 7.659749675896019, 7.136252347797597, 6.975189269032699, 5.742397860898623, 1.563066129789221, 8.711172819600586, 2.584753548096632, 2.958295990451879, 5.82985843595725, 6.180200730755636, 5.01570625228814, 6.027275555666724, 8.85653293129929, 4.1242518032112905, 8.976921253768504, 6.349882747732656, 3.960582586262584, 2.290229913371035, 7.729103671535367, 6.891332345807513, 9.37147157136991, 5.2891666851599535, 5.761954074872024, 4.077062944035082, 2.600878448492959, 6.1419597831108605, 7.209408937325736, 1.1353376356338698, 7.443028306519013, 4.054961325497869, 2.0288410253304328, 0.48043844431604626, 2.5963913806045493, 3.0518778728063247, 9.302327299519972, 5.882863424873584, 4.626742302603791, 4.610608093930531, 5.4885444402066135, 5.6707320308660805, 7.754790533876863, 3.096210664932628, 6.049313478405898, 6.893332105565721, 5.9643892104984015, 9.877309924046825, 6.5608728123050835, 7.357699217622776, 3.0845207268397385, 9.045062190060781, 5.202010193862204, 6.105613695266826, 2.983049076440846, 5.40835583804015, 1.7108842711880186, 5.498864002856681, 8.104153862246159, 8.919860989489074, 5.990564265373261, 5.466582873216064, 1.9081590430693054, 10.343395420286631, 5.550608553809172, 7.290104208647156, 8.3252688650741, 9.31664098590463, 5.541719589007551, 10.933572327122992, 7.982264951673582, 6.362231279202243, 2.295846093154655, 5.880579721997961, 7.870025879044424, 3.577537171277158, 6.93460789464384, 8.020678244510465, 3.9847741087095954, 6.586109500683966, 5.555772676985104, 7.91578835264148, 5.142215723370416, 5.131088364711631, 0.17321742161309395, 9.306005162256549, 6.117275955546665, 4.8482484486838855, 9.403420472101606, 5.918722073634162, 6.202903709458457, 7.266352172898702, 3.7016499475005524, 0.22263713030555254, 5.361904480932327, 6.548285562122642, 7.65790347106238, 5.2423330933439845, 7.790263601348301], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.855447008704581, "mean_inference_ms": 8.053413445741624, "mean_action_processing_ms": 0.5406988708759346, "mean_env_wait_ms": 23.938809562923407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04262065887451172, "StateBufferConnector_ms": 0.029666662216186523, "ViewRequirementAgentConnector_ms": 1.0160109996795654}}, "episode_reward_max": 10.933572327122992, "episode_reward_min": 0.17321742161309395, "episode_reward_mean": 5.794127623219995, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.650985329699845, 2.032364015171181, 8.058509490363141, 7.659749675896019, 7.136252347797597, 6.975189269032699, 5.742397860898623, 1.563066129789221, 8.711172819600586, 2.584753548096632, 2.958295990451879, 5.82985843595725, 6.180200730755636, 5.01570625228814, 6.027275555666724, 8.85653293129929, 4.1242518032112905, 8.976921253768504, 6.349882747732656, 3.960582586262584, 2.290229913371035, 7.729103671535367, 6.891332345807513, 9.37147157136991, 5.2891666851599535, 5.761954074872024, 4.077062944035082, 2.600878448492959, 6.1419597831108605, 7.209408937325736, 1.1353376356338698, 7.443028306519013, 4.054961325497869, 2.0288410253304328, 0.48043844431604626, 2.5963913806045493, 3.0518778728063247, 9.302327299519972, 5.882863424873584, 4.626742302603791, 4.610608093930531, 5.4885444402066135, 5.6707320308660805, 7.754790533876863, 3.096210664932628, 6.049313478405898, 6.893332105565721, 5.9643892104984015, 9.877309924046825, 6.5608728123050835, 7.357699217622776, 3.0845207268397385, 9.045062190060781, 5.202010193862204, 6.105613695266826, 2.983049076440846, 5.40835583804015, 1.7108842711880186, 5.498864002856681, 8.104153862246159, 8.919860989489074, 5.990564265373261, 5.466582873216064, 1.9081590430693054, 10.343395420286631, 5.550608553809172, 7.290104208647156, 8.3252688650741, 9.31664098590463, 5.541719589007551, 10.933572327122992, 7.982264951673582, 6.362231279202243, 2.295846093154655, 5.880579721997961, 7.870025879044424, 3.577537171277158, 6.93460789464384, 8.020678244510465, 3.9847741087095954, 6.586109500683966, 5.555772676985104, 7.91578835264148, 5.142215723370416, 5.131088364711631, 0.17321742161309395, 9.306005162256549, 6.117275955546665, 4.8482484486838855, 9.403420472101606, 5.918722073634162, 6.202903709458457, 7.266352172898702, 3.7016499475005524, 0.22263713030555254, 5.361904480932327, 6.548285562122642, 7.65790347106238, 5.2423330933439845, 7.790263601348301], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.855447008704581, "mean_inference_ms": 8.053413445741624, "mean_action_processing_ms": 0.5406988708759346, "mean_env_wait_ms": 23.938809562923407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04262065887451172, "StateBufferConnector_ms": 0.029666662216186523, "ViewRequirementAgentConnector_ms": 1.0160109996795654}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6929720, "num_agent_steps_trained": 6929720, "num_env_steps_sampled": 6929720, "num_env_steps_trained": 6929720, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.53102436640904, "num_env_steps_trained_throughput_per_sec": 286.53102436640904, "timesteps_total": 6929720, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6929720, "timers": {"training_iteration_time_ms": 55134.218, "sample_time_ms": 42009.338, "load_time_ms": 1748.4, "load_throughput": 8944.179, "learn_time_ms": 10807.637, "learn_throughput": 1446.94, "synch_weights_time_ms": 453.769}, "counters": {"num_env_steps_sampled": 6929720, "num_env_steps_trained": 6929720, "num_agent_steps_sampled": 6929720, "num_agent_steps_trained": 6929720}, "done": false, "episodes_total": 1400, "training_iteration": 448, "trial_id": "2f030_00000", "date": "2025-06-07_09-10-08", "timestamp": 1749280208, "time_this_iter_s": 54.59496474266052, "time_total_s": 5621.137048482895, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5621.137048482895, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 77.54444444444445, "ram_util_percent": 68.76031746031747, "gpu_util_percent0": 0.07936507936507936, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.423905263157895e-05, "total_loss": -0.05126569199418141, "policy_loss": -0.017962297591571273, "vf_loss": 0.013197421208870682, "vf_explained_var": 0.6999937843192707, "kl": 0.01453676740838553, "entropy": 21.034017895785244, "entropy_coeff": 0.00226355}, "model": {}, "num_grad_updates_lifetime": 55275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6945358, "num_env_steps_trained": 6945358, "num_agent_steps_sampled": 6945358, "num_agent_steps_trained": 6945358}, "sampler_results": {"episode_reward_max": 10.933572327122992, "episode_reward_min": 0.17321742161309395, "episode_reward_mean": 5.831261688332869, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.027275555666724, 8.85653293129929, 4.1242518032112905, 8.976921253768504, 6.349882747732656, 3.960582586262584, 2.290229913371035, 7.729103671535367, 6.891332345807513, 9.37147157136991, 5.2891666851599535, 5.761954074872024, 4.077062944035082, 2.600878448492959, 6.1419597831108605, 7.209408937325736, 1.1353376356338698, 7.443028306519013, 4.054961325497869, 2.0288410253304328, 0.48043844431604626, 2.5963913806045493, 3.0518778728063247, 9.302327299519972, 5.882863424873584, 4.626742302603791, 4.610608093930531, 5.4885444402066135, 5.6707320308660805, 7.754790533876863, 3.096210664932628, 6.049313478405898, 6.893332105565721, 5.9643892104984015, 9.877309924046825, 6.5608728123050835, 7.357699217622776, 3.0845207268397385, 9.045062190060781, 5.202010193862204, 6.105613695266826, 2.983049076440846, 5.40835583804015, 1.7108842711880186, 5.498864002856681, 8.104153862246159, 8.919860989489074, 5.990564265373261, 5.466582873216064, 1.9081590430693054, 10.343395420286631, 5.550608553809172, 7.290104208647156, 8.3252688650741, 9.31664098590463, 5.541719589007551, 10.933572327122992, 7.982264951673582, 6.362231279202243, 2.295846093154655, 5.880579721997961, 7.870025879044424, 3.577537171277158, 6.93460789464384, 8.020678244510465, 3.9847741087095954, 6.586109500683966, 5.555772676985104, 7.91578835264148, 5.142215723370416, 5.131088364711631, 0.17321742161309395, 9.306005162256549, 6.117275955546665, 4.8482484486838855, 9.403420472101606, 5.918722073634162, 6.202903709458457, 7.266352172898702, 3.7016499475005524, 0.22263713030555254, 5.361904480932327, 6.548285562122642, 7.65790347106238, 5.2423330933439845, 7.790263601348301, 7.0066934043206475, 4.786743815338449, 6.626307376071038, 6.446613661437187, 7.630435655436358, 8.067033276897678, 3.8496230429147626, 5.728000116978489, 6.000174717754946, 3.4753151050442788, 5.414460123511902, 7.687200059245891, 5.221419499034341, 3.871888553099614], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.854697358602868, "mean_inference_ms": 8.054925950919422, "mean_action_processing_ms": 0.5407998983522095, "mean_env_wait_ms": 23.94209698255535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0436549186706543, "StateBufferConnector_ms": 0.03072071075439453, "ViewRequirementAgentConnector_ms": 0.9940938949584961}}, "episode_reward_max": 10.933572327122992, "episode_reward_min": 0.17321742161309395, "episode_reward_mean": 5.831261688332869, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.027275555666724, 8.85653293129929, 4.1242518032112905, 8.976921253768504, 6.349882747732656, 3.960582586262584, 2.290229913371035, 7.729103671535367, 6.891332345807513, 9.37147157136991, 5.2891666851599535, 5.761954074872024, 4.077062944035082, 2.600878448492959, 6.1419597831108605, 7.209408937325736, 1.1353376356338698, 7.443028306519013, 4.054961325497869, 2.0288410253304328, 0.48043844431604626, 2.5963913806045493, 3.0518778728063247, 9.302327299519972, 5.882863424873584, 4.626742302603791, 4.610608093930531, 5.4885444402066135, 5.6707320308660805, 7.754790533876863, 3.096210664932628, 6.049313478405898, 6.893332105565721, 5.9643892104984015, 9.877309924046825, 6.5608728123050835, 7.357699217622776, 3.0845207268397385, 9.045062190060781, 5.202010193862204, 6.105613695266826, 2.983049076440846, 5.40835583804015, 1.7108842711880186, 5.498864002856681, 8.104153862246159, 8.919860989489074, 5.990564265373261, 5.466582873216064, 1.9081590430693054, 10.343395420286631, 5.550608553809172, 7.290104208647156, 8.3252688650741, 9.31664098590463, 5.541719589007551, 10.933572327122992, 7.982264951673582, 6.362231279202243, 2.295846093154655, 5.880579721997961, 7.870025879044424, 3.577537171277158, 6.93460789464384, 8.020678244510465, 3.9847741087095954, 6.586109500683966, 5.555772676985104, 7.91578835264148, 5.142215723370416, 5.131088364711631, 0.17321742161309395, 9.306005162256549, 6.117275955546665, 4.8482484486838855, 9.403420472101606, 5.918722073634162, 6.202903709458457, 7.266352172898702, 3.7016499475005524, 0.22263713030555254, 5.361904480932327, 6.548285562122642, 7.65790347106238, 5.2423330933439845, 7.790263601348301, 7.0066934043206475, 4.786743815338449, 6.626307376071038, 6.446613661437187, 7.630435655436358, 8.067033276897678, 3.8496230429147626, 5.728000116978489, 6.000174717754946, 3.4753151050442788, 5.414460123511902, 7.687200059245891, 5.221419499034341, 3.871888553099614], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.854697358602868, "mean_inference_ms": 8.054925950919422, "mean_action_processing_ms": 0.5407998983522095, "mean_env_wait_ms": 23.94209698255535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0436549186706543, "StateBufferConnector_ms": 0.03072071075439453, "ViewRequirementAgentConnector_ms": 0.9940938949584961}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6945358, "num_agent_steps_trained": 6945358, "num_env_steps_sampled": 6945358, "num_env_steps_trained": 6945358, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.44026966710476, "num_env_steps_trained_throughput_per_sec": 282.44026966710476, "timesteps_total": 6945358, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6945358, "timers": {"training_iteration_time_ms": 55184.55, "sample_time_ms": 42073.199, "load_time_ms": 1734.524, "load_throughput": 9015.731, "learn_time_ms": 10802.241, "learn_throughput": 1447.663, "synch_weights_time_ms": 459.345}, "counters": {"num_env_steps_sampled": 6945358, "num_env_steps_trained": 6945358, "num_agent_steps_sampled": 6945358, "num_agent_steps_trained": 6945358}, "done": false, "episodes_total": 1414, "training_iteration": 449, "trial_id": "2f030_00000", "date": "2025-06-07_09-11-04", "timestamp": 1749280264, "time_this_iter_s": 55.384459495544434, "time_total_s": 5676.521507978439, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5676.521507978439, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 78.14285714285715, "ram_util_percent": 68.61111111111111, "gpu_util_percent0": 0.07682539682539682, "vram_util_percent0": 0.8592122395833336}}
{"evaluation": {"sampler_results": {"episode_reward_max": -5.047429018505748, "episode_reward_min": -9.196266955770257, "episode_reward_mean": -6.733318237525222, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.047429018505748, -6.722008940337207, -9.196266955770257, -5.5430879095418275, -7.157798363471073], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4329092291289316, "mean_inference_ms": 3.8952020161378735, "mean_action_processing_ms": 0.28137738567345133, "mean_env_wait_ms": 10.480747099462652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020074844360351562, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3003501892089844}}, "episode_reward_max": -5.047429018505748, "episode_reward_min": -9.196266955770257, "episode_reward_mean": -6.733318237525222, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.047429018505748, -6.722008940337207, -9.196266955770257, -5.5430879095418275, -7.157798363471073], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4329092291289316, "mean_inference_ms": 3.8952020161378735, "mean_action_processing_ms": 0.28137738567345133, "mean_env_wait_ms": 10.480747099462652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020074844360351562, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3003501892089844}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.411559473684211e-05, "total_loss": -0.06949280842546035, "policy_loss": -0.03719205149846278, "vf_loss": 0.014424735168841752, "vf_explained_var": 0.7106808522614566, "kl": 0.013545675127444945, "entropy": 20.985702393271705, "entropy_coeff": 0.0022049074999999996}, "model": {}, "num_grad_updates_lifetime": 55825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6960996, "num_env_steps_trained": 6960996, "num_agent_steps_sampled": 6960996, "num_agent_steps_trained": 6960996}, "sampler_results": {"episode_reward_max": 10.933572327122992, "episode_reward_min": 0.17321742161309395, "episode_reward_mean": 5.794189037119183, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.1419597831108605, 7.209408937325736, 1.1353376356338698, 7.443028306519013, 4.054961325497869, 2.0288410253304328, 0.48043844431604626, 2.5963913806045493, 3.0518778728063247, 9.302327299519972, 5.882863424873584, 4.626742302603791, 4.610608093930531, 5.4885444402066135, 5.6707320308660805, 7.754790533876863, 3.096210664932628, 6.049313478405898, 6.893332105565721, 5.9643892104984015, 9.877309924046825, 6.5608728123050835, 7.357699217622776, 3.0845207268397385, 9.045062190060781, 5.202010193862204, 6.105613695266826, 2.983049076440846, 5.40835583804015, 1.7108842711880186, 5.498864002856681, 8.104153862246159, 8.919860989489074, 5.990564265373261, 5.466582873216064, 1.9081590430693054, 10.343395420286631, 5.550608553809172, 7.290104208647156, 8.3252688650741, 9.31664098590463, 5.541719589007551, 10.933572327122992, 7.982264951673582, 6.362231279202243, 2.295846093154655, 5.880579721997961, 7.870025879044424, 3.577537171277158, 6.93460789464384, 8.020678244510465, 3.9847741087095954, 6.586109500683966, 5.555772676985104, 7.91578835264148, 5.142215723370416, 5.131088364711631, 0.17321742161309395, 9.306005162256549, 6.117275955546665, 4.8482484486838855, 9.403420472101606, 5.918722073634162, 6.202903709458457, 7.266352172898702, 3.7016499475005524, 0.22263713030555254, 5.361904480932327, 6.548285562122642, 7.65790347106238, 5.2423330933439845, 7.790263601348301, 7.0066934043206475, 4.786743815338449, 6.626307376071038, 6.446613661437187, 7.630435655436358, 8.067033276897678, 3.8496230429147626, 5.728000116978489, 6.000174717754946, 3.4753151050442788, 5.414460123511902, 7.687200059245891, 5.221419499034341, 3.871888553099614, 3.6505889316548954, 9.354129856645365, 7.648754095202426, 1.5627047618899608, 6.11929870413704, 1.6849595362769338, 9.640759124821793, 5.178621610615089, 6.7369610148446215, 6.111635526636909, 5.800693065414483, 6.180625530021452, 3.744763380597479, 5.184886272458018], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8540128212487703, "mean_inference_ms": 8.056108619201304, "mean_action_processing_ms": 0.5409038777400547, "mean_env_wait_ms": 23.945120382961722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0351254940032959, "StateBufferConnector_ms": 0.03176164627075195, "ViewRequirementAgentConnector_ms": 1.0306823253631592}}, "episode_reward_max": 10.933572327122992, "episode_reward_min": 0.17321742161309395, "episode_reward_mean": 5.794189037119183, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.1419597831108605, 7.209408937325736, 1.1353376356338698, 7.443028306519013, 4.054961325497869, 2.0288410253304328, 0.48043844431604626, 2.5963913806045493, 3.0518778728063247, 9.302327299519972, 5.882863424873584, 4.626742302603791, 4.610608093930531, 5.4885444402066135, 5.6707320308660805, 7.754790533876863, 3.096210664932628, 6.049313478405898, 6.893332105565721, 5.9643892104984015, 9.877309924046825, 6.5608728123050835, 7.357699217622776, 3.0845207268397385, 9.045062190060781, 5.202010193862204, 6.105613695266826, 2.983049076440846, 5.40835583804015, 1.7108842711880186, 5.498864002856681, 8.104153862246159, 8.919860989489074, 5.990564265373261, 5.466582873216064, 1.9081590430693054, 10.343395420286631, 5.550608553809172, 7.290104208647156, 8.3252688650741, 9.31664098590463, 5.541719589007551, 10.933572327122992, 7.982264951673582, 6.362231279202243, 2.295846093154655, 5.880579721997961, 7.870025879044424, 3.577537171277158, 6.93460789464384, 8.020678244510465, 3.9847741087095954, 6.586109500683966, 5.555772676985104, 7.91578835264148, 5.142215723370416, 5.131088364711631, 0.17321742161309395, 9.306005162256549, 6.117275955546665, 4.8482484486838855, 9.403420472101606, 5.918722073634162, 6.202903709458457, 7.266352172898702, 3.7016499475005524, 0.22263713030555254, 5.361904480932327, 6.548285562122642, 7.65790347106238, 5.2423330933439845, 7.790263601348301, 7.0066934043206475, 4.786743815338449, 6.626307376071038, 6.446613661437187, 7.630435655436358, 8.067033276897678, 3.8496230429147626, 5.728000116978489, 6.000174717754946, 3.4753151050442788, 5.414460123511902, 7.687200059245891, 5.221419499034341, 3.871888553099614, 3.6505889316548954, 9.354129856645365, 7.648754095202426, 1.5627047618899608, 6.11929870413704, 1.6849595362769338, 9.640759124821793, 5.178621610615089, 6.7369610148446215, 6.111635526636909, 5.800693065414483, 6.180625530021452, 3.744763380597479, 5.184886272458018], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8540128212487703, "mean_inference_ms": 8.056108619201304, "mean_action_processing_ms": 0.5409038777400547, "mean_env_wait_ms": 23.945120382961722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0351254940032959, "StateBufferConnector_ms": 0.03176164627075195, "ViewRequirementAgentConnector_ms": 1.0306823253631592}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6960996, "num_agent_steps_trained": 6960996, "num_env_steps_sampled": 6960996, "num_env_steps_trained": 6960996, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.46616729050953, "num_env_steps_trained_throughput_per_sec": 284.46616729050953, "timesteps_total": 6960996, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6960996, "timers": {"training_iteration_time_ms": 55125.779, "sample_time_ms": 42028.521, "load_time_ms": 1740.758, "load_throughput": 8983.443, "learn_time_ms": 10786.153, "learn_throughput": 1449.822, "synch_weights_time_ms": 454.121}, "counters": {"num_env_steps_sampled": 6960996, "num_env_steps_trained": 6960996, "num_agent_steps_sampled": 6960996, "num_agent_steps_trained": 6960996}, "done": false, "episodes_total": 1428, "training_iteration": 450, "trial_id": "2f030_00000", "date": "2025-06-07_09-12-13", "timestamp": 1749280333, "time_this_iter_s": 69.82247734069824, "time_total_s": 5746.343985319138, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5746.343985319138, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 64.8329268292683, "ram_util_percent": 68.33048780487805, "gpu_util_percent0": 0.06682926829268293, "vram_util_percent0": 0.8592122395833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.399213684210527e-05, "total_loss": -0.057095907661555846, "policy_loss": -0.026890744335145097, "vf_loss": 0.016618013727394017, "vf_explained_var": 0.6992990294369784, "kl": 0.01386893637193993, "entropy": 20.99650234569203, "entropy_coeff": 0.002146265}, "model": {}, "num_grad_updates_lifetime": 56375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6976634, "num_env_steps_trained": 6976634, "num_agent_steps_sampled": 6976634, "num_agent_steps_trained": 6976634}, "sampler_results": {"episode_reward_max": 10.933572327122992, "episode_reward_min": -0.9650409550714458, "episode_reward_mean": 5.968764891258929, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.6707320308660805, 7.754790533876863, 3.096210664932628, 6.049313478405898, 6.893332105565721, 5.9643892104984015, 9.877309924046825, 6.5608728123050835, 7.357699217622776, 3.0845207268397385, 9.045062190060781, 5.202010193862204, 6.105613695266826, 2.983049076440846, 5.40835583804015, 1.7108842711880186, 5.498864002856681, 8.104153862246159, 8.919860989489074, 5.990564265373261, 5.466582873216064, 1.9081590430693054, 10.343395420286631, 5.550608553809172, 7.290104208647156, 8.3252688650741, 9.31664098590463, 5.541719589007551, 10.933572327122992, 7.982264951673582, 6.362231279202243, 2.295846093154655, 5.880579721997961, 7.870025879044424, 3.577537171277158, 6.93460789464384, 8.020678244510465, 3.9847741087095954, 6.586109500683966, 5.555772676985104, 7.91578835264148, 5.142215723370416, 5.131088364711631, 0.17321742161309395, 9.306005162256549, 6.117275955546665, 4.8482484486838855, 9.403420472101606, 5.918722073634162, 6.202903709458457, 7.266352172898702, 3.7016499475005524, 0.22263713030555254, 5.361904480932327, 6.548285562122642, 7.65790347106238, 5.2423330933439845, 7.790263601348301, 7.0066934043206475, 4.786743815338449, 6.626307376071038, 6.446613661437187, 7.630435655436358, 8.067033276897678, 3.8496230429147626, 5.728000116978489, 6.000174717754946, 3.4753151050442788, 5.414460123511902, 7.687200059245891, 5.221419499034341, 3.871888553099614, 3.6505889316548954, 9.354129856645365, 7.648754095202426, 1.5627047618899608, 6.11929870413704, 1.6849595362769338, 9.640759124821793, 5.178621610615089, 6.7369610148446215, 6.111635526636909, 5.800693065414483, 6.180625530021452, 3.744763380597479, 5.184886272458018, 6.254619432599161, 4.3538309215635165, 5.468503077493973, 8.289113816546836, 8.793058943086946, 3.737012309891754, -0.9650409550714458, 4.642811214890394, 7.3181581939381415, 2.8388719938999474, 6.437146256455983, 7.218075267637503, 8.463321837399869, 8.66143337592131], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.853242247413898, "mean_inference_ms": 8.057175497157624, "mean_action_processing_ms": 0.5410035634095169, "mean_env_wait_ms": 23.947791750619498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037110090255737305, "StateBufferConnector_ms": 0.036875009536743164, "ViewRequirementAgentConnector_ms": 0.9860124588012695}}, "episode_reward_max": 10.933572327122992, "episode_reward_min": -0.9650409550714458, "episode_reward_mean": 5.968764891258929, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.6707320308660805, 7.754790533876863, 3.096210664932628, 6.049313478405898, 6.893332105565721, 5.9643892104984015, 9.877309924046825, 6.5608728123050835, 7.357699217622776, 3.0845207268397385, 9.045062190060781, 5.202010193862204, 6.105613695266826, 2.983049076440846, 5.40835583804015, 1.7108842711880186, 5.498864002856681, 8.104153862246159, 8.919860989489074, 5.990564265373261, 5.466582873216064, 1.9081590430693054, 10.343395420286631, 5.550608553809172, 7.290104208647156, 8.3252688650741, 9.31664098590463, 5.541719589007551, 10.933572327122992, 7.982264951673582, 6.362231279202243, 2.295846093154655, 5.880579721997961, 7.870025879044424, 3.577537171277158, 6.93460789464384, 8.020678244510465, 3.9847741087095954, 6.586109500683966, 5.555772676985104, 7.91578835264148, 5.142215723370416, 5.131088364711631, 0.17321742161309395, 9.306005162256549, 6.117275955546665, 4.8482484486838855, 9.403420472101606, 5.918722073634162, 6.202903709458457, 7.266352172898702, 3.7016499475005524, 0.22263713030555254, 5.361904480932327, 6.548285562122642, 7.65790347106238, 5.2423330933439845, 7.790263601348301, 7.0066934043206475, 4.786743815338449, 6.626307376071038, 6.446613661437187, 7.630435655436358, 8.067033276897678, 3.8496230429147626, 5.728000116978489, 6.000174717754946, 3.4753151050442788, 5.414460123511902, 7.687200059245891, 5.221419499034341, 3.871888553099614, 3.6505889316548954, 9.354129856645365, 7.648754095202426, 1.5627047618899608, 6.11929870413704, 1.6849595362769338, 9.640759124821793, 5.178621610615089, 6.7369610148446215, 6.111635526636909, 5.800693065414483, 6.180625530021452, 3.744763380597479, 5.184886272458018, 6.254619432599161, 4.3538309215635165, 5.468503077493973, 8.289113816546836, 8.793058943086946, 3.737012309891754, -0.9650409550714458, 4.642811214890394, 7.3181581939381415, 2.8388719938999474, 6.437146256455983, 7.218075267637503, 8.463321837399869, 8.66143337592131], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.853242247413898, "mean_inference_ms": 8.057175497157624, "mean_action_processing_ms": 0.5410035634095169, "mean_env_wait_ms": 23.947791750619498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037110090255737305, "StateBufferConnector_ms": 0.036875009536743164, "ViewRequirementAgentConnector_ms": 0.9860124588012695}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6976634, "num_agent_steps_trained": 6976634, "num_env_steps_sampled": 6976634, "num_env_steps_trained": 6976634, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.9168745707381, "num_env_steps_trained_throughput_per_sec": 286.9168745707381, "timesteps_total": 6976634, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6976634, "timers": {"training_iteration_time_ms": 55136.318, "sample_time_ms": 42028.886, "load_time_ms": 1753.15, "load_throughput": 8919.946, "learn_time_ms": 10791.167, "learn_throughput": 1449.148, "synch_weights_time_ms": 445.871}, "counters": {"num_env_steps_sampled": 6976634, "num_env_steps_trained": 6976634, "num_agent_steps_sampled": 6976634, "num_agent_steps_trained": 6976634}, "done": false, "episodes_total": 1442, "training_iteration": 451, "trial_id": "2f030_00000", "date": "2025-06-07_09-13-08", "timestamp": 1749280388, "time_this_iter_s": 54.55260133743286, "time_total_s": 5800.89658665657, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5800.89658665657, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 76.82539682539684, "ram_util_percent": 69.06984126984126, "gpu_util_percent0": 0.07809523809523808, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.386867894736841e-05, "total_loss": -0.056401649401523174, "policy_loss": -0.027294961434831334, "vf_loss": 0.01450812587175857, "vf_explained_var": 0.6901495332067663, "kl": 0.014488586830890946, "entropy": 20.968233349540018, "entropy_coeff": 0.0020876225000000005}, "model": {}, "num_grad_updates_lifetime": 56925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 6992272, "num_env_steps_trained": 6992272, "num_agent_steps_sampled": 6992272, "num_agent_steps_trained": 6992272}, "sampler_results": {"episode_reward_max": 10.933572327122992, "episode_reward_min": -0.9650409550714458, "episode_reward_mean": 5.975672627087776, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.40835583804015, 1.7108842711880186, 5.498864002856681, 8.104153862246159, 8.919860989489074, 5.990564265373261, 5.466582873216064, 1.9081590430693054, 10.343395420286631, 5.550608553809172, 7.290104208647156, 8.3252688650741, 9.31664098590463, 5.541719589007551, 10.933572327122992, 7.982264951673582, 6.362231279202243, 2.295846093154655, 5.880579721997961, 7.870025879044424, 3.577537171277158, 6.93460789464384, 8.020678244510465, 3.9847741087095954, 6.586109500683966, 5.555772676985104, 7.91578835264148, 5.142215723370416, 5.131088364711631, 0.17321742161309395, 9.306005162256549, 6.117275955546665, 4.8482484486838855, 9.403420472101606, 5.918722073634162, 6.202903709458457, 7.266352172898702, 3.7016499475005524, 0.22263713030555254, 5.361904480932327, 6.548285562122642, 7.65790347106238, 5.2423330933439845, 7.790263601348301, 7.0066934043206475, 4.786743815338449, 6.626307376071038, 6.446613661437187, 7.630435655436358, 8.067033276897678, 3.8496230429147626, 5.728000116978489, 6.000174717754946, 3.4753151050442788, 5.414460123511902, 7.687200059245891, 5.221419499034341, 3.871888553099614, 3.6505889316548954, 9.354129856645365, 7.648754095202426, 1.5627047618899608, 6.11929870413704, 1.6849595362769338, 9.640759124821793, 5.178621610615089, 6.7369610148446215, 6.111635526636909, 5.800693065414483, 6.180625530021452, 3.744763380597479, 5.184886272458018, 6.254619432599161, 4.3538309215635165, 5.468503077493973, 8.289113816546836, 8.793058943086946, 3.737012309891754, -0.9650409550714458, 4.642811214890394, 7.3181581939381415, 2.8388719938999474, 6.437146256455983, 7.218075267637503, 8.463321837399869, 8.66143337592131, 6.904809423756822, 5.458780243518358, 7.104933315409197, 6.617727894109888, 5.916587786956445, 0.2506276115359083, 8.429209909238743, 7.860639471745731, 10.137888722972141, 1.5723574027101659, 4.099919623058259, 8.69199190175166, 6.120233267843275, 7.169972868868776], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8523597942694945, "mean_inference_ms": 8.058468512044254, "mean_action_processing_ms": 0.5410683077309055, "mean_env_wait_ms": 23.950845229326323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03413200378417969, "StateBufferConnector_ms": 0.03821706771850586, "ViewRequirementAgentConnector_ms": 0.999896764755249}}, "episode_reward_max": 10.933572327122992, "episode_reward_min": -0.9650409550714458, "episode_reward_mean": 5.975672627087776, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.40835583804015, 1.7108842711880186, 5.498864002856681, 8.104153862246159, 8.919860989489074, 5.990564265373261, 5.466582873216064, 1.9081590430693054, 10.343395420286631, 5.550608553809172, 7.290104208647156, 8.3252688650741, 9.31664098590463, 5.541719589007551, 10.933572327122992, 7.982264951673582, 6.362231279202243, 2.295846093154655, 5.880579721997961, 7.870025879044424, 3.577537171277158, 6.93460789464384, 8.020678244510465, 3.9847741087095954, 6.586109500683966, 5.555772676985104, 7.91578835264148, 5.142215723370416, 5.131088364711631, 0.17321742161309395, 9.306005162256549, 6.117275955546665, 4.8482484486838855, 9.403420472101606, 5.918722073634162, 6.202903709458457, 7.266352172898702, 3.7016499475005524, 0.22263713030555254, 5.361904480932327, 6.548285562122642, 7.65790347106238, 5.2423330933439845, 7.790263601348301, 7.0066934043206475, 4.786743815338449, 6.626307376071038, 6.446613661437187, 7.630435655436358, 8.067033276897678, 3.8496230429147626, 5.728000116978489, 6.000174717754946, 3.4753151050442788, 5.414460123511902, 7.687200059245891, 5.221419499034341, 3.871888553099614, 3.6505889316548954, 9.354129856645365, 7.648754095202426, 1.5627047618899608, 6.11929870413704, 1.6849595362769338, 9.640759124821793, 5.178621610615089, 6.7369610148446215, 6.111635526636909, 5.800693065414483, 6.180625530021452, 3.744763380597479, 5.184886272458018, 6.254619432599161, 4.3538309215635165, 5.468503077493973, 8.289113816546836, 8.793058943086946, 3.737012309891754, -0.9650409550714458, 4.642811214890394, 7.3181581939381415, 2.8388719938999474, 6.437146256455983, 7.218075267637503, 8.463321837399869, 8.66143337592131, 6.904809423756822, 5.458780243518358, 7.104933315409197, 6.617727894109888, 5.916587786956445, 0.2506276115359083, 8.429209909238743, 7.860639471745731, 10.137888722972141, 1.5723574027101659, 4.099919623058259, 8.69199190175166, 6.120233267843275, 7.169972868868776], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8523597942694945, "mean_inference_ms": 8.058468512044254, "mean_action_processing_ms": 0.5410683077309055, "mean_env_wait_ms": 23.950845229326323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03413200378417969, "StateBufferConnector_ms": 0.03821706771850586, "ViewRequirementAgentConnector_ms": 0.999896764755249}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6992272, "num_agent_steps_trained": 6992272, "num_env_steps_sampled": 6992272, "num_env_steps_trained": 6992272, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.2901586094715, "num_env_steps_trained_throughput_per_sec": 283.2901586094715, "timesteps_total": 6992272, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 6992272, "timers": {"training_iteration_time_ms": 55175.454, "sample_time_ms": 42060.586, "load_time_ms": 1758.474, "load_throughput": 8892.938, "learn_time_ms": 10792.638, "learn_throughput": 1448.951, "synch_weights_time_ms": 444.876}, "counters": {"num_env_steps_sampled": 6992272, "num_env_steps_trained": 6992272, "num_agent_steps_sampled": 6992272, "num_agent_steps_trained": 6992272}, "done": false, "episodes_total": 1456, "training_iteration": 452, "trial_id": "2f030_00000", "date": "2025-06-07_09-14-03", "timestamp": 1749280443, "time_this_iter_s": 55.217172145843506, "time_total_s": 5856.113758802414, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5856.113758802414, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 78.17142857142856, "ram_util_percent": 68.89682539682538, "gpu_util_percent0": 0.08222222222222222, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.3745221052631585e-05, "total_loss": -0.0671266488426111, "policy_loss": -0.038592249372529544, "vf_loss": 0.013109574209560047, "vf_explained_var": 0.699562004479495, "kl": 0.013747830525827506, "entropy": 20.825510666587135, "entropy_coeff": 0.00202898}, "model": {}, "num_grad_updates_lifetime": 57475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7007910, "num_env_steps_trained": 7007910, "num_agent_steps_sampled": 7007910, "num_agent_steps_trained": 7007910}, "sampler_results": {"episode_reward_max": 10.933572327122992, "episode_reward_min": -0.9650409550714458, "episode_reward_mean": 6.129936241981021, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.933572327122992, 7.982264951673582, 6.362231279202243, 2.295846093154655, 5.880579721997961, 7.870025879044424, 3.577537171277158, 6.93460789464384, 8.020678244510465, 3.9847741087095954, 6.586109500683966, 5.555772676985104, 7.91578835264148, 5.142215723370416, 5.131088364711631, 0.17321742161309395, 9.306005162256549, 6.117275955546665, 4.8482484486838855, 9.403420472101606, 5.918722073634162, 6.202903709458457, 7.266352172898702, 3.7016499475005524, 0.22263713030555254, 5.361904480932327, 6.548285562122642, 7.65790347106238, 5.2423330933439845, 7.790263601348301, 7.0066934043206475, 4.786743815338449, 6.626307376071038, 6.446613661437187, 7.630435655436358, 8.067033276897678, 3.8496230429147626, 5.728000116978489, 6.000174717754946, 3.4753151050442788, 5.414460123511902, 7.687200059245891, 5.221419499034341, 3.871888553099614, 3.6505889316548954, 9.354129856645365, 7.648754095202426, 1.5627047618899608, 6.11929870413704, 1.6849595362769338, 9.640759124821793, 5.178621610615089, 6.7369610148446215, 6.111635526636909, 5.800693065414483, 6.180625530021452, 3.744763380597479, 5.184886272458018, 6.254619432599161, 4.3538309215635165, 5.468503077493973, 8.289113816546836, 8.793058943086946, 3.737012309891754, -0.9650409550714458, 4.642811214890394, 7.3181581939381415, 2.8388719938999474, 6.437146256455983, 7.218075267637503, 8.463321837399869, 8.66143337592131, 6.904809423756822, 5.458780243518358, 7.104933315409197, 6.617727894109888, 5.916587786956445, 0.2506276115359083, 8.429209909238743, 7.860639471745731, 10.137888722972141, 1.5723574027101659, 4.099919623058259, 8.69199190175166, 6.120233267843275, 7.169972868868776, 4.7115150702244435, 7.834014603579077, 9.922340299563954, 9.373104190284632, 7.605882672008621, 8.549066260464075, 7.749236826628332, 7.055189228011666, 6.891220319132828, 5.906598325291339, 7.051631346497456, 7.451279397788782, 8.883573952539818, 5.816871765517545], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.851296363965012, "mean_inference_ms": 8.059412044373985, "mean_action_processing_ms": 0.5411283458537381, "mean_env_wait_ms": 23.95292053630078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03203392028808594, "StateBufferConnector_ms": 0.03931283950805664, "ViewRequirementAgentConnector_ms": 0.999737024307251}}, "episode_reward_max": 10.933572327122992, "episode_reward_min": -0.9650409550714458, "episode_reward_mean": 6.129936241981021, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.933572327122992, 7.982264951673582, 6.362231279202243, 2.295846093154655, 5.880579721997961, 7.870025879044424, 3.577537171277158, 6.93460789464384, 8.020678244510465, 3.9847741087095954, 6.586109500683966, 5.555772676985104, 7.91578835264148, 5.142215723370416, 5.131088364711631, 0.17321742161309395, 9.306005162256549, 6.117275955546665, 4.8482484486838855, 9.403420472101606, 5.918722073634162, 6.202903709458457, 7.266352172898702, 3.7016499475005524, 0.22263713030555254, 5.361904480932327, 6.548285562122642, 7.65790347106238, 5.2423330933439845, 7.790263601348301, 7.0066934043206475, 4.786743815338449, 6.626307376071038, 6.446613661437187, 7.630435655436358, 8.067033276897678, 3.8496230429147626, 5.728000116978489, 6.000174717754946, 3.4753151050442788, 5.414460123511902, 7.687200059245891, 5.221419499034341, 3.871888553099614, 3.6505889316548954, 9.354129856645365, 7.648754095202426, 1.5627047618899608, 6.11929870413704, 1.6849595362769338, 9.640759124821793, 5.178621610615089, 6.7369610148446215, 6.111635526636909, 5.800693065414483, 6.180625530021452, 3.744763380597479, 5.184886272458018, 6.254619432599161, 4.3538309215635165, 5.468503077493973, 8.289113816546836, 8.793058943086946, 3.737012309891754, -0.9650409550714458, 4.642811214890394, 7.3181581939381415, 2.8388719938999474, 6.437146256455983, 7.218075267637503, 8.463321837399869, 8.66143337592131, 6.904809423756822, 5.458780243518358, 7.104933315409197, 6.617727894109888, 5.916587786956445, 0.2506276115359083, 8.429209909238743, 7.860639471745731, 10.137888722972141, 1.5723574027101659, 4.099919623058259, 8.69199190175166, 6.120233267843275, 7.169972868868776, 4.7115150702244435, 7.834014603579077, 9.922340299563954, 9.373104190284632, 7.605882672008621, 8.549066260464075, 7.749236826628332, 7.055189228011666, 6.891220319132828, 5.906598325291339, 7.051631346497456, 7.451279397788782, 8.883573952539818, 5.816871765517545], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.851296363965012, "mean_inference_ms": 8.059412044373985, "mean_action_processing_ms": 0.5411283458537381, "mean_env_wait_ms": 23.95292053630078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03203392028808594, "StateBufferConnector_ms": 0.03931283950805664, "ViewRequirementAgentConnector_ms": 0.999737024307251}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7007910, "num_agent_steps_trained": 7007910, "num_env_steps_sampled": 7007910, "num_env_steps_trained": 7007910, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.6991141387642, "num_env_steps_trained_throughput_per_sec": 281.6991141387642, "timesteps_total": 7007910, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7007910, "timers": {"training_iteration_time_ms": 55146.71, "sample_time_ms": 42006.933, "load_time_ms": 1768.95, "load_throughput": 8840.271, "learn_time_ms": 10811.355, "learn_throughput": 1446.442, "synch_weights_time_ms": 441.601}, "counters": {"num_env_steps_sampled": 7007910, "num_env_steps_trained": 7007910, "num_agent_steps_sampled": 7007910, "num_agent_steps_trained": 7007910}, "done": false, "episodes_total": 1470, "training_iteration": 453, "trial_id": "2f030_00000", "date": "2025-06-07_09-14-59", "timestamp": 1749280499, "time_this_iter_s": 55.52913856506348, "time_total_s": 5911.642897367477, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5911.642897367477, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 77.97619047619048, "ram_util_percent": 68.6619047619048, "gpu_util_percent0": 0.08238095238095237, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.3621763157894736e-05, "total_loss": -0.05720792412440377, "policy_loss": -0.029256691364895563, "vf_loss": 0.014445382515815171, "vf_explained_var": 0.7164063541455702, "kl": 0.013275642473890912, "entropy": 20.867980693470347, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 58025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7023548, "num_env_steps_trained": 7023548, "num_agent_steps_sampled": 7023548, "num_agent_steps_trained": 7023548}, "sampler_results": {"episode_reward_max": 10.137888722972141, "episode_reward_min": -0.9650409550714458, "episode_reward_mean": 6.196345229145138, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.131088364711631, 0.17321742161309395, 9.306005162256549, 6.117275955546665, 4.8482484486838855, 9.403420472101606, 5.918722073634162, 6.202903709458457, 7.266352172898702, 3.7016499475005524, 0.22263713030555254, 5.361904480932327, 6.548285562122642, 7.65790347106238, 5.2423330933439845, 7.790263601348301, 7.0066934043206475, 4.786743815338449, 6.626307376071038, 6.446613661437187, 7.630435655436358, 8.067033276897678, 3.8496230429147626, 5.728000116978489, 6.000174717754946, 3.4753151050442788, 5.414460123511902, 7.687200059245891, 5.221419499034341, 3.871888553099614, 3.6505889316548954, 9.354129856645365, 7.648754095202426, 1.5627047618899608, 6.11929870413704, 1.6849595362769338, 9.640759124821793, 5.178621610615089, 6.7369610148446215, 6.111635526636909, 5.800693065414483, 6.180625530021452, 3.744763380597479, 5.184886272458018, 6.254619432599161, 4.3538309215635165, 5.468503077493973, 8.289113816546836, 8.793058943086946, 3.737012309891754, -0.9650409550714458, 4.642811214890394, 7.3181581939381415, 2.8388719938999474, 6.437146256455983, 7.218075267637503, 8.463321837399869, 8.66143337592131, 6.904809423756822, 5.458780243518358, 7.104933315409197, 6.617727894109888, 5.916587786956445, 0.2506276115359083, 8.429209909238743, 7.860639471745731, 10.137888722972141, 1.5723574027101659, 4.099919623058259, 8.69199190175166, 6.120233267843275, 7.169972868868776, 4.7115150702244435, 7.834014603579077, 9.922340299563954, 9.373104190284632, 7.605882672008621, 8.549066260464075, 7.749236826628332, 7.055189228011666, 6.891220319132828, 5.906598325291339, 7.051631346497456, 7.451279397788782, 8.883573952539818, 5.816871765517545, 9.390108759961086, 7.6899902329241066, 6.742254158545921, 8.996079498166022, 8.873877944468715, 6.6079885812805434, 4.796987213196337, 9.681328793853021, 3.0894683909075478, 2.2808156535184327, 6.598607155442604, 5.647652556122997, 7.787372164793852, 7.500371538248245], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.85021634014812, "mean_inference_ms": 8.060355708843325, "mean_action_processing_ms": 0.5411757444287997, "mean_env_wait_ms": 23.954641894101233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036547183990478516, "StateBufferConnector_ms": 0.04242062568664551, "ViewRequirementAgentConnector_ms": 0.9518630504608154}}, "episode_reward_max": 10.137888722972141, "episode_reward_min": -0.9650409550714458, "episode_reward_mean": 6.196345229145138, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.131088364711631, 0.17321742161309395, 9.306005162256549, 6.117275955546665, 4.8482484486838855, 9.403420472101606, 5.918722073634162, 6.202903709458457, 7.266352172898702, 3.7016499475005524, 0.22263713030555254, 5.361904480932327, 6.548285562122642, 7.65790347106238, 5.2423330933439845, 7.790263601348301, 7.0066934043206475, 4.786743815338449, 6.626307376071038, 6.446613661437187, 7.630435655436358, 8.067033276897678, 3.8496230429147626, 5.728000116978489, 6.000174717754946, 3.4753151050442788, 5.414460123511902, 7.687200059245891, 5.221419499034341, 3.871888553099614, 3.6505889316548954, 9.354129856645365, 7.648754095202426, 1.5627047618899608, 6.11929870413704, 1.6849595362769338, 9.640759124821793, 5.178621610615089, 6.7369610148446215, 6.111635526636909, 5.800693065414483, 6.180625530021452, 3.744763380597479, 5.184886272458018, 6.254619432599161, 4.3538309215635165, 5.468503077493973, 8.289113816546836, 8.793058943086946, 3.737012309891754, -0.9650409550714458, 4.642811214890394, 7.3181581939381415, 2.8388719938999474, 6.437146256455983, 7.218075267637503, 8.463321837399869, 8.66143337592131, 6.904809423756822, 5.458780243518358, 7.104933315409197, 6.617727894109888, 5.916587786956445, 0.2506276115359083, 8.429209909238743, 7.860639471745731, 10.137888722972141, 1.5723574027101659, 4.099919623058259, 8.69199190175166, 6.120233267843275, 7.169972868868776, 4.7115150702244435, 7.834014603579077, 9.922340299563954, 9.373104190284632, 7.605882672008621, 8.549066260464075, 7.749236826628332, 7.055189228011666, 6.891220319132828, 5.906598325291339, 7.051631346497456, 7.451279397788782, 8.883573952539818, 5.816871765517545, 9.390108759961086, 7.6899902329241066, 6.742254158545921, 8.996079498166022, 8.873877944468715, 6.6079885812805434, 4.796987213196337, 9.681328793853021, 3.0894683909075478, 2.2808156535184327, 6.598607155442604, 5.647652556122997, 7.787372164793852, 7.500371538248245], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.85021634014812, "mean_inference_ms": 8.060355708843325, "mean_action_processing_ms": 0.5411757444287997, "mean_env_wait_ms": 23.954641894101233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036547183990478516, "StateBufferConnector_ms": 0.04242062568664551, "ViewRequirementAgentConnector_ms": 0.9518630504608154}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7023548, "num_agent_steps_trained": 7023548, "num_env_steps_sampled": 7023548, "num_env_steps_trained": 7023548, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.3290919466006, "num_env_steps_trained_throughput_per_sec": 284.3290919466006, "timesteps_total": 7023548, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7023548, "timers": {"training_iteration_time_ms": 55202.537, "sample_time_ms": 42053.692, "load_time_ms": 1776.095, "load_throughput": 8804.707, "learn_time_ms": 10811.045, "learn_throughput": 1446.484, "synch_weights_time_ms": 442.5}, "counters": {"num_env_steps_sampled": 7023548, "num_env_steps_trained": 7023548, "num_agent_steps_sampled": 7023548, "num_agent_steps_trained": 7023548}, "done": false, "episodes_total": 1484, "training_iteration": 454, "trial_id": "2f030_00000", "date": "2025-06-07_09-15-54", "timestamp": 1749280554, "time_this_iter_s": 55.01764178276062, "time_total_s": 5966.660539150238, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5966.660539150238, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 77.03174603174605, "ram_util_percent": 69.03809523809525, "gpu_util_percent0": 0.08031746031746033, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.349830526315791e-05, "total_loss": -0.05551784711466594, "policy_loss": -0.027466718384953723, "vf_loss": 0.013906915236095135, "vf_explained_var": 0.7322634633020921, "kl": 0.013468377678776606, "entropy": 20.905764163624156, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 58575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7039186, "num_env_steps_trained": 7039186, "num_agent_steps_sampled": 7039186, "num_agent_steps_trained": 7039186}, "sampler_results": {"episode_reward_max": 10.137888722972141, "episode_reward_min": -0.9650409550714458, "episode_reward_mean": 6.374137926772787, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.2423330933439845, 7.790263601348301, 7.0066934043206475, 4.786743815338449, 6.626307376071038, 6.446613661437187, 7.630435655436358, 8.067033276897678, 3.8496230429147626, 5.728000116978489, 6.000174717754946, 3.4753151050442788, 5.414460123511902, 7.687200059245891, 5.221419499034341, 3.871888553099614, 3.6505889316548954, 9.354129856645365, 7.648754095202426, 1.5627047618899608, 6.11929870413704, 1.6849595362769338, 9.640759124821793, 5.178621610615089, 6.7369610148446215, 6.111635526636909, 5.800693065414483, 6.180625530021452, 3.744763380597479, 5.184886272458018, 6.254619432599161, 4.3538309215635165, 5.468503077493973, 8.289113816546836, 8.793058943086946, 3.737012309891754, -0.9650409550714458, 4.642811214890394, 7.3181581939381415, 2.8388719938999474, 6.437146256455983, 7.218075267637503, 8.463321837399869, 8.66143337592131, 6.904809423756822, 5.458780243518358, 7.104933315409197, 6.617727894109888, 5.916587786956445, 0.2506276115359083, 8.429209909238743, 7.860639471745731, 10.137888722972141, 1.5723574027101659, 4.099919623058259, 8.69199190175166, 6.120233267843275, 7.169972868868776, 4.7115150702244435, 7.834014603579077, 9.922340299563954, 9.373104190284632, 7.605882672008621, 8.549066260464075, 7.749236826628332, 7.055189228011666, 6.891220319132828, 5.906598325291339, 7.051631346497456, 7.451279397788782, 8.883573952539818, 5.816871765517545, 9.390108759961086, 7.6899902329241066, 6.742254158545921, 8.996079498166022, 8.873877944468715, 6.6079885812805434, 4.796987213196337, 9.681328793853021, 3.0894683909075478, 2.2808156535184327, 6.598607155442604, 5.647652556122997, 7.787372164793852, 7.500371538248245, 9.753878352537615, 7.6880113734278615, 5.484324219747716, 6.5034658944150765, 4.937649101333519, 2.8965249711697183, 6.623217700280974, 9.143889871030442, 5.123323472006372, 7.554797923389925, 8.436370100621462, 6.355251833976412, 6.291868218330559, 8.846311103325299], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8491429086804554, "mean_inference_ms": 8.061678617068486, "mean_action_processing_ms": 0.5412697263349089, "mean_env_wait_ms": 23.957240873702222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03468203544616699, "StateBufferConnector_ms": 0.04221653938293457, "ViewRequirementAgentConnector_ms": 0.9377717971801758}}, "episode_reward_max": 10.137888722972141, "episode_reward_min": -0.9650409550714458, "episode_reward_mean": 6.374137926772787, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.2423330933439845, 7.790263601348301, 7.0066934043206475, 4.786743815338449, 6.626307376071038, 6.446613661437187, 7.630435655436358, 8.067033276897678, 3.8496230429147626, 5.728000116978489, 6.000174717754946, 3.4753151050442788, 5.414460123511902, 7.687200059245891, 5.221419499034341, 3.871888553099614, 3.6505889316548954, 9.354129856645365, 7.648754095202426, 1.5627047618899608, 6.11929870413704, 1.6849595362769338, 9.640759124821793, 5.178621610615089, 6.7369610148446215, 6.111635526636909, 5.800693065414483, 6.180625530021452, 3.744763380597479, 5.184886272458018, 6.254619432599161, 4.3538309215635165, 5.468503077493973, 8.289113816546836, 8.793058943086946, 3.737012309891754, -0.9650409550714458, 4.642811214890394, 7.3181581939381415, 2.8388719938999474, 6.437146256455983, 7.218075267637503, 8.463321837399869, 8.66143337592131, 6.904809423756822, 5.458780243518358, 7.104933315409197, 6.617727894109888, 5.916587786956445, 0.2506276115359083, 8.429209909238743, 7.860639471745731, 10.137888722972141, 1.5723574027101659, 4.099919623058259, 8.69199190175166, 6.120233267843275, 7.169972868868776, 4.7115150702244435, 7.834014603579077, 9.922340299563954, 9.373104190284632, 7.605882672008621, 8.549066260464075, 7.749236826628332, 7.055189228011666, 6.891220319132828, 5.906598325291339, 7.051631346497456, 7.451279397788782, 8.883573952539818, 5.816871765517545, 9.390108759961086, 7.6899902329241066, 6.742254158545921, 8.996079498166022, 8.873877944468715, 6.6079885812805434, 4.796987213196337, 9.681328793853021, 3.0894683909075478, 2.2808156535184327, 6.598607155442604, 5.647652556122997, 7.787372164793852, 7.500371538248245, 9.753878352537615, 7.6880113734278615, 5.484324219747716, 6.5034658944150765, 4.937649101333519, 2.8965249711697183, 6.623217700280974, 9.143889871030442, 5.123323472006372, 7.554797923389925, 8.436370100621462, 6.355251833976412, 6.291868218330559, 8.846311103325299], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8491429086804554, "mean_inference_ms": 8.061678617068486, "mean_action_processing_ms": 0.5412697263349089, "mean_env_wait_ms": 23.957240873702222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03468203544616699, "StateBufferConnector_ms": 0.04221653938293457, "ViewRequirementAgentConnector_ms": 0.9377717971801758}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7039186, "num_agent_steps_trained": 7039186, "num_env_steps_sampled": 7039186, "num_env_steps_trained": 7039186, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.91784556028193, "num_env_steps_trained_throughput_per_sec": 280.91784556028193, "timesteps_total": 7039186, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7039186, "timers": {"training_iteration_time_ms": 55281.934, "sample_time_ms": 42150.945, "load_time_ms": 1779.474, "load_throughput": 8787.991, "learn_time_ms": 10788.642, "learn_throughput": 1449.487, "synch_weights_time_ms": 441.806}, "counters": {"num_env_steps_sampled": 7039186, "num_env_steps_trained": 7039186, "num_agent_steps_sampled": 7039186, "num_agent_steps_trained": 7039186}, "done": false, "episodes_total": 1498, "training_iteration": 455, "trial_id": "2f030_00000", "date": "2025-06-07_09-16-50", "timestamp": 1749280610, "time_this_iter_s": 55.683043479919434, "time_total_s": 6022.3435826301575, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6022.3435826301575, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 77.2296875, "ram_util_percent": 69.178125, "gpu_util_percent0": 0.07703125, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.3374847368421065e-05, "total_loss": -0.05533310519954698, "policy_loss": -0.02742762531111525, "vf_loss": 0.013385971467095343, "vf_explained_var": 0.7374212352796035, "kl": 0.013603789033209482, "entropy": 20.802999132329766, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 59125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7054824, "num_env_steps_trained": 7054824, "num_agent_steps_sampled": 7054824, "num_agent_steps_trained": 7054824}, "sampler_results": {"episode_reward_max": 10.15664550994915, "episode_reward_min": -0.9650409550714458, "episode_reward_mean": 6.504227759197072, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.221419499034341, 3.871888553099614, 3.6505889316548954, 9.354129856645365, 7.648754095202426, 1.5627047618899608, 6.11929870413704, 1.6849595362769338, 9.640759124821793, 5.178621610615089, 6.7369610148446215, 6.111635526636909, 5.800693065414483, 6.180625530021452, 3.744763380597479, 5.184886272458018, 6.254619432599161, 4.3538309215635165, 5.468503077493973, 8.289113816546836, 8.793058943086946, 3.737012309891754, -0.9650409550714458, 4.642811214890394, 7.3181581939381415, 2.8388719938999474, 6.437146256455983, 7.218075267637503, 8.463321837399869, 8.66143337592131, 6.904809423756822, 5.458780243518358, 7.104933315409197, 6.617727894109888, 5.916587786956445, 0.2506276115359083, 8.429209909238743, 7.860639471745731, 10.137888722972141, 1.5723574027101659, 4.099919623058259, 8.69199190175166, 6.120233267843275, 7.169972868868776, 4.7115150702244435, 7.834014603579077, 9.922340299563954, 9.373104190284632, 7.605882672008621, 8.549066260464075, 7.749236826628332, 7.055189228011666, 6.891220319132828, 5.906598325291339, 7.051631346497456, 7.451279397788782, 8.883573952539818, 5.816871765517545, 9.390108759961086, 7.6899902329241066, 6.742254158545921, 8.996079498166022, 8.873877944468715, 6.6079885812805434, 4.796987213196337, 9.681328793853021, 3.0894683909075478, 2.2808156535184327, 6.598607155442604, 5.647652556122997, 7.787372164793852, 7.500371538248245, 9.753878352537615, 7.6880113734278615, 5.484324219747716, 6.5034658944150765, 4.937649101333519, 2.8965249711697183, 6.623217700280974, 9.143889871030442, 5.123323472006372, 7.554797923389925, 8.436370100621462, 6.355251833976412, 6.291868218330559, 8.846311103325299, 10.15664550994915, 6.1392960916856705, 8.41328329019124, 7.148009280054292, 6.799655251685951, 6.907606076020782, 6.095379026944115, 7.659517972821077, 4.358322920286273, 6.690604854938795, 7.232200581949844, 7.474513401743455, 5.244572664097474, 8.440573369704287], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8482750175979414, "mean_inference_ms": 8.062794224367503, "mean_action_processing_ms": 0.5413438930701107, "mean_env_wait_ms": 23.959823477856265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034674882888793945, "StateBufferConnector_ms": 0.04172992706298828, "ViewRequirementAgentConnector_ms": 0.9377760887145996}}, "episode_reward_max": 10.15664550994915, "episode_reward_min": -0.9650409550714458, "episode_reward_mean": 6.504227759197072, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.221419499034341, 3.871888553099614, 3.6505889316548954, 9.354129856645365, 7.648754095202426, 1.5627047618899608, 6.11929870413704, 1.6849595362769338, 9.640759124821793, 5.178621610615089, 6.7369610148446215, 6.111635526636909, 5.800693065414483, 6.180625530021452, 3.744763380597479, 5.184886272458018, 6.254619432599161, 4.3538309215635165, 5.468503077493973, 8.289113816546836, 8.793058943086946, 3.737012309891754, -0.9650409550714458, 4.642811214890394, 7.3181581939381415, 2.8388719938999474, 6.437146256455983, 7.218075267637503, 8.463321837399869, 8.66143337592131, 6.904809423756822, 5.458780243518358, 7.104933315409197, 6.617727894109888, 5.916587786956445, 0.2506276115359083, 8.429209909238743, 7.860639471745731, 10.137888722972141, 1.5723574027101659, 4.099919623058259, 8.69199190175166, 6.120233267843275, 7.169972868868776, 4.7115150702244435, 7.834014603579077, 9.922340299563954, 9.373104190284632, 7.605882672008621, 8.549066260464075, 7.749236826628332, 7.055189228011666, 6.891220319132828, 5.906598325291339, 7.051631346497456, 7.451279397788782, 8.883573952539818, 5.816871765517545, 9.390108759961086, 7.6899902329241066, 6.742254158545921, 8.996079498166022, 8.873877944468715, 6.6079885812805434, 4.796987213196337, 9.681328793853021, 3.0894683909075478, 2.2808156535184327, 6.598607155442604, 5.647652556122997, 7.787372164793852, 7.500371538248245, 9.753878352537615, 7.6880113734278615, 5.484324219747716, 6.5034658944150765, 4.937649101333519, 2.8965249711697183, 6.623217700280974, 9.143889871030442, 5.123323472006372, 7.554797923389925, 8.436370100621462, 6.355251833976412, 6.291868218330559, 8.846311103325299, 10.15664550994915, 6.1392960916856705, 8.41328329019124, 7.148009280054292, 6.799655251685951, 6.907606076020782, 6.095379026944115, 7.659517972821077, 4.358322920286273, 6.690604854938795, 7.232200581949844, 7.474513401743455, 5.244572664097474, 8.440573369704287], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8482750175979414, "mean_inference_ms": 8.062794224367503, "mean_action_processing_ms": 0.5413438930701107, "mean_env_wait_ms": 23.959823477856265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034674882888793945, "StateBufferConnector_ms": 0.04172992706298828, "ViewRequirementAgentConnector_ms": 0.9377760887145996}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7054824, "num_agent_steps_trained": 7054824, "num_env_steps_sampled": 7054824, "num_env_steps_trained": 7054824, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.1585987475295, "num_env_steps_trained_throughput_per_sec": 283.1585987475295, "timesteps_total": 7054824, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7054824, "timers": {"training_iteration_time_ms": 55086.809, "sample_time_ms": 41972.048, "load_time_ms": 1767.87, "load_throughput": 8845.673, "learn_time_ms": 10784.538, "learn_throughput": 1450.039, "synch_weights_time_ms": 440.523}, "counters": {"num_env_steps_sampled": 7054824, "num_env_steps_trained": 7054824, "num_agent_steps_sampled": 7054824, "num_agent_steps_trained": 7054824}, "done": false, "episodes_total": 1512, "training_iteration": 456, "trial_id": "2f030_00000", "date": "2025-06-07_09-17-45", "timestamp": 1749280665, "time_this_iter_s": 55.24352145195007, "time_total_s": 6077.5871040821075, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6077.5871040821075, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 77.42222222222222, "ram_util_percent": 69.06190476190476, "gpu_util_percent0": 0.07984126984126985, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.325138947368422e-05, "total_loss": -0.05211386979726905, "policy_loss": -0.02447118618652563, "vf_loss": 0.015410417673940009, "vf_explained_var": 0.7152525380524722, "kl": 0.013185079146022486, "entropy": 20.826225594607266, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 59675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7070462, "num_env_steps_trained": 7070462, "num_agent_steps_sampled": 7070462, "num_agent_steps_trained": 7070462}, "sampler_results": {"episode_reward_max": 10.875385424916399, "episode_reward_min": -0.9650409550714458, "episode_reward_mean": 6.60025864554904, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.744763380597479, 5.184886272458018, 6.254619432599161, 4.3538309215635165, 5.468503077493973, 8.289113816546836, 8.793058943086946, 3.737012309891754, -0.9650409550714458, 4.642811214890394, 7.3181581939381415, 2.8388719938999474, 6.437146256455983, 7.218075267637503, 8.463321837399869, 8.66143337592131, 6.904809423756822, 5.458780243518358, 7.104933315409197, 6.617727894109888, 5.916587786956445, 0.2506276115359083, 8.429209909238743, 7.860639471745731, 10.137888722972141, 1.5723574027101659, 4.099919623058259, 8.69199190175166, 6.120233267843275, 7.169972868868776, 4.7115150702244435, 7.834014603579077, 9.922340299563954, 9.373104190284632, 7.605882672008621, 8.549066260464075, 7.749236826628332, 7.055189228011666, 6.891220319132828, 5.906598325291339, 7.051631346497456, 7.451279397788782, 8.883573952539818, 5.816871765517545, 9.390108759961086, 7.6899902329241066, 6.742254158545921, 8.996079498166022, 8.873877944468715, 6.6079885812805434, 4.796987213196337, 9.681328793853021, 3.0894683909075478, 2.2808156535184327, 6.598607155442604, 5.647652556122997, 7.787372164793852, 7.500371538248245, 9.753878352537615, 7.6880113734278615, 5.484324219747716, 6.5034658944150765, 4.937649101333519, 2.8965249711697183, 6.623217700280974, 9.143889871030442, 5.123323472006372, 7.554797923389925, 8.436370100621462, 6.355251833976412, 6.291868218330559, 8.846311103325299, 10.15664550994915, 6.1392960916856705, 8.41328329019124, 7.148009280054292, 6.799655251685951, 6.907606076020782, 6.095379026944115, 7.659517972821077, 4.358322920286273, 6.690604854938795, 7.232200581949844, 7.474513401743455, 5.244572664097474, 8.440573369704287, 10.875385424916399, 3.1025412886018016, 9.053049152271937, 5.617074431986214, 6.13185655525631, 2.578083739075444, 3.6852363339427443, 7.132213182946232, 10.38456446280627, 6.763221244874365, 6.75964743394847, 5.3764291968348745, 6.324427284856942, 4.582398713174068], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8472678713187687, "mean_inference_ms": 8.064186547352346, "mean_action_processing_ms": 0.541447270799883, "mean_env_wait_ms": 23.962597017755616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03570723533630371, "StateBufferConnector_ms": 0.04364752769470215, "ViewRequirementAgentConnector_ms": 0.9429323673248291}}, "episode_reward_max": 10.875385424916399, "episode_reward_min": -0.9650409550714458, "episode_reward_mean": 6.60025864554904, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.744763380597479, 5.184886272458018, 6.254619432599161, 4.3538309215635165, 5.468503077493973, 8.289113816546836, 8.793058943086946, 3.737012309891754, -0.9650409550714458, 4.642811214890394, 7.3181581939381415, 2.8388719938999474, 6.437146256455983, 7.218075267637503, 8.463321837399869, 8.66143337592131, 6.904809423756822, 5.458780243518358, 7.104933315409197, 6.617727894109888, 5.916587786956445, 0.2506276115359083, 8.429209909238743, 7.860639471745731, 10.137888722972141, 1.5723574027101659, 4.099919623058259, 8.69199190175166, 6.120233267843275, 7.169972868868776, 4.7115150702244435, 7.834014603579077, 9.922340299563954, 9.373104190284632, 7.605882672008621, 8.549066260464075, 7.749236826628332, 7.055189228011666, 6.891220319132828, 5.906598325291339, 7.051631346497456, 7.451279397788782, 8.883573952539818, 5.816871765517545, 9.390108759961086, 7.6899902329241066, 6.742254158545921, 8.996079498166022, 8.873877944468715, 6.6079885812805434, 4.796987213196337, 9.681328793853021, 3.0894683909075478, 2.2808156535184327, 6.598607155442604, 5.647652556122997, 7.787372164793852, 7.500371538248245, 9.753878352537615, 7.6880113734278615, 5.484324219747716, 6.5034658944150765, 4.937649101333519, 2.8965249711697183, 6.623217700280974, 9.143889871030442, 5.123323472006372, 7.554797923389925, 8.436370100621462, 6.355251833976412, 6.291868218330559, 8.846311103325299, 10.15664550994915, 6.1392960916856705, 8.41328329019124, 7.148009280054292, 6.799655251685951, 6.907606076020782, 6.095379026944115, 7.659517972821077, 4.358322920286273, 6.690604854938795, 7.232200581949844, 7.474513401743455, 5.244572664097474, 8.440573369704287, 10.875385424916399, 3.1025412886018016, 9.053049152271937, 5.617074431986214, 6.13185655525631, 2.578083739075444, 3.6852363339427443, 7.132213182946232, 10.38456446280627, 6.763221244874365, 6.75964743394847, 5.3764291968348745, 6.324427284856942, 4.582398713174068], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8472678713187687, "mean_inference_ms": 8.064186547352346, "mean_action_processing_ms": 0.541447270799883, "mean_env_wait_ms": 23.962597017755616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03570723533630371, "StateBufferConnector_ms": 0.04364752769470215, "ViewRequirementAgentConnector_ms": 0.9429323673248291}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7070462, "num_agent_steps_trained": 7070462, "num_env_steps_sampled": 7070462, "num_env_steps_trained": 7070462, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.18923836409226, "num_env_steps_trained_throughput_per_sec": 281.18923836409226, "timesteps_total": 7070462, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7070462, "timers": {"training_iteration_time_ms": 55164.162, "sample_time_ms": 42055.887, "load_time_ms": 1769.744, "load_throughput": 8836.306, "learn_time_ms": 10789.125, "learn_throughput": 1449.422, "synch_weights_time_ms": 429.703}, "counters": {"num_env_steps_sampled": 7070462, "num_env_steps_trained": 7070462, "num_agent_steps_sampled": 7070462, "num_agent_steps_trained": 7070462}, "done": false, "episodes_total": 1526, "training_iteration": 457, "trial_id": "2f030_00000", "date": "2025-06-07_09-18-41", "timestamp": 1749280721, "time_this_iter_s": 55.64553499221802, "time_total_s": 6133.232639074326, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6133.232639074326, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 78.5640625, "ram_util_percent": 69.1953125, "gpu_util_percent0": 0.07296875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.3127931578947354e-05, "total_loss": -0.05052643054715273, "policy_loss": -0.02274180483475158, "vf_loss": 0.01572653622112491, "vf_explained_var": 0.7157175184379925, "kl": 0.012893730160550728, "entropy": 20.84090675354004, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 60225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7086100, "num_env_steps_trained": 7086100, "num_agent_steps_sampled": 7086100, "num_agent_steps_trained": 7086100}, "sampler_results": {"episode_reward_max": 10.875385424916399, "episode_reward_min": -1.977661430271613, "episode_reward_mean": 6.690800160542448, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.463321837399869, 8.66143337592131, 6.904809423756822, 5.458780243518358, 7.104933315409197, 6.617727894109888, 5.916587786956445, 0.2506276115359083, 8.429209909238743, 7.860639471745731, 10.137888722972141, 1.5723574027101659, 4.099919623058259, 8.69199190175166, 6.120233267843275, 7.169972868868776, 4.7115150702244435, 7.834014603579077, 9.922340299563954, 9.373104190284632, 7.605882672008621, 8.549066260464075, 7.749236826628332, 7.055189228011666, 6.891220319132828, 5.906598325291339, 7.051631346497456, 7.451279397788782, 8.883573952539818, 5.816871765517545, 9.390108759961086, 7.6899902329241066, 6.742254158545921, 8.996079498166022, 8.873877944468715, 6.6079885812805434, 4.796987213196337, 9.681328793853021, 3.0894683909075478, 2.2808156535184327, 6.598607155442604, 5.647652556122997, 7.787372164793852, 7.500371538248245, 9.753878352537615, 7.6880113734278615, 5.484324219747716, 6.5034658944150765, 4.937649101333519, 2.8965249711697183, 6.623217700280974, 9.143889871030442, 5.123323472006372, 7.554797923389925, 8.436370100621462, 6.355251833976412, 6.291868218330559, 8.846311103325299, 10.15664550994915, 6.1392960916856705, 8.41328329019124, 7.148009280054292, 6.799655251685951, 6.907606076020782, 6.095379026944115, 7.659517972821077, 4.358322920286273, 6.690604854938795, 7.232200581949844, 7.474513401743455, 5.244572664097474, 8.440573369704287, 10.875385424916399, 3.1025412886018016, 9.053049152271937, 5.617074431986214, 6.13185655525631, 2.578083739075444, 3.6852363339427443, 7.132213182946232, 10.38456446280627, 6.763221244874365, 6.75964743394847, 5.3764291968348745, 6.324427284856942, 4.582398713174068, -1.977661430271613, 4.3033151255039765, 5.271271914070591, 5.989118824591997, 6.6156856808706985, 5.610087887535789, 9.512457794750892, 5.564007412858982, 8.230129228700848, 7.086521854301078, 7.402789803158533, 7.881460418598923, 0.028722423755012577, 10.852054686903072], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.846157795415615, "mean_inference_ms": 8.065886560435752, "mean_action_processing_ms": 0.5415583543089483, "mean_env_wait_ms": 23.965734046323327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05731797218322754, "StateBufferConnector_ms": 0.046556711196899414, "ViewRequirementAgentConnector_ms": 0.9295094013214111}}, "episode_reward_max": 10.875385424916399, "episode_reward_min": -1.977661430271613, "episode_reward_mean": 6.690800160542448, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.463321837399869, 8.66143337592131, 6.904809423756822, 5.458780243518358, 7.104933315409197, 6.617727894109888, 5.916587786956445, 0.2506276115359083, 8.429209909238743, 7.860639471745731, 10.137888722972141, 1.5723574027101659, 4.099919623058259, 8.69199190175166, 6.120233267843275, 7.169972868868776, 4.7115150702244435, 7.834014603579077, 9.922340299563954, 9.373104190284632, 7.605882672008621, 8.549066260464075, 7.749236826628332, 7.055189228011666, 6.891220319132828, 5.906598325291339, 7.051631346497456, 7.451279397788782, 8.883573952539818, 5.816871765517545, 9.390108759961086, 7.6899902329241066, 6.742254158545921, 8.996079498166022, 8.873877944468715, 6.6079885812805434, 4.796987213196337, 9.681328793853021, 3.0894683909075478, 2.2808156535184327, 6.598607155442604, 5.647652556122997, 7.787372164793852, 7.500371538248245, 9.753878352537615, 7.6880113734278615, 5.484324219747716, 6.5034658944150765, 4.937649101333519, 2.8965249711697183, 6.623217700280974, 9.143889871030442, 5.123323472006372, 7.554797923389925, 8.436370100621462, 6.355251833976412, 6.291868218330559, 8.846311103325299, 10.15664550994915, 6.1392960916856705, 8.41328329019124, 7.148009280054292, 6.799655251685951, 6.907606076020782, 6.095379026944115, 7.659517972821077, 4.358322920286273, 6.690604854938795, 7.232200581949844, 7.474513401743455, 5.244572664097474, 8.440573369704287, 10.875385424916399, 3.1025412886018016, 9.053049152271937, 5.617074431986214, 6.13185655525631, 2.578083739075444, 3.6852363339427443, 7.132213182946232, 10.38456446280627, 6.763221244874365, 6.75964743394847, 5.3764291968348745, 6.324427284856942, 4.582398713174068, -1.977661430271613, 4.3033151255039765, 5.271271914070591, 5.989118824591997, 6.6156856808706985, 5.610087887535789, 9.512457794750892, 5.564007412858982, 8.230129228700848, 7.086521854301078, 7.402789803158533, 7.881460418598923, 0.028722423755012577, 10.852054686903072], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.846157795415615, "mean_inference_ms": 8.065886560435752, "mean_action_processing_ms": 0.5415583543089483, "mean_env_wait_ms": 23.965734046323327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05731797218322754, "StateBufferConnector_ms": 0.046556711196899414, "ViewRequirementAgentConnector_ms": 0.9295094013214111}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7086100, "num_agent_steps_trained": 7086100, "num_env_steps_sampled": 7086100, "num_env_steps_trained": 7086100, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.5850987416242, "num_env_steps_trained_throughput_per_sec": 283.5850987416242, "timesteps_total": 7086100, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7086100, "timers": {"training_iteration_time_ms": 55220.858, "sample_time_ms": 42130.162, "load_time_ms": 1764.18, "load_throughput": 8864.177, "learn_time_ms": 10776.158, "learn_throughput": 1451.167, "synch_weights_time_ms": 432.731}, "counters": {"num_env_steps_sampled": 7086100, "num_env_steps_trained": 7086100, "num_agent_steps_sampled": 7086100, "num_agent_steps_trained": 7086100}, "done": false, "episodes_total": 1540, "training_iteration": 458, "trial_id": "2f030_00000", "date": "2025-06-07_09-19-36", "timestamp": 1749280776, "time_this_iter_s": 55.16392660140991, "time_total_s": 6188.3965656757355, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6188.3965656757355, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 77.59523809523809, "ram_util_percent": 69.23650793650793, "gpu_util_percent0": 0.08047619047619048, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.3004473684210525e-05, "total_loss": -0.05317963177253577, "policy_loss": -0.025642387897751178, "vf_loss": 0.016003970097411762, "vf_explained_var": 0.7049860306219621, "kl": 0.013207420688774285, "entropy": 20.870490545793015, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 60775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7101738, "num_env_steps_trained": 7101738, "num_agent_steps_sampled": 7101738, "num_agent_steps_trained": 7101738}, "sampler_results": {"episode_reward_max": 10.875385424916399, "episode_reward_min": -1.977661430271613, "episode_reward_mean": 6.6475302264783025, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.120233267843275, 7.169972868868776, 4.7115150702244435, 7.834014603579077, 9.922340299563954, 9.373104190284632, 7.605882672008621, 8.549066260464075, 7.749236826628332, 7.055189228011666, 6.891220319132828, 5.906598325291339, 7.051631346497456, 7.451279397788782, 8.883573952539818, 5.816871765517545, 9.390108759961086, 7.6899902329241066, 6.742254158545921, 8.996079498166022, 8.873877944468715, 6.6079885812805434, 4.796987213196337, 9.681328793853021, 3.0894683909075478, 2.2808156535184327, 6.598607155442604, 5.647652556122997, 7.787372164793852, 7.500371538248245, 9.753878352537615, 7.6880113734278615, 5.484324219747716, 6.5034658944150765, 4.937649101333519, 2.8965249711697183, 6.623217700280974, 9.143889871030442, 5.123323472006372, 7.554797923389925, 8.436370100621462, 6.355251833976412, 6.291868218330559, 8.846311103325299, 10.15664550994915, 6.1392960916856705, 8.41328329019124, 7.148009280054292, 6.799655251685951, 6.907606076020782, 6.095379026944115, 7.659517972821077, 4.358322920286273, 6.690604854938795, 7.232200581949844, 7.474513401743455, 5.244572664097474, 8.440573369704287, 10.875385424916399, 3.1025412886018016, 9.053049152271937, 5.617074431986214, 6.13185655525631, 2.578083739075444, 3.6852363339427443, 7.132213182946232, 10.38456446280627, 6.763221244874365, 6.75964743394847, 5.3764291968348745, 6.324427284856942, 4.582398713174068, -1.977661430271613, 4.3033151255039765, 5.271271914070591, 5.989118824591997, 6.6156856808706985, 5.610087887535789, 9.512457794750892, 5.564007412858982, 8.230129228700848, 7.086521854301078, 7.402789803158533, 7.881460418598923, 0.028722423755012577, 10.852054686903072, 6.3837429251248485, 10.348817280407824, 4.271096033604185, 5.589326890144565, 8.89370163432293, 5.0931207972457555, 5.9350140818320964, 6.823850091231646, 9.932668013752986, 5.605077257041081, 5.427904646933236, 4.7236981705735595, 0.9339534777888842, 5.881263813666221], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8448126755592638, "mean_inference_ms": 8.06760752166262, "mean_action_processing_ms": 0.5417281431335438, "mean_env_wait_ms": 23.969539879978758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06031346321105957, "StateBufferConnector_ms": 0.043248653411865234, "ViewRequirementAgentConnector_ms": 0.9276952743530273}}, "episode_reward_max": 10.875385424916399, "episode_reward_min": -1.977661430271613, "episode_reward_mean": 6.6475302264783025, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.120233267843275, 7.169972868868776, 4.7115150702244435, 7.834014603579077, 9.922340299563954, 9.373104190284632, 7.605882672008621, 8.549066260464075, 7.749236826628332, 7.055189228011666, 6.891220319132828, 5.906598325291339, 7.051631346497456, 7.451279397788782, 8.883573952539818, 5.816871765517545, 9.390108759961086, 7.6899902329241066, 6.742254158545921, 8.996079498166022, 8.873877944468715, 6.6079885812805434, 4.796987213196337, 9.681328793853021, 3.0894683909075478, 2.2808156535184327, 6.598607155442604, 5.647652556122997, 7.787372164793852, 7.500371538248245, 9.753878352537615, 7.6880113734278615, 5.484324219747716, 6.5034658944150765, 4.937649101333519, 2.8965249711697183, 6.623217700280974, 9.143889871030442, 5.123323472006372, 7.554797923389925, 8.436370100621462, 6.355251833976412, 6.291868218330559, 8.846311103325299, 10.15664550994915, 6.1392960916856705, 8.41328329019124, 7.148009280054292, 6.799655251685951, 6.907606076020782, 6.095379026944115, 7.659517972821077, 4.358322920286273, 6.690604854938795, 7.232200581949844, 7.474513401743455, 5.244572664097474, 8.440573369704287, 10.875385424916399, 3.1025412886018016, 9.053049152271937, 5.617074431986214, 6.13185655525631, 2.578083739075444, 3.6852363339427443, 7.132213182946232, 10.38456446280627, 6.763221244874365, 6.75964743394847, 5.3764291968348745, 6.324427284856942, 4.582398713174068, -1.977661430271613, 4.3033151255039765, 5.271271914070591, 5.989118824591997, 6.6156856808706985, 5.610087887535789, 9.512457794750892, 5.564007412858982, 8.230129228700848, 7.086521854301078, 7.402789803158533, 7.881460418598923, 0.028722423755012577, 10.852054686903072, 6.3837429251248485, 10.348817280407824, 4.271096033604185, 5.589326890144565, 8.89370163432293, 5.0931207972457555, 5.9350140818320964, 6.823850091231646, 9.932668013752986, 5.605077257041081, 5.427904646933236, 4.7236981705735595, 0.9339534777888842, 5.881263813666221], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8448126755592638, "mean_inference_ms": 8.06760752166262, "mean_action_processing_ms": 0.5417281431335438, "mean_env_wait_ms": 23.969539879978758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06031346321105957, "StateBufferConnector_ms": 0.043248653411865234, "ViewRequirementAgentConnector_ms": 0.9276952743530273}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7101738, "num_agent_steps_trained": 7101738, "num_env_steps_sampled": 7101738, "num_env_steps_trained": 7101738, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.56389045155703, "num_env_steps_trained_throughput_per_sec": 280.56389045155703, "timesteps_total": 7101738, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7101738, "timers": {"training_iteration_time_ms": 55257.887, "sample_time_ms": 42164.621, "load_time_ms": 1778.002, "load_throughput": 8795.265, "learn_time_ms": 10766.464, "learn_throughput": 1452.473, "synch_weights_time_ms": 427.521}, "counters": {"num_env_steps_sampled": 7101738, "num_env_steps_trained": 7101738, "num_agent_steps_sampled": 7101738, "num_agent_steps_trained": 7101738}, "done": false, "episodes_total": 1554, "training_iteration": 459, "trial_id": "2f030_00000", "date": "2025-06-07_09-20-32", "timestamp": 1749280832, "time_this_iter_s": 55.74035167694092, "time_total_s": 6244.136917352676, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6244.136917352676, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 77.821875, "ram_util_percent": 69.3328125, "gpu_util_percent0": 0.07703125, "vram_util_percent0": 0.8592122395833333}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3.0459500194117646, "episode_reward_min": -6.672276229808662, "episode_reward_mean": -4.735777134035226, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.794212348694434, -4.567496832368742, -6.672276229808662, -4.598950239892524, -3.0459500194117646], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.431698147428499, "mean_inference_ms": 3.8730880076357685, "mean_action_processing_ms": 0.2790727581669915, "mean_env_wait_ms": 10.479334374396615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3920459747314453}}, "episode_reward_max": -3.0459500194117646, "episode_reward_min": -6.672276229808662, "episode_reward_mean": -4.735777134035226, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.794212348694434, -4.567496832368742, -6.672276229808662, -4.598950239892524, -3.0459500194117646], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.431698147428499, "mean_inference_ms": 3.8730880076357685, "mean_action_processing_ms": 0.2790727581669915, "mean_env_wait_ms": 10.479334374396615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3920459747314453}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.288101578947369e-05, "total_loss": -0.053762898743999275, "policy_loss": -0.02593937852202957, "vf_loss": 0.013765141665935517, "vf_explained_var": 0.7197323379733346, "kl": 0.01336361869536175, "entropy": 20.733404704007235, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 61325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7117376, "num_env_steps_trained": 7117376, "num_agent_steps_sampled": 7117376, "num_agent_steps_trained": 7117376}, "sampler_results": {"episode_reward_max": 10.875385424916399, "episode_reward_min": -1.977661430271613, "episode_reward_mean": 6.542286730417938, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.883573952539818, 5.816871765517545, 9.390108759961086, 7.6899902329241066, 6.742254158545921, 8.996079498166022, 8.873877944468715, 6.6079885812805434, 4.796987213196337, 9.681328793853021, 3.0894683909075478, 2.2808156535184327, 6.598607155442604, 5.647652556122997, 7.787372164793852, 7.500371538248245, 9.753878352537615, 7.6880113734278615, 5.484324219747716, 6.5034658944150765, 4.937649101333519, 2.8965249711697183, 6.623217700280974, 9.143889871030442, 5.123323472006372, 7.554797923389925, 8.436370100621462, 6.355251833976412, 6.291868218330559, 8.846311103325299, 10.15664550994915, 6.1392960916856705, 8.41328329019124, 7.148009280054292, 6.799655251685951, 6.907606076020782, 6.095379026944115, 7.659517972821077, 4.358322920286273, 6.690604854938795, 7.232200581949844, 7.474513401743455, 5.244572664097474, 8.440573369704287, 10.875385424916399, 3.1025412886018016, 9.053049152271937, 5.617074431986214, 6.13185655525631, 2.578083739075444, 3.6852363339427443, 7.132213182946232, 10.38456446280627, 6.763221244874365, 6.75964743394847, 5.3764291968348745, 6.324427284856942, 4.582398713174068, -1.977661430271613, 4.3033151255039765, 5.271271914070591, 5.989118824591997, 6.6156856808706985, 5.610087887535789, 9.512457794750892, 5.564007412858982, 8.230129228700848, 7.086521854301078, 7.402789803158533, 7.881460418598923, 0.028722423755012577, 10.852054686903072, 6.3837429251248485, 10.348817280407824, 4.271096033604185, 5.589326890144565, 8.89370163432293, 5.0931207972457555, 5.9350140818320964, 6.823850091231646, 9.932668013752986, 5.605077257041081, 5.427904646933236, 4.7236981705735595, 0.9339534777888842, 5.881263813666221, 5.239709429068426, 2.1737358041848047, 10.351449721574928, 6.6064360987225035, 5.619140636664346, 6.798616462134177, 6.984301730237135, 5.470195210991381, 6.9591453288160645, 7.081294293806502, 9.37029914998101, 7.413796692451872, 7.673519993392288, 5.1252945181255605], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.843295034531536, "mean_inference_ms": 8.069479123889517, "mean_action_processing_ms": 0.5419059499050016, "mean_env_wait_ms": 23.973168231140136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.060353994369506836, "StateBufferConnector_ms": 0.03618931770324707, "ViewRequirementAgentConnector_ms": 0.9151527881622314}}, "episode_reward_max": 10.875385424916399, "episode_reward_min": -1.977661430271613, "episode_reward_mean": 6.542286730417938, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.883573952539818, 5.816871765517545, 9.390108759961086, 7.6899902329241066, 6.742254158545921, 8.996079498166022, 8.873877944468715, 6.6079885812805434, 4.796987213196337, 9.681328793853021, 3.0894683909075478, 2.2808156535184327, 6.598607155442604, 5.647652556122997, 7.787372164793852, 7.500371538248245, 9.753878352537615, 7.6880113734278615, 5.484324219747716, 6.5034658944150765, 4.937649101333519, 2.8965249711697183, 6.623217700280974, 9.143889871030442, 5.123323472006372, 7.554797923389925, 8.436370100621462, 6.355251833976412, 6.291868218330559, 8.846311103325299, 10.15664550994915, 6.1392960916856705, 8.41328329019124, 7.148009280054292, 6.799655251685951, 6.907606076020782, 6.095379026944115, 7.659517972821077, 4.358322920286273, 6.690604854938795, 7.232200581949844, 7.474513401743455, 5.244572664097474, 8.440573369704287, 10.875385424916399, 3.1025412886018016, 9.053049152271937, 5.617074431986214, 6.13185655525631, 2.578083739075444, 3.6852363339427443, 7.132213182946232, 10.38456446280627, 6.763221244874365, 6.75964743394847, 5.3764291968348745, 6.324427284856942, 4.582398713174068, -1.977661430271613, 4.3033151255039765, 5.271271914070591, 5.989118824591997, 6.6156856808706985, 5.610087887535789, 9.512457794750892, 5.564007412858982, 8.230129228700848, 7.086521854301078, 7.402789803158533, 7.881460418598923, 0.028722423755012577, 10.852054686903072, 6.3837429251248485, 10.348817280407824, 4.271096033604185, 5.589326890144565, 8.89370163432293, 5.0931207972457555, 5.9350140818320964, 6.823850091231646, 9.932668013752986, 5.605077257041081, 5.427904646933236, 4.7236981705735595, 0.9339534777888842, 5.881263813666221, 5.239709429068426, 2.1737358041848047, 10.351449721574928, 6.6064360987225035, 5.619140636664346, 6.798616462134177, 6.984301730237135, 5.470195210991381, 6.9591453288160645, 7.081294293806502, 9.37029914998101, 7.413796692451872, 7.673519993392288, 5.1252945181255605], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.843295034531536, "mean_inference_ms": 8.069479123889517, "mean_action_processing_ms": 0.5419059499050016, "mean_env_wait_ms": 23.973168231140136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.060353994369506836, "StateBufferConnector_ms": 0.03618931770324707, "ViewRequirementAgentConnector_ms": 0.9151527881622314}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7117376, "num_agent_steps_trained": 7117376, "num_env_steps_sampled": 7117376, "num_env_steps_trained": 7117376, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.67889939178633, "num_env_steps_trained_throughput_per_sec": 283.67889939178633, "timesteps_total": 7117376, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7117376, "timers": {"training_iteration_time_ms": 55273.243, "sample_time_ms": 42187.345, "load_time_ms": 1763.462, "load_throughput": 8867.781, "learn_time_ms": 10764.378, "learn_throughput": 1452.755, "synch_weights_time_ms": 436.176}, "counters": {"num_env_steps_sampled": 7117376, "num_env_steps_trained": 7117376, "num_agent_steps_sampled": 7117376, "num_agent_steps_trained": 7117376}, "done": false, "episodes_total": 1568, "training_iteration": 460, "trial_id": "2f030_00000", "date": "2025-06-07_09-21-42", "timestamp": 1749280902, "time_this_iter_s": 69.78259301185608, "time_total_s": 6313.9195103645325, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6313.9195103645325, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 65.45185185185186, "ram_util_percent": 69.16913580246913, "gpu_util_percent0": 0.061975308641975306, "vram_util_percent0": 0.8592122395833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.275755789473684e-05, "total_loss": -0.054961843743750995, "policy_loss": -0.027716305802089416, "vf_loss": 0.015335930487649007, "vf_explained_var": 0.7219036848978563, "kl": 0.013482948383595815, "entropy": 20.722508333379572, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 61875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7133014, "num_env_steps_trained": 7133014, "num_agent_steps_sampled": 7133014, "num_agent_steps_trained": 7133014}, "sampler_results": {"episode_reward_max": 10.875385424916399, "episode_reward_min": -1.977661430271613, "episode_reward_mean": 6.585194972509011, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.787372164793852, 7.500371538248245, 9.753878352537615, 7.6880113734278615, 5.484324219747716, 6.5034658944150765, 4.937649101333519, 2.8965249711697183, 6.623217700280974, 9.143889871030442, 5.123323472006372, 7.554797923389925, 8.436370100621462, 6.355251833976412, 6.291868218330559, 8.846311103325299, 10.15664550994915, 6.1392960916856705, 8.41328329019124, 7.148009280054292, 6.799655251685951, 6.907606076020782, 6.095379026944115, 7.659517972821077, 4.358322920286273, 6.690604854938795, 7.232200581949844, 7.474513401743455, 5.244572664097474, 8.440573369704287, 10.875385424916399, 3.1025412886018016, 9.053049152271937, 5.617074431986214, 6.13185655525631, 2.578083739075444, 3.6852363339427443, 7.132213182946232, 10.38456446280627, 6.763221244874365, 6.75964743394847, 5.3764291968348745, 6.324427284856942, 4.582398713174068, -1.977661430271613, 4.3033151255039765, 5.271271914070591, 5.989118824591997, 6.6156856808706985, 5.610087887535789, 9.512457794750892, 5.564007412858982, 8.230129228700848, 7.086521854301078, 7.402789803158533, 7.881460418598923, 0.028722423755012577, 10.852054686903072, 6.3837429251248485, 10.348817280407824, 4.271096033604185, 5.589326890144565, 8.89370163432293, 5.0931207972457555, 5.9350140818320964, 6.823850091231646, 9.932668013752986, 5.605077257041081, 5.427904646933236, 4.7236981705735595, 0.9339534777888842, 5.881263813666221, 5.239709429068426, 2.1737358041848047, 10.351449721574928, 6.6064360987225035, 5.619140636664346, 6.798616462134177, 6.984301730237135, 5.470195210991381, 6.9591453288160645, 7.081294293806502, 9.37029914998101, 7.413796692451872, 7.673519993392288, 5.1252945181255605, 7.0707786156408075, 5.347445773503118, 7.318888327982817, 7.049601981445447, 5.912281295942163, 7.006380915858816, 7.11498759303747, 7.880785596873773, 6.364172328235061, 10.25946145205501, 4.8385512832589885, 8.826301615111639, 8.209699238656768, 6.187092847950094], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8416726161866155, "mean_inference_ms": 8.071389011268986, "mean_action_processing_ms": 0.542098909838963, "mean_env_wait_ms": 23.976888079814994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05478191375732422, "StateBufferConnector_ms": 0.03220081329345703, "ViewRequirementAgentConnector_ms": 0.9556448459625244}}, "episode_reward_max": 10.875385424916399, "episode_reward_min": -1.977661430271613, "episode_reward_mean": 6.585194972509011, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.787372164793852, 7.500371538248245, 9.753878352537615, 7.6880113734278615, 5.484324219747716, 6.5034658944150765, 4.937649101333519, 2.8965249711697183, 6.623217700280974, 9.143889871030442, 5.123323472006372, 7.554797923389925, 8.436370100621462, 6.355251833976412, 6.291868218330559, 8.846311103325299, 10.15664550994915, 6.1392960916856705, 8.41328329019124, 7.148009280054292, 6.799655251685951, 6.907606076020782, 6.095379026944115, 7.659517972821077, 4.358322920286273, 6.690604854938795, 7.232200581949844, 7.474513401743455, 5.244572664097474, 8.440573369704287, 10.875385424916399, 3.1025412886018016, 9.053049152271937, 5.617074431986214, 6.13185655525631, 2.578083739075444, 3.6852363339427443, 7.132213182946232, 10.38456446280627, 6.763221244874365, 6.75964743394847, 5.3764291968348745, 6.324427284856942, 4.582398713174068, -1.977661430271613, 4.3033151255039765, 5.271271914070591, 5.989118824591997, 6.6156856808706985, 5.610087887535789, 9.512457794750892, 5.564007412858982, 8.230129228700848, 7.086521854301078, 7.402789803158533, 7.881460418598923, 0.028722423755012577, 10.852054686903072, 6.3837429251248485, 10.348817280407824, 4.271096033604185, 5.589326890144565, 8.89370163432293, 5.0931207972457555, 5.9350140818320964, 6.823850091231646, 9.932668013752986, 5.605077257041081, 5.427904646933236, 4.7236981705735595, 0.9339534777888842, 5.881263813666221, 5.239709429068426, 2.1737358041848047, 10.351449721574928, 6.6064360987225035, 5.619140636664346, 6.798616462134177, 6.984301730237135, 5.470195210991381, 6.9591453288160645, 7.081294293806502, 9.37029914998101, 7.413796692451872, 7.673519993392288, 5.1252945181255605, 7.0707786156408075, 5.347445773503118, 7.318888327982817, 7.049601981445447, 5.912281295942163, 7.006380915858816, 7.11498759303747, 7.880785596873773, 6.364172328235061, 10.25946145205501, 4.8385512832589885, 8.826301615111639, 8.209699238656768, 6.187092847950094], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8416726161866155, "mean_inference_ms": 8.071389011268986, "mean_action_processing_ms": 0.542098909838963, "mean_env_wait_ms": 23.976888079814994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05478191375732422, "StateBufferConnector_ms": 0.03220081329345703, "ViewRequirementAgentConnector_ms": 0.9556448459625244}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7133014, "num_agent_steps_trained": 7133014, "num_env_steps_sampled": 7133014, "num_env_steps_trained": 7133014, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.7312110126313, "num_env_steps_trained_throughput_per_sec": 283.7312110126313, "timesteps_total": 7133014, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7133014, "timers": {"training_iteration_time_ms": 55334.438, "sample_time_ms": 42249.764, "load_time_ms": 1758.262, "load_throughput": 8894.009, "learn_time_ms": 10764.063, "learn_throughput": 1452.797, "synch_weights_time_ms": 441.73}, "counters": {"num_env_steps_sampled": 7133014, "num_env_steps_trained": 7133014, "num_agent_steps_sampled": 7133014, "num_agent_steps_trained": 7133014}, "done": false, "episodes_total": 1582, "training_iteration": 461, "trial_id": "2f030_00000", "date": "2025-06-07_09-22-37", "timestamp": 1749280957, "time_this_iter_s": 55.211586713790894, "time_total_s": 6369.131097078323, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6369.131097078323, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 77.28888888888888, "ram_util_percent": 69.48253968253968, "gpu_util_percent0": 0.07761904761904763, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.2634100000000006e-05, "total_loss": -0.04980070892382752, "policy_loss": -0.021684624225464095, "vf_loss": 0.014218350099399686, "vf_explained_var": 0.7261143522912805, "kl": 0.012996012374816839, "entropy": 20.816816281405362, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 62425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7148652, "num_env_steps_trained": 7148652, "num_agent_steps_sampled": 7148652, "num_agent_steps_trained": 7148652}, "sampler_results": {"episode_reward_max": 10.875385424916399, "episode_reward_min": -1.977661430271613, "episode_reward_mean": 6.59096184250183, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.291868218330559, 8.846311103325299, 10.15664550994915, 6.1392960916856705, 8.41328329019124, 7.148009280054292, 6.799655251685951, 6.907606076020782, 6.095379026944115, 7.659517972821077, 4.358322920286273, 6.690604854938795, 7.232200581949844, 7.474513401743455, 5.244572664097474, 8.440573369704287, 10.875385424916399, 3.1025412886018016, 9.053049152271937, 5.617074431986214, 6.13185655525631, 2.578083739075444, 3.6852363339427443, 7.132213182946232, 10.38456446280627, 6.763221244874365, 6.75964743394847, 5.3764291968348745, 6.324427284856942, 4.582398713174068, -1.977661430271613, 4.3033151255039765, 5.271271914070591, 5.989118824591997, 6.6156856808706985, 5.610087887535789, 9.512457794750892, 5.564007412858982, 8.230129228700848, 7.086521854301078, 7.402789803158533, 7.881460418598923, 0.028722423755012577, 10.852054686903072, 6.3837429251248485, 10.348817280407824, 4.271096033604185, 5.589326890144565, 8.89370163432293, 5.0931207972457555, 5.9350140818320964, 6.823850091231646, 9.932668013752986, 5.605077257041081, 5.427904646933236, 4.7236981705735595, 0.9339534777888842, 5.881263813666221, 5.239709429068426, 2.1737358041848047, 10.351449721574928, 6.6064360987225035, 5.619140636664346, 6.798616462134177, 6.984301730237135, 5.470195210991381, 6.9591453288160645, 7.081294293806502, 9.37029914998101, 7.413796692451872, 7.673519993392288, 5.1252945181255605, 7.0707786156408075, 5.347445773503118, 7.318888327982817, 7.049601981445447, 5.912281295942163, 7.006380915858816, 7.11498759303747, 7.880785596873773, 6.364172328235061, 10.25946145205501, 4.8385512832589885, 8.826301615111639, 8.209699238656768, 6.187092847950094, 10.717965628411028, 7.8384408513417965, 3.4530539987779014, 9.251200075386302, 7.470947292359246, 7.9365810336881415, 8.8024494994151, 5.340952893800075, 4.557046773565795, 5.8737777567705685, 5.002720149721029, 7.6402855250840975, 6.194145975936209, 6.285568062003735], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.84020987761048, "mean_inference_ms": 8.073078750309632, "mean_action_processing_ms": 0.5422701989415446, "mean_env_wait_ms": 23.9807506763254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055748939514160156, "StateBufferConnector_ms": 0.03643083572387695, "ViewRequirementAgentConnector_ms": 0.9819936752319336}}, "episode_reward_max": 10.875385424916399, "episode_reward_min": -1.977661430271613, "episode_reward_mean": 6.59096184250183, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.291868218330559, 8.846311103325299, 10.15664550994915, 6.1392960916856705, 8.41328329019124, 7.148009280054292, 6.799655251685951, 6.907606076020782, 6.095379026944115, 7.659517972821077, 4.358322920286273, 6.690604854938795, 7.232200581949844, 7.474513401743455, 5.244572664097474, 8.440573369704287, 10.875385424916399, 3.1025412886018016, 9.053049152271937, 5.617074431986214, 6.13185655525631, 2.578083739075444, 3.6852363339427443, 7.132213182946232, 10.38456446280627, 6.763221244874365, 6.75964743394847, 5.3764291968348745, 6.324427284856942, 4.582398713174068, -1.977661430271613, 4.3033151255039765, 5.271271914070591, 5.989118824591997, 6.6156856808706985, 5.610087887535789, 9.512457794750892, 5.564007412858982, 8.230129228700848, 7.086521854301078, 7.402789803158533, 7.881460418598923, 0.028722423755012577, 10.852054686903072, 6.3837429251248485, 10.348817280407824, 4.271096033604185, 5.589326890144565, 8.89370163432293, 5.0931207972457555, 5.9350140818320964, 6.823850091231646, 9.932668013752986, 5.605077257041081, 5.427904646933236, 4.7236981705735595, 0.9339534777888842, 5.881263813666221, 5.239709429068426, 2.1737358041848047, 10.351449721574928, 6.6064360987225035, 5.619140636664346, 6.798616462134177, 6.984301730237135, 5.470195210991381, 6.9591453288160645, 7.081294293806502, 9.37029914998101, 7.413796692451872, 7.673519993392288, 5.1252945181255605, 7.0707786156408075, 5.347445773503118, 7.318888327982817, 7.049601981445447, 5.912281295942163, 7.006380915858816, 7.11498759303747, 7.880785596873773, 6.364172328235061, 10.25946145205501, 4.8385512832589885, 8.826301615111639, 8.209699238656768, 6.187092847950094, 10.717965628411028, 7.8384408513417965, 3.4530539987779014, 9.251200075386302, 7.470947292359246, 7.9365810336881415, 8.8024494994151, 5.340952893800075, 4.557046773565795, 5.8737777567705685, 5.002720149721029, 7.6402855250840975, 6.194145975936209, 6.285568062003735], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.84020987761048, "mean_inference_ms": 8.073078750309632, "mean_action_processing_ms": 0.5422701989415446, "mean_env_wait_ms": 23.9807506763254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055748939514160156, "StateBufferConnector_ms": 0.03643083572387695, "ViewRequirementAgentConnector_ms": 0.9819936752319336}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7148652, "num_agent_steps_trained": 7148652, "num_env_steps_sampled": 7148652, "num_env_steps_trained": 7148652, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.5820705823864, "num_env_steps_trained_throughput_per_sec": 282.5820705823864, "timesteps_total": 7148652, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7148652, "timers": {"training_iteration_time_ms": 55348.271, "sample_time_ms": 42269.823, "load_time_ms": 1749.902, "load_throughput": 8936.498, "learn_time_ms": 10769.454, "learn_throughput": 1452.07, "synch_weights_time_ms": 440.916}, "counters": {"num_env_steps_sampled": 7148652, "num_env_steps_trained": 7148652, "num_agent_steps_sampled": 7148652, "num_agent_steps_trained": 7148652}, "done": false, "episodes_total": 1596, "training_iteration": 462, "trial_id": "2f030_00000", "date": "2025-06-07_09-23-33", "timestamp": 1749281013, "time_this_iter_s": 55.36570429801941, "time_total_s": 6424.496801376343, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6424.496801376343, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 77.96190476190476, "ram_util_percent": 69.22698412698414, "gpu_util_percent0": 0.07507936507936507, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.2510642105263164e-05, "total_loss": -0.05033145577096465, "policy_loss": -0.022985833027553533, "vf_loss": 0.016098607882687993, "vf_explained_var": 0.724648492119529, "kl": 0.01340280534703779, "entropy": 20.858423515666615, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 62975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7164290, "num_env_steps_trained": 7164290, "num_agent_steps_sampled": 7164290, "num_agent_steps_trained": 7164290}, "sampler_results": {"episode_reward_max": 10.875385424916399, "episode_reward_min": -1.977661430271613, "episode_reward_mean": 6.370822614288377, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.244572664097474, 8.440573369704287, 10.875385424916399, 3.1025412886018016, 9.053049152271937, 5.617074431986214, 6.13185655525631, 2.578083739075444, 3.6852363339427443, 7.132213182946232, 10.38456446280627, 6.763221244874365, 6.75964743394847, 5.3764291968348745, 6.324427284856942, 4.582398713174068, -1.977661430271613, 4.3033151255039765, 5.271271914070591, 5.989118824591997, 6.6156856808706985, 5.610087887535789, 9.512457794750892, 5.564007412858982, 8.230129228700848, 7.086521854301078, 7.402789803158533, 7.881460418598923, 0.028722423755012577, 10.852054686903072, 6.3837429251248485, 10.348817280407824, 4.271096033604185, 5.589326890144565, 8.89370163432293, 5.0931207972457555, 5.9350140818320964, 6.823850091231646, 9.932668013752986, 5.605077257041081, 5.427904646933236, 4.7236981705735595, 0.9339534777888842, 5.881263813666221, 5.239709429068426, 2.1737358041848047, 10.351449721574928, 6.6064360987225035, 5.619140636664346, 6.798616462134177, 6.984301730237135, 5.470195210991381, 6.9591453288160645, 7.081294293806502, 9.37029914998101, 7.413796692451872, 7.673519993392288, 5.1252945181255605, 7.0707786156408075, 5.347445773503118, 7.318888327982817, 7.049601981445447, 5.912281295942163, 7.006380915858816, 7.11498759303747, 7.880785596873773, 6.364172328235061, 10.25946145205501, 4.8385512832589885, 8.826301615111639, 8.209699238656768, 6.187092847950094, 10.717965628411028, 7.8384408513417965, 3.4530539987779014, 9.251200075386302, 7.470947292359246, 7.9365810336881415, 8.8024494994151, 5.340952893800075, 4.557046773565795, 5.8737777567705685, 5.002720149721029, 7.6402855250840975, 6.194145975936209, 6.285568062003735, 4.268304854589253, 6.325828302595881, 6.277116043795051, 5.554562903370636, 6.57790432021091, 7.1225907573143, 0.24877718346148514, 4.482321807844675, 4.900659664185608, 10.129711067498027, 7.658892095383248, 3.2230980232219437, 4.6911835697908835, 6.738340165319383], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.838554231454266, "mean_inference_ms": 8.074820812120201, "mean_action_processing_ms": 0.5424686881810923, "mean_env_wait_ms": 23.984188716812117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05365109443664551, "StateBufferConnector_ms": 0.032877206802368164, "ViewRequirementAgentConnector_ms": 1.0160167217254639}}, "episode_reward_max": 10.875385424916399, "episode_reward_min": -1.977661430271613, "episode_reward_mean": 6.370822614288377, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.244572664097474, 8.440573369704287, 10.875385424916399, 3.1025412886018016, 9.053049152271937, 5.617074431986214, 6.13185655525631, 2.578083739075444, 3.6852363339427443, 7.132213182946232, 10.38456446280627, 6.763221244874365, 6.75964743394847, 5.3764291968348745, 6.324427284856942, 4.582398713174068, -1.977661430271613, 4.3033151255039765, 5.271271914070591, 5.989118824591997, 6.6156856808706985, 5.610087887535789, 9.512457794750892, 5.564007412858982, 8.230129228700848, 7.086521854301078, 7.402789803158533, 7.881460418598923, 0.028722423755012577, 10.852054686903072, 6.3837429251248485, 10.348817280407824, 4.271096033604185, 5.589326890144565, 8.89370163432293, 5.0931207972457555, 5.9350140818320964, 6.823850091231646, 9.932668013752986, 5.605077257041081, 5.427904646933236, 4.7236981705735595, 0.9339534777888842, 5.881263813666221, 5.239709429068426, 2.1737358041848047, 10.351449721574928, 6.6064360987225035, 5.619140636664346, 6.798616462134177, 6.984301730237135, 5.470195210991381, 6.9591453288160645, 7.081294293806502, 9.37029914998101, 7.413796692451872, 7.673519993392288, 5.1252945181255605, 7.0707786156408075, 5.347445773503118, 7.318888327982817, 7.049601981445447, 5.912281295942163, 7.006380915858816, 7.11498759303747, 7.880785596873773, 6.364172328235061, 10.25946145205501, 4.8385512832589885, 8.826301615111639, 8.209699238656768, 6.187092847950094, 10.717965628411028, 7.8384408513417965, 3.4530539987779014, 9.251200075386302, 7.470947292359246, 7.9365810336881415, 8.8024494994151, 5.340952893800075, 4.557046773565795, 5.8737777567705685, 5.002720149721029, 7.6402855250840975, 6.194145975936209, 6.285568062003735, 4.268304854589253, 6.325828302595881, 6.277116043795051, 5.554562903370636, 6.57790432021091, 7.1225907573143, 0.24877718346148514, 4.482321807844675, 4.900659664185608, 10.129711067498027, 7.658892095383248, 3.2230980232219437, 4.6911835697908835, 6.738340165319383], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.838554231454266, "mean_inference_ms": 8.074820812120201, "mean_action_processing_ms": 0.5424686881810923, "mean_env_wait_ms": 23.984188716812117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05365109443664551, "StateBufferConnector_ms": 0.032877206802368164, "ViewRequirementAgentConnector_ms": 1.0160167217254639}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7164290, "num_agent_steps_trained": 7164290, "num_env_steps_sampled": 7164290, "num_env_steps_trained": 7164290, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.5156755982163, "num_env_steps_trained_throughput_per_sec": 283.5156755982163, "timesteps_total": 7164290, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7164290, "timers": {"training_iteration_time_ms": 55312.702, "sample_time_ms": 42236.937, "load_time_ms": 1733.234, "load_throughput": 9022.44, "learn_time_ms": 10781.0, "learn_throughput": 1450.515, "synch_weights_time_ms": 443.915}, "counters": {"num_env_steps_sampled": 7164290, "num_env_steps_trained": 7164290, "num_agent_steps_sampled": 7164290, "num_agent_steps_trained": 7164290}, "done": false, "episodes_total": 1610, "training_iteration": 463, "trial_id": "2f030_00000", "date": "2025-06-07_09-24-28", "timestamp": 1749281068, "time_this_iter_s": 55.173996448516846, "time_total_s": 6479.67079782486, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6479.67079782486, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 77.04126984126982, "ram_util_percent": 69.62063492063491, "gpu_util_percent0": 0.07968253968253969, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.238718421052631e-05, "total_loss": -0.052213023837698117, "policy_loss": -0.024518442116730058, "vf_loss": 0.015566383409737186, "vf_explained_var": 0.7152701695398851, "kl": 0.01317054491568296, "entropy": 20.870394805561414, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 63525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7179928, "num_env_steps_trained": 7179928, "num_agent_steps_sampled": 7179928, "num_agent_steps_trained": 7179928}, "sampler_results": {"episode_reward_max": 10.852054686903072, "episode_reward_min": -1.977661430271613, "episode_reward_mean": 6.3850283150350675, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.324427284856942, 4.582398713174068, -1.977661430271613, 4.3033151255039765, 5.271271914070591, 5.989118824591997, 6.6156856808706985, 5.610087887535789, 9.512457794750892, 5.564007412858982, 8.230129228700848, 7.086521854301078, 7.402789803158533, 7.881460418598923, 0.028722423755012577, 10.852054686903072, 6.3837429251248485, 10.348817280407824, 4.271096033604185, 5.589326890144565, 8.89370163432293, 5.0931207972457555, 5.9350140818320964, 6.823850091231646, 9.932668013752986, 5.605077257041081, 5.427904646933236, 4.7236981705735595, 0.9339534777888842, 5.881263813666221, 5.239709429068426, 2.1737358041848047, 10.351449721574928, 6.6064360987225035, 5.619140636664346, 6.798616462134177, 6.984301730237135, 5.470195210991381, 6.9591453288160645, 7.081294293806502, 9.37029914998101, 7.413796692451872, 7.673519993392288, 5.1252945181255605, 7.0707786156408075, 5.347445773503118, 7.318888327982817, 7.049601981445447, 5.912281295942163, 7.006380915858816, 7.11498759303747, 7.880785596873773, 6.364172328235061, 10.25946145205501, 4.8385512832589885, 8.826301615111639, 8.209699238656768, 6.187092847950094, 10.717965628411028, 7.8384408513417965, 3.4530539987779014, 9.251200075386302, 7.470947292359246, 7.9365810336881415, 8.8024494994151, 5.340952893800075, 4.557046773565795, 5.8737777567705685, 5.002720149721029, 7.6402855250840975, 6.194145975936209, 6.285568062003735, 4.268304854589253, 6.325828302595881, 6.277116043795051, 5.554562903370636, 6.57790432021091, 7.1225907573143, 0.24877718346148514, 4.482321807844675, 4.900659664185608, 10.129711067498027, 7.658892095383248, 3.2230980232219437, 4.6911835697908835, 6.738340165319383, 9.59643970985714, 8.472081956829875, 6.623858731158571, 0.04006696708858689, 7.59267214482595, 8.10306957837081, 6.54602966640924, 5.412376673147897, 6.078790587780852, 6.804732077713098, 9.914307999730367, 4.848810858507624, 6.688947769197002, 5.842833835314821], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.83675943138077, "mean_inference_ms": 8.07636079715867, "mean_action_processing_ms": 0.5426515562147451, "mean_env_wait_ms": 23.987039649590383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.054596900939941406, "StateBufferConnector_ms": 0.03397369384765625, "ViewRequirementAgentConnector_ms": 1.0268120765686035}}, "episode_reward_max": 10.852054686903072, "episode_reward_min": -1.977661430271613, "episode_reward_mean": 6.3850283150350675, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.324427284856942, 4.582398713174068, -1.977661430271613, 4.3033151255039765, 5.271271914070591, 5.989118824591997, 6.6156856808706985, 5.610087887535789, 9.512457794750892, 5.564007412858982, 8.230129228700848, 7.086521854301078, 7.402789803158533, 7.881460418598923, 0.028722423755012577, 10.852054686903072, 6.3837429251248485, 10.348817280407824, 4.271096033604185, 5.589326890144565, 8.89370163432293, 5.0931207972457555, 5.9350140818320964, 6.823850091231646, 9.932668013752986, 5.605077257041081, 5.427904646933236, 4.7236981705735595, 0.9339534777888842, 5.881263813666221, 5.239709429068426, 2.1737358041848047, 10.351449721574928, 6.6064360987225035, 5.619140636664346, 6.798616462134177, 6.984301730237135, 5.470195210991381, 6.9591453288160645, 7.081294293806502, 9.37029914998101, 7.413796692451872, 7.673519993392288, 5.1252945181255605, 7.0707786156408075, 5.347445773503118, 7.318888327982817, 7.049601981445447, 5.912281295942163, 7.006380915858816, 7.11498759303747, 7.880785596873773, 6.364172328235061, 10.25946145205501, 4.8385512832589885, 8.826301615111639, 8.209699238656768, 6.187092847950094, 10.717965628411028, 7.8384408513417965, 3.4530539987779014, 9.251200075386302, 7.470947292359246, 7.9365810336881415, 8.8024494994151, 5.340952893800075, 4.557046773565795, 5.8737777567705685, 5.002720149721029, 7.6402855250840975, 6.194145975936209, 6.285568062003735, 4.268304854589253, 6.325828302595881, 6.277116043795051, 5.554562903370636, 6.57790432021091, 7.1225907573143, 0.24877718346148514, 4.482321807844675, 4.900659664185608, 10.129711067498027, 7.658892095383248, 3.2230980232219437, 4.6911835697908835, 6.738340165319383, 9.59643970985714, 8.472081956829875, 6.623858731158571, 0.04006696708858689, 7.59267214482595, 8.10306957837081, 6.54602966640924, 5.412376673147897, 6.078790587780852, 6.804732077713098, 9.914307999730367, 4.848810858507624, 6.688947769197002, 5.842833835314821], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.83675943138077, "mean_inference_ms": 8.07636079715867, "mean_action_processing_ms": 0.5426515562147451, "mean_env_wait_ms": 23.987039649590383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.054596900939941406, "StateBufferConnector_ms": 0.03397369384765625, "ViewRequirementAgentConnector_ms": 1.0268120765686035}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7179928, "num_agent_steps_trained": 7179928, "num_env_steps_sampled": 7179928, "num_env_steps_trained": 7179928, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.0258238843511, "num_env_steps_trained_throughput_per_sec": 285.0258238843511, "timesteps_total": 7179928, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7179928, "timers": {"training_iteration_time_ms": 55299.257, "sample_time_ms": 42219.052, "load_time_ms": 1726.685, "load_throughput": 9056.663, "learn_time_ms": 10791.394, "learn_throughput": 1449.118, "synch_weights_time_ms": 445.142}, "counters": {"num_env_steps_sampled": 7179928, "num_env_steps_trained": 7179928, "num_agent_steps_sampled": 7179928, "num_agent_steps_trained": 7179928}, "done": false, "episodes_total": 1624, "training_iteration": 464, "trial_id": "2f030_00000", "date": "2025-06-07_09-25-23", "timestamp": 1749281123, "time_this_iter_s": 54.88108038902283, "time_total_s": 6534.551878213882, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6534.551878213882, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 77.48888888888887, "ram_util_percent": 69.67777777777779, "gpu_util_percent0": 0.07746031746031747, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.226372631578948e-05, "total_loss": -0.04727576225318692, "policy_loss": -0.020015597743066875, "vf_loss": 0.01405873296613043, "vf_explained_var": 0.747044412873008, "kl": 0.014186028929399387, "entropy": 20.788507553447378, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 64075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7195566, "num_env_steps_trained": 7195566, "num_agent_steps_sampled": 7195566, "num_agent_steps_trained": 7195566}, "sampler_results": {"episode_reward_max": 10.852054686903072, "episode_reward_min": 0.028722423755012577, "episode_reward_mean": 6.433107872998744, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.028722423755012577, 10.852054686903072, 6.3837429251248485, 10.348817280407824, 4.271096033604185, 5.589326890144565, 8.89370163432293, 5.0931207972457555, 5.9350140818320964, 6.823850091231646, 9.932668013752986, 5.605077257041081, 5.427904646933236, 4.7236981705735595, 0.9339534777888842, 5.881263813666221, 5.239709429068426, 2.1737358041848047, 10.351449721574928, 6.6064360987225035, 5.619140636664346, 6.798616462134177, 6.984301730237135, 5.470195210991381, 6.9591453288160645, 7.081294293806502, 9.37029914998101, 7.413796692451872, 7.673519993392288, 5.1252945181255605, 7.0707786156408075, 5.347445773503118, 7.318888327982817, 7.049601981445447, 5.912281295942163, 7.006380915858816, 7.11498759303747, 7.880785596873773, 6.364172328235061, 10.25946145205501, 4.8385512832589885, 8.826301615111639, 8.209699238656768, 6.187092847950094, 10.717965628411028, 7.8384408513417965, 3.4530539987779014, 9.251200075386302, 7.470947292359246, 7.9365810336881415, 8.8024494994151, 5.340952893800075, 4.557046773565795, 5.8737777567705685, 5.002720149721029, 7.6402855250840975, 6.194145975936209, 6.285568062003735, 4.268304854589253, 6.325828302595881, 6.277116043795051, 5.554562903370636, 6.57790432021091, 7.1225907573143, 0.24877718346148514, 4.482321807844675, 4.900659664185608, 10.129711067498027, 7.658892095383248, 3.2230980232219437, 4.6911835697908835, 6.738340165319383, 9.59643970985714, 8.472081956829875, 6.623858731158571, 0.04006696708858689, 7.59267214482595, 8.10306957837081, 6.54602966640924, 5.412376673147897, 6.078790587780852, 6.804732077713098, 9.914307999730367, 4.848810858507624, 6.688947769197002, 5.842833835314821, 4.015470748393668, 8.803406448787433, 6.710262055185729, 9.408093323066499, 8.953678662783373, 6.127826491175248, 5.220649126659735, 4.820017739953714, 6.4095451119316555, 4.06854846815549, 7.024274161577604, 5.460336846589662, 6.67289063178606, 3.5089664930235656], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8349651466896524, "mean_inference_ms": 8.077654821794164, "mean_action_processing_ms": 0.5427803987628179, "mean_env_wait_ms": 23.99006887809916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03505825996398926, "StateBufferConnector_ms": 0.03000640869140625, "ViewRequirementAgentConnector_ms": 1.008967399597168}}, "episode_reward_max": 10.852054686903072, "episode_reward_min": 0.028722423755012577, "episode_reward_mean": 6.433107872998744, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.028722423755012577, 10.852054686903072, 6.3837429251248485, 10.348817280407824, 4.271096033604185, 5.589326890144565, 8.89370163432293, 5.0931207972457555, 5.9350140818320964, 6.823850091231646, 9.932668013752986, 5.605077257041081, 5.427904646933236, 4.7236981705735595, 0.9339534777888842, 5.881263813666221, 5.239709429068426, 2.1737358041848047, 10.351449721574928, 6.6064360987225035, 5.619140636664346, 6.798616462134177, 6.984301730237135, 5.470195210991381, 6.9591453288160645, 7.081294293806502, 9.37029914998101, 7.413796692451872, 7.673519993392288, 5.1252945181255605, 7.0707786156408075, 5.347445773503118, 7.318888327982817, 7.049601981445447, 5.912281295942163, 7.006380915858816, 7.11498759303747, 7.880785596873773, 6.364172328235061, 10.25946145205501, 4.8385512832589885, 8.826301615111639, 8.209699238656768, 6.187092847950094, 10.717965628411028, 7.8384408513417965, 3.4530539987779014, 9.251200075386302, 7.470947292359246, 7.9365810336881415, 8.8024494994151, 5.340952893800075, 4.557046773565795, 5.8737777567705685, 5.002720149721029, 7.6402855250840975, 6.194145975936209, 6.285568062003735, 4.268304854589253, 6.325828302595881, 6.277116043795051, 5.554562903370636, 6.57790432021091, 7.1225907573143, 0.24877718346148514, 4.482321807844675, 4.900659664185608, 10.129711067498027, 7.658892095383248, 3.2230980232219437, 4.6911835697908835, 6.738340165319383, 9.59643970985714, 8.472081956829875, 6.623858731158571, 0.04006696708858689, 7.59267214482595, 8.10306957837081, 6.54602966640924, 5.412376673147897, 6.078790587780852, 6.804732077713098, 9.914307999730367, 4.848810858507624, 6.688947769197002, 5.842833835314821, 4.015470748393668, 8.803406448787433, 6.710262055185729, 9.408093323066499, 8.953678662783373, 6.127826491175248, 5.220649126659735, 4.820017739953714, 6.4095451119316555, 4.06854846815549, 7.024274161577604, 5.460336846589662, 6.67289063178606, 3.5089664930235656], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8349651466896524, "mean_inference_ms": 8.077654821794164, "mean_action_processing_ms": 0.5427803987628179, "mean_env_wait_ms": 23.99006887809916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03505825996398926, "StateBufferConnector_ms": 0.03000640869140625, "ViewRequirementAgentConnector_ms": 1.008967399597168}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7195566, "num_agent_steps_trained": 7195566, "num_env_steps_sampled": 7195566, "num_env_steps_trained": 7195566, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.4946597653245, "num_env_steps_trained_throughput_per_sec": 282.4946597653245, "timesteps_total": 7195566, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7195566, "timers": {"training_iteration_time_ms": 55268.286, "sample_time_ms": 42187.366, "load_time_ms": 1717.711, "load_throughput": 9103.978, "learn_time_ms": 10799.614, "learn_throughput": 1448.015, "synch_weights_time_ms": 448.07}, "counters": {"num_env_steps_sampled": 7195566, "num_env_steps_trained": 7195566, "num_agent_steps_sampled": 7195566, "num_agent_steps_trained": 7195566}, "done": false, "episodes_total": 1638, "training_iteration": 465, "trial_id": "2f030_00000", "date": "2025-06-07_09-26-18", "timestamp": 1749281178, "time_this_iter_s": 55.37947964668274, "time_total_s": 6589.931357860565, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6589.931357860565, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 78.0253968253968, "ram_util_percent": 69.45238095238095, "gpu_util_percent0": 0.07920634920634921, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.214026842105264e-05, "total_loss": -0.05594351685436612, "policy_loss": -0.028701998043318532, "vf_loss": 0.015720701824704354, "vf_explained_var": 0.698503152999011, "kl": 0.013483762670128437, "entropy": 20.778503945090552, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 64625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7211204, "num_env_steps_trained": 7211204, "num_agent_steps_sampled": 7211204, "num_agent_steps_trained": 7211204}, "sampler_results": {"episode_reward_max": 10.850072088960195, "episode_reward_min": 0.04006696708858689, "episode_reward_mean": 6.429942204028561, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9339534777888842, 5.881263813666221, 5.239709429068426, 2.1737358041848047, 10.351449721574928, 6.6064360987225035, 5.619140636664346, 6.798616462134177, 6.984301730237135, 5.470195210991381, 6.9591453288160645, 7.081294293806502, 9.37029914998101, 7.413796692451872, 7.673519993392288, 5.1252945181255605, 7.0707786156408075, 5.347445773503118, 7.318888327982817, 7.049601981445447, 5.912281295942163, 7.006380915858816, 7.11498759303747, 7.880785596873773, 6.364172328235061, 10.25946145205501, 4.8385512832589885, 8.826301615111639, 8.209699238656768, 6.187092847950094, 10.717965628411028, 7.8384408513417965, 3.4530539987779014, 9.251200075386302, 7.470947292359246, 7.9365810336881415, 8.8024494994151, 5.340952893800075, 4.557046773565795, 5.8737777567705685, 5.002720149721029, 7.6402855250840975, 6.194145975936209, 6.285568062003735, 4.268304854589253, 6.325828302595881, 6.277116043795051, 5.554562903370636, 6.57790432021091, 7.1225907573143, 0.24877718346148514, 4.482321807844675, 4.900659664185608, 10.129711067498027, 7.658892095383248, 3.2230980232219437, 4.6911835697908835, 6.738340165319383, 9.59643970985714, 8.472081956829875, 6.623858731158571, 0.04006696708858689, 7.59267214482595, 8.10306957837081, 6.54602966640924, 5.412376673147897, 6.078790587780852, 6.804732077713098, 9.914307999730367, 4.848810858507624, 6.688947769197002, 5.842833835314821, 4.015470748393668, 8.803406448787433, 6.710262055185729, 9.408093323066499, 8.953678662783373, 6.127826491175248, 5.220649126659735, 4.820017739953714, 6.4095451119316555, 4.06854846815549, 7.024274161577604, 5.460336846589662, 6.67289063178606, 3.5089664930235656, 10.850072088960195, 2.3328272276618085, 3.3608041173737475, 5.636596823696809, 6.562468019496572, 8.59643685954559, 10.238263465648282, 2.5268171680247122, 4.77431367554783, 7.769109915695946, 9.00125242068207, 6.19265586974789, 3.758544783922301, 7.992065599850636], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.833313147728019, "mean_inference_ms": 8.078961127757651, "mean_action_processing_ms": 0.5428801831279945, "mean_env_wait_ms": 23.992718736665996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036113739013671875, "StateBufferConnector_ms": 0.0280303955078125, "ViewRequirementAgentConnector_ms": 1.0111713409423828}}, "episode_reward_max": 10.850072088960195, "episode_reward_min": 0.04006696708858689, "episode_reward_mean": 6.429942204028561, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9339534777888842, 5.881263813666221, 5.239709429068426, 2.1737358041848047, 10.351449721574928, 6.6064360987225035, 5.619140636664346, 6.798616462134177, 6.984301730237135, 5.470195210991381, 6.9591453288160645, 7.081294293806502, 9.37029914998101, 7.413796692451872, 7.673519993392288, 5.1252945181255605, 7.0707786156408075, 5.347445773503118, 7.318888327982817, 7.049601981445447, 5.912281295942163, 7.006380915858816, 7.11498759303747, 7.880785596873773, 6.364172328235061, 10.25946145205501, 4.8385512832589885, 8.826301615111639, 8.209699238656768, 6.187092847950094, 10.717965628411028, 7.8384408513417965, 3.4530539987779014, 9.251200075386302, 7.470947292359246, 7.9365810336881415, 8.8024494994151, 5.340952893800075, 4.557046773565795, 5.8737777567705685, 5.002720149721029, 7.6402855250840975, 6.194145975936209, 6.285568062003735, 4.268304854589253, 6.325828302595881, 6.277116043795051, 5.554562903370636, 6.57790432021091, 7.1225907573143, 0.24877718346148514, 4.482321807844675, 4.900659664185608, 10.129711067498027, 7.658892095383248, 3.2230980232219437, 4.6911835697908835, 6.738340165319383, 9.59643970985714, 8.472081956829875, 6.623858731158571, 0.04006696708858689, 7.59267214482595, 8.10306957837081, 6.54602966640924, 5.412376673147897, 6.078790587780852, 6.804732077713098, 9.914307999730367, 4.848810858507624, 6.688947769197002, 5.842833835314821, 4.015470748393668, 8.803406448787433, 6.710262055185729, 9.408093323066499, 8.953678662783373, 6.127826491175248, 5.220649126659735, 4.820017739953714, 6.4095451119316555, 4.06854846815549, 7.024274161577604, 5.460336846589662, 6.67289063178606, 3.5089664930235656, 10.850072088960195, 2.3328272276618085, 3.3608041173737475, 5.636596823696809, 6.562468019496572, 8.59643685954559, 10.238263465648282, 2.5268171680247122, 4.77431367554783, 7.769109915695946, 9.00125242068207, 6.19265586974789, 3.758544783922301, 7.992065599850636], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.833313147728019, "mean_inference_ms": 8.078961127757651, "mean_action_processing_ms": 0.5428801831279945, "mean_env_wait_ms": 23.992718736665996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036113739013671875, "StateBufferConnector_ms": 0.0280303955078125, "ViewRequirementAgentConnector_ms": 1.0111713409423828}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7211204, "num_agent_steps_trained": 7211204, "num_env_steps_sampled": 7211204, "num_env_steps_trained": 7211204, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.360528977575, "num_env_steps_trained_throughput_per_sec": 281.360528977575, "timesteps_total": 7211204, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7211204, "timers": {"training_iteration_time_ms": 55303.579, "sample_time_ms": 42229.842, "load_time_ms": 1721.345, "load_throughput": 9084.758, "learn_time_ms": 10792.618, "learn_throughput": 1448.953, "synch_weights_time_ms": 445.153}, "counters": {"num_env_steps_sampled": 7211204, "num_env_steps_trained": 7211204, "num_agent_steps_sampled": 7211204, "num_agent_steps_trained": 7211204}, "done": false, "episodes_total": 1652, "training_iteration": 466, "trial_id": "2f030_00000", "date": "2025-06-07_09-27-14", "timestamp": 1749281234, "time_this_iter_s": 55.591742277145386, "time_total_s": 6645.523100137711, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6645.523100137711, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 78.19999999999999, "ram_util_percent": 69.390625, "gpu_util_percent0": 0.07468749999999999, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.2016810526315795e-05, "total_loss": -0.05090887509794398, "policy_loss": -0.023738497280158876, "vf_loss": 0.017636201402003115, "vf_explained_var": 0.6962634040008892, "kl": 0.013040251329780804, "entropy": 20.87238795193759, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 65175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7226842, "num_env_steps_trained": 7226842, "num_agent_steps_sampled": 7226842, "num_agent_steps_trained": 7226842}, "sampler_results": {"episode_reward_max": 10.850072088960195, "episode_reward_min": -0.6230720676256791, "episode_reward_mean": 6.1896944402443985, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.673519993392288, 5.1252945181255605, 7.0707786156408075, 5.347445773503118, 7.318888327982817, 7.049601981445447, 5.912281295942163, 7.006380915858816, 7.11498759303747, 7.880785596873773, 6.364172328235061, 10.25946145205501, 4.8385512832589885, 8.826301615111639, 8.209699238656768, 6.187092847950094, 10.717965628411028, 7.8384408513417965, 3.4530539987779014, 9.251200075386302, 7.470947292359246, 7.9365810336881415, 8.8024494994151, 5.340952893800075, 4.557046773565795, 5.8737777567705685, 5.002720149721029, 7.6402855250840975, 6.194145975936209, 6.285568062003735, 4.268304854589253, 6.325828302595881, 6.277116043795051, 5.554562903370636, 6.57790432021091, 7.1225907573143, 0.24877718346148514, 4.482321807844675, 4.900659664185608, 10.129711067498027, 7.658892095383248, 3.2230980232219437, 4.6911835697908835, 6.738340165319383, 9.59643970985714, 8.472081956829875, 6.623858731158571, 0.04006696708858689, 7.59267214482595, 8.10306957837081, 6.54602966640924, 5.412376673147897, 6.078790587780852, 6.804732077713098, 9.914307999730367, 4.848810858507624, 6.688947769197002, 5.842833835314821, 4.015470748393668, 8.803406448787433, 6.710262055185729, 9.408093323066499, 8.953678662783373, 6.127826491175248, 5.220649126659735, 4.820017739953714, 6.4095451119316555, 4.06854846815549, 7.024274161577604, 5.460336846589662, 6.67289063178606, 3.5089664930235656, 10.850072088960195, 2.3328272276618085, 3.3608041173737475, 5.636596823696809, 6.562468019496572, 8.59643685954559, 10.238263465648282, 2.5268171680247122, 4.77431367554783, 7.769109915695946, 9.00125242068207, 6.19265586974789, 3.758544783922301, 7.992065599850636, 1.268769302370103, 7.365285920988189, 4.945497932833343, 6.80495805766244, 7.086315171487019, 2.7010917890481974, 5.445637683835624, -0.6230720676256791, 2.4955117854181013, 7.125389663085685, 5.9927654549523925, 2.1436846668422307, 5.380350348782047, 4.7263757619923386], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8317436269956624, "mean_inference_ms": 8.08004234726215, "mean_action_processing_ms": 0.5429581939397254, "mean_env_wait_ms": 23.994975141027854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038166046142578125, "StateBufferConnector_ms": 0.028048992156982422, "ViewRequirementAgentConnector_ms": 0.9750356674194336}}, "episode_reward_max": 10.850072088960195, "episode_reward_min": -0.6230720676256791, "episode_reward_mean": 6.1896944402443985, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.673519993392288, 5.1252945181255605, 7.0707786156408075, 5.347445773503118, 7.318888327982817, 7.049601981445447, 5.912281295942163, 7.006380915858816, 7.11498759303747, 7.880785596873773, 6.364172328235061, 10.25946145205501, 4.8385512832589885, 8.826301615111639, 8.209699238656768, 6.187092847950094, 10.717965628411028, 7.8384408513417965, 3.4530539987779014, 9.251200075386302, 7.470947292359246, 7.9365810336881415, 8.8024494994151, 5.340952893800075, 4.557046773565795, 5.8737777567705685, 5.002720149721029, 7.6402855250840975, 6.194145975936209, 6.285568062003735, 4.268304854589253, 6.325828302595881, 6.277116043795051, 5.554562903370636, 6.57790432021091, 7.1225907573143, 0.24877718346148514, 4.482321807844675, 4.900659664185608, 10.129711067498027, 7.658892095383248, 3.2230980232219437, 4.6911835697908835, 6.738340165319383, 9.59643970985714, 8.472081956829875, 6.623858731158571, 0.04006696708858689, 7.59267214482595, 8.10306957837081, 6.54602966640924, 5.412376673147897, 6.078790587780852, 6.804732077713098, 9.914307999730367, 4.848810858507624, 6.688947769197002, 5.842833835314821, 4.015470748393668, 8.803406448787433, 6.710262055185729, 9.408093323066499, 8.953678662783373, 6.127826491175248, 5.220649126659735, 4.820017739953714, 6.4095451119316555, 4.06854846815549, 7.024274161577604, 5.460336846589662, 6.67289063178606, 3.5089664930235656, 10.850072088960195, 2.3328272276618085, 3.3608041173737475, 5.636596823696809, 6.562468019496572, 8.59643685954559, 10.238263465648282, 2.5268171680247122, 4.77431367554783, 7.769109915695946, 9.00125242068207, 6.19265586974789, 3.758544783922301, 7.992065599850636, 1.268769302370103, 7.365285920988189, 4.945497932833343, 6.80495805766244, 7.086315171487019, 2.7010917890481974, 5.445637683835624, -0.6230720676256791, 2.4955117854181013, 7.125389663085685, 5.9927654549523925, 2.1436846668422307, 5.380350348782047, 4.7263757619923386], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8317436269956624, "mean_inference_ms": 8.08004234726215, "mean_action_processing_ms": 0.5429581939397254, "mean_env_wait_ms": 23.994975141027854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038166046142578125, "StateBufferConnector_ms": 0.028048992156982422, "ViewRequirementAgentConnector_ms": 0.9750356674194336}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7226842, "num_agent_steps_trained": 7226842, "num_env_steps_sampled": 7226842, "num_env_steps_trained": 7226842, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.6174832969193, "num_env_steps_trained_throughput_per_sec": 284.6174832969193, "timesteps_total": 7226842, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7226842, "timers": {"training_iteration_time_ms": 55236.592, "sample_time_ms": 42144.527, "load_time_ms": 1709.369, "load_throughput": 9148.407, "learn_time_ms": 10807.98, "learn_throughput": 1446.894, "synch_weights_time_ms": 458.863}, "counters": {"num_env_steps_sampled": 7226842, "num_env_steps_trained": 7226842, "num_agent_steps_sampled": 7226842, "num_agent_steps_trained": 7226842}, "done": false, "episodes_total": 1666, "training_iteration": 467, "trial_id": "2f030_00000", "date": "2025-06-07_09-28-09", "timestamp": 1749281289, "time_this_iter_s": 54.96145534515381, "time_total_s": 6700.484555482864, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6700.484555482864, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 76.9904761904762, "ram_util_percent": 69.46984126984127, "gpu_util_percent0": 0.08333333333333333, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.189335263157895e-05, "total_loss": -0.04389713732822036, "policy_loss": -0.016114173654985443, "vf_loss": 0.014507896018807184, "vf_explained_var": 0.7383720031651584, "kl": 0.013190211355950767, "entropy": 20.76281390797008, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 65725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7242480, "num_env_steps_trained": 7242480, "num_agent_steps_sampled": 7242480, "num_agent_steps_trained": 7242480}, "sampler_results": {"episode_reward_max": 10.850072088960195, "episode_reward_min": -0.6230720676256791, "episode_reward_mean": 6.06330192583212, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.209699238656768, 6.187092847950094, 10.717965628411028, 7.8384408513417965, 3.4530539987779014, 9.251200075386302, 7.470947292359246, 7.9365810336881415, 8.8024494994151, 5.340952893800075, 4.557046773565795, 5.8737777567705685, 5.002720149721029, 7.6402855250840975, 6.194145975936209, 6.285568062003735, 4.268304854589253, 6.325828302595881, 6.277116043795051, 5.554562903370636, 6.57790432021091, 7.1225907573143, 0.24877718346148514, 4.482321807844675, 4.900659664185608, 10.129711067498027, 7.658892095383248, 3.2230980232219437, 4.6911835697908835, 6.738340165319383, 9.59643970985714, 8.472081956829875, 6.623858731158571, 0.04006696708858689, 7.59267214482595, 8.10306957837081, 6.54602966640924, 5.412376673147897, 6.078790587780852, 6.804732077713098, 9.914307999730367, 4.848810858507624, 6.688947769197002, 5.842833835314821, 4.015470748393668, 8.803406448787433, 6.710262055185729, 9.408093323066499, 8.953678662783373, 6.127826491175248, 5.220649126659735, 4.820017739953714, 6.4095451119316555, 4.06854846815549, 7.024274161577604, 5.460336846589662, 6.67289063178606, 3.5089664930235656, 10.850072088960195, 2.3328272276618085, 3.3608041173737475, 5.636596823696809, 6.562468019496572, 8.59643685954559, 10.238263465648282, 2.5268171680247122, 4.77431367554783, 7.769109915695946, 9.00125242068207, 6.19265586974789, 3.758544783922301, 7.992065599850636, 1.268769302370103, 7.365285920988189, 4.945497932833343, 6.80495805766244, 7.086315171487019, 2.7010917890481974, 5.445637683835624, -0.6230720676256791, 2.4955117854181013, 7.125389663085685, 5.9927654549523925, 2.1436846668422307, 5.380350348782047, 4.7263757619923386, 5.5665354742498625, 7.150461018252611, 7.984092828796251, 5.6761309538200955, 9.899995049348599, 7.648492540552544, 2.4114167748490734, 1.8152923019460931, 7.609164414591844, 4.450986780135531, 7.944853655247176, 1.52888978145297, 7.8338921111172795, 7.628996164875149], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8300835187700506, "mean_inference_ms": 8.081026803775856, "mean_action_processing_ms": 0.5430263759520592, "mean_env_wait_ms": 23.997352595606017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04216122627258301, "StateBufferConnector_ms": 0.031079769134521484, "ViewRequirementAgentConnector_ms": 1.0444777011871338}}, "episode_reward_max": 10.850072088960195, "episode_reward_min": -0.6230720676256791, "episode_reward_mean": 6.06330192583212, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.209699238656768, 6.187092847950094, 10.717965628411028, 7.8384408513417965, 3.4530539987779014, 9.251200075386302, 7.470947292359246, 7.9365810336881415, 8.8024494994151, 5.340952893800075, 4.557046773565795, 5.8737777567705685, 5.002720149721029, 7.6402855250840975, 6.194145975936209, 6.285568062003735, 4.268304854589253, 6.325828302595881, 6.277116043795051, 5.554562903370636, 6.57790432021091, 7.1225907573143, 0.24877718346148514, 4.482321807844675, 4.900659664185608, 10.129711067498027, 7.658892095383248, 3.2230980232219437, 4.6911835697908835, 6.738340165319383, 9.59643970985714, 8.472081956829875, 6.623858731158571, 0.04006696708858689, 7.59267214482595, 8.10306957837081, 6.54602966640924, 5.412376673147897, 6.078790587780852, 6.804732077713098, 9.914307999730367, 4.848810858507624, 6.688947769197002, 5.842833835314821, 4.015470748393668, 8.803406448787433, 6.710262055185729, 9.408093323066499, 8.953678662783373, 6.127826491175248, 5.220649126659735, 4.820017739953714, 6.4095451119316555, 4.06854846815549, 7.024274161577604, 5.460336846589662, 6.67289063178606, 3.5089664930235656, 10.850072088960195, 2.3328272276618085, 3.3608041173737475, 5.636596823696809, 6.562468019496572, 8.59643685954559, 10.238263465648282, 2.5268171680247122, 4.77431367554783, 7.769109915695946, 9.00125242068207, 6.19265586974789, 3.758544783922301, 7.992065599850636, 1.268769302370103, 7.365285920988189, 4.945497932833343, 6.80495805766244, 7.086315171487019, 2.7010917890481974, 5.445637683835624, -0.6230720676256791, 2.4955117854181013, 7.125389663085685, 5.9927654549523925, 2.1436846668422307, 5.380350348782047, 4.7263757619923386, 5.5665354742498625, 7.150461018252611, 7.984092828796251, 5.6761309538200955, 9.899995049348599, 7.648492540552544, 2.4114167748490734, 1.8152923019460931, 7.609164414591844, 4.450986780135531, 7.944853655247176, 1.52888978145297, 7.8338921111172795, 7.628996164875149], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8300835187700506, "mean_inference_ms": 8.081026803775856, "mean_action_processing_ms": 0.5430263759520592, "mean_env_wait_ms": 23.997352595606017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04216122627258301, "StateBufferConnector_ms": 0.031079769134521484, "ViewRequirementAgentConnector_ms": 1.0444777011871338}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7242480, "num_agent_steps_trained": 7242480, "num_env_steps_sampled": 7242480, "num_env_steps_trained": 7242480, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.5488364141293, "num_env_steps_trained_throughput_per_sec": 284.5488364141293, "timesteps_total": 7242480, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7242480, "timers": {"training_iteration_time_ms": 55217.915, "sample_time_ms": 42136.539, "load_time_ms": 1706.172, "load_throughput": 9165.547, "learn_time_ms": 10808.135, "learn_throughput": 1446.873, "synch_weights_time_ms": 452.915}, "counters": {"num_env_steps_sampled": 7242480, "num_env_steps_trained": 7242480, "num_agent_steps_sampled": 7242480, "num_agent_steps_trained": 7242480}, "done": false, "episodes_total": 1680, "training_iteration": 468, "trial_id": "2f030_00000", "date": "2025-06-07_09-29-04", "timestamp": 1749281344, "time_this_iter_s": 54.97417116165161, "time_total_s": 6755.458726644516, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6755.458726644516, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 78.55238095238096, "ram_util_percent": 69.76031746031744, "gpu_util_percent0": 0.07968253968253969, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.176989473684212e-05, "total_loss": -0.03799977218647572, "policy_loss": -0.010421302906470373, "vf_loss": 0.01533800232901492, "vf_explained_var": 0.7302819399400191, "kl": 0.013159593810984766, "entropy": 20.774184098677203, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 66275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7258118, "num_env_steps_trained": 7258118, "num_agent_steps_sampled": 7258118, "num_agent_steps_trained": 7258118}, "sampler_results": {"episode_reward_max": 10.850072088960195, "episode_reward_min": -0.6230720676256791, "episode_reward_mean": 5.907227065949441, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.194145975936209, 6.285568062003735, 4.268304854589253, 6.325828302595881, 6.277116043795051, 5.554562903370636, 6.57790432021091, 7.1225907573143, 0.24877718346148514, 4.482321807844675, 4.900659664185608, 10.129711067498027, 7.658892095383248, 3.2230980232219437, 4.6911835697908835, 6.738340165319383, 9.59643970985714, 8.472081956829875, 6.623858731158571, 0.04006696708858689, 7.59267214482595, 8.10306957837081, 6.54602966640924, 5.412376673147897, 6.078790587780852, 6.804732077713098, 9.914307999730367, 4.848810858507624, 6.688947769197002, 5.842833835314821, 4.015470748393668, 8.803406448787433, 6.710262055185729, 9.408093323066499, 8.953678662783373, 6.127826491175248, 5.220649126659735, 4.820017739953714, 6.4095451119316555, 4.06854846815549, 7.024274161577604, 5.460336846589662, 6.67289063178606, 3.5089664930235656, 10.850072088960195, 2.3328272276618085, 3.3608041173737475, 5.636596823696809, 6.562468019496572, 8.59643685954559, 10.238263465648282, 2.5268171680247122, 4.77431367554783, 7.769109915695946, 9.00125242068207, 6.19265586974789, 3.758544783922301, 7.992065599850636, 1.268769302370103, 7.365285920988189, 4.945497932833343, 6.80495805766244, 7.086315171487019, 2.7010917890481974, 5.445637683835624, -0.6230720676256791, 2.4955117854181013, 7.125389663085685, 5.9927654549523925, 2.1436846668422307, 5.380350348782047, 4.7263757619923386, 5.5665354742498625, 7.150461018252611, 7.984092828796251, 5.6761309538200955, 9.899995049348599, 7.648492540552544, 2.4114167748490734, 1.8152923019460931, 7.609164414591844, 4.450986780135531, 7.944853655247176, 1.52888978145297, 7.8338921111172795, 7.628996164875149, 4.429601252497637, 9.05940897066619, 5.157948384639581, 6.152297927484441, 3.9142373404505486, 8.285405316122102, 5.704135942925889, 6.985655280943682, 4.458581675650954, 10.467539660082192, 2.0944897006023657, 6.878983544863534, 7.217808671566287, 1.868633908164628], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8282160340103006, "mean_inference_ms": 8.082130915214139, "mean_action_processing_ms": 0.5430855709878013, "mean_env_wait_ms": 23.99997878082058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04012584686279297, "StateBufferConnector_ms": 0.0310976505279541, "ViewRequirementAgentConnector_ms": 1.031834363937378}}, "episode_reward_max": 10.850072088960195, "episode_reward_min": -0.6230720676256791, "episode_reward_mean": 5.907227065949441, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.194145975936209, 6.285568062003735, 4.268304854589253, 6.325828302595881, 6.277116043795051, 5.554562903370636, 6.57790432021091, 7.1225907573143, 0.24877718346148514, 4.482321807844675, 4.900659664185608, 10.129711067498027, 7.658892095383248, 3.2230980232219437, 4.6911835697908835, 6.738340165319383, 9.59643970985714, 8.472081956829875, 6.623858731158571, 0.04006696708858689, 7.59267214482595, 8.10306957837081, 6.54602966640924, 5.412376673147897, 6.078790587780852, 6.804732077713098, 9.914307999730367, 4.848810858507624, 6.688947769197002, 5.842833835314821, 4.015470748393668, 8.803406448787433, 6.710262055185729, 9.408093323066499, 8.953678662783373, 6.127826491175248, 5.220649126659735, 4.820017739953714, 6.4095451119316555, 4.06854846815549, 7.024274161577604, 5.460336846589662, 6.67289063178606, 3.5089664930235656, 10.850072088960195, 2.3328272276618085, 3.3608041173737475, 5.636596823696809, 6.562468019496572, 8.59643685954559, 10.238263465648282, 2.5268171680247122, 4.77431367554783, 7.769109915695946, 9.00125242068207, 6.19265586974789, 3.758544783922301, 7.992065599850636, 1.268769302370103, 7.365285920988189, 4.945497932833343, 6.80495805766244, 7.086315171487019, 2.7010917890481974, 5.445637683835624, -0.6230720676256791, 2.4955117854181013, 7.125389663085685, 5.9927654549523925, 2.1436846668422307, 5.380350348782047, 4.7263757619923386, 5.5665354742498625, 7.150461018252611, 7.984092828796251, 5.6761309538200955, 9.899995049348599, 7.648492540552544, 2.4114167748490734, 1.8152923019460931, 7.609164414591844, 4.450986780135531, 7.944853655247176, 1.52888978145297, 7.8338921111172795, 7.628996164875149, 4.429601252497637, 9.05940897066619, 5.157948384639581, 6.152297927484441, 3.9142373404505486, 8.285405316122102, 5.704135942925889, 6.985655280943682, 4.458581675650954, 10.467539660082192, 2.0944897006023657, 6.878983544863534, 7.217808671566287, 1.868633908164628], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8282160340103006, "mean_inference_ms": 8.082130915214139, "mean_action_processing_ms": 0.5430855709878013, "mean_env_wait_ms": 23.99997878082058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04012584686279297, "StateBufferConnector_ms": 0.0310976505279541, "ViewRequirementAgentConnector_ms": 1.031834363937378}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7258118, "num_agent_steps_trained": 7258118, "num_env_steps_sampled": 7258118, "num_env_steps_trained": 7258118, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.7189972556439, "num_env_steps_trained_throughput_per_sec": 280.7189972556439, "timesteps_total": 7258118, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7258118, "timers": {"training_iteration_time_ms": 55214.836, "sample_time_ms": 42119.634, "load_time_ms": 1691.829, "load_throughput": 9243.249, "learn_time_ms": 10828.396, "learn_throughput": 1444.166, "synch_weights_time_ms": 463.972}, "counters": {"num_env_steps_sampled": 7258118, "num_env_steps_trained": 7258118, "num_agent_steps_sampled": 7258118, "num_agent_steps_trained": 7258118}, "done": false, "episodes_total": 1694, "training_iteration": 469, "trial_id": "2f030_00000", "date": "2025-06-07_09-30-00", "timestamp": 1749281400, "time_this_iter_s": 55.72496795654297, "time_total_s": 6811.183694601059, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6811.183694601059, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 77.45, "ram_util_percent": 69.765625, "gpu_util_percent0": 0.07718749999999999, "vram_util_percent0": 0.8592122395833333}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3.1345125609405295, "episode_reward_min": -9.275768248968733, "episode_reward_mean": -5.546941377799103, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.275768248968733, -3.1345125609405295, -6.348604721829235, -3.9851046008766122, -4.990716756380404], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4278128059220727, "mean_inference_ms": 3.880991284718293, "mean_action_processing_ms": 0.2813531985481032, "mean_env_wait_ms": 10.47186737484721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20025253295898438}}, "episode_reward_max": -3.1345125609405295, "episode_reward_min": -9.275768248968733, "episode_reward_mean": -5.546941377799103, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.275768248968733, -3.1345125609405295, -6.348604721829235, -3.9851046008766122, -4.990716756380404], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4278128059220727, "mean_inference_ms": 3.880991284718293, "mean_action_processing_ms": 0.2813531985481032, "mean_env_wait_ms": 10.47186737484721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20025253295898438}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.164643684210527e-05, "total_loss": -0.04652181769975207, "policy_loss": -0.01897555792164481, "vf_loss": 0.01468163583343002, "vf_explained_var": 0.7429915531115099, "kl": 0.013281749221405906, "entropy": 20.70310745932839, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 66825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7273756, "num_env_steps_trained": 7273756, "num_agent_steps_sampled": 7273756, "num_agent_steps_trained": 7273756}, "sampler_results": {"episode_reward_max": 10.850072088960195, "episode_reward_min": -0.6230720676256791, "episode_reward_mean": 5.915395044088282, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.6911835697908835, 6.738340165319383, 9.59643970985714, 8.472081956829875, 6.623858731158571, 0.04006696708858689, 7.59267214482595, 8.10306957837081, 6.54602966640924, 5.412376673147897, 6.078790587780852, 6.804732077713098, 9.914307999730367, 4.848810858507624, 6.688947769197002, 5.842833835314821, 4.015470748393668, 8.803406448787433, 6.710262055185729, 9.408093323066499, 8.953678662783373, 6.127826491175248, 5.220649126659735, 4.820017739953714, 6.4095451119316555, 4.06854846815549, 7.024274161577604, 5.460336846589662, 6.67289063178606, 3.5089664930235656, 10.850072088960195, 2.3328272276618085, 3.3608041173737475, 5.636596823696809, 6.562468019496572, 8.59643685954559, 10.238263465648282, 2.5268171680247122, 4.77431367554783, 7.769109915695946, 9.00125242068207, 6.19265586974789, 3.758544783922301, 7.992065599850636, 1.268769302370103, 7.365285920988189, 4.945497932833343, 6.80495805766244, 7.086315171487019, 2.7010917890481974, 5.445637683835624, -0.6230720676256791, 2.4955117854181013, 7.125389663085685, 5.9927654549523925, 2.1436846668422307, 5.380350348782047, 4.7263757619923386, 5.5665354742498625, 7.150461018252611, 7.984092828796251, 5.6761309538200955, 9.899995049348599, 7.648492540552544, 2.4114167748490734, 1.8152923019460931, 7.609164414591844, 4.450986780135531, 7.944853655247176, 1.52888978145297, 7.8338921111172795, 7.628996164875149, 4.429601252497637, 9.05940897066619, 5.157948384639581, 6.152297927484441, 3.9142373404505486, 8.285405316122102, 5.704135942925889, 6.985655280943682, 4.458581675650954, 10.467539660082192, 2.0944897006023657, 6.878983544863534, 7.217808671566287, 1.868633908164628, 8.643789551107517, 3.226179234621909, 3.4284600124538005, 4.956977507238417, 4.905227066554276, 3.8472582235855755, 7.661155099729198, 8.163248967369888, 5.825134278316813, 4.713652331705145, 6.222853635544032, 6.82508510283226, 9.587264289401173, 2.059993574835073], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8265334336974326, "mean_inference_ms": 8.083082755581357, "mean_action_processing_ms": 0.5431179475501421, "mean_env_wait_ms": 24.002448411338847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038182973861694336, "StateBufferConnector_ms": 0.03311443328857422, "ViewRequirementAgentConnector_ms": 0.9748525619506836}}, "episode_reward_max": 10.850072088960195, "episode_reward_min": -0.6230720676256791, "episode_reward_mean": 5.915395044088282, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.6911835697908835, 6.738340165319383, 9.59643970985714, 8.472081956829875, 6.623858731158571, 0.04006696708858689, 7.59267214482595, 8.10306957837081, 6.54602966640924, 5.412376673147897, 6.078790587780852, 6.804732077713098, 9.914307999730367, 4.848810858507624, 6.688947769197002, 5.842833835314821, 4.015470748393668, 8.803406448787433, 6.710262055185729, 9.408093323066499, 8.953678662783373, 6.127826491175248, 5.220649126659735, 4.820017739953714, 6.4095451119316555, 4.06854846815549, 7.024274161577604, 5.460336846589662, 6.67289063178606, 3.5089664930235656, 10.850072088960195, 2.3328272276618085, 3.3608041173737475, 5.636596823696809, 6.562468019496572, 8.59643685954559, 10.238263465648282, 2.5268171680247122, 4.77431367554783, 7.769109915695946, 9.00125242068207, 6.19265586974789, 3.758544783922301, 7.992065599850636, 1.268769302370103, 7.365285920988189, 4.945497932833343, 6.80495805766244, 7.086315171487019, 2.7010917890481974, 5.445637683835624, -0.6230720676256791, 2.4955117854181013, 7.125389663085685, 5.9927654549523925, 2.1436846668422307, 5.380350348782047, 4.7263757619923386, 5.5665354742498625, 7.150461018252611, 7.984092828796251, 5.6761309538200955, 9.899995049348599, 7.648492540552544, 2.4114167748490734, 1.8152923019460931, 7.609164414591844, 4.450986780135531, 7.944853655247176, 1.52888978145297, 7.8338921111172795, 7.628996164875149, 4.429601252497637, 9.05940897066619, 5.157948384639581, 6.152297927484441, 3.9142373404505486, 8.285405316122102, 5.704135942925889, 6.985655280943682, 4.458581675650954, 10.467539660082192, 2.0944897006023657, 6.878983544863534, 7.217808671566287, 1.868633908164628, 8.643789551107517, 3.226179234621909, 3.4284600124538005, 4.956977507238417, 4.905227066554276, 3.8472582235855755, 7.661155099729198, 8.163248967369888, 5.825134278316813, 4.713652331705145, 6.222853635544032, 6.82508510283226, 9.587264289401173, 2.059993574835073], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8265334336974326, "mean_inference_ms": 8.083082755581357, "mean_action_processing_ms": 0.5431179475501421, "mean_env_wait_ms": 24.002448411338847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038182973861694336, "StateBufferConnector_ms": 0.03311443328857422, "ViewRequirementAgentConnector_ms": 0.9748525619506836}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7273756, "num_agent_steps_trained": 7273756, "num_env_steps_sampled": 7273756, "num_env_steps_trained": 7273756, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.37962525942334, "num_env_steps_trained_throughput_per_sec": 284.37962525942334, "timesteps_total": 7273756, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7273756, "timers": {"training_iteration_time_ms": 55201.252, "sample_time_ms": 42087.129, "load_time_ms": 1718.8, "load_throughput": 9098.208, "learn_time_ms": 10826.319, "learn_throughput": 1444.443, "synch_weights_time_ms": 458.943}, "counters": {"num_env_steps_sampled": 7273756, "num_env_steps_trained": 7273756, "num_agent_steps_sampled": 7273756, "num_agent_steps_trained": 7273756}, "done": false, "episodes_total": 1708, "training_iteration": 470, "trial_id": "2f030_00000", "date": "2025-06-07_09-31-10", "timestamp": 1749281470, "time_this_iter_s": 69.91528224945068, "time_total_s": 6881.09897685051, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6881.09897685051, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 65.49382716049382, "ram_util_percent": 68.94320987654322, "gpu_util_percent0": 0.06567901234567902, "vram_util_percent0": 0.8592122395833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.1522978947368433e-05, "total_loss": -0.055532276578332214, "policy_loss": -0.02856558903416788, "vf_loss": 0.015936636056073688, "vf_explained_var": 0.7379308021068574, "kl": 0.013084478275018569, "entropy": 20.531349757801404, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 67375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7289394, "num_env_steps_trained": 7289394, "num_agent_steps_sampled": 7289394, "num_agent_steps_trained": 7289394}, "sampler_results": {"episode_reward_max": 10.900535290040368, "episode_reward_min": -0.6230720676256791, "episode_reward_mean": 6.039697796727521, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.688947769197002, 5.842833835314821, 4.015470748393668, 8.803406448787433, 6.710262055185729, 9.408093323066499, 8.953678662783373, 6.127826491175248, 5.220649126659735, 4.820017739953714, 6.4095451119316555, 4.06854846815549, 7.024274161577604, 5.460336846589662, 6.67289063178606, 3.5089664930235656, 10.850072088960195, 2.3328272276618085, 3.3608041173737475, 5.636596823696809, 6.562468019496572, 8.59643685954559, 10.238263465648282, 2.5268171680247122, 4.77431367554783, 7.769109915695946, 9.00125242068207, 6.19265586974789, 3.758544783922301, 7.992065599850636, 1.268769302370103, 7.365285920988189, 4.945497932833343, 6.80495805766244, 7.086315171487019, 2.7010917890481974, 5.445637683835624, -0.6230720676256791, 2.4955117854181013, 7.125389663085685, 5.9927654549523925, 2.1436846668422307, 5.380350348782047, 4.7263757619923386, 5.5665354742498625, 7.150461018252611, 7.984092828796251, 5.6761309538200955, 9.899995049348599, 7.648492540552544, 2.4114167748490734, 1.8152923019460931, 7.609164414591844, 4.450986780135531, 7.944853655247176, 1.52888978145297, 7.8338921111172795, 7.628996164875149, 4.429601252497637, 9.05940897066619, 5.157948384639581, 6.152297927484441, 3.9142373404505486, 8.285405316122102, 5.704135942925889, 6.985655280943682, 4.458581675650954, 10.467539660082192, 2.0944897006023657, 6.878983544863534, 7.217808671566287, 1.868633908164628, 8.643789551107517, 3.226179234621909, 3.4284600124538005, 4.956977507238417, 4.905227066554276, 3.8472582235855755, 7.661155099729198, 8.163248967369888, 5.825134278316813, 4.713652331705145, 6.222853635544032, 6.82508510283226, 9.587264289401173, 2.059993574835073, 6.529883499844275, 4.620593118434741, 9.818252613160015, 6.055165113492, 9.104628884732366, 8.977189412637957, 4.6558559681354925, 2.452210471775044, 10.900535290040368, 6.933427551440683, 9.610276282707813, 8.282687993265041, 9.070173939249257, 6.882155811539324], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8249785675642287, "mean_inference_ms": 8.084159134595138, "mean_action_processing_ms": 0.5431492748083149, "mean_env_wait_ms": 24.005344169661743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03728437423706055, "StateBufferConnector_ms": 0.04007411003112793, "ViewRequirementAgentConnector_ms": 0.973330020904541}}, "episode_reward_max": 10.900535290040368, "episode_reward_min": -0.6230720676256791, "episode_reward_mean": 6.039697796727521, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.688947769197002, 5.842833835314821, 4.015470748393668, 8.803406448787433, 6.710262055185729, 9.408093323066499, 8.953678662783373, 6.127826491175248, 5.220649126659735, 4.820017739953714, 6.4095451119316555, 4.06854846815549, 7.024274161577604, 5.460336846589662, 6.67289063178606, 3.5089664930235656, 10.850072088960195, 2.3328272276618085, 3.3608041173737475, 5.636596823696809, 6.562468019496572, 8.59643685954559, 10.238263465648282, 2.5268171680247122, 4.77431367554783, 7.769109915695946, 9.00125242068207, 6.19265586974789, 3.758544783922301, 7.992065599850636, 1.268769302370103, 7.365285920988189, 4.945497932833343, 6.80495805766244, 7.086315171487019, 2.7010917890481974, 5.445637683835624, -0.6230720676256791, 2.4955117854181013, 7.125389663085685, 5.9927654549523925, 2.1436846668422307, 5.380350348782047, 4.7263757619923386, 5.5665354742498625, 7.150461018252611, 7.984092828796251, 5.6761309538200955, 9.899995049348599, 7.648492540552544, 2.4114167748490734, 1.8152923019460931, 7.609164414591844, 4.450986780135531, 7.944853655247176, 1.52888978145297, 7.8338921111172795, 7.628996164875149, 4.429601252497637, 9.05940897066619, 5.157948384639581, 6.152297927484441, 3.9142373404505486, 8.285405316122102, 5.704135942925889, 6.985655280943682, 4.458581675650954, 10.467539660082192, 2.0944897006023657, 6.878983544863534, 7.217808671566287, 1.868633908164628, 8.643789551107517, 3.226179234621909, 3.4284600124538005, 4.956977507238417, 4.905227066554276, 3.8472582235855755, 7.661155099729198, 8.163248967369888, 5.825134278316813, 4.713652331705145, 6.222853635544032, 6.82508510283226, 9.587264289401173, 2.059993574835073, 6.529883499844275, 4.620593118434741, 9.818252613160015, 6.055165113492, 9.104628884732366, 8.977189412637957, 4.6558559681354925, 2.452210471775044, 10.900535290040368, 6.933427551440683, 9.610276282707813, 8.282687993265041, 9.070173939249257, 6.882155811539324], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8249785675642287, "mean_inference_ms": 8.084159134595138, "mean_action_processing_ms": 0.5431492748083149, "mean_env_wait_ms": 24.005344169661743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03728437423706055, "StateBufferConnector_ms": 0.04007411003112793, "ViewRequirementAgentConnector_ms": 0.973330020904541}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7289394, "num_agent_steps_trained": 7289394, "num_env_steps_sampled": 7289394, "num_env_steps_trained": 7289394, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.81426300675724, "num_env_steps_trained_throughput_per_sec": 280.81426300675724, "timesteps_total": 7289394, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7289394, "timers": {"training_iteration_time_ms": 55258.503, "sample_time_ms": 42144.641, "load_time_ms": 1723.879, "load_throughput": 9071.403, "learn_time_ms": 10822.75, "learn_throughput": 1444.919, "synch_weights_time_ms": 457.441}, "counters": {"num_env_steps_sampled": 7289394, "num_env_steps_trained": 7289394, "num_agent_steps_sampled": 7289394, "num_agent_steps_trained": 7289394}, "done": false, "episodes_total": 1722, "training_iteration": 471, "trial_id": "2f030_00000", "date": "2025-06-07_09-32-06", "timestamp": 1749281526, "time_this_iter_s": 55.71023607254028, "time_total_s": 6936.80921292305, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6936.80921292305, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 77.63125, "ram_util_percent": 69.571875, "gpu_util_percent0": 0.075625, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.139952105263159e-05, "total_loss": -0.048754893615418536, "policy_loss": -0.021502830623490312, "vf_loss": 0.014604267062280666, "vf_explained_var": 0.7528151182694869, "kl": 0.013199357252943229, "entropy": 20.51507532119751, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 67925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7305032, "num_env_steps_trained": 7305032, "num_agent_steps_sampled": 7305032, "num_agent_steps_trained": 7305032}, "sampler_results": {"episode_reward_max": 11.244523029865492, "episode_reward_min": -0.6230720676256791, "episode_reward_mean": 6.228998309325955, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.67289063178606, 3.5089664930235656, 10.850072088960195, 2.3328272276618085, 3.3608041173737475, 5.636596823696809, 6.562468019496572, 8.59643685954559, 10.238263465648282, 2.5268171680247122, 4.77431367554783, 7.769109915695946, 9.00125242068207, 6.19265586974789, 3.758544783922301, 7.992065599850636, 1.268769302370103, 7.365285920988189, 4.945497932833343, 6.80495805766244, 7.086315171487019, 2.7010917890481974, 5.445637683835624, -0.6230720676256791, 2.4955117854181013, 7.125389663085685, 5.9927654549523925, 2.1436846668422307, 5.380350348782047, 4.7263757619923386, 5.5665354742498625, 7.150461018252611, 7.984092828796251, 5.6761309538200955, 9.899995049348599, 7.648492540552544, 2.4114167748490734, 1.8152923019460931, 7.609164414591844, 4.450986780135531, 7.944853655247176, 1.52888978145297, 7.8338921111172795, 7.628996164875149, 4.429601252497637, 9.05940897066619, 5.157948384639581, 6.152297927484441, 3.9142373404505486, 8.285405316122102, 5.704135942925889, 6.985655280943682, 4.458581675650954, 10.467539660082192, 2.0944897006023657, 6.878983544863534, 7.217808671566287, 1.868633908164628, 8.643789551107517, 3.226179234621909, 3.4284600124538005, 4.956977507238417, 4.905227066554276, 3.8472582235855755, 7.661155099729198, 8.163248967369888, 5.825134278316813, 4.713652331705145, 6.222853635544032, 6.82508510283226, 9.587264289401173, 2.059993574835073, 6.529883499844275, 4.620593118434741, 9.818252613160015, 6.055165113492, 9.104628884732366, 8.977189412637957, 4.6558559681354925, 2.452210471775044, 10.900535290040368, 6.933427551440683, 9.610276282707813, 8.282687993265041, 9.070173939249257, 6.882155811539324, 8.763844776630984, 9.1570178232452, 8.233928317114692, 7.10370758364483, 6.2197866704494285, 10.806760862217933, 7.604109018320707, 5.1067390135543835, 8.98021590693922, 10.194402424090192, 11.244523029865492, 2.8259889268908194, 3.987686902086012, 8.255230793565032], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8232093878212465, "mean_inference_ms": 8.085450356373748, "mean_action_processing_ms": 0.5432106366771339, "mean_env_wait_ms": 24.00882738125469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04128623008728027, "StateBufferConnector_ms": 0.04266953468322754, "ViewRequirementAgentConnector_ms": 0.9796051979064941}}, "episode_reward_max": 11.244523029865492, "episode_reward_min": -0.6230720676256791, "episode_reward_mean": 6.228998309325955, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.67289063178606, 3.5089664930235656, 10.850072088960195, 2.3328272276618085, 3.3608041173737475, 5.636596823696809, 6.562468019496572, 8.59643685954559, 10.238263465648282, 2.5268171680247122, 4.77431367554783, 7.769109915695946, 9.00125242068207, 6.19265586974789, 3.758544783922301, 7.992065599850636, 1.268769302370103, 7.365285920988189, 4.945497932833343, 6.80495805766244, 7.086315171487019, 2.7010917890481974, 5.445637683835624, -0.6230720676256791, 2.4955117854181013, 7.125389663085685, 5.9927654549523925, 2.1436846668422307, 5.380350348782047, 4.7263757619923386, 5.5665354742498625, 7.150461018252611, 7.984092828796251, 5.6761309538200955, 9.899995049348599, 7.648492540552544, 2.4114167748490734, 1.8152923019460931, 7.609164414591844, 4.450986780135531, 7.944853655247176, 1.52888978145297, 7.8338921111172795, 7.628996164875149, 4.429601252497637, 9.05940897066619, 5.157948384639581, 6.152297927484441, 3.9142373404505486, 8.285405316122102, 5.704135942925889, 6.985655280943682, 4.458581675650954, 10.467539660082192, 2.0944897006023657, 6.878983544863534, 7.217808671566287, 1.868633908164628, 8.643789551107517, 3.226179234621909, 3.4284600124538005, 4.956977507238417, 4.905227066554276, 3.8472582235855755, 7.661155099729198, 8.163248967369888, 5.825134278316813, 4.713652331705145, 6.222853635544032, 6.82508510283226, 9.587264289401173, 2.059993574835073, 6.529883499844275, 4.620593118434741, 9.818252613160015, 6.055165113492, 9.104628884732366, 8.977189412637957, 4.6558559681354925, 2.452210471775044, 10.900535290040368, 6.933427551440683, 9.610276282707813, 8.282687993265041, 9.070173939249257, 6.882155811539324, 8.763844776630984, 9.1570178232452, 8.233928317114692, 7.10370758364483, 6.2197866704494285, 10.806760862217933, 7.604109018320707, 5.1067390135543835, 8.98021590693922, 10.194402424090192, 11.244523029865492, 2.8259889268908194, 3.987686902086012, 8.255230793565032], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8232093878212465, "mean_inference_ms": 8.085450356373748, "mean_action_processing_ms": 0.5432106366771339, "mean_env_wait_ms": 24.00882738125469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04128623008728027, "StateBufferConnector_ms": 0.04266953468322754, "ViewRequirementAgentConnector_ms": 0.9796051979064941}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7305032, "num_agent_steps_trained": 7305032, "num_env_steps_sampled": 7305032, "num_env_steps_trained": 7305032, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.87260110314554, "num_env_steps_trained_throughput_per_sec": 278.87260110314554, "timesteps_total": 7305032, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7305032, "timers": {"training_iteration_time_ms": 55332.114, "sample_time_ms": 42203.955, "load_time_ms": 1727.469, "load_throughput": 9052.551, "learn_time_ms": 10828.46, "learn_throughput": 1444.157, "synch_weights_time_ms": 461.255}, "counters": {"num_env_steps_sampled": 7305032, "num_env_steps_trained": 7305032, "num_agent_steps_sampled": 7305032, "num_agent_steps_trained": 7305032}, "done": false, "episodes_total": 1736, "training_iteration": 472, "trial_id": "2f030_00000", "date": "2025-06-07_09-33-02", "timestamp": 1749281582, "time_this_iter_s": 56.09277868270874, "time_total_s": 6992.901991605759, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6992.901991605759, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 77.5015625, "ram_util_percent": 70.0671875, "gpu_util_percent0": 0.07734374999999999, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.1276063157894736e-05, "total_loss": -0.06837437822652812, "policy_loss": -0.04040866251315244, "vf_loss": 0.013317332489585335, "vf_explained_var": 0.7547463393211364, "kl": 0.012956706884751012, "entropy": 20.592488417191937, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 68475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7320670, "num_env_steps_trained": 7320670, "num_agent_steps_sampled": 7320670, "num_agent_steps_trained": 7320670}, "sampler_results": {"episode_reward_max": 11.244523029865492, "episode_reward_min": -0.6230720676256791, "episode_reward_mean": 6.215116175386954, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.758544783922301, 7.992065599850636, 1.268769302370103, 7.365285920988189, 4.945497932833343, 6.80495805766244, 7.086315171487019, 2.7010917890481974, 5.445637683835624, -0.6230720676256791, 2.4955117854181013, 7.125389663085685, 5.9927654549523925, 2.1436846668422307, 5.380350348782047, 4.7263757619923386, 5.5665354742498625, 7.150461018252611, 7.984092828796251, 5.6761309538200955, 9.899995049348599, 7.648492540552544, 2.4114167748490734, 1.8152923019460931, 7.609164414591844, 4.450986780135531, 7.944853655247176, 1.52888978145297, 7.8338921111172795, 7.628996164875149, 4.429601252497637, 9.05940897066619, 5.157948384639581, 6.152297927484441, 3.9142373404505486, 8.285405316122102, 5.704135942925889, 6.985655280943682, 4.458581675650954, 10.467539660082192, 2.0944897006023657, 6.878983544863534, 7.217808671566287, 1.868633908164628, 8.643789551107517, 3.226179234621909, 3.4284600124538005, 4.956977507238417, 4.905227066554276, 3.8472582235855755, 7.661155099729198, 8.163248967369888, 5.825134278316813, 4.713652331705145, 6.222853635544032, 6.82508510283226, 9.587264289401173, 2.059993574835073, 6.529883499844275, 4.620593118434741, 9.818252613160015, 6.055165113492, 9.104628884732366, 8.977189412637957, 4.6558559681354925, 2.452210471775044, 10.900535290040368, 6.933427551440683, 9.610276282707813, 8.282687993265041, 9.070173939249257, 6.882155811539324, 8.763844776630984, 9.1570178232452, 8.233928317114692, 7.10370758364483, 6.2197866704494285, 10.806760862217933, 7.604109018320707, 5.1067390135543835, 8.98021590693922, 10.194402424090192, 11.244523029865492, 2.8259889268908194, 3.987686902086012, 8.255230793565032, 5.336788693257107, 6.165409130357684, 8.727378956707625, 4.329770882294165, 8.641540411304902, 1.865139474300606, 5.241114377594356, 8.563263511832744, 6.5105346595831275, 6.245579616250002, 8.335248252873383, 7.7286928861338495, 6.605262573682822, 2.3395379568185777], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.821426019467927, "mean_inference_ms": 8.086569056641759, "mean_action_processing_ms": 0.5432742097045851, "mean_env_wait_ms": 24.01160019466642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043291568756103516, "StateBufferConnector_ms": 0.04164576530456543, "ViewRequirementAgentConnector_ms": 0.9693253040313721}}, "episode_reward_max": 11.244523029865492, "episode_reward_min": -0.6230720676256791, "episode_reward_mean": 6.215116175386954, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.758544783922301, 7.992065599850636, 1.268769302370103, 7.365285920988189, 4.945497932833343, 6.80495805766244, 7.086315171487019, 2.7010917890481974, 5.445637683835624, -0.6230720676256791, 2.4955117854181013, 7.125389663085685, 5.9927654549523925, 2.1436846668422307, 5.380350348782047, 4.7263757619923386, 5.5665354742498625, 7.150461018252611, 7.984092828796251, 5.6761309538200955, 9.899995049348599, 7.648492540552544, 2.4114167748490734, 1.8152923019460931, 7.609164414591844, 4.450986780135531, 7.944853655247176, 1.52888978145297, 7.8338921111172795, 7.628996164875149, 4.429601252497637, 9.05940897066619, 5.157948384639581, 6.152297927484441, 3.9142373404505486, 8.285405316122102, 5.704135942925889, 6.985655280943682, 4.458581675650954, 10.467539660082192, 2.0944897006023657, 6.878983544863534, 7.217808671566287, 1.868633908164628, 8.643789551107517, 3.226179234621909, 3.4284600124538005, 4.956977507238417, 4.905227066554276, 3.8472582235855755, 7.661155099729198, 8.163248967369888, 5.825134278316813, 4.713652331705145, 6.222853635544032, 6.82508510283226, 9.587264289401173, 2.059993574835073, 6.529883499844275, 4.620593118434741, 9.818252613160015, 6.055165113492, 9.104628884732366, 8.977189412637957, 4.6558559681354925, 2.452210471775044, 10.900535290040368, 6.933427551440683, 9.610276282707813, 8.282687993265041, 9.070173939249257, 6.882155811539324, 8.763844776630984, 9.1570178232452, 8.233928317114692, 7.10370758364483, 6.2197866704494285, 10.806760862217933, 7.604109018320707, 5.1067390135543835, 8.98021590693922, 10.194402424090192, 11.244523029865492, 2.8259889268908194, 3.987686902086012, 8.255230793565032, 5.336788693257107, 6.165409130357684, 8.727378956707625, 4.329770882294165, 8.641540411304902, 1.865139474300606, 5.241114377594356, 8.563263511832744, 6.5105346595831275, 6.245579616250002, 8.335248252873383, 7.7286928861338495, 6.605262573682822, 2.3395379568185777], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.821426019467927, "mean_inference_ms": 8.086569056641759, "mean_action_processing_ms": 0.5432742097045851, "mean_env_wait_ms": 24.01160019466642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043291568756103516, "StateBufferConnector_ms": 0.04164576530456543, "ViewRequirementAgentConnector_ms": 0.9693253040313721}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7320670, "num_agent_steps_trained": 7320670, "num_env_steps_sampled": 7320670, "num_env_steps_trained": 7320670, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.5972035960331, "num_env_steps_trained_throughput_per_sec": 285.5972035960331, "timesteps_total": 7320670, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7320670, "timers": {"training_iteration_time_ms": 55291.914, "sample_time_ms": 42202.093, "load_time_ms": 1727.94, "load_throughput": 9050.083, "learn_time_ms": 10794.433, "learn_throughput": 1448.71, "synch_weights_time_ms": 458.097}, "counters": {"num_env_steps_sampled": 7320670, "num_env_steps_trained": 7320670, "num_agent_steps_sampled": 7320670, "num_agent_steps_trained": 7320670}, "done": false, "episodes_total": 1750, "training_iteration": 473, "trial_id": "2f030_00000", "date": "2025-06-07_09-33-57", "timestamp": 1749281637, "time_this_iter_s": 54.771119117736816, "time_total_s": 7047.6731107234955, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7047.6731107234955, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 77.23650793650795, "ram_util_percent": 69.88730158730161, "gpu_util_percent0": 0.07333333333333333, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.1152605263157894e-05, "total_loss": -0.05190456471702253, "policy_loss": -0.02409541492276317, "vf_loss": 0.014296084018424153, "vf_explained_var": 0.7644137151674791, "kl": 0.012864077040205963, "entropy": 20.628044671145354, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 69025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7336308, "num_env_steps_trained": 7336308, "num_agent_steps_sampled": 7336308, "num_agent_steps_trained": 7336308}, "sampler_results": {"episode_reward_max": 12.51801138724105, "episode_reward_min": -0.10653349925771675, "episode_reward_mean": 6.463712837029716, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.380350348782047, 4.7263757619923386, 5.5665354742498625, 7.150461018252611, 7.984092828796251, 5.6761309538200955, 9.899995049348599, 7.648492540552544, 2.4114167748490734, 1.8152923019460931, 7.609164414591844, 4.450986780135531, 7.944853655247176, 1.52888978145297, 7.8338921111172795, 7.628996164875149, 4.429601252497637, 9.05940897066619, 5.157948384639581, 6.152297927484441, 3.9142373404505486, 8.285405316122102, 5.704135942925889, 6.985655280943682, 4.458581675650954, 10.467539660082192, 2.0944897006023657, 6.878983544863534, 7.217808671566287, 1.868633908164628, 8.643789551107517, 3.226179234621909, 3.4284600124538005, 4.956977507238417, 4.905227066554276, 3.8472582235855755, 7.661155099729198, 8.163248967369888, 5.825134278316813, 4.713652331705145, 6.222853635544032, 6.82508510283226, 9.587264289401173, 2.059993574835073, 6.529883499844275, 4.620593118434741, 9.818252613160015, 6.055165113492, 9.104628884732366, 8.977189412637957, 4.6558559681354925, 2.452210471775044, 10.900535290040368, 6.933427551440683, 9.610276282707813, 8.282687993265041, 9.070173939249257, 6.882155811539324, 8.763844776630984, 9.1570178232452, 8.233928317114692, 7.10370758364483, 6.2197866704494285, 10.806760862217933, 7.604109018320707, 5.1067390135543835, 8.98021590693922, 10.194402424090192, 11.244523029865492, 2.8259889268908194, 3.987686902086012, 8.255230793565032, 5.336788693257107, 6.165409130357684, 8.727378956707625, 4.329770882294165, 8.641540411304902, 1.865139474300606, 5.241114377594356, 8.563263511832744, 6.5105346595831275, 6.245579616250002, 8.335248252873383, 7.7286928861338495, 6.605262573682822, 2.3395379568185777, 7.221658869562565, 2.381285071610137, 0.0024102189169263946, 6.162304600139594, 6.976728537821492, 7.144720391008416, 8.05190315654804, 10.894928511657668, 8.410566886991436, 5.863638093703121, 12.51801138724105, -0.10653349925771675, 6.1002233579964456, 7.740266325007577], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.819579546796313, "mean_inference_ms": 8.087752611049956, "mean_action_processing_ms": 0.5433470593747608, "mean_env_wait_ms": 24.014672083316967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039247989654541016, "StateBufferConnector_ms": 0.04262518882751465, "ViewRequirementAgentConnector_ms": 1.0112242698669434}}, "episode_reward_max": 12.51801138724105, "episode_reward_min": -0.10653349925771675, "episode_reward_mean": 6.463712837029716, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.380350348782047, 4.7263757619923386, 5.5665354742498625, 7.150461018252611, 7.984092828796251, 5.6761309538200955, 9.899995049348599, 7.648492540552544, 2.4114167748490734, 1.8152923019460931, 7.609164414591844, 4.450986780135531, 7.944853655247176, 1.52888978145297, 7.8338921111172795, 7.628996164875149, 4.429601252497637, 9.05940897066619, 5.157948384639581, 6.152297927484441, 3.9142373404505486, 8.285405316122102, 5.704135942925889, 6.985655280943682, 4.458581675650954, 10.467539660082192, 2.0944897006023657, 6.878983544863534, 7.217808671566287, 1.868633908164628, 8.643789551107517, 3.226179234621909, 3.4284600124538005, 4.956977507238417, 4.905227066554276, 3.8472582235855755, 7.661155099729198, 8.163248967369888, 5.825134278316813, 4.713652331705145, 6.222853635544032, 6.82508510283226, 9.587264289401173, 2.059993574835073, 6.529883499844275, 4.620593118434741, 9.818252613160015, 6.055165113492, 9.104628884732366, 8.977189412637957, 4.6558559681354925, 2.452210471775044, 10.900535290040368, 6.933427551440683, 9.610276282707813, 8.282687993265041, 9.070173939249257, 6.882155811539324, 8.763844776630984, 9.1570178232452, 8.233928317114692, 7.10370758364483, 6.2197866704494285, 10.806760862217933, 7.604109018320707, 5.1067390135543835, 8.98021590693922, 10.194402424090192, 11.244523029865492, 2.8259889268908194, 3.987686902086012, 8.255230793565032, 5.336788693257107, 6.165409130357684, 8.727378956707625, 4.329770882294165, 8.641540411304902, 1.865139474300606, 5.241114377594356, 8.563263511832744, 6.5105346595831275, 6.245579616250002, 8.335248252873383, 7.7286928861338495, 6.605262573682822, 2.3395379568185777, 7.221658869562565, 2.381285071610137, 0.0024102189169263946, 6.162304600139594, 6.976728537821492, 7.144720391008416, 8.05190315654804, 10.894928511657668, 8.410566886991436, 5.863638093703121, 12.51801138724105, -0.10653349925771675, 6.1002233579964456, 7.740266325007577], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.819579546796313, "mean_inference_ms": 8.087752611049956, "mean_action_processing_ms": 0.5433470593747608, "mean_env_wait_ms": 24.014672083316967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039247989654541016, "StateBufferConnector_ms": 0.04262518882751465, "ViewRequirementAgentConnector_ms": 1.0112242698669434}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7336308, "num_agent_steps_trained": 7336308, "num_env_steps_sampled": 7336308, "num_env_steps_trained": 7336308, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.1253099698858, "num_env_steps_trained_throughput_per_sec": 281.1253099698858, "timesteps_total": 7336308, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7336308, "timers": {"training_iteration_time_ms": 55368.037, "sample_time_ms": 42234.62, "load_time_ms": 1740.94, "load_throughput": 8982.505, "learn_time_ms": 10825.782, "learn_throughput": 1444.515, "synch_weights_time_ms": 455.752}, "counters": {"num_env_steps_sampled": 7336308, "num_env_steps_trained": 7336308, "num_agent_steps_sampled": 7336308, "num_agent_steps_trained": 7336308}, "done": false, "episodes_total": 1764, "training_iteration": 474, "trial_id": "2f030_00000", "date": "2025-06-07_09-34-52", "timestamp": 1749281692, "time_this_iter_s": 55.64344549179077, "time_total_s": 7103.316556215286, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7103.316556215286, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 78.28253968253965, "ram_util_percent": 70.05079365079366, "gpu_util_percent0": 0.07793650793650794, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.102914736842105e-05, "total_loss": -0.041046588364141906, "policy_loss": -0.013787792801370167, "vf_loss": 0.015477285949005323, "vf_explained_var": 0.7551549350131642, "kl": 0.012807480408928795, "entropy": 20.50990251714533, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 69575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7351946, "num_env_steps_trained": 7351946, "num_agent_steps_sampled": 7351946, "num_agent_steps_trained": 7351946}, "sampler_results": {"episode_reward_max": 12.51801138724105, "episode_reward_min": -0.10653349925771675, "episode_reward_mean": 6.699007556250808, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.8338921111172795, 7.628996164875149, 4.429601252497637, 9.05940897066619, 5.157948384639581, 6.152297927484441, 3.9142373404505486, 8.285405316122102, 5.704135942925889, 6.985655280943682, 4.458581675650954, 10.467539660082192, 2.0944897006023657, 6.878983544863534, 7.217808671566287, 1.868633908164628, 8.643789551107517, 3.226179234621909, 3.4284600124538005, 4.956977507238417, 4.905227066554276, 3.8472582235855755, 7.661155099729198, 8.163248967369888, 5.825134278316813, 4.713652331705145, 6.222853635544032, 6.82508510283226, 9.587264289401173, 2.059993574835073, 6.529883499844275, 4.620593118434741, 9.818252613160015, 6.055165113492, 9.104628884732366, 8.977189412637957, 4.6558559681354925, 2.452210471775044, 10.900535290040368, 6.933427551440683, 9.610276282707813, 8.282687993265041, 9.070173939249257, 6.882155811539324, 8.763844776630984, 9.1570178232452, 8.233928317114692, 7.10370758364483, 6.2197866704494285, 10.806760862217933, 7.604109018320707, 5.1067390135543835, 8.98021590693922, 10.194402424090192, 11.244523029865492, 2.8259889268908194, 3.987686902086012, 8.255230793565032, 5.336788693257107, 6.165409130357684, 8.727378956707625, 4.329770882294165, 8.641540411304902, 1.865139474300606, 5.241114377594356, 8.563263511832744, 6.5105346595831275, 6.245579616250002, 8.335248252873383, 7.7286928861338495, 6.605262573682822, 2.3395379568185777, 7.221658869562565, 2.381285071610137, 0.0024102189169263946, 6.162304600139594, 6.976728537821492, 7.144720391008416, 8.05190315654804, 10.894928511657668, 8.410566886991436, 5.863638093703121, 12.51801138724105, -0.10653349925771675, 6.1002233579964456, 7.740266325007577, 7.485417889822215, 12.106760822680403, 6.0912311962785335, 9.235021762819235, 9.578135288992613, 6.337998077567132, 2.421407313597467, 6.374189237109676, 6.619363390017009, 6.5001927011757425, 8.583483217906629, 8.382863905143243, 6.357903444790262, 7.2485413582260545], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8177967190737907, "mean_inference_ms": 8.089107190045333, "mean_action_processing_ms": 0.5433978263260785, "mean_env_wait_ms": 24.018032089567974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03823351860046387, "StateBufferConnector_ms": 0.044582366943359375, "ViewRequirementAgentConnector_ms": 0.9766392707824707}}, "episode_reward_max": 12.51801138724105, "episode_reward_min": -0.10653349925771675, "episode_reward_mean": 6.699007556250808, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.8338921111172795, 7.628996164875149, 4.429601252497637, 9.05940897066619, 5.157948384639581, 6.152297927484441, 3.9142373404505486, 8.285405316122102, 5.704135942925889, 6.985655280943682, 4.458581675650954, 10.467539660082192, 2.0944897006023657, 6.878983544863534, 7.217808671566287, 1.868633908164628, 8.643789551107517, 3.226179234621909, 3.4284600124538005, 4.956977507238417, 4.905227066554276, 3.8472582235855755, 7.661155099729198, 8.163248967369888, 5.825134278316813, 4.713652331705145, 6.222853635544032, 6.82508510283226, 9.587264289401173, 2.059993574835073, 6.529883499844275, 4.620593118434741, 9.818252613160015, 6.055165113492, 9.104628884732366, 8.977189412637957, 4.6558559681354925, 2.452210471775044, 10.900535290040368, 6.933427551440683, 9.610276282707813, 8.282687993265041, 9.070173939249257, 6.882155811539324, 8.763844776630984, 9.1570178232452, 8.233928317114692, 7.10370758364483, 6.2197866704494285, 10.806760862217933, 7.604109018320707, 5.1067390135543835, 8.98021590693922, 10.194402424090192, 11.244523029865492, 2.8259889268908194, 3.987686902086012, 8.255230793565032, 5.336788693257107, 6.165409130357684, 8.727378956707625, 4.329770882294165, 8.641540411304902, 1.865139474300606, 5.241114377594356, 8.563263511832744, 6.5105346595831275, 6.245579616250002, 8.335248252873383, 7.7286928861338495, 6.605262573682822, 2.3395379568185777, 7.221658869562565, 2.381285071610137, 0.0024102189169263946, 6.162304600139594, 6.976728537821492, 7.144720391008416, 8.05190315654804, 10.894928511657668, 8.410566886991436, 5.863638093703121, 12.51801138724105, -0.10653349925771675, 6.1002233579964456, 7.740266325007577, 7.485417889822215, 12.106760822680403, 6.0912311962785335, 9.235021762819235, 9.578135288992613, 6.337998077567132, 2.421407313597467, 6.374189237109676, 6.619363390017009, 6.5001927011757425, 8.583483217906629, 8.382863905143243, 6.357903444790262, 7.2485413582260545], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8177967190737907, "mean_inference_ms": 8.089107190045333, "mean_action_processing_ms": 0.5433978263260785, "mean_env_wait_ms": 24.018032089567974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03823351860046387, "StateBufferConnector_ms": 0.044582366943359375, "ViewRequirementAgentConnector_ms": 0.9766392707824707}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7351946, "num_agent_steps_trained": 7351946, "num_env_steps_sampled": 7351946, "num_env_steps_trained": 7351946, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.7988115283247, "num_env_steps_trained_throughput_per_sec": 278.7988115283247, "timesteps_total": 7351946, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7351946, "timers": {"training_iteration_time_ms": 55441.42, "sample_time_ms": 42274.674, "load_time_ms": 1747.973, "load_throughput": 8946.364, "learn_time_ms": 10821.326, "learn_throughput": 1445.109, "synch_weights_time_ms": 482.888}, "counters": {"num_env_steps_sampled": 7351946, "num_env_steps_trained": 7351946, "num_agent_steps_sampled": 7351946, "num_agent_steps_trained": 7351946}, "done": false, "episodes_total": 1778, "training_iteration": 475, "trial_id": "2f030_00000", "date": "2025-06-07_09-35-49", "timestamp": 1749281749, "time_this_iter_s": 56.106608629226685, "time_total_s": 7159.423164844513, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7159.423164844513, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 76.66615384615386, "ram_util_percent": 69.88000000000001, "gpu_util_percent0": 0.08384615384615383, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.090568947368422e-05, "total_loss": -0.050067343348213895, "policy_loss": -0.02200190245742719, "vf_loss": 0.013821213380856947, "vf_explained_var": 0.7618789339065551, "kl": 0.012374582459996165, "entropy": 20.510720998590642, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 70125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7367584, "num_env_steps_trained": 7367584, "num_agent_steps_sampled": 7367584, "num_agent_steps_trained": 7367584}, "sampler_results": {"episode_reward_max": 12.51801138724105, "episode_reward_min": -0.10653349925771675, "episode_reward_mean": 6.886462816449174, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.217808671566287, 1.868633908164628, 8.643789551107517, 3.226179234621909, 3.4284600124538005, 4.956977507238417, 4.905227066554276, 3.8472582235855755, 7.661155099729198, 8.163248967369888, 5.825134278316813, 4.713652331705145, 6.222853635544032, 6.82508510283226, 9.587264289401173, 2.059993574835073, 6.529883499844275, 4.620593118434741, 9.818252613160015, 6.055165113492, 9.104628884732366, 8.977189412637957, 4.6558559681354925, 2.452210471775044, 10.900535290040368, 6.933427551440683, 9.610276282707813, 8.282687993265041, 9.070173939249257, 6.882155811539324, 8.763844776630984, 9.1570178232452, 8.233928317114692, 7.10370758364483, 6.2197866704494285, 10.806760862217933, 7.604109018320707, 5.1067390135543835, 8.98021590693922, 10.194402424090192, 11.244523029865492, 2.8259889268908194, 3.987686902086012, 8.255230793565032, 5.336788693257107, 6.165409130357684, 8.727378956707625, 4.329770882294165, 8.641540411304902, 1.865139474300606, 5.241114377594356, 8.563263511832744, 6.5105346595831275, 6.245579616250002, 8.335248252873383, 7.7286928861338495, 6.605262573682822, 2.3395379568185777, 7.221658869562565, 2.381285071610137, 0.0024102189169263946, 6.162304600139594, 6.976728537821492, 7.144720391008416, 8.05190315654804, 10.894928511657668, 8.410566886991436, 5.863638093703121, 12.51801138724105, -0.10653349925771675, 6.1002233579964456, 7.740266325007577, 7.485417889822215, 12.106760822680403, 6.0912311962785335, 9.235021762819235, 9.578135288992613, 6.337998077567132, 2.421407313597467, 6.374189237109676, 6.619363390017009, 6.5001927011757425, 8.583483217906629, 8.382863905143243, 6.357903444790262, 7.2485413582260545, 8.740183552512171, 5.892114186901054, 10.638602231046223, 6.218730899151325, 9.08143986827025, 8.362097903533797, 4.1398546387996475, 7.60890393759649, 5.192207572007135, 9.694935527214698, 8.080351244350275, 8.867921610520586, 8.376323580437285, 6.903032540417146], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.816006082041243, "mean_inference_ms": 8.090485248141722, "mean_action_processing_ms": 0.543465856892576, "mean_env_wait_ms": 24.0210579752724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04574298858642578, "StateBufferConnector_ms": 0.042656898498535156, "ViewRequirementAgentConnector_ms": 0.981067419052124}}, "episode_reward_max": 12.51801138724105, "episode_reward_min": -0.10653349925771675, "episode_reward_mean": 6.886462816449174, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.217808671566287, 1.868633908164628, 8.643789551107517, 3.226179234621909, 3.4284600124538005, 4.956977507238417, 4.905227066554276, 3.8472582235855755, 7.661155099729198, 8.163248967369888, 5.825134278316813, 4.713652331705145, 6.222853635544032, 6.82508510283226, 9.587264289401173, 2.059993574835073, 6.529883499844275, 4.620593118434741, 9.818252613160015, 6.055165113492, 9.104628884732366, 8.977189412637957, 4.6558559681354925, 2.452210471775044, 10.900535290040368, 6.933427551440683, 9.610276282707813, 8.282687993265041, 9.070173939249257, 6.882155811539324, 8.763844776630984, 9.1570178232452, 8.233928317114692, 7.10370758364483, 6.2197866704494285, 10.806760862217933, 7.604109018320707, 5.1067390135543835, 8.98021590693922, 10.194402424090192, 11.244523029865492, 2.8259889268908194, 3.987686902086012, 8.255230793565032, 5.336788693257107, 6.165409130357684, 8.727378956707625, 4.329770882294165, 8.641540411304902, 1.865139474300606, 5.241114377594356, 8.563263511832744, 6.5105346595831275, 6.245579616250002, 8.335248252873383, 7.7286928861338495, 6.605262573682822, 2.3395379568185777, 7.221658869562565, 2.381285071610137, 0.0024102189169263946, 6.162304600139594, 6.976728537821492, 7.144720391008416, 8.05190315654804, 10.894928511657668, 8.410566886991436, 5.863638093703121, 12.51801138724105, -0.10653349925771675, 6.1002233579964456, 7.740266325007577, 7.485417889822215, 12.106760822680403, 6.0912311962785335, 9.235021762819235, 9.578135288992613, 6.337998077567132, 2.421407313597467, 6.374189237109676, 6.619363390017009, 6.5001927011757425, 8.583483217906629, 8.382863905143243, 6.357903444790262, 7.2485413582260545, 8.740183552512171, 5.892114186901054, 10.638602231046223, 6.218730899151325, 9.08143986827025, 8.362097903533797, 4.1398546387996475, 7.60890393759649, 5.192207572007135, 9.694935527214698, 8.080351244350275, 8.867921610520586, 8.376323580437285, 6.903032540417146], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.816006082041243, "mean_inference_ms": 8.090485248141722, "mean_action_processing_ms": 0.543465856892576, "mean_env_wait_ms": 24.0210579752724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04574298858642578, "StateBufferConnector_ms": 0.042656898498535156, "ViewRequirementAgentConnector_ms": 0.981067419052124}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7367584, "num_agent_steps_trained": 7367584, "num_env_steps_sampled": 7367584, "num_env_steps_trained": 7367584, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.79404724812963, "num_env_steps_trained_throughput_per_sec": 282.79404724812963, "timesteps_total": 7367584, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7367584, "timers": {"training_iteration_time_ms": 55413.246, "sample_time_ms": 42249.565, "load_time_ms": 1741.596, "load_throughput": 8979.118, "learn_time_ms": 10824.154, "learn_throughput": 1444.732, "synch_weights_time_ms": 483.07}, "counters": {"num_env_steps_sampled": 7367584, "num_env_steps_trained": 7367584, "num_agent_steps_sampled": 7367584, "num_agent_steps_trained": 7367584}, "done": false, "episodes_total": 1792, "training_iteration": 476, "trial_id": "2f030_00000", "date": "2025-06-07_09-36-44", "timestamp": 1749281804, "time_this_iter_s": 55.31419515609741, "time_total_s": 7214.73736000061, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7214.73736000061, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 78.20952380952383, "ram_util_percent": 69.96190476190475, "gpu_util_percent0": 0.0742857142857143, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.0782231578947374e-05, "total_loss": -0.046744538272985005, "policy_loss": -0.0196813381775494, "vf_loss": 0.01573414563370699, "vf_explained_var": 0.7430676499280062, "kl": 0.012808777155096464, "entropy": 20.45109563133933, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 70675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7383222, "num_env_steps_trained": 7383222, "num_agent_steps_sampled": 7383222, "num_agent_steps_trained": 7383222}, "sampler_results": {"episode_reward_max": 12.51801138724105, "episode_reward_min": -0.10653349925771675, "episode_reward_mean": 7.06714835972654, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.587264289401173, 2.059993574835073, 6.529883499844275, 4.620593118434741, 9.818252613160015, 6.055165113492, 9.104628884732366, 8.977189412637957, 4.6558559681354925, 2.452210471775044, 10.900535290040368, 6.933427551440683, 9.610276282707813, 8.282687993265041, 9.070173939249257, 6.882155811539324, 8.763844776630984, 9.1570178232452, 8.233928317114692, 7.10370758364483, 6.2197866704494285, 10.806760862217933, 7.604109018320707, 5.1067390135543835, 8.98021590693922, 10.194402424090192, 11.244523029865492, 2.8259889268908194, 3.987686902086012, 8.255230793565032, 5.336788693257107, 6.165409130357684, 8.727378956707625, 4.329770882294165, 8.641540411304902, 1.865139474300606, 5.241114377594356, 8.563263511832744, 6.5105346595831275, 6.245579616250002, 8.335248252873383, 7.7286928861338495, 6.605262573682822, 2.3395379568185777, 7.221658869562565, 2.381285071610137, 0.0024102189169263946, 6.162304600139594, 6.976728537821492, 7.144720391008416, 8.05190315654804, 10.894928511657668, 8.410566886991436, 5.863638093703121, 12.51801138724105, -0.10653349925771675, 6.1002233579964456, 7.740266325007577, 7.485417889822215, 12.106760822680403, 6.0912311962785335, 9.235021762819235, 9.578135288992613, 6.337998077567132, 2.421407313597467, 6.374189237109676, 6.619363390017009, 6.5001927011757425, 8.583483217906629, 8.382863905143243, 6.357903444790262, 7.2485413582260545, 8.740183552512171, 5.892114186901054, 10.638602231046223, 6.218730899151325, 9.08143986827025, 8.362097903533797, 4.1398546387996475, 7.60890393759649, 5.192207572007135, 9.694935527214698, 8.080351244350275, 8.867921610520586, 8.376323580437285, 6.903032540417146, 2.208203899551053, 7.802561818368865, 7.282088430660892, 7.940645170584344, 5.9286727439566, 9.8243724616575, 3.0644560835015224, 9.845351787850479, 9.10239667223799, 3.432959965149788, 9.52131253726508, 5.893985342258846, 5.5221458469970175, 8.204865158486518], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.81433287524503, "mean_inference_ms": 8.092025435758146, "mean_action_processing_ms": 0.5435401308793213, "mean_env_wait_ms": 24.024562577950213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04467320442199707, "StateBufferConnector_ms": 0.038668155670166016, "ViewRequirementAgentConnector_ms": 0.9990940093994141}}, "episode_reward_max": 12.51801138724105, "episode_reward_min": -0.10653349925771675, "episode_reward_mean": 7.06714835972654, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.587264289401173, 2.059993574835073, 6.529883499844275, 4.620593118434741, 9.818252613160015, 6.055165113492, 9.104628884732366, 8.977189412637957, 4.6558559681354925, 2.452210471775044, 10.900535290040368, 6.933427551440683, 9.610276282707813, 8.282687993265041, 9.070173939249257, 6.882155811539324, 8.763844776630984, 9.1570178232452, 8.233928317114692, 7.10370758364483, 6.2197866704494285, 10.806760862217933, 7.604109018320707, 5.1067390135543835, 8.98021590693922, 10.194402424090192, 11.244523029865492, 2.8259889268908194, 3.987686902086012, 8.255230793565032, 5.336788693257107, 6.165409130357684, 8.727378956707625, 4.329770882294165, 8.641540411304902, 1.865139474300606, 5.241114377594356, 8.563263511832744, 6.5105346595831275, 6.245579616250002, 8.335248252873383, 7.7286928861338495, 6.605262573682822, 2.3395379568185777, 7.221658869562565, 2.381285071610137, 0.0024102189169263946, 6.162304600139594, 6.976728537821492, 7.144720391008416, 8.05190315654804, 10.894928511657668, 8.410566886991436, 5.863638093703121, 12.51801138724105, -0.10653349925771675, 6.1002233579964456, 7.740266325007577, 7.485417889822215, 12.106760822680403, 6.0912311962785335, 9.235021762819235, 9.578135288992613, 6.337998077567132, 2.421407313597467, 6.374189237109676, 6.619363390017009, 6.5001927011757425, 8.583483217906629, 8.382863905143243, 6.357903444790262, 7.2485413582260545, 8.740183552512171, 5.892114186901054, 10.638602231046223, 6.218730899151325, 9.08143986827025, 8.362097903533797, 4.1398546387996475, 7.60890393759649, 5.192207572007135, 9.694935527214698, 8.080351244350275, 8.867921610520586, 8.376323580437285, 6.903032540417146, 2.208203899551053, 7.802561818368865, 7.282088430660892, 7.940645170584344, 5.9286727439566, 9.8243724616575, 3.0644560835015224, 9.845351787850479, 9.10239667223799, 3.432959965149788, 9.52131253726508, 5.893985342258846, 5.5221458469970175, 8.204865158486518], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.81433287524503, "mean_inference_ms": 8.092025435758146, "mean_action_processing_ms": 0.5435401308793213, "mean_env_wait_ms": 24.024562577950213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04467320442199707, "StateBufferConnector_ms": 0.038668155670166016, "ViewRequirementAgentConnector_ms": 0.9990940093994141}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7383222, "num_agent_steps_trained": 7383222, "num_env_steps_sampled": 7383222, "num_env_steps_trained": 7383222, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 279.3038080816426, "num_env_steps_trained_throughput_per_sec": 279.3038080816426, "timesteps_total": 7383222, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7383222, "timers": {"training_iteration_time_ms": 55517.775, "sample_time_ms": 42358.194, "load_time_ms": 1751.78, "load_throughput": 8926.919, "learn_time_ms": 10815.824, "learn_throughput": 1445.845, "synch_weights_time_ms": 477.158}, "counters": {"num_env_steps_sampled": 7383222, "num_env_steps_trained": 7383222, "num_agent_steps_sampled": 7383222, "num_agent_steps_trained": 7383222}, "done": false, "episodes_total": 1806, "training_iteration": 477, "trial_id": "2f030_00000", "date": "2025-06-07_09-37-40", "timestamp": 1749281860, "time_this_iter_s": 56.006197452545166, "time_total_s": 7270.7435574531555, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7270.7435574531555, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 78.25625, "ram_util_percent": 70.14375, "gpu_util_percent0": 0.07906250000000001, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.065877368421053e-05, "total_loss": -0.05094478419854898, "policy_loss": -0.02336996851552447, "vf_loss": 0.016141111244532196, "vf_explained_var": 0.7450578959421678, "kl": 0.012110027635341379, "entropy": 20.519222975644198, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 71225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7398860, "num_env_steps_trained": 7398860, "num_agent_steps_sampled": 7398860, "num_agent_steps_trained": 7398860}, "sampler_results": {"episode_reward_max": 12.51801138724105, "episode_reward_min": -0.10653349925771675, "episode_reward_mean": 6.980683408216184, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.070173939249257, 6.882155811539324, 8.763844776630984, 9.1570178232452, 8.233928317114692, 7.10370758364483, 6.2197866704494285, 10.806760862217933, 7.604109018320707, 5.1067390135543835, 8.98021590693922, 10.194402424090192, 11.244523029865492, 2.8259889268908194, 3.987686902086012, 8.255230793565032, 5.336788693257107, 6.165409130357684, 8.727378956707625, 4.329770882294165, 8.641540411304902, 1.865139474300606, 5.241114377594356, 8.563263511832744, 6.5105346595831275, 6.245579616250002, 8.335248252873383, 7.7286928861338495, 6.605262573682822, 2.3395379568185777, 7.221658869562565, 2.381285071610137, 0.0024102189169263946, 6.162304600139594, 6.976728537821492, 7.144720391008416, 8.05190315654804, 10.894928511657668, 8.410566886991436, 5.863638093703121, 12.51801138724105, -0.10653349925771675, 6.1002233579964456, 7.740266325007577, 7.485417889822215, 12.106760822680403, 6.0912311962785335, 9.235021762819235, 9.578135288992613, 6.337998077567132, 2.421407313597467, 6.374189237109676, 6.619363390017009, 6.5001927011757425, 8.583483217906629, 8.382863905143243, 6.357903444790262, 7.2485413582260545, 8.740183552512171, 5.892114186901054, 10.638602231046223, 6.218730899151325, 9.08143986827025, 8.362097903533797, 4.1398546387996475, 7.60890393759649, 5.192207572007135, 9.694935527214698, 8.080351244350275, 8.867921610520586, 8.376323580437285, 6.903032540417146, 2.208203899551053, 7.802561818368865, 7.282088430660892, 7.940645170584344, 5.9286727439566, 9.8243724616575, 3.0644560835015224, 9.845351787850479, 9.10239667223799, 3.432959965149788, 9.52131253726508, 5.893985342258846, 5.5221458469970175, 8.204865158486518, 8.2298232037201, 2.1120059859951756, 8.767391487550762, 3.9024069336607243, 7.297176502481159, 10.638718618076114, 6.202605387784572, 5.501662710685638, 7.117134589750822, 6.216552606455586, 4.656124309536796, 6.006310694434506, 3.795278514694701, 10.4982773680397], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.812487423122616, "mean_inference_ms": 8.093579991652403, "mean_action_processing_ms": 0.5436399441737466, "mean_env_wait_ms": 24.028662940130154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046777963638305664, "StateBufferConnector_ms": 0.0316920280456543, "ViewRequirementAgentConnector_ms": 0.9965903759002686}}, "episode_reward_max": 12.51801138724105, "episode_reward_min": -0.10653349925771675, "episode_reward_mean": 6.980683408216184, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.070173939249257, 6.882155811539324, 8.763844776630984, 9.1570178232452, 8.233928317114692, 7.10370758364483, 6.2197866704494285, 10.806760862217933, 7.604109018320707, 5.1067390135543835, 8.98021590693922, 10.194402424090192, 11.244523029865492, 2.8259889268908194, 3.987686902086012, 8.255230793565032, 5.336788693257107, 6.165409130357684, 8.727378956707625, 4.329770882294165, 8.641540411304902, 1.865139474300606, 5.241114377594356, 8.563263511832744, 6.5105346595831275, 6.245579616250002, 8.335248252873383, 7.7286928861338495, 6.605262573682822, 2.3395379568185777, 7.221658869562565, 2.381285071610137, 0.0024102189169263946, 6.162304600139594, 6.976728537821492, 7.144720391008416, 8.05190315654804, 10.894928511657668, 8.410566886991436, 5.863638093703121, 12.51801138724105, -0.10653349925771675, 6.1002233579964456, 7.740266325007577, 7.485417889822215, 12.106760822680403, 6.0912311962785335, 9.235021762819235, 9.578135288992613, 6.337998077567132, 2.421407313597467, 6.374189237109676, 6.619363390017009, 6.5001927011757425, 8.583483217906629, 8.382863905143243, 6.357903444790262, 7.2485413582260545, 8.740183552512171, 5.892114186901054, 10.638602231046223, 6.218730899151325, 9.08143986827025, 8.362097903533797, 4.1398546387996475, 7.60890393759649, 5.192207572007135, 9.694935527214698, 8.080351244350275, 8.867921610520586, 8.376323580437285, 6.903032540417146, 2.208203899551053, 7.802561818368865, 7.282088430660892, 7.940645170584344, 5.9286727439566, 9.8243724616575, 3.0644560835015224, 9.845351787850479, 9.10239667223799, 3.432959965149788, 9.52131253726508, 5.893985342258846, 5.5221458469970175, 8.204865158486518, 8.2298232037201, 2.1120059859951756, 8.767391487550762, 3.9024069336607243, 7.297176502481159, 10.638718618076114, 6.202605387784572, 5.501662710685638, 7.117134589750822, 6.216552606455586, 4.656124309536796, 6.006310694434506, 3.795278514694701, 10.4982773680397], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.812487423122616, "mean_inference_ms": 8.093579991652403, "mean_action_processing_ms": 0.5436399441737466, "mean_env_wait_ms": 24.028662940130154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046777963638305664, "StateBufferConnector_ms": 0.0316920280456543, "ViewRequirementAgentConnector_ms": 0.9965903759002686}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7398860, "num_agent_steps_trained": 7398860, "num_env_steps_sampled": 7398860, "num_env_steps_trained": 7398860, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 277.5506571884773, "num_env_steps_trained_throughput_per_sec": 277.5506571884773, "timesteps_total": 7398860, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7398860, "timers": {"training_iteration_time_ms": 55656.344, "sample_time_ms": 42462.385, "load_time_ms": 1758.221, "load_throughput": 8894.219, "learn_time_ms": 10841.058, "learn_throughput": 1442.479, "synch_weights_time_ms": 479.86}, "counters": {"num_env_steps_sampled": 7398860, "num_env_steps_trained": 7398860, "num_agent_steps_sampled": 7398860, "num_agent_steps_trained": 7398860}, "done": false, "episodes_total": 1820, "training_iteration": 478, "trial_id": "2f030_00000", "date": "2025-06-07_09-38-37", "timestamp": 1749281917, "time_this_iter_s": 56.35786724090576, "time_total_s": 7327.101424694061, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7327.101424694061, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 77.64375, "ram_util_percent": 70.05312500000001, "gpu_util_percent0": 0.078125, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.053531578947369e-05, "total_loss": -0.0378157855803147, "policy_loss": -0.010683073340915143, "vf_loss": 0.015322208699177612, "vf_explained_var": 0.7605502209880135, "kl": 0.012895693044637, "entropy": 20.454998921481046, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 71775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7414498, "num_env_steps_trained": 7414498, "num_agent_steps_sampled": 7414498, "num_agent_steps_trained": 7414498}, "sampler_results": {"episode_reward_max": 12.51801138724105, "episode_reward_min": -0.10653349925771675, "episode_reward_mean": 6.860477384250211, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.987686902086012, 8.255230793565032, 5.336788693257107, 6.165409130357684, 8.727378956707625, 4.329770882294165, 8.641540411304902, 1.865139474300606, 5.241114377594356, 8.563263511832744, 6.5105346595831275, 6.245579616250002, 8.335248252873383, 7.7286928861338495, 6.605262573682822, 2.3395379568185777, 7.221658869562565, 2.381285071610137, 0.0024102189169263946, 6.162304600139594, 6.976728537821492, 7.144720391008416, 8.05190315654804, 10.894928511657668, 8.410566886991436, 5.863638093703121, 12.51801138724105, -0.10653349925771675, 6.1002233579964456, 7.740266325007577, 7.485417889822215, 12.106760822680403, 6.0912311962785335, 9.235021762819235, 9.578135288992613, 6.337998077567132, 2.421407313597467, 6.374189237109676, 6.619363390017009, 6.5001927011757425, 8.583483217906629, 8.382863905143243, 6.357903444790262, 7.2485413582260545, 8.740183552512171, 5.892114186901054, 10.638602231046223, 6.218730899151325, 9.08143986827025, 8.362097903533797, 4.1398546387996475, 7.60890393759649, 5.192207572007135, 9.694935527214698, 8.080351244350275, 8.867921610520586, 8.376323580437285, 6.903032540417146, 2.208203899551053, 7.802561818368865, 7.282088430660892, 7.940645170584344, 5.9286727439566, 9.8243724616575, 3.0644560835015224, 9.845351787850479, 9.10239667223799, 3.432959965149788, 9.52131253726508, 5.893985342258846, 5.5221458469970175, 8.204865158486518, 8.2298232037201, 2.1120059859951756, 8.767391487550762, 3.9024069336607243, 7.297176502481159, 10.638718618076114, 6.202605387784572, 5.501662710685638, 7.117134589750822, 6.216552606455586, 4.656124309536796, 6.006310694434506, 3.795278514694701, 10.4982773680397, 7.393575548006859, 6.864282746939435, 6.6549782784028, 9.763629497181649, 6.369488278732412, 7.6342685296799075, 8.849770187785362, 6.8076028143840315, 4.622668787723374, 8.47599716202999, 3.521264278484853, 7.708615652746167, 7.639758722912616, 7.866851222145708], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8110024163474865, "mean_inference_ms": 8.095136522504315, "mean_action_processing_ms": 0.54373552586239, "mean_env_wait_ms": 24.032444569031426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03844189643859863, "StateBufferConnector_ms": 0.029129981994628906, "ViewRequirementAgentConnector_ms": 1.0286610126495361}}, "episode_reward_max": 12.51801138724105, "episode_reward_min": -0.10653349925771675, "episode_reward_mean": 6.860477384250211, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.987686902086012, 8.255230793565032, 5.336788693257107, 6.165409130357684, 8.727378956707625, 4.329770882294165, 8.641540411304902, 1.865139474300606, 5.241114377594356, 8.563263511832744, 6.5105346595831275, 6.245579616250002, 8.335248252873383, 7.7286928861338495, 6.605262573682822, 2.3395379568185777, 7.221658869562565, 2.381285071610137, 0.0024102189169263946, 6.162304600139594, 6.976728537821492, 7.144720391008416, 8.05190315654804, 10.894928511657668, 8.410566886991436, 5.863638093703121, 12.51801138724105, -0.10653349925771675, 6.1002233579964456, 7.740266325007577, 7.485417889822215, 12.106760822680403, 6.0912311962785335, 9.235021762819235, 9.578135288992613, 6.337998077567132, 2.421407313597467, 6.374189237109676, 6.619363390017009, 6.5001927011757425, 8.583483217906629, 8.382863905143243, 6.357903444790262, 7.2485413582260545, 8.740183552512171, 5.892114186901054, 10.638602231046223, 6.218730899151325, 9.08143986827025, 8.362097903533797, 4.1398546387996475, 7.60890393759649, 5.192207572007135, 9.694935527214698, 8.080351244350275, 8.867921610520586, 8.376323580437285, 6.903032540417146, 2.208203899551053, 7.802561818368865, 7.282088430660892, 7.940645170584344, 5.9286727439566, 9.8243724616575, 3.0644560835015224, 9.845351787850479, 9.10239667223799, 3.432959965149788, 9.52131253726508, 5.893985342258846, 5.5221458469970175, 8.204865158486518, 8.2298232037201, 2.1120059859951756, 8.767391487550762, 3.9024069336607243, 7.297176502481159, 10.638718618076114, 6.202605387784572, 5.501662710685638, 7.117134589750822, 6.216552606455586, 4.656124309536796, 6.006310694434506, 3.795278514694701, 10.4982773680397, 7.393575548006859, 6.864282746939435, 6.6549782784028, 9.763629497181649, 6.369488278732412, 7.6342685296799075, 8.849770187785362, 6.8076028143840315, 4.622668787723374, 8.47599716202999, 3.521264278484853, 7.708615652746167, 7.639758722912616, 7.866851222145708], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8110024163474865, "mean_inference_ms": 8.095136522504315, "mean_action_processing_ms": 0.54373552586239, "mean_env_wait_ms": 24.032444569031426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03844189643859863, "StateBufferConnector_ms": 0.029129981994628906, "ViewRequirementAgentConnector_ms": 1.0286610126495361}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7414498, "num_agent_steps_trained": 7414498, "num_env_steps_sampled": 7414498, "num_env_steps_trained": 7414498, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 279.0519367180801, "num_env_steps_trained_throughput_per_sec": 279.0519367180801, "timesteps_total": 7414498, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7414498, "timers": {"training_iteration_time_ms": 55689.624, "sample_time_ms": 42493.524, "load_time_ms": 1761.24, "load_throughput": 8878.973, "learn_time_ms": 10842.8, "learn_throughput": 1442.247, "synch_weights_time_ms": 473.092}, "counters": {"num_env_steps_sampled": 7414498, "num_env_steps_trained": 7414498, "num_agent_steps_sampled": 7414498, "num_agent_steps_trained": 7414498}, "done": false, "episodes_total": 1834, "training_iteration": 479, "trial_id": "2f030_00000", "date": "2025-06-07_09-39-33", "timestamp": 1749281973, "time_this_iter_s": 56.05729842185974, "time_total_s": 7383.158723115921, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7383.158723115921, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 77.83906250000001, "ram_util_percent": 69.7859375, "gpu_util_percent0": 0.0765625, "vram_util_percent0": 0.8592122395833333}}
{"evaluation": {"sampler_results": {"episode_reward_max": -4.886572751176145, "episode_reward_min": -9.537910622549717, "episode_reward_mean": -7.3395998337635415, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.886572751176145, -9.537910622549717, -6.451711013941756, -6.481711400118903, -9.340093381031188], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.43595854601739, "mean_inference_ms": 3.871392892778739, "mean_action_processing_ms": 0.27937212028115466, "mean_env_wait_ms": 10.456038561586212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.020041465759277344, "ViewRequirementAgentConnector_ms": 0.14045238494873047}}, "episode_reward_max": -4.886572751176145, "episode_reward_min": -9.537910622549717, "episode_reward_mean": -7.3395998337635415, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.886572751176145, -9.537910622549717, -6.451711013941756, -6.481711400118903, -9.340093381031188], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.43595854601739, "mean_inference_ms": 3.871392892778739, "mean_action_processing_ms": 0.27937212028115466, "mean_env_wait_ms": 10.456038561586212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.020041465759277344, "ViewRequirementAgentConnector_ms": 0.14045238494873047}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.041185789473685e-05, "total_loss": -0.04886084855407138, "policy_loss": -0.021098947692503728, "vf_loss": 0.013874642397700386, "vf_explained_var": 0.7653114881298759, "kl": 0.012586164579673641, "entropy": 20.442279865958472, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 72325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7430136, "num_env_steps_trained": 7430136, "num_agent_steps_sampled": 7430136, "num_agent_steps_trained": 7430136}, "sampler_results": {"episode_reward_max": 12.51801138724105, "episode_reward_min": -0.10653349925771675, "episode_reward_mean": 7.016491950356651, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.605262573682822, 2.3395379568185777, 7.221658869562565, 2.381285071610137, 0.0024102189169263946, 6.162304600139594, 6.976728537821492, 7.144720391008416, 8.05190315654804, 10.894928511657668, 8.410566886991436, 5.863638093703121, 12.51801138724105, -0.10653349925771675, 6.1002233579964456, 7.740266325007577, 7.485417889822215, 12.106760822680403, 6.0912311962785335, 9.235021762819235, 9.578135288992613, 6.337998077567132, 2.421407313597467, 6.374189237109676, 6.619363390017009, 6.5001927011757425, 8.583483217906629, 8.382863905143243, 6.357903444790262, 7.2485413582260545, 8.740183552512171, 5.892114186901054, 10.638602231046223, 6.218730899151325, 9.08143986827025, 8.362097903533797, 4.1398546387996475, 7.60890393759649, 5.192207572007135, 9.694935527214698, 8.080351244350275, 8.867921610520586, 8.376323580437285, 6.903032540417146, 2.208203899551053, 7.802561818368865, 7.282088430660892, 7.940645170584344, 5.9286727439566, 9.8243724616575, 3.0644560835015224, 9.845351787850479, 9.10239667223799, 3.432959965149788, 9.52131253726508, 5.893985342258846, 5.5221458469970175, 8.204865158486518, 8.2298232037201, 2.1120059859951756, 8.767391487550762, 3.9024069336607243, 7.297176502481159, 10.638718618076114, 6.202605387784572, 5.501662710685638, 7.117134589750822, 6.216552606455586, 4.656124309536796, 6.006310694434506, 3.795278514694701, 10.4982773680397, 7.393575548006859, 6.864282746939435, 6.6549782784028, 9.763629497181649, 6.369488278732412, 7.6342685296799075, 8.849770187785362, 6.8076028143840315, 4.622668787723374, 8.47599716202999, 3.521264278484853, 7.708615652746167, 7.639758722912616, 7.866851222145708, 8.794735730745622, 5.697563914274586, 7.641578249296423, 7.910961555515794, 7.717903397934557, 10.610672198590661, 7.187029108861124, 7.526444616041698, 2.9523413095641358, 10.84828428861936, 8.981256651661297, 2.34248021200192, 8.667684014770254, 8.655899910907355], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.809578284172012, "mean_inference_ms": 8.096845877718025, "mean_action_processing_ms": 0.5438485055555713, "mean_env_wait_ms": 24.036852067330692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04141879081726074, "StateBufferConnector_ms": 0.028126239776611328, "ViewRequirementAgentConnector_ms": 1.066742181777954}}, "episode_reward_max": 12.51801138724105, "episode_reward_min": -0.10653349925771675, "episode_reward_mean": 7.016491950356651, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.605262573682822, 2.3395379568185777, 7.221658869562565, 2.381285071610137, 0.0024102189169263946, 6.162304600139594, 6.976728537821492, 7.144720391008416, 8.05190315654804, 10.894928511657668, 8.410566886991436, 5.863638093703121, 12.51801138724105, -0.10653349925771675, 6.1002233579964456, 7.740266325007577, 7.485417889822215, 12.106760822680403, 6.0912311962785335, 9.235021762819235, 9.578135288992613, 6.337998077567132, 2.421407313597467, 6.374189237109676, 6.619363390017009, 6.5001927011757425, 8.583483217906629, 8.382863905143243, 6.357903444790262, 7.2485413582260545, 8.740183552512171, 5.892114186901054, 10.638602231046223, 6.218730899151325, 9.08143986827025, 8.362097903533797, 4.1398546387996475, 7.60890393759649, 5.192207572007135, 9.694935527214698, 8.080351244350275, 8.867921610520586, 8.376323580437285, 6.903032540417146, 2.208203899551053, 7.802561818368865, 7.282088430660892, 7.940645170584344, 5.9286727439566, 9.8243724616575, 3.0644560835015224, 9.845351787850479, 9.10239667223799, 3.432959965149788, 9.52131253726508, 5.893985342258846, 5.5221458469970175, 8.204865158486518, 8.2298232037201, 2.1120059859951756, 8.767391487550762, 3.9024069336607243, 7.297176502481159, 10.638718618076114, 6.202605387784572, 5.501662710685638, 7.117134589750822, 6.216552606455586, 4.656124309536796, 6.006310694434506, 3.795278514694701, 10.4982773680397, 7.393575548006859, 6.864282746939435, 6.6549782784028, 9.763629497181649, 6.369488278732412, 7.6342685296799075, 8.849770187785362, 6.8076028143840315, 4.622668787723374, 8.47599716202999, 3.521264278484853, 7.708615652746167, 7.639758722912616, 7.866851222145708, 8.794735730745622, 5.697563914274586, 7.641578249296423, 7.910961555515794, 7.717903397934557, 10.610672198590661, 7.187029108861124, 7.526444616041698, 2.9523413095641358, 10.84828428861936, 8.981256651661297, 2.34248021200192, 8.667684014770254, 8.655899910907355], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.809578284172012, "mean_inference_ms": 8.096845877718025, "mean_action_processing_ms": 0.5438485055555713, "mean_env_wait_ms": 24.036852067330692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04141879081726074, "StateBufferConnector_ms": 0.028126239776611328, "ViewRequirementAgentConnector_ms": 1.066742181777954}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7430136, "num_agent_steps_trained": 7430136, "num_env_steps_sampled": 7430136, "num_env_steps_trained": 7430136, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 279.96896211885985, "num_env_steps_trained_throughput_per_sec": 279.96896211885985, "timesteps_total": 7430136, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7430136, "timers": {"training_iteration_time_ms": 55776.256, "sample_time_ms": 42595.693, "load_time_ms": 1743.088, "load_throughput": 8971.435, "learn_time_ms": 10845.239, "learn_throughput": 1441.923, "synch_weights_time_ms": 470.175}, "counters": {"num_env_steps_sampled": 7430136, "num_env_steps_trained": 7430136, "num_agent_steps_sampled": 7430136, "num_agent_steps_trained": 7430136}, "done": false, "episodes_total": 1848, "training_iteration": 480, "trial_id": "2f030_00000", "date": "2025-06-07_09-40-43", "timestamp": 1749282043, "time_this_iter_s": 70.52551627159119, "time_total_s": 7453.684239387512, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7453.684239387512, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 65.64024390243901, "ram_util_percent": 69.68536585365854, "gpu_util_percent0": 0.06012195121951219, "vram_util_percent0": 0.8592122395833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.0288400000000005e-05, "total_loss": -0.04938908710991117, "policy_loss": -0.02215195264958311, "vf_loss": 0.01394603394818577, "vf_explained_var": 0.7796793355725028, "kl": 0.013107729119723152, "entropy": 20.37625928358598, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 72875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7445774, "num_env_steps_trained": 7445774, "num_agent_steps_sampled": 7445774, "num_agent_steps_trained": 7445774}, "sampler_results": {"episode_reward_max": 12.106760822680403, "episode_reward_min": 2.1120059859951756, "episode_reward_mean": 7.229275698787883, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.1002233579964456, 7.740266325007577, 7.485417889822215, 12.106760822680403, 6.0912311962785335, 9.235021762819235, 9.578135288992613, 6.337998077567132, 2.421407313597467, 6.374189237109676, 6.619363390017009, 6.5001927011757425, 8.583483217906629, 8.382863905143243, 6.357903444790262, 7.2485413582260545, 8.740183552512171, 5.892114186901054, 10.638602231046223, 6.218730899151325, 9.08143986827025, 8.362097903533797, 4.1398546387996475, 7.60890393759649, 5.192207572007135, 9.694935527214698, 8.080351244350275, 8.867921610520586, 8.376323580437285, 6.903032540417146, 2.208203899551053, 7.802561818368865, 7.282088430660892, 7.940645170584344, 5.9286727439566, 9.8243724616575, 3.0644560835015224, 9.845351787850479, 9.10239667223799, 3.432959965149788, 9.52131253726508, 5.893985342258846, 5.5221458469970175, 8.204865158486518, 8.2298232037201, 2.1120059859951756, 8.767391487550762, 3.9024069336607243, 7.297176502481159, 10.638718618076114, 6.202605387784572, 5.501662710685638, 7.117134589750822, 6.216552606455586, 4.656124309536796, 6.006310694434506, 3.795278514694701, 10.4982773680397, 7.393575548006859, 6.864282746939435, 6.6549782784028, 9.763629497181649, 6.369488278732412, 7.6342685296799075, 8.849770187785362, 6.8076028143840315, 4.622668787723374, 8.47599716202999, 3.521264278484853, 7.708615652746167, 7.639758722912616, 7.866851222145708, 8.794735730745622, 5.697563914274586, 7.641578249296423, 7.910961555515794, 7.717903397934557, 10.610672198590661, 7.187029108861124, 7.526444616041698, 2.9523413095641358, 10.84828428861936, 8.981256651661297, 2.34248021200192, 8.667684014770254, 8.655899910907355, 10.032940717917732, 8.215240261669225, 7.869218446577785, 6.062887816377375, 6.796542709842389, 4.474983547639975, 5.882206940228587, 11.109702935935086, 4.737059096467255, 7.606969188402055, 9.426486043587769, 7.747748037557535, 8.651571554073403, 7.131240303291071], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.808201607960452, "mean_inference_ms": 8.098638484632904, "mean_action_processing_ms": 0.5439564435558935, "mean_env_wait_ms": 24.04177325380493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04031991958618164, "StateBufferConnector_ms": 0.03457212448120117, "ViewRequirementAgentConnector_ms": 1.063136339187622}}, "episode_reward_max": 12.106760822680403, "episode_reward_min": 2.1120059859951756, "episode_reward_mean": 7.229275698787883, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.1002233579964456, 7.740266325007577, 7.485417889822215, 12.106760822680403, 6.0912311962785335, 9.235021762819235, 9.578135288992613, 6.337998077567132, 2.421407313597467, 6.374189237109676, 6.619363390017009, 6.5001927011757425, 8.583483217906629, 8.382863905143243, 6.357903444790262, 7.2485413582260545, 8.740183552512171, 5.892114186901054, 10.638602231046223, 6.218730899151325, 9.08143986827025, 8.362097903533797, 4.1398546387996475, 7.60890393759649, 5.192207572007135, 9.694935527214698, 8.080351244350275, 8.867921610520586, 8.376323580437285, 6.903032540417146, 2.208203899551053, 7.802561818368865, 7.282088430660892, 7.940645170584344, 5.9286727439566, 9.8243724616575, 3.0644560835015224, 9.845351787850479, 9.10239667223799, 3.432959965149788, 9.52131253726508, 5.893985342258846, 5.5221458469970175, 8.204865158486518, 8.2298232037201, 2.1120059859951756, 8.767391487550762, 3.9024069336607243, 7.297176502481159, 10.638718618076114, 6.202605387784572, 5.501662710685638, 7.117134589750822, 6.216552606455586, 4.656124309536796, 6.006310694434506, 3.795278514694701, 10.4982773680397, 7.393575548006859, 6.864282746939435, 6.6549782784028, 9.763629497181649, 6.369488278732412, 7.6342685296799075, 8.849770187785362, 6.8076028143840315, 4.622668787723374, 8.47599716202999, 3.521264278484853, 7.708615652746167, 7.639758722912616, 7.866851222145708, 8.794735730745622, 5.697563914274586, 7.641578249296423, 7.910961555515794, 7.717903397934557, 10.610672198590661, 7.187029108861124, 7.526444616041698, 2.9523413095641358, 10.84828428861936, 8.981256651661297, 2.34248021200192, 8.667684014770254, 8.655899910907355, 10.032940717917732, 8.215240261669225, 7.869218446577785, 6.062887816377375, 6.796542709842389, 4.474983547639975, 5.882206940228587, 11.109702935935086, 4.737059096467255, 7.606969188402055, 9.426486043587769, 7.747748037557535, 8.651571554073403, 7.131240303291071], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.808201607960452, "mean_inference_ms": 8.098638484632904, "mean_action_processing_ms": 0.5439564435558935, "mean_env_wait_ms": 24.04177325380493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04031991958618164, "StateBufferConnector_ms": 0.03457212448120117, "ViewRequirementAgentConnector_ms": 1.063136339187622}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7445774, "num_agent_steps_trained": 7445774, "num_env_steps_sampled": 7445774, "num_env_steps_trained": 7445774, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 279.9700519900943, "num_env_steps_trained_throughput_per_sec": 279.9700519900943, "timesteps_total": 7445774, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7445774, "timers": {"training_iteration_time_ms": 55793.047, "sample_time_ms": 42615.333, "load_time_ms": 1741.63, "load_throughput": 8978.943, "learn_time_ms": 10844.256, "learn_throughput": 1442.054, "synch_weights_time_ms": 468.147}, "counters": {"num_env_steps_sampled": 7445774, "num_env_steps_trained": 7445774, "num_agent_steps_sampled": 7445774, "num_agent_steps_trained": 7445774}, "done": false, "episodes_total": 1862, "training_iteration": 481, "trial_id": "2f030_00000", "date": "2025-06-07_09-41-39", "timestamp": 1749282099, "time_this_iter_s": 55.87177896499634, "time_total_s": 7509.5560183525085, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7509.5560183525085, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 78.521875, "ram_util_percent": 70.4140625, "gpu_util_percent0": 0.07359375, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.016494210526316e-05, "total_loss": -0.05955082184846767, "policy_loss": -0.032240465735508636, "vf_loss": 0.01502985811538317, "vf_explained_var": 0.7667510337179357, "kl": 0.012595349469814788, "entropy": 20.39305861039595, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 73425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7461412, "num_env_steps_trained": 7461412, "num_agent_steps_sampled": 7461412, "num_agent_steps_trained": 7461412}, "sampler_results": {"episode_reward_max": 11.109702935935086, "episode_reward_min": 2.1120059859951756, "episode_reward_mean": 7.180434752525953, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.357903444790262, 7.2485413582260545, 8.740183552512171, 5.892114186901054, 10.638602231046223, 6.218730899151325, 9.08143986827025, 8.362097903533797, 4.1398546387996475, 7.60890393759649, 5.192207572007135, 9.694935527214698, 8.080351244350275, 8.867921610520586, 8.376323580437285, 6.903032540417146, 2.208203899551053, 7.802561818368865, 7.282088430660892, 7.940645170584344, 5.9286727439566, 9.8243724616575, 3.0644560835015224, 9.845351787850479, 9.10239667223799, 3.432959965149788, 9.52131253726508, 5.893985342258846, 5.5221458469970175, 8.204865158486518, 8.2298232037201, 2.1120059859951756, 8.767391487550762, 3.9024069336607243, 7.297176502481159, 10.638718618076114, 6.202605387784572, 5.501662710685638, 7.117134589750822, 6.216552606455586, 4.656124309536796, 6.006310694434506, 3.795278514694701, 10.4982773680397, 7.393575548006859, 6.864282746939435, 6.6549782784028, 9.763629497181649, 6.369488278732412, 7.6342685296799075, 8.849770187785362, 6.8076028143840315, 4.622668787723374, 8.47599716202999, 3.521264278484853, 7.708615652746167, 7.639758722912616, 7.866851222145708, 8.794735730745622, 5.697563914274586, 7.641578249296423, 7.910961555515794, 7.717903397934557, 10.610672198590661, 7.187029108861124, 7.526444616041698, 2.9523413095641358, 10.84828428861936, 8.981256651661297, 2.34248021200192, 8.667684014770254, 8.655899910907355, 10.032940717917732, 8.215240261669225, 7.869218446577785, 6.062887816377375, 6.796542709842389, 4.474983547639975, 5.882206940228587, 11.109702935935086, 4.737059096467255, 7.606969188402055, 9.426486043587769, 7.747748037557535, 8.651571554073403, 7.131240303291071, 7.532992541561766, 7.188071155542832, 8.871799017154505, 6.831701033484693, 8.148927551515428, 8.9529871722905, 4.388796578351129, 8.265896364195912, 7.631427543958677, 5.86072800831787, 7.089002045925157, 7.310928582791699, 5.277047100331471, 5.322155164499092], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.80670170917706, "mean_inference_ms": 8.100551443874547, "mean_action_processing_ms": 0.5440970065501023, "mean_env_wait_ms": 24.04674704529201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041390180587768555, "StateBufferConnector_ms": 0.031645774841308594, "ViewRequirementAgentConnector_ms": 1.0468847751617432}}, "episode_reward_max": 11.109702935935086, "episode_reward_min": 2.1120059859951756, "episode_reward_mean": 7.180434752525953, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.357903444790262, 7.2485413582260545, 8.740183552512171, 5.892114186901054, 10.638602231046223, 6.218730899151325, 9.08143986827025, 8.362097903533797, 4.1398546387996475, 7.60890393759649, 5.192207572007135, 9.694935527214698, 8.080351244350275, 8.867921610520586, 8.376323580437285, 6.903032540417146, 2.208203899551053, 7.802561818368865, 7.282088430660892, 7.940645170584344, 5.9286727439566, 9.8243724616575, 3.0644560835015224, 9.845351787850479, 9.10239667223799, 3.432959965149788, 9.52131253726508, 5.893985342258846, 5.5221458469970175, 8.204865158486518, 8.2298232037201, 2.1120059859951756, 8.767391487550762, 3.9024069336607243, 7.297176502481159, 10.638718618076114, 6.202605387784572, 5.501662710685638, 7.117134589750822, 6.216552606455586, 4.656124309536796, 6.006310694434506, 3.795278514694701, 10.4982773680397, 7.393575548006859, 6.864282746939435, 6.6549782784028, 9.763629497181649, 6.369488278732412, 7.6342685296799075, 8.849770187785362, 6.8076028143840315, 4.622668787723374, 8.47599716202999, 3.521264278484853, 7.708615652746167, 7.639758722912616, 7.866851222145708, 8.794735730745622, 5.697563914274586, 7.641578249296423, 7.910961555515794, 7.717903397934557, 10.610672198590661, 7.187029108861124, 7.526444616041698, 2.9523413095641358, 10.84828428861936, 8.981256651661297, 2.34248021200192, 8.667684014770254, 8.655899910907355, 10.032940717917732, 8.215240261669225, 7.869218446577785, 6.062887816377375, 6.796542709842389, 4.474983547639975, 5.882206940228587, 11.109702935935086, 4.737059096467255, 7.606969188402055, 9.426486043587769, 7.747748037557535, 8.651571554073403, 7.131240303291071, 7.532992541561766, 7.188071155542832, 8.871799017154505, 6.831701033484693, 8.148927551515428, 8.9529871722905, 4.388796578351129, 8.265896364195912, 7.631427543958677, 5.86072800831787, 7.089002045925157, 7.310928582791699, 5.277047100331471, 5.322155164499092], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.80670170917706, "mean_inference_ms": 8.100551443874547, "mean_action_processing_ms": 0.5440970065501023, "mean_env_wait_ms": 24.04674704529201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041390180587768555, "StateBufferConnector_ms": 0.031645774841308594, "ViewRequirementAgentConnector_ms": 1.0468847751617432}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7461412, "num_agent_steps_trained": 7461412, "num_env_steps_sampled": 7461412, "num_env_steps_trained": 7461412, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.1807284568762, "num_env_steps_trained_throughput_per_sec": 280.1807284568762, "timesteps_total": 7461412, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7461412, "timers": {"training_iteration_time_ms": 55766.866, "sample_time_ms": 42585.563, "load_time_ms": 1749.263, "load_throughput": 8939.764, "learn_time_ms": 10843.559, "learn_throughput": 1442.146, "synch_weights_time_ms": 465.052}, "counters": {"num_env_steps_sampled": 7461412, "num_env_steps_trained": 7461412, "num_agent_steps_sampled": 7461412, "num_agent_steps_trained": 7461412}, "done": false, "episodes_total": 1876, "training_iteration": 482, "trial_id": "2f030_00000", "date": "2025-06-07_09-42-35", "timestamp": 1749282155, "time_this_iter_s": 55.830047369003296, "time_total_s": 7565.386065721512, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7565.386065721512, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 78.61250000000001, "ram_util_percent": 70.06406249999999, "gpu_util_percent0": 0.07640625000000001, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 4.004148421052632e-05, "total_loss": -0.04621687333607538, "policy_loss": -0.019078225230120798, "vf_loss": 0.014704077612947335, "vf_explained_var": 0.7605215727199207, "kl": 0.01306975448680238, "entropy": 20.427205250479957, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 73975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7477050, "num_env_steps_trained": 7477050, "num_agent_steps_sampled": 7477050, "num_agent_steps_trained": 7477050}, "sampler_results": {"episode_reward_max": 11.109702935935086, "episode_reward_min": 2.014619438354198, "episode_reward_mean": 7.093248404759372, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.376323580437285, 6.903032540417146, 2.208203899551053, 7.802561818368865, 7.282088430660892, 7.940645170584344, 5.9286727439566, 9.8243724616575, 3.0644560835015224, 9.845351787850479, 9.10239667223799, 3.432959965149788, 9.52131253726508, 5.893985342258846, 5.5221458469970175, 8.204865158486518, 8.2298232037201, 2.1120059859951756, 8.767391487550762, 3.9024069336607243, 7.297176502481159, 10.638718618076114, 6.202605387784572, 5.501662710685638, 7.117134589750822, 6.216552606455586, 4.656124309536796, 6.006310694434506, 3.795278514694701, 10.4982773680397, 7.393575548006859, 6.864282746939435, 6.6549782784028, 9.763629497181649, 6.369488278732412, 7.6342685296799075, 8.849770187785362, 6.8076028143840315, 4.622668787723374, 8.47599716202999, 3.521264278484853, 7.708615652746167, 7.639758722912616, 7.866851222145708, 8.794735730745622, 5.697563914274586, 7.641578249296423, 7.910961555515794, 7.717903397934557, 10.610672198590661, 7.187029108861124, 7.526444616041698, 2.9523413095641358, 10.84828428861936, 8.981256651661297, 2.34248021200192, 8.667684014770254, 8.655899910907355, 10.032940717917732, 8.215240261669225, 7.869218446577785, 6.062887816377375, 6.796542709842389, 4.474983547639975, 5.882206940228587, 11.109702935935086, 4.737059096467255, 7.606969188402055, 9.426486043587769, 7.747748037557535, 8.651571554073403, 7.131240303291071, 7.532992541561766, 7.188071155542832, 8.871799017154505, 6.831701033484693, 8.148927551515428, 8.9529871722905, 4.388796578351129, 8.265896364195912, 7.631427543958677, 5.86072800831787, 7.089002045925157, 7.310928582791699, 5.277047100331471, 5.322155164499092, 7.474033546036107, 8.34405208102307, 4.874095089998541, 10.631836846492078, 6.708954344896548, 3.7182945465094015, 10.307767518721894, 5.612804559024607, 8.932759643415165, 8.142431663261126, 6.205540796551864, 9.329719018488465, 2.014619438354198, 5.108244105489026], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8054286306500518, "mean_inference_ms": 8.102255905938044, "mean_action_processing_ms": 0.5442470471540152, "mean_env_wait_ms": 24.05123245054335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04218554496765137, "StateBufferConnector_ms": 0.033624887466430664, "ViewRequirementAgentConnector_ms": 1.0577232837677002}}, "episode_reward_max": 11.109702935935086, "episode_reward_min": 2.014619438354198, "episode_reward_mean": 7.093248404759372, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.376323580437285, 6.903032540417146, 2.208203899551053, 7.802561818368865, 7.282088430660892, 7.940645170584344, 5.9286727439566, 9.8243724616575, 3.0644560835015224, 9.845351787850479, 9.10239667223799, 3.432959965149788, 9.52131253726508, 5.893985342258846, 5.5221458469970175, 8.204865158486518, 8.2298232037201, 2.1120059859951756, 8.767391487550762, 3.9024069336607243, 7.297176502481159, 10.638718618076114, 6.202605387784572, 5.501662710685638, 7.117134589750822, 6.216552606455586, 4.656124309536796, 6.006310694434506, 3.795278514694701, 10.4982773680397, 7.393575548006859, 6.864282746939435, 6.6549782784028, 9.763629497181649, 6.369488278732412, 7.6342685296799075, 8.849770187785362, 6.8076028143840315, 4.622668787723374, 8.47599716202999, 3.521264278484853, 7.708615652746167, 7.639758722912616, 7.866851222145708, 8.794735730745622, 5.697563914274586, 7.641578249296423, 7.910961555515794, 7.717903397934557, 10.610672198590661, 7.187029108861124, 7.526444616041698, 2.9523413095641358, 10.84828428861936, 8.981256651661297, 2.34248021200192, 8.667684014770254, 8.655899910907355, 10.032940717917732, 8.215240261669225, 7.869218446577785, 6.062887816377375, 6.796542709842389, 4.474983547639975, 5.882206940228587, 11.109702935935086, 4.737059096467255, 7.606969188402055, 9.426486043587769, 7.747748037557535, 8.651571554073403, 7.131240303291071, 7.532992541561766, 7.188071155542832, 8.871799017154505, 6.831701033484693, 8.148927551515428, 8.9529871722905, 4.388796578351129, 8.265896364195912, 7.631427543958677, 5.86072800831787, 7.089002045925157, 7.310928582791699, 5.277047100331471, 5.322155164499092, 7.474033546036107, 8.34405208102307, 4.874095089998541, 10.631836846492078, 6.708954344896548, 3.7182945465094015, 10.307767518721894, 5.612804559024607, 8.932759643415165, 8.142431663261126, 6.205540796551864, 9.329719018488465, 2.014619438354198, 5.108244105489026], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8054286306500518, "mean_inference_ms": 8.102255905938044, "mean_action_processing_ms": 0.5442470471540152, "mean_env_wait_ms": 24.05123245054335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04218554496765137, "StateBufferConnector_ms": 0.033624887466430664, "ViewRequirementAgentConnector_ms": 1.0577232837677002}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7477050, "num_agent_steps_trained": 7477050, "num_env_steps_sampled": 7477050, "num_env_steps_trained": 7477050, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.7837310138081, "num_env_steps_trained_throughput_per_sec": 283.7837310138081, "timesteps_total": 7477050, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7477050, "timers": {"training_iteration_time_ms": 55801.857, "sample_time_ms": 42600.418, "load_time_ms": 1763.085, "load_throughput": 8869.682, "learn_time_ms": 10846.732, "learn_throughput": 1441.725, "synch_weights_time_ms": 462.305}, "counters": {"num_env_steps_sampled": 7477050, "num_env_steps_trained": 7477050, "num_agent_steps_sampled": 7477050, "num_agent_steps_trained": 7477050}, "done": false, "episodes_total": 1890, "training_iteration": 483, "trial_id": "2f030_00000", "date": "2025-06-07_09-43-30", "timestamp": 1749282210, "time_this_iter_s": 55.118674755096436, "time_total_s": 7620.504740476608, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7620.504740476608, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 78.25873015873015, "ram_util_percent": 69.93968253968255, "gpu_util_percent0": 0.07682539682539684, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.991802631578948e-05, "total_loss": -0.049237231656231666, "policy_loss": -0.02189516404506073, "vf_loss": 0.016013699151914227, "vf_explained_var": 0.7540841186046601, "kl": 0.012510346811735894, "entropy": 20.526233719912444, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 74525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7492688, "num_env_steps_trained": 7492688, "num_agent_steps_sampled": 7492688, "num_agent_steps_trained": 7492688}, "sampler_results": {"episode_reward_max": 11.109702935935086, "episode_reward_min": 2.0092718141608343, "episode_reward_mean": 7.012623065523021, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.5221458469970175, 8.204865158486518, 8.2298232037201, 2.1120059859951756, 8.767391487550762, 3.9024069336607243, 7.297176502481159, 10.638718618076114, 6.202605387784572, 5.501662710685638, 7.117134589750822, 6.216552606455586, 4.656124309536796, 6.006310694434506, 3.795278514694701, 10.4982773680397, 7.393575548006859, 6.864282746939435, 6.6549782784028, 9.763629497181649, 6.369488278732412, 7.6342685296799075, 8.849770187785362, 6.8076028143840315, 4.622668787723374, 8.47599716202999, 3.521264278484853, 7.708615652746167, 7.639758722912616, 7.866851222145708, 8.794735730745622, 5.697563914274586, 7.641578249296423, 7.910961555515794, 7.717903397934557, 10.610672198590661, 7.187029108861124, 7.526444616041698, 2.9523413095641358, 10.84828428861936, 8.981256651661297, 2.34248021200192, 8.667684014770254, 8.655899910907355, 10.032940717917732, 8.215240261669225, 7.869218446577785, 6.062887816377375, 6.796542709842389, 4.474983547639975, 5.882206940228587, 11.109702935935086, 4.737059096467255, 7.606969188402055, 9.426486043587769, 7.747748037557535, 8.651571554073403, 7.131240303291071, 7.532992541561766, 7.188071155542832, 8.871799017154505, 6.831701033484693, 8.148927551515428, 8.9529871722905, 4.388796578351129, 8.265896364195912, 7.631427543958677, 5.86072800831787, 7.089002045925157, 7.310928582791699, 5.277047100331471, 5.322155164499092, 7.474033546036107, 8.34405208102307, 4.874095089998541, 10.631836846492078, 6.708954344896548, 3.7182945465094015, 10.307767518721894, 5.612804559024607, 8.932759643415165, 8.142431663261126, 6.205540796551864, 9.329719018488465, 2.014619438354198, 5.108244105489026, 5.140702300114696, 9.472455900621013, 7.018453617692319, 6.568013517974551, 9.712029574689955, 7.675209100629185, 4.162666667808011, 6.080226579367511, 2.0092718141608343, 4.85636839400646, 3.534785910309519, 9.355142451266778, 3.698209629945741, 9.780293651675645], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.804062480899573, "mean_inference_ms": 8.103976819121355, "mean_action_processing_ms": 0.5443838182552533, "mean_env_wait_ms": 24.055821011187103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041896820068359375, "StateBufferConnector_ms": 0.03876805305480957, "ViewRequirementAgentConnector_ms": 1.032045602798462}}, "episode_reward_max": 11.109702935935086, "episode_reward_min": 2.0092718141608343, "episode_reward_mean": 7.012623065523021, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.5221458469970175, 8.204865158486518, 8.2298232037201, 2.1120059859951756, 8.767391487550762, 3.9024069336607243, 7.297176502481159, 10.638718618076114, 6.202605387784572, 5.501662710685638, 7.117134589750822, 6.216552606455586, 4.656124309536796, 6.006310694434506, 3.795278514694701, 10.4982773680397, 7.393575548006859, 6.864282746939435, 6.6549782784028, 9.763629497181649, 6.369488278732412, 7.6342685296799075, 8.849770187785362, 6.8076028143840315, 4.622668787723374, 8.47599716202999, 3.521264278484853, 7.708615652746167, 7.639758722912616, 7.866851222145708, 8.794735730745622, 5.697563914274586, 7.641578249296423, 7.910961555515794, 7.717903397934557, 10.610672198590661, 7.187029108861124, 7.526444616041698, 2.9523413095641358, 10.84828428861936, 8.981256651661297, 2.34248021200192, 8.667684014770254, 8.655899910907355, 10.032940717917732, 8.215240261669225, 7.869218446577785, 6.062887816377375, 6.796542709842389, 4.474983547639975, 5.882206940228587, 11.109702935935086, 4.737059096467255, 7.606969188402055, 9.426486043587769, 7.747748037557535, 8.651571554073403, 7.131240303291071, 7.532992541561766, 7.188071155542832, 8.871799017154505, 6.831701033484693, 8.148927551515428, 8.9529871722905, 4.388796578351129, 8.265896364195912, 7.631427543958677, 5.86072800831787, 7.089002045925157, 7.310928582791699, 5.277047100331471, 5.322155164499092, 7.474033546036107, 8.34405208102307, 4.874095089998541, 10.631836846492078, 6.708954344896548, 3.7182945465094015, 10.307767518721894, 5.612804559024607, 8.932759643415165, 8.142431663261126, 6.205540796551864, 9.329719018488465, 2.014619438354198, 5.108244105489026, 5.140702300114696, 9.472455900621013, 7.018453617692319, 6.568013517974551, 9.712029574689955, 7.675209100629185, 4.162666667808011, 6.080226579367511, 2.0092718141608343, 4.85636839400646, 3.534785910309519, 9.355142451266778, 3.698209629945741, 9.780293651675645], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.804062480899573, "mean_inference_ms": 8.103976819121355, "mean_action_processing_ms": 0.5443838182552533, "mean_env_wait_ms": 24.055821011187103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041896820068359375, "StateBufferConnector_ms": 0.03876805305480957, "ViewRequirementAgentConnector_ms": 1.032045602798462}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7492688, "num_agent_steps_trained": 7492688, "num_env_steps_sampled": 7492688, "num_env_steps_trained": 7492688, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.7377361822628, "num_env_steps_trained_throughput_per_sec": 280.7377361822628, "timesteps_total": 7492688, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7492688, "timers": {"training_iteration_time_ms": 55809.537, "sample_time_ms": 42635.855, "load_time_ms": 1764.338, "load_throughput": 8863.382, "learn_time_ms": 10817.333, "learn_throughput": 1445.643, "synch_weights_time_ms": 463.72}, "counters": {"num_env_steps_sampled": 7492688, "num_env_steps_trained": 7492688, "num_agent_steps_sampled": 7492688, "num_agent_steps_trained": 7492688}, "done": false, "episodes_total": 1904, "training_iteration": 484, "trial_id": "2f030_00000", "date": "2025-06-07_09-44-26", "timestamp": 1749282266, "time_this_iter_s": 55.724801540374756, "time_total_s": 7676.229542016983, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7676.229542016983, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 78.43015873015872, "ram_util_percent": 70.26507936507936, "gpu_util_percent0": 0.07301587301587302, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.979456842105264e-05, "total_loss": -0.0378985178580677, "policy_loss": -0.01064509198223029, "vf_loss": 0.014668808525258845, "vf_explained_var": 0.7582411960038272, "kl": 0.012846388465681194, "entropy": 20.399795318950307, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 75075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7508326, "num_env_steps_trained": 7508326, "num_agent_steps_sampled": 7508326, "num_agent_steps_trained": 7508326}, "sampler_results": {"episode_reward_max": 11.661990327387498, "episode_reward_min": 2.0092718141608343, "episode_reward_mean": 7.065550800951244, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.795278514694701, 10.4982773680397, 7.393575548006859, 6.864282746939435, 6.6549782784028, 9.763629497181649, 6.369488278732412, 7.6342685296799075, 8.849770187785362, 6.8076028143840315, 4.622668787723374, 8.47599716202999, 3.521264278484853, 7.708615652746167, 7.639758722912616, 7.866851222145708, 8.794735730745622, 5.697563914274586, 7.641578249296423, 7.910961555515794, 7.717903397934557, 10.610672198590661, 7.187029108861124, 7.526444616041698, 2.9523413095641358, 10.84828428861936, 8.981256651661297, 2.34248021200192, 8.667684014770254, 8.655899910907355, 10.032940717917732, 8.215240261669225, 7.869218446577785, 6.062887816377375, 6.796542709842389, 4.474983547639975, 5.882206940228587, 11.109702935935086, 4.737059096467255, 7.606969188402055, 9.426486043587769, 7.747748037557535, 8.651571554073403, 7.131240303291071, 7.532992541561766, 7.188071155542832, 8.871799017154505, 6.831701033484693, 8.148927551515428, 8.9529871722905, 4.388796578351129, 8.265896364195912, 7.631427543958677, 5.86072800831787, 7.089002045925157, 7.310928582791699, 5.277047100331471, 5.322155164499092, 7.474033546036107, 8.34405208102307, 4.874095089998541, 10.631836846492078, 6.708954344896548, 3.7182945465094015, 10.307767518721894, 5.612804559024607, 8.932759643415165, 8.142431663261126, 6.205540796551864, 9.329719018488465, 2.014619438354198, 5.108244105489026, 5.140702300114696, 9.472455900621013, 7.018453617692319, 6.568013517974551, 9.712029574689955, 7.675209100629185, 4.162666667808011, 6.080226579367511, 2.0092718141608343, 4.85636839400646, 3.534785910309519, 9.355142451266778, 3.698209629945741, 9.780293651675645, 11.661990327387498, 2.1382093846604326, 4.719376589154844, 10.207351397449441, 9.447526738352472, 7.9950164983062075, 5.3597226402346525, 10.099710812890422, 8.215545266236878, 3.75376106405168, 5.146722459435401, 4.744779677437584, 6.048597534070658, 6.129387188769578], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8030684497328493, "mean_inference_ms": 8.105546688817126, "mean_action_processing_ms": 0.5445050392430856, "mean_env_wait_ms": 24.059633552582554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03981375694274902, "StateBufferConnector_ms": 0.03876757621765137, "ViewRequirementAgentConnector_ms": 1.011972188949585}}, "episode_reward_max": 11.661990327387498, "episode_reward_min": 2.0092718141608343, "episode_reward_mean": 7.065550800951244, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.795278514694701, 10.4982773680397, 7.393575548006859, 6.864282746939435, 6.6549782784028, 9.763629497181649, 6.369488278732412, 7.6342685296799075, 8.849770187785362, 6.8076028143840315, 4.622668787723374, 8.47599716202999, 3.521264278484853, 7.708615652746167, 7.639758722912616, 7.866851222145708, 8.794735730745622, 5.697563914274586, 7.641578249296423, 7.910961555515794, 7.717903397934557, 10.610672198590661, 7.187029108861124, 7.526444616041698, 2.9523413095641358, 10.84828428861936, 8.981256651661297, 2.34248021200192, 8.667684014770254, 8.655899910907355, 10.032940717917732, 8.215240261669225, 7.869218446577785, 6.062887816377375, 6.796542709842389, 4.474983547639975, 5.882206940228587, 11.109702935935086, 4.737059096467255, 7.606969188402055, 9.426486043587769, 7.747748037557535, 8.651571554073403, 7.131240303291071, 7.532992541561766, 7.188071155542832, 8.871799017154505, 6.831701033484693, 8.148927551515428, 8.9529871722905, 4.388796578351129, 8.265896364195912, 7.631427543958677, 5.86072800831787, 7.089002045925157, 7.310928582791699, 5.277047100331471, 5.322155164499092, 7.474033546036107, 8.34405208102307, 4.874095089998541, 10.631836846492078, 6.708954344896548, 3.7182945465094015, 10.307767518721894, 5.612804559024607, 8.932759643415165, 8.142431663261126, 6.205540796551864, 9.329719018488465, 2.014619438354198, 5.108244105489026, 5.140702300114696, 9.472455900621013, 7.018453617692319, 6.568013517974551, 9.712029574689955, 7.675209100629185, 4.162666667808011, 6.080226579367511, 2.0092718141608343, 4.85636839400646, 3.534785910309519, 9.355142451266778, 3.698209629945741, 9.780293651675645, 11.661990327387498, 2.1382093846604326, 4.719376589154844, 10.207351397449441, 9.447526738352472, 7.9950164983062075, 5.3597226402346525, 10.099710812890422, 8.215545266236878, 3.75376106405168, 5.146722459435401, 4.744779677437584, 6.048597534070658, 6.129387188769578], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8030684497328493, "mean_inference_ms": 8.105546688817126, "mean_action_processing_ms": 0.5445050392430856, "mean_env_wait_ms": 24.059633552582554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03981375694274902, "StateBufferConnector_ms": 0.03876757621765137, "ViewRequirementAgentConnector_ms": 1.011972188949585}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7508326, "num_agent_steps_trained": 7508326, "num_env_steps_sampled": 7508326, "num_env_steps_trained": 7508326, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.6726297600909, "num_env_steps_trained_throughput_per_sec": 282.6726297600909, "timesteps_total": 7508326, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7508326, "timers": {"training_iteration_time_ms": 55732.668, "sample_time_ms": 42589.789, "load_time_ms": 1769.602, "load_throughput": 8837.016, "learn_time_ms": 10818.125, "learn_throughput": 1445.537, "synch_weights_time_ms": 430.964}, "counters": {"num_env_steps_sampled": 7508326, "num_env_steps_trained": 7508326, "num_agent_steps_sampled": 7508326, "num_agent_steps_trained": 7508326}, "done": false, "episodes_total": 1918, "training_iteration": 485, "trial_id": "2f030_00000", "date": "2025-06-07_09-45-22", "timestamp": 1749282322, "time_this_iter_s": 55.3472113609314, "time_total_s": 7731.576753377914, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7731.576753377914, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 78.34126984126983, "ram_util_percent": 70.33809523809522, "gpu_util_percent0": 0.07634920634920636, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.9671110526315795e-05, "total_loss": -0.05403517460196533, "policy_loss": -0.02636335588549793, "vf_loss": 0.014666464397345078, "vf_explained_var": 0.7308574479276484, "kl": 0.012330321144452431, "entropy": 20.42494233564897, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 75625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7523964, "num_env_steps_trained": 7523964, "num_agent_steps_sampled": 7523964, "num_agent_steps_trained": 7523964}, "sampler_results": {"episode_reward_max": 11.661990327387498, "episode_reward_min": -1.217987571011757, "episode_reward_mean": 7.06043686816268, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.639758722912616, 7.866851222145708, 8.794735730745622, 5.697563914274586, 7.641578249296423, 7.910961555515794, 7.717903397934557, 10.610672198590661, 7.187029108861124, 7.526444616041698, 2.9523413095641358, 10.84828428861936, 8.981256651661297, 2.34248021200192, 8.667684014770254, 8.655899910907355, 10.032940717917732, 8.215240261669225, 7.869218446577785, 6.062887816377375, 6.796542709842389, 4.474983547639975, 5.882206940228587, 11.109702935935086, 4.737059096467255, 7.606969188402055, 9.426486043587769, 7.747748037557535, 8.651571554073403, 7.131240303291071, 7.532992541561766, 7.188071155542832, 8.871799017154505, 6.831701033484693, 8.148927551515428, 8.9529871722905, 4.388796578351129, 8.265896364195912, 7.631427543958677, 5.86072800831787, 7.089002045925157, 7.310928582791699, 5.277047100331471, 5.322155164499092, 7.474033546036107, 8.34405208102307, 4.874095089998541, 10.631836846492078, 6.708954344896548, 3.7182945465094015, 10.307767518721894, 5.612804559024607, 8.932759643415165, 8.142431663261126, 6.205540796551864, 9.329719018488465, 2.014619438354198, 5.108244105489026, 5.140702300114696, 9.472455900621013, 7.018453617692319, 6.568013517974551, 9.712029574689955, 7.675209100629185, 4.162666667808011, 6.080226579367511, 2.0092718141608343, 4.85636839400646, 3.534785910309519, 9.355142451266778, 3.698209629945741, 9.780293651675645, 11.661990327387498, 2.1382093846604326, 4.719376589154844, 10.207351397449441, 9.447526738352472, 7.9950164983062075, 5.3597226402346525, 10.099710812890422, 8.215545266236878, 3.75376106405168, 5.146722459435401, 4.744779677437584, 6.048597534070658, 6.129387188769578, 7.231506996174868, 7.1284097082400235, 7.814625788689759, 8.029871747888059, 9.664769494915552, -1.217987571011757, 10.013857101124081, 8.542927193174808, -0.04416057109271222, 9.383459617814205, 8.45424292109062, 7.490319159423799, 10.58437909641924, 5.372083683124103], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8020612686205033, "mean_inference_ms": 8.107066499284342, "mean_action_processing_ms": 0.5446169540988538, "mean_env_wait_ms": 24.063270912990664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03983783721923828, "StateBufferConnector_ms": 0.03574776649475098, "ViewRequirementAgentConnector_ms": 0.9843778610229492}}, "episode_reward_max": 11.661990327387498, "episode_reward_min": -1.217987571011757, "episode_reward_mean": 7.06043686816268, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.639758722912616, 7.866851222145708, 8.794735730745622, 5.697563914274586, 7.641578249296423, 7.910961555515794, 7.717903397934557, 10.610672198590661, 7.187029108861124, 7.526444616041698, 2.9523413095641358, 10.84828428861936, 8.981256651661297, 2.34248021200192, 8.667684014770254, 8.655899910907355, 10.032940717917732, 8.215240261669225, 7.869218446577785, 6.062887816377375, 6.796542709842389, 4.474983547639975, 5.882206940228587, 11.109702935935086, 4.737059096467255, 7.606969188402055, 9.426486043587769, 7.747748037557535, 8.651571554073403, 7.131240303291071, 7.532992541561766, 7.188071155542832, 8.871799017154505, 6.831701033484693, 8.148927551515428, 8.9529871722905, 4.388796578351129, 8.265896364195912, 7.631427543958677, 5.86072800831787, 7.089002045925157, 7.310928582791699, 5.277047100331471, 5.322155164499092, 7.474033546036107, 8.34405208102307, 4.874095089998541, 10.631836846492078, 6.708954344896548, 3.7182945465094015, 10.307767518721894, 5.612804559024607, 8.932759643415165, 8.142431663261126, 6.205540796551864, 9.329719018488465, 2.014619438354198, 5.108244105489026, 5.140702300114696, 9.472455900621013, 7.018453617692319, 6.568013517974551, 9.712029574689955, 7.675209100629185, 4.162666667808011, 6.080226579367511, 2.0092718141608343, 4.85636839400646, 3.534785910309519, 9.355142451266778, 3.698209629945741, 9.780293651675645, 11.661990327387498, 2.1382093846604326, 4.719376589154844, 10.207351397449441, 9.447526738352472, 7.9950164983062075, 5.3597226402346525, 10.099710812890422, 8.215545266236878, 3.75376106405168, 5.146722459435401, 4.744779677437584, 6.048597534070658, 6.129387188769578, 7.231506996174868, 7.1284097082400235, 7.814625788689759, 8.029871747888059, 9.664769494915552, -1.217987571011757, 10.013857101124081, 8.542927193174808, -0.04416057109271222, 9.383459617814205, 8.45424292109062, 7.490319159423799, 10.58437909641924, 5.372083683124103], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8020612686205033, "mean_inference_ms": 8.107066499284342, "mean_action_processing_ms": 0.5446169540988538, "mean_env_wait_ms": 24.063270912990664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03983783721923828, "StateBufferConnector_ms": 0.03574776649475098, "ViewRequirementAgentConnector_ms": 0.9843778610229492}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7523964, "num_agent_steps_trained": 7523964, "num_env_steps_sampled": 7523964, "num_env_steps_trained": 7523964, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.2383632775244, "num_env_steps_trained_throughput_per_sec": 280.2383632775244, "timesteps_total": 7523964, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7523964, "timers": {"training_iteration_time_ms": 55783.099, "sample_time_ms": 42643.101, "load_time_ms": 1773.39, "load_throughput": 8818.137, "learn_time_ms": 10811.983, "learn_throughput": 1446.358, "synch_weights_time_ms": 430.034}, "counters": {"num_env_steps_sampled": 7523964, "num_env_steps_trained": 7523964, "num_agent_steps_sampled": 7523964, "num_agent_steps_trained": 7523964}, "done": false, "episodes_total": 1932, "training_iteration": 486, "trial_id": "2f030_00000", "date": "2025-06-07_09-46-18", "timestamp": 1749282378, "time_this_iter_s": 55.81749200820923, "time_total_s": 7787.394245386124, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7787.394245386124, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 77.5, "ram_util_percent": 70.259375, "gpu_util_percent0": 0.07671875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.954765263157896e-05, "total_loss": -0.051830955052917654, "policy_loss": -0.024594506185332484, "vf_loss": 0.015201635136353699, "vf_explained_var": 0.7474100630933588, "kl": 0.012686937632758848, "entropy": 20.414472600763496, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 76175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7539602, "num_env_steps_trained": 7539602, "num_agent_steps_sampled": 7539602, "num_agent_steps_trained": 7539602}, "sampler_results": {"episode_reward_max": 11.661990327387498, "episode_reward_min": -1.217987571011757, "episode_reward_mean": 6.994474677699142, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.667684014770254, 8.655899910907355, 10.032940717917732, 8.215240261669225, 7.869218446577785, 6.062887816377375, 6.796542709842389, 4.474983547639975, 5.882206940228587, 11.109702935935086, 4.737059096467255, 7.606969188402055, 9.426486043587769, 7.747748037557535, 8.651571554073403, 7.131240303291071, 7.532992541561766, 7.188071155542832, 8.871799017154505, 6.831701033484693, 8.148927551515428, 8.9529871722905, 4.388796578351129, 8.265896364195912, 7.631427543958677, 5.86072800831787, 7.089002045925157, 7.310928582791699, 5.277047100331471, 5.322155164499092, 7.474033546036107, 8.34405208102307, 4.874095089998541, 10.631836846492078, 6.708954344896548, 3.7182945465094015, 10.307767518721894, 5.612804559024607, 8.932759643415165, 8.142431663261126, 6.205540796551864, 9.329719018488465, 2.014619438354198, 5.108244105489026, 5.140702300114696, 9.472455900621013, 7.018453617692319, 6.568013517974551, 9.712029574689955, 7.675209100629185, 4.162666667808011, 6.080226579367511, 2.0092718141608343, 4.85636839400646, 3.534785910309519, 9.355142451266778, 3.698209629945741, 9.780293651675645, 11.661990327387498, 2.1382093846604326, 4.719376589154844, 10.207351397449441, 9.447526738352472, 7.9950164983062075, 5.3597226402346525, 10.099710812890422, 8.215545266236878, 3.75376106405168, 5.146722459435401, 4.744779677437584, 6.048597534070658, 6.129387188769578, 7.231506996174868, 7.1284097082400235, 7.814625788689759, 8.029871747888059, 9.664769494915552, -1.217987571011757, 10.013857101124081, 8.542927193174808, -0.04416057109271222, 9.383459617814205, 8.45424292109062, 7.490319159423799, 10.58437909641924, 5.372083683124103, 5.935940290845865, 5.527645447828281, 8.741449960842404, 8.136511176025948, 10.753393098293534, 9.406662206626123, 6.789076394456763, 9.221573389945185, 5.368471190622028, 9.925168216669086, 3.141009781455817, 6.614533394293281, 2.062302841386707, 5.4979047425209515], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8010539690906615, "mean_inference_ms": 8.108472284292102, "mean_action_processing_ms": 0.5447009907722467, "mean_env_wait_ms": 24.066850670538265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04390072822570801, "StateBufferConnector_ms": 0.040766239166259766, "ViewRequirementAgentConnector_ms": 0.9435644149780273}}, "episode_reward_max": 11.661990327387498, "episode_reward_min": -1.217987571011757, "episode_reward_mean": 6.994474677699142, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.667684014770254, 8.655899910907355, 10.032940717917732, 8.215240261669225, 7.869218446577785, 6.062887816377375, 6.796542709842389, 4.474983547639975, 5.882206940228587, 11.109702935935086, 4.737059096467255, 7.606969188402055, 9.426486043587769, 7.747748037557535, 8.651571554073403, 7.131240303291071, 7.532992541561766, 7.188071155542832, 8.871799017154505, 6.831701033484693, 8.148927551515428, 8.9529871722905, 4.388796578351129, 8.265896364195912, 7.631427543958677, 5.86072800831787, 7.089002045925157, 7.310928582791699, 5.277047100331471, 5.322155164499092, 7.474033546036107, 8.34405208102307, 4.874095089998541, 10.631836846492078, 6.708954344896548, 3.7182945465094015, 10.307767518721894, 5.612804559024607, 8.932759643415165, 8.142431663261126, 6.205540796551864, 9.329719018488465, 2.014619438354198, 5.108244105489026, 5.140702300114696, 9.472455900621013, 7.018453617692319, 6.568013517974551, 9.712029574689955, 7.675209100629185, 4.162666667808011, 6.080226579367511, 2.0092718141608343, 4.85636839400646, 3.534785910309519, 9.355142451266778, 3.698209629945741, 9.780293651675645, 11.661990327387498, 2.1382093846604326, 4.719376589154844, 10.207351397449441, 9.447526738352472, 7.9950164983062075, 5.3597226402346525, 10.099710812890422, 8.215545266236878, 3.75376106405168, 5.146722459435401, 4.744779677437584, 6.048597534070658, 6.129387188769578, 7.231506996174868, 7.1284097082400235, 7.814625788689759, 8.029871747888059, 9.664769494915552, -1.217987571011757, 10.013857101124081, 8.542927193174808, -0.04416057109271222, 9.383459617814205, 8.45424292109062, 7.490319159423799, 10.58437909641924, 5.372083683124103, 5.935940290845865, 5.527645447828281, 8.741449960842404, 8.136511176025948, 10.753393098293534, 9.406662206626123, 6.789076394456763, 9.221573389945185, 5.368471190622028, 9.925168216669086, 3.141009781455817, 6.614533394293281, 2.062302841386707, 5.4979047425209515], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8010539690906615, "mean_inference_ms": 8.108472284292102, "mean_action_processing_ms": 0.5447009907722467, "mean_env_wait_ms": 24.066850670538265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04390072822570801, "StateBufferConnector_ms": 0.040766239166259766, "ViewRequirementAgentConnector_ms": 0.9435644149780273}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7539602, "num_agent_steps_trained": 7539602, "num_env_steps_sampled": 7539602, "num_env_steps_trained": 7539602, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.19026758131133, "num_env_steps_trained_throughput_per_sec": 280.19026758131133, "timesteps_total": 7539602, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7539602, "timers": {"training_iteration_time_ms": 55765.385, "sample_time_ms": 42641.062, "load_time_ms": 1771.107, "load_throughput": 8829.506, "learn_time_ms": 10805.985, "learn_throughput": 1447.161, "synch_weights_time_ms": 423.527}, "counters": {"num_env_steps_sampled": 7539602, "num_env_steps_trained": 7539602, "num_agent_steps_sampled": 7539602, "num_agent_steps_trained": 7539602}, "done": false, "episodes_total": 1946, "training_iteration": 487, "trial_id": "2f030_00000", "date": "2025-06-07_09-47-14", "timestamp": 1749282434, "time_this_iter_s": 55.82783269882202, "time_total_s": 7843.222078084946, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7843.222078084946, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 78.2078125, "ram_util_percent": 70.5859375, "gpu_util_percent0": 0.08109374999999999, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.942419473684212e-05, "total_loss": -0.06596312155481428, "policy_loss": -0.038408788358581, "vf_loss": 0.01509410318410532, "vf_explained_var": 0.7542762111533772, "kl": 0.012321386299465137, "entropy": 20.427165116396818, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 76725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7555240, "num_env_steps_trained": 7555240, "num_agent_steps_sampled": 7555240, "num_agent_steps_trained": 7555240}, "sampler_results": {"episode_reward_max": 11.661990327387498, "episode_reward_min": -1.217987571011757, "episode_reward_mean": 6.939306988486403, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.651571554073403, 7.131240303291071, 7.532992541561766, 7.188071155542832, 8.871799017154505, 6.831701033484693, 8.148927551515428, 8.9529871722905, 4.388796578351129, 8.265896364195912, 7.631427543958677, 5.86072800831787, 7.089002045925157, 7.310928582791699, 5.277047100331471, 5.322155164499092, 7.474033546036107, 8.34405208102307, 4.874095089998541, 10.631836846492078, 6.708954344896548, 3.7182945465094015, 10.307767518721894, 5.612804559024607, 8.932759643415165, 8.142431663261126, 6.205540796551864, 9.329719018488465, 2.014619438354198, 5.108244105489026, 5.140702300114696, 9.472455900621013, 7.018453617692319, 6.568013517974551, 9.712029574689955, 7.675209100629185, 4.162666667808011, 6.080226579367511, 2.0092718141608343, 4.85636839400646, 3.534785910309519, 9.355142451266778, 3.698209629945741, 9.780293651675645, 11.661990327387498, 2.1382093846604326, 4.719376589154844, 10.207351397449441, 9.447526738352472, 7.9950164983062075, 5.3597226402346525, 10.099710812890422, 8.215545266236878, 3.75376106405168, 5.146722459435401, 4.744779677437584, 6.048597534070658, 6.129387188769578, 7.231506996174868, 7.1284097082400235, 7.814625788689759, 8.029871747888059, 9.664769494915552, -1.217987571011757, 10.013857101124081, 8.542927193174808, -0.04416057109271222, 9.383459617814205, 8.45424292109062, 7.490319159423799, 10.58437909641924, 5.372083683124103, 5.935940290845865, 5.527645447828281, 8.741449960842404, 8.136511176025948, 10.753393098293534, 9.406662206626123, 6.789076394456763, 9.221573389945185, 5.368471190622028, 9.925168216669086, 3.141009781455817, 6.614533394293281, 2.062302841386707, 5.4979047425209515, 5.467643452439681, 3.6506881309426427, 5.048402883237263, 3.103808346839703, 6.412216867985812, 9.673904451034453, 7.075009521944386, 8.835559646914676, 9.033389722969002, 9.99238624022372, 7.497311619089864, 10.280667552737695, 8.648972662567516, 7.048839647680034], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8001628171424158, "mean_inference_ms": 8.109826377779326, "mean_action_processing_ms": 0.54478862924775, "mean_env_wait_ms": 24.070129583764725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04993152618408203, "StateBufferConnector_ms": 0.03682589530944824, "ViewRequirementAgentConnector_ms": 0.9350721836090088}}, "episode_reward_max": 11.661990327387498, "episode_reward_min": -1.217987571011757, "episode_reward_mean": 6.939306988486403, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.651571554073403, 7.131240303291071, 7.532992541561766, 7.188071155542832, 8.871799017154505, 6.831701033484693, 8.148927551515428, 8.9529871722905, 4.388796578351129, 8.265896364195912, 7.631427543958677, 5.86072800831787, 7.089002045925157, 7.310928582791699, 5.277047100331471, 5.322155164499092, 7.474033546036107, 8.34405208102307, 4.874095089998541, 10.631836846492078, 6.708954344896548, 3.7182945465094015, 10.307767518721894, 5.612804559024607, 8.932759643415165, 8.142431663261126, 6.205540796551864, 9.329719018488465, 2.014619438354198, 5.108244105489026, 5.140702300114696, 9.472455900621013, 7.018453617692319, 6.568013517974551, 9.712029574689955, 7.675209100629185, 4.162666667808011, 6.080226579367511, 2.0092718141608343, 4.85636839400646, 3.534785910309519, 9.355142451266778, 3.698209629945741, 9.780293651675645, 11.661990327387498, 2.1382093846604326, 4.719376589154844, 10.207351397449441, 9.447526738352472, 7.9950164983062075, 5.3597226402346525, 10.099710812890422, 8.215545266236878, 3.75376106405168, 5.146722459435401, 4.744779677437584, 6.048597534070658, 6.129387188769578, 7.231506996174868, 7.1284097082400235, 7.814625788689759, 8.029871747888059, 9.664769494915552, -1.217987571011757, 10.013857101124081, 8.542927193174808, -0.04416057109271222, 9.383459617814205, 8.45424292109062, 7.490319159423799, 10.58437909641924, 5.372083683124103, 5.935940290845865, 5.527645447828281, 8.741449960842404, 8.136511176025948, 10.753393098293534, 9.406662206626123, 6.789076394456763, 9.221573389945185, 5.368471190622028, 9.925168216669086, 3.141009781455817, 6.614533394293281, 2.062302841386707, 5.4979047425209515, 5.467643452439681, 3.6506881309426427, 5.048402883237263, 3.103808346839703, 6.412216867985812, 9.673904451034453, 7.075009521944386, 8.835559646914676, 9.033389722969002, 9.99238624022372, 7.497311619089864, 10.280667552737695, 8.648972662567516, 7.048839647680034], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8001628171424158, "mean_inference_ms": 8.109826377779326, "mean_action_processing_ms": 0.54478862924775, "mean_env_wait_ms": 24.070129583764725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04993152618408203, "StateBufferConnector_ms": 0.03682589530944824, "ViewRequirementAgentConnector_ms": 0.9350721836090088}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7555240, "num_agent_steps_trained": 7555240, "num_env_steps_sampled": 7555240, "num_env_steps_trained": 7555240, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.7463543330094, "num_env_steps_trained_throughput_per_sec": 280.7463543330094, "timesteps_total": 7555240, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7555240, "timers": {"training_iteration_time_ms": 55701.251, "sample_time_ms": 42596.364, "load_time_ms": 1772.142, "load_throughput": 8824.351, "learn_time_ms": 10784.19, "learn_throughput": 1450.086, "synch_weights_time_ms": 424.18}, "counters": {"num_env_steps_sampled": 7555240, "num_env_steps_trained": 7555240, "num_agent_steps_sampled": 7555240, "num_agent_steps_trained": 7555240}, "done": false, "episodes_total": 1960, "training_iteration": 488, "trial_id": "2f030_00000", "date": "2025-06-07_09-48-09", "timestamp": 1749282489, "time_this_iter_s": 55.71731424331665, "time_total_s": 7898.939392328262, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7898.939392328262, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 78.2015625, "ram_util_percent": 70.115625, "gpu_util_percent0": 0.0746875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.930073684210527e-05, "total_loss": -0.05959316544150087, "policy_loss": -0.032007909708084877, "vf_loss": 0.01357929775152694, "vf_explained_var": 0.7686667810786855, "kl": 0.01283717379592071, "entropy": 20.399003425944937, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 77275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7570878, "num_env_steps_trained": 7570878, "num_agent_steps_sampled": 7570878, "num_agent_steps_trained": 7570878}, "sampler_results": {"episode_reward_max": 11.661990327387498, "episode_reward_min": -1.217987571011757, "episode_reward_mean": 6.99480711667796, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.277047100331471, 5.322155164499092, 7.474033546036107, 8.34405208102307, 4.874095089998541, 10.631836846492078, 6.708954344896548, 3.7182945465094015, 10.307767518721894, 5.612804559024607, 8.932759643415165, 8.142431663261126, 6.205540796551864, 9.329719018488465, 2.014619438354198, 5.108244105489026, 5.140702300114696, 9.472455900621013, 7.018453617692319, 6.568013517974551, 9.712029574689955, 7.675209100629185, 4.162666667808011, 6.080226579367511, 2.0092718141608343, 4.85636839400646, 3.534785910309519, 9.355142451266778, 3.698209629945741, 9.780293651675645, 11.661990327387498, 2.1382093846604326, 4.719376589154844, 10.207351397449441, 9.447526738352472, 7.9950164983062075, 5.3597226402346525, 10.099710812890422, 8.215545266236878, 3.75376106405168, 5.146722459435401, 4.744779677437584, 6.048597534070658, 6.129387188769578, 7.231506996174868, 7.1284097082400235, 7.814625788689759, 8.029871747888059, 9.664769494915552, -1.217987571011757, 10.013857101124081, 8.542927193174808, -0.04416057109271222, 9.383459617814205, 8.45424292109062, 7.490319159423799, 10.58437909641924, 5.372083683124103, 5.935940290845865, 5.527645447828281, 8.741449960842404, 8.136511176025948, 10.753393098293534, 9.406662206626123, 6.789076394456763, 9.221573389945185, 5.368471190622028, 9.925168216669086, 3.141009781455817, 6.614533394293281, 2.062302841386707, 5.4979047425209515, 5.467643452439681, 3.6506881309426427, 5.048402883237263, 3.103808346839703, 6.412216867985812, 9.673904451034453, 7.075009521944386, 8.835559646914676, 9.033389722969002, 9.99238624022372, 7.497311619089864, 10.280667552737695, 8.648972662567516, 7.048839647680034, 9.391422166422494, 10.7156025938416, 8.597086377110756, 10.294944002273866, 4.912778820369162, 9.447210642976163, 4.3775921148350205, 7.4080597009288836, 5.375775761186259, 10.321183807417215, 7.98389807978645, 8.8107399858736, 7.693083033606283, 4.0767051849826315], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7994899609763473, "mean_inference_ms": 8.110996513243608, "mean_action_processing_ms": 0.5448590740252905, "mean_env_wait_ms": 24.07314772864038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05592465400695801, "StateBufferConnector_ms": 0.03973507881164551, "ViewRequirementAgentConnector_ms": 0.9613597393035889}}, "episode_reward_max": 11.661990327387498, "episode_reward_min": -1.217987571011757, "episode_reward_mean": 6.99480711667796, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.277047100331471, 5.322155164499092, 7.474033546036107, 8.34405208102307, 4.874095089998541, 10.631836846492078, 6.708954344896548, 3.7182945465094015, 10.307767518721894, 5.612804559024607, 8.932759643415165, 8.142431663261126, 6.205540796551864, 9.329719018488465, 2.014619438354198, 5.108244105489026, 5.140702300114696, 9.472455900621013, 7.018453617692319, 6.568013517974551, 9.712029574689955, 7.675209100629185, 4.162666667808011, 6.080226579367511, 2.0092718141608343, 4.85636839400646, 3.534785910309519, 9.355142451266778, 3.698209629945741, 9.780293651675645, 11.661990327387498, 2.1382093846604326, 4.719376589154844, 10.207351397449441, 9.447526738352472, 7.9950164983062075, 5.3597226402346525, 10.099710812890422, 8.215545266236878, 3.75376106405168, 5.146722459435401, 4.744779677437584, 6.048597534070658, 6.129387188769578, 7.231506996174868, 7.1284097082400235, 7.814625788689759, 8.029871747888059, 9.664769494915552, -1.217987571011757, 10.013857101124081, 8.542927193174808, -0.04416057109271222, 9.383459617814205, 8.45424292109062, 7.490319159423799, 10.58437909641924, 5.372083683124103, 5.935940290845865, 5.527645447828281, 8.741449960842404, 8.136511176025948, 10.753393098293534, 9.406662206626123, 6.789076394456763, 9.221573389945185, 5.368471190622028, 9.925168216669086, 3.141009781455817, 6.614533394293281, 2.062302841386707, 5.4979047425209515, 5.467643452439681, 3.6506881309426427, 5.048402883237263, 3.103808346839703, 6.412216867985812, 9.673904451034453, 7.075009521944386, 8.835559646914676, 9.033389722969002, 9.99238624022372, 7.497311619089864, 10.280667552737695, 8.648972662567516, 7.048839647680034, 9.391422166422494, 10.7156025938416, 8.597086377110756, 10.294944002273866, 4.912778820369162, 9.447210642976163, 4.3775921148350205, 7.4080597009288836, 5.375775761186259, 10.321183807417215, 7.98389807978645, 8.8107399858736, 7.693083033606283, 4.0767051849826315], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7994899609763473, "mean_inference_ms": 8.110996513243608, "mean_action_processing_ms": 0.5448590740252905, "mean_env_wait_ms": 24.07314772864038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05592465400695801, "StateBufferConnector_ms": 0.03973507881164551, "ViewRequirementAgentConnector_ms": 0.9613597393035889}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7570878, "num_agent_steps_trained": 7570878, "num_env_steps_sampled": 7570878, "num_env_steps_trained": 7570878, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.73091609315225, "num_env_steps_trained_throughput_per_sec": 281.73091609315225, "timesteps_total": 7570878, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7570878, "timers": {"training_iteration_time_ms": 55647.962, "sample_time_ms": 42566.957, "load_time_ms": 1767.59, "load_throughput": 8847.076, "learn_time_ms": 10770.457, "learn_throughput": 1451.935, "synch_weights_time_ms": 422.483}, "counters": {"num_env_steps_sampled": 7570878, "num_env_steps_trained": 7570878, "num_agent_steps_sampled": 7570878, "num_agent_steps_trained": 7570878}, "done": false, "episodes_total": 1974, "training_iteration": 489, "trial_id": "2f030_00000", "date": "2025-06-07_09-49-05", "timestamp": 1749282545, "time_this_iter_s": 55.52986550331116, "time_total_s": 7954.4692578315735, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7954.4692578315735, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 77.17777777777776, "ram_util_percent": 70.23174603174606, "gpu_util_percent0": 0.08174603174603176, "vram_util_percent0": 0.8592122395833336}}
{"evaluation": {"sampler_results": {"episode_reward_max": -4.665424791082313, "episode_reward_min": -7.730989319362845, "episode_reward_mean": -5.9507896697629805, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.569303143721254, -7.730989319362845, -4.665424791082313, -5.588965732548715, -6.199265362099775], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.431923777752532, "mean_inference_ms": 3.8593767276838817, "mean_action_processing_ms": 0.27901854569320617, "mean_env_wait_ms": 10.463921352276188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.020084381103515625, "ViewRequirementAgentConnector_ms": 0.15996456146240234}}, "episode_reward_max": -4.665424791082313, "episode_reward_min": -7.730989319362845, "episode_reward_mean": -5.9507896697629805, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.569303143721254, -7.730989319362845, -4.665424791082313, -5.588965732548715, -6.199265362099775], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.431923777752532, "mean_inference_ms": 3.8593767276838817, "mean_action_processing_ms": 0.27901854569320617, "mean_env_wait_ms": 10.463921352276188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.020084381103515625, "ViewRequirementAgentConnector_ms": 0.15996456146240234}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.9177278947368426e-05, "total_loss": -0.06011992068876597, "policy_loss": -0.03197874264421195, "vf_loss": 0.013469410975548353, "vf_explained_var": 0.7382624483108521, "kl": 0.012269970286052487, "entropy": 20.458581666079436, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 77825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7586516, "num_env_steps_trained": 7586516, "num_agent_steps_sampled": 7586516, "num_agent_steps_trained": 7586516}, "sampler_results": {"episode_reward_max": 11.661990327387498, "episode_reward_min": -1.217987571011757, "episode_reward_mean": 7.0347399040626275, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.014619438354198, 5.108244105489026, 5.140702300114696, 9.472455900621013, 7.018453617692319, 6.568013517974551, 9.712029574689955, 7.675209100629185, 4.162666667808011, 6.080226579367511, 2.0092718141608343, 4.85636839400646, 3.534785910309519, 9.355142451266778, 3.698209629945741, 9.780293651675645, 11.661990327387498, 2.1382093846604326, 4.719376589154844, 10.207351397449441, 9.447526738352472, 7.9950164983062075, 5.3597226402346525, 10.099710812890422, 8.215545266236878, 3.75376106405168, 5.146722459435401, 4.744779677437584, 6.048597534070658, 6.129387188769578, 7.231506996174868, 7.1284097082400235, 7.814625788689759, 8.029871747888059, 9.664769494915552, -1.217987571011757, 10.013857101124081, 8.542927193174808, -0.04416057109271222, 9.383459617814205, 8.45424292109062, 7.490319159423799, 10.58437909641924, 5.372083683124103, 5.935940290845865, 5.527645447828281, 8.741449960842404, 8.136511176025948, 10.753393098293534, 9.406662206626123, 6.789076394456763, 9.221573389945185, 5.368471190622028, 9.925168216669086, 3.141009781455817, 6.614533394293281, 2.062302841386707, 5.4979047425209515, 5.467643452439681, 3.6506881309426427, 5.048402883237263, 3.103808346839703, 6.412216867985812, 9.673904451034453, 7.075009521944386, 8.835559646914676, 9.033389722969002, 9.99238624022372, 7.497311619089864, 10.280667552737695, 8.648972662567516, 7.048839647680034, 9.391422166422494, 10.7156025938416, 8.597086377110756, 10.294944002273866, 4.912778820369162, 9.447210642976163, 4.3775921148350205, 7.4080597009288836, 5.375775761186259, 10.321183807417215, 7.98389807978645, 8.8107399858736, 7.693083033606283, 4.0767051849826315, 5.733208420550385, 5.606134275470497, 5.176190141393272, 6.733739206471106, 6.890062346904293, 10.997986383434858, 8.366498299461337, 7.103709044145809, 5.880675596448142, 8.248344837767949, 11.545506229309009, 8.089578844112312, 8.622503804788552, 5.880633227458422], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.798731132288069, "mean_inference_ms": 8.112323799348179, "mean_action_processing_ms": 0.5449219386439563, "mean_env_wait_ms": 24.076422630225725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0556483268737793, "StateBufferConnector_ms": 0.03766036033630371, "ViewRequirementAgentConnector_ms": 0.9775841236114502}}, "episode_reward_max": 11.661990327387498, "episode_reward_min": -1.217987571011757, "episode_reward_mean": 7.0347399040626275, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.014619438354198, 5.108244105489026, 5.140702300114696, 9.472455900621013, 7.018453617692319, 6.568013517974551, 9.712029574689955, 7.675209100629185, 4.162666667808011, 6.080226579367511, 2.0092718141608343, 4.85636839400646, 3.534785910309519, 9.355142451266778, 3.698209629945741, 9.780293651675645, 11.661990327387498, 2.1382093846604326, 4.719376589154844, 10.207351397449441, 9.447526738352472, 7.9950164983062075, 5.3597226402346525, 10.099710812890422, 8.215545266236878, 3.75376106405168, 5.146722459435401, 4.744779677437584, 6.048597534070658, 6.129387188769578, 7.231506996174868, 7.1284097082400235, 7.814625788689759, 8.029871747888059, 9.664769494915552, -1.217987571011757, 10.013857101124081, 8.542927193174808, -0.04416057109271222, 9.383459617814205, 8.45424292109062, 7.490319159423799, 10.58437909641924, 5.372083683124103, 5.935940290845865, 5.527645447828281, 8.741449960842404, 8.136511176025948, 10.753393098293534, 9.406662206626123, 6.789076394456763, 9.221573389945185, 5.368471190622028, 9.925168216669086, 3.141009781455817, 6.614533394293281, 2.062302841386707, 5.4979047425209515, 5.467643452439681, 3.6506881309426427, 5.048402883237263, 3.103808346839703, 6.412216867985812, 9.673904451034453, 7.075009521944386, 8.835559646914676, 9.033389722969002, 9.99238624022372, 7.497311619089864, 10.280667552737695, 8.648972662567516, 7.048839647680034, 9.391422166422494, 10.7156025938416, 8.597086377110756, 10.294944002273866, 4.912778820369162, 9.447210642976163, 4.3775921148350205, 7.4080597009288836, 5.375775761186259, 10.321183807417215, 7.98389807978645, 8.8107399858736, 7.693083033606283, 4.0767051849826315, 5.733208420550385, 5.606134275470497, 5.176190141393272, 6.733739206471106, 6.890062346904293, 10.997986383434858, 8.366498299461337, 7.103709044145809, 5.880675596448142, 8.248344837767949, 11.545506229309009, 8.089578844112312, 8.622503804788552, 5.880633227458422], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.798731132288069, "mean_inference_ms": 8.112323799348179, "mean_action_processing_ms": 0.5449219386439563, "mean_env_wait_ms": 24.076422630225725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0556483268737793, "StateBufferConnector_ms": 0.03766036033630371, "ViewRequirementAgentConnector_ms": 0.9775841236114502}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7586516, "num_agent_steps_trained": 7586516, "num_env_steps_sampled": 7586516, "num_env_steps_trained": 7586516, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.72858946659153, "num_env_steps_trained_throughput_per_sec": 278.72858946659153, "timesteps_total": 7586516, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7586516, "timers": {"training_iteration_time_ms": 55672.819, "sample_time_ms": 42562.244, "load_time_ms": 1771.106, "load_throughput": 8829.513, "learn_time_ms": 10795.996, "learn_throughput": 1448.5, "synch_weights_time_ms": 426.772}, "counters": {"num_env_steps_sampled": 7586516, "num_env_steps_trained": 7586516, "num_agent_steps_sampled": 7586516, "num_agent_steps_trained": 7586516}, "done": false, "episodes_total": 1988, "training_iteration": 490, "trial_id": "2f030_00000", "date": "2025-06-07_09-50-16", "timestamp": 1749282616, "time_this_iter_s": 70.92567229270935, "time_total_s": 8025.394930124283, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8025.394930124283, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 65.73780487804876, "ram_util_percent": 70.24512195121949, "gpu_util_percent0": 0.05987804878048781, "vram_util_percent0": 0.8592122395833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.9053821052631584e-05, "total_loss": -0.06266804784917357, "policy_loss": -0.03492348837285218, "vf_loss": 0.013980928444388238, "vf_explained_var": 0.7653922627188943, "kl": 0.012506872331525377, "entropy": 20.42132725802335, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 78375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7602154, "num_env_steps_trained": 7602154, "num_agent_steps_sampled": 7602154, "num_agent_steps_trained": 7602154}, "sampler_results": {"episode_reward_max": 11.661990327387498, "episode_reward_min": -1.217987571011757, "episode_reward_mean": 7.180769201690811, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.698209629945741, 9.780293651675645, 11.661990327387498, 2.1382093846604326, 4.719376589154844, 10.207351397449441, 9.447526738352472, 7.9950164983062075, 5.3597226402346525, 10.099710812890422, 8.215545266236878, 3.75376106405168, 5.146722459435401, 4.744779677437584, 6.048597534070658, 6.129387188769578, 7.231506996174868, 7.1284097082400235, 7.814625788689759, 8.029871747888059, 9.664769494915552, -1.217987571011757, 10.013857101124081, 8.542927193174808, -0.04416057109271222, 9.383459617814205, 8.45424292109062, 7.490319159423799, 10.58437909641924, 5.372083683124103, 5.935940290845865, 5.527645447828281, 8.741449960842404, 8.136511176025948, 10.753393098293534, 9.406662206626123, 6.789076394456763, 9.221573389945185, 5.368471190622028, 9.925168216669086, 3.141009781455817, 6.614533394293281, 2.062302841386707, 5.4979047425209515, 5.467643452439681, 3.6506881309426427, 5.048402883237263, 3.103808346839703, 6.412216867985812, 9.673904451034453, 7.075009521944386, 8.835559646914676, 9.033389722969002, 9.99238624022372, 7.497311619089864, 10.280667552737695, 8.648972662567516, 7.048839647680034, 9.391422166422494, 10.7156025938416, 8.597086377110756, 10.294944002273866, 4.912778820369162, 9.447210642976163, 4.3775921148350205, 7.4080597009288836, 5.375775761186259, 10.321183807417215, 7.98389807978645, 8.8107399858736, 7.693083033606283, 4.0767051849826315, 5.733208420550385, 5.606134275470497, 5.176190141393272, 6.733739206471106, 6.890062346904293, 10.997986383434858, 8.366498299461337, 7.103709044145809, 5.880675596448142, 8.248344837767949, 11.545506229309009, 8.089578844112312, 8.622503804788552, 5.880633227458422, 5.4072865130272065, 7.780421132124189, 7.267130046126989, 5.720619948626905, 4.967435347823392, 8.687707054872607, 7.40900536256935, 7.614240831530157, 7.016566667692525, 6.520715327846095, 7.901258199197144, 9.78842754474362, 5.14199457481744, 6.088310584304934], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.798194593719625, "mean_inference_ms": 8.113561176440355, "mean_action_processing_ms": 0.5449905225322942, "mean_env_wait_ms": 24.079912426924903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05191302299499512, "StateBufferConnector_ms": 0.039031982421875, "ViewRequirementAgentConnector_ms": 1.0136749744415283}}, "episode_reward_max": 11.661990327387498, "episode_reward_min": -1.217987571011757, "episode_reward_mean": 7.180769201690811, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.698209629945741, 9.780293651675645, 11.661990327387498, 2.1382093846604326, 4.719376589154844, 10.207351397449441, 9.447526738352472, 7.9950164983062075, 5.3597226402346525, 10.099710812890422, 8.215545266236878, 3.75376106405168, 5.146722459435401, 4.744779677437584, 6.048597534070658, 6.129387188769578, 7.231506996174868, 7.1284097082400235, 7.814625788689759, 8.029871747888059, 9.664769494915552, -1.217987571011757, 10.013857101124081, 8.542927193174808, -0.04416057109271222, 9.383459617814205, 8.45424292109062, 7.490319159423799, 10.58437909641924, 5.372083683124103, 5.935940290845865, 5.527645447828281, 8.741449960842404, 8.136511176025948, 10.753393098293534, 9.406662206626123, 6.789076394456763, 9.221573389945185, 5.368471190622028, 9.925168216669086, 3.141009781455817, 6.614533394293281, 2.062302841386707, 5.4979047425209515, 5.467643452439681, 3.6506881309426427, 5.048402883237263, 3.103808346839703, 6.412216867985812, 9.673904451034453, 7.075009521944386, 8.835559646914676, 9.033389722969002, 9.99238624022372, 7.497311619089864, 10.280667552737695, 8.648972662567516, 7.048839647680034, 9.391422166422494, 10.7156025938416, 8.597086377110756, 10.294944002273866, 4.912778820369162, 9.447210642976163, 4.3775921148350205, 7.4080597009288836, 5.375775761186259, 10.321183807417215, 7.98389807978645, 8.8107399858736, 7.693083033606283, 4.0767051849826315, 5.733208420550385, 5.606134275470497, 5.176190141393272, 6.733739206471106, 6.890062346904293, 10.997986383434858, 8.366498299461337, 7.103709044145809, 5.880675596448142, 8.248344837767949, 11.545506229309009, 8.089578844112312, 8.622503804788552, 5.880633227458422, 5.4072865130272065, 7.780421132124189, 7.267130046126989, 5.720619948626905, 4.967435347823392, 8.687707054872607, 7.40900536256935, 7.614240831530157, 7.016566667692525, 6.520715327846095, 7.901258199197144, 9.78842754474362, 5.14199457481744, 6.088310584304934], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.798194593719625, "mean_inference_ms": 8.113561176440355, "mean_action_processing_ms": 0.5449905225322942, "mean_env_wait_ms": 24.079912426924903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05191302299499512, "StateBufferConnector_ms": 0.039031982421875, "ViewRequirementAgentConnector_ms": 1.0136749744415283}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7602154, "num_agent_steps_trained": 7602154, "num_env_steps_sampled": 7602154, "num_env_steps_trained": 7602154, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 277.86627739886103, "num_env_steps_trained_throughput_per_sec": 277.86627739886103, "timesteps_total": 7602154, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7602154, "timers": {"training_iteration_time_ms": 55715.109, "sample_time_ms": 42582.994, "load_time_ms": 1786.375, "load_throughput": 8754.04, "learn_time_ms": 10802.225, "learn_throughput": 1447.665, "synch_weights_time_ms": 427.205}, "counters": {"num_env_steps_sampled": 7602154, "num_env_steps_trained": 7602154, "num_agent_steps_sampled": 7602154, "num_agent_steps_trained": 7602154}, "done": false, "episodes_total": 2002, "training_iteration": 491, "trial_id": "2f030_00000", "date": "2025-06-07_09-51-12", "timestamp": 1749282672, "time_this_iter_s": 56.29385542869568, "time_total_s": 8081.6887855529785, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8081.6887855529785, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 78.8, "ram_util_percent": 70.4671875, "gpu_util_percent0": 0.07265625, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.893036315789474e-05, "total_loss": -0.053454634106125345, "policy_loss": -0.02536770776480394, "vf_loss": 0.013767059251496738, "vf_explained_var": 0.7746419176188383, "kl": 0.01212860976119621, "entropy": 20.425785069899124, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 78925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7617792, "num_env_steps_trained": 7617792, "num_agent_steps_sampled": 7617792, "num_agent_steps_trained": 7617792}, "sampler_results": {"episode_reward_max": 11.545506229309009, "episode_reward_min": -1.217987571011757, "episode_reward_mean": 7.169243694709752, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.048597534070658, 6.129387188769578, 7.231506996174868, 7.1284097082400235, 7.814625788689759, 8.029871747888059, 9.664769494915552, -1.217987571011757, 10.013857101124081, 8.542927193174808, -0.04416057109271222, 9.383459617814205, 8.45424292109062, 7.490319159423799, 10.58437909641924, 5.372083683124103, 5.935940290845865, 5.527645447828281, 8.741449960842404, 8.136511176025948, 10.753393098293534, 9.406662206626123, 6.789076394456763, 9.221573389945185, 5.368471190622028, 9.925168216669086, 3.141009781455817, 6.614533394293281, 2.062302841386707, 5.4979047425209515, 5.467643452439681, 3.6506881309426427, 5.048402883237263, 3.103808346839703, 6.412216867985812, 9.673904451034453, 7.075009521944386, 8.835559646914676, 9.033389722969002, 9.99238624022372, 7.497311619089864, 10.280667552737695, 8.648972662567516, 7.048839647680034, 9.391422166422494, 10.7156025938416, 8.597086377110756, 10.294944002273866, 4.912778820369162, 9.447210642976163, 4.3775921148350205, 7.4080597009288836, 5.375775761186259, 10.321183807417215, 7.98389807978645, 8.8107399858736, 7.693083033606283, 4.0767051849826315, 5.733208420550385, 5.606134275470497, 5.176190141393272, 6.733739206471106, 6.890062346904293, 10.997986383434858, 8.366498299461337, 7.103709044145809, 5.880675596448142, 8.248344837767949, 11.545506229309009, 8.089578844112312, 8.622503804788552, 5.880633227458422, 5.4072865130272065, 7.780421132124189, 7.267130046126989, 5.720619948626905, 4.967435347823392, 8.687707054872607, 7.40900536256935, 7.614240831530157, 7.016566667692525, 6.520715327846095, 7.901258199197144, 9.78842754474362, 5.14199457481744, 6.088310584304934, 9.151890187187528, 8.071098433747382, 8.097821982147401, 1.8382290167905595, 8.94200575837296, 9.137022810380614, 5.201740996588288, 6.236300778530211, 6.279783051656328, 6.021563083428315, 2.388878679587606, 7.334164596022768, 8.605205891639377, 8.509960173033729], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7975260637599306, "mean_inference_ms": 8.11508413334877, "mean_action_processing_ms": 0.5450650637930319, "mean_env_wait_ms": 24.08360021793752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049904823303222656, "StateBufferConnector_ms": 0.03998970985412598, "ViewRequirementAgentConnector_ms": 1.0189712047576904}}, "episode_reward_max": 11.545506229309009, "episode_reward_min": -1.217987571011757, "episode_reward_mean": 7.169243694709752, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.048597534070658, 6.129387188769578, 7.231506996174868, 7.1284097082400235, 7.814625788689759, 8.029871747888059, 9.664769494915552, -1.217987571011757, 10.013857101124081, 8.542927193174808, -0.04416057109271222, 9.383459617814205, 8.45424292109062, 7.490319159423799, 10.58437909641924, 5.372083683124103, 5.935940290845865, 5.527645447828281, 8.741449960842404, 8.136511176025948, 10.753393098293534, 9.406662206626123, 6.789076394456763, 9.221573389945185, 5.368471190622028, 9.925168216669086, 3.141009781455817, 6.614533394293281, 2.062302841386707, 5.4979047425209515, 5.467643452439681, 3.6506881309426427, 5.048402883237263, 3.103808346839703, 6.412216867985812, 9.673904451034453, 7.075009521944386, 8.835559646914676, 9.033389722969002, 9.99238624022372, 7.497311619089864, 10.280667552737695, 8.648972662567516, 7.048839647680034, 9.391422166422494, 10.7156025938416, 8.597086377110756, 10.294944002273866, 4.912778820369162, 9.447210642976163, 4.3775921148350205, 7.4080597009288836, 5.375775761186259, 10.321183807417215, 7.98389807978645, 8.8107399858736, 7.693083033606283, 4.0767051849826315, 5.733208420550385, 5.606134275470497, 5.176190141393272, 6.733739206471106, 6.890062346904293, 10.997986383434858, 8.366498299461337, 7.103709044145809, 5.880675596448142, 8.248344837767949, 11.545506229309009, 8.089578844112312, 8.622503804788552, 5.880633227458422, 5.4072865130272065, 7.780421132124189, 7.267130046126989, 5.720619948626905, 4.967435347823392, 8.687707054872607, 7.40900536256935, 7.614240831530157, 7.016566667692525, 6.520715327846095, 7.901258199197144, 9.78842754474362, 5.14199457481744, 6.088310584304934, 9.151890187187528, 8.071098433747382, 8.097821982147401, 1.8382290167905595, 8.94200575837296, 9.137022810380614, 5.201740996588288, 6.236300778530211, 6.279783051656328, 6.021563083428315, 2.388878679587606, 7.334164596022768, 8.605205891639377, 8.509960173033729], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7975260637599306, "mean_inference_ms": 8.11508413334877, "mean_action_processing_ms": 0.5450650637930319, "mean_env_wait_ms": 24.08360021793752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049904823303222656, "StateBufferConnector_ms": 0.03998970985412598, "ViewRequirementAgentConnector_ms": 1.0189712047576904}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7617792, "num_agent_steps_trained": 7617792, "num_env_steps_sampled": 7617792, "num_env_steps_trained": 7617792, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 276.5475798361775, "num_env_steps_trained_throughput_per_sec": 276.5475798361775, "timesteps_total": 7617792, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7617792, "timers": {"training_iteration_time_ms": 55788.434, "sample_time_ms": 42628.899, "load_time_ms": 1797.264, "load_throughput": 8701.006, "learn_time_ms": 10817.024, "learn_throughput": 1445.684, "synch_weights_time_ms": 425.427}, "counters": {"num_env_steps_sampled": 7617792, "num_env_steps_trained": 7617792, "num_agent_steps_sampled": 7617792, "num_agent_steps_trained": 7617792}, "done": false, "episodes_total": 2016, "training_iteration": 492, "trial_id": "2f030_00000", "date": "2025-06-07_09-52-09", "timestamp": 1749282729, "time_this_iter_s": 56.577152729034424, "time_total_s": 8138.265938282013, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8138.265938282013, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 78.58307692307693, "ram_util_percent": 70.35384615384615, "gpu_util_percent0": 0.08107692307692309, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.88069052631579e-05, "total_loss": -0.05545393033249473, "policy_loss": -0.027908229746601797, "vf_loss": 0.0156355147046799, "vf_explained_var": 0.7550284444202077, "kl": 0.012084006770574805, "entropy": 20.419563609036533, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 79475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7633430, "num_env_steps_trained": 7633430, "num_agent_steps_sampled": 7633430, "num_agent_steps_trained": 7633430}, "sampler_results": {"episode_reward_max": 11.974867393855767, "episode_reward_min": -0.2698995881035525, "episode_reward_mean": 7.242379880007036, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.58437909641924, 5.372083683124103, 5.935940290845865, 5.527645447828281, 8.741449960842404, 8.136511176025948, 10.753393098293534, 9.406662206626123, 6.789076394456763, 9.221573389945185, 5.368471190622028, 9.925168216669086, 3.141009781455817, 6.614533394293281, 2.062302841386707, 5.4979047425209515, 5.467643452439681, 3.6506881309426427, 5.048402883237263, 3.103808346839703, 6.412216867985812, 9.673904451034453, 7.075009521944386, 8.835559646914676, 9.033389722969002, 9.99238624022372, 7.497311619089864, 10.280667552737695, 8.648972662567516, 7.048839647680034, 9.391422166422494, 10.7156025938416, 8.597086377110756, 10.294944002273866, 4.912778820369162, 9.447210642976163, 4.3775921148350205, 7.4080597009288836, 5.375775761186259, 10.321183807417215, 7.98389807978645, 8.8107399858736, 7.693083033606283, 4.0767051849826315, 5.733208420550385, 5.606134275470497, 5.176190141393272, 6.733739206471106, 6.890062346904293, 10.997986383434858, 8.366498299461337, 7.103709044145809, 5.880675596448142, 8.248344837767949, 11.545506229309009, 8.089578844112312, 8.622503804788552, 5.880633227458422, 5.4072865130272065, 7.780421132124189, 7.267130046126989, 5.720619948626905, 4.967435347823392, 8.687707054872607, 7.40900536256935, 7.614240831530157, 7.016566667692525, 6.520715327846095, 7.901258199197144, 9.78842754474362, 5.14199457481744, 6.088310584304934, 9.151890187187528, 8.071098433747382, 8.097821982147401, 1.8382290167905595, 8.94200575837296, 9.137022810380614, 5.201740996588288, 6.236300778530211, 6.279783051656328, 6.021563083428315, 2.388878679587606, 7.334164596022768, 8.605205891639377, 8.509960173033729, 8.227614149795231, 8.2330230034647, 7.642573486865863, 9.064361374259404, -0.2698995881035525, 5.820494107086748, 7.603929491573448, 6.890453001778674, 5.305342211261286, 7.823417111437361, 8.153436653236815, 9.663688654648219, 5.850143787839944, 11.974867393855767], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.796854485193328, "mean_inference_ms": 8.11686085252688, "mean_action_processing_ms": 0.5451649020273965, "mean_env_wait_ms": 24.08781841870676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056157588958740234, "StateBufferConnector_ms": 0.0460662841796875, "ViewRequirementAgentConnector_ms": 1.0227346420288086}}, "episode_reward_max": 11.974867393855767, "episode_reward_min": -0.2698995881035525, "episode_reward_mean": 7.242379880007036, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.58437909641924, 5.372083683124103, 5.935940290845865, 5.527645447828281, 8.741449960842404, 8.136511176025948, 10.753393098293534, 9.406662206626123, 6.789076394456763, 9.221573389945185, 5.368471190622028, 9.925168216669086, 3.141009781455817, 6.614533394293281, 2.062302841386707, 5.4979047425209515, 5.467643452439681, 3.6506881309426427, 5.048402883237263, 3.103808346839703, 6.412216867985812, 9.673904451034453, 7.075009521944386, 8.835559646914676, 9.033389722969002, 9.99238624022372, 7.497311619089864, 10.280667552737695, 8.648972662567516, 7.048839647680034, 9.391422166422494, 10.7156025938416, 8.597086377110756, 10.294944002273866, 4.912778820369162, 9.447210642976163, 4.3775921148350205, 7.4080597009288836, 5.375775761186259, 10.321183807417215, 7.98389807978645, 8.8107399858736, 7.693083033606283, 4.0767051849826315, 5.733208420550385, 5.606134275470497, 5.176190141393272, 6.733739206471106, 6.890062346904293, 10.997986383434858, 8.366498299461337, 7.103709044145809, 5.880675596448142, 8.248344837767949, 11.545506229309009, 8.089578844112312, 8.622503804788552, 5.880633227458422, 5.4072865130272065, 7.780421132124189, 7.267130046126989, 5.720619948626905, 4.967435347823392, 8.687707054872607, 7.40900536256935, 7.614240831530157, 7.016566667692525, 6.520715327846095, 7.901258199197144, 9.78842754474362, 5.14199457481744, 6.088310584304934, 9.151890187187528, 8.071098433747382, 8.097821982147401, 1.8382290167905595, 8.94200575837296, 9.137022810380614, 5.201740996588288, 6.236300778530211, 6.279783051656328, 6.021563083428315, 2.388878679587606, 7.334164596022768, 8.605205891639377, 8.509960173033729, 8.227614149795231, 8.2330230034647, 7.642573486865863, 9.064361374259404, -0.2698995881035525, 5.820494107086748, 7.603929491573448, 6.890453001778674, 5.305342211261286, 7.823417111437361, 8.153436653236815, 9.663688654648219, 5.850143787839944, 11.974867393855767], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.796854485193328, "mean_inference_ms": 8.11686085252688, "mean_action_processing_ms": 0.5451649020273965, "mean_env_wait_ms": 24.08781841870676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056157588958740234, "StateBufferConnector_ms": 0.0460662841796875, "ViewRequirementAgentConnector_ms": 1.0227346420288086}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7633430, "num_agent_steps_trained": 7633430, "num_env_steps_sampled": 7633430, "num_env_steps_trained": 7633430, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 276.0581456706454, "num_env_steps_trained_throughput_per_sec": 276.0581456706454, "timesteps_total": 7633430, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7633430, "timers": {"training_iteration_time_ms": 55942.649, "sample_time_ms": 42801.282, "load_time_ms": 1788.832, "load_throughput": 8742.015, "learn_time_ms": 10808.927, "learn_throughput": 1446.767, "synch_weights_time_ms": 427.847}, "counters": {"num_env_steps_sampled": 7633430, "num_env_steps_trained": 7633430, "num_agent_steps_sampled": 7633430, "num_agent_steps_trained": 7633430}, "done": false, "episodes_total": 2030, "training_iteration": 493, "trial_id": "2f030_00000", "date": "2025-06-07_09-53-06", "timestamp": 1749282786, "time_this_iter_s": 56.66451597213745, "time_total_s": 8194.93045425415, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8194.93045425415, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 78.9921875, "ram_util_percent": 70.628125, "gpu_util_percent0": 0.07234375, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.868344736842106e-05, "total_loss": -0.056725714437832885, "policy_loss": -0.028449048342564228, "vf_loss": 0.014889040077951821, "vf_explained_var": 0.7223152457584034, "kl": 0.011522039219178807, "entropy": 20.473039243871515, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 80025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7649068, "num_env_steps_trained": 7649068, "num_agent_steps_sampled": 7649068, "num_agent_steps_trained": 7649068}, "sampler_results": {"episode_reward_max": 11.974867393855767, "episode_reward_min": -0.2698995881035525, "episode_reward_mean": 7.170731731597426, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.062302841386707, 5.4979047425209515, 5.467643452439681, 3.6506881309426427, 5.048402883237263, 3.103808346839703, 6.412216867985812, 9.673904451034453, 7.075009521944386, 8.835559646914676, 9.033389722969002, 9.99238624022372, 7.497311619089864, 10.280667552737695, 8.648972662567516, 7.048839647680034, 9.391422166422494, 10.7156025938416, 8.597086377110756, 10.294944002273866, 4.912778820369162, 9.447210642976163, 4.3775921148350205, 7.4080597009288836, 5.375775761186259, 10.321183807417215, 7.98389807978645, 8.8107399858736, 7.693083033606283, 4.0767051849826315, 5.733208420550385, 5.606134275470497, 5.176190141393272, 6.733739206471106, 6.890062346904293, 10.997986383434858, 8.366498299461337, 7.103709044145809, 5.880675596448142, 8.248344837767949, 11.545506229309009, 8.089578844112312, 8.622503804788552, 5.880633227458422, 5.4072865130272065, 7.780421132124189, 7.267130046126989, 5.720619948626905, 4.967435347823392, 8.687707054872607, 7.40900536256935, 7.614240831530157, 7.016566667692525, 6.520715327846095, 7.901258199197144, 9.78842754474362, 5.14199457481744, 6.088310584304934, 9.151890187187528, 8.071098433747382, 8.097821982147401, 1.8382290167905595, 8.94200575837296, 9.137022810380614, 5.201740996588288, 6.236300778530211, 6.279783051656328, 6.021563083428315, 2.388878679587606, 7.334164596022768, 8.605205891639377, 8.509960173033729, 8.227614149795231, 8.2330230034647, 7.642573486865863, 9.064361374259404, -0.2698995881035525, 5.820494107086748, 7.603929491573448, 6.890453001778674, 5.305342211261286, 7.823417111437361, 8.153436653236815, 9.663688654648219, 5.850143787839944, 11.974867393855767, 8.532035755014542, 8.441545241944377, 8.766928521973826, 1.3562772738988915, 9.866435697003729, 3.646566586155399, 5.7691259304929545, 9.229768918753754, 10.328479311065367, 8.884312823734229, 2.424207106157183, 8.612603363969054, 4.776083638349014, 7.718712317974502], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.79623253506609, "mean_inference_ms": 8.11869265314426, "mean_action_processing_ms": 0.5452739470596293, "mean_env_wait_ms": 24.092193795521617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06169271469116211, "StateBufferConnector_ms": 0.041019439697265625, "ViewRequirementAgentConnector_ms": 1.0449633598327637}}, "episode_reward_max": 11.974867393855767, "episode_reward_min": -0.2698995881035525, "episode_reward_mean": 7.170731731597426, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.062302841386707, 5.4979047425209515, 5.467643452439681, 3.6506881309426427, 5.048402883237263, 3.103808346839703, 6.412216867985812, 9.673904451034453, 7.075009521944386, 8.835559646914676, 9.033389722969002, 9.99238624022372, 7.497311619089864, 10.280667552737695, 8.648972662567516, 7.048839647680034, 9.391422166422494, 10.7156025938416, 8.597086377110756, 10.294944002273866, 4.912778820369162, 9.447210642976163, 4.3775921148350205, 7.4080597009288836, 5.375775761186259, 10.321183807417215, 7.98389807978645, 8.8107399858736, 7.693083033606283, 4.0767051849826315, 5.733208420550385, 5.606134275470497, 5.176190141393272, 6.733739206471106, 6.890062346904293, 10.997986383434858, 8.366498299461337, 7.103709044145809, 5.880675596448142, 8.248344837767949, 11.545506229309009, 8.089578844112312, 8.622503804788552, 5.880633227458422, 5.4072865130272065, 7.780421132124189, 7.267130046126989, 5.720619948626905, 4.967435347823392, 8.687707054872607, 7.40900536256935, 7.614240831530157, 7.016566667692525, 6.520715327846095, 7.901258199197144, 9.78842754474362, 5.14199457481744, 6.088310584304934, 9.151890187187528, 8.071098433747382, 8.097821982147401, 1.8382290167905595, 8.94200575837296, 9.137022810380614, 5.201740996588288, 6.236300778530211, 6.279783051656328, 6.021563083428315, 2.388878679587606, 7.334164596022768, 8.605205891639377, 8.509960173033729, 8.227614149795231, 8.2330230034647, 7.642573486865863, 9.064361374259404, -0.2698995881035525, 5.820494107086748, 7.603929491573448, 6.890453001778674, 5.305342211261286, 7.823417111437361, 8.153436653236815, 9.663688654648219, 5.850143787839944, 11.974867393855767, 8.532035755014542, 8.441545241944377, 8.766928521973826, 1.3562772738988915, 9.866435697003729, 3.646566586155399, 5.7691259304929545, 9.229768918753754, 10.328479311065367, 8.884312823734229, 2.424207106157183, 8.612603363969054, 4.776083638349014, 7.718712317974502], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.79623253506609, "mean_inference_ms": 8.11869265314426, "mean_action_processing_ms": 0.5452739470596293, "mean_env_wait_ms": 24.092193795521617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06169271469116211, "StateBufferConnector_ms": 0.041019439697265625, "ViewRequirementAgentConnector_ms": 1.0449633598327637}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7649068, "num_agent_steps_trained": 7649068, "num_env_steps_sampled": 7649068, "num_env_steps_trained": 7649068, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.0682447088953, "num_env_steps_trained_throughput_per_sec": 278.0682447088953, "timesteps_total": 7649068, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7649068, "timers": {"training_iteration_time_ms": 55996.124, "sample_time_ms": 42833.352, "load_time_ms": 1784.31, "load_throughput": 8764.171, "learn_time_ms": 10836.338, "learn_throughput": 1443.107, "synch_weights_time_ms": 425.444}, "counters": {"num_env_steps_sampled": 7649068, "num_env_steps_trained": 7649068, "num_agent_steps_sampled": 7649068, "num_agent_steps_trained": 7649068}, "done": false, "episodes_total": 2044, "training_iteration": 494, "trial_id": "2f030_00000", "date": "2025-06-07_09-54-02", "timestamp": 1749282842, "time_this_iter_s": 56.25297832489014, "time_total_s": 8251.18343257904, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8251.18343257904, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 78.82343750000001, "ram_util_percent": 70.76093750000001, "gpu_util_percent0": 0.075625, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.8559989473684216e-05, "total_loss": -0.05399870070967484, "policy_loss": -0.026180742174302312, "vf_loss": 0.015473198284479704, "vf_explained_var": 0.7208674547889016, "kl": 0.011778079640897162, "entropy": 20.42244782187722, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 80575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7664706, "num_env_steps_trained": 7664706, "num_agent_steps_sampled": 7664706, "num_agent_steps_trained": 7664706}, "sampler_results": {"episode_reward_max": 11.974867393855767, "episode_reward_min": -0.2698995881035525, "episode_reward_mean": 7.147469384361682, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.648972662567516, 7.048839647680034, 9.391422166422494, 10.7156025938416, 8.597086377110756, 10.294944002273866, 4.912778820369162, 9.447210642976163, 4.3775921148350205, 7.4080597009288836, 5.375775761186259, 10.321183807417215, 7.98389807978645, 8.8107399858736, 7.693083033606283, 4.0767051849826315, 5.733208420550385, 5.606134275470497, 5.176190141393272, 6.733739206471106, 6.890062346904293, 10.997986383434858, 8.366498299461337, 7.103709044145809, 5.880675596448142, 8.248344837767949, 11.545506229309009, 8.089578844112312, 8.622503804788552, 5.880633227458422, 5.4072865130272065, 7.780421132124189, 7.267130046126989, 5.720619948626905, 4.967435347823392, 8.687707054872607, 7.40900536256935, 7.614240831530157, 7.016566667692525, 6.520715327846095, 7.901258199197144, 9.78842754474362, 5.14199457481744, 6.088310584304934, 9.151890187187528, 8.071098433747382, 8.097821982147401, 1.8382290167905595, 8.94200575837296, 9.137022810380614, 5.201740996588288, 6.236300778530211, 6.279783051656328, 6.021563083428315, 2.388878679587606, 7.334164596022768, 8.605205891639377, 8.509960173033729, 8.227614149795231, 8.2330230034647, 7.642573486865863, 9.064361374259404, -0.2698995881035525, 5.820494107086748, 7.603929491573448, 6.890453001778674, 5.305342211261286, 7.823417111437361, 8.153436653236815, 9.663688654648219, 5.850143787839944, 11.974867393855767, 8.532035755014542, 8.441545241944377, 8.766928521973826, 1.3562772738988915, 9.866435697003729, 3.646566586155399, 5.7691259304929545, 9.229768918753754, 10.328479311065367, 8.884312823734229, 2.424207106157183, 8.612603363969054, 4.776083638349014, 7.718712317974502, 6.699692230959303, 4.410018989040804, 7.6546040200733785, 4.62430911502989, 10.144003822311415, 5.032747657517903, 5.35001893975055, 3.0967577950582004, 10.225531511302282, 3.4428094891057572, 7.720565685865192, 7.4800535349256405, 8.782983475521204, 6.640865030230443], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.795682733527153, "mean_inference_ms": 8.12046298700895, "mean_action_processing_ms": 0.5453802687009626, "mean_env_wait_ms": 24.096180750999455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05366110801696777, "StateBufferConnector_ms": 0.0405731201171875, "ViewRequirementAgentConnector_ms": 1.058574914932251}}, "episode_reward_max": 11.974867393855767, "episode_reward_min": -0.2698995881035525, "episode_reward_mean": 7.147469384361682, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.648972662567516, 7.048839647680034, 9.391422166422494, 10.7156025938416, 8.597086377110756, 10.294944002273866, 4.912778820369162, 9.447210642976163, 4.3775921148350205, 7.4080597009288836, 5.375775761186259, 10.321183807417215, 7.98389807978645, 8.8107399858736, 7.693083033606283, 4.0767051849826315, 5.733208420550385, 5.606134275470497, 5.176190141393272, 6.733739206471106, 6.890062346904293, 10.997986383434858, 8.366498299461337, 7.103709044145809, 5.880675596448142, 8.248344837767949, 11.545506229309009, 8.089578844112312, 8.622503804788552, 5.880633227458422, 5.4072865130272065, 7.780421132124189, 7.267130046126989, 5.720619948626905, 4.967435347823392, 8.687707054872607, 7.40900536256935, 7.614240831530157, 7.016566667692525, 6.520715327846095, 7.901258199197144, 9.78842754474362, 5.14199457481744, 6.088310584304934, 9.151890187187528, 8.071098433747382, 8.097821982147401, 1.8382290167905595, 8.94200575837296, 9.137022810380614, 5.201740996588288, 6.236300778530211, 6.279783051656328, 6.021563083428315, 2.388878679587606, 7.334164596022768, 8.605205891639377, 8.509960173033729, 8.227614149795231, 8.2330230034647, 7.642573486865863, 9.064361374259404, -0.2698995881035525, 5.820494107086748, 7.603929491573448, 6.890453001778674, 5.305342211261286, 7.823417111437361, 8.153436653236815, 9.663688654648219, 5.850143787839944, 11.974867393855767, 8.532035755014542, 8.441545241944377, 8.766928521973826, 1.3562772738988915, 9.866435697003729, 3.646566586155399, 5.7691259304929545, 9.229768918753754, 10.328479311065367, 8.884312823734229, 2.424207106157183, 8.612603363969054, 4.776083638349014, 7.718712317974502, 6.699692230959303, 4.410018989040804, 7.6546040200733785, 4.62430911502989, 10.144003822311415, 5.032747657517903, 5.35001893975055, 3.0967577950582004, 10.225531511302282, 3.4428094891057572, 7.720565685865192, 7.4800535349256405, 8.782983475521204, 6.640865030230443], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.795682733527153, "mean_inference_ms": 8.12046298700895, "mean_action_processing_ms": 0.5453802687009626, "mean_env_wait_ms": 24.096180750999455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05366110801696777, "StateBufferConnector_ms": 0.0405731201171875, "ViewRequirementAgentConnector_ms": 1.058574914932251}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7664706, "num_agent_steps_trained": 7664706, "num_env_steps_sampled": 7664706, "num_env_steps_trained": 7664706, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.8437326393599, "num_env_steps_trained_throughput_per_sec": 282.8437326393599, "timesteps_total": 7664706, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7664706, "timers": {"training_iteration_time_ms": 55992.778, "sample_time_ms": 42836.679, "load_time_ms": 1777.037, "load_throughput": 8800.043, "learn_time_ms": 10832.539, "learn_throughput": 1443.614, "synch_weights_time_ms": 429.595}, "counters": {"num_env_steps_sampled": 7664706, "num_env_steps_trained": 7664706, "num_agent_steps_sampled": 7664706, "num_agent_steps_trained": 7664706}, "done": false, "episodes_total": 2058, "training_iteration": 495, "trial_id": "2f030_00000", "date": "2025-06-07_09-54-57", "timestamp": 1749282897, "time_this_iter_s": 55.305028676986694, "time_total_s": 8306.488461256027, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8306.488461256027, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 77.68412698412699, "ram_util_percent": 70.615873015873, "gpu_util_percent0": 0.07825396825396826, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.8436531578947374e-05, "total_loss": -0.05089902794157917, "policy_loss": -0.023216747460960918, "vf_loss": 0.014206751453774896, "vf_explained_var": 0.7485146982019598, "kl": 0.01244182886202786, "entropy": 20.400908783999355, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 81125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7680344, "num_env_steps_trained": 7680344, "num_agent_steps_sampled": 7680344, "num_agent_steps_trained": 7680344}, "sampler_results": {"episode_reward_max": 11.974867393855767, "episode_reward_min": -0.2698995881035525, "episode_reward_mean": 7.0236512056943186, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.693083033606283, 4.0767051849826315, 5.733208420550385, 5.606134275470497, 5.176190141393272, 6.733739206471106, 6.890062346904293, 10.997986383434858, 8.366498299461337, 7.103709044145809, 5.880675596448142, 8.248344837767949, 11.545506229309009, 8.089578844112312, 8.622503804788552, 5.880633227458422, 5.4072865130272065, 7.780421132124189, 7.267130046126989, 5.720619948626905, 4.967435347823392, 8.687707054872607, 7.40900536256935, 7.614240831530157, 7.016566667692525, 6.520715327846095, 7.901258199197144, 9.78842754474362, 5.14199457481744, 6.088310584304934, 9.151890187187528, 8.071098433747382, 8.097821982147401, 1.8382290167905595, 8.94200575837296, 9.137022810380614, 5.201740996588288, 6.236300778530211, 6.279783051656328, 6.021563083428315, 2.388878679587606, 7.334164596022768, 8.605205891639377, 8.509960173033729, 8.227614149795231, 8.2330230034647, 7.642573486865863, 9.064361374259404, -0.2698995881035525, 5.820494107086748, 7.603929491573448, 6.890453001778674, 5.305342211261286, 7.823417111437361, 8.153436653236815, 9.663688654648219, 5.850143787839944, 11.974867393855767, 8.532035755014542, 8.441545241944377, 8.766928521973826, 1.3562772738988915, 9.866435697003729, 3.646566586155399, 5.7691259304929545, 9.229768918753754, 10.328479311065367, 8.884312823734229, 2.424207106157183, 8.612603363969054, 4.776083638349014, 7.718712317974502, 6.699692230959303, 4.410018989040804, 7.6546040200733785, 4.62430911502989, 10.144003822311415, 5.032747657517903, 5.35001893975055, 3.0967577950582004, 10.225531511302282, 3.4428094891057572, 7.720565685865192, 7.4800535349256405, 8.782983475521204, 6.640865030230443, 6.2684494208054105, 7.315247581963048, 3.949770259146089, 5.640156628347769, 7.748498787201204, 8.284844962564668, 3.932067363823045, 8.735652665914934, 4.807694721107165, 8.556886786939774, 8.133455964119115, 8.85511302534005, 10.67610252710522, 8.04834780215516], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.795013695017592, "mean_inference_ms": 8.122198997588033, "mean_action_processing_ms": 0.5455081741157413, "mean_env_wait_ms": 24.100324687000544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07018923759460449, "StateBufferConnector_ms": 0.03862714767456055, "ViewRequirementAgentConnector_ms": 1.0366642475128174}}, "episode_reward_max": 11.974867393855767, "episode_reward_min": -0.2698995881035525, "episode_reward_mean": 7.0236512056943186, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.693083033606283, 4.0767051849826315, 5.733208420550385, 5.606134275470497, 5.176190141393272, 6.733739206471106, 6.890062346904293, 10.997986383434858, 8.366498299461337, 7.103709044145809, 5.880675596448142, 8.248344837767949, 11.545506229309009, 8.089578844112312, 8.622503804788552, 5.880633227458422, 5.4072865130272065, 7.780421132124189, 7.267130046126989, 5.720619948626905, 4.967435347823392, 8.687707054872607, 7.40900536256935, 7.614240831530157, 7.016566667692525, 6.520715327846095, 7.901258199197144, 9.78842754474362, 5.14199457481744, 6.088310584304934, 9.151890187187528, 8.071098433747382, 8.097821982147401, 1.8382290167905595, 8.94200575837296, 9.137022810380614, 5.201740996588288, 6.236300778530211, 6.279783051656328, 6.021563083428315, 2.388878679587606, 7.334164596022768, 8.605205891639377, 8.509960173033729, 8.227614149795231, 8.2330230034647, 7.642573486865863, 9.064361374259404, -0.2698995881035525, 5.820494107086748, 7.603929491573448, 6.890453001778674, 5.305342211261286, 7.823417111437361, 8.153436653236815, 9.663688654648219, 5.850143787839944, 11.974867393855767, 8.532035755014542, 8.441545241944377, 8.766928521973826, 1.3562772738988915, 9.866435697003729, 3.646566586155399, 5.7691259304929545, 9.229768918753754, 10.328479311065367, 8.884312823734229, 2.424207106157183, 8.612603363969054, 4.776083638349014, 7.718712317974502, 6.699692230959303, 4.410018989040804, 7.6546040200733785, 4.62430911502989, 10.144003822311415, 5.032747657517903, 5.35001893975055, 3.0967577950582004, 10.225531511302282, 3.4428094891057572, 7.720565685865192, 7.4800535349256405, 8.782983475521204, 6.640865030230443, 6.2684494208054105, 7.315247581963048, 3.949770259146089, 5.640156628347769, 7.748498787201204, 8.284844962564668, 3.932067363823045, 8.735652665914934, 4.807694721107165, 8.556886786939774, 8.133455964119115, 8.85511302534005, 10.67610252710522, 8.04834780215516], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.795013695017592, "mean_inference_ms": 8.122198997588033, "mean_action_processing_ms": 0.5455081741157413, "mean_env_wait_ms": 24.100324687000544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07018923759460449, "StateBufferConnector_ms": 0.03862714767456055, "ViewRequirementAgentConnector_ms": 1.0366642475128174}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7680344, "num_agent_steps_trained": 7680344, "num_env_steps_sampled": 7680344, "num_env_steps_trained": 7680344, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.747678441801, "num_env_steps_trained_throughput_per_sec": 281.747678441801, "timesteps_total": 7680344, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7680344, "timers": {"training_iteration_time_ms": 55962.884, "sample_time_ms": 42804.351, "load_time_ms": 1778.33, "load_throughput": 8793.642, "learn_time_ms": 10837.535, "learn_throughput": 1442.948, "synch_weights_time_ms": 427.973}, "counters": {"num_env_steps_sampled": 7680344, "num_env_steps_trained": 7680344, "num_agent_steps_sampled": 7680344, "num_agent_steps_trained": 7680344}, "done": false, "episodes_total": 2072, "training_iteration": 496, "trial_id": "2f030_00000", "date": "2025-06-07_09-55-53", "timestamp": 1749282953, "time_this_iter_s": 55.530102491378784, "time_total_s": 8362.018563747406, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8362.018563747406, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 77.98253968253971, "ram_util_percent": 70.66666666666666, "gpu_util_percent0": 0.08047619047619049, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.831307368421053e-05, "total_loss": -0.05875656555914743, "policy_loss": -0.03022326912945242, "vf_loss": 0.013817503208463842, "vf_explained_var": 0.736228811415759, "kl": 0.011582834335038735, "entropy": 20.462264321067117, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 81675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7695982, "num_env_steps_trained": 7695982, "num_agent_steps_sampled": 7695982, "num_agent_steps_trained": 7695982}, "sampler_results": {"episode_reward_max": 11.974867393855767, "episode_reward_min": -0.2698995881035525, "episode_reward_mean": 6.926812430215255, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.622503804788552, 5.880633227458422, 5.4072865130272065, 7.780421132124189, 7.267130046126989, 5.720619948626905, 4.967435347823392, 8.687707054872607, 7.40900536256935, 7.614240831530157, 7.016566667692525, 6.520715327846095, 7.901258199197144, 9.78842754474362, 5.14199457481744, 6.088310584304934, 9.151890187187528, 8.071098433747382, 8.097821982147401, 1.8382290167905595, 8.94200575837296, 9.137022810380614, 5.201740996588288, 6.236300778530211, 6.279783051656328, 6.021563083428315, 2.388878679587606, 7.334164596022768, 8.605205891639377, 8.509960173033729, 8.227614149795231, 8.2330230034647, 7.642573486865863, 9.064361374259404, -0.2698995881035525, 5.820494107086748, 7.603929491573448, 6.890453001778674, 5.305342211261286, 7.823417111437361, 8.153436653236815, 9.663688654648219, 5.850143787839944, 11.974867393855767, 8.532035755014542, 8.441545241944377, 8.766928521973826, 1.3562772738988915, 9.866435697003729, 3.646566586155399, 5.7691259304929545, 9.229768918753754, 10.328479311065367, 8.884312823734229, 2.424207106157183, 8.612603363969054, 4.776083638349014, 7.718712317974502, 6.699692230959303, 4.410018989040804, 7.6546040200733785, 4.62430911502989, 10.144003822311415, 5.032747657517903, 5.35001893975055, 3.0967577950582004, 10.225531511302282, 3.4428094891057572, 7.720565685865192, 7.4800535349256405, 8.782983475521204, 6.640865030230443, 6.2684494208054105, 7.315247581963048, 3.949770259146089, 5.640156628347769, 7.748498787201204, 8.284844962564668, 3.932067363823045, 8.735652665914934, 4.807694721107165, 8.556886786939774, 8.133455964119115, 8.85511302534005, 10.67610252710522, 8.04834780215516, 7.005766721038474, 7.159392287295887, 5.337178205111519, 1.5685444006116667, 8.97399738487972, 7.70035668129955, 6.6398267394676855, 8.98074168445917, 6.600881021873087, 7.720543088283, 7.975140434682152, 6.288202367236536, 6.554707333021036, 3.952265946892137], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7941802283726904, "mean_inference_ms": 8.12391641671308, "mean_action_processing_ms": 0.5456270561635358, "mean_env_wait_ms": 24.104870794879925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06827092170715332, "StateBufferConnector_ms": 0.04109001159667969, "ViewRequirementAgentConnector_ms": 1.0229954719543457}}, "episode_reward_max": 11.974867393855767, "episode_reward_min": -0.2698995881035525, "episode_reward_mean": 6.926812430215255, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.622503804788552, 5.880633227458422, 5.4072865130272065, 7.780421132124189, 7.267130046126989, 5.720619948626905, 4.967435347823392, 8.687707054872607, 7.40900536256935, 7.614240831530157, 7.016566667692525, 6.520715327846095, 7.901258199197144, 9.78842754474362, 5.14199457481744, 6.088310584304934, 9.151890187187528, 8.071098433747382, 8.097821982147401, 1.8382290167905595, 8.94200575837296, 9.137022810380614, 5.201740996588288, 6.236300778530211, 6.279783051656328, 6.021563083428315, 2.388878679587606, 7.334164596022768, 8.605205891639377, 8.509960173033729, 8.227614149795231, 8.2330230034647, 7.642573486865863, 9.064361374259404, -0.2698995881035525, 5.820494107086748, 7.603929491573448, 6.890453001778674, 5.305342211261286, 7.823417111437361, 8.153436653236815, 9.663688654648219, 5.850143787839944, 11.974867393855767, 8.532035755014542, 8.441545241944377, 8.766928521973826, 1.3562772738988915, 9.866435697003729, 3.646566586155399, 5.7691259304929545, 9.229768918753754, 10.328479311065367, 8.884312823734229, 2.424207106157183, 8.612603363969054, 4.776083638349014, 7.718712317974502, 6.699692230959303, 4.410018989040804, 7.6546040200733785, 4.62430911502989, 10.144003822311415, 5.032747657517903, 5.35001893975055, 3.0967577950582004, 10.225531511302282, 3.4428094891057572, 7.720565685865192, 7.4800535349256405, 8.782983475521204, 6.640865030230443, 6.2684494208054105, 7.315247581963048, 3.949770259146089, 5.640156628347769, 7.748498787201204, 8.284844962564668, 3.932067363823045, 8.735652665914934, 4.807694721107165, 8.556886786939774, 8.133455964119115, 8.85511302534005, 10.67610252710522, 8.04834780215516, 7.005766721038474, 7.159392287295887, 5.337178205111519, 1.5685444006116667, 8.97399738487972, 7.70035668129955, 6.6398267394676855, 8.98074168445917, 6.600881021873087, 7.720543088283, 7.975140434682152, 6.288202367236536, 6.554707333021036, 3.952265946892137], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7941802283726904, "mean_inference_ms": 8.12391641671308, "mean_action_processing_ms": 0.5456270561635358, "mean_env_wait_ms": 24.104870794879925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06827092170715332, "StateBufferConnector_ms": 0.04109001159667969, "ViewRequirementAgentConnector_ms": 1.0229954719543457}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7695982, "num_agent_steps_trained": 7695982, "num_env_steps_sampled": 7695982, "num_env_steps_trained": 7695982, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.8424736439115, "num_env_steps_trained_throughput_per_sec": 278.8424736439115, "timesteps_total": 7695982, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7695982, "timers": {"training_iteration_time_ms": 55989.861, "sample_time_ms": 42828.018, "load_time_ms": 1767.213, "load_throughput": 8848.959, "learn_time_ms": 10851.098, "learn_throughput": 1441.144, "synch_weights_time_ms": 427.739}, "counters": {"num_env_steps_sampled": 7695982, "num_env_steps_trained": 7695982, "num_agent_steps_sampled": 7695982, "num_agent_steps_trained": 7695982}, "done": false, "episodes_total": 2086, "training_iteration": 497, "trial_id": "2f030_00000", "date": "2025-06-07_09-56-49", "timestamp": 1749283009, "time_this_iter_s": 56.08831310272217, "time_total_s": 8418.106876850128, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8418.106876850128, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 78.2296875, "ram_util_percent": 70.434375, "gpu_util_percent0": 0.07171875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.8189615789473696e-05, "total_loss": -0.05806842810432003, "policy_loss": -0.030259760268223048, "vf_loss": 0.01485250089656223, "vf_explained_var": 0.7296945445104078, "kl": 0.012055177805093329, "entropy": 20.423333592848344, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 82225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7711620, "num_env_steps_trained": 7711620, "num_agent_steps_sampled": 7711620, "num_agent_steps_trained": 7711620}, "sampler_results": {"episode_reward_max": 11.974867393855767, "episode_reward_min": -0.2698995881035525, "episode_reward_mean": 6.799590198213283, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.14199457481744, 6.088310584304934, 9.151890187187528, 8.071098433747382, 8.097821982147401, 1.8382290167905595, 8.94200575837296, 9.137022810380614, 5.201740996588288, 6.236300778530211, 6.279783051656328, 6.021563083428315, 2.388878679587606, 7.334164596022768, 8.605205891639377, 8.509960173033729, 8.227614149795231, 8.2330230034647, 7.642573486865863, 9.064361374259404, -0.2698995881035525, 5.820494107086748, 7.603929491573448, 6.890453001778674, 5.305342211261286, 7.823417111437361, 8.153436653236815, 9.663688654648219, 5.850143787839944, 11.974867393855767, 8.532035755014542, 8.441545241944377, 8.766928521973826, 1.3562772738988915, 9.866435697003729, 3.646566586155399, 5.7691259304929545, 9.229768918753754, 10.328479311065367, 8.884312823734229, 2.424207106157183, 8.612603363969054, 4.776083638349014, 7.718712317974502, 6.699692230959303, 4.410018989040804, 7.6546040200733785, 4.62430911502989, 10.144003822311415, 5.032747657517903, 5.35001893975055, 3.0967577950582004, 10.225531511302282, 3.4428094891057572, 7.720565685865192, 7.4800535349256405, 8.782983475521204, 6.640865030230443, 6.2684494208054105, 7.315247581963048, 3.949770259146089, 5.640156628347769, 7.748498787201204, 8.284844962564668, 3.932067363823045, 8.735652665914934, 4.807694721107165, 8.556886786939774, 8.133455964119115, 8.85511302534005, 10.67610252710522, 8.04834780215516, 7.005766721038474, 7.159392287295887, 5.337178205111519, 1.5685444006116667, 8.97399738487972, 7.70035668129955, 6.6398267394676855, 8.98074168445917, 6.600881021873087, 7.720543088283, 7.975140434682152, 6.288202367236536, 6.554707333021036, 3.952265946892137, 4.148040490737504, 9.216382775770105, 2.3385149882501053, 3.1479618791190234, 6.094387992540233, 6.919814696770869, 5.180617255469582, 6.85294513300095, 8.256007835286795, 9.144704873385853, 6.375350176323801, 6.578955068839807, 7.8131910845081265, 5.7948535582270955], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7931967550623615, "mean_inference_ms": 8.125562494980027, "mean_action_processing_ms": 0.5457545783933113, "mean_env_wait_ms": 24.10892434420186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07036995887756348, "StateBufferConnector_ms": 0.03563427925109863, "ViewRequirementAgentConnector_ms": 0.9816243648529053}}, "episode_reward_max": 11.974867393855767, "episode_reward_min": -0.2698995881035525, "episode_reward_mean": 6.799590198213283, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.14199457481744, 6.088310584304934, 9.151890187187528, 8.071098433747382, 8.097821982147401, 1.8382290167905595, 8.94200575837296, 9.137022810380614, 5.201740996588288, 6.236300778530211, 6.279783051656328, 6.021563083428315, 2.388878679587606, 7.334164596022768, 8.605205891639377, 8.509960173033729, 8.227614149795231, 8.2330230034647, 7.642573486865863, 9.064361374259404, -0.2698995881035525, 5.820494107086748, 7.603929491573448, 6.890453001778674, 5.305342211261286, 7.823417111437361, 8.153436653236815, 9.663688654648219, 5.850143787839944, 11.974867393855767, 8.532035755014542, 8.441545241944377, 8.766928521973826, 1.3562772738988915, 9.866435697003729, 3.646566586155399, 5.7691259304929545, 9.229768918753754, 10.328479311065367, 8.884312823734229, 2.424207106157183, 8.612603363969054, 4.776083638349014, 7.718712317974502, 6.699692230959303, 4.410018989040804, 7.6546040200733785, 4.62430911502989, 10.144003822311415, 5.032747657517903, 5.35001893975055, 3.0967577950582004, 10.225531511302282, 3.4428094891057572, 7.720565685865192, 7.4800535349256405, 8.782983475521204, 6.640865030230443, 6.2684494208054105, 7.315247581963048, 3.949770259146089, 5.640156628347769, 7.748498787201204, 8.284844962564668, 3.932067363823045, 8.735652665914934, 4.807694721107165, 8.556886786939774, 8.133455964119115, 8.85511302534005, 10.67610252710522, 8.04834780215516, 7.005766721038474, 7.159392287295887, 5.337178205111519, 1.5685444006116667, 8.97399738487972, 7.70035668129955, 6.6398267394676855, 8.98074168445917, 6.600881021873087, 7.720543088283, 7.975140434682152, 6.288202367236536, 6.554707333021036, 3.952265946892137, 4.148040490737504, 9.216382775770105, 2.3385149882501053, 3.1479618791190234, 6.094387992540233, 6.919814696770869, 5.180617255469582, 6.85294513300095, 8.256007835286795, 9.144704873385853, 6.375350176323801, 6.578955068839807, 7.8131910845081265, 5.7948535582270955], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7931967550623615, "mean_inference_ms": 8.125562494980027, "mean_action_processing_ms": 0.5457545783933113, "mean_env_wait_ms": 24.10892434420186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07036995887756348, "StateBufferConnector_ms": 0.03563427925109863, "ViewRequirementAgentConnector_ms": 0.9816243648529053}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7711620, "num_agent_steps_trained": 7711620, "num_env_steps_sampled": 7711620, "num_env_steps_trained": 7711620, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.54951507866014, "num_env_steps_trained_throughput_per_sec": 282.54951507866014, "timesteps_total": 7711620, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7711620, "timers": {"training_iteration_time_ms": 55954.314, "sample_time_ms": 42792.014, "load_time_ms": 1764.792, "load_throughput": 8861.1, "learn_time_ms": 10849.826, "learn_throughput": 1441.313, "synch_weights_time_ms": 427.028}, "counters": {"num_env_steps_sampled": 7711620, "num_env_steps_trained": 7711620, "num_agent_steps_sampled": 7711620, "num_agent_steps_trained": 7711620}, "done": false, "episodes_total": 2100, "training_iteration": 498, "trial_id": "2f030_00000", "date": "2025-06-07_09-57-45", "timestamp": 1749283065, "time_this_iter_s": 55.36596488952637, "time_total_s": 8473.472841739655, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8473.472841739655, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 77.0640625, "ram_util_percent": 70.5453125, "gpu_util_percent0": 0.08656249999999999, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.806615789473685e-05, "total_loss": -0.049994461026720026, "policy_loss": -0.022336698439268565, "vf_loss": 0.015287874236872251, "vf_explained_var": 0.7125682158903642, "kl": 0.011919929056168607, "entropy": 20.365044136047363, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 82775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7727258, "num_env_steps_trained": 7727258, "num_agent_steps_sampled": 7727258, "num_agent_steps_trained": 7727258}, "sampler_results": {"episode_reward_max": 11.974867393855767, "episode_reward_min": -0.2698995881035525, "episode_reward_mean": 6.841747777986442, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.605205891639377, 8.509960173033729, 8.227614149795231, 8.2330230034647, 7.642573486865863, 9.064361374259404, -0.2698995881035525, 5.820494107086748, 7.603929491573448, 6.890453001778674, 5.305342211261286, 7.823417111437361, 8.153436653236815, 9.663688654648219, 5.850143787839944, 11.974867393855767, 8.532035755014542, 8.441545241944377, 8.766928521973826, 1.3562772738988915, 9.866435697003729, 3.646566586155399, 5.7691259304929545, 9.229768918753754, 10.328479311065367, 8.884312823734229, 2.424207106157183, 8.612603363969054, 4.776083638349014, 7.718712317974502, 6.699692230959303, 4.410018989040804, 7.6546040200733785, 4.62430911502989, 10.144003822311415, 5.032747657517903, 5.35001893975055, 3.0967577950582004, 10.225531511302282, 3.4428094891057572, 7.720565685865192, 7.4800535349256405, 8.782983475521204, 6.640865030230443, 6.2684494208054105, 7.315247581963048, 3.949770259146089, 5.640156628347769, 7.748498787201204, 8.284844962564668, 3.932067363823045, 8.735652665914934, 4.807694721107165, 8.556886786939774, 8.133455964119115, 8.85511302534005, 10.67610252710522, 8.04834780215516, 7.005766721038474, 7.159392287295887, 5.337178205111519, 1.5685444006116667, 8.97399738487972, 7.70035668129955, 6.6398267394676855, 8.98074168445917, 6.600881021873087, 7.720543088283, 7.975140434682152, 6.288202367236536, 6.554707333021036, 3.952265946892137, 4.148040490737504, 9.216382775770105, 2.3385149882501053, 3.1479618791190234, 6.094387992540233, 6.919814696770869, 5.180617255469582, 6.85294513300095, 8.256007835286795, 9.144704873385853, 6.375350176323801, 6.578955068839807, 7.8131910845081265, 5.7948535582270955, 9.001858186890622, 10.960533711441922, 1.8907969705121905, 9.207405187295443, 8.72774581405163, 3.3328700575930923, 4.262443111745383, 6.824590095437072, 6.9451261958531765, 4.012117982798688, 7.689519679011713, 7.995811850926823, 5.5703076707573, 7.725435996563334], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7919993364723577, "mean_inference_ms": 8.127096977168629, "mean_action_processing_ms": 0.5458779917641327, "mean_env_wait_ms": 24.11297315849622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07330870628356934, "StateBufferConnector_ms": 0.03367447853088379, "ViewRequirementAgentConnector_ms": 0.9815409183502197}}, "episode_reward_max": 11.974867393855767, "episode_reward_min": -0.2698995881035525, "episode_reward_mean": 6.841747777986442, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.605205891639377, 8.509960173033729, 8.227614149795231, 8.2330230034647, 7.642573486865863, 9.064361374259404, -0.2698995881035525, 5.820494107086748, 7.603929491573448, 6.890453001778674, 5.305342211261286, 7.823417111437361, 8.153436653236815, 9.663688654648219, 5.850143787839944, 11.974867393855767, 8.532035755014542, 8.441545241944377, 8.766928521973826, 1.3562772738988915, 9.866435697003729, 3.646566586155399, 5.7691259304929545, 9.229768918753754, 10.328479311065367, 8.884312823734229, 2.424207106157183, 8.612603363969054, 4.776083638349014, 7.718712317974502, 6.699692230959303, 4.410018989040804, 7.6546040200733785, 4.62430911502989, 10.144003822311415, 5.032747657517903, 5.35001893975055, 3.0967577950582004, 10.225531511302282, 3.4428094891057572, 7.720565685865192, 7.4800535349256405, 8.782983475521204, 6.640865030230443, 6.2684494208054105, 7.315247581963048, 3.949770259146089, 5.640156628347769, 7.748498787201204, 8.284844962564668, 3.932067363823045, 8.735652665914934, 4.807694721107165, 8.556886786939774, 8.133455964119115, 8.85511302534005, 10.67610252710522, 8.04834780215516, 7.005766721038474, 7.159392287295887, 5.337178205111519, 1.5685444006116667, 8.97399738487972, 7.70035668129955, 6.6398267394676855, 8.98074168445917, 6.600881021873087, 7.720543088283, 7.975140434682152, 6.288202367236536, 6.554707333021036, 3.952265946892137, 4.148040490737504, 9.216382775770105, 2.3385149882501053, 3.1479618791190234, 6.094387992540233, 6.919814696770869, 5.180617255469582, 6.85294513300095, 8.256007835286795, 9.144704873385853, 6.375350176323801, 6.578955068839807, 7.8131910845081265, 5.7948535582270955, 9.001858186890622, 10.960533711441922, 1.8907969705121905, 9.207405187295443, 8.72774581405163, 3.3328700575930923, 4.262443111745383, 6.824590095437072, 6.9451261958531765, 4.012117982798688, 7.689519679011713, 7.995811850926823, 5.5703076707573, 7.725435996563334], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7919993364723577, "mean_inference_ms": 8.127096977168629, "mean_action_processing_ms": 0.5458779917641327, "mean_env_wait_ms": 24.11297315849622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07330870628356934, "StateBufferConnector_ms": 0.03367447853088379, "ViewRequirementAgentConnector_ms": 0.9815409183502197}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7727258, "num_agent_steps_trained": 7727258, "num_env_steps_sampled": 7727258, "num_env_steps_trained": 7727258, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 279.7963641071844, "num_env_steps_trained_throughput_per_sec": 279.7963641071844, "timesteps_total": 7727258, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7727258, "timers": {"training_iteration_time_ms": 55992.692, "sample_time_ms": 42798.139, "load_time_ms": 1781.037, "load_throughput": 8780.28, "learn_time_ms": 10870.02, "learn_throughput": 1438.636, "synch_weights_time_ms": 425.012}, "counters": {"num_env_steps_sampled": 7727258, "num_env_steps_trained": 7727258, "num_agent_steps_sampled": 7727258, "num_agent_steps_trained": 7727258}, "done": false, "episodes_total": 2114, "training_iteration": 499, "trial_id": "2f030_00000", "date": "2025-06-07_09-58-41", "timestamp": 1749283121, "time_this_iter_s": 55.91191530227661, "time_total_s": 8529.384757041931, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8529.384757041931, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 77.87936507936506, "ram_util_percent": 70.93650793650797, "gpu_util_percent0": 0.08317460317460316, "vram_util_percent0": 0.8592122395833336}}
{"evaluation": {"sampler_results": {"episode_reward_max": -4.298781347638417, "episode_reward_min": -6.9132546961393455, "episode_reward_mean": -5.624584543986186, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.298781347638417, -4.713946564535479, -6.9132546961393455, -6.121764485326935, -6.0751756262907595], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.427832476414624, "mean_inference_ms": 3.8611486743434384, "mean_action_processing_ms": 0.2768724948262951, "mean_env_wait_ms": 10.47184599959391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0402069091796875, "ViewRequirementAgentConnector_ms": 0.2399444580078125}}, "episode_reward_max": -4.298781347638417, "episode_reward_min": -6.9132546961393455, "episode_reward_mean": -5.624584543986186, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.298781347638417, -4.713946564535479, -6.9132546961393455, -6.121764485326935, -6.0751756262907595], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.427832476414624, "mean_inference_ms": 3.8611486743434384, "mean_action_processing_ms": 0.2768724948262951, "mean_env_wait_ms": 10.47184599959391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0402069091796875, "ViewRequirementAgentConnector_ms": 0.2399444580078125}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.7942700000000005e-05, "total_loss": -0.060961098374206234, "policy_loss": -0.033065275013108145, "vf_loss": 0.014752757389267738, "vf_explained_var": 0.7364836609363556, "kl": 0.011854868853276796, "entropy": 20.38064821243286, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 83325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7742896, "num_env_steps_trained": 7742896, "num_agent_steps_sampled": 7742896, "num_agent_steps_trained": 7742896}, "sampler_results": {"episode_reward_max": 11.974867393855767, "episode_reward_min": 1.3562772738988915, "episode_reward_mean": 6.746109662185013, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.850143787839944, 11.974867393855767, 8.532035755014542, 8.441545241944377, 8.766928521973826, 1.3562772738988915, 9.866435697003729, 3.646566586155399, 5.7691259304929545, 9.229768918753754, 10.328479311065367, 8.884312823734229, 2.424207106157183, 8.612603363969054, 4.776083638349014, 7.718712317974502, 6.699692230959303, 4.410018989040804, 7.6546040200733785, 4.62430911502989, 10.144003822311415, 5.032747657517903, 5.35001893975055, 3.0967577950582004, 10.225531511302282, 3.4428094891057572, 7.720565685865192, 7.4800535349256405, 8.782983475521204, 6.640865030230443, 6.2684494208054105, 7.315247581963048, 3.949770259146089, 5.640156628347769, 7.748498787201204, 8.284844962564668, 3.932067363823045, 8.735652665914934, 4.807694721107165, 8.556886786939774, 8.133455964119115, 8.85511302534005, 10.67610252710522, 8.04834780215516, 7.005766721038474, 7.159392287295887, 5.337178205111519, 1.5685444006116667, 8.97399738487972, 7.70035668129955, 6.6398267394676855, 8.98074168445917, 6.600881021873087, 7.720543088283, 7.975140434682152, 6.288202367236536, 6.554707333021036, 3.952265946892137, 4.148040490737504, 9.216382775770105, 2.3385149882501053, 3.1479618791190234, 6.094387992540233, 6.919814696770869, 5.180617255469582, 6.85294513300095, 8.256007835286795, 9.144704873385853, 6.375350176323801, 6.578955068839807, 7.8131910845081265, 5.7948535582270955, 9.001858186890622, 10.960533711441922, 1.8907969705121905, 9.207405187295443, 8.72774581405163, 3.3328700575930923, 4.262443111745383, 6.824590095437072, 6.9451261958531765, 4.012117982798688, 7.689519679011713, 7.995811850926823, 5.5703076707573, 7.725435996563334, 9.06968431216376, 5.202409905713495, 5.169688288778219, 6.607561861292278, 1.763379077503442, 6.3747620671776115, 7.599128151667885, 5.941676074400027, 7.088929149247566, 7.67283305786144, 6.502271846033866, 9.20099446711709, 10.682971143849732, 2.833498739027727], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7909722613186556, "mean_inference_ms": 8.128290700263625, "mean_action_processing_ms": 0.5459846330283769, "mean_env_wait_ms": 24.116843258287272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07023906707763672, "StateBufferConnector_ms": 0.029590368270874023, "ViewRequirementAgentConnector_ms": 0.9759807586669922}}, "episode_reward_max": 11.974867393855767, "episode_reward_min": 1.3562772738988915, "episode_reward_mean": 6.746109662185013, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.850143787839944, 11.974867393855767, 8.532035755014542, 8.441545241944377, 8.766928521973826, 1.3562772738988915, 9.866435697003729, 3.646566586155399, 5.7691259304929545, 9.229768918753754, 10.328479311065367, 8.884312823734229, 2.424207106157183, 8.612603363969054, 4.776083638349014, 7.718712317974502, 6.699692230959303, 4.410018989040804, 7.6546040200733785, 4.62430911502989, 10.144003822311415, 5.032747657517903, 5.35001893975055, 3.0967577950582004, 10.225531511302282, 3.4428094891057572, 7.720565685865192, 7.4800535349256405, 8.782983475521204, 6.640865030230443, 6.2684494208054105, 7.315247581963048, 3.949770259146089, 5.640156628347769, 7.748498787201204, 8.284844962564668, 3.932067363823045, 8.735652665914934, 4.807694721107165, 8.556886786939774, 8.133455964119115, 8.85511302534005, 10.67610252710522, 8.04834780215516, 7.005766721038474, 7.159392287295887, 5.337178205111519, 1.5685444006116667, 8.97399738487972, 7.70035668129955, 6.6398267394676855, 8.98074168445917, 6.600881021873087, 7.720543088283, 7.975140434682152, 6.288202367236536, 6.554707333021036, 3.952265946892137, 4.148040490737504, 9.216382775770105, 2.3385149882501053, 3.1479618791190234, 6.094387992540233, 6.919814696770869, 5.180617255469582, 6.85294513300095, 8.256007835286795, 9.144704873385853, 6.375350176323801, 6.578955068839807, 7.8131910845081265, 5.7948535582270955, 9.001858186890622, 10.960533711441922, 1.8907969705121905, 9.207405187295443, 8.72774581405163, 3.3328700575930923, 4.262443111745383, 6.824590095437072, 6.9451261958531765, 4.012117982798688, 7.689519679011713, 7.995811850926823, 5.5703076707573, 7.725435996563334, 9.06968431216376, 5.202409905713495, 5.169688288778219, 6.607561861292278, 1.763379077503442, 6.3747620671776115, 7.599128151667885, 5.941676074400027, 7.088929149247566, 7.67283305786144, 6.502271846033866, 9.20099446711709, 10.682971143849732, 2.833498739027727], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7909722613186556, "mean_inference_ms": 8.128290700263625, "mean_action_processing_ms": 0.5459846330283769, "mean_env_wait_ms": 24.116843258287272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07023906707763672, "StateBufferConnector_ms": 0.029590368270874023, "ViewRequirementAgentConnector_ms": 0.9759807586669922}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7742896, "num_agent_steps_trained": 7742896, "num_env_steps_sampled": 7742896, "num_env_steps_trained": 7742896, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.6842916263477, "num_env_steps_trained_throughput_per_sec": 278.6842916263477, "timesteps_total": 7742896, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7742896, "timers": {"training_iteration_time_ms": 55993.584, "sample_time_ms": 42828.185, "load_time_ms": 1773.151, "load_throughput": 8819.328, "learn_time_ms": 10852.985, "learn_throughput": 1440.894, "synch_weights_time_ms": 420.249}, "counters": {"num_env_steps_sampled": 7742896, "num_env_steps_trained": 7742896, "num_agent_steps_sampled": 7742896, "num_agent_steps_trained": 7742896}, "done": false, "episodes_total": 2128, "training_iteration": 500, "trial_id": "2f030_00000", "date": "2025-06-07_09-59-52", "timestamp": 1749283192, "time_this_iter_s": 71.07614350318909, "time_total_s": 8600.46090054512, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8600.46090054512, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 65.80609756097562, "ram_util_percent": 70.09878048780489, "gpu_util_percent0": 0.06439024390243901, "vram_util_percent0": 0.8592122395833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.7819242105263156e-05, "total_loss": -0.0472145637662404, "policy_loss": -0.019838503269499846, "vf_loss": 0.01582836037417027, "vf_explained_var": 0.7099512024359269, "kl": 0.012057564765537708, "entropy": 20.354258691614323, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 83875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7758534, "num_env_steps_trained": 7758534, "num_agent_steps_sampled": 7758534, "num_agent_steps_trained": 7758534}, "sampler_results": {"episode_reward_max": 11.56392495385698, "episode_reward_min": 1.5685444006116667, "episode_reward_mean": 6.702096568781452, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.776083638349014, 7.718712317974502, 6.699692230959303, 4.410018989040804, 7.6546040200733785, 4.62430911502989, 10.144003822311415, 5.032747657517903, 5.35001893975055, 3.0967577950582004, 10.225531511302282, 3.4428094891057572, 7.720565685865192, 7.4800535349256405, 8.782983475521204, 6.640865030230443, 6.2684494208054105, 7.315247581963048, 3.949770259146089, 5.640156628347769, 7.748498787201204, 8.284844962564668, 3.932067363823045, 8.735652665914934, 4.807694721107165, 8.556886786939774, 8.133455964119115, 8.85511302534005, 10.67610252710522, 8.04834780215516, 7.005766721038474, 7.159392287295887, 5.337178205111519, 1.5685444006116667, 8.97399738487972, 7.70035668129955, 6.6398267394676855, 8.98074168445917, 6.600881021873087, 7.720543088283, 7.975140434682152, 6.288202367236536, 6.554707333021036, 3.952265946892137, 4.148040490737504, 9.216382775770105, 2.3385149882501053, 3.1479618791190234, 6.094387992540233, 6.919814696770869, 5.180617255469582, 6.85294513300095, 8.256007835286795, 9.144704873385853, 6.375350176323801, 6.578955068839807, 7.8131910845081265, 5.7948535582270955, 9.001858186890622, 10.960533711441922, 1.8907969705121905, 9.207405187295443, 8.72774581405163, 3.3328700575930923, 4.262443111745383, 6.824590095437072, 6.9451261958531765, 4.012117982798688, 7.689519679011713, 7.995811850926823, 5.5703076707573, 7.725435996563334, 9.06968431216376, 5.202409905713495, 5.169688288778219, 6.607561861292278, 1.763379077503442, 6.3747620671776115, 7.599128151667885, 5.941676074400027, 7.088929149247566, 7.67283305786144, 6.502271846033866, 9.20099446711709, 10.682971143849732, 2.833498739027727, 6.557140827691993, 10.415167965911355, 6.408359741764364, 2.183936382849949, 8.310456364860045, 11.56392495385698, 9.123467276438083, 6.3372835300128765, 3.9983488270930208, 8.319930347624654, 7.724505534779789, 7.866979004565935, 4.6188758004493655, 5.853611813604637], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7900488738668177, "mean_inference_ms": 8.12933247309224, "mean_action_processing_ms": 0.5460741600034372, "mean_env_wait_ms": 24.12012458925111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06218361854553223, "StateBufferConnector_ms": 0.03870654106140137, "ViewRequirementAgentConnector_ms": 0.96124267578125}}, "episode_reward_max": 11.56392495385698, "episode_reward_min": 1.5685444006116667, "episode_reward_mean": 6.702096568781452, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.776083638349014, 7.718712317974502, 6.699692230959303, 4.410018989040804, 7.6546040200733785, 4.62430911502989, 10.144003822311415, 5.032747657517903, 5.35001893975055, 3.0967577950582004, 10.225531511302282, 3.4428094891057572, 7.720565685865192, 7.4800535349256405, 8.782983475521204, 6.640865030230443, 6.2684494208054105, 7.315247581963048, 3.949770259146089, 5.640156628347769, 7.748498787201204, 8.284844962564668, 3.932067363823045, 8.735652665914934, 4.807694721107165, 8.556886786939774, 8.133455964119115, 8.85511302534005, 10.67610252710522, 8.04834780215516, 7.005766721038474, 7.159392287295887, 5.337178205111519, 1.5685444006116667, 8.97399738487972, 7.70035668129955, 6.6398267394676855, 8.98074168445917, 6.600881021873087, 7.720543088283, 7.975140434682152, 6.288202367236536, 6.554707333021036, 3.952265946892137, 4.148040490737504, 9.216382775770105, 2.3385149882501053, 3.1479618791190234, 6.094387992540233, 6.919814696770869, 5.180617255469582, 6.85294513300095, 8.256007835286795, 9.144704873385853, 6.375350176323801, 6.578955068839807, 7.8131910845081265, 5.7948535582270955, 9.001858186890622, 10.960533711441922, 1.8907969705121905, 9.207405187295443, 8.72774581405163, 3.3328700575930923, 4.262443111745383, 6.824590095437072, 6.9451261958531765, 4.012117982798688, 7.689519679011713, 7.995811850926823, 5.5703076707573, 7.725435996563334, 9.06968431216376, 5.202409905713495, 5.169688288778219, 6.607561861292278, 1.763379077503442, 6.3747620671776115, 7.599128151667885, 5.941676074400027, 7.088929149247566, 7.67283305786144, 6.502271846033866, 9.20099446711709, 10.682971143849732, 2.833498739027727, 6.557140827691993, 10.415167965911355, 6.408359741764364, 2.183936382849949, 8.310456364860045, 11.56392495385698, 9.123467276438083, 6.3372835300128765, 3.9983488270930208, 8.319930347624654, 7.724505534779789, 7.866979004565935, 4.6188758004493655, 5.853611813604637], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7900488738668177, "mean_inference_ms": 8.12933247309224, "mean_action_processing_ms": 0.5460741600034372, "mean_env_wait_ms": 24.12012458925111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06218361854553223, "StateBufferConnector_ms": 0.03870654106140137, "ViewRequirementAgentConnector_ms": 0.96124267578125}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7758534, "num_agent_steps_trained": 7758534, "num_env_steps_sampled": 7758534, "num_env_steps_trained": 7758534, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.30276635511876, "num_env_steps_trained_throughput_per_sec": 282.30276635511876, "timesteps_total": 7758534, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7758534, "timers": {"training_iteration_time_ms": 55905.14, "sample_time_ms": 42768.324, "load_time_ms": 1748.749, "load_throughput": 8942.393, "learn_time_ms": 10849.459, "learn_throughput": 1441.362, "synch_weights_time_ms": 420.191}, "counters": {"num_env_steps_sampled": 7758534, "num_env_steps_trained": 7758534, "num_agent_steps_sampled": 7758534, "num_agent_steps_trained": 7758534}, "done": false, "episodes_total": 2142, "training_iteration": 501, "trial_id": "2f030_00000", "date": "2025-06-07_10-00-47", "timestamp": 1749283247, "time_this_iter_s": 55.41093564033508, "time_total_s": 8655.871836185455, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8655.871836185455, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 77.82222222222222, "ram_util_percent": 70.37142857142857, "gpu_util_percent0": 0.07650793650793651, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.7695784210526314e-05, "total_loss": -0.05189305341082879, "policy_loss": -0.023815478627485308, "vf_loss": 0.013536517560820688, "vf_explained_var": 0.7368528825586492, "kl": 0.011873291765077187, "entropy": 20.295645710338245, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 84425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7774172, "num_env_steps_trained": 7774172, "num_agent_steps_sampled": 7774172, "num_agent_steps_trained": 7774172}, "sampler_results": {"episode_reward_max": 11.56392495385698, "episode_reward_min": 1.5685444006116667, "episode_reward_mean": 6.798344088175931, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.782983475521204, 6.640865030230443, 6.2684494208054105, 7.315247581963048, 3.949770259146089, 5.640156628347769, 7.748498787201204, 8.284844962564668, 3.932067363823045, 8.735652665914934, 4.807694721107165, 8.556886786939774, 8.133455964119115, 8.85511302534005, 10.67610252710522, 8.04834780215516, 7.005766721038474, 7.159392287295887, 5.337178205111519, 1.5685444006116667, 8.97399738487972, 7.70035668129955, 6.6398267394676855, 8.98074168445917, 6.600881021873087, 7.720543088283, 7.975140434682152, 6.288202367236536, 6.554707333021036, 3.952265946892137, 4.148040490737504, 9.216382775770105, 2.3385149882501053, 3.1479618791190234, 6.094387992540233, 6.919814696770869, 5.180617255469582, 6.85294513300095, 8.256007835286795, 9.144704873385853, 6.375350176323801, 6.578955068839807, 7.8131910845081265, 5.7948535582270955, 9.001858186890622, 10.960533711441922, 1.8907969705121905, 9.207405187295443, 8.72774581405163, 3.3328700575930923, 4.262443111745383, 6.824590095437072, 6.9451261958531765, 4.012117982798688, 7.689519679011713, 7.995811850926823, 5.5703076707573, 7.725435996563334, 9.06968431216376, 5.202409905713495, 5.169688288778219, 6.607561861292278, 1.763379077503442, 6.3747620671776115, 7.599128151667885, 5.941676074400027, 7.088929149247566, 7.67283305786144, 6.502271846033866, 9.20099446711709, 10.682971143849732, 2.833498739027727, 6.557140827691993, 10.415167965911355, 6.408359741764364, 2.183936382849949, 8.310456364860045, 11.56392495385698, 9.123467276438083, 6.3372835300128765, 3.9983488270930208, 8.319930347624654, 7.724505534779789, 7.866979004565935, 4.6188758004493655, 5.853611813604637, 7.056695848383289, 10.424411207013113, 8.613792625511726, 7.804397351005958, 5.462380312076238, 5.275343207939424, 7.957510377313557, 3.191389624255224, 6.949052365199196, 7.299750976696767, 9.428185580341992, 7.7146344199999515, 5.122057767815364, 5.701059023159878], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7888460522357366, "mean_inference_ms": 8.130646662052337, "mean_action_processing_ms": 0.5461628847130018, "mean_env_wait_ms": 24.12387331916604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06828641891479492, "StateBufferConnector_ms": 0.04026484489440918, "ViewRequirementAgentConnector_ms": 0.9485816955566406}}, "episode_reward_max": 11.56392495385698, "episode_reward_min": 1.5685444006116667, "episode_reward_mean": 6.798344088175931, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.782983475521204, 6.640865030230443, 6.2684494208054105, 7.315247581963048, 3.949770259146089, 5.640156628347769, 7.748498787201204, 8.284844962564668, 3.932067363823045, 8.735652665914934, 4.807694721107165, 8.556886786939774, 8.133455964119115, 8.85511302534005, 10.67610252710522, 8.04834780215516, 7.005766721038474, 7.159392287295887, 5.337178205111519, 1.5685444006116667, 8.97399738487972, 7.70035668129955, 6.6398267394676855, 8.98074168445917, 6.600881021873087, 7.720543088283, 7.975140434682152, 6.288202367236536, 6.554707333021036, 3.952265946892137, 4.148040490737504, 9.216382775770105, 2.3385149882501053, 3.1479618791190234, 6.094387992540233, 6.919814696770869, 5.180617255469582, 6.85294513300095, 8.256007835286795, 9.144704873385853, 6.375350176323801, 6.578955068839807, 7.8131910845081265, 5.7948535582270955, 9.001858186890622, 10.960533711441922, 1.8907969705121905, 9.207405187295443, 8.72774581405163, 3.3328700575930923, 4.262443111745383, 6.824590095437072, 6.9451261958531765, 4.012117982798688, 7.689519679011713, 7.995811850926823, 5.5703076707573, 7.725435996563334, 9.06968431216376, 5.202409905713495, 5.169688288778219, 6.607561861292278, 1.763379077503442, 6.3747620671776115, 7.599128151667885, 5.941676074400027, 7.088929149247566, 7.67283305786144, 6.502271846033866, 9.20099446711709, 10.682971143849732, 2.833498739027727, 6.557140827691993, 10.415167965911355, 6.408359741764364, 2.183936382849949, 8.310456364860045, 11.56392495385698, 9.123467276438083, 6.3372835300128765, 3.9983488270930208, 8.319930347624654, 7.724505534779789, 7.866979004565935, 4.6188758004493655, 5.853611813604637, 7.056695848383289, 10.424411207013113, 8.613792625511726, 7.804397351005958, 5.462380312076238, 5.275343207939424, 7.957510377313557, 3.191389624255224, 6.949052365199196, 7.299750976696767, 9.428185580341992, 7.7146344199999515, 5.122057767815364, 5.701059023159878], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7888460522357366, "mean_inference_ms": 8.130646662052337, "mean_action_processing_ms": 0.5461628847130018, "mean_env_wait_ms": 24.12387331916604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06828641891479492, "StateBufferConnector_ms": 0.04026484489440918, "ViewRequirementAgentConnector_ms": 0.9485816955566406}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7774172, "num_agent_steps_trained": 7774172, "num_env_steps_sampled": 7774172, "num_env_steps_trained": 7774172, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 277.64293339382084, "num_env_steps_trained_throughput_per_sec": 277.64293339382084, "timesteps_total": 7774172, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7774172, "timers": {"training_iteration_time_ms": 55882.831, "sample_time_ms": 42776.158, "load_time_ms": 1734.692, "load_throughput": 9014.857, "learn_time_ms": 10833.099, "learn_throughput": 1443.539, "synch_weights_time_ms": 423.022}, "counters": {"num_env_steps_sampled": 7774172, "num_env_steps_trained": 7774172, "num_agent_steps_sampled": 7774172, "num_agent_steps_trained": 7774172}, "done": false, "episodes_total": 2156, "training_iteration": 502, "trial_id": "2f030_00000", "date": "2025-06-07_10-01-44", "timestamp": 1749283304, "time_this_iter_s": 56.34212875366211, "time_total_s": 8712.213964939117, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8712.213964939117, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 77.78153846153846, "ram_util_percent": 70.83846153846154, "gpu_util_percent0": 0.08015384615384617, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.757232631578948e-05, "total_loss": -0.061253724149851634, "policy_loss": -0.03400822346627882, "vf_loss": 0.015710936097258873, "vf_explained_var": 0.7382859248464758, "kl": 0.012142828327185379, "entropy": 20.301715422543612, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 84975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7789810, "num_env_steps_trained": 7789810, "num_agent_steps_sampled": 7789810, "num_agent_steps_trained": 7789810}, "sampler_results": {"episode_reward_max": 11.56392495385698, "episode_reward_min": 1.5685444006116667, "episode_reward_mean": 6.753079763704749, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.67610252710522, 8.04834780215516, 7.005766721038474, 7.159392287295887, 5.337178205111519, 1.5685444006116667, 8.97399738487972, 7.70035668129955, 6.6398267394676855, 8.98074168445917, 6.600881021873087, 7.720543088283, 7.975140434682152, 6.288202367236536, 6.554707333021036, 3.952265946892137, 4.148040490737504, 9.216382775770105, 2.3385149882501053, 3.1479618791190234, 6.094387992540233, 6.919814696770869, 5.180617255469582, 6.85294513300095, 8.256007835286795, 9.144704873385853, 6.375350176323801, 6.578955068839807, 7.8131910845081265, 5.7948535582270955, 9.001858186890622, 10.960533711441922, 1.8907969705121905, 9.207405187295443, 8.72774581405163, 3.3328700575930923, 4.262443111745383, 6.824590095437072, 6.9451261958531765, 4.012117982798688, 7.689519679011713, 7.995811850926823, 5.5703076707573, 7.725435996563334, 9.06968431216376, 5.202409905713495, 5.169688288778219, 6.607561861292278, 1.763379077503442, 6.3747620671776115, 7.599128151667885, 5.941676074400027, 7.088929149247566, 7.67283305786144, 6.502271846033866, 9.20099446711709, 10.682971143849732, 2.833498739027727, 6.557140827691993, 10.415167965911355, 6.408359741764364, 2.183936382849949, 8.310456364860045, 11.56392495385698, 9.123467276438083, 6.3372835300128765, 3.9983488270930208, 8.319930347624654, 7.724505534779789, 7.866979004565935, 4.6188758004493655, 5.853611813604637, 7.056695848383289, 10.424411207013113, 8.613792625511726, 7.804397351005958, 5.462380312076238, 5.275343207939424, 7.957510377313557, 3.191389624255224, 6.949052365199196, 7.299750976696767, 9.428185580341992, 7.7146344199999515, 5.122057767815364, 5.701059023159878, 4.069818990020964, 6.879086167503752, 5.5882185958599235, 7.3441982945946265, 8.09323872758118, 8.989218451314185, 4.697987072484711, 5.201735227883111, 9.721107853744428, 10.513117619235578, 5.944561926714337, 8.35547061087466, 4.555263085014666, 3.1722316030797035], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7875258954534776, "mean_inference_ms": 8.132104127389542, "mean_action_processing_ms": 0.5462354333906024, "mean_env_wait_ms": 24.12799379771418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04469728469848633, "StateBufferConnector_ms": 0.03926229476928711, "ViewRequirementAgentConnector_ms": 0.9512207508087158}}, "episode_reward_max": 11.56392495385698, "episode_reward_min": 1.5685444006116667, "episode_reward_mean": 6.753079763704749, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.67610252710522, 8.04834780215516, 7.005766721038474, 7.159392287295887, 5.337178205111519, 1.5685444006116667, 8.97399738487972, 7.70035668129955, 6.6398267394676855, 8.98074168445917, 6.600881021873087, 7.720543088283, 7.975140434682152, 6.288202367236536, 6.554707333021036, 3.952265946892137, 4.148040490737504, 9.216382775770105, 2.3385149882501053, 3.1479618791190234, 6.094387992540233, 6.919814696770869, 5.180617255469582, 6.85294513300095, 8.256007835286795, 9.144704873385853, 6.375350176323801, 6.578955068839807, 7.8131910845081265, 5.7948535582270955, 9.001858186890622, 10.960533711441922, 1.8907969705121905, 9.207405187295443, 8.72774581405163, 3.3328700575930923, 4.262443111745383, 6.824590095437072, 6.9451261958531765, 4.012117982798688, 7.689519679011713, 7.995811850926823, 5.5703076707573, 7.725435996563334, 9.06968431216376, 5.202409905713495, 5.169688288778219, 6.607561861292278, 1.763379077503442, 6.3747620671776115, 7.599128151667885, 5.941676074400027, 7.088929149247566, 7.67283305786144, 6.502271846033866, 9.20099446711709, 10.682971143849732, 2.833498739027727, 6.557140827691993, 10.415167965911355, 6.408359741764364, 2.183936382849949, 8.310456364860045, 11.56392495385698, 9.123467276438083, 6.3372835300128765, 3.9983488270930208, 8.319930347624654, 7.724505534779789, 7.866979004565935, 4.6188758004493655, 5.853611813604637, 7.056695848383289, 10.424411207013113, 8.613792625511726, 7.804397351005958, 5.462380312076238, 5.275343207939424, 7.957510377313557, 3.191389624255224, 6.949052365199196, 7.299750976696767, 9.428185580341992, 7.7146344199999515, 5.122057767815364, 5.701059023159878, 4.069818990020964, 6.879086167503752, 5.5882185958599235, 7.3441982945946265, 8.09323872758118, 8.989218451314185, 4.697987072484711, 5.201735227883111, 9.721107853744428, 10.513117619235578, 5.944561926714337, 8.35547061087466, 4.555263085014666, 3.1722316030797035], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7875258954534776, "mean_inference_ms": 8.132104127389542, "mean_action_processing_ms": 0.5462354333906024, "mean_env_wait_ms": 24.12799379771418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04469728469848633, "StateBufferConnector_ms": 0.03926229476928711, "ViewRequirementAgentConnector_ms": 0.9512207508087158}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7789810, "num_agent_steps_trained": 7789810, "num_env_steps_sampled": 7789810, "num_env_steps_trained": 7789810, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 277.56796649121765, "num_env_steps_trained_throughput_per_sec": 277.56796649121765, "timesteps_total": 7789810, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7789810, "timers": {"training_iteration_time_ms": 55852.018, "sample_time_ms": 42719.958, "load_time_ms": 1738.67, "load_throughput": 8994.232, "learn_time_ms": 10844.686, "learn_throughput": 1441.997, "synch_weights_time_ms": 432.708}, "counters": {"num_env_steps_sampled": 7789810, "num_env_steps_trained": 7789810, "num_agent_steps_sampled": 7789810, "num_agent_steps_trained": 7789810}, "done": false, "episodes_total": 2170, "training_iteration": 503, "trial_id": "2f030_00000", "date": "2025-06-07_10-02-40", "timestamp": 1749283360, "time_this_iter_s": 56.35535502433777, "time_total_s": 8768.569319963455, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8768.569319963455, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 78.5171875, "ram_util_percent": 71.03125, "gpu_util_percent0": 0.07718749999999999, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.744886842105264e-05, "total_loss": -0.055013355821455744, "policy_loss": -0.02745972201545638, "vf_loss": 0.015183986211195589, "vf_explained_var": 0.7212269439480522, "kl": 0.011944985488056588, "entropy": 20.306314775293522, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 85525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7805448, "num_env_steps_trained": 7805448, "num_agent_steps_sampled": 7805448, "num_agent_steps_trained": 7805448}, "sampler_results": {"episode_reward_max": 11.56392495385698, "episode_reward_min": 1.763379077503442, "episode_reward_mean": 6.694506132291777, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.554707333021036, 3.952265946892137, 4.148040490737504, 9.216382775770105, 2.3385149882501053, 3.1479618791190234, 6.094387992540233, 6.919814696770869, 5.180617255469582, 6.85294513300095, 8.256007835286795, 9.144704873385853, 6.375350176323801, 6.578955068839807, 7.8131910845081265, 5.7948535582270955, 9.001858186890622, 10.960533711441922, 1.8907969705121905, 9.207405187295443, 8.72774581405163, 3.3328700575930923, 4.262443111745383, 6.824590095437072, 6.9451261958531765, 4.012117982798688, 7.689519679011713, 7.995811850926823, 5.5703076707573, 7.725435996563334, 9.06968431216376, 5.202409905713495, 5.169688288778219, 6.607561861292278, 1.763379077503442, 6.3747620671776115, 7.599128151667885, 5.941676074400027, 7.088929149247566, 7.67283305786144, 6.502271846033866, 9.20099446711709, 10.682971143849732, 2.833498739027727, 6.557140827691993, 10.415167965911355, 6.408359741764364, 2.183936382849949, 8.310456364860045, 11.56392495385698, 9.123467276438083, 6.3372835300128765, 3.9983488270930208, 8.319930347624654, 7.724505534779789, 7.866979004565935, 4.6188758004493655, 5.853611813604637, 7.056695848383289, 10.424411207013113, 8.613792625511726, 7.804397351005958, 5.462380312076238, 5.275343207939424, 7.957510377313557, 3.191389624255224, 6.949052365199196, 7.299750976696767, 9.428185580341992, 7.7146344199999515, 5.122057767815364, 5.701059023159878, 4.069818990020964, 6.879086167503752, 5.5882185958599235, 7.3441982945946265, 8.09323872758118, 8.989218451314185, 4.697987072484711, 5.201735227883111, 9.721107853744428, 10.513117619235578, 5.944561926714337, 8.35547061087466, 4.555263085014666, 3.1722316030797035, 8.99181324869774, 6.58236085698132, 7.03745198446182, 2.3884438593062307, 5.55586330033132, 4.404555830698465, 7.282965050570074, 4.673762357428669, 8.829798166422332, 10.311336832935359, 7.218427646553472, 7.217535859740451, 7.9256455506547505, 6.397697659419639], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7864549552266658, "mean_inference_ms": 8.133635112207068, "mean_action_processing_ms": 0.546313130543626, "mean_env_wait_ms": 24.131971860833676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05267810821533203, "StateBufferConnector_ms": 0.036843061447143555, "ViewRequirementAgentConnector_ms": 0.9598703384399414}}, "episode_reward_max": 11.56392495385698, "episode_reward_min": 1.763379077503442, "episode_reward_mean": 6.694506132291777, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.554707333021036, 3.952265946892137, 4.148040490737504, 9.216382775770105, 2.3385149882501053, 3.1479618791190234, 6.094387992540233, 6.919814696770869, 5.180617255469582, 6.85294513300095, 8.256007835286795, 9.144704873385853, 6.375350176323801, 6.578955068839807, 7.8131910845081265, 5.7948535582270955, 9.001858186890622, 10.960533711441922, 1.8907969705121905, 9.207405187295443, 8.72774581405163, 3.3328700575930923, 4.262443111745383, 6.824590095437072, 6.9451261958531765, 4.012117982798688, 7.689519679011713, 7.995811850926823, 5.5703076707573, 7.725435996563334, 9.06968431216376, 5.202409905713495, 5.169688288778219, 6.607561861292278, 1.763379077503442, 6.3747620671776115, 7.599128151667885, 5.941676074400027, 7.088929149247566, 7.67283305786144, 6.502271846033866, 9.20099446711709, 10.682971143849732, 2.833498739027727, 6.557140827691993, 10.415167965911355, 6.408359741764364, 2.183936382849949, 8.310456364860045, 11.56392495385698, 9.123467276438083, 6.3372835300128765, 3.9983488270930208, 8.319930347624654, 7.724505534779789, 7.866979004565935, 4.6188758004493655, 5.853611813604637, 7.056695848383289, 10.424411207013113, 8.613792625511726, 7.804397351005958, 5.462380312076238, 5.275343207939424, 7.957510377313557, 3.191389624255224, 6.949052365199196, 7.299750976696767, 9.428185580341992, 7.7146344199999515, 5.122057767815364, 5.701059023159878, 4.069818990020964, 6.879086167503752, 5.5882185958599235, 7.3441982945946265, 8.09323872758118, 8.989218451314185, 4.697987072484711, 5.201735227883111, 9.721107853744428, 10.513117619235578, 5.944561926714337, 8.35547061087466, 4.555263085014666, 3.1722316030797035, 8.99181324869774, 6.58236085698132, 7.03745198446182, 2.3884438593062307, 5.55586330033132, 4.404555830698465, 7.282965050570074, 4.673762357428669, 8.829798166422332, 10.311336832935359, 7.218427646553472, 7.217535859740451, 7.9256455506547505, 6.397697659419639], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7864549552266658, "mean_inference_ms": 8.133635112207068, "mean_action_processing_ms": 0.546313130543626, "mean_env_wait_ms": 24.131971860833676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05267810821533203, "StateBufferConnector_ms": 0.036843061447143555, "ViewRequirementAgentConnector_ms": 0.9598703384399414}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7805448, "num_agent_steps_trained": 7805448, "num_env_steps_sampled": 7805448, "num_env_steps_trained": 7805448, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.53552060822733, "num_env_steps_trained_throughput_per_sec": 278.53552060822733, "timesteps_total": 7805448, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7805448, "timers": {"training_iteration_time_ms": 55842.583, "sample_time_ms": 42736.843, "load_time_ms": 1732.502, "load_throughput": 9026.251, "learn_time_ms": 10819.371, "learn_throughput": 1445.371, "synch_weights_time_ms": 435.345}, "counters": {"num_env_steps_sampled": 7805448, "num_env_steps_trained": 7805448, "num_agent_steps_sampled": 7805448, "num_agent_steps_trained": 7805448}, "done": false, "episodes_total": 2184, "training_iteration": 504, "trial_id": "2f030_00000", "date": "2025-06-07_10-03-36", "timestamp": 1749283416, "time_this_iter_s": 56.15763783454895, "time_total_s": 8824.726957798004, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8824.726957798004, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 78.85, "ram_util_percent": 70.8328125, "gpu_util_percent0": 0.07296875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.7325410526315795e-05, "total_loss": -0.04352174158546735, "policy_loss": -0.01588045844152062, "vf_loss": 0.016889535386792637, "vf_explained_var": 0.7074354910850524, "kl": 0.01130266558511548, "entropy": 20.377335003939542, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 86075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7821086, "num_env_steps_trained": 7821086, "num_agent_steps_sampled": 7821086, "num_agent_steps_trained": 7821086}, "sampler_results": {"episode_reward_max": 11.786816563183617, "episode_reward_min": -0.5408307063586375, "episode_reward_mean": 6.862188275437588, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.8131910845081265, 5.7948535582270955, 9.001858186890622, 10.960533711441922, 1.8907969705121905, 9.207405187295443, 8.72774581405163, 3.3328700575930923, 4.262443111745383, 6.824590095437072, 6.9451261958531765, 4.012117982798688, 7.689519679011713, 7.995811850926823, 5.5703076707573, 7.725435996563334, 9.06968431216376, 5.202409905713495, 5.169688288778219, 6.607561861292278, 1.763379077503442, 6.3747620671776115, 7.599128151667885, 5.941676074400027, 7.088929149247566, 7.67283305786144, 6.502271846033866, 9.20099446711709, 10.682971143849732, 2.833498739027727, 6.557140827691993, 10.415167965911355, 6.408359741764364, 2.183936382849949, 8.310456364860045, 11.56392495385698, 9.123467276438083, 6.3372835300128765, 3.9983488270930208, 8.319930347624654, 7.724505534779789, 7.866979004565935, 4.6188758004493655, 5.853611813604637, 7.056695848383289, 10.424411207013113, 8.613792625511726, 7.804397351005958, 5.462380312076238, 5.275343207939424, 7.957510377313557, 3.191389624255224, 6.949052365199196, 7.299750976696767, 9.428185580341992, 7.7146344199999515, 5.122057767815364, 5.701059023159878, 4.069818990020964, 6.879086167503752, 5.5882185958599235, 7.3441982945946265, 8.09323872758118, 8.989218451314185, 4.697987072484711, 5.201735227883111, 9.721107853744428, 10.513117619235578, 5.944561926714337, 8.35547061087466, 4.555263085014666, 3.1722316030797035, 8.99181324869774, 6.58236085698132, 7.03745198446182, 2.3884438593062307, 5.55586330033132, 4.404555830698465, 7.282965050570074, 4.673762357428669, 8.829798166422332, 10.311336832935359, 7.218427646553472, 7.217535859740451, 7.9256455506547505, 6.397697659419639, 6.09049893818288, 8.623873045155646, 10.933926916609945, 9.028891755369772, 6.360407309438819, 10.695701103299145, 11.786816563183617, 4.614122001847504, -0.5408307063586375, 3.138404397523805, 7.099581610974075, 6.154956934377457, 11.641827328988821, 5.900693561396087], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7852812442026105, "mean_inference_ms": 8.135222223662755, "mean_action_processing_ms": 0.5463909501014702, "mean_env_wait_ms": 24.13611668068701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05361604690551758, "StateBufferConnector_ms": 0.03679394721984863, "ViewRequirementAgentConnector_ms": 0.9820678234100342}}, "episode_reward_max": 11.786816563183617, "episode_reward_min": -0.5408307063586375, "episode_reward_mean": 6.862188275437588, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.8131910845081265, 5.7948535582270955, 9.001858186890622, 10.960533711441922, 1.8907969705121905, 9.207405187295443, 8.72774581405163, 3.3328700575930923, 4.262443111745383, 6.824590095437072, 6.9451261958531765, 4.012117982798688, 7.689519679011713, 7.995811850926823, 5.5703076707573, 7.725435996563334, 9.06968431216376, 5.202409905713495, 5.169688288778219, 6.607561861292278, 1.763379077503442, 6.3747620671776115, 7.599128151667885, 5.941676074400027, 7.088929149247566, 7.67283305786144, 6.502271846033866, 9.20099446711709, 10.682971143849732, 2.833498739027727, 6.557140827691993, 10.415167965911355, 6.408359741764364, 2.183936382849949, 8.310456364860045, 11.56392495385698, 9.123467276438083, 6.3372835300128765, 3.9983488270930208, 8.319930347624654, 7.724505534779789, 7.866979004565935, 4.6188758004493655, 5.853611813604637, 7.056695848383289, 10.424411207013113, 8.613792625511726, 7.804397351005958, 5.462380312076238, 5.275343207939424, 7.957510377313557, 3.191389624255224, 6.949052365199196, 7.299750976696767, 9.428185580341992, 7.7146344199999515, 5.122057767815364, 5.701059023159878, 4.069818990020964, 6.879086167503752, 5.5882185958599235, 7.3441982945946265, 8.09323872758118, 8.989218451314185, 4.697987072484711, 5.201735227883111, 9.721107853744428, 10.513117619235578, 5.944561926714337, 8.35547061087466, 4.555263085014666, 3.1722316030797035, 8.99181324869774, 6.58236085698132, 7.03745198446182, 2.3884438593062307, 5.55586330033132, 4.404555830698465, 7.282965050570074, 4.673762357428669, 8.829798166422332, 10.311336832935359, 7.218427646553472, 7.217535859740451, 7.9256455506547505, 6.397697659419639, 6.09049893818288, 8.623873045155646, 10.933926916609945, 9.028891755369772, 6.360407309438819, 10.695701103299145, 11.786816563183617, 4.614122001847504, -0.5408307063586375, 3.138404397523805, 7.099581610974075, 6.154956934377457, 11.641827328988821, 5.900693561396087], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7852812442026105, "mean_inference_ms": 8.135222223662755, "mean_action_processing_ms": 0.5463909501014702, "mean_env_wait_ms": 24.13611668068701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05361604690551758, "StateBufferConnector_ms": 0.03679394721984863, "ViewRequirementAgentConnector_ms": 0.9820678234100342}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7821086, "num_agent_steps_trained": 7821086, "num_env_steps_sampled": 7821086, "num_env_steps_trained": 7821086, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 279.92452482744824, "num_env_steps_trained_throughput_per_sec": 279.92452482744824, "timesteps_total": 7821086, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7821086, "timers": {"training_iteration_time_ms": 55900.241, "sample_time_ms": 42772.754, "load_time_ms": 1744.83, "load_throughput": 8962.477, "learn_time_ms": 10830.675, "learn_throughput": 1443.862, "synch_weights_time_ms": 433.111}, "counters": {"num_env_steps_sampled": 7821086, "num_env_steps_trained": 7821086, "num_agent_steps_sampled": 7821086, "num_agent_steps_trained": 7821086}, "done": false, "episodes_total": 2198, "training_iteration": 505, "trial_id": "2f030_00000", "date": "2025-06-07_10-04-32", "timestamp": 1749283472, "time_this_iter_s": 55.88104605674744, "time_total_s": 8880.608003854752, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8880.608003854752, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 78.23174603174604, "ram_util_percent": 70.88571428571427, "gpu_util_percent0": 0.07587301587301586, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.720195263157895e-05, "total_loss": -0.04927588459654626, "policy_loss": -0.021514776077679636, "vf_loss": 0.015367101229388605, "vf_explained_var": 0.7256890133294193, "kl": 0.011574882843403899, "entropy": 20.305780332738703, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 86625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7836724, "num_env_steps_trained": 7836724, "num_agent_steps_sampled": 7836724, "num_agent_steps_trained": 7836724}, "sampler_results": {"episode_reward_max": 11.786816563183617, "episode_reward_min": -0.5408307063586375, "episode_reward_mean": 6.943912166236244, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.5703076707573, 7.725435996563334, 9.06968431216376, 5.202409905713495, 5.169688288778219, 6.607561861292278, 1.763379077503442, 6.3747620671776115, 7.599128151667885, 5.941676074400027, 7.088929149247566, 7.67283305786144, 6.502271846033866, 9.20099446711709, 10.682971143849732, 2.833498739027727, 6.557140827691993, 10.415167965911355, 6.408359741764364, 2.183936382849949, 8.310456364860045, 11.56392495385698, 9.123467276438083, 6.3372835300128765, 3.9983488270930208, 8.319930347624654, 7.724505534779789, 7.866979004565935, 4.6188758004493655, 5.853611813604637, 7.056695848383289, 10.424411207013113, 8.613792625511726, 7.804397351005958, 5.462380312076238, 5.275343207939424, 7.957510377313557, 3.191389624255224, 6.949052365199196, 7.299750976696767, 9.428185580341992, 7.7146344199999515, 5.122057767815364, 5.701059023159878, 4.069818990020964, 6.879086167503752, 5.5882185958599235, 7.3441982945946265, 8.09323872758118, 8.989218451314185, 4.697987072484711, 5.201735227883111, 9.721107853744428, 10.513117619235578, 5.944561926714337, 8.35547061087466, 4.555263085014666, 3.1722316030797035, 8.99181324869774, 6.58236085698132, 7.03745198446182, 2.3884438593062307, 5.55586330033132, 4.404555830698465, 7.282965050570074, 4.673762357428669, 8.829798166422332, 10.311336832935359, 7.218427646553472, 7.217535859740451, 7.9256455506547505, 6.397697659419639, 6.09049893818288, 8.623873045155646, 10.933926916609945, 9.028891755369772, 6.360407309438819, 10.695701103299145, 11.786816563183617, 4.614122001847504, -0.5408307063586375, 3.138404397523805, 7.099581610974075, 6.154956934377457, 11.641827328988821, 5.900693561396087, 10.617000611183974, 8.881654601600594, 10.754335467443157, 4.165228482729503, 5.878121279145976, 8.077444067008637, 3.348099703945929, 8.323471399394087, 4.267654508857237, 6.530943157451397, 8.531979151942785, 10.030756180897846, 5.732453748263035, 7.492110206294343], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7842510143444623, "mean_inference_ms": 8.136768666581492, "mean_action_processing_ms": 0.5464756946541207, "mean_env_wait_ms": 24.140239393607647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0507197380065918, "StateBufferConnector_ms": 0.03479957580566406, "ViewRequirementAgentConnector_ms": 0.9886577129364014}}, "episode_reward_max": 11.786816563183617, "episode_reward_min": -0.5408307063586375, "episode_reward_mean": 6.943912166236244, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.5703076707573, 7.725435996563334, 9.06968431216376, 5.202409905713495, 5.169688288778219, 6.607561861292278, 1.763379077503442, 6.3747620671776115, 7.599128151667885, 5.941676074400027, 7.088929149247566, 7.67283305786144, 6.502271846033866, 9.20099446711709, 10.682971143849732, 2.833498739027727, 6.557140827691993, 10.415167965911355, 6.408359741764364, 2.183936382849949, 8.310456364860045, 11.56392495385698, 9.123467276438083, 6.3372835300128765, 3.9983488270930208, 8.319930347624654, 7.724505534779789, 7.866979004565935, 4.6188758004493655, 5.853611813604637, 7.056695848383289, 10.424411207013113, 8.613792625511726, 7.804397351005958, 5.462380312076238, 5.275343207939424, 7.957510377313557, 3.191389624255224, 6.949052365199196, 7.299750976696767, 9.428185580341992, 7.7146344199999515, 5.122057767815364, 5.701059023159878, 4.069818990020964, 6.879086167503752, 5.5882185958599235, 7.3441982945946265, 8.09323872758118, 8.989218451314185, 4.697987072484711, 5.201735227883111, 9.721107853744428, 10.513117619235578, 5.944561926714337, 8.35547061087466, 4.555263085014666, 3.1722316030797035, 8.99181324869774, 6.58236085698132, 7.03745198446182, 2.3884438593062307, 5.55586330033132, 4.404555830698465, 7.282965050570074, 4.673762357428669, 8.829798166422332, 10.311336832935359, 7.218427646553472, 7.217535859740451, 7.9256455506547505, 6.397697659419639, 6.09049893818288, 8.623873045155646, 10.933926916609945, 9.028891755369772, 6.360407309438819, 10.695701103299145, 11.786816563183617, 4.614122001847504, -0.5408307063586375, 3.138404397523805, 7.099581610974075, 6.154956934377457, 11.641827328988821, 5.900693561396087, 10.617000611183974, 8.881654601600594, 10.754335467443157, 4.165228482729503, 5.878121279145976, 8.077444067008637, 3.348099703945929, 8.323471399394087, 4.267654508857237, 6.530943157451397, 8.531979151942785, 10.030756180897846, 5.732453748263035, 7.492110206294343], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7842510143444623, "mean_inference_ms": 8.136768666581492, "mean_action_processing_ms": 0.5464756946541207, "mean_env_wait_ms": 24.140239393607647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0507197380065918, "StateBufferConnector_ms": 0.03479957580566406, "ViewRequirementAgentConnector_ms": 0.9886577129364014}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7836724, "num_agent_steps_trained": 7836724, "num_env_steps_sampled": 7836724, "num_env_steps_trained": 7836724, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 279.8104034243673, "num_env_steps_trained_throughput_per_sec": 279.8104034243673, "timesteps_total": 7836724, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7836724, "timers": {"training_iteration_time_ms": 55938.669, "sample_time_ms": 42804.672, "load_time_ms": 1745.2, "load_throughput": 8960.576, "learn_time_ms": 10829.09, "learn_throughput": 1444.073, "synch_weights_time_ms": 433.006}, "counters": {"num_env_steps_sampled": 7836724, "num_env_steps_trained": 7836724, "num_agent_steps_sampled": 7836724, "num_agent_steps_trained": 7836724}, "done": false, "episodes_total": 2212, "training_iteration": 506, "trial_id": "2f030_00000", "date": "2025-06-07_10-05-28", "timestamp": 1749283528, "time_this_iter_s": 55.89985108375549, "time_total_s": 8936.507854938507, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8936.507854938507, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 77.8015625, "ram_util_percent": 70.6859375, "gpu_util_percent0": 0.07781249999999999, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.707849473684211e-05, "total_loss": -0.05945700228679925, "policy_loss": -0.032106310753680936, "vf_loss": 0.016252444401722063, "vf_explained_var": 0.7124733049219305, "kl": 0.011784861795462481, "entropy": 20.308115829120982, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 87175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7852362, "num_env_steps_trained": 7852362, "num_agent_steps_sampled": 7852362, "num_agent_steps_trained": 7852362}, "sampler_results": {"episode_reward_max": 11.786816563183617, "episode_reward_min": -0.5408307063586375, "episode_reward_mean": 7.066803421066544, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.682971143849732, 2.833498739027727, 6.557140827691993, 10.415167965911355, 6.408359741764364, 2.183936382849949, 8.310456364860045, 11.56392495385698, 9.123467276438083, 6.3372835300128765, 3.9983488270930208, 8.319930347624654, 7.724505534779789, 7.866979004565935, 4.6188758004493655, 5.853611813604637, 7.056695848383289, 10.424411207013113, 8.613792625511726, 7.804397351005958, 5.462380312076238, 5.275343207939424, 7.957510377313557, 3.191389624255224, 6.949052365199196, 7.299750976696767, 9.428185580341992, 7.7146344199999515, 5.122057767815364, 5.701059023159878, 4.069818990020964, 6.879086167503752, 5.5882185958599235, 7.3441982945946265, 8.09323872758118, 8.989218451314185, 4.697987072484711, 5.201735227883111, 9.721107853744428, 10.513117619235578, 5.944561926714337, 8.35547061087466, 4.555263085014666, 3.1722316030797035, 8.99181324869774, 6.58236085698132, 7.03745198446182, 2.3884438593062307, 5.55586330033132, 4.404555830698465, 7.282965050570074, 4.673762357428669, 8.829798166422332, 10.311336832935359, 7.218427646553472, 7.217535859740451, 7.9256455506547505, 6.397697659419639, 6.09049893818288, 8.623873045155646, 10.933926916609945, 9.028891755369772, 6.360407309438819, 10.695701103299145, 11.786816563183617, 4.614122001847504, -0.5408307063586375, 3.138404397523805, 7.099581610974075, 6.154956934377457, 11.641827328988821, 5.900693561396087, 10.617000611183974, 8.881654601600594, 10.754335467443157, 4.165228482729503, 5.878121279145976, 8.077444067008637, 3.348099703945929, 8.323471399394087, 4.267654508857237, 6.530943157451397, 8.531979151942785, 10.030756180897846, 5.732453748263035, 7.492110206294343, 3.34669678168482, 10.917701161190038, 10.23157610247548, 5.499321492692685, 5.627756576624887, 9.680177098413443, 1.647986965530629, 8.61981838285317, 7.692035783831999, 8.083496022516291, 5.683721908947542, 9.664499409485265, 9.652742471745572, 7.430657251315599], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.783325845522004, "mean_inference_ms": 8.138515208128348, "mean_action_processing_ms": 0.5465710532390701, "mean_env_wait_ms": 24.144444380844092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04680275917053223, "StateBufferConnector_ms": 0.032837629318237305, "ViewRequirementAgentConnector_ms": 0.9976816177368164}}, "episode_reward_max": 11.786816563183617, "episode_reward_min": -0.5408307063586375, "episode_reward_mean": 7.066803421066544, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.682971143849732, 2.833498739027727, 6.557140827691993, 10.415167965911355, 6.408359741764364, 2.183936382849949, 8.310456364860045, 11.56392495385698, 9.123467276438083, 6.3372835300128765, 3.9983488270930208, 8.319930347624654, 7.724505534779789, 7.866979004565935, 4.6188758004493655, 5.853611813604637, 7.056695848383289, 10.424411207013113, 8.613792625511726, 7.804397351005958, 5.462380312076238, 5.275343207939424, 7.957510377313557, 3.191389624255224, 6.949052365199196, 7.299750976696767, 9.428185580341992, 7.7146344199999515, 5.122057767815364, 5.701059023159878, 4.069818990020964, 6.879086167503752, 5.5882185958599235, 7.3441982945946265, 8.09323872758118, 8.989218451314185, 4.697987072484711, 5.201735227883111, 9.721107853744428, 10.513117619235578, 5.944561926714337, 8.35547061087466, 4.555263085014666, 3.1722316030797035, 8.99181324869774, 6.58236085698132, 7.03745198446182, 2.3884438593062307, 5.55586330033132, 4.404555830698465, 7.282965050570074, 4.673762357428669, 8.829798166422332, 10.311336832935359, 7.218427646553472, 7.217535859740451, 7.9256455506547505, 6.397697659419639, 6.09049893818288, 8.623873045155646, 10.933926916609945, 9.028891755369772, 6.360407309438819, 10.695701103299145, 11.786816563183617, 4.614122001847504, -0.5408307063586375, 3.138404397523805, 7.099581610974075, 6.154956934377457, 11.641827328988821, 5.900693561396087, 10.617000611183974, 8.881654601600594, 10.754335467443157, 4.165228482729503, 5.878121279145976, 8.077444067008637, 3.348099703945929, 8.323471399394087, 4.267654508857237, 6.530943157451397, 8.531979151942785, 10.030756180897846, 5.732453748263035, 7.492110206294343, 3.34669678168482, 10.917701161190038, 10.23157610247548, 5.499321492692685, 5.627756576624887, 9.680177098413443, 1.647986965530629, 8.61981838285317, 7.692035783831999, 8.083496022516291, 5.683721908947542, 9.664499409485265, 9.652742471745572, 7.430657251315599], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.783325845522004, "mean_inference_ms": 8.138515208128348, "mean_action_processing_ms": 0.5465710532390701, "mean_env_wait_ms": 24.144444380844092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04680275917053223, "StateBufferConnector_ms": 0.032837629318237305, "ViewRequirementAgentConnector_ms": 0.9976816177368164}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7852362, "num_agent_steps_trained": 7852362, "num_env_steps_sampled": 7852362, "num_env_steps_trained": 7852362, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 275.6475899331399, "num_env_steps_trained_throughput_per_sec": 275.6475899331399, "timesteps_total": 7852362, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7852362, "timers": {"training_iteration_time_ms": 56003.671, "sample_time_ms": 42862.341, "load_time_ms": 1769.158, "load_throughput": 8839.234, "learn_time_ms": 10814.806, "learn_throughput": 1445.981, "synch_weights_time_ms": 433.178}, "counters": {"num_env_steps_sampled": 7852362, "num_env_steps_trained": 7852362, "num_agent_steps_sampled": 7852362, "num_agent_steps_trained": 7852362}, "done": false, "episodes_total": 2226, "training_iteration": 507, "trial_id": "2f030_00000", "date": "2025-06-07_10-06-25", "timestamp": 1749283585, "time_this_iter_s": 56.74769115447998, "time_total_s": 8993.255546092987, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8993.255546092987, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 79.7453125, "ram_util_percent": 70.94375, "gpu_util_percent0": 0.07218749999999999, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.695503684210527e-05, "total_loss": -0.0589635608298704, "policy_loss": -0.030944915205896407, "vf_loss": 0.01477916017936712, "vf_explained_var": 0.7230889510024677, "kl": 0.011530933466936953, "entropy": 20.33071343682029, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 87725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7868000, "num_env_steps_trained": 7868000, "num_agent_steps_sampled": 7868000, "num_agent_steps_trained": 7868000}, "sampler_results": {"episode_reward_max": 11.786816563183617, "episode_reward_min": -0.5408307063586375, "episode_reward_mean": 7.02325178091643, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.6188758004493655, 5.853611813604637, 7.056695848383289, 10.424411207013113, 8.613792625511726, 7.804397351005958, 5.462380312076238, 5.275343207939424, 7.957510377313557, 3.191389624255224, 6.949052365199196, 7.299750976696767, 9.428185580341992, 7.7146344199999515, 5.122057767815364, 5.701059023159878, 4.069818990020964, 6.879086167503752, 5.5882185958599235, 7.3441982945946265, 8.09323872758118, 8.989218451314185, 4.697987072484711, 5.201735227883111, 9.721107853744428, 10.513117619235578, 5.944561926714337, 8.35547061087466, 4.555263085014666, 3.1722316030797035, 8.99181324869774, 6.58236085698132, 7.03745198446182, 2.3884438593062307, 5.55586330033132, 4.404555830698465, 7.282965050570074, 4.673762357428669, 8.829798166422332, 10.311336832935359, 7.218427646553472, 7.217535859740451, 7.9256455506547505, 6.397697659419639, 6.09049893818288, 8.623873045155646, 10.933926916609945, 9.028891755369772, 6.360407309438819, 10.695701103299145, 11.786816563183617, 4.614122001847504, -0.5408307063586375, 3.138404397523805, 7.099581610974075, 6.154956934377457, 11.641827328988821, 5.900693561396087, 10.617000611183974, 8.881654601600594, 10.754335467443157, 4.165228482729503, 5.878121279145976, 8.077444067008637, 3.348099703945929, 8.323471399394087, 4.267654508857237, 6.530943157451397, 8.531979151942785, 10.030756180897846, 5.732453748263035, 7.492110206294343, 3.34669678168482, 10.917701161190038, 10.23157610247548, 5.499321492692685, 5.627756576624887, 9.680177098413443, 1.647986965530629, 8.61981838285317, 7.692035783831999, 8.083496022516291, 5.683721908947542, 9.664499409485265, 9.652742471745572, 7.430657251315599, 5.6631838999110675, 5.770199698341412, 7.87500978524931, 4.554620819126507, 5.979518498743465, 8.966735318100467, 6.766276886149455, 9.933006878998167, 8.940313814822183, 4.5314560442815495, 8.960576808824232, 9.47572444283187, 7.308029438438339, 3.246154291496932], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.782205316617432, "mean_inference_ms": 8.140366994160324, "mean_action_processing_ms": 0.5466777797720207, "mean_env_wait_ms": 24.148934814190866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045244455337524414, "StateBufferConnector_ms": 0.027821063995361328, "ViewRequirementAgentConnector_ms": 0.9961693286895752}}, "episode_reward_max": 11.786816563183617, "episode_reward_min": -0.5408307063586375, "episode_reward_mean": 7.02325178091643, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.6188758004493655, 5.853611813604637, 7.056695848383289, 10.424411207013113, 8.613792625511726, 7.804397351005958, 5.462380312076238, 5.275343207939424, 7.957510377313557, 3.191389624255224, 6.949052365199196, 7.299750976696767, 9.428185580341992, 7.7146344199999515, 5.122057767815364, 5.701059023159878, 4.069818990020964, 6.879086167503752, 5.5882185958599235, 7.3441982945946265, 8.09323872758118, 8.989218451314185, 4.697987072484711, 5.201735227883111, 9.721107853744428, 10.513117619235578, 5.944561926714337, 8.35547061087466, 4.555263085014666, 3.1722316030797035, 8.99181324869774, 6.58236085698132, 7.03745198446182, 2.3884438593062307, 5.55586330033132, 4.404555830698465, 7.282965050570074, 4.673762357428669, 8.829798166422332, 10.311336832935359, 7.218427646553472, 7.217535859740451, 7.9256455506547505, 6.397697659419639, 6.09049893818288, 8.623873045155646, 10.933926916609945, 9.028891755369772, 6.360407309438819, 10.695701103299145, 11.786816563183617, 4.614122001847504, -0.5408307063586375, 3.138404397523805, 7.099581610974075, 6.154956934377457, 11.641827328988821, 5.900693561396087, 10.617000611183974, 8.881654601600594, 10.754335467443157, 4.165228482729503, 5.878121279145976, 8.077444067008637, 3.348099703945929, 8.323471399394087, 4.267654508857237, 6.530943157451397, 8.531979151942785, 10.030756180897846, 5.732453748263035, 7.492110206294343, 3.34669678168482, 10.917701161190038, 10.23157610247548, 5.499321492692685, 5.627756576624887, 9.680177098413443, 1.647986965530629, 8.61981838285317, 7.692035783831999, 8.083496022516291, 5.683721908947542, 9.664499409485265, 9.652742471745572, 7.430657251315599, 5.6631838999110675, 5.770199698341412, 7.87500978524931, 4.554620819126507, 5.979518498743465, 8.966735318100467, 6.766276886149455, 9.933006878998167, 8.940313814822183, 4.5314560442815495, 8.960576808824232, 9.47572444283187, 7.308029438438339, 3.246154291496932], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.782205316617432, "mean_inference_ms": 8.140366994160324, "mean_action_processing_ms": 0.5466777797720207, "mean_env_wait_ms": 24.148934814190866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045244455337524414, "StateBufferConnector_ms": 0.027821063995361328, "ViewRequirementAgentConnector_ms": 0.9961693286895752}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7868000, "num_agent_steps_trained": 7868000, "num_env_steps_sampled": 7868000, "num_env_steps_trained": 7868000, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.2172367239396, "num_env_steps_trained_throughput_per_sec": 278.2172367239396, "timesteps_total": 7868000, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7868000, "timers": {"training_iteration_time_ms": 56089.853, "sample_time_ms": 42934.02, "load_time_ms": 1766.609, "load_throughput": 8851.987, "learn_time_ms": 10830.231, "learn_throughput": 1443.921, "synch_weights_time_ms": 439.27}, "counters": {"num_env_steps_sampled": 7868000, "num_env_steps_trained": 7868000, "num_agent_steps_sampled": 7868000, "num_agent_steps_trained": 7868000}, "done": false, "episodes_total": 2240, "training_iteration": 508, "trial_id": "2f030_00000", "date": "2025-06-07_10-07-22", "timestamp": 1749283642, "time_this_iter_s": 56.22890591621399, "time_total_s": 9049.484452009201, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9049.484452009201, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 78.10923076923076, "ram_util_percent": 71.02307692307693, "gpu_util_percent0": 0.08661538461538461, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.6831578947368426e-05, "total_loss": -0.04356068099213933, "policy_loss": -0.015634270134720612, "vf_loss": 0.01558708018199964, "vf_explained_var": 0.7421242046356201, "kl": 0.011558934136476242, "entropy": 20.415750637054444, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 88275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7883638, "num_env_steps_trained": 7883638, "num_agent_steps_sampled": 7883638, "num_agent_steps_trained": 7883638}, "sampler_results": {"episode_reward_max": 11.786816563183617, "episode_reward_min": -0.5408307063586375, "episode_reward_mean": 6.992065357977279, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.122057767815364, 5.701059023159878, 4.069818990020964, 6.879086167503752, 5.5882185958599235, 7.3441982945946265, 8.09323872758118, 8.989218451314185, 4.697987072484711, 5.201735227883111, 9.721107853744428, 10.513117619235578, 5.944561926714337, 8.35547061087466, 4.555263085014666, 3.1722316030797035, 8.99181324869774, 6.58236085698132, 7.03745198446182, 2.3884438593062307, 5.55586330033132, 4.404555830698465, 7.282965050570074, 4.673762357428669, 8.829798166422332, 10.311336832935359, 7.218427646553472, 7.217535859740451, 7.9256455506547505, 6.397697659419639, 6.09049893818288, 8.623873045155646, 10.933926916609945, 9.028891755369772, 6.360407309438819, 10.695701103299145, 11.786816563183617, 4.614122001847504, -0.5408307063586375, 3.138404397523805, 7.099581610974075, 6.154956934377457, 11.641827328988821, 5.900693561396087, 10.617000611183974, 8.881654601600594, 10.754335467443157, 4.165228482729503, 5.878121279145976, 8.077444067008637, 3.348099703945929, 8.323471399394087, 4.267654508857237, 6.530943157451397, 8.531979151942785, 10.030756180897846, 5.732453748263035, 7.492110206294343, 3.34669678168482, 10.917701161190038, 10.23157610247548, 5.499321492692685, 5.627756576624887, 9.680177098413443, 1.647986965530629, 8.61981838285317, 7.692035783831999, 8.083496022516291, 5.683721908947542, 9.664499409485265, 9.652742471745572, 7.430657251315599, 5.6631838999110675, 5.770199698341412, 7.87500978524931, 4.554620819126507, 5.979518498743465, 8.966735318100467, 6.766276886149455, 9.933006878998167, 8.940313814822183, 4.5314560442815495, 8.960576808824232, 9.47572444283187, 7.308029438438339, 3.246154291496932, 4.421881630781972, 5.302701181129261, 8.054222785336753, 7.6835343370065, 7.839703090675596, 5.024597887795358, 8.383708169518876, 5.7371934437893035, 7.756816339713703, 3.8449232481037257, 6.854929123055321, 5.606788473409882, 8.854183254449005, 9.166206251110156], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7811850112156495, "mean_inference_ms": 8.142082652652974, "mean_action_processing_ms": 0.5467840017275472, "mean_env_wait_ms": 24.153347845600123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04122209548950195, "StateBufferConnector_ms": 0.023153066635131836, "ViewRequirementAgentConnector_ms": 0.9840257167816162}}, "episode_reward_max": 11.786816563183617, "episode_reward_min": -0.5408307063586375, "episode_reward_mean": 6.992065357977279, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.122057767815364, 5.701059023159878, 4.069818990020964, 6.879086167503752, 5.5882185958599235, 7.3441982945946265, 8.09323872758118, 8.989218451314185, 4.697987072484711, 5.201735227883111, 9.721107853744428, 10.513117619235578, 5.944561926714337, 8.35547061087466, 4.555263085014666, 3.1722316030797035, 8.99181324869774, 6.58236085698132, 7.03745198446182, 2.3884438593062307, 5.55586330033132, 4.404555830698465, 7.282965050570074, 4.673762357428669, 8.829798166422332, 10.311336832935359, 7.218427646553472, 7.217535859740451, 7.9256455506547505, 6.397697659419639, 6.09049893818288, 8.623873045155646, 10.933926916609945, 9.028891755369772, 6.360407309438819, 10.695701103299145, 11.786816563183617, 4.614122001847504, -0.5408307063586375, 3.138404397523805, 7.099581610974075, 6.154956934377457, 11.641827328988821, 5.900693561396087, 10.617000611183974, 8.881654601600594, 10.754335467443157, 4.165228482729503, 5.878121279145976, 8.077444067008637, 3.348099703945929, 8.323471399394087, 4.267654508857237, 6.530943157451397, 8.531979151942785, 10.030756180897846, 5.732453748263035, 7.492110206294343, 3.34669678168482, 10.917701161190038, 10.23157610247548, 5.499321492692685, 5.627756576624887, 9.680177098413443, 1.647986965530629, 8.61981838285317, 7.692035783831999, 8.083496022516291, 5.683721908947542, 9.664499409485265, 9.652742471745572, 7.430657251315599, 5.6631838999110675, 5.770199698341412, 7.87500978524931, 4.554620819126507, 5.979518498743465, 8.966735318100467, 6.766276886149455, 9.933006878998167, 8.940313814822183, 4.5314560442815495, 8.960576808824232, 9.47572444283187, 7.308029438438339, 3.246154291496932, 4.421881630781972, 5.302701181129261, 8.054222785336753, 7.6835343370065, 7.839703090675596, 5.024597887795358, 8.383708169518876, 5.7371934437893035, 7.756816339713703, 3.8449232481037257, 6.854929123055321, 5.606788473409882, 8.854183254449005, 9.166206251110156], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7811850112156495, "mean_inference_ms": 8.142082652652974, "mean_action_processing_ms": 0.5467840017275472, "mean_env_wait_ms": 24.153347845600123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04122209548950195, "StateBufferConnector_ms": 0.023153066635131836, "ViewRequirementAgentConnector_ms": 0.9840257167816162}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7883638, "num_agent_steps_trained": 7883638, "num_env_steps_sampled": 7883638, "num_env_steps_trained": 7883638, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 277.4779328527655, "num_env_steps_trained_throughput_per_sec": 277.4779328527655, "timesteps_total": 7883638, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7883638, "timers": {"training_iteration_time_ms": 56136.552, "sample_time_ms": 42978.449, "load_time_ms": 1774.839, "load_throughput": 8810.939, "learn_time_ms": 10822.544, "learn_throughput": 1444.947, "synch_weights_time_ms": 440.643}, "counters": {"num_env_steps_sampled": 7883638, "num_env_steps_trained": 7883638, "num_agent_steps_sampled": 7883638, "num_agent_steps_trained": 7883638}, "done": false, "episodes_total": 2254, "training_iteration": 509, "trial_id": "2f030_00000", "date": "2025-06-07_10-08-18", "timestamp": 1749283698, "time_this_iter_s": 56.37332105636597, "time_total_s": 9105.857773065567, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9105.857773065567, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 78.56984126984128, "ram_util_percent": 70.89047619047619, "gpu_util_percent0": 0.08206349206349207, "vram_util_percent0": 0.8592122395833336}}
{"evaluation": {"sampler_results": {"episode_reward_max": -2.3405374280109466, "episode_reward_min": -7.120721988126896, "episode_reward_mean": -4.335229988713411, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3405374280109466, -4.824123056303769, -4.452962186819002, -7.120721988126896, -2.9378052843064375], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4246810801871697, "mean_inference_ms": 3.856743519952951, "mean_action_processing_ms": 0.2777964537897178, "mean_env_wait_ms": 10.476059807237858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.019822120666503906, "ViewRequirementAgentConnector_ms": 0.18027305603027344}}, "episode_reward_max": -2.3405374280109466, "episode_reward_min": -7.120721988126896, "episode_reward_mean": -4.335229988713411, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3405374280109466, -4.824123056303769, -4.452962186819002, -7.120721988126896, -2.9378052843064375], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4246810801871697, "mean_inference_ms": 3.856743519952951, "mean_action_processing_ms": 0.2777964537897178, "mean_env_wait_ms": 10.476059807237858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.019822120666503906, "ViewRequirementAgentConnector_ms": 0.18027305603027344}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.6708121052631584e-05, "total_loss": -0.05108602258038114, "policy_loss": -0.023170478973453017, "vf_loss": 0.014897890745408156, "vf_explained_var": 0.7397445185617967, "kl": 0.011526984394533644, "entropy": 20.29556527571245, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 88825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7899276, "num_env_steps_trained": 7899276, "num_agent_steps_sampled": 7899276, "num_agent_steps_trained": 7899276}, "sampler_results": {"episode_reward_max": 11.786816563183617, "episode_reward_min": -0.5408307063586375, "episode_reward_mean": 7.0438642998924035, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.555263085014666, 3.1722316030797035, 8.99181324869774, 6.58236085698132, 7.03745198446182, 2.3884438593062307, 5.55586330033132, 4.404555830698465, 7.282965050570074, 4.673762357428669, 8.829798166422332, 10.311336832935359, 7.218427646553472, 7.217535859740451, 7.9256455506547505, 6.397697659419639, 6.09049893818288, 8.623873045155646, 10.933926916609945, 9.028891755369772, 6.360407309438819, 10.695701103299145, 11.786816563183617, 4.614122001847504, -0.5408307063586375, 3.138404397523805, 7.099581610974075, 6.154956934377457, 11.641827328988821, 5.900693561396087, 10.617000611183974, 8.881654601600594, 10.754335467443157, 4.165228482729503, 5.878121279145976, 8.077444067008637, 3.348099703945929, 8.323471399394087, 4.267654508857237, 6.530943157451397, 8.531979151942785, 10.030756180897846, 5.732453748263035, 7.492110206294343, 3.34669678168482, 10.917701161190038, 10.23157610247548, 5.499321492692685, 5.627756576624887, 9.680177098413443, 1.647986965530629, 8.61981838285317, 7.692035783831999, 8.083496022516291, 5.683721908947542, 9.664499409485265, 9.652742471745572, 7.430657251315599, 5.6631838999110675, 5.770199698341412, 7.87500978524931, 4.554620819126507, 5.979518498743465, 8.966735318100467, 6.766276886149455, 9.933006878998167, 8.940313814822183, 4.5314560442815495, 8.960576808824232, 9.47572444283187, 7.308029438438339, 3.246154291496932, 4.421881630781972, 5.302701181129261, 8.054222785336753, 7.6835343370065, 7.839703090675596, 5.024597887795358, 8.383708169518876, 5.7371934437893035, 7.756816339713703, 3.8449232481037257, 6.854929123055321, 5.606788473409882, 8.854183254449005, 9.166206251110156, 6.405358604786256, 5.295326682955034, 3.2690633547172037, 6.1272005751191765, 5.903047350960822, 9.472018859417815, 7.62621416807603, 5.6520538423730065, 9.835017374943995, 8.824676707777147, 6.932390044504633, 7.186838833321095, 10.422425549180419, 8.449138572166625], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.780206335269371, "mean_inference_ms": 8.143698716881772, "mean_action_processing_ms": 0.5468833430275368, "mean_env_wait_ms": 24.157532490117823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04023885726928711, "StateBufferConnector_ms": 0.02820301055908203, "ViewRequirementAgentConnector_ms": 0.9701707363128662}}, "episode_reward_max": 11.786816563183617, "episode_reward_min": -0.5408307063586375, "episode_reward_mean": 7.0438642998924035, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.555263085014666, 3.1722316030797035, 8.99181324869774, 6.58236085698132, 7.03745198446182, 2.3884438593062307, 5.55586330033132, 4.404555830698465, 7.282965050570074, 4.673762357428669, 8.829798166422332, 10.311336832935359, 7.218427646553472, 7.217535859740451, 7.9256455506547505, 6.397697659419639, 6.09049893818288, 8.623873045155646, 10.933926916609945, 9.028891755369772, 6.360407309438819, 10.695701103299145, 11.786816563183617, 4.614122001847504, -0.5408307063586375, 3.138404397523805, 7.099581610974075, 6.154956934377457, 11.641827328988821, 5.900693561396087, 10.617000611183974, 8.881654601600594, 10.754335467443157, 4.165228482729503, 5.878121279145976, 8.077444067008637, 3.348099703945929, 8.323471399394087, 4.267654508857237, 6.530943157451397, 8.531979151942785, 10.030756180897846, 5.732453748263035, 7.492110206294343, 3.34669678168482, 10.917701161190038, 10.23157610247548, 5.499321492692685, 5.627756576624887, 9.680177098413443, 1.647986965530629, 8.61981838285317, 7.692035783831999, 8.083496022516291, 5.683721908947542, 9.664499409485265, 9.652742471745572, 7.430657251315599, 5.6631838999110675, 5.770199698341412, 7.87500978524931, 4.554620819126507, 5.979518498743465, 8.966735318100467, 6.766276886149455, 9.933006878998167, 8.940313814822183, 4.5314560442815495, 8.960576808824232, 9.47572444283187, 7.308029438438339, 3.246154291496932, 4.421881630781972, 5.302701181129261, 8.054222785336753, 7.6835343370065, 7.839703090675596, 5.024597887795358, 8.383708169518876, 5.7371934437893035, 7.756816339713703, 3.8449232481037257, 6.854929123055321, 5.606788473409882, 8.854183254449005, 9.166206251110156, 6.405358604786256, 5.295326682955034, 3.2690633547172037, 6.1272005751191765, 5.903047350960822, 9.472018859417815, 7.62621416807603, 5.6520538423730065, 9.835017374943995, 8.824676707777147, 6.932390044504633, 7.186838833321095, 10.422425549180419, 8.449138572166625], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.780206335269371, "mean_inference_ms": 8.143698716881772, "mean_action_processing_ms": 0.5468833430275368, "mean_env_wait_ms": 24.157532490117823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04023885726928711, "StateBufferConnector_ms": 0.02820301055908203, "ViewRequirementAgentConnector_ms": 0.9701707363128662}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7899276, "num_agent_steps_trained": 7899276, "num_env_steps_sampled": 7899276, "num_env_steps_trained": 7899276, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.7912214189646, "num_env_steps_trained_throughput_per_sec": 278.7912214189646, "timesteps_total": 7899276, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7899276, "timers": {"training_iteration_time_ms": 56134.4, "sample_time_ms": 42966.795, "load_time_ms": 1786.532, "load_throughput": 8753.274, "learn_time_ms": 10815.781, "learn_throughput": 1445.85, "synch_weights_time_ms": 444.416}, "counters": {"num_env_steps_sampled": 7899276, "num_env_steps_trained": 7899276, "num_agent_steps_sampled": 7899276, "num_agent_steps_trained": 7899276}, "done": false, "episodes_total": 2268, "training_iteration": 510, "trial_id": "2f030_00000", "date": "2025-06-07_10-09-29", "timestamp": 1749283769, "time_this_iter_s": 70.97597146034241, "time_total_s": 9176.83374452591, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9176.83374452591, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 65.85487804878049, "ram_util_percent": 70.53536585365856, "gpu_util_percent0": 0.059024390243902436, "vram_util_percent0": 0.8592122395833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.658466315789474e-05, "total_loss": -0.05193182556297291, "policy_loss": -0.024458281027777543, "vf_loss": 0.01818402618000453, "vf_explained_var": 0.7222615693915974, "kl": 0.011188458338252862, "entropy": 20.446985071355645, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 89375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7914914, "num_env_steps_trained": 7914914, "num_agent_steps_sampled": 7914914, "num_agent_steps_trained": 7914914}, "sampler_results": {"episode_reward_max": 11.786816563183617, "episode_reward_min": -0.5408307063586375, "episode_reward_mean": 7.042546841722338, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.9256455506547505, 6.397697659419639, 6.09049893818288, 8.623873045155646, 10.933926916609945, 9.028891755369772, 6.360407309438819, 10.695701103299145, 11.786816563183617, 4.614122001847504, -0.5408307063586375, 3.138404397523805, 7.099581610974075, 6.154956934377457, 11.641827328988821, 5.900693561396087, 10.617000611183974, 8.881654601600594, 10.754335467443157, 4.165228482729503, 5.878121279145976, 8.077444067008637, 3.348099703945929, 8.323471399394087, 4.267654508857237, 6.530943157451397, 8.531979151942785, 10.030756180897846, 5.732453748263035, 7.492110206294343, 3.34669678168482, 10.917701161190038, 10.23157610247548, 5.499321492692685, 5.627756576624887, 9.680177098413443, 1.647986965530629, 8.61981838285317, 7.692035783831999, 8.083496022516291, 5.683721908947542, 9.664499409485265, 9.652742471745572, 7.430657251315599, 5.6631838999110675, 5.770199698341412, 7.87500978524931, 4.554620819126507, 5.979518498743465, 8.966735318100467, 6.766276886149455, 9.933006878998167, 8.940313814822183, 4.5314560442815495, 8.960576808824232, 9.47572444283187, 7.308029438438339, 3.246154291496932, 4.421881630781972, 5.302701181129261, 8.054222785336753, 7.6835343370065, 7.839703090675596, 5.024597887795358, 8.383708169518876, 5.7371934437893035, 7.756816339713703, 3.8449232481037257, 6.854929123055321, 5.606788473409882, 8.854183254449005, 9.166206251110156, 6.405358604786256, 5.295326682955034, 3.2690633547172037, 6.1272005751191765, 5.903047350960822, 9.472018859417815, 7.62621416807603, 5.6520538423730065, 9.835017374943995, 8.824676707777147, 6.932390044504633, 7.186838833321095, 10.422425549180419, 8.449138572166625, 0.560906200286441, 9.244179273052005, 7.184138975746756, 6.560698058240934, 9.917451739066506, 0.6061425839287183, 1.5104012390192059, 6.023570528544432, 8.23642485585396, 4.085163555415779, 10.732587403875922, 7.47431089165626, 7.461131422161445, 8.49295713836664], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.779001151042207, "mean_inference_ms": 8.145446906150362, "mean_action_processing_ms": 0.5469785093656031, "mean_env_wait_ms": 24.16178759897839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03218793869018555, "StateBufferConnector_ms": 0.02617669105529785, "ViewRequirementAgentConnector_ms": 0.9770336151123047}}, "episode_reward_max": 11.786816563183617, "episode_reward_min": -0.5408307063586375, "episode_reward_mean": 7.042546841722338, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.9256455506547505, 6.397697659419639, 6.09049893818288, 8.623873045155646, 10.933926916609945, 9.028891755369772, 6.360407309438819, 10.695701103299145, 11.786816563183617, 4.614122001847504, -0.5408307063586375, 3.138404397523805, 7.099581610974075, 6.154956934377457, 11.641827328988821, 5.900693561396087, 10.617000611183974, 8.881654601600594, 10.754335467443157, 4.165228482729503, 5.878121279145976, 8.077444067008637, 3.348099703945929, 8.323471399394087, 4.267654508857237, 6.530943157451397, 8.531979151942785, 10.030756180897846, 5.732453748263035, 7.492110206294343, 3.34669678168482, 10.917701161190038, 10.23157610247548, 5.499321492692685, 5.627756576624887, 9.680177098413443, 1.647986965530629, 8.61981838285317, 7.692035783831999, 8.083496022516291, 5.683721908947542, 9.664499409485265, 9.652742471745572, 7.430657251315599, 5.6631838999110675, 5.770199698341412, 7.87500978524931, 4.554620819126507, 5.979518498743465, 8.966735318100467, 6.766276886149455, 9.933006878998167, 8.940313814822183, 4.5314560442815495, 8.960576808824232, 9.47572444283187, 7.308029438438339, 3.246154291496932, 4.421881630781972, 5.302701181129261, 8.054222785336753, 7.6835343370065, 7.839703090675596, 5.024597887795358, 8.383708169518876, 5.7371934437893035, 7.756816339713703, 3.8449232481037257, 6.854929123055321, 5.606788473409882, 8.854183254449005, 9.166206251110156, 6.405358604786256, 5.295326682955034, 3.2690633547172037, 6.1272005751191765, 5.903047350960822, 9.472018859417815, 7.62621416807603, 5.6520538423730065, 9.835017374943995, 8.824676707777147, 6.932390044504633, 7.186838833321095, 10.422425549180419, 8.449138572166625, 0.560906200286441, 9.244179273052005, 7.184138975746756, 6.560698058240934, 9.917451739066506, 0.6061425839287183, 1.5104012390192059, 6.023570528544432, 8.23642485585396, 4.085163555415779, 10.732587403875922, 7.47431089165626, 7.461131422161445, 8.49295713836664], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.779001151042207, "mean_inference_ms": 8.145446906150362, "mean_action_processing_ms": 0.5469785093656031, "mean_env_wait_ms": 24.16178759897839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03218793869018555, "StateBufferConnector_ms": 0.02617669105529785, "ViewRequirementAgentConnector_ms": 0.9770336151123047}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7914914, "num_agent_steps_trained": 7914914, "num_env_steps_sampled": 7914914, "num_env_steps_trained": 7914914, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 275.9288034513852, "num_env_steps_trained_throughput_per_sec": 275.9288034513852, "timesteps_total": 7914914, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7914914, "timers": {"training_iteration_time_ms": 56262.361, "sample_time_ms": 43052.282, "load_time_ms": 1811.282, "load_throughput": 8633.664, "learn_time_ms": 10827.06, "learn_throughput": 1444.344, "synch_weights_time_ms": 450.061}, "counters": {"num_env_steps_sampled": 7914914, "num_env_steps_trained": 7914914, "num_agent_steps_sampled": 7914914, "num_agent_steps_trained": 7914914}, "done": false, "episodes_total": 2282, "training_iteration": 511, "trial_id": "2f030_00000", "date": "2025-06-07_10-10-26", "timestamp": 1749283826, "time_this_iter_s": 56.690078020095825, "time_total_s": 9233.523822546005, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9233.523822546005, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 77.79230769230769, "ram_util_percent": 71.28000000000002, "gpu_util_percent0": 0.07523076923076923, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.6461205263157907e-05, "total_loss": -0.05815883774141019, "policy_loss": -0.030434793407541953, "vf_loss": 0.01693492905660109, "vf_explained_var": 0.7285990369319916, "kl": 0.01132222766598025, "entropy": 20.432488278475674, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 89925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7930552, "num_env_steps_trained": 7930552, "num_agent_steps_sampled": 7930552, "num_agent_steps_trained": 7930552}, "sampler_results": {"episode_reward_max": 11.641827328988821, "episode_reward_min": 0.560906200286441, "episode_reward_mean": 7.00203493372482, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.641827328988821, 5.900693561396087, 10.617000611183974, 8.881654601600594, 10.754335467443157, 4.165228482729503, 5.878121279145976, 8.077444067008637, 3.348099703945929, 8.323471399394087, 4.267654508857237, 6.530943157451397, 8.531979151942785, 10.030756180897846, 5.732453748263035, 7.492110206294343, 3.34669678168482, 10.917701161190038, 10.23157610247548, 5.499321492692685, 5.627756576624887, 9.680177098413443, 1.647986965530629, 8.61981838285317, 7.692035783831999, 8.083496022516291, 5.683721908947542, 9.664499409485265, 9.652742471745572, 7.430657251315599, 5.6631838999110675, 5.770199698341412, 7.87500978524931, 4.554620819126507, 5.979518498743465, 8.966735318100467, 6.766276886149455, 9.933006878998167, 8.940313814822183, 4.5314560442815495, 8.960576808824232, 9.47572444283187, 7.308029438438339, 3.246154291496932, 4.421881630781972, 5.302701181129261, 8.054222785336753, 7.6835343370065, 7.839703090675596, 5.024597887795358, 8.383708169518876, 5.7371934437893035, 7.756816339713703, 3.8449232481037257, 6.854929123055321, 5.606788473409882, 8.854183254449005, 9.166206251110156, 6.405358604786256, 5.295326682955034, 3.2690633547172037, 6.1272005751191765, 5.903047350960822, 9.472018859417815, 7.62621416807603, 5.6520538423730065, 9.835017374943995, 8.824676707777147, 6.932390044504633, 7.186838833321095, 10.422425549180419, 8.449138572166625, 0.560906200286441, 9.244179273052005, 7.184138975746756, 6.560698058240934, 9.917451739066506, 0.6061425839287183, 1.5104012390192059, 6.023570528544432, 8.23642485585396, 4.085163555415779, 10.732587403875922, 7.47431089165626, 7.461131422161445, 8.49295713836664, 5.05920211416867, 9.041937461401606, 3.169284680157711, 9.123163247485204, 4.973404989159482, 8.056696583918733, 9.10824514149655, 5.250701191016678, 5.3815313030237055, 7.259836359008767, 5.2481030401582345, 9.52903937953734, 7.994648613813257, 5.062708175580765], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7780331728183687, "mean_inference_ms": 8.147194830375712, "mean_action_processing_ms": 0.5470617800777187, "mean_env_wait_ms": 24.165968748159234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027144908905029297, "StateBufferConnector_ms": 0.030084848403930664, "ViewRequirementAgentConnector_ms": 0.9608306884765625}}, "episode_reward_max": 11.641827328988821, "episode_reward_min": 0.560906200286441, "episode_reward_mean": 7.00203493372482, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.641827328988821, 5.900693561396087, 10.617000611183974, 8.881654601600594, 10.754335467443157, 4.165228482729503, 5.878121279145976, 8.077444067008637, 3.348099703945929, 8.323471399394087, 4.267654508857237, 6.530943157451397, 8.531979151942785, 10.030756180897846, 5.732453748263035, 7.492110206294343, 3.34669678168482, 10.917701161190038, 10.23157610247548, 5.499321492692685, 5.627756576624887, 9.680177098413443, 1.647986965530629, 8.61981838285317, 7.692035783831999, 8.083496022516291, 5.683721908947542, 9.664499409485265, 9.652742471745572, 7.430657251315599, 5.6631838999110675, 5.770199698341412, 7.87500978524931, 4.554620819126507, 5.979518498743465, 8.966735318100467, 6.766276886149455, 9.933006878998167, 8.940313814822183, 4.5314560442815495, 8.960576808824232, 9.47572444283187, 7.308029438438339, 3.246154291496932, 4.421881630781972, 5.302701181129261, 8.054222785336753, 7.6835343370065, 7.839703090675596, 5.024597887795358, 8.383708169518876, 5.7371934437893035, 7.756816339713703, 3.8449232481037257, 6.854929123055321, 5.606788473409882, 8.854183254449005, 9.166206251110156, 6.405358604786256, 5.295326682955034, 3.2690633547172037, 6.1272005751191765, 5.903047350960822, 9.472018859417815, 7.62621416807603, 5.6520538423730065, 9.835017374943995, 8.824676707777147, 6.932390044504633, 7.186838833321095, 10.422425549180419, 8.449138572166625, 0.560906200286441, 9.244179273052005, 7.184138975746756, 6.560698058240934, 9.917451739066506, 0.6061425839287183, 1.5104012390192059, 6.023570528544432, 8.23642485585396, 4.085163555415779, 10.732587403875922, 7.47431089165626, 7.461131422161445, 8.49295713836664, 5.05920211416867, 9.041937461401606, 3.169284680157711, 9.123163247485204, 4.973404989159482, 8.056696583918733, 9.10824514149655, 5.250701191016678, 5.3815313030237055, 7.259836359008767, 5.2481030401582345, 9.52903937953734, 7.994648613813257, 5.062708175580765], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7780331728183687, "mean_inference_ms": 8.147194830375712, "mean_action_processing_ms": 0.5470617800777187, "mean_env_wait_ms": 24.165968748159234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027144908905029297, "StateBufferConnector_ms": 0.030084848403930664, "ViewRequirementAgentConnector_ms": 0.9608306884765625}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7930552, "num_agent_steps_trained": 7930552, "num_env_steps_sampled": 7930552, "num_env_steps_trained": 7930552, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.9879736135384, "num_env_steps_trained_throughput_per_sec": 278.9879736135384, "timesteps_total": 7930552, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7930552, "timers": {"training_iteration_time_ms": 56235.206, "sample_time_ms": 43027.972, "load_time_ms": 1808.123, "load_throughput": 8648.746, "learn_time_ms": 10829.232, "learn_throughput": 1444.054, "synch_weights_time_ms": 448.56}, "counters": {"num_env_steps_sampled": 7930552, "num_env_steps_trained": 7930552, "num_agent_steps_sampled": 7930552, "num_agent_steps_trained": 7930552}, "done": false, "episodes_total": 2296, "training_iteration": 512, "trial_id": "2f030_00000", "date": "2025-06-07_10-11-22", "timestamp": 1749283882, "time_this_iter_s": 56.06858229637146, "time_total_s": 9289.592404842377, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9289.592404842377, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 79.01587301587303, "ram_util_percent": 71.17936507936507, "gpu_util_percent0": 0.07412698412698414, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.633774736842106e-05, "total_loss": -0.059024767870591445, "policy_loss": -0.03077480401780287, "vf_loss": 0.014498887678438967, "vf_explained_var": 0.7306607007980347, "kl": 0.011439992909716111, "entropy": 20.371960291428998, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 90475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7946190, "num_env_steps_trained": 7946190, "num_agent_steps_sampled": 7946190, "num_agent_steps_trained": 7946190}, "sampler_results": {"episode_reward_max": 11.454395693445358, "episode_reward_min": 0.560906200286441, "episode_reward_mean": 7.039217077149736, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.732453748263035, 7.492110206294343, 3.34669678168482, 10.917701161190038, 10.23157610247548, 5.499321492692685, 5.627756576624887, 9.680177098413443, 1.647986965530629, 8.61981838285317, 7.692035783831999, 8.083496022516291, 5.683721908947542, 9.664499409485265, 9.652742471745572, 7.430657251315599, 5.6631838999110675, 5.770199698341412, 7.87500978524931, 4.554620819126507, 5.979518498743465, 8.966735318100467, 6.766276886149455, 9.933006878998167, 8.940313814822183, 4.5314560442815495, 8.960576808824232, 9.47572444283187, 7.308029438438339, 3.246154291496932, 4.421881630781972, 5.302701181129261, 8.054222785336753, 7.6835343370065, 7.839703090675596, 5.024597887795358, 8.383708169518876, 5.7371934437893035, 7.756816339713703, 3.8449232481037257, 6.854929123055321, 5.606788473409882, 8.854183254449005, 9.166206251110156, 6.405358604786256, 5.295326682955034, 3.2690633547172037, 6.1272005751191765, 5.903047350960822, 9.472018859417815, 7.62621416807603, 5.6520538423730065, 9.835017374943995, 8.824676707777147, 6.932390044504633, 7.186838833321095, 10.422425549180419, 8.449138572166625, 0.560906200286441, 9.244179273052005, 7.184138975746756, 6.560698058240934, 9.917451739066506, 0.6061425839287183, 1.5104012390192059, 6.023570528544432, 8.23642485585396, 4.085163555415779, 10.732587403875922, 7.47431089165626, 7.461131422161445, 8.49295713836664, 5.05920211416867, 9.041937461401606, 3.169284680157711, 9.123163247485204, 4.973404989159482, 8.056696583918733, 9.10824514149655, 5.250701191016678, 5.3815313030237055, 7.259836359008767, 5.2481030401582345, 9.52903937953734, 7.994648613813257, 5.062708175580765, 8.692177606859525, 10.944800204408011, 11.454395693445358, 3.669977288195929, 7.361391253318118, 7.25895654667589, 8.967481468022628, 4.691511234483594, 5.176076746205589, 9.82664627519414, 7.8975160666900335, 9.976037485697175, 6.304264682628591, 8.446191292652843], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.777127693741515, "mean_inference_ms": 8.148928932284885, "mean_action_processing_ms": 0.5471392131613317, "mean_env_wait_ms": 24.17007231963714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02610301971435547, "StateBufferConnector_ms": 0.035155296325683594, "ViewRequirementAgentConnector_ms": 0.9922854900360107}}, "episode_reward_max": 11.454395693445358, "episode_reward_min": 0.560906200286441, "episode_reward_mean": 7.039217077149736, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.732453748263035, 7.492110206294343, 3.34669678168482, 10.917701161190038, 10.23157610247548, 5.499321492692685, 5.627756576624887, 9.680177098413443, 1.647986965530629, 8.61981838285317, 7.692035783831999, 8.083496022516291, 5.683721908947542, 9.664499409485265, 9.652742471745572, 7.430657251315599, 5.6631838999110675, 5.770199698341412, 7.87500978524931, 4.554620819126507, 5.979518498743465, 8.966735318100467, 6.766276886149455, 9.933006878998167, 8.940313814822183, 4.5314560442815495, 8.960576808824232, 9.47572444283187, 7.308029438438339, 3.246154291496932, 4.421881630781972, 5.302701181129261, 8.054222785336753, 7.6835343370065, 7.839703090675596, 5.024597887795358, 8.383708169518876, 5.7371934437893035, 7.756816339713703, 3.8449232481037257, 6.854929123055321, 5.606788473409882, 8.854183254449005, 9.166206251110156, 6.405358604786256, 5.295326682955034, 3.2690633547172037, 6.1272005751191765, 5.903047350960822, 9.472018859417815, 7.62621416807603, 5.6520538423730065, 9.835017374943995, 8.824676707777147, 6.932390044504633, 7.186838833321095, 10.422425549180419, 8.449138572166625, 0.560906200286441, 9.244179273052005, 7.184138975746756, 6.560698058240934, 9.917451739066506, 0.6061425839287183, 1.5104012390192059, 6.023570528544432, 8.23642485585396, 4.085163555415779, 10.732587403875922, 7.47431089165626, 7.461131422161445, 8.49295713836664, 5.05920211416867, 9.041937461401606, 3.169284680157711, 9.123163247485204, 4.973404989159482, 8.056696583918733, 9.10824514149655, 5.250701191016678, 5.3815313030237055, 7.259836359008767, 5.2481030401582345, 9.52903937953734, 7.994648613813257, 5.062708175580765, 8.692177606859525, 10.944800204408011, 11.454395693445358, 3.669977288195929, 7.361391253318118, 7.25895654667589, 8.967481468022628, 4.691511234483594, 5.176076746205589, 9.82664627519414, 7.8975160666900335, 9.976037485697175, 6.304264682628591, 8.446191292652843], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.777127693741515, "mean_inference_ms": 8.148928932284885, "mean_action_processing_ms": 0.5471392131613317, "mean_env_wait_ms": 24.17007231963714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02610301971435547, "StateBufferConnector_ms": 0.035155296325683594, "ViewRequirementAgentConnector_ms": 0.9922854900360107}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7946190, "num_agent_steps_trained": 7946190, "num_env_steps_sampled": 7946190, "num_env_steps_trained": 7946190, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.5317285266987, "num_env_steps_trained_throughput_per_sec": 278.5317285266987, "timesteps_total": 7946190, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7946190, "timers": {"training_iteration_time_ms": 56215.712, "sample_time_ms": 42979.654, "load_time_ms": 1823.749, "load_throughput": 8574.645, "learn_time_ms": 10850.92, "learn_throughput": 1441.168, "synch_weights_time_ms": 439.809}, "counters": {"num_env_steps_sampled": 7946190, "num_env_steps_trained": 7946190, "num_agent_steps_sampled": 7946190, "num_agent_steps_trained": 7946190}, "done": false, "episodes_total": 2310, "training_iteration": 513, "trial_id": "2f030_00000", "date": "2025-06-07_10-12-18", "timestamp": 1749283938, "time_this_iter_s": 56.158414125442505, "time_total_s": 9345.75081896782, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9345.75081896782, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 78.0140625, "ram_util_percent": 71.04375, "gpu_util_percent0": 0.0878125, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.6214289473684216e-05, "total_loss": -0.056238593645393846, "policy_loss": -0.028251538049292074, "vf_loss": 0.016892390414987777, "vf_explained_var": 0.7259697083993392, "kl": 0.010882133427711034, "entropy": 20.400957338159735, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 91025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7961828, "num_env_steps_trained": 7961828, "num_agent_steps_sampled": 7961828, "num_agent_steps_trained": 7961828}, "sampler_results": {"episode_reward_max": 11.454395693445358, "episode_reward_min": 0.560906200286441, "episode_reward_mean": 7.012814348334971, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.652742471745572, 7.430657251315599, 5.6631838999110675, 5.770199698341412, 7.87500978524931, 4.554620819126507, 5.979518498743465, 8.966735318100467, 6.766276886149455, 9.933006878998167, 8.940313814822183, 4.5314560442815495, 8.960576808824232, 9.47572444283187, 7.308029438438339, 3.246154291496932, 4.421881630781972, 5.302701181129261, 8.054222785336753, 7.6835343370065, 7.839703090675596, 5.024597887795358, 8.383708169518876, 5.7371934437893035, 7.756816339713703, 3.8449232481037257, 6.854929123055321, 5.606788473409882, 8.854183254449005, 9.166206251110156, 6.405358604786256, 5.295326682955034, 3.2690633547172037, 6.1272005751191765, 5.903047350960822, 9.472018859417815, 7.62621416807603, 5.6520538423730065, 9.835017374943995, 8.824676707777147, 6.932390044504633, 7.186838833321095, 10.422425549180419, 8.449138572166625, 0.560906200286441, 9.244179273052005, 7.184138975746756, 6.560698058240934, 9.917451739066506, 0.6061425839287183, 1.5104012390192059, 6.023570528544432, 8.23642485585396, 4.085163555415779, 10.732587403875922, 7.47431089165626, 7.461131422161445, 8.49295713836664, 5.05920211416867, 9.041937461401606, 3.169284680157711, 9.123163247485204, 4.973404989159482, 8.056696583918733, 9.10824514149655, 5.250701191016678, 5.3815313030237055, 7.259836359008767, 5.2481030401582345, 9.52903937953734, 7.994648613813257, 5.062708175580765, 8.692177606859525, 10.944800204408011, 11.454395693445358, 3.669977288195929, 7.361391253318118, 7.25895654667589, 8.967481468022628, 4.691511234483594, 5.176076746205589, 9.82664627519414, 7.8975160666900335, 9.976037485697175, 6.304264682628591, 8.446191292652843, 5.430953574763245, 6.112849959003759, 1.2359426655995218, 2.2645257440398576, 7.557125424002972, 4.607041521856852, 8.907627370477064, 10.536763003592199, 10.934993872186979, 8.874710569811429, 8.520029902075274, 8.936426908143696, 7.84198717827472, 5.518101065499396], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7759317290506953, "mean_inference_ms": 8.150651592178022, "mean_action_processing_ms": 0.5472171350200559, "mean_env_wait_ms": 24.173833479281228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024036169052124023, "StateBufferConnector_ms": 0.04008817672729492, "ViewRequirementAgentConnector_ms": 0.9698641300201416}}, "episode_reward_max": 11.454395693445358, "episode_reward_min": 0.560906200286441, "episode_reward_mean": 7.012814348334971, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.652742471745572, 7.430657251315599, 5.6631838999110675, 5.770199698341412, 7.87500978524931, 4.554620819126507, 5.979518498743465, 8.966735318100467, 6.766276886149455, 9.933006878998167, 8.940313814822183, 4.5314560442815495, 8.960576808824232, 9.47572444283187, 7.308029438438339, 3.246154291496932, 4.421881630781972, 5.302701181129261, 8.054222785336753, 7.6835343370065, 7.839703090675596, 5.024597887795358, 8.383708169518876, 5.7371934437893035, 7.756816339713703, 3.8449232481037257, 6.854929123055321, 5.606788473409882, 8.854183254449005, 9.166206251110156, 6.405358604786256, 5.295326682955034, 3.2690633547172037, 6.1272005751191765, 5.903047350960822, 9.472018859417815, 7.62621416807603, 5.6520538423730065, 9.835017374943995, 8.824676707777147, 6.932390044504633, 7.186838833321095, 10.422425549180419, 8.449138572166625, 0.560906200286441, 9.244179273052005, 7.184138975746756, 6.560698058240934, 9.917451739066506, 0.6061425839287183, 1.5104012390192059, 6.023570528544432, 8.23642485585396, 4.085163555415779, 10.732587403875922, 7.47431089165626, 7.461131422161445, 8.49295713836664, 5.05920211416867, 9.041937461401606, 3.169284680157711, 9.123163247485204, 4.973404989159482, 8.056696583918733, 9.10824514149655, 5.250701191016678, 5.3815313030237055, 7.259836359008767, 5.2481030401582345, 9.52903937953734, 7.994648613813257, 5.062708175580765, 8.692177606859525, 10.944800204408011, 11.454395693445358, 3.669977288195929, 7.361391253318118, 7.25895654667589, 8.967481468022628, 4.691511234483594, 5.176076746205589, 9.82664627519414, 7.8975160666900335, 9.976037485697175, 6.304264682628591, 8.446191292652843, 5.430953574763245, 6.112849959003759, 1.2359426655995218, 2.2645257440398576, 7.557125424002972, 4.607041521856852, 8.907627370477064, 10.536763003592199, 10.934993872186979, 8.874710569811429, 8.520029902075274, 8.936426908143696, 7.84198717827472, 5.518101065499396], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7759317290506953, "mean_inference_ms": 8.150651592178022, "mean_action_processing_ms": 0.5472171350200559, "mean_env_wait_ms": 24.173833479281228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024036169052124023, "StateBufferConnector_ms": 0.04008817672729492, "ViewRequirementAgentConnector_ms": 0.9698641300201416}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7961828, "num_agent_steps_trained": 7961828, "num_env_steps_sampled": 7961828, "num_env_steps_trained": 7961828, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 277.3972523656649, "num_env_steps_trained_throughput_per_sec": 277.3972523656649, "timesteps_total": 7961828, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7961828, "timers": {"training_iteration_time_ms": 56238.75, "sample_time_ms": 42994.075, "load_time_ms": 1816.07, "load_throughput": 8610.901, "learn_time_ms": 10867.182, "learn_throughput": 1439.011, "synch_weights_time_ms": 442.723}, "counters": {"num_env_steps_sampled": 7961828, "num_env_steps_trained": 7961828, "num_agent_steps_sampled": 7961828, "num_agent_steps_trained": 7961828}, "done": false, "episodes_total": 2324, "training_iteration": 514, "trial_id": "2f030_00000", "date": "2025-06-07_10-13-15", "timestamp": 1749283995, "time_this_iter_s": 56.391029357910156, "time_total_s": 9402.14184832573, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9402.14184832573, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 77.55625, "ram_util_percent": 70.8671875, "gpu_util_percent0": 0.0746875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.6090831578947373e-05, "total_loss": -0.052131449749947274, "policy_loss": -0.02404171255751201, "vf_loss": 0.015718414994295347, "vf_explained_var": 0.7545952708070929, "kl": 0.01103673185644002, "entropy": 20.33123259977861, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 91575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7977466, "num_env_steps_trained": 7977466, "num_agent_steps_sampled": 7977466, "num_agent_steps_trained": 7977466}, "sampler_results": {"episode_reward_max": 11.454395693445358, "episode_reward_min": 0.560906200286441, "episode_reward_mean": 6.948965907747886, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.308029438438339, 3.246154291496932, 4.421881630781972, 5.302701181129261, 8.054222785336753, 7.6835343370065, 7.839703090675596, 5.024597887795358, 8.383708169518876, 5.7371934437893035, 7.756816339713703, 3.8449232481037257, 6.854929123055321, 5.606788473409882, 8.854183254449005, 9.166206251110156, 6.405358604786256, 5.295326682955034, 3.2690633547172037, 6.1272005751191765, 5.903047350960822, 9.472018859417815, 7.62621416807603, 5.6520538423730065, 9.835017374943995, 8.824676707777147, 6.932390044504633, 7.186838833321095, 10.422425549180419, 8.449138572166625, 0.560906200286441, 9.244179273052005, 7.184138975746756, 6.560698058240934, 9.917451739066506, 0.6061425839287183, 1.5104012390192059, 6.023570528544432, 8.23642485585396, 4.085163555415779, 10.732587403875922, 7.47431089165626, 7.461131422161445, 8.49295713836664, 5.05920211416867, 9.041937461401606, 3.169284680157711, 9.123163247485204, 4.973404989159482, 8.056696583918733, 9.10824514149655, 5.250701191016678, 5.3815313030237055, 7.259836359008767, 5.2481030401582345, 9.52903937953734, 7.994648613813257, 5.062708175580765, 8.692177606859525, 10.944800204408011, 11.454395693445358, 3.669977288195929, 7.361391253318118, 7.25895654667589, 8.967481468022628, 4.691511234483594, 5.176076746205589, 9.82664627519414, 7.8975160666900335, 9.976037485697175, 6.304264682628591, 8.446191292652843, 5.430953574763245, 6.112849959003759, 1.2359426655995218, 2.2645257440398576, 7.557125424002972, 4.607041521856852, 8.907627370477064, 10.536763003592199, 10.934993872186979, 8.874710569811429, 8.520029902075274, 8.936426908143696, 7.84198717827472, 5.518101065499396, 7.198224549731057, 9.561995035535892, 5.74682017239092, 10.843665065943762, 8.762536650935171, 6.770672716289705, 3.93261122327548, 8.98413616167669, 4.216172642051082, 5.537762042846417, 7.407398053242417, 7.696068917993802, 7.806693025264661, 3.6504223025554667], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.774865016894889, "mean_inference_ms": 8.152201376881472, "mean_action_processing_ms": 0.5472874570289828, "mean_env_wait_ms": 24.177240337056254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037932395935058594, "StateBufferConnector_ms": 0.04102754592895508, "ViewRequirementAgentConnector_ms": 0.9679405689239502}}, "episode_reward_max": 11.454395693445358, "episode_reward_min": 0.560906200286441, "episode_reward_mean": 6.948965907747886, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.308029438438339, 3.246154291496932, 4.421881630781972, 5.302701181129261, 8.054222785336753, 7.6835343370065, 7.839703090675596, 5.024597887795358, 8.383708169518876, 5.7371934437893035, 7.756816339713703, 3.8449232481037257, 6.854929123055321, 5.606788473409882, 8.854183254449005, 9.166206251110156, 6.405358604786256, 5.295326682955034, 3.2690633547172037, 6.1272005751191765, 5.903047350960822, 9.472018859417815, 7.62621416807603, 5.6520538423730065, 9.835017374943995, 8.824676707777147, 6.932390044504633, 7.186838833321095, 10.422425549180419, 8.449138572166625, 0.560906200286441, 9.244179273052005, 7.184138975746756, 6.560698058240934, 9.917451739066506, 0.6061425839287183, 1.5104012390192059, 6.023570528544432, 8.23642485585396, 4.085163555415779, 10.732587403875922, 7.47431089165626, 7.461131422161445, 8.49295713836664, 5.05920211416867, 9.041937461401606, 3.169284680157711, 9.123163247485204, 4.973404989159482, 8.056696583918733, 9.10824514149655, 5.250701191016678, 5.3815313030237055, 7.259836359008767, 5.2481030401582345, 9.52903937953734, 7.994648613813257, 5.062708175580765, 8.692177606859525, 10.944800204408011, 11.454395693445358, 3.669977288195929, 7.361391253318118, 7.25895654667589, 8.967481468022628, 4.691511234483594, 5.176076746205589, 9.82664627519414, 7.8975160666900335, 9.976037485697175, 6.304264682628591, 8.446191292652843, 5.430953574763245, 6.112849959003759, 1.2359426655995218, 2.2645257440398576, 7.557125424002972, 4.607041521856852, 8.907627370477064, 10.536763003592199, 10.934993872186979, 8.874710569811429, 8.520029902075274, 8.936426908143696, 7.84198717827472, 5.518101065499396, 7.198224549731057, 9.561995035535892, 5.74682017239092, 10.843665065943762, 8.762536650935171, 6.770672716289705, 3.93261122327548, 8.98413616167669, 4.216172642051082, 5.537762042846417, 7.407398053242417, 7.696068917993802, 7.806693025264661, 3.6504223025554667], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.774865016894889, "mean_inference_ms": 8.152201376881472, "mean_action_processing_ms": 0.5472874570289828, "mean_env_wait_ms": 24.177240337056254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037932395935058594, "StateBufferConnector_ms": 0.04102754592895508, "ViewRequirementAgentConnector_ms": 0.9679405689239502}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7977466, "num_agent_steps_trained": 7977466, "num_env_steps_sampled": 7977466, "num_env_steps_trained": 7977466, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.1520906979513, "num_env_steps_trained_throughput_per_sec": 281.1520906979513, "timesteps_total": 7977466, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7977466, "timers": {"training_iteration_time_ms": 56214.358, "sample_time_ms": 42974.558, "load_time_ms": 1823.993, "load_throughput": 8573.497, "learn_time_ms": 10856.952, "learn_throughput": 1440.367, "synch_weights_time_ms": 440.907}, "counters": {"num_env_steps_sampled": 7977466, "num_env_steps_trained": 7977466, "num_agent_steps_sampled": 7977466, "num_agent_steps_trained": 7977466}, "done": false, "episodes_total": 2338, "training_iteration": 515, "trial_id": "2f030_00000", "date": "2025-06-07_10-14-10", "timestamp": 1749284050, "time_this_iter_s": 55.63612413406372, "time_total_s": 9457.777972459793, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9457.777972459793, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 78.75238095238095, "ram_util_percent": 71.13809523809525, "gpu_util_percent0": 0.07492063492063493, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.596737368421053e-05, "total_loss": -0.04952766713008962, "policy_loss": -0.021498129698077472, "vf_loss": 0.01586163802834397, "vf_explained_var": 0.7292266543345017, "kl": 0.01126823544382088, "entropy": 20.405020774494517, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 92125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 7993104, "num_env_steps_trained": 7993104, "num_agent_steps_sampled": 7993104, "num_agent_steps_trained": 7993104}, "sampler_results": {"episode_reward_max": 11.807643477698468, "episode_reward_min": 0.560906200286441, "episode_reward_mean": 7.012669821928227, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.854183254449005, 9.166206251110156, 6.405358604786256, 5.295326682955034, 3.2690633547172037, 6.1272005751191765, 5.903047350960822, 9.472018859417815, 7.62621416807603, 5.6520538423730065, 9.835017374943995, 8.824676707777147, 6.932390044504633, 7.186838833321095, 10.422425549180419, 8.449138572166625, 0.560906200286441, 9.244179273052005, 7.184138975746756, 6.560698058240934, 9.917451739066506, 0.6061425839287183, 1.5104012390192059, 6.023570528544432, 8.23642485585396, 4.085163555415779, 10.732587403875922, 7.47431089165626, 7.461131422161445, 8.49295713836664, 5.05920211416867, 9.041937461401606, 3.169284680157711, 9.123163247485204, 4.973404989159482, 8.056696583918733, 9.10824514149655, 5.250701191016678, 5.3815313030237055, 7.259836359008767, 5.2481030401582345, 9.52903937953734, 7.994648613813257, 5.062708175580765, 8.692177606859525, 10.944800204408011, 11.454395693445358, 3.669977288195929, 7.361391253318118, 7.25895654667589, 8.967481468022628, 4.691511234483594, 5.176076746205589, 9.82664627519414, 7.8975160666900335, 9.976037485697175, 6.304264682628591, 8.446191292652843, 5.430953574763245, 6.112849959003759, 1.2359426655995218, 2.2645257440398576, 7.557125424002972, 4.607041521856852, 8.907627370477064, 10.536763003592199, 10.934993872186979, 8.874710569811429, 8.520029902075274, 8.936426908143696, 7.84198717827472, 5.518101065499396, 7.198224549731057, 9.561995035535892, 5.74682017239092, 10.843665065943762, 8.762536650935171, 6.770672716289705, 3.93261122327548, 8.98413616167669, 4.216172642051082, 5.537762042846417, 7.407398053242417, 7.696068917993802, 7.806693025264661, 3.6504223025554667, 5.417782338877194, 1.330919671807573, 9.08935222184077, 9.210520899257823, 8.762750703337048, 11.807643477698468, 2.922413538435434, 5.489401331047108, 7.814855193852197, 9.502269926065345, 4.52024360113992, 3.5102386787063145, 7.266434783737127, 6.790748492483357], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.77363412449007, "mean_inference_ms": 8.153848072151769, "mean_action_processing_ms": 0.5473668421312132, "mean_env_wait_ms": 24.181204707628726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03901958465576172, "StateBufferConnector_ms": 0.0411074161529541, "ViewRequirementAgentConnector_ms": 0.9937479496002197}}, "episode_reward_max": 11.807643477698468, "episode_reward_min": 0.560906200286441, "episode_reward_mean": 7.012669821928227, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.854183254449005, 9.166206251110156, 6.405358604786256, 5.295326682955034, 3.2690633547172037, 6.1272005751191765, 5.903047350960822, 9.472018859417815, 7.62621416807603, 5.6520538423730065, 9.835017374943995, 8.824676707777147, 6.932390044504633, 7.186838833321095, 10.422425549180419, 8.449138572166625, 0.560906200286441, 9.244179273052005, 7.184138975746756, 6.560698058240934, 9.917451739066506, 0.6061425839287183, 1.5104012390192059, 6.023570528544432, 8.23642485585396, 4.085163555415779, 10.732587403875922, 7.47431089165626, 7.461131422161445, 8.49295713836664, 5.05920211416867, 9.041937461401606, 3.169284680157711, 9.123163247485204, 4.973404989159482, 8.056696583918733, 9.10824514149655, 5.250701191016678, 5.3815313030237055, 7.259836359008767, 5.2481030401582345, 9.52903937953734, 7.994648613813257, 5.062708175580765, 8.692177606859525, 10.944800204408011, 11.454395693445358, 3.669977288195929, 7.361391253318118, 7.25895654667589, 8.967481468022628, 4.691511234483594, 5.176076746205589, 9.82664627519414, 7.8975160666900335, 9.976037485697175, 6.304264682628591, 8.446191292652843, 5.430953574763245, 6.112849959003759, 1.2359426655995218, 2.2645257440398576, 7.557125424002972, 4.607041521856852, 8.907627370477064, 10.536763003592199, 10.934993872186979, 8.874710569811429, 8.520029902075274, 8.936426908143696, 7.84198717827472, 5.518101065499396, 7.198224549731057, 9.561995035535892, 5.74682017239092, 10.843665065943762, 8.762536650935171, 6.770672716289705, 3.93261122327548, 8.98413616167669, 4.216172642051082, 5.537762042846417, 7.407398053242417, 7.696068917993802, 7.806693025264661, 3.6504223025554667, 5.417782338877194, 1.330919671807573, 9.08935222184077, 9.210520899257823, 8.762750703337048, 11.807643477698468, 2.922413538435434, 5.489401331047108, 7.814855193852197, 9.502269926065345, 4.52024360113992, 3.5102386787063145, 7.266434783737127, 6.790748492483357], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.77363412449007, "mean_inference_ms": 8.153848072151769, "mean_action_processing_ms": 0.5473668421312132, "mean_env_wait_ms": 24.181204707628726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03901958465576172, "StateBufferConnector_ms": 0.0411074161529541, "ViewRequirementAgentConnector_ms": 0.9937479496002197}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7993104, "num_agent_steps_trained": 7993104, "num_env_steps_sampled": 7993104, "num_env_steps_trained": 7993104, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 273.952038178258, "num_env_steps_trained_throughput_per_sec": 273.952038178258, "timesteps_total": 7993104, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 7993104, "timers": {"training_iteration_time_ms": 56333.872, "sample_time_ms": 43065.322, "load_time_ms": 1839.418, "load_throughput": 8501.601, "learn_time_ms": 10873.839, "learn_throughput": 1438.131, "synch_weights_time_ms": 440.039}, "counters": {"num_env_steps_sampled": 7993104, "num_env_steps_trained": 7993104, "num_agent_steps_sampled": 7993104, "num_agent_steps_trained": 7993104}, "done": false, "episodes_total": 2352, "training_iteration": 516, "trial_id": "2f030_00000", "date": "2025-06-07_10-15-08", "timestamp": 1749284108, "time_this_iter_s": 57.09851002693176, "time_total_s": 9514.876482486725, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9514.876482486725, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 77.4323076923077, "ram_util_percent": 71.3, "gpu_util_percent0": 0.08476923076923076, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.584391578947368e-05, "total_loss": -0.053312080227346584, "policy_loss": -0.02490971043990364, "vf_loss": 0.015358405621214346, "vf_explained_var": 0.7456387813524766, "kl": 0.010849598787489262, "entropy": 20.366936031688343, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 92675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8008742, "num_env_steps_trained": 8008742, "num_agent_steps_sampled": 8008742, "num_agent_steps_trained": 8008742}, "sampler_results": {"episode_reward_max": 11.807643477698468, "episode_reward_min": 0.560906200286441, "episode_reward_mean": 7.104380091015621, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.422425549180419, 8.449138572166625, 0.560906200286441, 9.244179273052005, 7.184138975746756, 6.560698058240934, 9.917451739066506, 0.6061425839287183, 1.5104012390192059, 6.023570528544432, 8.23642485585396, 4.085163555415779, 10.732587403875922, 7.47431089165626, 7.461131422161445, 8.49295713836664, 5.05920211416867, 9.041937461401606, 3.169284680157711, 9.123163247485204, 4.973404989159482, 8.056696583918733, 9.10824514149655, 5.250701191016678, 5.3815313030237055, 7.259836359008767, 5.2481030401582345, 9.52903937953734, 7.994648613813257, 5.062708175580765, 8.692177606859525, 10.944800204408011, 11.454395693445358, 3.669977288195929, 7.361391253318118, 7.25895654667589, 8.967481468022628, 4.691511234483594, 5.176076746205589, 9.82664627519414, 7.8975160666900335, 9.976037485697175, 6.304264682628591, 8.446191292652843, 5.430953574763245, 6.112849959003759, 1.2359426655995218, 2.2645257440398576, 7.557125424002972, 4.607041521856852, 8.907627370477064, 10.536763003592199, 10.934993872186979, 8.874710569811429, 8.520029902075274, 8.936426908143696, 7.84198717827472, 5.518101065499396, 7.198224549731057, 9.561995035535892, 5.74682017239092, 10.843665065943762, 8.762536650935171, 6.770672716289705, 3.93261122327548, 8.98413616167669, 4.216172642051082, 5.537762042846417, 7.407398053242417, 7.696068917993802, 7.806693025264661, 3.6504223025554667, 5.417782338877194, 1.330919671807573, 9.08935222184077, 9.210520899257823, 8.762750703337048, 11.807643477698468, 2.922413538435434, 5.489401331047108, 7.814855193852197, 9.502269926065345, 4.52024360113992, 3.5102386787063145, 7.266434783737127, 6.790748492483357, 9.240553107608935, 4.861418011210646, 11.130642241734769, 3.210938366698568, 6.996163186507471, 10.134699916737322, 7.2853729725735095, 8.321843190026579, 7.887939899823732, 6.174182892065922, 6.04437682218247, 11.736807629401843, 10.142319383741496, 6.553365192937448], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.772521429069426, "mean_inference_ms": 8.155548887501604, "mean_action_processing_ms": 0.547461169142992, "mean_env_wait_ms": 24.185083249842165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04496908187866211, "StateBufferConnector_ms": 0.03904604911804199, "ViewRequirementAgentConnector_ms": 0.9801528453826904}}, "episode_reward_max": 11.807643477698468, "episode_reward_min": 0.560906200286441, "episode_reward_mean": 7.104380091015621, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.422425549180419, 8.449138572166625, 0.560906200286441, 9.244179273052005, 7.184138975746756, 6.560698058240934, 9.917451739066506, 0.6061425839287183, 1.5104012390192059, 6.023570528544432, 8.23642485585396, 4.085163555415779, 10.732587403875922, 7.47431089165626, 7.461131422161445, 8.49295713836664, 5.05920211416867, 9.041937461401606, 3.169284680157711, 9.123163247485204, 4.973404989159482, 8.056696583918733, 9.10824514149655, 5.250701191016678, 5.3815313030237055, 7.259836359008767, 5.2481030401582345, 9.52903937953734, 7.994648613813257, 5.062708175580765, 8.692177606859525, 10.944800204408011, 11.454395693445358, 3.669977288195929, 7.361391253318118, 7.25895654667589, 8.967481468022628, 4.691511234483594, 5.176076746205589, 9.82664627519414, 7.8975160666900335, 9.976037485697175, 6.304264682628591, 8.446191292652843, 5.430953574763245, 6.112849959003759, 1.2359426655995218, 2.2645257440398576, 7.557125424002972, 4.607041521856852, 8.907627370477064, 10.536763003592199, 10.934993872186979, 8.874710569811429, 8.520029902075274, 8.936426908143696, 7.84198717827472, 5.518101065499396, 7.198224549731057, 9.561995035535892, 5.74682017239092, 10.843665065943762, 8.762536650935171, 6.770672716289705, 3.93261122327548, 8.98413616167669, 4.216172642051082, 5.537762042846417, 7.407398053242417, 7.696068917993802, 7.806693025264661, 3.6504223025554667, 5.417782338877194, 1.330919671807573, 9.08935222184077, 9.210520899257823, 8.762750703337048, 11.807643477698468, 2.922413538435434, 5.489401331047108, 7.814855193852197, 9.502269926065345, 4.52024360113992, 3.5102386787063145, 7.266434783737127, 6.790748492483357, 9.240553107608935, 4.861418011210646, 11.130642241734769, 3.210938366698568, 6.996163186507471, 10.134699916737322, 7.2853729725735095, 8.321843190026579, 7.887939899823732, 6.174182892065922, 6.04437682218247, 11.736807629401843, 10.142319383741496, 6.553365192937448], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.772521429069426, "mean_inference_ms": 8.155548887501604, "mean_action_processing_ms": 0.547461169142992, "mean_env_wait_ms": 24.185083249842165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04496908187866211, "StateBufferConnector_ms": 0.03904604911804199, "ViewRequirementAgentConnector_ms": 0.9801528453826904}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8008742, "num_agent_steps_trained": 8008742, "num_env_steps_sampled": 8008742, "num_env_steps_trained": 8008742, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 276.9772528248149, "num_env_steps_trained_throughput_per_sec": 276.9772528248149, "timesteps_total": 8008742, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8008742, "timers": {"training_iteration_time_ms": 56306.637, "sample_time_ms": 43034.988, "load_time_ms": 1819.779, "load_throughput": 8593.35, "learn_time_ms": 10885.35, "learn_throughput": 1436.61, "synch_weights_time_ms": 449.752}, "counters": {"num_env_steps_sampled": 8008742, "num_env_steps_trained": 8008742, "num_agent_steps_sampled": 8008742, "num_agent_steps_trained": 8008742}, "done": false, "episodes_total": 2366, "training_iteration": 517, "trial_id": "2f030_00000", "date": "2025-06-07_10-16-04", "timestamp": 1749284164, "time_this_iter_s": 56.47320556640625, "time_total_s": 9571.349688053131, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9571.349688053131, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 78.3625, "ram_util_percent": 71.30156249999999, "gpu_util_percent0": 0.0759375, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.572045789473684e-05, "total_loss": -0.046911046489311214, "policy_loss": -0.018396201955408534, "vf_loss": 0.013897171391343529, "vf_explained_var": 0.7359897418455644, "kl": 0.01122218719814675, "entropy": 20.336613388061522, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 93225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8024380, "num_env_steps_trained": 8024380, "num_agent_steps_sampled": 8024380, "num_agent_steps_trained": 8024380}, "sampler_results": {"episode_reward_max": 11.807643477698468, "episode_reward_min": 1.2359426655995218, "episode_reward_mean": 7.316140883887109, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.461131422161445, 8.49295713836664, 5.05920211416867, 9.041937461401606, 3.169284680157711, 9.123163247485204, 4.973404989159482, 8.056696583918733, 9.10824514149655, 5.250701191016678, 5.3815313030237055, 7.259836359008767, 5.2481030401582345, 9.52903937953734, 7.994648613813257, 5.062708175580765, 8.692177606859525, 10.944800204408011, 11.454395693445358, 3.669977288195929, 7.361391253318118, 7.25895654667589, 8.967481468022628, 4.691511234483594, 5.176076746205589, 9.82664627519414, 7.8975160666900335, 9.976037485697175, 6.304264682628591, 8.446191292652843, 5.430953574763245, 6.112849959003759, 1.2359426655995218, 2.2645257440398576, 7.557125424002972, 4.607041521856852, 8.907627370477064, 10.536763003592199, 10.934993872186979, 8.874710569811429, 8.520029902075274, 8.936426908143696, 7.84198717827472, 5.518101065499396, 7.198224549731057, 9.561995035535892, 5.74682017239092, 10.843665065943762, 8.762536650935171, 6.770672716289705, 3.93261122327548, 8.98413616167669, 4.216172642051082, 5.537762042846417, 7.407398053242417, 7.696068917993802, 7.806693025264661, 3.6504223025554667, 5.417782338877194, 1.330919671807573, 9.08935222184077, 9.210520899257823, 8.762750703337048, 11.807643477698468, 2.922413538435434, 5.489401331047108, 7.814855193852197, 9.502269926065345, 4.52024360113992, 3.5102386787063145, 7.266434783737127, 6.790748492483357, 9.240553107608935, 4.861418011210646, 11.130642241734769, 3.210938366698568, 6.996163186507471, 10.134699916737322, 7.2853729725735095, 8.321843190026579, 7.887939899823732, 6.174182892065922, 6.04437682218247, 11.736807629401843, 10.142319383741496, 6.553365192937448, 6.312519505095439, 8.548402373579309, 10.407218828823948, 8.595651070053696, 10.279477613176992, 9.517347583635457, 1.7714973812870556, 7.091240421045978, 8.82272888217294, 9.023408952599395, 8.963815170929092, 7.142205824930301, 8.823868977165962, 6.884236128687282], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7717208301453216, "mean_inference_ms": 8.15700645482477, "mean_action_processing_ms": 0.5475380969171355, "mean_env_wait_ms": 24.188657337828605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044013023376464844, "StateBufferConnector_ms": 0.0380091667175293, "ViewRequirementAgentConnector_ms": 0.9575767517089844}}, "episode_reward_max": 11.807643477698468, "episode_reward_min": 1.2359426655995218, "episode_reward_mean": 7.316140883887109, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.461131422161445, 8.49295713836664, 5.05920211416867, 9.041937461401606, 3.169284680157711, 9.123163247485204, 4.973404989159482, 8.056696583918733, 9.10824514149655, 5.250701191016678, 5.3815313030237055, 7.259836359008767, 5.2481030401582345, 9.52903937953734, 7.994648613813257, 5.062708175580765, 8.692177606859525, 10.944800204408011, 11.454395693445358, 3.669977288195929, 7.361391253318118, 7.25895654667589, 8.967481468022628, 4.691511234483594, 5.176076746205589, 9.82664627519414, 7.8975160666900335, 9.976037485697175, 6.304264682628591, 8.446191292652843, 5.430953574763245, 6.112849959003759, 1.2359426655995218, 2.2645257440398576, 7.557125424002972, 4.607041521856852, 8.907627370477064, 10.536763003592199, 10.934993872186979, 8.874710569811429, 8.520029902075274, 8.936426908143696, 7.84198717827472, 5.518101065499396, 7.198224549731057, 9.561995035535892, 5.74682017239092, 10.843665065943762, 8.762536650935171, 6.770672716289705, 3.93261122327548, 8.98413616167669, 4.216172642051082, 5.537762042846417, 7.407398053242417, 7.696068917993802, 7.806693025264661, 3.6504223025554667, 5.417782338877194, 1.330919671807573, 9.08935222184077, 9.210520899257823, 8.762750703337048, 11.807643477698468, 2.922413538435434, 5.489401331047108, 7.814855193852197, 9.502269926065345, 4.52024360113992, 3.5102386787063145, 7.266434783737127, 6.790748492483357, 9.240553107608935, 4.861418011210646, 11.130642241734769, 3.210938366698568, 6.996163186507471, 10.134699916737322, 7.2853729725735095, 8.321843190026579, 7.887939899823732, 6.174182892065922, 6.04437682218247, 11.736807629401843, 10.142319383741496, 6.553365192937448, 6.312519505095439, 8.548402373579309, 10.407218828823948, 8.595651070053696, 10.279477613176992, 9.517347583635457, 1.7714973812870556, 7.091240421045978, 8.82272888217294, 9.023408952599395, 8.963815170929092, 7.142205824930301, 8.823868977165962, 6.884236128687282], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7717208301453216, "mean_inference_ms": 8.15700645482477, "mean_action_processing_ms": 0.5475380969171355, "mean_env_wait_ms": 24.188657337828605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044013023376464844, "StateBufferConnector_ms": 0.0380091667175293, "ViewRequirementAgentConnector_ms": 0.9575767517089844}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8024380, "num_agent_steps_trained": 8024380, "num_env_steps_sampled": 8024380, "num_env_steps_trained": 8024380, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.12675188430813, "num_env_steps_trained_throughput_per_sec": 280.12675188430813, "timesteps_total": 8024380, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8024380, "timers": {"training_iteration_time_ms": 56268.323, "sample_time_ms": 42997.52, "load_time_ms": 1826.534, "load_throughput": 8561.571, "learn_time_ms": 10879.45, "learn_throughput": 1437.389, "synch_weights_time_ms": 447.292}, "counters": {"num_env_steps_sampled": 8024380, "num_env_steps_trained": 8024380, "num_agent_steps_sampled": 8024380, "num_agent_steps_trained": 8024380}, "done": false, "episodes_total": 2380, "training_iteration": 518, "trial_id": "2f030_00000", "date": "2025-06-07_10-17-00", "timestamp": 1749284220, "time_this_iter_s": 55.83855628967285, "time_total_s": 9627.188244342804, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9627.188244342804, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 78.6079365079365, "ram_util_percent": 70.73492063492064, "gpu_util_percent0": 0.07333333333333335, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.559700000000001e-05, "total_loss": -0.055006956313313406, "policy_loss": -0.026314258956011725, "vf_loss": 0.014692612059245056, "vf_explained_var": 0.7499503491141579, "kl": 0.010613014285256874, "entropy": 20.32801640597257, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 93775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8040018, "num_env_steps_trained": 8040018, "num_agent_steps_sampled": 8040018, "num_agent_steps_trained": 8040018}, "sampler_results": {"episode_reward_max": 11.807643477698468, "episode_reward_min": 1.2359426655995218, "episode_reward_mean": 7.335003970195898, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.994648613813257, 5.062708175580765, 8.692177606859525, 10.944800204408011, 11.454395693445358, 3.669977288195929, 7.361391253318118, 7.25895654667589, 8.967481468022628, 4.691511234483594, 5.176076746205589, 9.82664627519414, 7.8975160666900335, 9.976037485697175, 6.304264682628591, 8.446191292652843, 5.430953574763245, 6.112849959003759, 1.2359426655995218, 2.2645257440398576, 7.557125424002972, 4.607041521856852, 8.907627370477064, 10.536763003592199, 10.934993872186979, 8.874710569811429, 8.520029902075274, 8.936426908143696, 7.84198717827472, 5.518101065499396, 7.198224549731057, 9.561995035535892, 5.74682017239092, 10.843665065943762, 8.762536650935171, 6.770672716289705, 3.93261122327548, 8.98413616167669, 4.216172642051082, 5.537762042846417, 7.407398053242417, 7.696068917993802, 7.806693025264661, 3.6504223025554667, 5.417782338877194, 1.330919671807573, 9.08935222184077, 9.210520899257823, 8.762750703337048, 11.807643477698468, 2.922413538435434, 5.489401331047108, 7.814855193852197, 9.502269926065345, 4.52024360113992, 3.5102386787063145, 7.266434783737127, 6.790748492483357, 9.240553107608935, 4.861418011210646, 11.130642241734769, 3.210938366698568, 6.996163186507471, 10.134699916737322, 7.2853729725735095, 8.321843190026579, 7.887939899823732, 6.174182892065922, 6.04437682218247, 11.736807629401843, 10.142319383741496, 6.553365192937448, 6.312519505095439, 8.548402373579309, 10.407218828823948, 8.595651070053696, 10.279477613176992, 9.517347583635457, 1.7714973812870556, 7.091240421045978, 8.82272888217294, 9.023408952599395, 8.963815170929092, 7.142205824930301, 8.823868977165962, 6.884236128687282, 6.906579763507267, 6.760006369668925, 9.687316079612632, 5.302791336485666, 7.571828980987511, 5.229258844056363, 10.411371654129898, 11.458031008632954, 5.224139304362303, 7.050756663431978, 6.862837325265559, 4.887481474946714, 4.85344837269657, 6.835695504155249], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.770628270971646, "mean_inference_ms": 8.158547061009106, "mean_action_processing_ms": 0.5476328206523435, "mean_env_wait_ms": 24.192736028842656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042046308517456055, "StateBufferConnector_ms": 0.03403925895690918, "ViewRequirementAgentConnector_ms": 0.953599214553833}}, "episode_reward_max": 11.807643477698468, "episode_reward_min": 1.2359426655995218, "episode_reward_mean": 7.335003970195898, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.994648613813257, 5.062708175580765, 8.692177606859525, 10.944800204408011, 11.454395693445358, 3.669977288195929, 7.361391253318118, 7.25895654667589, 8.967481468022628, 4.691511234483594, 5.176076746205589, 9.82664627519414, 7.8975160666900335, 9.976037485697175, 6.304264682628591, 8.446191292652843, 5.430953574763245, 6.112849959003759, 1.2359426655995218, 2.2645257440398576, 7.557125424002972, 4.607041521856852, 8.907627370477064, 10.536763003592199, 10.934993872186979, 8.874710569811429, 8.520029902075274, 8.936426908143696, 7.84198717827472, 5.518101065499396, 7.198224549731057, 9.561995035535892, 5.74682017239092, 10.843665065943762, 8.762536650935171, 6.770672716289705, 3.93261122327548, 8.98413616167669, 4.216172642051082, 5.537762042846417, 7.407398053242417, 7.696068917993802, 7.806693025264661, 3.6504223025554667, 5.417782338877194, 1.330919671807573, 9.08935222184077, 9.210520899257823, 8.762750703337048, 11.807643477698468, 2.922413538435434, 5.489401331047108, 7.814855193852197, 9.502269926065345, 4.52024360113992, 3.5102386787063145, 7.266434783737127, 6.790748492483357, 9.240553107608935, 4.861418011210646, 11.130642241734769, 3.210938366698568, 6.996163186507471, 10.134699916737322, 7.2853729725735095, 8.321843190026579, 7.887939899823732, 6.174182892065922, 6.04437682218247, 11.736807629401843, 10.142319383741496, 6.553365192937448, 6.312519505095439, 8.548402373579309, 10.407218828823948, 8.595651070053696, 10.279477613176992, 9.517347583635457, 1.7714973812870556, 7.091240421045978, 8.82272888217294, 9.023408952599395, 8.963815170929092, 7.142205824930301, 8.823868977165962, 6.884236128687282, 6.906579763507267, 6.760006369668925, 9.687316079612632, 5.302791336485666, 7.571828980987511, 5.229258844056363, 10.411371654129898, 11.458031008632954, 5.224139304362303, 7.050756663431978, 6.862837325265559, 4.887481474946714, 4.85344837269657, 6.835695504155249], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.770628270971646, "mean_inference_ms": 8.158547061009106, "mean_action_processing_ms": 0.5476328206523435, "mean_env_wait_ms": 24.192736028842656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042046308517456055, "StateBufferConnector_ms": 0.03403925895690918, "ViewRequirementAgentConnector_ms": 0.953599214553833}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8040018, "num_agent_steps_trained": 8040018, "num_env_steps_sampled": 8040018, "num_env_steps_trained": 8040018, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 274.7712032888563, "num_env_steps_trained_throughput_per_sec": 274.7712032888563, "timesteps_total": 8040018, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8040018, "timers": {"training_iteration_time_ms": 56323.84, "sample_time_ms": 43068.213, "load_time_ms": 1808.428, "load_throughput": 8647.29, "learn_time_ms": 10876.883, "learn_throughput": 1437.728, "synch_weights_time_ms": 451.574}, "counters": {"num_env_steps_sampled": 8040018, "num_env_steps_trained": 8040018, "num_agent_steps_sampled": 8040018, "num_agent_steps_trained": 8040018}, "done": false, "episodes_total": 2394, "training_iteration": 519, "trial_id": "2f030_00000", "date": "2025-06-07_10-17-57", "timestamp": 1749284277, "time_this_iter_s": 56.929325342178345, "time_total_s": 9684.117569684982, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9684.117569684982, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 77.8, "ram_util_percent": 70.53846153846153, "gpu_util_percent0": 0.07861538461538461, "vram_util_percent0": 0.8592122395833333}}
{"evaluation": {"sampler_results": {"episode_reward_max": -2.1999160005295217, "episode_reward_min": -8.10649385402145, "episode_reward_mean": -4.5342597876050315, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.823254223293332, -5.100368344255001, -2.4412665159258506, -8.10649385402145, -2.1999160005295217], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4377450116640502, "mean_inference_ms": 3.8819489405067507, "mean_action_processing_ms": 0.27796358498144347, "mean_env_wait_ms": 10.462197493861877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.020008087158203125, "ViewRequirementAgentConnector_ms": 0.21012306213378906}}, "episode_reward_max": -2.1999160005295217, "episode_reward_min": -8.10649385402145, "episode_reward_mean": -4.5342597876050315, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.823254223293332, -5.100368344255001, -2.4412665159258506, -8.10649385402145, -2.1999160005295217], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4377450116640502, "mean_inference_ms": 3.8819489405067507, "mean_action_processing_ms": 0.27796358498144347, "mean_env_wait_ms": 10.462197493861877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.020008087158203125, "ViewRequirementAgentConnector_ms": 0.21012306213378906}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.547354210526316e-05, "total_loss": -0.06762027016121216, "policy_loss": -0.03897746037136213, "vf_loss": 0.01394540181806819, "vf_explained_var": 0.7430945280465213, "kl": 0.010841554376979316, "entropy": 20.2723418339816, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 94325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8055656, "num_env_steps_trained": 8055656, "num_agent_steps_sampled": 8055656, "num_agent_steps_trained": 8055656}, "sampler_results": {"episode_reward_max": 11.807643477698468, "episode_reward_min": 1.2359426655995218, "episode_reward_mean": 7.3402277234462385, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.304264682628591, 8.446191292652843, 5.430953574763245, 6.112849959003759, 1.2359426655995218, 2.2645257440398576, 7.557125424002972, 4.607041521856852, 8.907627370477064, 10.536763003592199, 10.934993872186979, 8.874710569811429, 8.520029902075274, 8.936426908143696, 7.84198717827472, 5.518101065499396, 7.198224549731057, 9.561995035535892, 5.74682017239092, 10.843665065943762, 8.762536650935171, 6.770672716289705, 3.93261122327548, 8.98413616167669, 4.216172642051082, 5.537762042846417, 7.407398053242417, 7.696068917993802, 7.806693025264661, 3.6504223025554667, 5.417782338877194, 1.330919671807573, 9.08935222184077, 9.210520899257823, 8.762750703337048, 11.807643477698468, 2.922413538435434, 5.489401331047108, 7.814855193852197, 9.502269926065345, 4.52024360113992, 3.5102386787063145, 7.266434783737127, 6.790748492483357, 9.240553107608935, 4.861418011210646, 11.130642241734769, 3.210938366698568, 6.996163186507471, 10.134699916737322, 7.2853729725735095, 8.321843190026579, 7.887939899823732, 6.174182892065922, 6.04437682218247, 11.736807629401843, 10.142319383741496, 6.553365192937448, 6.312519505095439, 8.548402373579309, 10.407218828823948, 8.595651070053696, 10.279477613176992, 9.517347583635457, 1.7714973812870556, 7.091240421045978, 8.82272888217294, 9.023408952599395, 8.963815170929092, 7.142205824930301, 8.823868977165962, 6.884236128687282, 6.906579763507267, 6.760006369668925, 9.687316079612632, 5.302791336485666, 7.571828980987511, 5.229258844056363, 10.411371654129898, 11.458031008632954, 5.224139304362303, 7.050756663431978, 6.862837325265559, 4.887481474946714, 4.85344837269657, 6.835695504155249, 8.326526312918261, 5.364703080840593, 9.467932268435593, 3.780771843119014, 9.392293455794798, 2.1534741254027017, 11.122062164708419, 7.6783873893910455, 8.609325588469218, 9.187493476009731, 8.170891620487549, 9.39273550278773, 9.636680012744106, 7.213423142515403], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.769538630370135, "mean_inference_ms": 8.160002892255, "mean_action_processing_ms": 0.5477488877897647, "mean_env_wait_ms": 24.196610435643247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04199576377868652, "StateBufferConnector_ms": 0.0290071964263916, "ViewRequirementAgentConnector_ms": 0.9257657527923584}}, "episode_reward_max": 11.807643477698468, "episode_reward_min": 1.2359426655995218, "episode_reward_mean": 7.3402277234462385, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.304264682628591, 8.446191292652843, 5.430953574763245, 6.112849959003759, 1.2359426655995218, 2.2645257440398576, 7.557125424002972, 4.607041521856852, 8.907627370477064, 10.536763003592199, 10.934993872186979, 8.874710569811429, 8.520029902075274, 8.936426908143696, 7.84198717827472, 5.518101065499396, 7.198224549731057, 9.561995035535892, 5.74682017239092, 10.843665065943762, 8.762536650935171, 6.770672716289705, 3.93261122327548, 8.98413616167669, 4.216172642051082, 5.537762042846417, 7.407398053242417, 7.696068917993802, 7.806693025264661, 3.6504223025554667, 5.417782338877194, 1.330919671807573, 9.08935222184077, 9.210520899257823, 8.762750703337048, 11.807643477698468, 2.922413538435434, 5.489401331047108, 7.814855193852197, 9.502269926065345, 4.52024360113992, 3.5102386787063145, 7.266434783737127, 6.790748492483357, 9.240553107608935, 4.861418011210646, 11.130642241734769, 3.210938366698568, 6.996163186507471, 10.134699916737322, 7.2853729725735095, 8.321843190026579, 7.887939899823732, 6.174182892065922, 6.04437682218247, 11.736807629401843, 10.142319383741496, 6.553365192937448, 6.312519505095439, 8.548402373579309, 10.407218828823948, 8.595651070053696, 10.279477613176992, 9.517347583635457, 1.7714973812870556, 7.091240421045978, 8.82272888217294, 9.023408952599395, 8.963815170929092, 7.142205824930301, 8.823868977165962, 6.884236128687282, 6.906579763507267, 6.760006369668925, 9.687316079612632, 5.302791336485666, 7.571828980987511, 5.229258844056363, 10.411371654129898, 11.458031008632954, 5.224139304362303, 7.050756663431978, 6.862837325265559, 4.887481474946714, 4.85344837269657, 6.835695504155249, 8.326526312918261, 5.364703080840593, 9.467932268435593, 3.780771843119014, 9.392293455794798, 2.1534741254027017, 11.122062164708419, 7.6783873893910455, 8.609325588469218, 9.187493476009731, 8.170891620487549, 9.39273550278773, 9.636680012744106, 7.213423142515403], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.769538630370135, "mean_inference_ms": 8.160002892255, "mean_action_processing_ms": 0.5477488877897647, "mean_env_wait_ms": 24.196610435643247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04199576377868652, "StateBufferConnector_ms": 0.0290071964263916, "ViewRequirementAgentConnector_ms": 0.9257657527923584}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8055656, "num_agent_steps_trained": 8055656, "num_env_steps_sampled": 8055656, "num_env_steps_trained": 8055656, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.0754833542492, "num_env_steps_trained_throughput_per_sec": 280.0754833542492, "timesteps_total": 8055656, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8055656, "timers": {"training_iteration_time_ms": 56298.119, "sample_time_ms": 43011.31, "load_time_ms": 1810.979, "load_throughput": 8635.107, "learn_time_ms": 10904.698, "learn_throughput": 1434.061, "synch_weights_time_ms": 453.886}, "counters": {"num_env_steps_sampled": 8055656, "num_env_steps_trained": 8055656, "num_agent_steps_sampled": 8055656, "num_agent_steps_trained": 8055656}, "done": false, "episodes_total": 2408, "training_iteration": 520, "trial_id": "2f030_00000", "date": "2025-06-07_10-19-08", "timestamp": 1749284348, "time_this_iter_s": 71.17894387245178, "time_total_s": 9755.296513557434, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9755.296513557434, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 65.16626506024096, "ram_util_percent": 70.65421686746987, "gpu_util_percent0": 0.0616867469879518, "vram_util_percent0": 0.859212239583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.535008421052632e-05, "total_loss": -0.06006712844806977, "policy_loss": -0.031580798973816195, "vf_loss": 0.013167874661528252, "vf_explained_var": 0.7363595329631458, "kl": 0.011313047464606799, "entropy": 20.24530424638228, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 94875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8071294, "num_env_steps_trained": 8071294, "num_agent_steps_sampled": 8071294, "num_agent_steps_trained": 8071294}, "sampler_results": {"episode_reward_max": 11.807643477698468, "episode_reward_min": 1.330919671807573, "episode_reward_mean": 7.451109566128542, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.84198717827472, 5.518101065499396, 7.198224549731057, 9.561995035535892, 5.74682017239092, 10.843665065943762, 8.762536650935171, 6.770672716289705, 3.93261122327548, 8.98413616167669, 4.216172642051082, 5.537762042846417, 7.407398053242417, 7.696068917993802, 7.806693025264661, 3.6504223025554667, 5.417782338877194, 1.330919671807573, 9.08935222184077, 9.210520899257823, 8.762750703337048, 11.807643477698468, 2.922413538435434, 5.489401331047108, 7.814855193852197, 9.502269926065345, 4.52024360113992, 3.5102386787063145, 7.266434783737127, 6.790748492483357, 9.240553107608935, 4.861418011210646, 11.130642241734769, 3.210938366698568, 6.996163186507471, 10.134699916737322, 7.2853729725735095, 8.321843190026579, 7.887939899823732, 6.174182892065922, 6.04437682218247, 11.736807629401843, 10.142319383741496, 6.553365192937448, 6.312519505095439, 8.548402373579309, 10.407218828823948, 8.595651070053696, 10.279477613176992, 9.517347583635457, 1.7714973812870556, 7.091240421045978, 8.82272888217294, 9.023408952599395, 8.963815170929092, 7.142205824930301, 8.823868977165962, 6.884236128687282, 6.906579763507267, 6.760006369668925, 9.687316079612632, 5.302791336485666, 7.571828980987511, 5.229258844056363, 10.411371654129898, 11.458031008632954, 5.224139304362303, 7.050756663431978, 6.862837325265559, 4.887481474946714, 4.85344837269657, 6.835695504155249, 8.326526312918261, 5.364703080840593, 9.467932268435593, 3.780771843119014, 9.392293455794798, 2.1534741254027017, 11.122062164708419, 7.6783873893910455, 8.609325588469218, 9.187493476009731, 8.170891620487549, 9.39273550278773, 9.636680012744106, 7.213423142515403, 10.015622638255616, 10.651232850232052, 8.311026093666861, 7.865171481449868, 5.279450312064873, 7.640977322426036, 8.297321170034365, 8.247799049839296, 5.973157472272415, 5.50786318644563, 8.215495679896653, 11.17873021369023, 6.673412204651835, 5.900371084138949], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7686502626811937, "mean_inference_ms": 8.161327213363023, "mean_action_processing_ms": 0.5478439427937869, "mean_env_wait_ms": 24.200071493613255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03904891014099121, "StateBufferConnector_ms": 0.025089740753173828, "ViewRequirementAgentConnector_ms": 0.9358305931091309}}, "episode_reward_max": 11.807643477698468, "episode_reward_min": 1.330919671807573, "episode_reward_mean": 7.451109566128542, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.84198717827472, 5.518101065499396, 7.198224549731057, 9.561995035535892, 5.74682017239092, 10.843665065943762, 8.762536650935171, 6.770672716289705, 3.93261122327548, 8.98413616167669, 4.216172642051082, 5.537762042846417, 7.407398053242417, 7.696068917993802, 7.806693025264661, 3.6504223025554667, 5.417782338877194, 1.330919671807573, 9.08935222184077, 9.210520899257823, 8.762750703337048, 11.807643477698468, 2.922413538435434, 5.489401331047108, 7.814855193852197, 9.502269926065345, 4.52024360113992, 3.5102386787063145, 7.266434783737127, 6.790748492483357, 9.240553107608935, 4.861418011210646, 11.130642241734769, 3.210938366698568, 6.996163186507471, 10.134699916737322, 7.2853729725735095, 8.321843190026579, 7.887939899823732, 6.174182892065922, 6.04437682218247, 11.736807629401843, 10.142319383741496, 6.553365192937448, 6.312519505095439, 8.548402373579309, 10.407218828823948, 8.595651070053696, 10.279477613176992, 9.517347583635457, 1.7714973812870556, 7.091240421045978, 8.82272888217294, 9.023408952599395, 8.963815170929092, 7.142205824930301, 8.823868977165962, 6.884236128687282, 6.906579763507267, 6.760006369668925, 9.687316079612632, 5.302791336485666, 7.571828980987511, 5.229258844056363, 10.411371654129898, 11.458031008632954, 5.224139304362303, 7.050756663431978, 6.862837325265559, 4.887481474946714, 4.85344837269657, 6.835695504155249, 8.326526312918261, 5.364703080840593, 9.467932268435593, 3.780771843119014, 9.392293455794798, 2.1534741254027017, 11.122062164708419, 7.6783873893910455, 8.609325588469218, 9.187493476009731, 8.170891620487549, 9.39273550278773, 9.636680012744106, 7.213423142515403, 10.015622638255616, 10.651232850232052, 8.311026093666861, 7.865171481449868, 5.279450312064873, 7.640977322426036, 8.297321170034365, 8.247799049839296, 5.973157472272415, 5.50786318644563, 8.215495679896653, 11.17873021369023, 6.673412204651835, 5.900371084138949], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7686502626811937, "mean_inference_ms": 8.161327213363023, "mean_action_processing_ms": 0.5478439427937869, "mean_env_wait_ms": 24.200071493613255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03904891014099121, "StateBufferConnector_ms": 0.025089740753173828, "ViewRequirementAgentConnector_ms": 0.9358305931091309}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8071294, "num_agent_steps_trained": 8071294, "num_env_steps_sampled": 8071294, "num_env_steps_trained": 8071294, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.0873829512283, "num_env_steps_trained_throughput_per_sec": 281.0873829512283, "timesteps_total": 8071294, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8071294, "timers": {"training_iteration_time_ms": 56194.11, "sample_time_ms": 42931.12, "load_time_ms": 1791.219, "load_throughput": 8730.365, "learn_time_ms": 10907.177, "learn_throughput": 1433.735, "synch_weights_time_ms": 448.426}, "counters": {"num_env_steps_sampled": 8071294, "num_env_steps_trained": 8071294, "num_agent_steps_sampled": 8071294, "num_agent_steps_trained": 8071294}, "done": false, "episodes_total": 2422, "training_iteration": 521, "trial_id": "2f030_00000", "date": "2025-06-07_10-20-04", "timestamp": 1749284404, "time_this_iter_s": 55.65393567085266, "time_total_s": 9810.950449228287, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9810.950449228287, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 77.98095238095237, "ram_util_percent": 70.94920634920632, "gpu_util_percent0": 0.08111111111111112, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.522662631578948e-05, "total_loss": -0.052422135375778785, "policy_loss": -0.0242596538078661, "vf_loss": 0.016171752185645427, "vf_explained_var": 0.7206877540458333, "kl": 0.010842808993886469, "entropy": 20.366576333479447, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 95425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8086932, "num_env_steps_trained": 8086932, "num_agent_steps_sampled": 8086932, "num_agent_steps_trained": 8086932}, "sampler_results": {"episode_reward_max": 11.807643477698468, "episode_reward_min": 1.330919671807573, "episode_reward_mean": 7.441795323021693, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.806693025264661, 3.6504223025554667, 5.417782338877194, 1.330919671807573, 9.08935222184077, 9.210520899257823, 8.762750703337048, 11.807643477698468, 2.922413538435434, 5.489401331047108, 7.814855193852197, 9.502269926065345, 4.52024360113992, 3.5102386787063145, 7.266434783737127, 6.790748492483357, 9.240553107608935, 4.861418011210646, 11.130642241734769, 3.210938366698568, 6.996163186507471, 10.134699916737322, 7.2853729725735095, 8.321843190026579, 7.887939899823732, 6.174182892065922, 6.04437682218247, 11.736807629401843, 10.142319383741496, 6.553365192937448, 6.312519505095439, 8.548402373579309, 10.407218828823948, 8.595651070053696, 10.279477613176992, 9.517347583635457, 1.7714973812870556, 7.091240421045978, 8.82272888217294, 9.023408952599395, 8.963815170929092, 7.142205824930301, 8.823868977165962, 6.884236128687282, 6.906579763507267, 6.760006369668925, 9.687316079612632, 5.302791336485666, 7.571828980987511, 5.229258844056363, 10.411371654129898, 11.458031008632954, 5.224139304362303, 7.050756663431978, 6.862837325265559, 4.887481474946714, 4.85344837269657, 6.835695504155249, 8.326526312918261, 5.364703080840593, 9.467932268435593, 3.780771843119014, 9.392293455794798, 2.1534741254027017, 11.122062164708419, 7.6783873893910455, 8.609325588469218, 9.187493476009731, 8.170891620487549, 9.39273550278773, 9.636680012744106, 7.213423142515403, 10.015622638255616, 10.651232850232052, 8.311026093666861, 7.865171481449868, 5.279450312064873, 7.640977322426036, 8.297321170034365, 8.247799049839296, 5.973157472272415, 5.50786318644563, 8.215495679896653, 11.17873021369023, 6.673412204651835, 5.900371084138949, 10.138930402976142, 4.7501566770725505, 9.899083353355506, 7.165805177519585, 5.607274591642902, 5.979880311009209, 8.581402439666723, 2.916935184850543, 10.649078641806119, 9.186607403803464, 6.17549975407249, 4.75043155652941, 8.384178748059572, 4.901462922637251], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7676055420453274, "mean_inference_ms": 8.162921858290135, "mean_action_processing_ms": 0.5479412832657938, "mean_env_wait_ms": 24.20410571420333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0371546745300293, "StateBufferConnector_ms": 0.021121978759765625, "ViewRequirementAgentConnector_ms": 0.9426746368408203}}, "episode_reward_max": 11.807643477698468, "episode_reward_min": 1.330919671807573, "episode_reward_mean": 7.441795323021693, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.806693025264661, 3.6504223025554667, 5.417782338877194, 1.330919671807573, 9.08935222184077, 9.210520899257823, 8.762750703337048, 11.807643477698468, 2.922413538435434, 5.489401331047108, 7.814855193852197, 9.502269926065345, 4.52024360113992, 3.5102386787063145, 7.266434783737127, 6.790748492483357, 9.240553107608935, 4.861418011210646, 11.130642241734769, 3.210938366698568, 6.996163186507471, 10.134699916737322, 7.2853729725735095, 8.321843190026579, 7.887939899823732, 6.174182892065922, 6.04437682218247, 11.736807629401843, 10.142319383741496, 6.553365192937448, 6.312519505095439, 8.548402373579309, 10.407218828823948, 8.595651070053696, 10.279477613176992, 9.517347583635457, 1.7714973812870556, 7.091240421045978, 8.82272888217294, 9.023408952599395, 8.963815170929092, 7.142205824930301, 8.823868977165962, 6.884236128687282, 6.906579763507267, 6.760006369668925, 9.687316079612632, 5.302791336485666, 7.571828980987511, 5.229258844056363, 10.411371654129898, 11.458031008632954, 5.224139304362303, 7.050756663431978, 6.862837325265559, 4.887481474946714, 4.85344837269657, 6.835695504155249, 8.326526312918261, 5.364703080840593, 9.467932268435593, 3.780771843119014, 9.392293455794798, 2.1534741254027017, 11.122062164708419, 7.6783873893910455, 8.609325588469218, 9.187493476009731, 8.170891620487549, 9.39273550278773, 9.636680012744106, 7.213423142515403, 10.015622638255616, 10.651232850232052, 8.311026093666861, 7.865171481449868, 5.279450312064873, 7.640977322426036, 8.297321170034365, 8.247799049839296, 5.973157472272415, 5.50786318644563, 8.215495679896653, 11.17873021369023, 6.673412204651835, 5.900371084138949, 10.138930402976142, 4.7501566770725505, 9.899083353355506, 7.165805177519585, 5.607274591642902, 5.979880311009209, 8.581402439666723, 2.916935184850543, 10.649078641806119, 9.186607403803464, 6.17549975407249, 4.75043155652941, 8.384178748059572, 4.901462922637251], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7676055420453274, "mean_inference_ms": 8.162921858290135, "mean_action_processing_ms": 0.5479412832657938, "mean_env_wait_ms": 24.20410571420333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0371546745300293, "StateBufferConnector_ms": 0.021121978759765625, "ViewRequirementAgentConnector_ms": 0.9426746368408203}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8086932, "num_agent_steps_trained": 8086932, "num_env_steps_sampled": 8086932, "num_env_steps_trained": 8086932, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 273.7032314949598, "num_env_steps_trained_throughput_per_sec": 273.7032314949598, "timesteps_total": 8086932, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8086932, "timers": {"training_iteration_time_ms": 56302.138, "sample_time_ms": 43021.489, "load_time_ms": 1812.658, "load_throughput": 8627.109, "learn_time_ms": 10904.792, "learn_throughput": 1434.048, "synch_weights_time_ms": 447.835}, "counters": {"num_env_steps_sampled": 8086932, "num_env_steps_trained": 8086932, "num_agent_steps_sampled": 8086932, "num_agent_steps_trained": 8086932}, "done": false, "episodes_total": 2436, "training_iteration": 522, "trial_id": "2f030_00000", "date": "2025-06-07_10-21-01", "timestamp": 1749284461, "time_this_iter_s": 57.14887619018555, "time_total_s": 9868.099325418472, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9868.099325418472, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 78.80615384615385, "ram_util_percent": 70.93846153846154, "gpu_util_percent0": 0.08153846153846153, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.5103168421052636e-05, "total_loss": -0.03748267568859526, "policy_loss": -0.009729876322274901, "vf_loss": 0.01521663229489191, "vf_explained_var": 0.759957260652022, "kl": 0.011732326634336642, "entropy": 20.335097732543947, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 95975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8102570, "num_env_steps_trained": 8102570, "num_agent_steps_sampled": 8102570, "num_agent_steps_trained": 8102570}, "sampler_results": {"episode_reward_max": 11.736807629401843, "episode_reward_min": 1.7714973812870556, "episode_reward_mean": 7.5285208287552186, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.266434783737127, 6.790748492483357, 9.240553107608935, 4.861418011210646, 11.130642241734769, 3.210938366698568, 6.996163186507471, 10.134699916737322, 7.2853729725735095, 8.321843190026579, 7.887939899823732, 6.174182892065922, 6.04437682218247, 11.736807629401843, 10.142319383741496, 6.553365192937448, 6.312519505095439, 8.548402373579309, 10.407218828823948, 8.595651070053696, 10.279477613176992, 9.517347583635457, 1.7714973812870556, 7.091240421045978, 8.82272888217294, 9.023408952599395, 8.963815170929092, 7.142205824930301, 8.823868977165962, 6.884236128687282, 6.906579763507267, 6.760006369668925, 9.687316079612632, 5.302791336485666, 7.571828980987511, 5.229258844056363, 10.411371654129898, 11.458031008632954, 5.224139304362303, 7.050756663431978, 6.862837325265559, 4.887481474946714, 4.85344837269657, 6.835695504155249, 8.326526312918261, 5.364703080840593, 9.467932268435593, 3.780771843119014, 9.392293455794798, 2.1534741254027017, 11.122062164708419, 7.6783873893910455, 8.609325588469218, 9.187493476009731, 8.170891620487549, 9.39273550278773, 9.636680012744106, 7.213423142515403, 10.015622638255616, 10.651232850232052, 8.311026093666861, 7.865171481449868, 5.279450312064873, 7.640977322426036, 8.297321170034365, 8.247799049839296, 5.973157472272415, 5.50786318644563, 8.215495679896653, 11.17873021369023, 6.673412204651835, 5.900371084138949, 10.138930402976142, 4.7501566770725505, 9.899083353355506, 7.165805177519585, 5.607274591642902, 5.979880311009209, 8.581402439666723, 2.916935184850543, 10.649078641806119, 9.186607403803464, 6.17549975407249, 4.75043155652941, 8.384178748059572, 4.901462922637251, 10.185551653103259, 6.593413927873839, 6.790475425635961, 8.757258627095014, 4.975179115685918, 4.968800431749303, 4.702071860940537, 8.824428874465143, 5.757162569955821, 8.304345177029605, 9.027279209327194, 5.854646496495562, 5.916272054769885, 8.851172059110898], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7666404467253245, "mean_inference_ms": 8.164487047644354, "mean_action_processing_ms": 0.5480365527036836, "mean_env_wait_ms": 24.207536084983047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032697200775146484, "StateBufferConnector_ms": 0.02213144302368164, "ViewRequirementAgentConnector_ms": 0.9301049709320068}}, "episode_reward_max": 11.736807629401843, "episode_reward_min": 1.7714973812870556, "episode_reward_mean": 7.5285208287552186, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.266434783737127, 6.790748492483357, 9.240553107608935, 4.861418011210646, 11.130642241734769, 3.210938366698568, 6.996163186507471, 10.134699916737322, 7.2853729725735095, 8.321843190026579, 7.887939899823732, 6.174182892065922, 6.04437682218247, 11.736807629401843, 10.142319383741496, 6.553365192937448, 6.312519505095439, 8.548402373579309, 10.407218828823948, 8.595651070053696, 10.279477613176992, 9.517347583635457, 1.7714973812870556, 7.091240421045978, 8.82272888217294, 9.023408952599395, 8.963815170929092, 7.142205824930301, 8.823868977165962, 6.884236128687282, 6.906579763507267, 6.760006369668925, 9.687316079612632, 5.302791336485666, 7.571828980987511, 5.229258844056363, 10.411371654129898, 11.458031008632954, 5.224139304362303, 7.050756663431978, 6.862837325265559, 4.887481474946714, 4.85344837269657, 6.835695504155249, 8.326526312918261, 5.364703080840593, 9.467932268435593, 3.780771843119014, 9.392293455794798, 2.1534741254027017, 11.122062164708419, 7.6783873893910455, 8.609325588469218, 9.187493476009731, 8.170891620487549, 9.39273550278773, 9.636680012744106, 7.213423142515403, 10.015622638255616, 10.651232850232052, 8.311026093666861, 7.865171481449868, 5.279450312064873, 7.640977322426036, 8.297321170034365, 8.247799049839296, 5.973157472272415, 5.50786318644563, 8.215495679896653, 11.17873021369023, 6.673412204651835, 5.900371084138949, 10.138930402976142, 4.7501566770725505, 9.899083353355506, 7.165805177519585, 5.607274591642902, 5.979880311009209, 8.581402439666723, 2.916935184850543, 10.649078641806119, 9.186607403803464, 6.17549975407249, 4.75043155652941, 8.384178748059572, 4.901462922637251, 10.185551653103259, 6.593413927873839, 6.790475425635961, 8.757258627095014, 4.975179115685918, 4.968800431749303, 4.702071860940537, 8.824428874465143, 5.757162569955821, 8.304345177029605, 9.027279209327194, 5.854646496495562, 5.916272054769885, 8.851172059110898], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7666404467253245, "mean_inference_ms": 8.164487047644354, "mean_action_processing_ms": 0.5480365527036836, "mean_env_wait_ms": 24.207536084983047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032697200775146484, "StateBufferConnector_ms": 0.02213144302368164, "ViewRequirementAgentConnector_ms": 0.9301049709320068}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8102570, "num_agent_steps_trained": 8102570, "num_env_steps_sampled": 8102570, "num_env_steps_trained": 8102570, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 277.69011379809643, "num_env_steps_trained_throughput_per_sec": 277.69011379809643, "timesteps_total": 8102570, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8102570, "timers": {"training_iteration_time_ms": 56319.154, "sample_time_ms": 43010.499, "load_time_ms": 1807.547, "load_throughput": 8651.503, "learn_time_ms": 10937.603, "learn_throughput": 1429.747, "synch_weights_time_ms": 446.736}, "counters": {"num_env_steps_sampled": 8102570, "num_env_steps_trained": 8102570, "num_agent_steps_sampled": 8102570, "num_agent_steps_trained": 8102570}, "done": false, "episodes_total": 2450, "training_iteration": 523, "trial_id": "2f030_00000", "date": "2025-06-07_10-21-58", "timestamp": 1749284518, "time_this_iter_s": 56.3315908908844, "time_total_s": 9924.430916309357, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9924.430916309357, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 78.0703125, "ram_util_percent": 71.090625, "gpu_util_percent0": 0.076875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.4979710526315794e-05, "total_loss": -0.05376089795069261, "policy_loss": -0.025274118750742425, "vf_loss": 0.01499777296981351, "vf_explained_var": 0.7535266214067285, "kl": 0.010880654255266894, "entropy": 20.366100052920256, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 96525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8118208, "num_env_steps_trained": 8118208, "num_agent_steps_sampled": 8118208, "num_agent_steps_trained": 8118208}, "sampler_results": {"episode_reward_max": 11.458031008632954, "episode_reward_min": 1.7714973812870556, "episode_reward_mean": 7.437180793183126, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.142319383741496, 6.553365192937448, 6.312519505095439, 8.548402373579309, 10.407218828823948, 8.595651070053696, 10.279477613176992, 9.517347583635457, 1.7714973812870556, 7.091240421045978, 8.82272888217294, 9.023408952599395, 8.963815170929092, 7.142205824930301, 8.823868977165962, 6.884236128687282, 6.906579763507267, 6.760006369668925, 9.687316079612632, 5.302791336485666, 7.571828980987511, 5.229258844056363, 10.411371654129898, 11.458031008632954, 5.224139304362303, 7.050756663431978, 6.862837325265559, 4.887481474946714, 4.85344837269657, 6.835695504155249, 8.326526312918261, 5.364703080840593, 9.467932268435593, 3.780771843119014, 9.392293455794798, 2.1534741254027017, 11.122062164708419, 7.6783873893910455, 8.609325588469218, 9.187493476009731, 8.170891620487549, 9.39273550278773, 9.636680012744106, 7.213423142515403, 10.015622638255616, 10.651232850232052, 8.311026093666861, 7.865171481449868, 5.279450312064873, 7.640977322426036, 8.297321170034365, 8.247799049839296, 5.973157472272415, 5.50786318644563, 8.215495679896653, 11.17873021369023, 6.673412204651835, 5.900371084138949, 10.138930402976142, 4.7501566770725505, 9.899083353355506, 7.165805177519585, 5.607274591642902, 5.979880311009209, 8.581402439666723, 2.916935184850543, 10.649078641806119, 9.186607403803464, 6.17549975407249, 4.75043155652941, 8.384178748059572, 4.901462922637251, 10.185551653103259, 6.593413927873839, 6.790475425635961, 8.757258627095014, 4.975179115685918, 4.968800431749303, 4.702071860940537, 8.824428874465143, 5.757162569955821, 8.304345177029605, 9.027279209327194, 5.854646496495562, 5.916272054769885, 8.851172059110898, 5.8140966520240305, 5.893244646694268, 6.796129368282887, 4.921734821653139, 9.91805423972514, 7.371965667302368, 8.007467397061307, 7.129089379557762, 8.072431233461115, 9.108541971814299, 6.574738911300241, 2.5557310643448643, 7.228410706718916, 8.556481895642733], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.765779520604042, "mean_inference_ms": 8.166075608533303, "mean_action_processing_ms": 0.5481264213248298, "mean_env_wait_ms": 24.210852573289785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032624244689941406, "StateBufferConnector_ms": 0.018166065216064453, "ViewRequirementAgentConnector_ms": 0.9318115711212158}}, "episode_reward_max": 11.458031008632954, "episode_reward_min": 1.7714973812870556, "episode_reward_mean": 7.437180793183126, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.142319383741496, 6.553365192937448, 6.312519505095439, 8.548402373579309, 10.407218828823948, 8.595651070053696, 10.279477613176992, 9.517347583635457, 1.7714973812870556, 7.091240421045978, 8.82272888217294, 9.023408952599395, 8.963815170929092, 7.142205824930301, 8.823868977165962, 6.884236128687282, 6.906579763507267, 6.760006369668925, 9.687316079612632, 5.302791336485666, 7.571828980987511, 5.229258844056363, 10.411371654129898, 11.458031008632954, 5.224139304362303, 7.050756663431978, 6.862837325265559, 4.887481474946714, 4.85344837269657, 6.835695504155249, 8.326526312918261, 5.364703080840593, 9.467932268435593, 3.780771843119014, 9.392293455794798, 2.1534741254027017, 11.122062164708419, 7.6783873893910455, 8.609325588469218, 9.187493476009731, 8.170891620487549, 9.39273550278773, 9.636680012744106, 7.213423142515403, 10.015622638255616, 10.651232850232052, 8.311026093666861, 7.865171481449868, 5.279450312064873, 7.640977322426036, 8.297321170034365, 8.247799049839296, 5.973157472272415, 5.50786318644563, 8.215495679896653, 11.17873021369023, 6.673412204651835, 5.900371084138949, 10.138930402976142, 4.7501566770725505, 9.899083353355506, 7.165805177519585, 5.607274591642902, 5.979880311009209, 8.581402439666723, 2.916935184850543, 10.649078641806119, 9.186607403803464, 6.17549975407249, 4.75043155652941, 8.384178748059572, 4.901462922637251, 10.185551653103259, 6.593413927873839, 6.790475425635961, 8.757258627095014, 4.975179115685918, 4.968800431749303, 4.702071860940537, 8.824428874465143, 5.757162569955821, 8.304345177029605, 9.027279209327194, 5.854646496495562, 5.916272054769885, 8.851172059110898, 5.8140966520240305, 5.893244646694268, 6.796129368282887, 4.921734821653139, 9.91805423972514, 7.371965667302368, 8.007467397061307, 7.129089379557762, 8.072431233461115, 9.108541971814299, 6.574738911300241, 2.5557310643448643, 7.228410706718916, 8.556481895642733], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.765779520604042, "mean_inference_ms": 8.166075608533303, "mean_action_processing_ms": 0.5481264213248298, "mean_env_wait_ms": 24.210852573289785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032624244689941406, "StateBufferConnector_ms": 0.018166065216064453, "ViewRequirementAgentConnector_ms": 0.9318115711212158}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8118208, "num_agent_steps_trained": 8118208, "num_env_steps_sampled": 8118208, "num_env_steps_trained": 8118208, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 273.7981555477803, "num_env_steps_trained_throughput_per_sec": 273.7981555477803, "timesteps_total": 8118208, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8118208, "timers": {"training_iteration_time_ms": 56393.258, "sample_time_ms": 43058.842, "load_time_ms": 1827.923, "load_throughput": 8555.066, "learn_time_ms": 10949.373, "learn_throughput": 1428.21, "synch_weights_time_ms": 440.554}, "counters": {"num_env_steps_sampled": 8118208, "num_env_steps_trained": 8118208, "num_agent_steps_sampled": 8118208, "num_agent_steps_trained": 8118208}, "done": false, "episodes_total": 2464, "training_iteration": 524, "trial_id": "2f030_00000", "date": "2025-06-07_10-22-55", "timestamp": 1749284575, "time_this_iter_s": 57.23761701583862, "time_total_s": 9981.668533325195, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9981.668533325195, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 77.87999999999998, "ram_util_percent": 71.0753846153846, "gpu_util_percent0": 0.08307692307692306, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.485625263157895e-05, "total_loss": -0.061372580224732784, "policy_loss": -0.03318246829831465, "vf_loss": 0.015665570185096428, "vf_explained_var": 0.7272285069118847, "kl": 0.010700568128442611, "entropy": 20.253832615939054, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 97075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8133846, "num_env_steps_trained": 8133846, "num_agent_steps_sampled": 8133846, "num_agent_steps_trained": 8133846}, "sampler_results": {"episode_reward_max": 12.04913266537767, "episode_reward_min": 1.2888433107425474, "episode_reward_mean": 7.366115507439994, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.823868977165962, 6.884236128687282, 6.906579763507267, 6.760006369668925, 9.687316079612632, 5.302791336485666, 7.571828980987511, 5.229258844056363, 10.411371654129898, 11.458031008632954, 5.224139304362303, 7.050756663431978, 6.862837325265559, 4.887481474946714, 4.85344837269657, 6.835695504155249, 8.326526312918261, 5.364703080840593, 9.467932268435593, 3.780771843119014, 9.392293455794798, 2.1534741254027017, 11.122062164708419, 7.6783873893910455, 8.609325588469218, 9.187493476009731, 8.170891620487549, 9.39273550278773, 9.636680012744106, 7.213423142515403, 10.015622638255616, 10.651232850232052, 8.311026093666861, 7.865171481449868, 5.279450312064873, 7.640977322426036, 8.297321170034365, 8.247799049839296, 5.973157472272415, 5.50786318644563, 8.215495679896653, 11.17873021369023, 6.673412204651835, 5.900371084138949, 10.138930402976142, 4.7501566770725505, 9.899083353355506, 7.165805177519585, 5.607274591642902, 5.979880311009209, 8.581402439666723, 2.916935184850543, 10.649078641806119, 9.186607403803464, 6.17549975407249, 4.75043155652941, 8.384178748059572, 4.901462922637251, 10.185551653103259, 6.593413927873839, 6.790475425635961, 8.757258627095014, 4.975179115685918, 4.968800431749303, 4.702071860940537, 8.824428874465143, 5.757162569955821, 8.304345177029605, 9.027279209327194, 5.854646496495562, 5.916272054769885, 8.851172059110898, 5.8140966520240305, 5.893244646694268, 6.796129368282887, 4.921734821653139, 9.91805423972514, 7.371965667302368, 8.007467397061307, 7.129089379557762, 8.072431233461115, 9.108541971814299, 6.574738911300241, 2.5557310643448643, 7.228410706718916, 8.556481895642733, 2.9751670844444065, 8.279805656956801, 6.052766778712866, 1.2888433107425474, 8.616817732375468, 7.645531564772511, 6.731086832331713, 4.598552327752356, 7.991185672261427, 9.161022207295012, 12.04913266537767, 10.156357993539423, 11.773641194808993, 8.744758588324], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.764798166348063, "mean_inference_ms": 8.168055257004601, "mean_action_processing_ms": 0.5482370788351357, "mean_env_wait_ms": 24.215117780851816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030190706253051758, "StateBufferConnector_ms": 0.018221139907836914, "ViewRequirementAgentConnector_ms": 0.9551999568939209}}, "episode_reward_max": 12.04913266537767, "episode_reward_min": 1.2888433107425474, "episode_reward_mean": 7.366115507439994, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.823868977165962, 6.884236128687282, 6.906579763507267, 6.760006369668925, 9.687316079612632, 5.302791336485666, 7.571828980987511, 5.229258844056363, 10.411371654129898, 11.458031008632954, 5.224139304362303, 7.050756663431978, 6.862837325265559, 4.887481474946714, 4.85344837269657, 6.835695504155249, 8.326526312918261, 5.364703080840593, 9.467932268435593, 3.780771843119014, 9.392293455794798, 2.1534741254027017, 11.122062164708419, 7.6783873893910455, 8.609325588469218, 9.187493476009731, 8.170891620487549, 9.39273550278773, 9.636680012744106, 7.213423142515403, 10.015622638255616, 10.651232850232052, 8.311026093666861, 7.865171481449868, 5.279450312064873, 7.640977322426036, 8.297321170034365, 8.247799049839296, 5.973157472272415, 5.50786318644563, 8.215495679896653, 11.17873021369023, 6.673412204651835, 5.900371084138949, 10.138930402976142, 4.7501566770725505, 9.899083353355506, 7.165805177519585, 5.607274591642902, 5.979880311009209, 8.581402439666723, 2.916935184850543, 10.649078641806119, 9.186607403803464, 6.17549975407249, 4.75043155652941, 8.384178748059572, 4.901462922637251, 10.185551653103259, 6.593413927873839, 6.790475425635961, 8.757258627095014, 4.975179115685918, 4.968800431749303, 4.702071860940537, 8.824428874465143, 5.757162569955821, 8.304345177029605, 9.027279209327194, 5.854646496495562, 5.916272054769885, 8.851172059110898, 5.8140966520240305, 5.893244646694268, 6.796129368282887, 4.921734821653139, 9.91805423972514, 7.371965667302368, 8.007467397061307, 7.129089379557762, 8.072431233461115, 9.108541971814299, 6.574738911300241, 2.5557310643448643, 7.228410706718916, 8.556481895642733, 2.9751670844444065, 8.279805656956801, 6.052766778712866, 1.2888433107425474, 8.616817732375468, 7.645531564772511, 6.731086832331713, 4.598552327752356, 7.991185672261427, 9.161022207295012, 12.04913266537767, 10.156357993539423, 11.773641194808993, 8.744758588324], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.764798166348063, "mean_inference_ms": 8.168055257004601, "mean_action_processing_ms": 0.5482370788351357, "mean_env_wait_ms": 24.215117780851816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030190706253051758, "StateBufferConnector_ms": 0.018221139907836914, "ViewRequirementAgentConnector_ms": 0.9551999568939209}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8133846, "num_agent_steps_trained": 8133846, "num_env_steps_sampled": 8133846, "num_env_steps_trained": 8133846, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 268.3405048500347, "num_env_steps_trained_throughput_per_sec": 268.3405048500347, "timesteps_total": 8133846, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8133846, "timers": {"training_iteration_time_ms": 56658.814, "sample_time_ms": 43312.635, "load_time_ms": 1816.686, "load_throughput": 8607.984, "learn_time_ms": 10968.138, "learn_throughput": 1425.766, "synch_weights_time_ms": 443.895}, "counters": {"num_env_steps_sampled": 8133846, "num_env_steps_trained": 8133846, "num_agent_steps_sampled": 8133846, "num_agent_steps_trained": 8133846}, "done": false, "episodes_total": 2478, "training_iteration": 525, "trial_id": "2f030_00000", "date": "2025-06-07_10-23-53", "timestamp": 1749284633, "time_this_iter_s": 58.292691230773926, "time_total_s": 10039.96122455597, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10039.96122455597, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 79.61515151515151, "ram_util_percent": 71.20303030303033, "gpu_util_percent0": 0.07348484848484849, "vram_util_percent0": 0.8592122395833334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.473279473684212e-05, "total_loss": -0.050995166579430755, "policy_loss": -0.02282760952646971, "vf_loss": 0.015567857736552303, "vf_explained_var": 0.7555138578198173, "kl": 0.010842084761190397, "entropy": 20.278272909684613, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 97625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8149484, "num_env_steps_trained": 8149484, "num_agent_steps_sampled": 8149484, "num_agent_steps_trained": 8149484}, "sampler_results": {"episode_reward_max": 12.04913266537767, "episode_reward_min": 1.2888433107425474, "episode_reward_mean": 7.3383024471312535, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.85344837269657, 6.835695504155249, 8.326526312918261, 5.364703080840593, 9.467932268435593, 3.780771843119014, 9.392293455794798, 2.1534741254027017, 11.122062164708419, 7.6783873893910455, 8.609325588469218, 9.187493476009731, 8.170891620487549, 9.39273550278773, 9.636680012744106, 7.213423142515403, 10.015622638255616, 10.651232850232052, 8.311026093666861, 7.865171481449868, 5.279450312064873, 7.640977322426036, 8.297321170034365, 8.247799049839296, 5.973157472272415, 5.50786318644563, 8.215495679896653, 11.17873021369023, 6.673412204651835, 5.900371084138949, 10.138930402976142, 4.7501566770725505, 9.899083353355506, 7.165805177519585, 5.607274591642902, 5.979880311009209, 8.581402439666723, 2.916935184850543, 10.649078641806119, 9.186607403803464, 6.17549975407249, 4.75043155652941, 8.384178748059572, 4.901462922637251, 10.185551653103259, 6.593413927873839, 6.790475425635961, 8.757258627095014, 4.975179115685918, 4.968800431749303, 4.702071860940537, 8.824428874465143, 5.757162569955821, 8.304345177029605, 9.027279209327194, 5.854646496495562, 5.916272054769885, 8.851172059110898, 5.8140966520240305, 5.893244646694268, 6.796129368282887, 4.921734821653139, 9.91805423972514, 7.371965667302368, 8.007467397061307, 7.129089379557762, 8.072431233461115, 9.108541971814299, 6.574738911300241, 2.5557310643448643, 7.228410706718916, 8.556481895642733, 2.9751670844444065, 8.279805656956801, 6.052766778712866, 1.2888433107425474, 8.616817732375468, 7.645531564772511, 6.731086832331713, 4.598552327752356, 7.991185672261427, 9.161022207295012, 12.04913266537767, 10.156357993539423, 11.773641194808993, 8.744758588324, 7.546230152180517, 7.324574056655563, 9.461532738777366, 6.845083173094715, 6.965884338774587, 7.7386965871400175, 4.826808833852122, 10.488714006555403, 6.438363174881409, 8.561753678645776, 4.553017042681926, 8.928992969492935, 3.1362911290901, 7.463255998244576], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.76376785773952, "mean_inference_ms": 8.170116239864933, "mean_action_processing_ms": 0.5483559329808879, "mean_env_wait_ms": 24.219503950037687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03625822067260742, "StateBufferConnector_ms": 0.022275447845458984, "ViewRequirementAgentConnector_ms": 0.9427542686462402}}, "episode_reward_max": 12.04913266537767, "episode_reward_min": 1.2888433107425474, "episode_reward_mean": 7.3383024471312535, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.85344837269657, 6.835695504155249, 8.326526312918261, 5.364703080840593, 9.467932268435593, 3.780771843119014, 9.392293455794798, 2.1534741254027017, 11.122062164708419, 7.6783873893910455, 8.609325588469218, 9.187493476009731, 8.170891620487549, 9.39273550278773, 9.636680012744106, 7.213423142515403, 10.015622638255616, 10.651232850232052, 8.311026093666861, 7.865171481449868, 5.279450312064873, 7.640977322426036, 8.297321170034365, 8.247799049839296, 5.973157472272415, 5.50786318644563, 8.215495679896653, 11.17873021369023, 6.673412204651835, 5.900371084138949, 10.138930402976142, 4.7501566770725505, 9.899083353355506, 7.165805177519585, 5.607274591642902, 5.979880311009209, 8.581402439666723, 2.916935184850543, 10.649078641806119, 9.186607403803464, 6.17549975407249, 4.75043155652941, 8.384178748059572, 4.901462922637251, 10.185551653103259, 6.593413927873839, 6.790475425635961, 8.757258627095014, 4.975179115685918, 4.968800431749303, 4.702071860940537, 8.824428874465143, 5.757162569955821, 8.304345177029605, 9.027279209327194, 5.854646496495562, 5.916272054769885, 8.851172059110898, 5.8140966520240305, 5.893244646694268, 6.796129368282887, 4.921734821653139, 9.91805423972514, 7.371965667302368, 8.007467397061307, 7.129089379557762, 8.072431233461115, 9.108541971814299, 6.574738911300241, 2.5557310643448643, 7.228410706718916, 8.556481895642733, 2.9751670844444065, 8.279805656956801, 6.052766778712866, 1.2888433107425474, 8.616817732375468, 7.645531564772511, 6.731086832331713, 4.598552327752356, 7.991185672261427, 9.161022207295012, 12.04913266537767, 10.156357993539423, 11.773641194808993, 8.744758588324, 7.546230152180517, 7.324574056655563, 9.461532738777366, 6.845083173094715, 6.965884338774587, 7.7386965871400175, 4.826808833852122, 10.488714006555403, 6.438363174881409, 8.561753678645776, 4.553017042681926, 8.928992969492935, 3.1362911290901, 7.463255998244576], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.76376785773952, "mean_inference_ms": 8.170116239864933, "mean_action_processing_ms": 0.5483559329808879, "mean_env_wait_ms": 24.219503950037687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03625822067260742, "StateBufferConnector_ms": 0.022275447845458984, "ViewRequirementAgentConnector_ms": 0.9427542686462402}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8149484, "num_agent_steps_trained": 8149484, "num_env_steps_sampled": 8149484, "num_env_steps_trained": 8149484, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 273.17679732273393, "num_env_steps_trained_throughput_per_sec": 273.17679732273393, "timesteps_total": 8149484, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8149484, "timers": {"training_iteration_time_ms": 56675.014, "sample_time_ms": 43332.416, "load_time_ms": 1812.232, "load_throughput": 8629.139, "learn_time_ms": 10965.795, "learn_throughput": 1426.071, "synch_weights_time_ms": 450.663}, "counters": {"num_env_steps_sampled": 8149484, "num_env_steps_trained": 8149484, "num_agent_steps_sampled": 8149484, "num_agent_steps_trained": 8149484}, "done": false, "episodes_total": 2492, "training_iteration": 526, "trial_id": "2f030_00000", "date": "2025-06-07_10-24-51", "timestamp": 1749284691, "time_this_iter_s": 57.25451469421387, "time_total_s": 10097.215739250183, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10097.215739250183, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 79.16153846153846, "ram_util_percent": 71.2123076923077, "gpu_util_percent0": 0.07630769230769231, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.4609336842105275e-05, "total_loss": -0.05515314848119901, "policy_loss": -0.026816613206405732, "vf_loss": 0.015443269254809076, "vf_explained_var": 0.7368046857010234, "kl": 0.010566101309182572, "entropy": 20.24583483435891, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 98175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8165122, "num_env_steps_trained": 8165122, "num_agent_steps_sampled": 8165122, "num_agent_steps_trained": 8165122}, "sampler_results": {"episode_reward_max": 12.04913266537767, "episode_reward_min": 1.2888433107425474, "episode_reward_mean": 7.305499713317824, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.636680012744106, 7.213423142515403, 10.015622638255616, 10.651232850232052, 8.311026093666861, 7.865171481449868, 5.279450312064873, 7.640977322426036, 8.297321170034365, 8.247799049839296, 5.973157472272415, 5.50786318644563, 8.215495679896653, 11.17873021369023, 6.673412204651835, 5.900371084138949, 10.138930402976142, 4.7501566770725505, 9.899083353355506, 7.165805177519585, 5.607274591642902, 5.979880311009209, 8.581402439666723, 2.916935184850543, 10.649078641806119, 9.186607403803464, 6.17549975407249, 4.75043155652941, 8.384178748059572, 4.901462922637251, 10.185551653103259, 6.593413927873839, 6.790475425635961, 8.757258627095014, 4.975179115685918, 4.968800431749303, 4.702071860940537, 8.824428874465143, 5.757162569955821, 8.304345177029605, 9.027279209327194, 5.854646496495562, 5.916272054769885, 8.851172059110898, 5.8140966520240305, 5.893244646694268, 6.796129368282887, 4.921734821653139, 9.91805423972514, 7.371965667302368, 8.007467397061307, 7.129089379557762, 8.072431233461115, 9.108541971814299, 6.574738911300241, 2.5557310643448643, 7.228410706718916, 8.556481895642733, 2.9751670844444065, 8.279805656956801, 6.052766778712866, 1.2888433107425474, 8.616817732375468, 7.645531564772511, 6.731086832331713, 4.598552327752356, 7.991185672261427, 9.161022207295012, 12.04913266537767, 10.156357993539423, 11.773641194808993, 8.744758588324, 7.546230152180517, 7.324574056655563, 9.461532738777366, 6.845083173094715, 6.965884338774587, 7.7386965871400175, 4.826808833852122, 10.488714006555403, 6.438363174881409, 8.561753678645776, 4.553017042681926, 8.928992969492935, 3.1362911290901, 7.463255998244576, 9.08274069329747, 6.541096103840586, 9.04927767248719, 7.874319980655588, 8.712792871660211, 8.431582213542166, 8.954812205195275, 6.889213630934074, 2.732799720826688, 5.932018546174991, 7.314922413248356, 4.989061382989893, 8.860474413896673, 5.69035547512429], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.762799332641101, "mean_inference_ms": 8.172098432052723, "mean_action_processing_ms": 0.5484523842417783, "mean_env_wait_ms": 24.223876647315247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034265756607055664, "StateBufferConnector_ms": 0.020843505859375, "ViewRequirementAgentConnector_ms": 0.9613397121429443}}, "episode_reward_max": 12.04913266537767, "episode_reward_min": 1.2888433107425474, "episode_reward_mean": 7.305499713317824, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.636680012744106, 7.213423142515403, 10.015622638255616, 10.651232850232052, 8.311026093666861, 7.865171481449868, 5.279450312064873, 7.640977322426036, 8.297321170034365, 8.247799049839296, 5.973157472272415, 5.50786318644563, 8.215495679896653, 11.17873021369023, 6.673412204651835, 5.900371084138949, 10.138930402976142, 4.7501566770725505, 9.899083353355506, 7.165805177519585, 5.607274591642902, 5.979880311009209, 8.581402439666723, 2.916935184850543, 10.649078641806119, 9.186607403803464, 6.17549975407249, 4.75043155652941, 8.384178748059572, 4.901462922637251, 10.185551653103259, 6.593413927873839, 6.790475425635961, 8.757258627095014, 4.975179115685918, 4.968800431749303, 4.702071860940537, 8.824428874465143, 5.757162569955821, 8.304345177029605, 9.027279209327194, 5.854646496495562, 5.916272054769885, 8.851172059110898, 5.8140966520240305, 5.893244646694268, 6.796129368282887, 4.921734821653139, 9.91805423972514, 7.371965667302368, 8.007467397061307, 7.129089379557762, 8.072431233461115, 9.108541971814299, 6.574738911300241, 2.5557310643448643, 7.228410706718916, 8.556481895642733, 2.9751670844444065, 8.279805656956801, 6.052766778712866, 1.2888433107425474, 8.616817732375468, 7.645531564772511, 6.731086832331713, 4.598552327752356, 7.991185672261427, 9.161022207295012, 12.04913266537767, 10.156357993539423, 11.773641194808993, 8.744758588324, 7.546230152180517, 7.324574056655563, 9.461532738777366, 6.845083173094715, 6.965884338774587, 7.7386965871400175, 4.826808833852122, 10.488714006555403, 6.438363174881409, 8.561753678645776, 4.553017042681926, 8.928992969492935, 3.1362911290901, 7.463255998244576, 9.08274069329747, 6.541096103840586, 9.04927767248719, 7.874319980655588, 8.712792871660211, 8.431582213542166, 8.954812205195275, 6.889213630934074, 2.732799720826688, 5.932018546174991, 7.314922413248356, 4.989061382989893, 8.860474413896673, 5.69035547512429], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.762799332641101, "mean_inference_ms": 8.172098432052723, "mean_action_processing_ms": 0.5484523842417783, "mean_env_wait_ms": 24.223876647315247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034265756607055664, "StateBufferConnector_ms": 0.020843505859375, "ViewRequirementAgentConnector_ms": 0.9613397121429443}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8165122, "num_agent_steps_trained": 8165122, "num_env_steps_sampled": 8165122, "num_env_steps_trained": 8165122, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.2726171041627, "num_env_steps_trained_throughput_per_sec": 280.2726171041627, "timesteps_total": 8165122, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8165122, "timers": {"training_iteration_time_ms": 56608.63, "sample_time_ms": 43274.288, "load_time_ms": 1815.353, "load_throughput": 8614.303, "learn_time_ms": 10960.148, "learn_throughput": 1426.806, "synch_weights_time_ms": 440.701}, "counters": {"num_env_steps_sampled": 8165122, "num_env_steps_trained": 8165122, "num_agent_steps_sampled": 8165122, "num_agent_steps_trained": 8165122}, "done": false, "episodes_total": 2506, "training_iteration": 527, "trial_id": "2f030_00000", "date": "2025-06-07_10-25-47", "timestamp": 1749284747, "time_this_iter_s": 55.81269025802612, "time_total_s": 10153.02842950821, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10153.02842950821, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 77.3046875, "ram_util_percent": 70.8390625, "gpu_util_percent0": 0.0784375, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.448587894736843e-05, "total_loss": -0.05343030559195375, "policy_loss": -0.025056764730702112, "vf_loss": 0.015382021347230131, "vf_explained_var": 0.7306363413550637, "kl": 0.010766474808545106, "entropy": 20.32647519371726, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 98725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8180760, "num_env_steps_trained": 8180760, "num_agent_steps_sampled": 8180760, "num_agent_steps_trained": 8180760}, "sampler_results": {"episode_reward_max": 12.04913266537767, "episode_reward_min": 1.2888433107425474, "episode_reward_mean": 7.130497626862924, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.673412204651835, 5.900371084138949, 10.138930402976142, 4.7501566770725505, 9.899083353355506, 7.165805177519585, 5.607274591642902, 5.979880311009209, 8.581402439666723, 2.916935184850543, 10.649078641806119, 9.186607403803464, 6.17549975407249, 4.75043155652941, 8.384178748059572, 4.901462922637251, 10.185551653103259, 6.593413927873839, 6.790475425635961, 8.757258627095014, 4.975179115685918, 4.968800431749303, 4.702071860940537, 8.824428874465143, 5.757162569955821, 8.304345177029605, 9.027279209327194, 5.854646496495562, 5.916272054769885, 8.851172059110898, 5.8140966520240305, 5.893244646694268, 6.796129368282887, 4.921734821653139, 9.91805423972514, 7.371965667302368, 8.007467397061307, 7.129089379557762, 8.072431233461115, 9.108541971814299, 6.574738911300241, 2.5557310643448643, 7.228410706718916, 8.556481895642733, 2.9751670844444065, 8.279805656956801, 6.052766778712866, 1.2888433107425474, 8.616817732375468, 7.645531564772511, 6.731086832331713, 4.598552327752356, 7.991185672261427, 9.161022207295012, 12.04913266537767, 10.156357993539423, 11.773641194808993, 8.744758588324, 7.546230152180517, 7.324574056655563, 9.461532738777366, 6.845083173094715, 6.965884338774587, 7.7386965871400175, 4.826808833852122, 10.488714006555403, 6.438363174881409, 8.561753678645776, 4.553017042681926, 8.928992969492935, 3.1362911290901, 7.463255998244576, 9.08274069329747, 6.541096103840586, 9.04927767248719, 7.874319980655588, 8.712792871660211, 8.431582213542166, 8.954812205195275, 6.889213630934074, 2.732799720826688, 5.932018546174991, 7.314922413248356, 4.989061382989893, 8.860474413896673, 5.69035547512429, 5.429852796385486, 7.220744419270234, 7.735480429363707, 9.661615277705002, 6.437852092676406, 9.108838503971906, 4.263410330713755, 5.189484777208351, 4.4500397009558705, 3.1136651502619754, 8.883701448823338, 9.845902908383477, 7.199799406835852, 7.9933547374882945], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7617961054628237, "mean_inference_ms": 8.174215367011561, "mean_action_processing_ms": 0.5485531525172996, "mean_env_wait_ms": 24.228750859080073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04106426239013672, "StateBufferConnector_ms": 0.024310827255249023, "ViewRequirementAgentConnector_ms": 0.9685389995574951}}, "episode_reward_max": 12.04913266537767, "episode_reward_min": 1.2888433107425474, "episode_reward_mean": 7.130497626862924, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.673412204651835, 5.900371084138949, 10.138930402976142, 4.7501566770725505, 9.899083353355506, 7.165805177519585, 5.607274591642902, 5.979880311009209, 8.581402439666723, 2.916935184850543, 10.649078641806119, 9.186607403803464, 6.17549975407249, 4.75043155652941, 8.384178748059572, 4.901462922637251, 10.185551653103259, 6.593413927873839, 6.790475425635961, 8.757258627095014, 4.975179115685918, 4.968800431749303, 4.702071860940537, 8.824428874465143, 5.757162569955821, 8.304345177029605, 9.027279209327194, 5.854646496495562, 5.916272054769885, 8.851172059110898, 5.8140966520240305, 5.893244646694268, 6.796129368282887, 4.921734821653139, 9.91805423972514, 7.371965667302368, 8.007467397061307, 7.129089379557762, 8.072431233461115, 9.108541971814299, 6.574738911300241, 2.5557310643448643, 7.228410706718916, 8.556481895642733, 2.9751670844444065, 8.279805656956801, 6.052766778712866, 1.2888433107425474, 8.616817732375468, 7.645531564772511, 6.731086832331713, 4.598552327752356, 7.991185672261427, 9.161022207295012, 12.04913266537767, 10.156357993539423, 11.773641194808993, 8.744758588324, 7.546230152180517, 7.324574056655563, 9.461532738777366, 6.845083173094715, 6.965884338774587, 7.7386965871400175, 4.826808833852122, 10.488714006555403, 6.438363174881409, 8.561753678645776, 4.553017042681926, 8.928992969492935, 3.1362911290901, 7.463255998244576, 9.08274069329747, 6.541096103840586, 9.04927767248719, 7.874319980655588, 8.712792871660211, 8.431582213542166, 8.954812205195275, 6.889213630934074, 2.732799720826688, 5.932018546174991, 7.314922413248356, 4.989061382989893, 8.860474413896673, 5.69035547512429, 5.429852796385486, 7.220744419270234, 7.735480429363707, 9.661615277705002, 6.437852092676406, 9.108838503971906, 4.263410330713755, 5.189484777208351, 4.4500397009558705, 3.1136651502619754, 8.883701448823338, 9.845902908383477, 7.199799406835852, 7.9933547374882945], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7617961054628237, "mean_inference_ms": 8.174215367011561, "mean_action_processing_ms": 0.5485531525172996, "mean_env_wait_ms": 24.228750859080073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04106426239013672, "StateBufferConnector_ms": 0.024310827255249023, "ViewRequirementAgentConnector_ms": 0.9685389995574951}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8180760, "num_agent_steps_trained": 8180760, "num_env_steps_sampled": 8180760, "num_env_steps_trained": 8180760, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 276.74873864936325, "num_env_steps_trained_throughput_per_sec": 276.74873864936325, "timesteps_total": 8180760, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8180760, "timers": {"training_iteration_time_ms": 56676.77, "sample_time_ms": 43358.393, "load_time_ms": 1813.281, "load_throughput": 8624.148, "learn_time_ms": 10946.057, "learn_throughput": 1428.642, "synch_weights_time_ms": 436.375}, "counters": {"num_env_steps_sampled": 8180760, "num_env_steps_trained": 8180760, "num_agent_steps_sampled": 8180760, "num_agent_steps_trained": 8180760}, "done": false, "episodes_total": 2520, "training_iteration": 528, "trial_id": "2f030_00000", "date": "2025-06-07_10-26-43", "timestamp": 1749284803, "time_this_iter_s": 56.52012658119202, "time_total_s": 10209.548556089401, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10209.548556089401, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 78.303125, "ram_util_percent": 71.0125, "gpu_util_percent0": 0.074375, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.4362421052631584e-05, "total_loss": -0.059880658160810445, "policy_loss": -0.031561835717690306, "vf_loss": 0.014398281262679533, "vf_explained_var": 0.7153594640168277, "kl": 0.010908537372468175, "entropy": 20.202123284773393, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 99275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8196398, "num_env_steps_trained": 8196398, "num_agent_steps_sampled": 8196398, "num_agent_steps_trained": 8196398}, "sampler_results": {"episode_reward_max": 12.04913266537767, "episode_reward_min": 1.1141394191915666, "episode_reward_mean": 7.162222352179847, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.384178748059572, 4.901462922637251, 10.185551653103259, 6.593413927873839, 6.790475425635961, 8.757258627095014, 4.975179115685918, 4.968800431749303, 4.702071860940537, 8.824428874465143, 5.757162569955821, 8.304345177029605, 9.027279209327194, 5.854646496495562, 5.916272054769885, 8.851172059110898, 5.8140966520240305, 5.893244646694268, 6.796129368282887, 4.921734821653139, 9.91805423972514, 7.371965667302368, 8.007467397061307, 7.129089379557762, 8.072431233461115, 9.108541971814299, 6.574738911300241, 2.5557310643448643, 7.228410706718916, 8.556481895642733, 2.9751670844444065, 8.279805656956801, 6.052766778712866, 1.2888433107425474, 8.616817732375468, 7.645531564772511, 6.731086832331713, 4.598552327752356, 7.991185672261427, 9.161022207295012, 12.04913266537767, 10.156357993539423, 11.773641194808993, 8.744758588324, 7.546230152180517, 7.324574056655563, 9.461532738777366, 6.845083173094715, 6.965884338774587, 7.7386965871400175, 4.826808833852122, 10.488714006555403, 6.438363174881409, 8.561753678645776, 4.553017042681926, 8.928992969492935, 3.1362911290901, 7.463255998244576, 9.08274069329747, 6.541096103840586, 9.04927767248719, 7.874319980655588, 8.712792871660211, 8.431582213542166, 8.954812205195275, 6.889213630934074, 2.732799720826688, 5.932018546174991, 7.314922413248356, 4.989061382989893, 8.860474413896673, 5.69035547512429, 5.429852796385486, 7.220744419270234, 7.735480429363707, 9.661615277705002, 6.437852092676406, 9.108838503971906, 4.263410330713755, 5.189484777208351, 4.4500397009558705, 3.1136651502619754, 8.883701448823338, 9.845902908383477, 7.199799406835852, 7.9933547374882945, 7.087149336457165, 7.908549458417683, 8.738374864221068, 1.1141394191915666, 3.7586004618651008, 9.702790175565491, 7.984815493050488, 7.7095754543605315, 4.246622712384565, 9.385176631927921, 7.621265397189747, 10.45133099598841, 8.24382240782487, 7.595128506342872], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7607974750197064, "mean_inference_ms": 8.176289312824487, "mean_action_processing_ms": 0.5486549548540551, "mean_env_wait_ms": 24.233818804726496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04011702537536621, "StateBufferConnector_ms": 0.02978968620300293, "ViewRequirementAgentConnector_ms": 0.9689443111419678}}, "episode_reward_max": 12.04913266537767, "episode_reward_min": 1.1141394191915666, "episode_reward_mean": 7.162222352179847, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.384178748059572, 4.901462922637251, 10.185551653103259, 6.593413927873839, 6.790475425635961, 8.757258627095014, 4.975179115685918, 4.968800431749303, 4.702071860940537, 8.824428874465143, 5.757162569955821, 8.304345177029605, 9.027279209327194, 5.854646496495562, 5.916272054769885, 8.851172059110898, 5.8140966520240305, 5.893244646694268, 6.796129368282887, 4.921734821653139, 9.91805423972514, 7.371965667302368, 8.007467397061307, 7.129089379557762, 8.072431233461115, 9.108541971814299, 6.574738911300241, 2.5557310643448643, 7.228410706718916, 8.556481895642733, 2.9751670844444065, 8.279805656956801, 6.052766778712866, 1.2888433107425474, 8.616817732375468, 7.645531564772511, 6.731086832331713, 4.598552327752356, 7.991185672261427, 9.161022207295012, 12.04913266537767, 10.156357993539423, 11.773641194808993, 8.744758588324, 7.546230152180517, 7.324574056655563, 9.461532738777366, 6.845083173094715, 6.965884338774587, 7.7386965871400175, 4.826808833852122, 10.488714006555403, 6.438363174881409, 8.561753678645776, 4.553017042681926, 8.928992969492935, 3.1362911290901, 7.463255998244576, 9.08274069329747, 6.541096103840586, 9.04927767248719, 7.874319980655588, 8.712792871660211, 8.431582213542166, 8.954812205195275, 6.889213630934074, 2.732799720826688, 5.932018546174991, 7.314922413248356, 4.989061382989893, 8.860474413896673, 5.69035547512429, 5.429852796385486, 7.220744419270234, 7.735480429363707, 9.661615277705002, 6.437852092676406, 9.108838503971906, 4.263410330713755, 5.189484777208351, 4.4500397009558705, 3.1136651502619754, 8.883701448823338, 9.845902908383477, 7.199799406835852, 7.9933547374882945, 7.087149336457165, 7.908549458417683, 8.738374864221068, 1.1141394191915666, 3.7586004618651008, 9.702790175565491, 7.984815493050488, 7.7095754543605315, 4.246622712384565, 9.385176631927921, 7.621265397189747, 10.45133099598841, 8.24382240782487, 7.595128506342872], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7607974750197064, "mean_inference_ms": 8.176289312824487, "mean_action_processing_ms": 0.5486549548540551, "mean_env_wait_ms": 24.233818804726496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04011702537536621, "StateBufferConnector_ms": 0.02978968620300293, "ViewRequirementAgentConnector_ms": 0.9689443111419678}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8196398, "num_agent_steps_trained": 8196398, "num_env_steps_sampled": 8196398, "num_env_steps_trained": 8196398, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 274.51768542673426, "num_env_steps_trained_throughput_per_sec": 274.51768542673426, "timesteps_total": 8196398, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8196398, "timers": {"training_iteration_time_ms": 56682.026, "sample_time_ms": 43359.672, "load_time_ms": 1822.074, "load_throughput": 8582.528, "learn_time_ms": 10947.864, "learn_throughput": 1428.407, "synch_weights_time_ms": 431.918}, "counters": {"num_env_steps_sampled": 8196398, "num_env_steps_trained": 8196398, "num_agent_steps_sampled": 8196398, "num_agent_steps_trained": 8196398}, "done": false, "episodes_total": 2534, "training_iteration": 529, "trial_id": "2f030_00000", "date": "2025-06-07_10-27-40", "timestamp": 1749284860, "time_this_iter_s": 56.98134231567383, "time_total_s": 10266.529898405075, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10266.529898405075, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 78.87812499999998, "ram_util_percent": 71.3546875, "gpu_util_percent0": 0.07640625000000001, "vram_util_percent0": 0.8592122395833333}}
{"evaluation": {"sampler_results": {"episode_reward_max": -4.071946181881125, "episode_reward_min": -7.598024010618425, "episode_reward_mean": -4.994121540929544, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.071946181881125, -4.228998989042173, -4.890787166075666, -7.598024010618425, -4.180851357030333], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4398681729440388, "mean_inference_ms": 3.8714972017531637, "mean_action_processing_ms": 0.27773962789552653, "mean_env_wait_ms": 10.47803047531073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5245590209960938}}, "episode_reward_max": -4.071946181881125, "episode_reward_min": -7.598024010618425, "episode_reward_mean": -4.994121540929544, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.071946181881125, -4.228998989042173, -4.890787166075666, -7.598024010618425, -4.180851357030333], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4398681729440388, "mean_inference_ms": 3.8714972017531637, "mean_action_processing_ms": 0.27773962789552653, "mean_env_wait_ms": 10.47803047531073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5245590209960938}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.4238963157894735e-05, "total_loss": -0.04477728151081299, "policy_loss": -0.01593974735926498, "vf_loss": 0.014559915012425997, "vf_explained_var": 0.6950150495225733, "kl": 0.010625989541734488, "entropy": 20.385149263902143, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 99825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8212036, "num_env_steps_trained": 8212036, "num_agent_steps_sampled": 8212036, "num_agent_steps_trained": 8212036}, "sampler_results": {"episode_reward_max": 12.04913266537767, "episode_reward_min": -0.5174589473490085, "episode_reward_mean": 7.0694601112681115, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.916272054769885, 8.851172059110898, 5.8140966520240305, 5.893244646694268, 6.796129368282887, 4.921734821653139, 9.91805423972514, 7.371965667302368, 8.007467397061307, 7.129089379557762, 8.072431233461115, 9.108541971814299, 6.574738911300241, 2.5557310643448643, 7.228410706718916, 8.556481895642733, 2.9751670844444065, 8.279805656956801, 6.052766778712866, 1.2888433107425474, 8.616817732375468, 7.645531564772511, 6.731086832331713, 4.598552327752356, 7.991185672261427, 9.161022207295012, 12.04913266537767, 10.156357993539423, 11.773641194808993, 8.744758588324, 7.546230152180517, 7.324574056655563, 9.461532738777366, 6.845083173094715, 6.965884338774587, 7.7386965871400175, 4.826808833852122, 10.488714006555403, 6.438363174881409, 8.561753678645776, 4.553017042681926, 8.928992969492935, 3.1362911290901, 7.463255998244576, 9.08274069329747, 6.541096103840586, 9.04927767248719, 7.874319980655588, 8.712792871660211, 8.431582213542166, 8.954812205195275, 6.889213630934074, 2.732799720826688, 5.932018546174991, 7.314922413248356, 4.989061382989893, 8.860474413896673, 5.69035547512429, 5.429852796385486, 7.220744419270234, 7.735480429363707, 9.661615277705002, 6.437852092676406, 9.108838503971906, 4.263410330713755, 5.189484777208351, 4.4500397009558705, 3.1136651502619754, 8.883701448823338, 9.845902908383477, 7.199799406835852, 7.9933547374882945, 7.087149336457165, 7.908549458417683, 8.738374864221068, 1.1141394191915666, 3.7586004618651008, 9.702790175565491, 7.984815493050488, 7.7095754543605315, 4.246622712384565, 9.385176631927921, 7.621265397189747, 10.45133099598841, 8.24382240782487, 7.595128506342872, 5.152427253200688, 4.720850755938451, 9.146821982873602, 5.580808680697649, 6.330358961529277, 10.249298134622286, 3.1366970676306547, 9.524949498045984, 3.1800845108493103, 6.626991905656934, 8.54675284969896, 6.606743238611579, 10.464705056874298, -0.5174589473490085], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.760049735732429, "mean_inference_ms": 8.178179431120876, "mean_action_processing_ms": 0.5487393177212532, "mean_env_wait_ms": 24.238752994144026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0365293025970459, "StateBufferConnector_ms": 0.0338292121887207, "ViewRequirementAgentConnector_ms": 0.9730193614959717}}, "episode_reward_max": 12.04913266537767, "episode_reward_min": -0.5174589473490085, "episode_reward_mean": 7.0694601112681115, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.916272054769885, 8.851172059110898, 5.8140966520240305, 5.893244646694268, 6.796129368282887, 4.921734821653139, 9.91805423972514, 7.371965667302368, 8.007467397061307, 7.129089379557762, 8.072431233461115, 9.108541971814299, 6.574738911300241, 2.5557310643448643, 7.228410706718916, 8.556481895642733, 2.9751670844444065, 8.279805656956801, 6.052766778712866, 1.2888433107425474, 8.616817732375468, 7.645531564772511, 6.731086832331713, 4.598552327752356, 7.991185672261427, 9.161022207295012, 12.04913266537767, 10.156357993539423, 11.773641194808993, 8.744758588324, 7.546230152180517, 7.324574056655563, 9.461532738777366, 6.845083173094715, 6.965884338774587, 7.7386965871400175, 4.826808833852122, 10.488714006555403, 6.438363174881409, 8.561753678645776, 4.553017042681926, 8.928992969492935, 3.1362911290901, 7.463255998244576, 9.08274069329747, 6.541096103840586, 9.04927767248719, 7.874319980655588, 8.712792871660211, 8.431582213542166, 8.954812205195275, 6.889213630934074, 2.732799720826688, 5.932018546174991, 7.314922413248356, 4.989061382989893, 8.860474413896673, 5.69035547512429, 5.429852796385486, 7.220744419270234, 7.735480429363707, 9.661615277705002, 6.437852092676406, 9.108838503971906, 4.263410330713755, 5.189484777208351, 4.4500397009558705, 3.1136651502619754, 8.883701448823338, 9.845902908383477, 7.199799406835852, 7.9933547374882945, 7.087149336457165, 7.908549458417683, 8.738374864221068, 1.1141394191915666, 3.7586004618651008, 9.702790175565491, 7.984815493050488, 7.7095754543605315, 4.246622712384565, 9.385176631927921, 7.621265397189747, 10.45133099598841, 8.24382240782487, 7.595128506342872, 5.152427253200688, 4.720850755938451, 9.146821982873602, 5.580808680697649, 6.330358961529277, 10.249298134622286, 3.1366970676306547, 9.524949498045984, 3.1800845108493103, 6.626991905656934, 8.54675284969896, 6.606743238611579, 10.464705056874298, -0.5174589473490085], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.760049735732429, "mean_inference_ms": 8.178179431120876, "mean_action_processing_ms": 0.5487393177212532, "mean_env_wait_ms": 24.238752994144026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0365293025970459, "StateBufferConnector_ms": 0.0338292121887207, "ViewRequirementAgentConnector_ms": 0.9730193614959717}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8212036, "num_agent_steps_trained": 8212036, "num_env_steps_sampled": 8212036, "num_env_steps_trained": 8212036, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.35122478843005, "num_env_steps_trained_throughput_per_sec": 280.35122478843005, "timesteps_total": 8212036, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8212036, "timers": {"training_iteration_time_ms": 56676.535, "sample_time_ms": 43388.848, "load_time_ms": 1812.843, "load_throughput": 8626.23, "learn_time_ms": 10924.477, "learn_throughput": 1431.464, "synch_weights_time_ms": 429.063}, "counters": {"num_env_steps_sampled": 8212036, "num_env_steps_trained": 8212036, "num_agent_steps_sampled": 8212036, "num_agent_steps_trained": 8212036}, "done": false, "episodes_total": 2548, "training_iteration": 530, "trial_id": "2f030_00000", "date": "2025-06-07_10-28-51", "timestamp": 1749284931, "time_this_iter_s": 70.83543181419373, "time_total_s": 10337.365330219269, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10337.365330219269, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 65.24578313253012, "ram_util_percent": 70.69277108433735, "gpu_util_percent0": 0.0619277108433735, "vram_util_percent0": 0.859212239583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.411550526315789e-05, "total_loss": -0.0534328253838149, "policy_loss": -0.02493965718895197, "vf_loss": 0.01517407487823882, "vf_explained_var": 0.7049796498905528, "kl": 0.010585693357257855, "entropy": 20.29074650330977, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 100375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8227674, "num_env_steps_trained": 8227674, "num_agent_steps_sampled": 8227674, "num_agent_steps_trained": 8227674}, "sampler_results": {"episode_reward_max": 12.04913266537767, "episode_reward_min": -0.5174589473490085, "episode_reward_mean": 7.0424339730516525, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.228410706718916, 8.556481895642733, 2.9751670844444065, 8.279805656956801, 6.052766778712866, 1.2888433107425474, 8.616817732375468, 7.645531564772511, 6.731086832331713, 4.598552327752356, 7.991185672261427, 9.161022207295012, 12.04913266537767, 10.156357993539423, 11.773641194808993, 8.744758588324, 7.546230152180517, 7.324574056655563, 9.461532738777366, 6.845083173094715, 6.965884338774587, 7.7386965871400175, 4.826808833852122, 10.488714006555403, 6.438363174881409, 8.561753678645776, 4.553017042681926, 8.928992969492935, 3.1362911290901, 7.463255998244576, 9.08274069329747, 6.541096103840586, 9.04927767248719, 7.874319980655588, 8.712792871660211, 8.431582213542166, 8.954812205195275, 6.889213630934074, 2.732799720826688, 5.932018546174991, 7.314922413248356, 4.989061382989893, 8.860474413896673, 5.69035547512429, 5.429852796385486, 7.220744419270234, 7.735480429363707, 9.661615277705002, 6.437852092676406, 9.108838503971906, 4.263410330713755, 5.189484777208351, 4.4500397009558705, 3.1136651502619754, 8.883701448823338, 9.845902908383477, 7.199799406835852, 7.9933547374882945, 7.087149336457165, 7.908549458417683, 8.738374864221068, 1.1141394191915666, 3.7586004618651008, 9.702790175565491, 7.984815493050488, 7.7095754543605315, 4.246622712384565, 9.385176631927921, 7.621265397189747, 10.45133099598841, 8.24382240782487, 7.595128506342872, 5.152427253200688, 4.720850755938451, 9.146821982873602, 5.580808680697649, 6.330358961529277, 10.249298134622286, 3.1366970676306547, 9.524949498045984, 3.1800845108493103, 6.626991905656934, 8.54675284969896, 6.606743238611579, 10.464705056874298, -0.5174589473490085, 7.3433987740594775, 8.955964573918846, 4.395429137007957, 4.336829292692716, 8.041755617128029, 4.710776089552414, 5.910374302905134, 9.239992080009108, 8.537626851294485, 6.584052456088602, 2.6668850305904477, 7.940961113046845, 7.421093487443338, 8.142916839718731], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.759290717748287, "mean_inference_ms": 8.179993832399013, "mean_action_processing_ms": 0.548825901745155, "mean_env_wait_ms": 24.24360294582842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04557991027832031, "StateBufferConnector_ms": 0.037380218505859375, "ViewRequirementAgentConnector_ms": 0.9846072196960449}}, "episode_reward_max": 12.04913266537767, "episode_reward_min": -0.5174589473490085, "episode_reward_mean": 7.0424339730516525, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.228410706718916, 8.556481895642733, 2.9751670844444065, 8.279805656956801, 6.052766778712866, 1.2888433107425474, 8.616817732375468, 7.645531564772511, 6.731086832331713, 4.598552327752356, 7.991185672261427, 9.161022207295012, 12.04913266537767, 10.156357993539423, 11.773641194808993, 8.744758588324, 7.546230152180517, 7.324574056655563, 9.461532738777366, 6.845083173094715, 6.965884338774587, 7.7386965871400175, 4.826808833852122, 10.488714006555403, 6.438363174881409, 8.561753678645776, 4.553017042681926, 8.928992969492935, 3.1362911290901, 7.463255998244576, 9.08274069329747, 6.541096103840586, 9.04927767248719, 7.874319980655588, 8.712792871660211, 8.431582213542166, 8.954812205195275, 6.889213630934074, 2.732799720826688, 5.932018546174991, 7.314922413248356, 4.989061382989893, 8.860474413896673, 5.69035547512429, 5.429852796385486, 7.220744419270234, 7.735480429363707, 9.661615277705002, 6.437852092676406, 9.108838503971906, 4.263410330713755, 5.189484777208351, 4.4500397009558705, 3.1136651502619754, 8.883701448823338, 9.845902908383477, 7.199799406835852, 7.9933547374882945, 7.087149336457165, 7.908549458417683, 8.738374864221068, 1.1141394191915666, 3.7586004618651008, 9.702790175565491, 7.984815493050488, 7.7095754543605315, 4.246622712384565, 9.385176631927921, 7.621265397189747, 10.45133099598841, 8.24382240782487, 7.595128506342872, 5.152427253200688, 4.720850755938451, 9.146821982873602, 5.580808680697649, 6.330358961529277, 10.249298134622286, 3.1366970676306547, 9.524949498045984, 3.1800845108493103, 6.626991905656934, 8.54675284969896, 6.606743238611579, 10.464705056874298, -0.5174589473490085, 7.3433987740594775, 8.955964573918846, 4.395429137007957, 4.336829292692716, 8.041755617128029, 4.710776089552414, 5.910374302905134, 9.239992080009108, 8.537626851294485, 6.584052456088602, 2.6668850305904477, 7.940961113046845, 7.421093487443338, 8.142916839718731], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.759290717748287, "mean_inference_ms": 8.179993832399013, "mean_action_processing_ms": 0.548825901745155, "mean_env_wait_ms": 24.24360294582842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04557991027832031, "StateBufferConnector_ms": 0.037380218505859375, "ViewRequirementAgentConnector_ms": 0.9846072196960449}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8227674, "num_agent_steps_trained": 8227674, "num_env_steps_sampled": 8227674, "num_env_steps_trained": 8227674, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 277.5143225457314, "num_env_steps_trained_throughput_per_sec": 277.5143225457314, "timesteps_total": 8227674, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8227674, "timers": {"training_iteration_time_ms": 56748.165, "sample_time_ms": 43469.451, "load_time_ms": 1809.053, "load_throughput": 8644.304, "learn_time_ms": 10919.359, "learn_throughput": 1432.135, "synch_weights_time_ms": 429.975}, "counters": {"num_env_steps_sampled": 8227674, "num_env_steps_trained": 8227674, "num_agent_steps_sampled": 8227674, "num_agent_steps_trained": 8227674}, "done": false, "episodes_total": 2562, "training_iteration": 531, "trial_id": "2f030_00000", "date": "2025-06-07_10-29-48", "timestamp": 1749284988, "time_this_iter_s": 56.38166809082031, "time_total_s": 10393.74699831009, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10393.74699831009, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 77.84531249999999, "ram_util_percent": 71.040625, "gpu_util_percent0": 0.07625, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.399204736842105e-05, "total_loss": -0.0619780335215513, "policy_loss": -0.03362624602703198, "vf_loss": 0.01490198875354095, "vf_explained_var": 0.7258944094181061, "kl": 0.010988196562463283, "entropy": 20.322516436143356, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 100925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8243312, "num_env_steps_trained": 8243312, "num_agent_steps_sampled": 8243312, "num_agent_steps_trained": 8243312}, "sampler_results": {"episode_reward_max": 11.773641194808993, "episode_reward_min": -0.5174589473490085, "episode_reward_mean": 6.9841954274207545, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.773641194808993, 8.744758588324, 7.546230152180517, 7.324574056655563, 9.461532738777366, 6.845083173094715, 6.965884338774587, 7.7386965871400175, 4.826808833852122, 10.488714006555403, 6.438363174881409, 8.561753678645776, 4.553017042681926, 8.928992969492935, 3.1362911290901, 7.463255998244576, 9.08274069329747, 6.541096103840586, 9.04927767248719, 7.874319980655588, 8.712792871660211, 8.431582213542166, 8.954812205195275, 6.889213630934074, 2.732799720826688, 5.932018546174991, 7.314922413248356, 4.989061382989893, 8.860474413896673, 5.69035547512429, 5.429852796385486, 7.220744419270234, 7.735480429363707, 9.661615277705002, 6.437852092676406, 9.108838503971906, 4.263410330713755, 5.189484777208351, 4.4500397009558705, 3.1136651502619754, 8.883701448823338, 9.845902908383477, 7.199799406835852, 7.9933547374882945, 7.087149336457165, 7.908549458417683, 8.738374864221068, 1.1141394191915666, 3.7586004618651008, 9.702790175565491, 7.984815493050488, 7.7095754543605315, 4.246622712384565, 9.385176631927921, 7.621265397189747, 10.45133099598841, 8.24382240782487, 7.595128506342872, 5.152427253200688, 4.720850755938451, 9.146821982873602, 5.580808680697649, 6.330358961529277, 10.249298134622286, 3.1366970676306547, 9.524949498045984, 3.1800845108493103, 6.626991905656934, 8.54675284969896, 6.606743238611579, 10.464705056874298, -0.5174589473490085, 7.3433987740594775, 8.955964573918846, 4.395429137007957, 4.336829292692716, 8.041755617128029, 4.710776089552414, 5.910374302905134, 9.239992080009108, 8.537626851294485, 6.584052456088602, 2.6668850305904477, 7.940961113046845, 7.421093487443338, 8.142916839718731, 7.9981744201775475, 5.046004647658577, 2.0707844137416975, 4.783929578562678, 4.6632741125492, 9.536807983805641, 5.932055362194371, 6.9391313722746695, 4.214211044218097, 7.781611144637756, 10.587259598554251, 7.495954358031373, 10.021622653337998, 8.43648717609016], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.758436522842816, "mean_inference_ms": 8.18166055126192, "mean_action_processing_ms": 0.5489099506859643, "mean_env_wait_ms": 24.248091852306448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046994686126708984, "StateBufferConnector_ms": 0.03538990020751953, "ViewRequirementAgentConnector_ms": 0.9852073192596436}}, "episode_reward_max": 11.773641194808993, "episode_reward_min": -0.5174589473490085, "episode_reward_mean": 6.9841954274207545, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.773641194808993, 8.744758588324, 7.546230152180517, 7.324574056655563, 9.461532738777366, 6.845083173094715, 6.965884338774587, 7.7386965871400175, 4.826808833852122, 10.488714006555403, 6.438363174881409, 8.561753678645776, 4.553017042681926, 8.928992969492935, 3.1362911290901, 7.463255998244576, 9.08274069329747, 6.541096103840586, 9.04927767248719, 7.874319980655588, 8.712792871660211, 8.431582213542166, 8.954812205195275, 6.889213630934074, 2.732799720826688, 5.932018546174991, 7.314922413248356, 4.989061382989893, 8.860474413896673, 5.69035547512429, 5.429852796385486, 7.220744419270234, 7.735480429363707, 9.661615277705002, 6.437852092676406, 9.108838503971906, 4.263410330713755, 5.189484777208351, 4.4500397009558705, 3.1136651502619754, 8.883701448823338, 9.845902908383477, 7.199799406835852, 7.9933547374882945, 7.087149336457165, 7.908549458417683, 8.738374864221068, 1.1141394191915666, 3.7586004618651008, 9.702790175565491, 7.984815493050488, 7.7095754543605315, 4.246622712384565, 9.385176631927921, 7.621265397189747, 10.45133099598841, 8.24382240782487, 7.595128506342872, 5.152427253200688, 4.720850755938451, 9.146821982873602, 5.580808680697649, 6.330358961529277, 10.249298134622286, 3.1366970676306547, 9.524949498045984, 3.1800845108493103, 6.626991905656934, 8.54675284969896, 6.606743238611579, 10.464705056874298, -0.5174589473490085, 7.3433987740594775, 8.955964573918846, 4.395429137007957, 4.336829292692716, 8.041755617128029, 4.710776089552414, 5.910374302905134, 9.239992080009108, 8.537626851294485, 6.584052456088602, 2.6668850305904477, 7.940961113046845, 7.421093487443338, 8.142916839718731, 7.9981744201775475, 5.046004647658577, 2.0707844137416975, 4.783929578562678, 4.6632741125492, 9.536807983805641, 5.932055362194371, 6.9391313722746695, 4.214211044218097, 7.781611144637756, 10.587259598554251, 7.495954358031373, 10.021622653337998, 8.43648717609016], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.758436522842816, "mean_inference_ms": 8.18166055126192, "mean_action_processing_ms": 0.5489099506859643, "mean_env_wait_ms": 24.248091852306448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046994686126708984, "StateBufferConnector_ms": 0.03538990020751953, "ViewRequirementAgentConnector_ms": 0.9852073192596436}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8243312, "num_agent_steps_trained": 8243312, "num_env_steps_sampled": 8243312, "num_env_steps_trained": 8243312, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 274.62127899001274, "num_env_steps_trained_throughput_per_sec": 274.62127899001274, "timesteps_total": 8243312, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8243312, "timers": {"training_iteration_time_ms": 56729.264, "sample_time_ms": 43457.251, "load_time_ms": 1799.533, "load_throughput": 8690.035, "learn_time_ms": 10920.981, "learn_throughput": 1431.923, "synch_weights_time_ms": 431.389}, "counters": {"num_env_steps_sampled": 8243312, "num_env_steps_trained": 8243312, "num_agent_steps_sampled": 8243312, "num_agent_steps_trained": 8243312}, "done": false, "episodes_total": 2576, "training_iteration": 532, "trial_id": "2f030_00000", "date": "2025-06-07_10-30-45", "timestamp": 1749285045, "time_this_iter_s": 56.95987319946289, "time_total_s": 10450.706871509552, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10450.706871509552, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 78.35692307692307, "ram_util_percent": 71.35384615384613, "gpu_util_percent0": 0.08123076923076923, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.3868589473684215e-05, "total_loss": -0.048259225835261696, "policy_loss": -0.01961713063125816, "vf_loss": 0.015307333976538344, "vf_explained_var": 0.7548492543263868, "kl": 0.010247099072270234, "entropy": 20.264674025448887, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 101475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8258950, "num_env_steps_trained": 8258950, "num_agent_steps_sampled": 8258950, "num_agent_steps_trained": 8258950}, "sampler_results": {"episode_reward_max": 11.541320980892412, "episode_reward_min": -0.5174589473490085, "episode_reward_mean": 6.9166384107627525, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.1362911290901, 7.463255998244576, 9.08274069329747, 6.541096103840586, 9.04927767248719, 7.874319980655588, 8.712792871660211, 8.431582213542166, 8.954812205195275, 6.889213630934074, 2.732799720826688, 5.932018546174991, 7.314922413248356, 4.989061382989893, 8.860474413896673, 5.69035547512429, 5.429852796385486, 7.220744419270234, 7.735480429363707, 9.661615277705002, 6.437852092676406, 9.108838503971906, 4.263410330713755, 5.189484777208351, 4.4500397009558705, 3.1136651502619754, 8.883701448823338, 9.845902908383477, 7.199799406835852, 7.9933547374882945, 7.087149336457165, 7.908549458417683, 8.738374864221068, 1.1141394191915666, 3.7586004618651008, 9.702790175565491, 7.984815493050488, 7.7095754543605315, 4.246622712384565, 9.385176631927921, 7.621265397189747, 10.45133099598841, 8.24382240782487, 7.595128506342872, 5.152427253200688, 4.720850755938451, 9.146821982873602, 5.580808680697649, 6.330358961529277, 10.249298134622286, 3.1366970676306547, 9.524949498045984, 3.1800845108493103, 6.626991905656934, 8.54675284969896, 6.606743238611579, 10.464705056874298, -0.5174589473490085, 7.3433987740594775, 8.955964573918846, 4.395429137007957, 4.336829292692716, 8.041755617128029, 4.710776089552414, 5.910374302905134, 9.239992080009108, 8.537626851294485, 6.584052456088602, 2.6668850305904477, 7.940961113046845, 7.421093487443338, 8.142916839718731, 7.9981744201775475, 5.046004647658577, 2.0707844137416975, 4.783929578562678, 4.6632741125492, 9.536807983805641, 5.932055362194371, 6.9391313722746695, 4.214211044218097, 7.781611144637756, 10.587259598554251, 7.495954358031373, 10.021622653337998, 8.43648717609016, 6.183309330279327, 9.38313338895874, 7.34817757311212, 8.57618917823369, 7.047841808064488, 3.7271476392600333, 7.047518493690791, 4.477170136336219, 5.250602456664669, 6.934574254899775, 9.10994423279684, 8.93773944005847, 7.877679956817563, 11.541320980892412], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.757720492769428, "mean_inference_ms": 8.183163373972219, "mean_action_processing_ms": 0.5489922584552851, "mean_env_wait_ms": 24.251999381325163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04497218132019043, "StateBufferConnector_ms": 0.03404855728149414, "ViewRequirementAgentConnector_ms": 0.9731481075286865}}, "episode_reward_max": 11.541320980892412, "episode_reward_min": -0.5174589473490085, "episode_reward_mean": 6.9166384107627525, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.1362911290901, 7.463255998244576, 9.08274069329747, 6.541096103840586, 9.04927767248719, 7.874319980655588, 8.712792871660211, 8.431582213542166, 8.954812205195275, 6.889213630934074, 2.732799720826688, 5.932018546174991, 7.314922413248356, 4.989061382989893, 8.860474413896673, 5.69035547512429, 5.429852796385486, 7.220744419270234, 7.735480429363707, 9.661615277705002, 6.437852092676406, 9.108838503971906, 4.263410330713755, 5.189484777208351, 4.4500397009558705, 3.1136651502619754, 8.883701448823338, 9.845902908383477, 7.199799406835852, 7.9933547374882945, 7.087149336457165, 7.908549458417683, 8.738374864221068, 1.1141394191915666, 3.7586004618651008, 9.702790175565491, 7.984815493050488, 7.7095754543605315, 4.246622712384565, 9.385176631927921, 7.621265397189747, 10.45133099598841, 8.24382240782487, 7.595128506342872, 5.152427253200688, 4.720850755938451, 9.146821982873602, 5.580808680697649, 6.330358961529277, 10.249298134622286, 3.1366970676306547, 9.524949498045984, 3.1800845108493103, 6.626991905656934, 8.54675284969896, 6.606743238611579, 10.464705056874298, -0.5174589473490085, 7.3433987740594775, 8.955964573918846, 4.395429137007957, 4.336829292692716, 8.041755617128029, 4.710776089552414, 5.910374302905134, 9.239992080009108, 8.537626851294485, 6.584052456088602, 2.6668850305904477, 7.940961113046845, 7.421093487443338, 8.142916839718731, 7.9981744201775475, 5.046004647658577, 2.0707844137416975, 4.783929578562678, 4.6632741125492, 9.536807983805641, 5.932055362194371, 6.9391313722746695, 4.214211044218097, 7.781611144637756, 10.587259598554251, 7.495954358031373, 10.021622653337998, 8.43648717609016, 6.183309330279327, 9.38313338895874, 7.34817757311212, 8.57618917823369, 7.047841808064488, 3.7271476392600333, 7.047518493690791, 4.477170136336219, 5.250602456664669, 6.934574254899775, 9.10994423279684, 8.93773944005847, 7.877679956817563, 11.541320980892412], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.757720492769428, "mean_inference_ms": 8.183163373972219, "mean_action_processing_ms": 0.5489922584552851, "mean_env_wait_ms": 24.251999381325163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04497218132019043, "StateBufferConnector_ms": 0.03404855728149414, "ViewRequirementAgentConnector_ms": 0.9731481075286865}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8258950, "num_agent_steps_trained": 8258950, "num_env_steps_sampled": 8258950, "num_env_steps_trained": 8258950, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 276.73830683705893, "num_env_steps_trained_throughput_per_sec": 276.73830683705893, "timesteps_total": 8258950, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8258950, "timers": {"training_iteration_time_ms": 56748.633, "sample_time_ms": 43532.161, "load_time_ms": 1797.693, "load_throughput": 8698.926, "learn_time_ms": 10871.857, "learn_throughput": 1438.393, "synch_weights_time_ms": 429.56}, "counters": {"num_env_steps_sampled": 8258950, "num_env_steps_trained": 8258950, "num_agent_steps_sampled": 8258950, "num_agent_steps_trained": 8258950}, "done": false, "episodes_total": 2590, "training_iteration": 533, "trial_id": "2f030_00000", "date": "2025-06-07_10-31-41", "timestamp": 1749285101, "time_this_iter_s": 56.521052837371826, "time_total_s": 10507.227924346924, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10507.227924346924, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 78.0453125, "ram_util_percent": 71.3203125, "gpu_util_percent0": 0.06890625, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.374513157894737e-05, "total_loss": -0.058112790333530444, "policy_loss": -0.029067303400978826, "vf_loss": 0.014212500212544745, "vf_explained_var": 0.7380361318588257, "kl": 0.010183919974303783, "entropy": 20.279655716635965, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 102025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8274588, "num_env_steps_trained": 8274588, "num_agent_steps_sampled": 8274588, "num_agent_steps_trained": 8274588}, "sampler_results": {"episode_reward_max": 11.541320980892412, "episode_reward_min": -0.5174589473490085, "episode_reward_mean": 6.93229243310166, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.860474413896673, 5.69035547512429, 5.429852796385486, 7.220744419270234, 7.735480429363707, 9.661615277705002, 6.437852092676406, 9.108838503971906, 4.263410330713755, 5.189484777208351, 4.4500397009558705, 3.1136651502619754, 8.883701448823338, 9.845902908383477, 7.199799406835852, 7.9933547374882945, 7.087149336457165, 7.908549458417683, 8.738374864221068, 1.1141394191915666, 3.7586004618651008, 9.702790175565491, 7.984815493050488, 7.7095754543605315, 4.246622712384565, 9.385176631927921, 7.621265397189747, 10.45133099598841, 8.24382240782487, 7.595128506342872, 5.152427253200688, 4.720850755938451, 9.146821982873602, 5.580808680697649, 6.330358961529277, 10.249298134622286, 3.1366970676306547, 9.524949498045984, 3.1800845108493103, 6.626991905656934, 8.54675284969896, 6.606743238611579, 10.464705056874298, -0.5174589473490085, 7.3433987740594775, 8.955964573918846, 4.395429137007957, 4.336829292692716, 8.041755617128029, 4.710776089552414, 5.910374302905134, 9.239992080009108, 8.537626851294485, 6.584052456088602, 2.6668850305904477, 7.940961113046845, 7.421093487443338, 8.142916839718731, 7.9981744201775475, 5.046004647658577, 2.0707844137416975, 4.783929578562678, 4.6632741125492, 9.536807983805641, 5.932055362194371, 6.9391313722746695, 4.214211044218097, 7.781611144637756, 10.587259598554251, 7.495954358031373, 10.021622653337998, 8.43648717609016, 6.183309330279327, 9.38313338895874, 7.34817757311212, 8.57618917823369, 7.047841808064488, 3.7271476392600333, 7.047518493690791, 4.477170136336219, 5.250602456664669, 6.934574254899775, 9.10994423279684, 8.93773944005847, 7.877679956817563, 11.541320980892412, 7.677895883385302, 5.714709719457605, 8.3241113641073, 6.174072788990879, 8.634884060447504, 8.367387417110322, 6.506632516003355, 8.047111978832891, 5.48088046205544, 11.244434654513647, 6.036948734603545, 2.911087068309648, 8.309561373153645, 5.239868775106872], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.756923847821904, "mean_inference_ms": 8.184736767316444, "mean_action_processing_ms": 0.5490776949826045, "mean_env_wait_ms": 24.255842666805606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04595804214477539, "StateBufferConnector_ms": 0.04102730751037598, "ViewRequirementAgentConnector_ms": 0.9795491695404053}}, "episode_reward_max": 11.541320980892412, "episode_reward_min": -0.5174589473490085, "episode_reward_mean": 6.93229243310166, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.860474413896673, 5.69035547512429, 5.429852796385486, 7.220744419270234, 7.735480429363707, 9.661615277705002, 6.437852092676406, 9.108838503971906, 4.263410330713755, 5.189484777208351, 4.4500397009558705, 3.1136651502619754, 8.883701448823338, 9.845902908383477, 7.199799406835852, 7.9933547374882945, 7.087149336457165, 7.908549458417683, 8.738374864221068, 1.1141394191915666, 3.7586004618651008, 9.702790175565491, 7.984815493050488, 7.7095754543605315, 4.246622712384565, 9.385176631927921, 7.621265397189747, 10.45133099598841, 8.24382240782487, 7.595128506342872, 5.152427253200688, 4.720850755938451, 9.146821982873602, 5.580808680697649, 6.330358961529277, 10.249298134622286, 3.1366970676306547, 9.524949498045984, 3.1800845108493103, 6.626991905656934, 8.54675284969896, 6.606743238611579, 10.464705056874298, -0.5174589473490085, 7.3433987740594775, 8.955964573918846, 4.395429137007957, 4.336829292692716, 8.041755617128029, 4.710776089552414, 5.910374302905134, 9.239992080009108, 8.537626851294485, 6.584052456088602, 2.6668850305904477, 7.940961113046845, 7.421093487443338, 8.142916839718731, 7.9981744201775475, 5.046004647658577, 2.0707844137416975, 4.783929578562678, 4.6632741125492, 9.536807983805641, 5.932055362194371, 6.9391313722746695, 4.214211044218097, 7.781611144637756, 10.587259598554251, 7.495954358031373, 10.021622653337998, 8.43648717609016, 6.183309330279327, 9.38313338895874, 7.34817757311212, 8.57618917823369, 7.047841808064488, 3.7271476392600333, 7.047518493690791, 4.477170136336219, 5.250602456664669, 6.934574254899775, 9.10994423279684, 8.93773944005847, 7.877679956817563, 11.541320980892412, 7.677895883385302, 5.714709719457605, 8.3241113641073, 6.174072788990879, 8.634884060447504, 8.367387417110322, 6.506632516003355, 8.047111978832891, 5.48088046205544, 11.244434654513647, 6.036948734603545, 2.911087068309648, 8.309561373153645, 5.239868775106872], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.756923847821904, "mean_inference_ms": 8.184736767316444, "mean_action_processing_ms": 0.5490776949826045, "mean_env_wait_ms": 24.255842666805606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04595804214477539, "StateBufferConnector_ms": 0.04102730751037598, "ViewRequirementAgentConnector_ms": 0.9795491695404053}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8274588, "num_agent_steps_trained": 8274588, "num_env_steps_sampled": 8274588, "num_env_steps_trained": 8274588, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 277.9455172506377, "num_env_steps_trained_throughput_per_sec": 277.9455172506377, "timesteps_total": 8274588, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8274588, "timers": {"training_iteration_time_ms": 56663.409, "sample_time_ms": 43484.569, "load_time_ms": 1778.49, "load_throughput": 8792.851, "learn_time_ms": 10854.534, "learn_throughput": 1440.688, "synch_weights_time_ms": 430.04}, "counters": {"num_env_steps_sampled": 8274588, "num_env_steps_trained": 8274588, "num_agent_steps_sampled": 8274588, "num_agent_steps_trained": 8274588}, "done": false, "episodes_total": 2604, "training_iteration": 534, "trial_id": "2f030_00000", "date": "2025-06-07_10-32-38", "timestamp": 1749285158, "time_this_iter_s": 56.28549814224243, "time_total_s": 10563.513422489166, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10563.513422489166, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 77.84375, "ram_util_percent": 71.33125, "gpu_util_percent0": 0.08015625, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.362167368421053e-05, "total_loss": -0.040286123507063495, "policy_loss": -0.012161792902942663, "vf_loss": 0.017379087868400596, "vf_explained_var": 0.70804445754398, "kl": 0.010316753303474176, "entropy": 20.34134813308716, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 102575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8290226, "num_env_steps_trained": 8290226, "num_agent_steps_sampled": 8290226, "num_agent_steps_trained": 8290226}, "sampler_results": {"episode_reward_max": 11.541320980892412, "episode_reward_min": -3.3781662379470845, "episode_reward_mean": 6.8429286257341815, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.199799406835852, 7.9933547374882945, 7.087149336457165, 7.908549458417683, 8.738374864221068, 1.1141394191915666, 3.7586004618651008, 9.702790175565491, 7.984815493050488, 7.7095754543605315, 4.246622712384565, 9.385176631927921, 7.621265397189747, 10.45133099598841, 8.24382240782487, 7.595128506342872, 5.152427253200688, 4.720850755938451, 9.146821982873602, 5.580808680697649, 6.330358961529277, 10.249298134622286, 3.1366970676306547, 9.524949498045984, 3.1800845108493103, 6.626991905656934, 8.54675284969896, 6.606743238611579, 10.464705056874298, -0.5174589473490085, 7.3433987740594775, 8.955964573918846, 4.395429137007957, 4.336829292692716, 8.041755617128029, 4.710776089552414, 5.910374302905134, 9.239992080009108, 8.537626851294485, 6.584052456088602, 2.6668850305904477, 7.940961113046845, 7.421093487443338, 8.142916839718731, 7.9981744201775475, 5.046004647658577, 2.0707844137416975, 4.783929578562678, 4.6632741125492, 9.536807983805641, 5.932055362194371, 6.9391313722746695, 4.214211044218097, 7.781611144637756, 10.587259598554251, 7.495954358031373, 10.021622653337998, 8.43648717609016, 6.183309330279327, 9.38313338895874, 7.34817757311212, 8.57618917823369, 7.047841808064488, 3.7271476392600333, 7.047518493690791, 4.477170136336219, 5.250602456664669, 6.934574254899775, 9.10994423279684, 8.93773944005847, 7.877679956817563, 11.541320980892412, 7.677895883385302, 5.714709719457605, 8.3241113641073, 6.174072788990879, 8.634884060447504, 8.367387417110322, 6.506632516003355, 8.047111978832891, 5.48088046205544, 11.244434654513647, 6.036948734603545, 2.911087068309648, 8.309561373153645, 5.239868775106872, 9.80444490179316, 8.560655700417108, 7.6548827876421495, 7.543955965236521, 6.122067248898795, 6.889585006614845, 5.867467625053374, 0.22809949539670793, 2.371801859782293, 10.902753967113538, -3.3781662379470845, 5.579240957370397, 7.9019391615014385, 10.90630854911938], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7561023430369977, "mean_inference_ms": 8.186356998675416, "mean_action_processing_ms": 0.5491805263049712, "mean_env_wait_ms": 24.259845025630394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0441737174987793, "StateBufferConnector_ms": 0.04283332824707031, "ViewRequirementAgentConnector_ms": 0.983008623123169}}, "episode_reward_max": 11.541320980892412, "episode_reward_min": -3.3781662379470845, "episode_reward_mean": 6.8429286257341815, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.199799406835852, 7.9933547374882945, 7.087149336457165, 7.908549458417683, 8.738374864221068, 1.1141394191915666, 3.7586004618651008, 9.702790175565491, 7.984815493050488, 7.7095754543605315, 4.246622712384565, 9.385176631927921, 7.621265397189747, 10.45133099598841, 8.24382240782487, 7.595128506342872, 5.152427253200688, 4.720850755938451, 9.146821982873602, 5.580808680697649, 6.330358961529277, 10.249298134622286, 3.1366970676306547, 9.524949498045984, 3.1800845108493103, 6.626991905656934, 8.54675284969896, 6.606743238611579, 10.464705056874298, -0.5174589473490085, 7.3433987740594775, 8.955964573918846, 4.395429137007957, 4.336829292692716, 8.041755617128029, 4.710776089552414, 5.910374302905134, 9.239992080009108, 8.537626851294485, 6.584052456088602, 2.6668850305904477, 7.940961113046845, 7.421093487443338, 8.142916839718731, 7.9981744201775475, 5.046004647658577, 2.0707844137416975, 4.783929578562678, 4.6632741125492, 9.536807983805641, 5.932055362194371, 6.9391313722746695, 4.214211044218097, 7.781611144637756, 10.587259598554251, 7.495954358031373, 10.021622653337998, 8.43648717609016, 6.183309330279327, 9.38313338895874, 7.34817757311212, 8.57618917823369, 7.047841808064488, 3.7271476392600333, 7.047518493690791, 4.477170136336219, 5.250602456664669, 6.934574254899775, 9.10994423279684, 8.93773944005847, 7.877679956817563, 11.541320980892412, 7.677895883385302, 5.714709719457605, 8.3241113641073, 6.174072788990879, 8.634884060447504, 8.367387417110322, 6.506632516003355, 8.047111978832891, 5.48088046205544, 11.244434654513647, 6.036948734603545, 2.911087068309648, 8.309561373153645, 5.239868775106872, 9.80444490179316, 8.560655700417108, 7.6548827876421495, 7.543955965236521, 6.122067248898795, 6.889585006614845, 5.867467625053374, 0.22809949539670793, 2.371801859782293, 10.902753967113538, -3.3781662379470845, 5.579240957370397, 7.9019391615014385, 10.90630854911938], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7561023430369977, "mean_inference_ms": 8.186356998675416, "mean_action_processing_ms": 0.5491805263049712, "mean_env_wait_ms": 24.259845025630394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0441737174987793, "StateBufferConnector_ms": 0.04283332824707031, "ViewRequirementAgentConnector_ms": 0.983008623123169}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8290226, "num_agent_steps_trained": 8290226, "num_env_steps_sampled": 8290226, "num_env_steps_trained": 8290226, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 272.5198631151058, "num_env_steps_trained_throughput_per_sec": 272.5198631151058, "timesteps_total": 8290226, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8290226, "timers": {"training_iteration_time_ms": 56574.036, "sample_time_ms": 43382.525, "load_time_ms": 1792.761, "load_throughput": 8722.859, "learn_time_ms": 10854.332, "learn_throughput": 1440.715, "synch_weights_time_ms": 430.73}, "counters": {"num_env_steps_sampled": 8290226, "num_env_steps_trained": 8290226, "num_agent_steps_sampled": 8290226, "num_agent_steps_trained": 8290226}, "done": false, "episodes_total": 2618, "training_iteration": 535, "trial_id": "2f030_00000", "date": "2025-06-07_10-33-35", "timestamp": 1749285215, "time_this_iter_s": 57.406121492385864, "time_total_s": 10620.919543981552, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10620.919543981552, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 78.61212121212121, "ram_util_percent": 71.67121212121211, "gpu_util_percent0": 0.07393939393939396, "vram_util_percent0": 0.8592122395833334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.349821578947369e-05, "total_loss": -0.0653508981156417, "policy_loss": -0.03629421579196457, "vf_loss": 0.013854966174641794, "vf_explained_var": 0.7401457218690352, "kl": 0.010432686469178986, "entropy": 20.320173391862348, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 103125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8305864, "num_env_steps_trained": 8305864, "num_agent_steps_sampled": 8305864, "num_agent_steps_trained": 8305864}, "sampler_results": {"episode_reward_max": 11.541320980892412, "episode_reward_min": -3.3781662379470845, "episode_reward_mean": 6.771406677542306, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.24382240782487, 7.595128506342872, 5.152427253200688, 4.720850755938451, 9.146821982873602, 5.580808680697649, 6.330358961529277, 10.249298134622286, 3.1366970676306547, 9.524949498045984, 3.1800845108493103, 6.626991905656934, 8.54675284969896, 6.606743238611579, 10.464705056874298, -0.5174589473490085, 7.3433987740594775, 8.955964573918846, 4.395429137007957, 4.336829292692716, 8.041755617128029, 4.710776089552414, 5.910374302905134, 9.239992080009108, 8.537626851294485, 6.584052456088602, 2.6668850305904477, 7.940961113046845, 7.421093487443338, 8.142916839718731, 7.9981744201775475, 5.046004647658577, 2.0707844137416975, 4.783929578562678, 4.6632741125492, 9.536807983805641, 5.932055362194371, 6.9391313722746695, 4.214211044218097, 7.781611144637756, 10.587259598554251, 7.495954358031373, 10.021622653337998, 8.43648717609016, 6.183309330279327, 9.38313338895874, 7.34817757311212, 8.57618917823369, 7.047841808064488, 3.7271476392600333, 7.047518493690791, 4.477170136336219, 5.250602456664669, 6.934574254899775, 9.10994423279684, 8.93773944005847, 7.877679956817563, 11.541320980892412, 7.677895883385302, 5.714709719457605, 8.3241113641073, 6.174072788990879, 8.634884060447504, 8.367387417110322, 6.506632516003355, 8.047111978832891, 5.48088046205544, 11.244434654513647, 6.036948734603545, 2.911087068309648, 8.309561373153645, 5.239868775106872, 9.80444490179316, 8.560655700417108, 7.6548827876421495, 7.543955965236521, 6.122067248898795, 6.889585006614845, 5.867467625053374, 0.22809949539670793, 2.371801859782293, 10.902753967113538, -3.3781662379470845, 5.579240957370397, 7.9019391615014385, 10.90630854911938, 8.707015484069748, 8.72715300895365, 5.956077369691694, 6.786267622461184, 4.632390415256428, 4.390179599526688, 3.5322101605460126, 7.500946551562113, 7.230484710196722, 5.102576228301138, 7.171153481785886, 9.565924711986161, 7.75492384091997, 6.692046540498862], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7553524211147256, "mean_inference_ms": 8.187937985920986, "mean_action_processing_ms": 0.5492836340313143, "mean_env_wait_ms": 24.263574446560693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04510903358459473, "StateBufferConnector_ms": 0.038407325744628906, "ViewRequirementAgentConnector_ms": 0.9849534034729004}}, "episode_reward_max": 11.541320980892412, "episode_reward_min": -3.3781662379470845, "episode_reward_mean": 6.771406677542306, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.24382240782487, 7.595128506342872, 5.152427253200688, 4.720850755938451, 9.146821982873602, 5.580808680697649, 6.330358961529277, 10.249298134622286, 3.1366970676306547, 9.524949498045984, 3.1800845108493103, 6.626991905656934, 8.54675284969896, 6.606743238611579, 10.464705056874298, -0.5174589473490085, 7.3433987740594775, 8.955964573918846, 4.395429137007957, 4.336829292692716, 8.041755617128029, 4.710776089552414, 5.910374302905134, 9.239992080009108, 8.537626851294485, 6.584052456088602, 2.6668850305904477, 7.940961113046845, 7.421093487443338, 8.142916839718731, 7.9981744201775475, 5.046004647658577, 2.0707844137416975, 4.783929578562678, 4.6632741125492, 9.536807983805641, 5.932055362194371, 6.9391313722746695, 4.214211044218097, 7.781611144637756, 10.587259598554251, 7.495954358031373, 10.021622653337998, 8.43648717609016, 6.183309330279327, 9.38313338895874, 7.34817757311212, 8.57618917823369, 7.047841808064488, 3.7271476392600333, 7.047518493690791, 4.477170136336219, 5.250602456664669, 6.934574254899775, 9.10994423279684, 8.93773944005847, 7.877679956817563, 11.541320980892412, 7.677895883385302, 5.714709719457605, 8.3241113641073, 6.174072788990879, 8.634884060447504, 8.367387417110322, 6.506632516003355, 8.047111978832891, 5.48088046205544, 11.244434654513647, 6.036948734603545, 2.911087068309648, 8.309561373153645, 5.239868775106872, 9.80444490179316, 8.560655700417108, 7.6548827876421495, 7.543955965236521, 6.122067248898795, 6.889585006614845, 5.867467625053374, 0.22809949539670793, 2.371801859782293, 10.902753967113538, -3.3781662379470845, 5.579240957370397, 7.9019391615014385, 10.90630854911938, 8.707015484069748, 8.72715300895365, 5.956077369691694, 6.786267622461184, 4.632390415256428, 4.390179599526688, 3.5322101605460126, 7.500946551562113, 7.230484710196722, 5.102576228301138, 7.171153481785886, 9.565924711986161, 7.75492384091997, 6.692046540498862], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7553524211147256, "mean_inference_ms": 8.187937985920986, "mean_action_processing_ms": 0.5492836340313143, "mean_env_wait_ms": 24.263574446560693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04510903358459473, "StateBufferConnector_ms": 0.038407325744628906, "ViewRequirementAgentConnector_ms": 0.9849534034729004}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8305864, "num_agent_steps_trained": 8305864, "num_env_steps_sampled": 8305864, "num_env_steps_trained": 8305864, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 275.50122445220217, "num_env_steps_trained_throughput_per_sec": 275.50122445220217, "timesteps_total": 8305864, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8305864, "timers": {"training_iteration_time_ms": 56525.738, "sample_time_ms": 43335.558, "load_time_ms": 1787.973, "load_throughput": 8746.218, "learn_time_ms": 10861.083, "learn_throughput": 1439.82, "synch_weights_time_ms": 427.898}, "counters": {"num_env_steps_sampled": 8305864, "num_env_steps_trained": 8305864, "num_agent_steps_sampled": 8305864, "num_agent_steps_trained": 8305864}, "done": false, "episodes_total": 2632, "training_iteration": 536, "trial_id": "2f030_00000", "date": "2025-06-07_10-34-32", "timestamp": 1749285272, "time_this_iter_s": 56.78244876861572, "time_total_s": 10677.701992750168, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10677.701992750168, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 78.75937499999999, "ram_util_percent": 71.32499999999999, "gpu_util_percent0": 0.08046875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.337475789473685e-05, "total_loss": -0.05558910448146476, "policy_loss": -0.02682670285068029, "vf_loss": 0.015604306990280748, "vf_explained_var": 0.7301923050663688, "kl": 0.009873461071044313, "entropy": 20.23637379212813, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 103675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8321502, "num_env_steps_trained": 8321502, "num_agent_steps_sampled": 8321502, "num_agent_steps_trained": 8321502}, "sampler_results": {"episode_reward_max": 11.554655469302586, "episode_reward_min": -3.3781662379470845, "episode_reward_mean": 6.9518572966315215, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.464705056874298, -0.5174589473490085, 7.3433987740594775, 8.955964573918846, 4.395429137007957, 4.336829292692716, 8.041755617128029, 4.710776089552414, 5.910374302905134, 9.239992080009108, 8.537626851294485, 6.584052456088602, 2.6668850305904477, 7.940961113046845, 7.421093487443338, 8.142916839718731, 7.9981744201775475, 5.046004647658577, 2.0707844137416975, 4.783929578562678, 4.6632741125492, 9.536807983805641, 5.932055362194371, 6.9391313722746695, 4.214211044218097, 7.781611144637756, 10.587259598554251, 7.495954358031373, 10.021622653337998, 8.43648717609016, 6.183309330279327, 9.38313338895874, 7.34817757311212, 8.57618917823369, 7.047841808064488, 3.7271476392600333, 7.047518493690791, 4.477170136336219, 5.250602456664669, 6.934574254899775, 9.10994423279684, 8.93773944005847, 7.877679956817563, 11.541320980892412, 7.677895883385302, 5.714709719457605, 8.3241113641073, 6.174072788990879, 8.634884060447504, 8.367387417110322, 6.506632516003355, 8.047111978832891, 5.48088046205544, 11.244434654513647, 6.036948734603545, 2.911087068309648, 8.309561373153645, 5.239868775106872, 9.80444490179316, 8.560655700417108, 7.6548827876421495, 7.543955965236521, 6.122067248898795, 6.889585006614845, 5.867467625053374, 0.22809949539670793, 2.371801859782293, 10.902753967113538, -3.3781662379470845, 5.579240957370397, 7.9019391615014385, 10.90630854911938, 8.707015484069748, 8.72715300895365, 5.956077369691694, 6.786267622461184, 4.632390415256428, 4.390179599526688, 3.5322101605460126, 7.500946551562113, 7.230484710196722, 5.102576228301138, 7.171153481785886, 9.565924711986161, 7.75492384091997, 6.692046540498862, 10.530072084214533, 3.3721893904358375, 5.1341537363179786, 11.554655469302586, 10.896102775504545, 7.55541213181024, 8.771445971904436, 8.108464832149485, 9.428951940640193, 2.604290867783853, 11.52666816463507, 11.257440991050945, 4.620556021231346, 7.326393285463572], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.754563174099785, "mean_inference_ms": 8.189674243591044, "mean_action_processing_ms": 0.5494043530389188, "mean_env_wait_ms": 24.267624836489503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05316472053527832, "StateBufferConnector_ms": 0.040358543395996094, "ViewRequirementAgentConnector_ms": 0.9750337600708008}}, "episode_reward_max": 11.554655469302586, "episode_reward_min": -3.3781662379470845, "episode_reward_mean": 6.9518572966315215, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.464705056874298, -0.5174589473490085, 7.3433987740594775, 8.955964573918846, 4.395429137007957, 4.336829292692716, 8.041755617128029, 4.710776089552414, 5.910374302905134, 9.239992080009108, 8.537626851294485, 6.584052456088602, 2.6668850305904477, 7.940961113046845, 7.421093487443338, 8.142916839718731, 7.9981744201775475, 5.046004647658577, 2.0707844137416975, 4.783929578562678, 4.6632741125492, 9.536807983805641, 5.932055362194371, 6.9391313722746695, 4.214211044218097, 7.781611144637756, 10.587259598554251, 7.495954358031373, 10.021622653337998, 8.43648717609016, 6.183309330279327, 9.38313338895874, 7.34817757311212, 8.57618917823369, 7.047841808064488, 3.7271476392600333, 7.047518493690791, 4.477170136336219, 5.250602456664669, 6.934574254899775, 9.10994423279684, 8.93773944005847, 7.877679956817563, 11.541320980892412, 7.677895883385302, 5.714709719457605, 8.3241113641073, 6.174072788990879, 8.634884060447504, 8.367387417110322, 6.506632516003355, 8.047111978832891, 5.48088046205544, 11.244434654513647, 6.036948734603545, 2.911087068309648, 8.309561373153645, 5.239868775106872, 9.80444490179316, 8.560655700417108, 7.6548827876421495, 7.543955965236521, 6.122067248898795, 6.889585006614845, 5.867467625053374, 0.22809949539670793, 2.371801859782293, 10.902753967113538, -3.3781662379470845, 5.579240957370397, 7.9019391615014385, 10.90630854911938, 8.707015484069748, 8.72715300895365, 5.956077369691694, 6.786267622461184, 4.632390415256428, 4.390179599526688, 3.5322101605460126, 7.500946551562113, 7.230484710196722, 5.102576228301138, 7.171153481785886, 9.565924711986161, 7.75492384091997, 6.692046540498862, 10.530072084214533, 3.3721893904358375, 5.1341537363179786, 11.554655469302586, 10.896102775504545, 7.55541213181024, 8.771445971904436, 8.108464832149485, 9.428951940640193, 2.604290867783853, 11.52666816463507, 11.257440991050945, 4.620556021231346, 7.326393285463572], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.754563174099785, "mean_inference_ms": 8.189674243591044, "mean_action_processing_ms": 0.5494043530389188, "mean_env_wait_ms": 24.267624836489503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05316472053527832, "StateBufferConnector_ms": 0.040358543395996094, "ViewRequirementAgentConnector_ms": 0.9750337600708008}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8321502, "num_agent_steps_trained": 8321502, "num_env_steps_sampled": 8321502, "num_env_steps_trained": 8321502, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 275.36574788319683, "num_env_steps_trained_throughput_per_sec": 275.36574788319683, "timesteps_total": 8321502, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8321502, "timers": {"training_iteration_time_ms": 56625.163, "sample_time_ms": 43433.977, "load_time_ms": 1789.496, "load_throughput": 8738.772, "learn_time_ms": 10861.386, "learn_throughput": 1439.779, "synch_weights_time_ms": 432.371}, "counters": {"num_env_steps_sampled": 8321502, "num_env_steps_trained": 8321502, "num_agent_steps_sampled": 8321502, "num_agent_steps_trained": 8321502}, "done": false, "episodes_total": 2646, "training_iteration": 537, "trial_id": "2f030_00000", "date": "2025-06-07_10-35-29", "timestamp": 1749285329, "time_this_iter_s": 56.81248998641968, "time_total_s": 10734.514482736588, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10734.514482736588, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 79.0515625, "ram_util_percent": 71.55, "gpu_util_percent0": 0.07171875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.3251300000000005e-05, "total_loss": -0.05422650538003919, "policy_loss": -0.024969637620035262, "vf_loss": 0.013194884021173824, "vf_explained_var": 0.77715426271612, "kl": 0.010328992753138208, "entropy": 20.284343331076883, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 104225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8337140, "num_env_steps_trained": 8337140, "num_agent_steps_sampled": 8337140, "num_agent_steps_trained": 8337140}, "sampler_results": {"episode_reward_max": 11.554655469302586, "episode_reward_min": -3.3781662379470845, "episode_reward_mean": 7.1187491108756635, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.421093487443338, 8.142916839718731, 7.9981744201775475, 5.046004647658577, 2.0707844137416975, 4.783929578562678, 4.6632741125492, 9.536807983805641, 5.932055362194371, 6.9391313722746695, 4.214211044218097, 7.781611144637756, 10.587259598554251, 7.495954358031373, 10.021622653337998, 8.43648717609016, 6.183309330279327, 9.38313338895874, 7.34817757311212, 8.57618917823369, 7.047841808064488, 3.7271476392600333, 7.047518493690791, 4.477170136336219, 5.250602456664669, 6.934574254899775, 9.10994423279684, 8.93773944005847, 7.877679956817563, 11.541320980892412, 7.677895883385302, 5.714709719457605, 8.3241113641073, 6.174072788990879, 8.634884060447504, 8.367387417110322, 6.506632516003355, 8.047111978832891, 5.48088046205544, 11.244434654513647, 6.036948734603545, 2.911087068309648, 8.309561373153645, 5.239868775106872, 9.80444490179316, 8.560655700417108, 7.6548827876421495, 7.543955965236521, 6.122067248898795, 6.889585006614845, 5.867467625053374, 0.22809949539670793, 2.371801859782293, 10.902753967113538, -3.3781662379470845, 5.579240957370397, 7.9019391615014385, 10.90630854911938, 8.707015484069748, 8.72715300895365, 5.956077369691694, 6.786267622461184, 4.632390415256428, 4.390179599526688, 3.5322101605460126, 7.500946551562113, 7.230484710196722, 5.102576228301138, 7.171153481785886, 9.565924711986161, 7.75492384091997, 6.692046540498862, 10.530072084214533, 3.3721893904358375, 5.1341537363179786, 11.554655469302586, 10.896102775504545, 7.55541213181024, 8.771445971904436, 8.108464832149485, 9.428951940640193, 2.604290867783853, 11.52666816463507, 11.257440991050945, 4.620556021231346, 7.326393285463572, 4.910171928525906, 10.067553578007576, 7.876375720844922, 9.12855130088317, 8.324168386224587, 6.451282602396809, 7.177234266117572, 4.420531267636116, 7.686314929761952, 7.435000908536649, 7.263893161898387, 6.74580180608623, 7.438963353554916, 10.374629641758917], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7537138582474414, "mean_inference_ms": 8.191479785523942, "mean_action_processing_ms": 0.5495281146027307, "mean_env_wait_ms": 24.271892725828003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038193702697753906, "StateBufferConnector_ms": 0.03789639472961426, "ViewRequirementAgentConnector_ms": 0.9750118255615234}}, "episode_reward_max": 11.554655469302586, "episode_reward_min": -3.3781662379470845, "episode_reward_mean": 7.1187491108756635, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.421093487443338, 8.142916839718731, 7.9981744201775475, 5.046004647658577, 2.0707844137416975, 4.783929578562678, 4.6632741125492, 9.536807983805641, 5.932055362194371, 6.9391313722746695, 4.214211044218097, 7.781611144637756, 10.587259598554251, 7.495954358031373, 10.021622653337998, 8.43648717609016, 6.183309330279327, 9.38313338895874, 7.34817757311212, 8.57618917823369, 7.047841808064488, 3.7271476392600333, 7.047518493690791, 4.477170136336219, 5.250602456664669, 6.934574254899775, 9.10994423279684, 8.93773944005847, 7.877679956817563, 11.541320980892412, 7.677895883385302, 5.714709719457605, 8.3241113641073, 6.174072788990879, 8.634884060447504, 8.367387417110322, 6.506632516003355, 8.047111978832891, 5.48088046205544, 11.244434654513647, 6.036948734603545, 2.911087068309648, 8.309561373153645, 5.239868775106872, 9.80444490179316, 8.560655700417108, 7.6548827876421495, 7.543955965236521, 6.122067248898795, 6.889585006614845, 5.867467625053374, 0.22809949539670793, 2.371801859782293, 10.902753967113538, -3.3781662379470845, 5.579240957370397, 7.9019391615014385, 10.90630854911938, 8.707015484069748, 8.72715300895365, 5.956077369691694, 6.786267622461184, 4.632390415256428, 4.390179599526688, 3.5322101605460126, 7.500946551562113, 7.230484710196722, 5.102576228301138, 7.171153481785886, 9.565924711986161, 7.75492384091997, 6.692046540498862, 10.530072084214533, 3.3721893904358375, 5.1341537363179786, 11.554655469302586, 10.896102775504545, 7.55541213181024, 8.771445971904436, 8.108464832149485, 9.428951940640193, 2.604290867783853, 11.52666816463507, 11.257440991050945, 4.620556021231346, 7.326393285463572, 4.910171928525906, 10.067553578007576, 7.876375720844922, 9.12855130088317, 8.324168386224587, 6.451282602396809, 7.177234266117572, 4.420531267636116, 7.686314929761952, 7.435000908536649, 7.263893161898387, 6.74580180608623, 7.438963353554916, 10.374629641758917], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7537138582474414, "mean_inference_ms": 8.191479785523942, "mean_action_processing_ms": 0.5495281146027307, "mean_env_wait_ms": 24.271892725828003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038193702697753906, "StateBufferConnector_ms": 0.03789639472961426, "ViewRequirementAgentConnector_ms": 0.9750118255615234}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8337140, "num_agent_steps_trained": 8337140, "num_env_steps_sampled": 8337140, "num_env_steps_trained": 8337140, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 274.5021525583931, "num_env_steps_trained_throughput_per_sec": 274.5021525583931, "timesteps_total": 8337140, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8337140, "timers": {"training_iteration_time_ms": 56671.408, "sample_time_ms": 43453.255, "load_time_ms": 1800.111, "load_throughput": 8687.243, "learn_time_ms": 10880.82, "learn_throughput": 1437.208, "synch_weights_time_ms": 430.834}, "counters": {"num_env_steps_sampled": 8337140, "num_env_steps_trained": 8337140, "num_agent_steps_sampled": 8337140, "num_agent_steps_trained": 8337140}, "done": false, "episodes_total": 2660, "training_iteration": 538, "trial_id": "2f030_00000", "date": "2025-06-07_10-36-26", "timestamp": 1749285386, "time_this_iter_s": 56.980597734451294, "time_total_s": 10791.495080471039, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10791.495080471039, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 77.8446153846154, "ram_util_percent": 71.70153846153846, "gpu_util_percent0": 0.08430769230769232, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7119140625, "cur_lr": 3.3127842105263156e-05, "total_loss": -0.04819970266470178, "policy_loss": -0.019615311012550426, "vf_loss": 0.01683906578289514, "vf_explained_var": 0.7438577753847295, "kl": 0.009871946791483259, "entropy": 20.332043888785623, "entropy_coeff": 0.002}, "model": {}, "num_grad_updates_lifetime": 104775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 8352778, "num_env_steps_trained": 8352778, "num_agent_steps_sampled": 8352778, "num_agent_steps_trained": 8352778}, "sampler_results": {"episode_reward_max": 12.393359779192975, "episode_reward_min": -3.3781662379470845, "episode_reward_mean": 7.1842590686909285, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.021622653337998, 8.43648717609016, 6.183309330279327, 9.38313338895874, 7.34817757311212, 8.57618917823369, 7.047841808064488, 3.7271476392600333, 7.047518493690791, 4.477170136336219, 5.250602456664669, 6.934574254899775, 9.10994423279684, 8.93773944005847, 7.877679956817563, 11.541320980892412, 7.677895883385302, 5.714709719457605, 8.3241113641073, 6.174072788990879, 8.634884060447504, 8.367387417110322, 6.506632516003355, 8.047111978832891, 5.48088046205544, 11.244434654513647, 6.036948734603545, 2.911087068309648, 8.309561373153645, 5.239868775106872, 9.80444490179316, 8.560655700417108, 7.6548827876421495, 7.543955965236521, 6.122067248898795, 6.889585006614845, 5.867467625053374, 0.22809949539670793, 2.371801859782293, 10.902753967113538, -3.3781662379470845, 5.579240957370397, 7.9019391615014385, 10.90630854911938, 8.707015484069748, 8.72715300895365, 5.956077369691694, 6.786267622461184, 4.632390415256428, 4.390179599526688, 3.5322101605460126, 7.500946551562113, 7.230484710196722, 5.102576228301138, 7.171153481785886, 9.565924711986161, 7.75492384091997, 6.692046540498862, 10.530072084214533, 3.3721893904358375, 5.1341537363179786, 11.554655469302586, 10.896102775504545, 7.55541213181024, 8.771445971904436, 8.108464832149485, 9.428951940640193, 2.604290867783853, 11.52666816463507, 11.257440991050945, 4.620556021231346, 7.326393285463572, 4.910171928525906, 10.067553578007576, 7.876375720844922, 9.12855130088317, 8.324168386224587, 6.451282602396809, 7.177234266117572, 4.420531267636116, 7.686314929761952, 7.435000908536649, 7.263893161898387, 6.74580180608623, 7.438963353554916, 10.374629641758917, 5.123441744605001, 7.093094085861167, 8.051326116612776, 12.393359779192975, 6.926255913892696, 7.396966883334206, 9.50283445978402, 6.967663963757563, 3.3943392056583224, 7.619948881864168, 6.5216301752446055, 9.475743556542747, 3.2088909075438456, 5.488708471200355], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.752940843981612, "mean_inference_ms": 8.193191012916529, "mean_action_processing_ms": 0.549653875983683, "mean_env_wait_ms": 24.275926634648567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03873729705810547, "StateBufferConnector_ms": 0.044920921325683594, "ViewRequirementAgentConnector_ms": 1.0283381938934326}}, "episode_reward_max": 12.393359779192975, "episode_reward_min": -3.3781662379470845, "episode_reward_mean": 7.1842590686909285, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.021622653337998, 8.43648717609016, 6.183309330279327, 9.38313338895874, 7.34817757311212, 8.57618917823369, 7.047841808064488, 3.7271476392600333, 7.047518493690791, 4.477170136336219, 5.250602456664669, 6.934574254899775, 9.10994423279684, 8.93773944005847, 7.877679956817563, 11.541320980892412, 7.677895883385302, 5.714709719457605, 8.3241113641073, 6.174072788990879, 8.634884060447504, 8.367387417110322, 6.506632516003355, 8.047111978832891, 5.48088046205544, 11.244434654513647, 6.036948734603545, 2.911087068309648, 8.309561373153645, 5.239868775106872, 9.80444490179316, 8.560655700417108, 7.6548827876421495, 7.543955965236521, 6.122067248898795, 6.889585006614845, 5.867467625053374, 0.22809949539670793, 2.371801859782293, 10.902753967113538, -3.3781662379470845, 5.579240957370397, 7.9019391615014385, 10.90630854911938, 8.707015484069748, 8.72715300895365, 5.956077369691694, 6.786267622461184, 4.632390415256428, 4.390179599526688, 3.5322101605460126, 7.500946551562113, 7.230484710196722, 5.102576228301138, 7.171153481785886, 9.565924711986161, 7.75492384091997, 6.692046540498862, 10.530072084214533, 3.3721893904358375, 5.1341537363179786, 11.554655469302586, 10.896102775504545, 7.55541213181024, 8.771445971904436, 8.108464832149485, 9.428951940640193, 2.604290867783853, 11.52666816463507, 11.257440991050945, 4.620556021231346, 7.326393285463572, 4.910171928525906, 10.067553578007576, 7.876375720844922, 9.12855130088317, 8.324168386224587, 6.451282602396809, 7.177234266117572, 4.420531267636116, 7.686314929761952, 7.435000908536649, 7.263893161898387, 6.74580180608623, 7.438963353554916, 10.374629641758917, 5.123441744605001, 7.093094085861167, 8.051326116612776, 12.393359779192975, 6.926255913892696, 7.396966883334206, 9.50283445978402, 6.967663963757563, 3.3943392056583224, 7.619948881864168, 6.5216301752446055, 9.475743556542747, 3.2088909075438456, 5.488708471200355], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.752940843981612, "mean_inference_ms": 8.193191012916529, "mean_action_processing_ms": 0.549653875983683, "mean_env_wait_ms": 24.275926634648567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03873729705810547, "StateBufferConnector_ms": 0.044920921325683594, "ViewRequirementAgentConnector_ms": 1.0283381938934326}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8352778, "num_agent_steps_trained": 8352778, "num_env_steps_sampled": 8352778, "num_env_steps_trained": 8352778, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 272.296500721609, "num_env_steps_trained_throughput_per_sec": 272.296500721609, "timesteps_total": 8352778, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 8352778, "timers": {"training_iteration_time_ms": 56717.876, "sample_time_ms": 43434.676, "load_time_ms": 1798.3, "load_throughput": 8695.991, "learn_time_ms": 10942.869, "learn_throughput": 1429.059, "synch_weights_time_ms": 429.764}, "counters": {"num_env_steps_sampled": 8352778, "num_env_steps_trained": 8352778, "num_agent_steps_sampled": 8352778, "num_agent_steps_trained": 8352778}, "done": false, "episodes_total": 2674, "training_iteration": 539, "trial_id": "2f030_00000", "date": "2025-06-07_10-37-24", "timestamp": 1749285444, "time_this_iter_s": 57.44957113265991, "time_total_s": 10848.944651603699, "pid": 114704, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 384736.0001, "r_mean": 0.00416787548755006, "r_var": 758.6393472961946, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [384737, 53134.33847854618, 5.761889928500612e+16], "realized_pnl": [384737, 38937.3793919131, 9.23834938051817e+16], "compounded_returns": [384737, 16905.559140276608, 68421208649705.88], "balance": [384737, 32192205.1521465, 2.3133179513943566e+20], "position_value": [384737, 184164.20611313038, 1.2063401081113446e+17], "current_position_size": [384737, 920771.109972951, 3.0158469722511995e+18], "last_log_ret": [384737, 0.009278966920867538, 674.974975860418], "sortino_ratio": [384737, 27.676089459391385, 30944719773176.305], "rolling_pnl_sigma": [384737, 0.017510714844182873, 391.0534623465048], "portfolio_cash_ratio": [384737, 0.8746796960242733, 24871.895939551257], "free_collateral": [384737, 32412879.39637785, 2.2887840600138056e+20], "mm_reqs": [384737, 16690.199759636387, 4219786227373631.5], "unrealized_pnl_0": [384737, 4.791226371010521, 231872912361.97794], "unrealized_pnl_1": [384737, 5.3475391019061975, 1053917869266.14], "unrealized_pnl_2": [384737, 26678.56959702857, 8340465401414441.0], "unrealized_pnl_3": [384737, 48920.07213811186, 1.3170801041063406e+17], "unrealized_pnl_4": [384737, 114.90771132671618, 4398899889290.642], "unrealized_pnl_5": [384737, 5492.622820258704, 1309655638466726.2], "unrealized_pnl_6": [384737, 70.37489151323798, 3599909981991.248], "unrealized_pnl_7": [384737, 25.952882858980374, 547393931025.83386], "unrealized_pnl_8": [384737, 33.301196274249634, 496810145683.7956], "unrealized_pnl_9": [384737, 1556.32606549306, 176756668248074.22], "margin_usage_ratio": [384737, 0.004572439887978512, 35.09114778047366]}, "pcr_min_ew": 0.9974069113355711, "pcr_max_ew": 1.000000000000006}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000284D60775B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [6200000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [6200000.0, 0.005], [7000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10848.944651603699, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 78.84, "ram_util_percent": 71.48461538461538, "gpu_util_percent0": 0.07707692307692307, "vram_util_percent0": 0.8592122395833333}}
