{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.052734375, "cur_lr": 0.00010000000000000002, "total_loss": -0.23761908878170124, "policy_loss": -0.04012811183696613, "vf_loss": 0.013091777927580883, "vf_explained_var": 0.7369782824949784, "kl": 0.027099190531009208, "entropy": 20.28475745114413, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2008818, "num_env_steps_trained": 2008818, "num_agent_steps_sampled": 2008818, "num_agent_steps_trained": 2008818}, "sampler_results": {"episode_reward_max": 10.701660238610001, "episode_reward_min": 3.591258345704118, "episode_reward_mean": 6.537801161388158, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.4069539363759604, 6.837920870377424, 10.701660238610001, 7.663856759889065, 6.055684075013728, 8.840257068417504, 5.481485188774336, 5.222258129632442, 4.99582127800241, 5.66030023735552, 3.591258345704118, 5.854807771673253, 9.57595221051401, 5.6410001490944515], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4489629279004317, "mean_inference_ms": 6.269702392254466, "mean_action_processing_ms": 0.5355909325843144, "mean_env_wait_ms": 23.415868312173753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07455519267490932, "StateBufferConnector_ms": 0.018080643245152066, "ViewRequirementAgentConnector_ms": 0.5431124142238072}}, "episode_reward_max": 10.701660238610001, "episode_reward_min": 3.591258345704118, "episode_reward_mean": 6.537801161388158, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.4069539363759604, 6.837920870377424, 10.701660238610001, 7.663856759889065, 6.055684075013728, 8.840257068417504, 5.481485188774336, 5.222258129632442, 4.99582127800241, 5.66030023735552, 3.591258345704118, 5.854807771673253, 9.57595221051401, 5.6410001490944515], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4489629279004317, "mean_inference_ms": 6.269702392254466, "mean_action_processing_ms": 0.5355909325843144, "mean_env_wait_ms": 23.415868312173753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07455519267490932, "StateBufferConnector_ms": 0.018080643245152066, "ViewRequirementAgentConnector_ms": 0.5431124142238072}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2008818, "num_agent_steps_trained": 2008818, "num_env_steps_sampled": 2008818, "num_env_steps_trained": 2008818, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 321.7074863973856, "num_env_steps_trained_throughput_per_sec": 321.7074863973856, "timesteps_total": 2008818, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2008818, "timers": {"training_iteration_time_ms": 48609.375, "sample_time_ms": 36089.327, "load_time_ms": 875.914, "load_throughput": 17853.349, "learn_time_ms": 11320.203, "learn_throughput": 1381.424, "synch_weights_time_ms": 306.428}, "counters": {"num_env_steps_sampled": 2008818, "num_env_steps_trained": 2008818, "num_agent_steps_sampled": 2008818, "num_agent_steps_trained": 2008818}, "done": false, "episodes_total": 14, "training_iteration": 133, "trial_id": "c5092_00000", "date": "2025-06-08_09-41-40", "timestamp": 1749368500, "time_this_iter_s": 48.64948034286499, "time_total_s": 48.64948034286499, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 48.64948034286499, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 75.34310344827587, "ram_util_percent": 58.982758620689665, "gpu_util_percent0": 0.0853448275862069, "vram_util_percent0": 0.04634181932471264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.052734375, "cur_lr": 7.991181999999999e-05, "total_loss": -0.1690236138205298, "policy_loss": -0.038859156004592395, "vf_loss": 0.014370990920473229, "vf_explained_var": 0.7646374746886166, "kl": 0.02782257601481185, "entropy": 20.436496295928954, "entropy_coeff": 0.00665197}, "model": {}, "num_grad_updates_lifetime": 825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2024456, "num_env_steps_trained": 2024456, "num_agent_steps_sampled": 2024456, "num_agent_steps_trained": 2024456}, "sampler_results": {"episode_reward_max": 11.120488519513067, "episode_reward_min": 1.5486886498457713, "episode_reward_mean": 6.407471702945045, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.4069539363759604, 6.837920870377424, 10.701660238610001, 7.663856759889065, 6.055684075013728, 8.840257068417504, 5.481485188774336, 5.222258129632442, 4.99582127800241, 5.66030023735552, 3.591258345704118, 5.854807771673253, 9.57595221051401, 5.6410001490944515, 7.9287890588763394, 5.087228997362045, 11.120488519513067, 5.495305914024472, 2.5944954490252097, 4.995224237746139, 7.7027445260843255, 7.581443632651035, 1.5486886498457713, 4.421285627544057, 6.240352809883253, 8.973056649456106, 5.948191297347817, 8.242696053667407], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4555860058189969, "mean_inference_ms": 6.271444914822088, "mean_action_processing_ms": 0.523079477751386, "mean_env_wait_ms": 23.016955583604723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04792554037911551, "StateBufferConnector_ms": 0.023395674569266185, "ViewRequirementAgentConnector_ms": 0.5560943058558873}}, "episode_reward_max": 11.120488519513067, "episode_reward_min": 1.5486886498457713, "episode_reward_mean": 6.407471702945045, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.4069539363759604, 6.837920870377424, 10.701660238610001, 7.663856759889065, 6.055684075013728, 8.840257068417504, 5.481485188774336, 5.222258129632442, 4.99582127800241, 5.66030023735552, 3.591258345704118, 5.854807771673253, 9.57595221051401, 5.6410001490944515, 7.9287890588763394, 5.087228997362045, 11.120488519513067, 5.495305914024472, 2.5944954490252097, 4.995224237746139, 7.7027445260843255, 7.581443632651035, 1.5486886498457713, 4.421285627544057, 6.240352809883253, 8.973056649456106, 5.948191297347817, 8.242696053667407], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4555860058189969, "mean_inference_ms": 6.271444914822088, "mean_action_processing_ms": 0.523079477751386, "mean_env_wait_ms": 23.016955583604723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04792554037911551, "StateBufferConnector_ms": 0.023395674569266185, "ViewRequirementAgentConnector_ms": 0.5560943058558873}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2024456, "num_agent_steps_trained": 2024456, "num_env_steps_sampled": 2024456, "num_env_steps_trained": 2024456, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 337.93672878725846, "num_env_steps_trained_throughput_per_sec": 337.93672878725846, "timesteps_total": 2024456, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2024456, "timers": {"training_iteration_time_ms": 47441.65, "sample_time_ms": 35131.519, "load_time_ms": 738.645, "load_throughput": 21171.193, "learn_time_ms": 11215.867, "learn_throughput": 1394.275, "synch_weights_time_ms": 334.871}, "counters": {"num_env_steps_sampled": 2024456, "num_env_steps_trained": 2024456, "num_agent_steps_sampled": 2024456, "num_agent_steps_trained": 2024456}, "done": false, "episodes_total": 28, "training_iteration": 134, "trial_id": "c5092_00000", "date": "2025-06-08_09-42-26", "timestamp": 1749368546, "time_this_iter_s": 46.283923864364624, "time_total_s": 94.93340420722961, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 94.93340420722961, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 76.86481481481484, "ram_util_percent": 61.2462962962963, "gpu_util_percent0": 0.09314814814814813, "vram_util_percent0": 0.13236038773148145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.052734375, "cur_lr": 7.975544000000002e-05, "total_loss": -0.16878921275471592, "policy_loss": -0.03958896357428537, "vf_loss": 0.014232052836397831, "vf_explained_var": 0.739876981865276, "kl": 0.028221158321989192, "entropy": 20.368245561773126, "entropy_coeff": 0.006625906666666667}, "model": {}, "num_grad_updates_lifetime": 1375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2040094, "num_env_steps_trained": 2040094, "num_agent_steps_sampled": 2040094, "num_agent_steps_trained": 2040094}, "sampler_results": {"episode_reward_max": 11.120488519513067, "episode_reward_min": 1.5486886498457713, "episode_reward_mean": 6.360442897095193, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.4069539363759604, 6.837920870377424, 10.701660238610001, 7.663856759889065, 6.055684075013728, 8.840257068417504, 5.481485188774336, 5.222258129632442, 4.99582127800241, 5.66030023735552, 3.591258345704118, 5.854807771673253, 9.57595221051401, 5.6410001490944515, 7.9287890588763394, 5.087228997362045, 11.120488519513067, 5.495305914024472, 2.5944954490252097, 4.995224237746139, 7.7027445260843255, 7.581443632651035, 1.5486886498457713, 4.421285627544057, 6.240352809883253, 8.973056649456106, 5.948191297347817, 8.242696053667407, 4.13951594394742, 6.474927753935458, 6.0152225033083795, 6.730052696569157, 7.20499085317248, 5.217007686609684, 8.102185494604697, 4.523179325994315, 6.973328925876149, 6.323987487236603, 9.140929014560582, 3.728738421003633, 7.564753821355101, 5.590574067363213], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.479259714729802, "mean_inference_ms": 6.2744275718613, "mean_action_processing_ms": 0.5180343253694434, "mean_env_wait_ms": 22.870376564382234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036763577234177364, "StateBufferConnector_ms": 0.02873681840442476, "ViewRequirementAgentConnector_ms": 0.5396456945510137}}, "episode_reward_max": 11.120488519513067, "episode_reward_min": 1.5486886498457713, "episode_reward_mean": 6.360442897095193, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.4069539363759604, 6.837920870377424, 10.701660238610001, 7.663856759889065, 6.055684075013728, 8.840257068417504, 5.481485188774336, 5.222258129632442, 4.99582127800241, 5.66030023735552, 3.591258345704118, 5.854807771673253, 9.57595221051401, 5.6410001490944515, 7.9287890588763394, 5.087228997362045, 11.120488519513067, 5.495305914024472, 2.5944954490252097, 4.995224237746139, 7.7027445260843255, 7.581443632651035, 1.5486886498457713, 4.421285627544057, 6.240352809883253, 8.973056649456106, 5.948191297347817, 8.242696053667407, 4.13951594394742, 6.474927753935458, 6.0152225033083795, 6.730052696569157, 7.20499085317248, 5.217007686609684, 8.102185494604697, 4.523179325994315, 6.973328925876149, 6.323987487236603, 9.140929014560582, 3.728738421003633, 7.564753821355101, 5.590574067363213], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.479259714729802, "mean_inference_ms": 6.2744275718613, "mean_action_processing_ms": 0.5180343253694434, "mean_env_wait_ms": 22.870376564382234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036763577234177364, "StateBufferConnector_ms": 0.02873681840442476, "ViewRequirementAgentConnector_ms": 0.5396456945510137}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040094, "num_agent_steps_trained": 2040094, "num_env_steps_sampled": 2040094, "num_env_steps_trained": 2040094, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 330.608017150389, "num_env_steps_trained_throughput_per_sec": 330.608017150389, "timesteps_total": 2040094, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2040094, "timers": {"training_iteration_time_ms": 47394.676, "sample_time_ms": 35146.176, "load_time_ms": 702.736, "load_throughput": 22253.008, "learn_time_ms": 11199.832, "learn_throughput": 1396.271, "synch_weights_time_ms": 324.73}, "counters": {"num_env_steps_sampled": 2040094, "num_env_steps_trained": 2040094, "num_agent_steps_sampled": 2040094, "num_agent_steps_trained": 2040094}, "done": false, "episodes_total": 42, "training_iteration": 135, "trial_id": "c5092_00000", "date": "2025-06-08_09-43-13", "timestamp": 1749368593, "time_this_iter_s": 47.30449032783508, "time_total_s": 142.2378945350647, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 142.2378945350647, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 78.1909090909091, "ram_util_percent": 60.107272727272736, "gpu_util_percent0": 0.09381818181818184, "vram_util_percent0": 0.1883138020833334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.052734375, "cur_lr": 7.959906000000001e-05, "total_loss": -0.15726073766444726, "policy_loss": -0.027655560222814197, "vf_loss": 0.013054430624893443, "vf_explained_var": 0.7519881600683386, "kl": 0.029057917473441927, "entropy": 20.46319090062922, "entropy_coeff": 0.006599843333333334}, "model": {}, "num_grad_updates_lifetime": 1925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2055732, "num_env_steps_trained": 2055732, "num_agent_steps_sampled": 2055732, "num_agent_steps_trained": 2055732}, "sampler_results": {"episode_reward_max": 11.120488519513067, "episode_reward_min": 1.5486886498457713, "episode_reward_mean": 6.223152124626485, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.4069539363759604, 6.837920870377424, 10.701660238610001, 7.663856759889065, 6.055684075013728, 8.840257068417504, 5.481485188774336, 5.222258129632442, 4.99582127800241, 5.66030023735552, 3.591258345704118, 5.854807771673253, 9.57595221051401, 5.6410001490944515, 7.9287890588763394, 5.087228997362045, 11.120488519513067, 5.495305914024472, 2.5944954490252097, 4.995224237746139, 7.7027445260843255, 7.581443632651035, 1.5486886498457713, 4.421285627544057, 6.240352809883253, 8.973056649456106, 5.948191297347817, 8.242696053667407, 4.13951594394742, 6.474927753935458, 6.0152225033083795, 6.730052696569157, 7.20499085317248, 5.217007686609684, 8.102185494604697, 4.523179325994315, 6.973328925876149, 6.323987487236603, 9.140929014560582, 3.728738421003633, 7.564753821355101, 5.590574067363213, 2.401543327295774, 7.231923804159378, 7.779513847565727, 5.116814043544216, 6.315754285527489, 7.186592085255205, 8.93980160558183, 6.1246951517997905, 3.0002314898396643, 3.3065693998701318, 4.949101839011328, 4.995420066139491, 5.795421794010245, 8.21453456148472], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4949206190373796, "mean_inference_ms": 6.291254090988807, "mean_action_processing_ms": 0.515884181068836, "mean_env_wait_ms": 22.85538783898735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03112639699663435, "StateBufferConnector_ms": 0.026819535664149692, "ViewRequirementAgentConnector_ms": 0.5199147122246879}}, "episode_reward_max": 11.120488519513067, "episode_reward_min": 1.5486886498457713, "episode_reward_mean": 6.223152124626485, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.4069539363759604, 6.837920870377424, 10.701660238610001, 7.663856759889065, 6.055684075013728, 8.840257068417504, 5.481485188774336, 5.222258129632442, 4.99582127800241, 5.66030023735552, 3.591258345704118, 5.854807771673253, 9.57595221051401, 5.6410001490944515, 7.9287890588763394, 5.087228997362045, 11.120488519513067, 5.495305914024472, 2.5944954490252097, 4.995224237746139, 7.7027445260843255, 7.581443632651035, 1.5486886498457713, 4.421285627544057, 6.240352809883253, 8.973056649456106, 5.948191297347817, 8.242696053667407, 4.13951594394742, 6.474927753935458, 6.0152225033083795, 6.730052696569157, 7.20499085317248, 5.217007686609684, 8.102185494604697, 4.523179325994315, 6.973328925876149, 6.323987487236603, 9.140929014560582, 3.728738421003633, 7.564753821355101, 5.590574067363213, 2.401543327295774, 7.231923804159378, 7.779513847565727, 5.116814043544216, 6.315754285527489, 7.186592085255205, 8.93980160558183, 6.1246951517997905, 3.0002314898396643, 3.3065693998701318, 4.949101839011328, 4.995420066139491, 5.795421794010245, 8.21453456148472], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4949206190373796, "mean_inference_ms": 6.291254090988807, "mean_action_processing_ms": 0.515884181068836, "mean_env_wait_ms": 22.85538783898735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03112639699663435, "StateBufferConnector_ms": 0.026819535664149692, "ViewRequirementAgentConnector_ms": 0.5199147122246879}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2055732, "num_agent_steps_trained": 2055732, "num_env_steps_sampled": 2055732, "num_env_steps_trained": 2055732, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 322.4005663823243, "num_env_steps_trained_throughput_per_sec": 322.4005663823243, "timesteps_total": 2055732, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2055732, "timers": {"training_iteration_time_ms": 47672.227, "sample_time_ms": 35479.743, "load_time_ms": 654.87, "load_throughput": 23879.543, "learn_time_ms": 11198.55, "learn_throughput": 1396.431, "synch_weights_time_ms": 315.145}, "counters": {"num_env_steps_sampled": 2055732, "num_env_steps_trained": 2055732, "num_agent_steps_sampled": 2055732, "num_agent_steps_trained": 2055732}, "done": false, "episodes_total": 56, "training_iteration": 136, "trial_id": "c5092_00000", "date": "2025-06-08_09-44-02", "timestamp": 1749368642, "time_this_iter_s": 48.50487756729126, "time_total_s": 190.74277210235596, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 190.74277210235596, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 78.1232142857143, "ram_util_percent": 58.78035714285715, "gpu_util_percent0": 0.08767857142857143, "vram_util_percent0": 0.18831380208333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.052734375, "cur_lr": 7.944268e-05, "total_loss": -0.15799996413354, "policy_loss": -0.02897889254317058, "vf_loss": 0.012603991052389822, "vf_explained_var": 0.7687743204290216, "kl": 0.02819823565706346, "entropy": 20.42801647012884, "entropy_coeff": 0.00657378}, "model": {}, "num_grad_updates_lifetime": 2475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2071370, "num_env_steps_trained": 2071370, "num_agent_steps_sampled": 2071370, "num_agent_steps_trained": 2071370}, "sampler_results": {"episode_reward_max": 11.146201330409344, "episode_reward_min": 1.5486886498457713, "episode_reward_mean": 6.2319032653844895, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.4069539363759604, 6.837920870377424, 10.701660238610001, 7.663856759889065, 6.055684075013728, 8.840257068417504, 5.481485188774336, 5.222258129632442, 4.99582127800241, 5.66030023735552, 3.591258345704118, 5.854807771673253, 9.57595221051401, 5.6410001490944515, 7.9287890588763394, 5.087228997362045, 11.120488519513067, 5.495305914024472, 2.5944954490252097, 4.995224237746139, 7.7027445260843255, 7.581443632651035, 1.5486886498457713, 4.421285627544057, 6.240352809883253, 8.973056649456106, 5.948191297347817, 8.242696053667407, 4.13951594394742, 6.474927753935458, 6.0152225033083795, 6.730052696569157, 7.20499085317248, 5.217007686609684, 8.102185494604697, 4.523179325994315, 6.973328925876149, 6.323987487236603, 9.140929014560582, 3.728738421003633, 7.564753821355101, 5.590574067363213, 2.401543327295774, 7.231923804159378, 7.779513847565727, 5.116814043544216, 6.315754285527489, 7.186592085255205, 8.93980160558183, 6.1246951517997905, 3.0002314898396643, 3.3065693998701318, 4.949101839011328, 4.995420066139491, 5.795421794010245, 8.21453456148472, 7.43481303309517, 6.956512017001786, 7.833525655564042, 4.9977058056246895, 6.254072463418269, 6.883166139053204, 4.398609967782661, 4.992019593858154, 3.990211927316071, 11.146201330409344, 6.132030996238489, 3.6331884667558825, 4.534988350081049, 8.549663851632346], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5060488172426578, "mean_inference_ms": 6.31100861431216, "mean_action_processing_ms": 0.5148163865036772, "mean_env_wait_ms": 22.869094917595085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030564240046909878, "StateBufferConnector_ms": 0.027225698743547713, "ViewRequirementAgentConnector_ms": 0.5287112508501325}}, "episode_reward_max": 11.146201330409344, "episode_reward_min": 1.5486886498457713, "episode_reward_mean": 6.2319032653844895, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.4069539363759604, 6.837920870377424, 10.701660238610001, 7.663856759889065, 6.055684075013728, 8.840257068417504, 5.481485188774336, 5.222258129632442, 4.99582127800241, 5.66030023735552, 3.591258345704118, 5.854807771673253, 9.57595221051401, 5.6410001490944515, 7.9287890588763394, 5.087228997362045, 11.120488519513067, 5.495305914024472, 2.5944954490252097, 4.995224237746139, 7.7027445260843255, 7.581443632651035, 1.5486886498457713, 4.421285627544057, 6.240352809883253, 8.973056649456106, 5.948191297347817, 8.242696053667407, 4.13951594394742, 6.474927753935458, 6.0152225033083795, 6.730052696569157, 7.20499085317248, 5.217007686609684, 8.102185494604697, 4.523179325994315, 6.973328925876149, 6.323987487236603, 9.140929014560582, 3.728738421003633, 7.564753821355101, 5.590574067363213, 2.401543327295774, 7.231923804159378, 7.779513847565727, 5.116814043544216, 6.315754285527489, 7.186592085255205, 8.93980160558183, 6.1246951517997905, 3.0002314898396643, 3.3065693998701318, 4.949101839011328, 4.995420066139491, 5.795421794010245, 8.21453456148472, 7.43481303309517, 6.956512017001786, 7.833525655564042, 4.9977058056246895, 6.254072463418269, 6.883166139053204, 4.398609967782661, 4.992019593858154, 3.990211927316071, 11.146201330409344, 6.132030996238489, 3.6331884667558825, 4.534988350081049, 8.549663851632346], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5060488172426578, "mean_inference_ms": 6.31100861431216, "mean_action_processing_ms": 0.5148163865036772, "mean_env_wait_ms": 22.869094917595085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030564240046909878, "StateBufferConnector_ms": 0.027225698743547713, "ViewRequirementAgentConnector_ms": 0.5287112508501325}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2071370, "num_agent_steps_trained": 2071370, "num_env_steps_sampled": 2071370, "num_env_steps_trained": 2071370, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 324.1479320622418, "num_env_steps_trained_throughput_per_sec": 324.1479320622418, "timesteps_total": 2071370, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2071370, "timers": {"training_iteration_time_ms": 47786.462, "sample_time_ms": 35658.991, "load_time_ms": 620.862, "load_throughput": 25187.565, "learn_time_ms": 11168.559, "learn_throughput": 1400.181, "synch_weights_time_ms": 312.51}, "counters": {"num_env_steps_sampled": 2071370, "num_env_steps_trained": 2071370, "num_agent_steps_sampled": 2071370, "num_agent_steps_trained": 2071370}, "done": false, "episodes_total": 70, "training_iteration": 137, "trial_id": "c5092_00000", "date": "2025-06-08_09-44-50", "timestamp": 1749368690, "time_this_iter_s": 48.24340510368347, "time_total_s": 238.98617720603943, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 238.98617720603943, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 78.11785714285715, "ram_util_percent": 58.857142857142854, "gpu_util_percent0": 0.08339285714285714, "vram_util_percent0": 0.18831380208333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.052734375, "cur_lr": 7.92863e-05, "total_loss": -0.16401819297916848, "policy_loss": -0.03587931015407032, "vf_loss": 0.013187195609577677, "vf_explained_var": 0.7721143106980757, "kl": 0.028474690471459483, "entropy": 20.403546394001353, "entropy_coeff": 0.006547716666666667}, "model": {}, "num_grad_updates_lifetime": 3025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2087008, "num_env_steps_trained": 2087008, "num_agent_steps_sampled": 2087008, "num_agent_steps_trained": 2087008}, "sampler_results": {"episode_reward_max": 11.146201330409344, "episode_reward_min": 1.5486886498457713, "episode_reward_mean": 6.296257743008921, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.4069539363759604, 6.837920870377424, 10.701660238610001, 7.663856759889065, 6.055684075013728, 8.840257068417504, 5.481485188774336, 5.222258129632442, 4.99582127800241, 5.66030023735552, 3.591258345704118, 5.854807771673253, 9.57595221051401, 5.6410001490944515, 7.9287890588763394, 5.087228997362045, 11.120488519513067, 5.495305914024472, 2.5944954490252097, 4.995224237746139, 7.7027445260843255, 7.581443632651035, 1.5486886498457713, 4.421285627544057, 6.240352809883253, 8.973056649456106, 5.948191297347817, 8.242696053667407, 4.13951594394742, 6.474927753935458, 6.0152225033083795, 6.730052696569157, 7.20499085317248, 5.217007686609684, 8.102185494604697, 4.523179325994315, 6.973328925876149, 6.323987487236603, 9.140929014560582, 3.728738421003633, 7.564753821355101, 5.590574067363213, 2.401543327295774, 7.231923804159378, 7.779513847565727, 5.116814043544216, 6.315754285527489, 7.186592085255205, 8.93980160558183, 6.1246951517997905, 3.0002314898396643, 3.3065693998701318, 4.949101839011328, 4.995420066139491, 5.795421794010245, 8.21453456148472, 7.43481303309517, 6.956512017001786, 7.833525655564042, 4.9977058056246895, 6.254072463418269, 6.883166139053204, 4.398609967782661, 4.992019593858154, 3.990211927316071, 11.146201330409344, 6.132030996238489, 3.6331884667558825, 4.534988350081049, 8.549663851632346, 8.079953367686544, 8.21413266723904, 9.030510261626626, 2.0208557357145027, 8.20255573642542, 5.107813861797437, 7.748703393386301, 7.999890073643866, 5.22983367395633, 7.102050086290167, 7.486109230887012, 8.966568345058816, 4.24479052932996, 3.2186548727930533], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.515152443921701, "mean_inference_ms": 6.3321764017850475, "mean_action_processing_ms": 0.5150433686082754, "mean_env_wait_ms": 22.90358347685479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03398600078764416, "StateBufferConnector_ms": 0.027449925740559895, "ViewRequirementAgentConnector_ms": 0.5370534601665679}}, "episode_reward_max": 11.146201330409344, "episode_reward_min": 1.5486886498457713, "episode_reward_mean": 6.296257743008921, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.4069539363759604, 6.837920870377424, 10.701660238610001, 7.663856759889065, 6.055684075013728, 8.840257068417504, 5.481485188774336, 5.222258129632442, 4.99582127800241, 5.66030023735552, 3.591258345704118, 5.854807771673253, 9.57595221051401, 5.6410001490944515, 7.9287890588763394, 5.087228997362045, 11.120488519513067, 5.495305914024472, 2.5944954490252097, 4.995224237746139, 7.7027445260843255, 7.581443632651035, 1.5486886498457713, 4.421285627544057, 6.240352809883253, 8.973056649456106, 5.948191297347817, 8.242696053667407, 4.13951594394742, 6.474927753935458, 6.0152225033083795, 6.730052696569157, 7.20499085317248, 5.217007686609684, 8.102185494604697, 4.523179325994315, 6.973328925876149, 6.323987487236603, 9.140929014560582, 3.728738421003633, 7.564753821355101, 5.590574067363213, 2.401543327295774, 7.231923804159378, 7.779513847565727, 5.116814043544216, 6.315754285527489, 7.186592085255205, 8.93980160558183, 6.1246951517997905, 3.0002314898396643, 3.3065693998701318, 4.949101839011328, 4.995420066139491, 5.795421794010245, 8.21453456148472, 7.43481303309517, 6.956512017001786, 7.833525655564042, 4.9977058056246895, 6.254072463418269, 6.883166139053204, 4.398609967782661, 4.992019593858154, 3.990211927316071, 11.146201330409344, 6.132030996238489, 3.6331884667558825, 4.534988350081049, 8.549663851632346, 8.079953367686544, 8.21413266723904, 9.030510261626626, 2.0208557357145027, 8.20255573642542, 5.107813861797437, 7.748703393386301, 7.999890073643866, 5.22983367395633, 7.102050086290167, 7.486109230887012, 8.966568345058816, 4.24479052932996, 3.2186548727930533], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.515152443921701, "mean_inference_ms": 6.3321764017850475, "mean_action_processing_ms": 0.5150433686082754, "mean_env_wait_ms": 22.90358347685479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03398600078764416, "StateBufferConnector_ms": 0.027449925740559895, "ViewRequirementAgentConnector_ms": 0.5370534601665679}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2087008, "num_agent_steps_trained": 2087008, "num_env_steps_sampled": 2087008, "num_env_steps_trained": 2087008, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 318.32529503456317, "num_env_steps_trained_throughput_per_sec": 318.32529503456317, "timesteps_total": 2087008, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2087008, "timers": {"training_iteration_time_ms": 48009.693, "sample_time_ms": 35923.52, "load_time_ms": 605.598, "load_throughput": 25822.405, "learn_time_ms": 11146.067, "learn_throughput": 1403.006, "synch_weights_time_ms": 309.39}, "counters": {"num_env_steps_sampled": 2087008, "num_env_steps_trained": 2087008, "num_agent_steps_sampled": 2087008, "num_agent_steps_trained": 2087008}, "done": false, "episodes_total": 84, "training_iteration": 138, "trial_id": "c5092_00000", "date": "2025-06-08_09-45-39", "timestamp": 1749368739, "time_this_iter_s": 49.13686680793762, "time_total_s": 288.12304401397705, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 288.12304401397705, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 78.06140350877193, "ram_util_percent": 59.050877192982455, "gpu_util_percent0": 0.08649122807017544, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.052734375, "cur_lr": 7.912992e-05, "total_loss": -0.17265982547288083, "policy_loss": -0.04511248233950358, "vf_loss": 0.013610686412589116, "vf_explained_var": 0.7868750367381356, "kl": 0.027182611103662952, "entropy": 20.4034157111428, "entropy_coeff": 0.006521653333333334}, "model": {}, "num_grad_updates_lifetime": 3575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2102646, "num_env_steps_trained": 2102646, "num_agent_steps_sampled": 2102646, "num_agent_steps_trained": 2102646}, "sampler_results": {"episode_reward_max": 11.52618185142, "episode_reward_min": 1.5486886498457713, "episode_reward_mean": 6.448286041236501, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.4069539363759604, 6.837920870377424, 10.701660238610001, 7.663856759889065, 6.055684075013728, 8.840257068417504, 5.481485188774336, 5.222258129632442, 4.99582127800241, 5.66030023735552, 3.591258345704118, 5.854807771673253, 9.57595221051401, 5.6410001490944515, 7.9287890588763394, 5.087228997362045, 11.120488519513067, 5.495305914024472, 2.5944954490252097, 4.995224237746139, 7.7027445260843255, 7.581443632651035, 1.5486886498457713, 4.421285627544057, 6.240352809883253, 8.973056649456106, 5.948191297347817, 8.242696053667407, 4.13951594394742, 6.474927753935458, 6.0152225033083795, 6.730052696569157, 7.20499085317248, 5.217007686609684, 8.102185494604697, 4.523179325994315, 6.973328925876149, 6.323987487236603, 9.140929014560582, 3.728738421003633, 7.564753821355101, 5.590574067363213, 2.401543327295774, 7.231923804159378, 7.779513847565727, 5.116814043544216, 6.315754285527489, 7.186592085255205, 8.93980160558183, 6.1246951517997905, 3.0002314898396643, 3.3065693998701318, 4.949101839011328, 4.995420066139491, 5.795421794010245, 8.21453456148472, 7.43481303309517, 6.956512017001786, 7.833525655564042, 4.9977058056246895, 6.254072463418269, 6.883166139053204, 4.398609967782661, 4.992019593858154, 3.990211927316071, 11.146201330409344, 6.132030996238489, 3.6331884667558825, 4.534988350081049, 8.549663851632346, 8.079953367686544, 8.21413266723904, 9.030510261626626, 2.0208557357145027, 8.20255573642542, 5.107813861797437, 7.748703393386301, 7.999890073643866, 5.22983367395633, 7.102050086290167, 7.486109230887012, 8.966568345058816, 4.24479052932996, 3.2186548727930533, 7.123254341358241, 6.624774057792126, 5.580386671586777, 5.92018385111323, 5.681350511234624, 8.534883748260999, 10.559507809776623, 10.246405733141742, 6.732314264996158, 5.813094451557168, 11.52618185142, 6.448830405189783, 4.635824583751742, 7.6193893472485685], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.522774402727825, "mean_inference_ms": 6.346888673181977, "mean_action_processing_ms": 0.5153437535797292, "mean_env_wait_ms": 22.951062025544587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038302431301194796, "StateBufferConnector_ms": 0.02864745198463907, "ViewRequirementAgentConnector_ms": 0.5394899115270498}}, "episode_reward_max": 11.52618185142, "episode_reward_min": 1.5486886498457713, "episode_reward_mean": 6.448286041236501, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.4069539363759604, 6.837920870377424, 10.701660238610001, 7.663856759889065, 6.055684075013728, 8.840257068417504, 5.481485188774336, 5.222258129632442, 4.99582127800241, 5.66030023735552, 3.591258345704118, 5.854807771673253, 9.57595221051401, 5.6410001490944515, 7.9287890588763394, 5.087228997362045, 11.120488519513067, 5.495305914024472, 2.5944954490252097, 4.995224237746139, 7.7027445260843255, 7.581443632651035, 1.5486886498457713, 4.421285627544057, 6.240352809883253, 8.973056649456106, 5.948191297347817, 8.242696053667407, 4.13951594394742, 6.474927753935458, 6.0152225033083795, 6.730052696569157, 7.20499085317248, 5.217007686609684, 8.102185494604697, 4.523179325994315, 6.973328925876149, 6.323987487236603, 9.140929014560582, 3.728738421003633, 7.564753821355101, 5.590574067363213, 2.401543327295774, 7.231923804159378, 7.779513847565727, 5.116814043544216, 6.315754285527489, 7.186592085255205, 8.93980160558183, 6.1246951517997905, 3.0002314898396643, 3.3065693998701318, 4.949101839011328, 4.995420066139491, 5.795421794010245, 8.21453456148472, 7.43481303309517, 6.956512017001786, 7.833525655564042, 4.9977058056246895, 6.254072463418269, 6.883166139053204, 4.398609967782661, 4.992019593858154, 3.990211927316071, 11.146201330409344, 6.132030996238489, 3.6331884667558825, 4.534988350081049, 8.549663851632346, 8.079953367686544, 8.21413266723904, 9.030510261626626, 2.0208557357145027, 8.20255573642542, 5.107813861797437, 7.748703393386301, 7.999890073643866, 5.22983367395633, 7.102050086290167, 7.486109230887012, 8.966568345058816, 4.24479052932996, 3.2186548727930533, 7.123254341358241, 6.624774057792126, 5.580386671586777, 5.92018385111323, 5.681350511234624, 8.534883748260999, 10.559507809776623, 10.246405733141742, 6.732314264996158, 5.813094451557168, 11.52618185142, 6.448830405189783, 4.635824583751742, 7.6193893472485685], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.522774402727825, "mean_inference_ms": 6.346888673181977, "mean_action_processing_ms": 0.5153437535797292, "mean_env_wait_ms": 22.951062025544587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038302431301194796, "StateBufferConnector_ms": 0.02864745198463907, "ViewRequirementAgentConnector_ms": 0.5394899115270498}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2102646, "num_agent_steps_trained": 2102646, "num_env_steps_sampled": 2102646, "num_env_steps_trained": 2102646, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 316.3498428476389, "num_env_steps_trained_throughput_per_sec": 316.3498428476389, "timesteps_total": 2102646, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2102646, "timers": {"training_iteration_time_ms": 48212.968, "sample_time_ms": 36125.677, "load_time_ms": 603.359, "load_throughput": 25918.215, "learn_time_ms": 11152.682, "learn_throughput": 1402.174, "synch_weights_time_ms": 307.413}, "counters": {"num_env_steps_sampled": 2102646, "num_env_steps_trained": 2102646, "num_agent_steps_sampled": 2102646, "num_agent_steps_trained": 2102646}, "done": false, "episodes_total": 98, "training_iteration": 139, "trial_id": "c5092_00000", "date": "2025-06-08_09-46-29", "timestamp": 1749368789, "time_this_iter_s": 49.44860053062439, "time_total_s": 337.57164454460144, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 337.57164454460144, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 77.98620689655172, "ram_util_percent": 59.224137931034484, "gpu_util_percent0": 0.08827586206896551, "vram_util_percent0": 0.18831380208333334}}
{"evaluation": {"sampler_results": {"episode_reward_max": 0.28304704834172123, "episode_reward_min": -5.706079560495073, "episode_reward_mean": -3.2121475296306854, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.706079560495073, -3.2136100426707537, -3.70321982481566, 0.28304704834172123, -3.7208752685136615], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2821923379142173, "mean_inference_ms": 3.410286287272533, "mean_action_processing_ms": 0.3007607661939988, "mean_env_wait_ms": 10.483417914822358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02002239227294922, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2000904083251953}}, "episode_reward_max": 0.28304704834172123, "episode_reward_min": -5.706079560495073, "episode_reward_mean": -3.2121475296306854, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.706079560495073, -3.2136100426707537, -3.70321982481566, 0.28304704834172123, -3.7208752685136615], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2821923379142173, "mean_inference_ms": 3.410286287272533, "mean_action_processing_ms": 0.3007607661939988, "mean_env_wait_ms": 10.483417914822358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02002239227294922, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2000904083251953}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.052734375, "cur_lr": 7.897354e-05, "total_loss": -0.16383198988941414, "policy_loss": -0.03691327706468821, "vf_loss": 0.013010239443657073, "vf_explained_var": 0.786198584058068, "kl": 0.02889553863383216, "entropy": 20.374681264703923, "entropy_coeff": 0.006495590000000002}, "model": {}, "num_grad_updates_lifetime": 4125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2118284, "num_env_steps_trained": 2118284, "num_agent_steps_sampled": 2118284, "num_agent_steps_trained": 2118284}, "sampler_results": {"episode_reward_max": 11.52618185142, "episode_reward_min": 1.5486886498457713, "episode_reward_mean": 6.54567223487706, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.57595221051401, 5.6410001490944515, 7.9287890588763394, 5.087228997362045, 11.120488519513067, 5.495305914024472, 2.5944954490252097, 4.995224237746139, 7.7027445260843255, 7.581443632651035, 1.5486886498457713, 4.421285627544057, 6.240352809883253, 8.973056649456106, 5.948191297347817, 8.242696053667407, 4.13951594394742, 6.474927753935458, 6.0152225033083795, 6.730052696569157, 7.20499085317248, 5.217007686609684, 8.102185494604697, 4.523179325994315, 6.973328925876149, 6.323987487236603, 9.140929014560582, 3.728738421003633, 7.564753821355101, 5.590574067363213, 2.401543327295774, 7.231923804159378, 7.779513847565727, 5.116814043544216, 6.315754285527489, 7.186592085255205, 8.93980160558183, 6.1246951517997905, 3.0002314898396643, 3.3065693998701318, 4.949101839011328, 4.995420066139491, 5.795421794010245, 8.21453456148472, 7.43481303309517, 6.956512017001786, 7.833525655564042, 4.9977058056246895, 6.254072463418269, 6.883166139053204, 4.398609967782661, 4.992019593858154, 3.990211927316071, 11.146201330409344, 6.132030996238489, 3.6331884667558825, 4.534988350081049, 8.549663851632346, 8.079953367686544, 8.21413266723904, 9.030510261626626, 2.0208557357145027, 8.20255573642542, 5.107813861797437, 7.748703393386301, 7.999890073643866, 5.22983367395633, 7.102050086290167, 7.486109230887012, 8.966568345058816, 4.24479052932996, 3.2186548727930533, 7.123254341358241, 6.624774057792126, 5.580386671586777, 5.92018385111323, 5.681350511234624, 8.534883748260999, 10.559507809776623, 10.246405733141742, 6.732314264996158, 5.813094451557168, 11.52618185142, 6.448830405189783, 4.635824583751742, 7.6193893472485685, 5.214846392624493, 6.88722947422848, 7.709114836842977, 5.189933653401423, 8.026073494705502, 3.5006756610364924, 8.526665698819775, 8.342094130956335, 9.224819008937125, 7.6413432785727515, 5.344924448422679, 7.180092157720586, 9.694696110041495, 6.464947000044467], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.535598080360744, "mean_inference_ms": 6.374180778975387, "mean_action_processing_ms": 0.5131380261171747, "mean_env_wait_ms": 22.96101528057852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03112030029296875, "StateBufferConnector_ms": 0.03154706954956055, "ViewRequirementAgentConnector_ms": 0.5363452434539795}}, "episode_reward_max": 11.52618185142, "episode_reward_min": 1.5486886498457713, "episode_reward_mean": 6.54567223487706, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.57595221051401, 5.6410001490944515, 7.9287890588763394, 5.087228997362045, 11.120488519513067, 5.495305914024472, 2.5944954490252097, 4.995224237746139, 7.7027445260843255, 7.581443632651035, 1.5486886498457713, 4.421285627544057, 6.240352809883253, 8.973056649456106, 5.948191297347817, 8.242696053667407, 4.13951594394742, 6.474927753935458, 6.0152225033083795, 6.730052696569157, 7.20499085317248, 5.217007686609684, 8.102185494604697, 4.523179325994315, 6.973328925876149, 6.323987487236603, 9.140929014560582, 3.728738421003633, 7.564753821355101, 5.590574067363213, 2.401543327295774, 7.231923804159378, 7.779513847565727, 5.116814043544216, 6.315754285527489, 7.186592085255205, 8.93980160558183, 6.1246951517997905, 3.0002314898396643, 3.3065693998701318, 4.949101839011328, 4.995420066139491, 5.795421794010245, 8.21453456148472, 7.43481303309517, 6.956512017001786, 7.833525655564042, 4.9977058056246895, 6.254072463418269, 6.883166139053204, 4.398609967782661, 4.992019593858154, 3.990211927316071, 11.146201330409344, 6.132030996238489, 3.6331884667558825, 4.534988350081049, 8.549663851632346, 8.079953367686544, 8.21413266723904, 9.030510261626626, 2.0208557357145027, 8.20255573642542, 5.107813861797437, 7.748703393386301, 7.999890073643866, 5.22983367395633, 7.102050086290167, 7.486109230887012, 8.966568345058816, 4.24479052932996, 3.2186548727930533, 7.123254341358241, 6.624774057792126, 5.580386671586777, 5.92018385111323, 5.681350511234624, 8.534883748260999, 10.559507809776623, 10.246405733141742, 6.732314264996158, 5.813094451557168, 11.52618185142, 6.448830405189783, 4.635824583751742, 7.6193893472485685, 5.214846392624493, 6.88722947422848, 7.709114836842977, 5.189933653401423, 8.026073494705502, 3.5006756610364924, 8.526665698819775, 8.342094130956335, 9.224819008937125, 7.6413432785727515, 5.344924448422679, 7.180092157720586, 9.694696110041495, 6.464947000044467], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.535598080360744, "mean_inference_ms": 6.374180778975387, "mean_action_processing_ms": 0.5131380261171747, "mean_env_wait_ms": 22.96101528057852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03112030029296875, "StateBufferConnector_ms": 0.03154706954956055, "ViewRequirementAgentConnector_ms": 0.5363452434539795}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2118284, "num_agent_steps_trained": 2118284, "num_env_steps_sampled": 2118284, "num_env_steps_trained": 2118284, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 314.5707144955349, "num_env_steps_trained_throughput_per_sec": 314.5707144955349, "timesteps_total": 2118284, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2118284, "timers": {"training_iteration_time_ms": 48400.371, "sample_time_ms": 36314.57, "load_time_ms": 606.735, "load_throughput": 25774.038, "learn_time_ms": 11137.414, "learn_throughput": 1404.096, "synch_weights_time_ms": 317.199}, "counters": {"num_env_steps_sampled": 2118284, "num_env_steps_trained": 2118284, "num_agent_steps_sampled": 2118284, "num_agent_steps_trained": 2118284}, "done": false, "episodes_total": 112, "training_iteration": 140, "trial_id": "c5092_00000", "date": "2025-06-08_09-47-33", "timestamp": 1749368853, "time_this_iter_s": 64.03899669647217, "time_total_s": 401.6106412410736, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 401.6106412410736, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 64.99736842105263, "ram_util_percent": 59.323684210526324, "gpu_util_percent0": 0.07144736842105263, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.052734375, "cur_lr": 7.881716000000003e-05, "total_loss": -0.17136938131414353, "policy_loss": -0.04468799319917294, "vf_loss": 0.012387397826479917, "vf_explained_var": 0.7828674107248133, "kl": 0.029218069019288206, "entropy": 20.39382628874345, "entropy_coeff": 0.006469526666666668}, "model": {}, "num_grad_updates_lifetime": 4675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2133922, "num_env_steps_trained": 2133922, "num_agent_steps_sampled": 2133922, "num_agent_steps_trained": 2133922}, "sampler_results": {"episode_reward_max": 11.52618185142, "episode_reward_min": 2.0208557357145027, "episode_reward_mean": 6.557288650889284, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.948191297347817, 8.242696053667407, 4.13951594394742, 6.474927753935458, 6.0152225033083795, 6.730052696569157, 7.20499085317248, 5.217007686609684, 8.102185494604697, 4.523179325994315, 6.973328925876149, 6.323987487236603, 9.140929014560582, 3.728738421003633, 7.564753821355101, 5.590574067363213, 2.401543327295774, 7.231923804159378, 7.779513847565727, 5.116814043544216, 6.315754285527489, 7.186592085255205, 8.93980160558183, 6.1246951517997905, 3.0002314898396643, 3.3065693998701318, 4.949101839011328, 4.995420066139491, 5.795421794010245, 8.21453456148472, 7.43481303309517, 6.956512017001786, 7.833525655564042, 4.9977058056246895, 6.254072463418269, 6.883166139053204, 4.398609967782661, 4.992019593858154, 3.990211927316071, 11.146201330409344, 6.132030996238489, 3.6331884667558825, 4.534988350081049, 8.549663851632346, 8.079953367686544, 8.21413266723904, 9.030510261626626, 2.0208557357145027, 8.20255573642542, 5.107813861797437, 7.748703393386301, 7.999890073643866, 5.22983367395633, 7.102050086290167, 7.486109230887012, 8.966568345058816, 4.24479052932996, 3.2186548727930533, 7.123254341358241, 6.624774057792126, 5.580386671586777, 5.92018385111323, 5.681350511234624, 8.534883748260999, 10.559507809776623, 10.246405733141742, 6.732314264996158, 5.813094451557168, 11.52618185142, 6.448830405189783, 4.635824583751742, 7.6193893472485685, 5.214846392624493, 6.88722947422848, 7.709114836842977, 5.189933653401423, 8.026073494705502, 3.5006756610364924, 8.526665698819775, 8.342094130956335, 9.224819008937125, 7.6413432785727515, 5.344924448422679, 7.180092157720586, 9.694696110041495, 6.464947000044467, 6.037161598036796, 5.506392745637583, 7.90506688747104, 7.173768376641937, 7.39981857209919, 5.369440766253171, 8.775531553111726, 5.550885069377118, 6.024503165481516, 8.839409034714105, 5.538452130756824, 6.083331591851787, 3.5754981492539204, 6.288438392156014], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.550328591646307, "mean_inference_ms": 6.405944613511306, "mean_action_processing_ms": 0.5147479196200105, "mean_env_wait_ms": 23.06803373440356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03513622283935547, "StateBufferConnector_ms": 0.028525352478027344, "ViewRequirementAgentConnector_ms": 0.5340538024902344}}, "episode_reward_max": 11.52618185142, "episode_reward_min": 2.0208557357145027, "episode_reward_mean": 6.557288650889284, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.948191297347817, 8.242696053667407, 4.13951594394742, 6.474927753935458, 6.0152225033083795, 6.730052696569157, 7.20499085317248, 5.217007686609684, 8.102185494604697, 4.523179325994315, 6.973328925876149, 6.323987487236603, 9.140929014560582, 3.728738421003633, 7.564753821355101, 5.590574067363213, 2.401543327295774, 7.231923804159378, 7.779513847565727, 5.116814043544216, 6.315754285527489, 7.186592085255205, 8.93980160558183, 6.1246951517997905, 3.0002314898396643, 3.3065693998701318, 4.949101839011328, 4.995420066139491, 5.795421794010245, 8.21453456148472, 7.43481303309517, 6.956512017001786, 7.833525655564042, 4.9977058056246895, 6.254072463418269, 6.883166139053204, 4.398609967782661, 4.992019593858154, 3.990211927316071, 11.146201330409344, 6.132030996238489, 3.6331884667558825, 4.534988350081049, 8.549663851632346, 8.079953367686544, 8.21413266723904, 9.030510261626626, 2.0208557357145027, 8.20255573642542, 5.107813861797437, 7.748703393386301, 7.999890073643866, 5.22983367395633, 7.102050086290167, 7.486109230887012, 8.966568345058816, 4.24479052932996, 3.2186548727930533, 7.123254341358241, 6.624774057792126, 5.580386671586777, 5.92018385111323, 5.681350511234624, 8.534883748260999, 10.559507809776623, 10.246405733141742, 6.732314264996158, 5.813094451557168, 11.52618185142, 6.448830405189783, 4.635824583751742, 7.6193893472485685, 5.214846392624493, 6.88722947422848, 7.709114836842977, 5.189933653401423, 8.026073494705502, 3.5006756610364924, 8.526665698819775, 8.342094130956335, 9.224819008937125, 7.6413432785727515, 5.344924448422679, 7.180092157720586, 9.694696110041495, 6.464947000044467, 6.037161598036796, 5.506392745637583, 7.90506688747104, 7.173768376641937, 7.39981857209919, 5.369440766253171, 8.775531553111726, 5.550885069377118, 6.024503165481516, 8.839409034714105, 5.538452130756824, 6.083331591851787, 3.5754981492539204, 6.288438392156014], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.550328591646307, "mean_inference_ms": 6.405944613511306, "mean_action_processing_ms": 0.5147479196200105, "mean_env_wait_ms": 23.06803373440356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03513622283935547, "StateBufferConnector_ms": 0.028525352478027344, "ViewRequirementAgentConnector_ms": 0.5340538024902344}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2133922, "num_agent_steps_trained": 2133922, "num_env_steps_sampled": 2133922, "num_env_steps_trained": 2133922, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 314.87648929288343, "num_env_steps_trained_throughput_per_sec": 314.87648929288343, "timesteps_total": 2133922, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2133922, "timers": {"training_iteration_time_ms": 48540.765, "sample_time_ms": 36462.924, "load_time_ms": 610.99, "load_throughput": 25594.507, "learn_time_ms": 11128.247, "learn_throughput": 1405.253, "synch_weights_time_ms": 314.477}, "counters": {"num_env_steps_sampled": 2133922, "num_env_steps_trained": 2133922, "num_agent_steps_sampled": 2133922, "num_agent_steps_trained": 2133922}, "done": false, "episodes_total": 126, "training_iteration": 141, "trial_id": "c5092_00000", "date": "2025-06-08_09-48-23", "timestamp": 1749368903, "time_this_iter_s": 49.67592096328735, "time_total_s": 451.28656220436096, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 451.28656220436096, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 79.23333333333335, "ram_util_percent": 58.738596491228066, "gpu_util_percent0": 0.07929824561403508, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.052734375, "cur_lr": 7.866078000000001e-05, "total_loss": -0.1611550492708656, "policy_loss": -0.03506789065897465, "vf_loss": 0.013678172132508321, "vf_explained_var": 0.781883672692559, "kl": 0.028326985005843717, "entropy": 20.43690038507635, "entropy_coeff": 0.006443463333333332}, "model": {}, "num_grad_updates_lifetime": 5225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2149560, "num_env_steps_trained": 2149560, "num_agent_steps_sampled": 2149560, "num_agent_steps_trained": 2149560}, "sampler_results": {"episode_reward_max": 11.52618185142, "episode_reward_min": 2.0208557357145027, "episode_reward_mean": 6.601810895249282, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.564753821355101, 5.590574067363213, 2.401543327295774, 7.231923804159378, 7.779513847565727, 5.116814043544216, 6.315754285527489, 7.186592085255205, 8.93980160558183, 6.1246951517997905, 3.0002314898396643, 3.3065693998701318, 4.949101839011328, 4.995420066139491, 5.795421794010245, 8.21453456148472, 7.43481303309517, 6.956512017001786, 7.833525655564042, 4.9977058056246895, 6.254072463418269, 6.883166139053204, 4.398609967782661, 4.992019593858154, 3.990211927316071, 11.146201330409344, 6.132030996238489, 3.6331884667558825, 4.534988350081049, 8.549663851632346, 8.079953367686544, 8.21413266723904, 9.030510261626626, 2.0208557357145027, 8.20255573642542, 5.107813861797437, 7.748703393386301, 7.999890073643866, 5.22983367395633, 7.102050086290167, 7.486109230887012, 8.966568345058816, 4.24479052932996, 3.2186548727930533, 7.123254341358241, 6.624774057792126, 5.580386671586777, 5.92018385111323, 5.681350511234624, 8.534883748260999, 10.559507809776623, 10.246405733141742, 6.732314264996158, 5.813094451557168, 11.52618185142, 6.448830405189783, 4.635824583751742, 7.6193893472485685, 5.214846392624493, 6.88722947422848, 7.709114836842977, 5.189933653401423, 8.026073494705502, 3.5006756610364924, 8.526665698819775, 8.342094130956335, 9.224819008937125, 7.6413432785727515, 5.344924448422679, 7.180092157720586, 9.694696110041495, 6.464947000044467, 6.037161598036796, 5.506392745637583, 7.90506688747104, 7.173768376641937, 7.39981857209919, 5.369440766253171, 8.775531553111726, 5.550885069377118, 6.024503165481516, 8.839409034714105, 5.538452130756824, 6.083331591851787, 3.5754981492539204, 6.288438392156014, 7.755253162630748, 6.236327654255031, 4.882652882490525, 7.219307915499178, 4.124478452912691, 5.969574122032112, 7.604047373594125, 7.701729041704455, 3.853956974376194, 9.946127671762953, 6.318209332040255, 6.923232777810415, 6.6451519833078265, 8.037128549417003], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5566621559970735, "mean_inference_ms": 6.445418310664941, "mean_action_processing_ms": 0.5174220641091071, "mean_env_wait_ms": 23.21817837549874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03515005111694336, "StateBufferConnector_ms": 0.02701544761657715, "ViewRequirementAgentConnector_ms": 0.5404207706451416}}, "episode_reward_max": 11.52618185142, "episode_reward_min": 2.0208557357145027, "episode_reward_mean": 6.601810895249282, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.564753821355101, 5.590574067363213, 2.401543327295774, 7.231923804159378, 7.779513847565727, 5.116814043544216, 6.315754285527489, 7.186592085255205, 8.93980160558183, 6.1246951517997905, 3.0002314898396643, 3.3065693998701318, 4.949101839011328, 4.995420066139491, 5.795421794010245, 8.21453456148472, 7.43481303309517, 6.956512017001786, 7.833525655564042, 4.9977058056246895, 6.254072463418269, 6.883166139053204, 4.398609967782661, 4.992019593858154, 3.990211927316071, 11.146201330409344, 6.132030996238489, 3.6331884667558825, 4.534988350081049, 8.549663851632346, 8.079953367686544, 8.21413266723904, 9.030510261626626, 2.0208557357145027, 8.20255573642542, 5.107813861797437, 7.748703393386301, 7.999890073643866, 5.22983367395633, 7.102050086290167, 7.486109230887012, 8.966568345058816, 4.24479052932996, 3.2186548727930533, 7.123254341358241, 6.624774057792126, 5.580386671586777, 5.92018385111323, 5.681350511234624, 8.534883748260999, 10.559507809776623, 10.246405733141742, 6.732314264996158, 5.813094451557168, 11.52618185142, 6.448830405189783, 4.635824583751742, 7.6193893472485685, 5.214846392624493, 6.88722947422848, 7.709114836842977, 5.189933653401423, 8.026073494705502, 3.5006756610364924, 8.526665698819775, 8.342094130956335, 9.224819008937125, 7.6413432785727515, 5.344924448422679, 7.180092157720586, 9.694696110041495, 6.464947000044467, 6.037161598036796, 5.506392745637583, 7.90506688747104, 7.173768376641937, 7.39981857209919, 5.369440766253171, 8.775531553111726, 5.550885069377118, 6.024503165481516, 8.839409034714105, 5.538452130756824, 6.083331591851787, 3.5754981492539204, 6.288438392156014, 7.755253162630748, 6.236327654255031, 4.882652882490525, 7.219307915499178, 4.124478452912691, 5.969574122032112, 7.604047373594125, 7.701729041704455, 3.853956974376194, 9.946127671762953, 6.318209332040255, 6.923232777810415, 6.6451519833078265, 8.037128549417003], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5566621559970735, "mean_inference_ms": 6.445418310664941, "mean_action_processing_ms": 0.5174220641091071, "mean_env_wait_ms": 23.21817837549874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03515005111694336, "StateBufferConnector_ms": 0.02701544761657715, "ViewRequirementAgentConnector_ms": 0.5404207706451416}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2149560, "num_agent_steps_trained": 2149560, "num_env_steps_sampled": 2149560, "num_env_steps_trained": 2149560, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 304.6311913616074, "num_env_steps_trained_throughput_per_sec": 304.6311913616074, "timesteps_total": 2149560, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2149560, "timers": {"training_iteration_time_ms": 48820.109, "sample_time_ms": 36734.357, "load_time_ms": 610.552, "load_throughput": 25612.901, "learn_time_ms": 11135.708, "learn_throughput": 1404.311, "synch_weights_time_ms": 315.565}, "counters": {"num_env_steps_sampled": 2149560, "num_env_steps_trained": 2149560, "num_agent_steps_sampled": 2149560, "num_agent_steps_trained": 2149560}, "done": false, "episodes_total": 140, "training_iteration": 142, "trial_id": "c5092_00000", "date": "2025-06-08_09-49-14", "timestamp": 1749368954, "time_this_iter_s": 51.34487724304199, "time_total_s": 502.63143944740295, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 502.63143944740295, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 77.93666666666668, "ram_util_percent": 58.208333333333336, "gpu_util_percent0": 0.08900000000000001, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.052734375, "cur_lr": 7.850440000000002e-05, "total_loss": -0.1483749490665187, "policy_loss": -0.022758859935698143, "vf_loss": 0.012781341536901891, "vf_explained_var": 0.795558882409876, "kl": 0.030851917374398723, "entropy": 20.425319258949973, "entropy_coeff": 0.006417400000000003}, "model": {}, "num_grad_updates_lifetime": 5775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2165198, "num_env_steps_trained": 2165198, "num_agent_steps_sampled": 2165198, "num_agent_steps_trained": 2165198}, "sampler_results": {"episode_reward_max": 11.52618185142, "episode_reward_min": 2.0208557357145027, "episode_reward_mean": 6.8619540929566645, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.795421794010245, 8.21453456148472, 7.43481303309517, 6.956512017001786, 7.833525655564042, 4.9977058056246895, 6.254072463418269, 6.883166139053204, 4.398609967782661, 4.992019593858154, 3.990211927316071, 11.146201330409344, 6.132030996238489, 3.6331884667558825, 4.534988350081049, 8.549663851632346, 8.079953367686544, 8.21413266723904, 9.030510261626626, 2.0208557357145027, 8.20255573642542, 5.107813861797437, 7.748703393386301, 7.999890073643866, 5.22983367395633, 7.102050086290167, 7.486109230887012, 8.966568345058816, 4.24479052932996, 3.2186548727930533, 7.123254341358241, 6.624774057792126, 5.580386671586777, 5.92018385111323, 5.681350511234624, 8.534883748260999, 10.559507809776623, 10.246405733141742, 6.732314264996158, 5.813094451557168, 11.52618185142, 6.448830405189783, 4.635824583751742, 7.6193893472485685, 5.214846392624493, 6.88722947422848, 7.709114836842977, 5.189933653401423, 8.026073494705502, 3.5006756610364924, 8.526665698819775, 8.342094130956335, 9.224819008937125, 7.6413432785727515, 5.344924448422679, 7.180092157720586, 9.694696110041495, 6.464947000044467, 6.037161598036796, 5.506392745637583, 7.90506688747104, 7.173768376641937, 7.39981857209919, 5.369440766253171, 8.775531553111726, 5.550885069377118, 6.024503165481516, 8.839409034714105, 5.538452130756824, 6.083331591851787, 3.5754981492539204, 6.288438392156014, 7.755253162630748, 6.236327654255031, 4.882652882490525, 7.219307915499178, 4.124478452912691, 5.969574122032112, 7.604047373594125, 7.701729041704455, 3.853956974376194, 9.946127671762953, 6.318209332040255, 6.923232777810415, 6.6451519833078265, 8.037128549417003, 10.027972582434298, 3.9258687777526586, 7.8425676429173405, 9.710976995796397, 8.167815017771995, 6.7098125871098055, 8.581649663696684, 8.299718645849104, 4.268995080267521, 10.651939578064086, 7.731867903205602, 4.800935640109778, 6.7018622738642994, 9.095626216207036], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5599937809208735, "mean_inference_ms": 6.4799689976261705, "mean_action_processing_ms": 0.5197727675242815, "mean_env_wait_ms": 23.357031092327375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03716778755187988, "StateBufferConnector_ms": 0.03013324737548828, "ViewRequirementAgentConnector_ms": 0.5598654747009277}}, "episode_reward_max": 11.52618185142, "episode_reward_min": 2.0208557357145027, "episode_reward_mean": 6.8619540929566645, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.795421794010245, 8.21453456148472, 7.43481303309517, 6.956512017001786, 7.833525655564042, 4.9977058056246895, 6.254072463418269, 6.883166139053204, 4.398609967782661, 4.992019593858154, 3.990211927316071, 11.146201330409344, 6.132030996238489, 3.6331884667558825, 4.534988350081049, 8.549663851632346, 8.079953367686544, 8.21413266723904, 9.030510261626626, 2.0208557357145027, 8.20255573642542, 5.107813861797437, 7.748703393386301, 7.999890073643866, 5.22983367395633, 7.102050086290167, 7.486109230887012, 8.966568345058816, 4.24479052932996, 3.2186548727930533, 7.123254341358241, 6.624774057792126, 5.580386671586777, 5.92018385111323, 5.681350511234624, 8.534883748260999, 10.559507809776623, 10.246405733141742, 6.732314264996158, 5.813094451557168, 11.52618185142, 6.448830405189783, 4.635824583751742, 7.6193893472485685, 5.214846392624493, 6.88722947422848, 7.709114836842977, 5.189933653401423, 8.026073494705502, 3.5006756610364924, 8.526665698819775, 8.342094130956335, 9.224819008937125, 7.6413432785727515, 5.344924448422679, 7.180092157720586, 9.694696110041495, 6.464947000044467, 6.037161598036796, 5.506392745637583, 7.90506688747104, 7.173768376641937, 7.39981857209919, 5.369440766253171, 8.775531553111726, 5.550885069377118, 6.024503165481516, 8.839409034714105, 5.538452130756824, 6.083331591851787, 3.5754981492539204, 6.288438392156014, 7.755253162630748, 6.236327654255031, 4.882652882490525, 7.219307915499178, 4.124478452912691, 5.969574122032112, 7.604047373594125, 7.701729041704455, 3.853956974376194, 9.946127671762953, 6.318209332040255, 6.923232777810415, 6.6451519833078265, 8.037128549417003, 10.027972582434298, 3.9258687777526586, 7.8425676429173405, 9.710976995796397, 8.167815017771995, 6.7098125871098055, 8.581649663696684, 8.299718645849104, 4.268995080267521, 10.651939578064086, 7.731867903205602, 4.800935640109778, 6.7018622738642994, 9.095626216207036], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5599937809208735, "mean_inference_ms": 6.4799689976261705, "mean_action_processing_ms": 0.5197727675242815, "mean_env_wait_ms": 23.357031092327375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03716778755187988, "StateBufferConnector_ms": 0.03013324737548828, "ViewRequirementAgentConnector_ms": 0.5598654747009277}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2165198, "num_agent_steps_trained": 2165198, "num_env_steps_sampled": 2165198, "num_env_steps_trained": 2165198, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 308.37239212207993, "num_env_steps_trained_throughput_per_sec": 308.37239212207993, "timesteps_total": 2165198, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2165198, "timers": {"training_iteration_time_ms": 49030.313, "sample_time_ms": 36953.148, "load_time_ms": 585.665, "load_throughput": 26701.271, "learn_time_ms": 11153.389, "learn_throughput": 1402.085, "synch_weights_time_ms": 313.735}, "counters": {"num_env_steps_sampled": 2165198, "num_env_steps_trained": 2165198, "num_agent_steps_sampled": 2165198, "num_agent_steps_trained": 2165198}, "done": false, "episodes_total": 154, "training_iteration": 143, "trial_id": "c5092_00000", "date": "2025-06-08_09-50-05", "timestamp": 1749369005, "time_this_iter_s": 50.724435567855835, "time_total_s": 553.3558750152588, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 553.3558750152588, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 79.57758620689656, "ram_util_percent": 58.334482758620695, "gpu_util_percent0": 0.08448275862068966, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.834802000000002e-05, "total_loss": -0.16081378797048027, "policy_loss": -0.03600196853004904, "vf_loss": 0.012291912087662654, "vf_explained_var": 0.7751506782661785, "kl": 0.027132876005372526, "entropy": 20.44105228770863, "entropy_coeff": 0.0063913366666666655}, "model": {}, "num_grad_updates_lifetime": 6325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2180836, "num_env_steps_trained": 2180836, "num_agent_steps_sampled": 2180836, "num_agent_steps_trained": 2180836}, "sampler_results": {"episode_reward_max": 11.52618185142, "episode_reward_min": 2.0208557357145027, "episode_reward_mean": 7.009832126658025, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.534988350081049, 8.549663851632346, 8.079953367686544, 8.21413266723904, 9.030510261626626, 2.0208557357145027, 8.20255573642542, 5.107813861797437, 7.748703393386301, 7.999890073643866, 5.22983367395633, 7.102050086290167, 7.486109230887012, 8.966568345058816, 4.24479052932996, 3.2186548727930533, 7.123254341358241, 6.624774057792126, 5.580386671586777, 5.92018385111323, 5.681350511234624, 8.534883748260999, 10.559507809776623, 10.246405733141742, 6.732314264996158, 5.813094451557168, 11.52618185142, 6.448830405189783, 4.635824583751742, 7.6193893472485685, 5.214846392624493, 6.88722947422848, 7.709114836842977, 5.189933653401423, 8.026073494705502, 3.5006756610364924, 8.526665698819775, 8.342094130956335, 9.224819008937125, 7.6413432785727515, 5.344924448422679, 7.180092157720586, 9.694696110041495, 6.464947000044467, 6.037161598036796, 5.506392745637583, 7.90506688747104, 7.173768376641937, 7.39981857209919, 5.369440766253171, 8.775531553111726, 5.550885069377118, 6.024503165481516, 8.839409034714105, 5.538452130756824, 6.083331591851787, 3.5754981492539204, 6.288438392156014, 7.755253162630748, 6.236327654255031, 4.882652882490525, 7.219307915499178, 4.124478452912691, 5.969574122032112, 7.604047373594125, 7.701729041704455, 3.853956974376194, 9.946127671762953, 6.318209332040255, 6.923232777810415, 6.6451519833078265, 8.037128549417003, 10.027972582434298, 3.9258687777526586, 7.8425676429173405, 9.710976995796397, 8.167815017771995, 6.7098125871098055, 8.581649663696684, 8.299718645849104, 4.268995080267521, 10.651939578064086, 7.731867903205602, 4.800935640109778, 6.7018622738642994, 9.095626216207036, 9.177468679294932, 9.697358492051887, 8.28691161712164, 7.100850921050855, 8.091804396767651, 8.402789511461632, 5.584195868426386, 8.541865605481346, 6.647339406144162, 5.153534751208879, 2.8547160095545303, 7.101793884597825, 7.900523540663995, 8.908664437923258], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5615449525527405, "mean_inference_ms": 6.510978002281831, "mean_action_processing_ms": 0.5223734078934253, "mean_env_wait_ms": 23.4914234174896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03821706771850586, "StateBufferConnector_ms": 0.029083728790283203, "ViewRequirementAgentConnector_ms": 0.5718793869018555}}, "episode_reward_max": 11.52618185142, "episode_reward_min": 2.0208557357145027, "episode_reward_mean": 7.009832126658025, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.534988350081049, 8.549663851632346, 8.079953367686544, 8.21413266723904, 9.030510261626626, 2.0208557357145027, 8.20255573642542, 5.107813861797437, 7.748703393386301, 7.999890073643866, 5.22983367395633, 7.102050086290167, 7.486109230887012, 8.966568345058816, 4.24479052932996, 3.2186548727930533, 7.123254341358241, 6.624774057792126, 5.580386671586777, 5.92018385111323, 5.681350511234624, 8.534883748260999, 10.559507809776623, 10.246405733141742, 6.732314264996158, 5.813094451557168, 11.52618185142, 6.448830405189783, 4.635824583751742, 7.6193893472485685, 5.214846392624493, 6.88722947422848, 7.709114836842977, 5.189933653401423, 8.026073494705502, 3.5006756610364924, 8.526665698819775, 8.342094130956335, 9.224819008937125, 7.6413432785727515, 5.344924448422679, 7.180092157720586, 9.694696110041495, 6.464947000044467, 6.037161598036796, 5.506392745637583, 7.90506688747104, 7.173768376641937, 7.39981857209919, 5.369440766253171, 8.775531553111726, 5.550885069377118, 6.024503165481516, 8.839409034714105, 5.538452130756824, 6.083331591851787, 3.5754981492539204, 6.288438392156014, 7.755253162630748, 6.236327654255031, 4.882652882490525, 7.219307915499178, 4.124478452912691, 5.969574122032112, 7.604047373594125, 7.701729041704455, 3.853956974376194, 9.946127671762953, 6.318209332040255, 6.923232777810415, 6.6451519833078265, 8.037128549417003, 10.027972582434298, 3.9258687777526586, 7.8425676429173405, 9.710976995796397, 8.167815017771995, 6.7098125871098055, 8.581649663696684, 8.299718645849104, 4.268995080267521, 10.651939578064086, 7.731867903205602, 4.800935640109778, 6.7018622738642994, 9.095626216207036, 9.177468679294932, 9.697358492051887, 8.28691161712164, 7.100850921050855, 8.091804396767651, 8.402789511461632, 5.584195868426386, 8.541865605481346, 6.647339406144162, 5.153534751208879, 2.8547160095545303, 7.101793884597825, 7.900523540663995, 8.908664437923258], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5615449525527405, "mean_inference_ms": 6.510978002281831, "mean_action_processing_ms": 0.5223734078934253, "mean_env_wait_ms": 23.4914234174896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03821706771850586, "StateBufferConnector_ms": 0.029083728790283203, "ViewRequirementAgentConnector_ms": 0.5718793869018555}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2180836, "num_agent_steps_trained": 2180836, "num_env_steps_sampled": 2180836, "num_env_steps_trained": 2180836, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 308.6324338400464, "num_env_steps_trained_throughput_per_sec": 308.6324338400464, "timesteps_total": 2180836, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2180836, "timers": {"training_iteration_time_ms": 49469.789, "sample_time_ms": 37400.961, "load_time_ms": 579.302, "load_throughput": 26994.574, "learn_time_ms": 11151.837, "learn_throughput": 1402.28, "synch_weights_time_ms": 312.678}, "counters": {"num_env_steps_sampled": 2180836, "num_env_steps_trained": 2180836, "num_agent_steps_sampled": 2180836, "num_agent_steps_trained": 2180836}, "done": false, "episodes_total": 168, "training_iteration": 144, "trial_id": "c5092_00000", "date": "2025-06-08_09-50-55", "timestamp": 1749369055, "time_this_iter_s": 50.668686389923096, "time_total_s": 604.0245614051819, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 604.0245614051819, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 78.06551724137931, "ram_util_percent": 58.422413793103445, "gpu_util_percent0": 0.08775862068965518, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.819164e-05, "total_loss": -0.14693091984711248, "policy_loss": -0.02308081371931952, "vf_loss": 0.012957276900044896, "vf_explained_var": 0.7815533628247001, "kl": 0.027752942711536856, "entropy": 20.412728059942072, "entropy_coeff": 0.006365273333333333}, "model": {}, "num_grad_updates_lifetime": 6875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2196474, "num_env_steps_trained": 2196474, "num_agent_steps_sampled": 2196474, "num_agent_steps_trained": 2196474}, "sampler_results": {"episode_reward_max": 11.52618185142, "episode_reward_min": 2.8547160095545303, "episode_reward_mean": 7.0143139743613325, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.24479052932996, 3.2186548727930533, 7.123254341358241, 6.624774057792126, 5.580386671586777, 5.92018385111323, 5.681350511234624, 8.534883748260999, 10.559507809776623, 10.246405733141742, 6.732314264996158, 5.813094451557168, 11.52618185142, 6.448830405189783, 4.635824583751742, 7.6193893472485685, 5.214846392624493, 6.88722947422848, 7.709114836842977, 5.189933653401423, 8.026073494705502, 3.5006756610364924, 8.526665698819775, 8.342094130956335, 9.224819008937125, 7.6413432785727515, 5.344924448422679, 7.180092157720586, 9.694696110041495, 6.464947000044467, 6.037161598036796, 5.506392745637583, 7.90506688747104, 7.173768376641937, 7.39981857209919, 5.369440766253171, 8.775531553111726, 5.550885069377118, 6.024503165481516, 8.839409034714105, 5.538452130756824, 6.083331591851787, 3.5754981492539204, 6.288438392156014, 7.755253162630748, 6.236327654255031, 4.882652882490525, 7.219307915499178, 4.124478452912691, 5.969574122032112, 7.604047373594125, 7.701729041704455, 3.853956974376194, 9.946127671762953, 6.318209332040255, 6.923232777810415, 6.6451519833078265, 8.037128549417003, 10.027972582434298, 3.9258687777526586, 7.8425676429173405, 9.710976995796397, 8.167815017771995, 6.7098125871098055, 8.581649663696684, 8.299718645849104, 4.268995080267521, 10.651939578064086, 7.731867903205602, 4.800935640109778, 6.7018622738642994, 9.095626216207036, 9.177468679294932, 9.697358492051887, 8.28691161712164, 7.100850921050855, 8.091804396767651, 8.402789511461632, 5.584195868426386, 8.541865605481346, 6.647339406144162, 5.153534751208879, 2.8547160095545303, 7.101793884597825, 7.900523540663995, 8.908664437923258, 9.833946363287273, 5.856695936920255, 5.796007528020094, 6.774792131756734, 5.741068826733143, 7.556768465051464, 4.776903630452069, 5.204795932574889, 10.272247571610746, 9.286304480674, 7.646255422585588, 6.597589796025442, 5.4394184750547785, 7.939018845009483], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5607071560861354, "mean_inference_ms": 6.535192284681127, "mean_action_processing_ms": 0.5243938885011712, "mean_env_wait_ms": 23.62517966001909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034088850021362305, "StateBufferConnector_ms": 0.0321197509765625, "ViewRequirementAgentConnector_ms": 0.577972412109375}}, "episode_reward_max": 11.52618185142, "episode_reward_min": 2.8547160095545303, "episode_reward_mean": 7.0143139743613325, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.24479052932996, 3.2186548727930533, 7.123254341358241, 6.624774057792126, 5.580386671586777, 5.92018385111323, 5.681350511234624, 8.534883748260999, 10.559507809776623, 10.246405733141742, 6.732314264996158, 5.813094451557168, 11.52618185142, 6.448830405189783, 4.635824583751742, 7.6193893472485685, 5.214846392624493, 6.88722947422848, 7.709114836842977, 5.189933653401423, 8.026073494705502, 3.5006756610364924, 8.526665698819775, 8.342094130956335, 9.224819008937125, 7.6413432785727515, 5.344924448422679, 7.180092157720586, 9.694696110041495, 6.464947000044467, 6.037161598036796, 5.506392745637583, 7.90506688747104, 7.173768376641937, 7.39981857209919, 5.369440766253171, 8.775531553111726, 5.550885069377118, 6.024503165481516, 8.839409034714105, 5.538452130756824, 6.083331591851787, 3.5754981492539204, 6.288438392156014, 7.755253162630748, 6.236327654255031, 4.882652882490525, 7.219307915499178, 4.124478452912691, 5.969574122032112, 7.604047373594125, 7.701729041704455, 3.853956974376194, 9.946127671762953, 6.318209332040255, 6.923232777810415, 6.6451519833078265, 8.037128549417003, 10.027972582434298, 3.9258687777526586, 7.8425676429173405, 9.710976995796397, 8.167815017771995, 6.7098125871098055, 8.581649663696684, 8.299718645849104, 4.268995080267521, 10.651939578064086, 7.731867903205602, 4.800935640109778, 6.7018622738642994, 9.095626216207036, 9.177468679294932, 9.697358492051887, 8.28691161712164, 7.100850921050855, 8.091804396767651, 8.402789511461632, 5.584195868426386, 8.541865605481346, 6.647339406144162, 5.153534751208879, 2.8547160095545303, 7.101793884597825, 7.900523540663995, 8.908664437923258, 9.833946363287273, 5.856695936920255, 5.796007528020094, 6.774792131756734, 5.741068826733143, 7.556768465051464, 4.776903630452069, 5.204795932574889, 10.272247571610746, 9.286304480674, 7.646255422585588, 6.597589796025442, 5.4394184750547785, 7.939018845009483], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5607071560861354, "mean_inference_ms": 6.535192284681127, "mean_action_processing_ms": 0.5243938885011712, "mean_env_wait_ms": 23.62517966001909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034088850021362305, "StateBufferConnector_ms": 0.0321197509765625, "ViewRequirementAgentConnector_ms": 0.577972412109375}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2196474, "num_agent_steps_trained": 2196474, "num_env_steps_sampled": 2196474, "num_env_steps_trained": 2196474, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 305.87258554550834, "num_env_steps_trained_throughput_per_sec": 305.87258554550834, "timesteps_total": 2196474, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2196474, "timers": {"training_iteration_time_ms": 49852.302, "sample_time_ms": 37789.24, "load_time_ms": 574.404, "load_throughput": 27224.736, "learn_time_ms": 11148.044, "learn_throughput": 1402.757, "synch_weights_time_ms": 315.48}, "counters": {"num_env_steps_sampled": 2196474, "num_env_steps_trained": 2196474, "num_agent_steps_sampled": 2196474, "num_agent_steps_trained": 2196474}, "done": false, "episodes_total": 182, "training_iteration": 145, "trial_id": "c5092_00000", "date": "2025-06-08_09-51-47", "timestamp": 1749369107, "time_this_iter_s": 51.13988399505615, "time_total_s": 655.164445400238, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 655.164445400238, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 78.25166666666668, "ram_util_percent": 58.395, "gpu_util_percent0": 0.08916666666666667, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.803526e-05, "total_loss": -0.16339840635149316, "policy_loss": -0.039649174709014585, "vf_loss": 0.0133593836621466, "vf_explained_var": 0.7878800041025336, "kl": 0.02785143428754735, "entropy": 20.500998602780427, "entropy_coeff": 0.006339209999999999}, "model": {}, "num_grad_updates_lifetime": 7425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2212112, "num_env_steps_trained": 2212112, "num_agent_steps_sampled": 2212112, "num_agent_steps_trained": 2212112}, "sampler_results": {"episode_reward_max": 10.651939578064086, "episode_reward_min": 0.9571991725751628, "episode_reward_mean": 6.997713635402457, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.635824583751742, 7.6193893472485685, 5.214846392624493, 6.88722947422848, 7.709114836842977, 5.189933653401423, 8.026073494705502, 3.5006756610364924, 8.526665698819775, 8.342094130956335, 9.224819008937125, 7.6413432785727515, 5.344924448422679, 7.180092157720586, 9.694696110041495, 6.464947000044467, 6.037161598036796, 5.506392745637583, 7.90506688747104, 7.173768376641937, 7.39981857209919, 5.369440766253171, 8.775531553111726, 5.550885069377118, 6.024503165481516, 8.839409034714105, 5.538452130756824, 6.083331591851787, 3.5754981492539204, 6.288438392156014, 7.755253162630748, 6.236327654255031, 4.882652882490525, 7.219307915499178, 4.124478452912691, 5.969574122032112, 7.604047373594125, 7.701729041704455, 3.853956974376194, 9.946127671762953, 6.318209332040255, 6.923232777810415, 6.6451519833078265, 8.037128549417003, 10.027972582434298, 3.9258687777526586, 7.8425676429173405, 9.710976995796397, 8.167815017771995, 6.7098125871098055, 8.581649663696684, 8.299718645849104, 4.268995080267521, 10.651939578064086, 7.731867903205602, 4.800935640109778, 6.7018622738642994, 9.095626216207036, 9.177468679294932, 9.697358492051887, 8.28691161712164, 7.100850921050855, 8.091804396767651, 8.402789511461632, 5.584195868426386, 8.541865605481346, 6.647339406144162, 5.153534751208879, 2.8547160095545303, 7.101793884597825, 7.900523540663995, 8.908664437923258, 9.833946363287273, 5.856695936920255, 5.796007528020094, 6.774792131756734, 5.741068826733143, 7.556768465051464, 4.776903630452069, 5.204795932574889, 10.272247571610746, 9.286304480674, 7.646255422585588, 6.597589796025442, 5.4394184750547785, 7.939018845009483, 9.405771776637636, 5.899980190387225, 0.9571991725751628, 5.3384402265421445, 5.7346899055389455, 8.029478620292723, 4.900171622928935, 7.915058677412833, 7.431359249897482, 9.875369348890361, 6.350767517923278, 8.30793740137703, 8.20507303593268, 8.243282457326766], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5584486508149606, "mean_inference_ms": 6.5629287672666115, "mean_action_processing_ms": 0.5264829353802252, "mean_env_wait_ms": 23.7498929276188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035074710845947266, "StateBufferConnector_ms": 0.032097816467285156, "ViewRequirementAgentConnector_ms": 0.5749075412750244}}, "episode_reward_max": 10.651939578064086, "episode_reward_min": 0.9571991725751628, "episode_reward_mean": 6.997713635402457, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.635824583751742, 7.6193893472485685, 5.214846392624493, 6.88722947422848, 7.709114836842977, 5.189933653401423, 8.026073494705502, 3.5006756610364924, 8.526665698819775, 8.342094130956335, 9.224819008937125, 7.6413432785727515, 5.344924448422679, 7.180092157720586, 9.694696110041495, 6.464947000044467, 6.037161598036796, 5.506392745637583, 7.90506688747104, 7.173768376641937, 7.39981857209919, 5.369440766253171, 8.775531553111726, 5.550885069377118, 6.024503165481516, 8.839409034714105, 5.538452130756824, 6.083331591851787, 3.5754981492539204, 6.288438392156014, 7.755253162630748, 6.236327654255031, 4.882652882490525, 7.219307915499178, 4.124478452912691, 5.969574122032112, 7.604047373594125, 7.701729041704455, 3.853956974376194, 9.946127671762953, 6.318209332040255, 6.923232777810415, 6.6451519833078265, 8.037128549417003, 10.027972582434298, 3.9258687777526586, 7.8425676429173405, 9.710976995796397, 8.167815017771995, 6.7098125871098055, 8.581649663696684, 8.299718645849104, 4.268995080267521, 10.651939578064086, 7.731867903205602, 4.800935640109778, 6.7018622738642994, 9.095626216207036, 9.177468679294932, 9.697358492051887, 8.28691161712164, 7.100850921050855, 8.091804396767651, 8.402789511461632, 5.584195868426386, 8.541865605481346, 6.647339406144162, 5.153534751208879, 2.8547160095545303, 7.101793884597825, 7.900523540663995, 8.908664437923258, 9.833946363287273, 5.856695936920255, 5.796007528020094, 6.774792131756734, 5.741068826733143, 7.556768465051464, 4.776903630452069, 5.204795932574889, 10.272247571610746, 9.286304480674, 7.646255422585588, 6.597589796025442, 5.4394184750547785, 7.939018845009483, 9.405771776637636, 5.899980190387225, 0.9571991725751628, 5.3384402265421445, 5.7346899055389455, 8.029478620292723, 4.900171622928935, 7.915058677412833, 7.431359249897482, 9.875369348890361, 6.350767517923278, 8.30793740137703, 8.20507303593268, 8.243282457326766], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5584486508149606, "mean_inference_ms": 6.5629287672666115, "mean_action_processing_ms": 0.5264829353802252, "mean_env_wait_ms": 23.7498929276188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035074710845947266, "StateBufferConnector_ms": 0.032097816467285156, "ViewRequirementAgentConnector_ms": 0.5749075412750244}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2212112, "num_agent_steps_trained": 2212112, "num_env_steps_sampled": 2212112, "num_env_steps_trained": 2212112, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 305.94282740774236, "num_env_steps_trained_throughput_per_sec": 305.94282740774236, "timesteps_total": 2212112, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2212112, "timers": {"training_iteration_time_ms": 50113.227, "sample_time_ms": 38045.589, "load_time_ms": 574.405, "load_throughput": 27224.709, "learn_time_ms": 11149.793, "learn_throughput": 1402.537, "synch_weights_time_ms": 318.895}, "counters": {"num_env_steps_sampled": 2212112, "num_env_steps_trained": 2212112, "num_agent_steps_sampled": 2212112, "num_agent_steps_trained": 2212112}, "done": false, "episodes_total": 196, "training_iteration": 146, "trial_id": "c5092_00000", "date": "2025-06-08_09-52-38", "timestamp": 1749369158, "time_this_iter_s": 51.121155977249146, "time_total_s": 706.2856013774872, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 706.2856013774872, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 79.2050847457627, "ram_util_percent": 58.423728813559336, "gpu_util_percent0": 0.08305084745762713, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.787888000000002e-05, "total_loss": -0.14751793505920266, "policy_loss": -0.023842077898959608, "vf_loss": 0.012486894720826636, "vf_explained_var": 0.7683200515400279, "kl": 0.02795737474688477, "entropy": 20.533880395022305, "entropy_coeff": 0.006313146666666667}, "model": {}, "num_grad_updates_lifetime": 7975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2227750, "num_env_steps_trained": 2227750, "num_agent_steps_sampled": 2227750, "num_agent_steps_trained": 2227750}, "sampler_results": {"episode_reward_max": 10.651939578064086, "episode_reward_min": 0.9571991725751628, "episode_reward_mean": 6.981325844881693, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.694696110041495, 6.464947000044467, 6.037161598036796, 5.506392745637583, 7.90506688747104, 7.173768376641937, 7.39981857209919, 5.369440766253171, 8.775531553111726, 5.550885069377118, 6.024503165481516, 8.839409034714105, 5.538452130756824, 6.083331591851787, 3.5754981492539204, 6.288438392156014, 7.755253162630748, 6.236327654255031, 4.882652882490525, 7.219307915499178, 4.124478452912691, 5.969574122032112, 7.604047373594125, 7.701729041704455, 3.853956974376194, 9.946127671762953, 6.318209332040255, 6.923232777810415, 6.6451519833078265, 8.037128549417003, 10.027972582434298, 3.9258687777526586, 7.8425676429173405, 9.710976995796397, 8.167815017771995, 6.7098125871098055, 8.581649663696684, 8.299718645849104, 4.268995080267521, 10.651939578064086, 7.731867903205602, 4.800935640109778, 6.7018622738642994, 9.095626216207036, 9.177468679294932, 9.697358492051887, 8.28691161712164, 7.100850921050855, 8.091804396767651, 8.402789511461632, 5.584195868426386, 8.541865605481346, 6.647339406144162, 5.153534751208879, 2.8547160095545303, 7.101793884597825, 7.900523540663995, 8.908664437923258, 9.833946363287273, 5.856695936920255, 5.796007528020094, 6.774792131756734, 5.741068826733143, 7.556768465051464, 4.776903630452069, 5.204795932574889, 10.272247571610746, 9.286304480674, 7.646255422585588, 6.597589796025442, 5.4394184750547785, 7.939018845009483, 9.405771776637636, 5.899980190387225, 0.9571991725751628, 5.3384402265421445, 5.7346899055389455, 8.029478620292723, 4.900171622928935, 7.915058677412833, 7.431359249897482, 9.875369348890361, 6.350767517923278, 8.30793740137703, 8.20507303593268, 8.243282457326766, 6.8684067499893136, 8.191018932102365, 6.783147445128466, 8.065729312896284, 4.5613489114151555, 6.5514125478581375, 7.411029056266671, 8.127342432198903, 5.502518481557316, 6.2709847053431425, 5.576227344545815, 7.342772997332744, 7.187575628447334, 4.964732570110797], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.55674322758298, "mean_inference_ms": 6.588340613816384, "mean_action_processing_ms": 0.5283567469779917, "mean_env_wait_ms": 23.865711812596643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0320587158203125, "StateBufferConnector_ms": 0.03114175796508789, "ViewRequirementAgentConnector_ms": 0.5818619728088379}}, "episode_reward_max": 10.651939578064086, "episode_reward_min": 0.9571991725751628, "episode_reward_mean": 6.981325844881693, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.694696110041495, 6.464947000044467, 6.037161598036796, 5.506392745637583, 7.90506688747104, 7.173768376641937, 7.39981857209919, 5.369440766253171, 8.775531553111726, 5.550885069377118, 6.024503165481516, 8.839409034714105, 5.538452130756824, 6.083331591851787, 3.5754981492539204, 6.288438392156014, 7.755253162630748, 6.236327654255031, 4.882652882490525, 7.219307915499178, 4.124478452912691, 5.969574122032112, 7.604047373594125, 7.701729041704455, 3.853956974376194, 9.946127671762953, 6.318209332040255, 6.923232777810415, 6.6451519833078265, 8.037128549417003, 10.027972582434298, 3.9258687777526586, 7.8425676429173405, 9.710976995796397, 8.167815017771995, 6.7098125871098055, 8.581649663696684, 8.299718645849104, 4.268995080267521, 10.651939578064086, 7.731867903205602, 4.800935640109778, 6.7018622738642994, 9.095626216207036, 9.177468679294932, 9.697358492051887, 8.28691161712164, 7.100850921050855, 8.091804396767651, 8.402789511461632, 5.584195868426386, 8.541865605481346, 6.647339406144162, 5.153534751208879, 2.8547160095545303, 7.101793884597825, 7.900523540663995, 8.908664437923258, 9.833946363287273, 5.856695936920255, 5.796007528020094, 6.774792131756734, 5.741068826733143, 7.556768465051464, 4.776903630452069, 5.204795932574889, 10.272247571610746, 9.286304480674, 7.646255422585588, 6.597589796025442, 5.4394184750547785, 7.939018845009483, 9.405771776637636, 5.899980190387225, 0.9571991725751628, 5.3384402265421445, 5.7346899055389455, 8.029478620292723, 4.900171622928935, 7.915058677412833, 7.431359249897482, 9.875369348890361, 6.350767517923278, 8.30793740137703, 8.20507303593268, 8.243282457326766, 6.8684067499893136, 8.191018932102365, 6.783147445128466, 8.065729312896284, 4.5613489114151555, 6.5514125478581375, 7.411029056266671, 8.127342432198903, 5.502518481557316, 6.2709847053431425, 5.576227344545815, 7.342772997332744, 7.187575628447334, 4.964732570110797], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.55674322758298, "mean_inference_ms": 6.588340613816384, "mean_action_processing_ms": 0.5283567469779917, "mean_env_wait_ms": 23.865711812596643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0320587158203125, "StateBufferConnector_ms": 0.03114175796508789, "ViewRequirementAgentConnector_ms": 0.5818619728088379}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2227750, "num_agent_steps_trained": 2227750, "num_env_steps_sampled": 2227750, "num_env_steps_trained": 2227750, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 306.3212764910029, "num_env_steps_trained_throughput_per_sec": 306.3212764910029, "timesteps_total": 2227750, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2227750, "timers": {"training_iteration_time_ms": 50393.984, "sample_time_ms": 38300.796, "load_time_ms": 593.056, "load_throughput": 26368.504, "learn_time_ms": 11154.462, "learn_throughput": 1401.95, "synch_weights_time_ms": 321.939}, "counters": {"num_env_steps_sampled": 2227750, "num_env_steps_trained": 2227750, "num_agent_steps_sampled": 2227750, "num_agent_steps_trained": 2227750}, "done": false, "episodes_total": 210, "training_iteration": 147, "trial_id": "c5092_00000", "date": "2025-06-08_09-53-29", "timestamp": 1749369209, "time_this_iter_s": 51.058616399765015, "time_total_s": 757.3442177772522, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 757.3442177772522, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 78.11016949152541, "ram_util_percent": 58.51694915254238, "gpu_util_percent0": 0.08762711864406779, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.77225e-05, "total_loss": -0.15282347640985708, "policy_loss": -0.029408525977103802, "vf_loss": 0.012722416350787337, "vf_explained_var": 0.7683570597388527, "kl": 0.02780277757609194, "entropy": 20.586797844279896, "entropy_coeff": 0.006287083333333332}, "model": {}, "num_grad_updates_lifetime": 8525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2243388, "num_env_steps_trained": 2243388, "num_agent_steps_sampled": 2243388, "num_agent_steps_trained": 2243388}, "sampler_results": {"episode_reward_max": 10.651939578064086, "episode_reward_min": 0.9571991725751628, "episode_reward_mean": 6.905932249500165, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.5754981492539204, 6.288438392156014, 7.755253162630748, 6.236327654255031, 4.882652882490525, 7.219307915499178, 4.124478452912691, 5.969574122032112, 7.604047373594125, 7.701729041704455, 3.853956974376194, 9.946127671762953, 6.318209332040255, 6.923232777810415, 6.6451519833078265, 8.037128549417003, 10.027972582434298, 3.9258687777526586, 7.8425676429173405, 9.710976995796397, 8.167815017771995, 6.7098125871098055, 8.581649663696684, 8.299718645849104, 4.268995080267521, 10.651939578064086, 7.731867903205602, 4.800935640109778, 6.7018622738642994, 9.095626216207036, 9.177468679294932, 9.697358492051887, 8.28691161712164, 7.100850921050855, 8.091804396767651, 8.402789511461632, 5.584195868426386, 8.541865605481346, 6.647339406144162, 5.153534751208879, 2.8547160095545303, 7.101793884597825, 7.900523540663995, 8.908664437923258, 9.833946363287273, 5.856695936920255, 5.796007528020094, 6.774792131756734, 5.741068826733143, 7.556768465051464, 4.776903630452069, 5.204795932574889, 10.272247571610746, 9.286304480674, 7.646255422585588, 6.597589796025442, 5.4394184750547785, 7.939018845009483, 9.405771776637636, 5.899980190387225, 0.9571991725751628, 5.3384402265421445, 5.7346899055389455, 8.029478620292723, 4.900171622928935, 7.915058677412833, 7.431359249897482, 9.875369348890361, 6.350767517923278, 8.30793740137703, 8.20507303593268, 8.243282457326766, 6.8684067499893136, 8.191018932102365, 6.783147445128466, 8.065729312896284, 4.5613489114151555, 6.5514125478581375, 7.411029056266671, 8.127342432198903, 5.502518481557316, 6.2709847053431425, 5.576227344545815, 7.342772997332744, 7.187575628447334, 4.964732570110797, 8.722121800605393, 6.599100225672838, 8.469468133887421, 3.918344665563585, 8.227915784733527, 9.880893222423676, 6.956679237843526, 7.141995748294636, 2.392962390807395, 4.826869052039529, 2.7384788335976116, 6.167264957187534, 7.056306645642468, 5.7256443650668665], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5551821575911644, "mean_inference_ms": 6.612113728553753, "mean_action_processing_ms": 0.5301007340958745, "mean_env_wait_ms": 23.97874001646963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029083251953125, "StateBufferConnector_ms": 0.03615260124206543, "ViewRequirementAgentConnector_ms": 0.5826325416564941}}, "episode_reward_max": 10.651939578064086, "episode_reward_min": 0.9571991725751628, "episode_reward_mean": 6.905932249500165, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.5754981492539204, 6.288438392156014, 7.755253162630748, 6.236327654255031, 4.882652882490525, 7.219307915499178, 4.124478452912691, 5.969574122032112, 7.604047373594125, 7.701729041704455, 3.853956974376194, 9.946127671762953, 6.318209332040255, 6.923232777810415, 6.6451519833078265, 8.037128549417003, 10.027972582434298, 3.9258687777526586, 7.8425676429173405, 9.710976995796397, 8.167815017771995, 6.7098125871098055, 8.581649663696684, 8.299718645849104, 4.268995080267521, 10.651939578064086, 7.731867903205602, 4.800935640109778, 6.7018622738642994, 9.095626216207036, 9.177468679294932, 9.697358492051887, 8.28691161712164, 7.100850921050855, 8.091804396767651, 8.402789511461632, 5.584195868426386, 8.541865605481346, 6.647339406144162, 5.153534751208879, 2.8547160095545303, 7.101793884597825, 7.900523540663995, 8.908664437923258, 9.833946363287273, 5.856695936920255, 5.796007528020094, 6.774792131756734, 5.741068826733143, 7.556768465051464, 4.776903630452069, 5.204795932574889, 10.272247571610746, 9.286304480674, 7.646255422585588, 6.597589796025442, 5.4394184750547785, 7.939018845009483, 9.405771776637636, 5.899980190387225, 0.9571991725751628, 5.3384402265421445, 5.7346899055389455, 8.029478620292723, 4.900171622928935, 7.915058677412833, 7.431359249897482, 9.875369348890361, 6.350767517923278, 8.30793740137703, 8.20507303593268, 8.243282457326766, 6.8684067499893136, 8.191018932102365, 6.783147445128466, 8.065729312896284, 4.5613489114151555, 6.5514125478581375, 7.411029056266671, 8.127342432198903, 5.502518481557316, 6.2709847053431425, 5.576227344545815, 7.342772997332744, 7.187575628447334, 4.964732570110797, 8.722121800605393, 6.599100225672838, 8.469468133887421, 3.918344665563585, 8.227915784733527, 9.880893222423676, 6.956679237843526, 7.141995748294636, 2.392962390807395, 4.826869052039529, 2.7384788335976116, 6.167264957187534, 7.056306645642468, 5.7256443650668665], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5551821575911644, "mean_inference_ms": 6.612113728553753, "mean_action_processing_ms": 0.5301007340958745, "mean_env_wait_ms": 23.97874001646963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029083251953125, "StateBufferConnector_ms": 0.03615260124206543, "ViewRequirementAgentConnector_ms": 0.5826325416564941}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2243388, "num_agent_steps_trained": 2243388, "num_env_steps_sampled": 2243388, "num_env_steps_trained": 2243388, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 302.13520100494367, "num_env_steps_trained_throughput_per_sec": 302.13520100494367, "timesteps_total": 2243388, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2243388, "timers": {"training_iteration_time_ms": 50657.228, "sample_time_ms": 38552.975, "load_time_ms": 598.452, "load_throughput": 26130.735, "learn_time_ms": 11160.051, "learn_throughput": 1401.248, "synch_weights_time_ms": 322.752}, "counters": {"num_env_steps_sampled": 2243388, "num_env_steps_trained": 2243388, "num_agent_steps_sampled": 2243388, "num_agent_steps_trained": 2243388}, "done": false, "episodes_total": 224, "training_iteration": 148, "trial_id": "c5092_00000", "date": "2025-06-08_09-54-21", "timestamp": 1749369261, "time_this_iter_s": 51.781766414642334, "time_total_s": 809.1259841918945, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 809.1259841918945, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 80.12033898305086, "ram_util_percent": 58.59661016949152, "gpu_util_percent0": 0.07694915254237288, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.756612000000002e-05, "total_loss": -0.1660211885906756, "policy_loss": -0.04249322298891705, "vf_loss": 0.011989959663796153, "vf_explained_var": 0.7825782836567272, "kl": 0.027446122332264414, "entropy": 20.650945933948865, "entropy_coeff": 0.00626102}, "model": {}, "num_grad_updates_lifetime": 9075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2259026, "num_env_steps_trained": 2259026, "num_agent_steps_sampled": 2259026, "num_agent_steps_trained": 2259026}, "sampler_results": {"episode_reward_max": 10.651939578064086, "episode_reward_min": 0.9571991725751628, "episode_reward_mean": 6.912737623245636, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.6451519833078265, 8.037128549417003, 10.027972582434298, 3.9258687777526586, 7.8425676429173405, 9.710976995796397, 8.167815017771995, 6.7098125871098055, 8.581649663696684, 8.299718645849104, 4.268995080267521, 10.651939578064086, 7.731867903205602, 4.800935640109778, 6.7018622738642994, 9.095626216207036, 9.177468679294932, 9.697358492051887, 8.28691161712164, 7.100850921050855, 8.091804396767651, 8.402789511461632, 5.584195868426386, 8.541865605481346, 6.647339406144162, 5.153534751208879, 2.8547160095545303, 7.101793884597825, 7.900523540663995, 8.908664437923258, 9.833946363287273, 5.856695936920255, 5.796007528020094, 6.774792131756734, 5.741068826733143, 7.556768465051464, 4.776903630452069, 5.204795932574889, 10.272247571610746, 9.286304480674, 7.646255422585588, 6.597589796025442, 5.4394184750547785, 7.939018845009483, 9.405771776637636, 5.899980190387225, 0.9571991725751628, 5.3384402265421445, 5.7346899055389455, 8.029478620292723, 4.900171622928935, 7.915058677412833, 7.431359249897482, 9.875369348890361, 6.350767517923278, 8.30793740137703, 8.20507303593268, 8.243282457326766, 6.8684067499893136, 8.191018932102365, 6.783147445128466, 8.065729312896284, 4.5613489114151555, 6.5514125478581375, 7.411029056266671, 8.127342432198903, 5.502518481557316, 6.2709847053431425, 5.576227344545815, 7.342772997332744, 7.187575628447334, 4.964732570110797, 8.722121800605393, 6.599100225672838, 8.469468133887421, 3.918344665563585, 8.227915784733527, 9.880893222423676, 6.956679237843526, 7.141995748294636, 2.392962390807395, 4.826869052039529, 2.7384788335976116, 6.167264957187534, 7.056306645642468, 5.7256443650668665, 7.529869123870094, 5.168305722929078, 9.610015639112724, 3.7315859756438554, 3.6426323098029467, 9.334735339274685, 8.368517670310764, 6.273624230412876, 8.08304354911684, 3.8184487949648633, 4.867119250900541, 6.700758089420711, 5.481955626682667, 6.468759954623138], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5543676170785525, "mean_inference_ms": 6.631543233055648, "mean_action_processing_ms": 0.5315463299566379, "mean_env_wait_ms": 24.08103692947836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03311634063720703, "StateBufferConnector_ms": 0.04219818115234375, "ViewRequirementAgentConnector_ms": 0.6140072345733643}}, "episode_reward_max": 10.651939578064086, "episode_reward_min": 0.9571991725751628, "episode_reward_mean": 6.912737623245636, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.6451519833078265, 8.037128549417003, 10.027972582434298, 3.9258687777526586, 7.8425676429173405, 9.710976995796397, 8.167815017771995, 6.7098125871098055, 8.581649663696684, 8.299718645849104, 4.268995080267521, 10.651939578064086, 7.731867903205602, 4.800935640109778, 6.7018622738642994, 9.095626216207036, 9.177468679294932, 9.697358492051887, 8.28691161712164, 7.100850921050855, 8.091804396767651, 8.402789511461632, 5.584195868426386, 8.541865605481346, 6.647339406144162, 5.153534751208879, 2.8547160095545303, 7.101793884597825, 7.900523540663995, 8.908664437923258, 9.833946363287273, 5.856695936920255, 5.796007528020094, 6.774792131756734, 5.741068826733143, 7.556768465051464, 4.776903630452069, 5.204795932574889, 10.272247571610746, 9.286304480674, 7.646255422585588, 6.597589796025442, 5.4394184750547785, 7.939018845009483, 9.405771776637636, 5.899980190387225, 0.9571991725751628, 5.3384402265421445, 5.7346899055389455, 8.029478620292723, 4.900171622928935, 7.915058677412833, 7.431359249897482, 9.875369348890361, 6.350767517923278, 8.30793740137703, 8.20507303593268, 8.243282457326766, 6.8684067499893136, 8.191018932102365, 6.783147445128466, 8.065729312896284, 4.5613489114151555, 6.5514125478581375, 7.411029056266671, 8.127342432198903, 5.502518481557316, 6.2709847053431425, 5.576227344545815, 7.342772997332744, 7.187575628447334, 4.964732570110797, 8.722121800605393, 6.599100225672838, 8.469468133887421, 3.918344665563585, 8.227915784733527, 9.880893222423676, 6.956679237843526, 7.141995748294636, 2.392962390807395, 4.826869052039529, 2.7384788335976116, 6.167264957187534, 7.056306645642468, 5.7256443650668665, 7.529869123870094, 5.168305722929078, 9.610015639112724, 3.7315859756438554, 3.6426323098029467, 9.334735339274685, 8.368517670310764, 6.273624230412876, 8.08304354911684, 3.8184487949648633, 4.867119250900541, 6.700758089420711, 5.481955626682667, 6.468759954623138], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5543676170785525, "mean_inference_ms": 6.631543233055648, "mean_action_processing_ms": 0.5315463299566379, "mean_env_wait_ms": 24.08103692947836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03311634063720703, "StateBufferConnector_ms": 0.04219818115234375, "ViewRequirementAgentConnector_ms": 0.6140072345733643}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2259026, "num_agent_steps_trained": 2259026, "num_env_steps_sampled": 2259026, "num_env_steps_trained": 2259026, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 304.35149664587993, "num_env_steps_trained_throughput_per_sec": 304.35149664587993, "timesteps_total": 2259026, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2259026, "timers": {"training_iteration_time_ms": 50852.105, "sample_time_ms": 38753.645, "load_time_ms": 601.881, "load_throughput": 25981.872, "learn_time_ms": 11147.923, "learn_throughput": 1402.773, "synch_weights_time_ms": 325.019}, "counters": {"num_env_steps_sampled": 2259026, "num_env_steps_trained": 2259026, "num_agent_steps_sampled": 2259026, "num_agent_steps_trained": 2259026}, "done": false, "episodes_total": 238, "training_iteration": 149, "trial_id": "c5092_00000", "date": "2025-06-08_09-55-12", "timestamp": 1749369312, "time_this_iter_s": 51.3923659324646, "time_total_s": 860.5183501243591, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 860.5183501243591, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 78.74833333333335, "ram_util_percent": 58.68333333333333, "gpu_util_percent0": 0.08816666666666666, "vram_util_percent0": 0.18831380208333337}}
{"evaluation": {"sampler_results": {"episode_reward_max": -2.5998060469118207, "episode_reward_min": -8.556312217155384, "episode_reward_mean": -6.1010094091581495, "episode_len_mean": 182.6, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.08462599308362, -8.556312217155384, -2.5998060469118207, -8.180894807607116, -4.083407981032808], "episode_lengths": [184, 177, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2169804671858493, "mean_inference_ms": 3.3853063146576625, "mean_action_processing_ms": 0.26174720007044666, "mean_env_wait_ms": 10.51076326921436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.020003318786621094, "ViewRequirementAgentConnector_ms": 0.12003898620605469}}, "episode_reward_max": -2.5998060469118207, "episode_reward_min": -8.556312217155384, "episode_reward_mean": -6.1010094091581495, "episode_len_mean": 182.6, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.08462599308362, -8.556312217155384, -2.5998060469118207, -8.180894807607116, -4.083407981032808], "episode_lengths": [184, 177, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2169804671858493, "mean_inference_ms": 3.3853063146576625, "mean_action_processing_ms": 0.26174720007044666, "mean_env_wait_ms": 10.51076326921436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.020003318786621094, "ViewRequirementAgentConnector_ms": 0.12003898620605469}, "num_agent_steps_sampled_this_iter": 913, "num_env_steps_sampled_this_iter": 913, "timesteps_this_iter": 913, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.740974e-05, "total_loss": -0.1454865264655514, "policy_loss": -0.02314514491326091, "vf_loss": 0.012500478795052252, "vf_explained_var": 0.7631594855135138, "kl": 0.02719896208727866, "entropy": 20.568388321616432, "entropy_coeff": 0.006234956666666667}, "model": {}, "num_grad_updates_lifetime": 9625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2274664, "num_env_steps_trained": 2274664, "num_agent_steps_sampled": 2274664, "num_agent_steps_trained": 2274664}, "sampler_results": {"episode_reward_max": 10.272247571610746, "episode_reward_min": 0.9571991725751628, "episode_reward_mean": 6.781492824884087, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.7018622738642994, 9.095626216207036, 9.177468679294932, 9.697358492051887, 8.28691161712164, 7.100850921050855, 8.091804396767651, 8.402789511461632, 5.584195868426386, 8.541865605481346, 6.647339406144162, 5.153534751208879, 2.8547160095545303, 7.101793884597825, 7.900523540663995, 8.908664437923258, 9.833946363287273, 5.856695936920255, 5.796007528020094, 6.774792131756734, 5.741068826733143, 7.556768465051464, 4.776903630452069, 5.204795932574889, 10.272247571610746, 9.286304480674, 7.646255422585588, 6.597589796025442, 5.4394184750547785, 7.939018845009483, 9.405771776637636, 5.899980190387225, 0.9571991725751628, 5.3384402265421445, 5.7346899055389455, 8.029478620292723, 4.900171622928935, 7.915058677412833, 7.431359249897482, 9.875369348890361, 6.350767517923278, 8.30793740137703, 8.20507303593268, 8.243282457326766, 6.8684067499893136, 8.191018932102365, 6.783147445128466, 8.065729312896284, 4.5613489114151555, 6.5514125478581375, 7.411029056266671, 8.127342432198903, 5.502518481557316, 6.2709847053431425, 5.576227344545815, 7.342772997332744, 7.187575628447334, 4.964732570110797, 8.722121800605393, 6.599100225672838, 8.469468133887421, 3.918344665563585, 8.227915784733527, 9.880893222423676, 6.956679237843526, 7.141995748294636, 2.392962390807395, 4.826869052039529, 2.7384788335976116, 6.167264957187534, 7.056306645642468, 5.7256443650668665, 7.529869123870094, 5.168305722929078, 9.610015639112724, 3.7315859756438554, 3.6426323098029467, 9.334735339274685, 8.368517670310764, 6.273624230412876, 8.08304354911684, 3.8184487949648633, 4.867119250900541, 6.700758089420711, 5.481955626682667, 6.468759954623138, 6.584214805339346, 6.820867554078354, 4.0615071624751256, 9.073580945919414, 8.254937627751973, 4.74501160307902, 6.299498748667449, 2.3362436362256056, 8.661055306049235, 4.596695477797019, 6.150059458252891, 6.968213292992977, 9.371913272525505, 8.354121920391039], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5540005739933873, "mean_inference_ms": 6.6501065384923175, "mean_action_processing_ms": 0.5330301278164213, "mean_env_wait_ms": 24.178025401317385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03610658645629883, "StateBufferConnector_ms": 0.04112362861633301, "ViewRequirementAgentConnector_ms": 0.6293771266937256}}, "episode_reward_max": 10.272247571610746, "episode_reward_min": 0.9571991725751628, "episode_reward_mean": 6.781492824884087, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.7018622738642994, 9.095626216207036, 9.177468679294932, 9.697358492051887, 8.28691161712164, 7.100850921050855, 8.091804396767651, 8.402789511461632, 5.584195868426386, 8.541865605481346, 6.647339406144162, 5.153534751208879, 2.8547160095545303, 7.101793884597825, 7.900523540663995, 8.908664437923258, 9.833946363287273, 5.856695936920255, 5.796007528020094, 6.774792131756734, 5.741068826733143, 7.556768465051464, 4.776903630452069, 5.204795932574889, 10.272247571610746, 9.286304480674, 7.646255422585588, 6.597589796025442, 5.4394184750547785, 7.939018845009483, 9.405771776637636, 5.899980190387225, 0.9571991725751628, 5.3384402265421445, 5.7346899055389455, 8.029478620292723, 4.900171622928935, 7.915058677412833, 7.431359249897482, 9.875369348890361, 6.350767517923278, 8.30793740137703, 8.20507303593268, 8.243282457326766, 6.8684067499893136, 8.191018932102365, 6.783147445128466, 8.065729312896284, 4.5613489114151555, 6.5514125478581375, 7.411029056266671, 8.127342432198903, 5.502518481557316, 6.2709847053431425, 5.576227344545815, 7.342772997332744, 7.187575628447334, 4.964732570110797, 8.722121800605393, 6.599100225672838, 8.469468133887421, 3.918344665563585, 8.227915784733527, 9.880893222423676, 6.956679237843526, 7.141995748294636, 2.392962390807395, 4.826869052039529, 2.7384788335976116, 6.167264957187534, 7.056306645642468, 5.7256443650668665, 7.529869123870094, 5.168305722929078, 9.610015639112724, 3.7315859756438554, 3.6426323098029467, 9.334735339274685, 8.368517670310764, 6.273624230412876, 8.08304354911684, 3.8184487949648633, 4.867119250900541, 6.700758089420711, 5.481955626682667, 6.468759954623138, 6.584214805339346, 6.820867554078354, 4.0615071624751256, 9.073580945919414, 8.254937627751973, 4.74501160307902, 6.299498748667449, 2.3362436362256056, 8.661055306049235, 4.596695477797019, 6.150059458252891, 6.968213292992977, 9.371913272525505, 8.354121920391039], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5540005739933873, "mean_inference_ms": 6.6501065384923175, "mean_action_processing_ms": 0.5330301278164213, "mean_env_wait_ms": 24.178025401317385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03610658645629883, "StateBufferConnector_ms": 0.04112362861633301, "ViewRequirementAgentConnector_ms": 0.6293771266937256}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2274664, "num_agent_steps_trained": 2274664, "num_env_steps_sampled": 2274664, "num_env_steps_trained": 2274664, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 300.52266952746925, "num_env_steps_trained_throughput_per_sec": 300.52266952746925, "timesteps_total": 2274664, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2274664, "timers": {"training_iteration_time_ms": 51084.486, "sample_time_ms": 38968.644, "load_time_ms": 602.629, "load_throughput": 25949.639, "learn_time_ms": 11169.478, "learn_throughput": 1400.065, "synch_weights_time_ms": 320.539}, "counters": {"num_env_steps_sampled": 2274664, "num_env_steps_trained": 2274664, "num_agent_steps_sampled": 2274664, "num_agent_steps_trained": 2274664}, "done": false, "episodes_total": 252, "training_iteration": 150, "trial_id": "c5092_00000", "date": "2025-06-08_09-56-18", "timestamp": 1749369378, "time_this_iter_s": 66.02506709098816, "time_total_s": 926.5434172153473, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 926.5434172153473, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 66.72337662337661, "ram_util_percent": 58.619480519480504, "gpu_util_percent0": 0.06753246753246753, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.725335999999997e-05, "total_loss": -0.157981993151744, "policy_loss": -0.03610652403223371, "vf_loss": 0.013080129743638364, "vf_explained_var": 0.7410236581889066, "kl": 0.026186922565528046, "entropy": 20.594802804426713, "entropy_coeff": 0.006208893333333333}, "model": {}, "num_grad_updates_lifetime": 10175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2290302, "num_env_steps_trained": 2290302, "num_agent_steps_sampled": 2290302, "num_agent_steps_trained": 2290302}, "sampler_results": {"episode_reward_max": 12.514428534474467, "episode_reward_min": 0.9571991725751628, "episode_reward_mean": 6.695012580003087, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.900523540663995, 8.908664437923258, 9.833946363287273, 5.856695936920255, 5.796007528020094, 6.774792131756734, 5.741068826733143, 7.556768465051464, 4.776903630452069, 5.204795932574889, 10.272247571610746, 9.286304480674, 7.646255422585588, 6.597589796025442, 5.4394184750547785, 7.939018845009483, 9.405771776637636, 5.899980190387225, 0.9571991725751628, 5.3384402265421445, 5.7346899055389455, 8.029478620292723, 4.900171622928935, 7.915058677412833, 7.431359249897482, 9.875369348890361, 6.350767517923278, 8.30793740137703, 8.20507303593268, 8.243282457326766, 6.8684067499893136, 8.191018932102365, 6.783147445128466, 8.065729312896284, 4.5613489114151555, 6.5514125478581375, 7.411029056266671, 8.127342432198903, 5.502518481557316, 6.2709847053431425, 5.576227344545815, 7.342772997332744, 7.187575628447334, 4.964732570110797, 8.722121800605393, 6.599100225672838, 8.469468133887421, 3.918344665563585, 8.227915784733527, 9.880893222423676, 6.956679237843526, 7.141995748294636, 2.392962390807395, 4.826869052039529, 2.7384788335976116, 6.167264957187534, 7.056306645642468, 5.7256443650668665, 7.529869123870094, 5.168305722929078, 9.610015639112724, 3.7315859756438554, 3.6426323098029467, 9.334735339274685, 8.368517670310764, 6.273624230412876, 8.08304354911684, 3.8184487949648633, 4.867119250900541, 6.700758089420711, 5.481955626682667, 6.468759954623138, 6.584214805339346, 6.820867554078354, 4.0615071624751256, 9.073580945919414, 8.254937627751973, 4.74501160307902, 6.299498748667449, 2.3362436362256056, 8.661055306049235, 4.596695477797019, 6.150059458252891, 6.968213292992977, 9.371913272525505, 8.354121920391039, 3.3238062474707175, 4.990618706073042, 6.648592964647557, 7.645809581191458, 6.34684776854285, 5.0240205800744455, 6.359219482569622, 4.553164289028838, 12.514428534474467, 7.125985921327465, 6.746863728185306, 6.182974918225453, 10.565694854952396, 5.762065568369346], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5542933995783261, "mean_inference_ms": 6.66764177771525, "mean_action_processing_ms": 0.534318932587989, "mean_env_wait_ms": 24.268658452617696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03209042549133301, "StateBufferConnector_ms": 0.039140939712524414, "ViewRequirementAgentConnector_ms": 0.6192748546600342}}, "episode_reward_max": 12.514428534474467, "episode_reward_min": 0.9571991725751628, "episode_reward_mean": 6.695012580003087, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.900523540663995, 8.908664437923258, 9.833946363287273, 5.856695936920255, 5.796007528020094, 6.774792131756734, 5.741068826733143, 7.556768465051464, 4.776903630452069, 5.204795932574889, 10.272247571610746, 9.286304480674, 7.646255422585588, 6.597589796025442, 5.4394184750547785, 7.939018845009483, 9.405771776637636, 5.899980190387225, 0.9571991725751628, 5.3384402265421445, 5.7346899055389455, 8.029478620292723, 4.900171622928935, 7.915058677412833, 7.431359249897482, 9.875369348890361, 6.350767517923278, 8.30793740137703, 8.20507303593268, 8.243282457326766, 6.8684067499893136, 8.191018932102365, 6.783147445128466, 8.065729312896284, 4.5613489114151555, 6.5514125478581375, 7.411029056266671, 8.127342432198903, 5.502518481557316, 6.2709847053431425, 5.576227344545815, 7.342772997332744, 7.187575628447334, 4.964732570110797, 8.722121800605393, 6.599100225672838, 8.469468133887421, 3.918344665563585, 8.227915784733527, 9.880893222423676, 6.956679237843526, 7.141995748294636, 2.392962390807395, 4.826869052039529, 2.7384788335976116, 6.167264957187534, 7.056306645642468, 5.7256443650668665, 7.529869123870094, 5.168305722929078, 9.610015639112724, 3.7315859756438554, 3.6426323098029467, 9.334735339274685, 8.368517670310764, 6.273624230412876, 8.08304354911684, 3.8184487949648633, 4.867119250900541, 6.700758089420711, 5.481955626682667, 6.468759954623138, 6.584214805339346, 6.820867554078354, 4.0615071624751256, 9.073580945919414, 8.254937627751973, 4.74501160307902, 6.299498748667449, 2.3362436362256056, 8.661055306049235, 4.596695477797019, 6.150059458252891, 6.968213292992977, 9.371913272525505, 8.354121920391039, 3.3238062474707175, 4.990618706073042, 6.648592964647557, 7.645809581191458, 6.34684776854285, 5.0240205800744455, 6.359219482569622, 4.553164289028838, 12.514428534474467, 7.125985921327465, 6.746863728185306, 6.182974918225453, 10.565694854952396, 5.762065568369346], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5542933995783261, "mean_inference_ms": 6.66764177771525, "mean_action_processing_ms": 0.534318932587989, "mean_env_wait_ms": 24.268658452617696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03209042549133301, "StateBufferConnector_ms": 0.039140939712524414, "ViewRequirementAgentConnector_ms": 0.6192748546600342}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2290302, "num_agent_steps_trained": 2290302, "num_env_steps_sampled": 2290302, "num_env_steps_trained": 2290302, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 302.71920830003535, "num_env_steps_trained_throughput_per_sec": 302.71920830003535, "timesteps_total": 2290302, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2290302, "timers": {"training_iteration_time_ms": 51283.938, "sample_time_ms": 39162.623, "load_time_ms": 602.198, "load_throughput": 25968.19, "learn_time_ms": 11172.496, "learn_throughput": 1399.687, "synch_weights_time_ms": 323.273}, "counters": {"num_env_steps_sampled": 2290302, "num_env_steps_trained": 2290302, "num_agent_steps_sampled": 2290302, "num_agent_steps_trained": 2290302}, "done": false, "episodes_total": 266, "training_iteration": 151, "trial_id": "c5092_00000", "date": "2025-06-08_09-57-10", "timestamp": 1749369430, "time_this_iter_s": 51.67042064666748, "time_total_s": 978.2138378620148, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 978.2138378620148, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 79.16666666666667, "ram_util_percent": 58.82, "gpu_util_percent0": 0.0785, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.709698000000001e-05, "total_loss": -0.14009747494308447, "policy_loss": -0.018861434741570107, "vf_loss": 0.0119448542912406, "vf_explained_var": 0.7496835382418199, "kl": 0.027558716458286395, "entropy": 20.540664476914838, "entropy_coeff": 0.00618283}, "model": {}, "num_grad_updates_lifetime": 10725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2305940, "num_env_steps_trained": 2305940, "num_agent_steps_sampled": 2305940, "num_agent_steps_trained": 2305940}, "sampler_results": {"episode_reward_max": 12.514428534474467, "episode_reward_min": 0.9571991725751628, "episode_reward_mean": 6.665207520924449, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.4394184750547785, 7.939018845009483, 9.405771776637636, 5.899980190387225, 0.9571991725751628, 5.3384402265421445, 5.7346899055389455, 8.029478620292723, 4.900171622928935, 7.915058677412833, 7.431359249897482, 9.875369348890361, 6.350767517923278, 8.30793740137703, 8.20507303593268, 8.243282457326766, 6.8684067499893136, 8.191018932102365, 6.783147445128466, 8.065729312896284, 4.5613489114151555, 6.5514125478581375, 7.411029056266671, 8.127342432198903, 5.502518481557316, 6.2709847053431425, 5.576227344545815, 7.342772997332744, 7.187575628447334, 4.964732570110797, 8.722121800605393, 6.599100225672838, 8.469468133887421, 3.918344665563585, 8.227915784733527, 9.880893222423676, 6.956679237843526, 7.141995748294636, 2.392962390807395, 4.826869052039529, 2.7384788335976116, 6.167264957187534, 7.056306645642468, 5.7256443650668665, 7.529869123870094, 5.168305722929078, 9.610015639112724, 3.7315859756438554, 3.6426323098029467, 9.334735339274685, 8.368517670310764, 6.273624230412876, 8.08304354911684, 3.8184487949648633, 4.867119250900541, 6.700758089420711, 5.481955626682667, 6.468759954623138, 6.584214805339346, 6.820867554078354, 4.0615071624751256, 9.073580945919414, 8.254937627751973, 4.74501160307902, 6.299498748667449, 2.3362436362256056, 8.661055306049235, 4.596695477797019, 6.150059458252891, 6.968213292992977, 9.371913272525505, 8.354121920391039, 3.3238062474707175, 4.990618706073042, 6.648592964647557, 7.645809581191458, 6.34684776854285, 5.0240205800744455, 6.359219482569622, 4.553164289028838, 12.514428534474467, 7.125985921327465, 6.746863728185306, 6.182974918225453, 10.565694854952396, 5.762065568369346, 8.615755984584514, 9.290814781262355, 7.30499585408052, 7.2885665180052275, 10.781020633097533, 7.216221051880661, 6.273685805720569, 8.398208092264994, 3.753118331070647, 5.948150349649147, 9.166037586756719, 3.9474221313260007, 5.542551814170725, 5.645509222545668], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5565228172485397, "mean_inference_ms": 6.687326742897461, "mean_action_processing_ms": 0.5356340487557373, "mean_env_wait_ms": 24.350288119814863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0315549373626709, "StateBufferConnector_ms": 0.03510642051696777, "ViewRequirementAgentConnector_ms": 0.6016340255737305}}, "episode_reward_max": 12.514428534474467, "episode_reward_min": 0.9571991725751628, "episode_reward_mean": 6.665207520924449, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.4394184750547785, 7.939018845009483, 9.405771776637636, 5.899980190387225, 0.9571991725751628, 5.3384402265421445, 5.7346899055389455, 8.029478620292723, 4.900171622928935, 7.915058677412833, 7.431359249897482, 9.875369348890361, 6.350767517923278, 8.30793740137703, 8.20507303593268, 8.243282457326766, 6.8684067499893136, 8.191018932102365, 6.783147445128466, 8.065729312896284, 4.5613489114151555, 6.5514125478581375, 7.411029056266671, 8.127342432198903, 5.502518481557316, 6.2709847053431425, 5.576227344545815, 7.342772997332744, 7.187575628447334, 4.964732570110797, 8.722121800605393, 6.599100225672838, 8.469468133887421, 3.918344665563585, 8.227915784733527, 9.880893222423676, 6.956679237843526, 7.141995748294636, 2.392962390807395, 4.826869052039529, 2.7384788335976116, 6.167264957187534, 7.056306645642468, 5.7256443650668665, 7.529869123870094, 5.168305722929078, 9.610015639112724, 3.7315859756438554, 3.6426323098029467, 9.334735339274685, 8.368517670310764, 6.273624230412876, 8.08304354911684, 3.8184487949648633, 4.867119250900541, 6.700758089420711, 5.481955626682667, 6.468759954623138, 6.584214805339346, 6.820867554078354, 4.0615071624751256, 9.073580945919414, 8.254937627751973, 4.74501160307902, 6.299498748667449, 2.3362436362256056, 8.661055306049235, 4.596695477797019, 6.150059458252891, 6.968213292992977, 9.371913272525505, 8.354121920391039, 3.3238062474707175, 4.990618706073042, 6.648592964647557, 7.645809581191458, 6.34684776854285, 5.0240205800744455, 6.359219482569622, 4.553164289028838, 12.514428534474467, 7.125985921327465, 6.746863728185306, 6.182974918225453, 10.565694854952396, 5.762065568369346, 8.615755984584514, 9.290814781262355, 7.30499585408052, 7.2885665180052275, 10.781020633097533, 7.216221051880661, 6.273685805720569, 8.398208092264994, 3.753118331070647, 5.948150349649147, 9.166037586756719, 3.9474221313260007, 5.542551814170725, 5.645509222545668], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5565228172485397, "mean_inference_ms": 6.687326742897461, "mean_action_processing_ms": 0.5356340487557373, "mean_env_wait_ms": 24.350288119814863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0315549373626709, "StateBufferConnector_ms": 0.03510642051696777, "ViewRequirementAgentConnector_ms": 0.6016340255737305}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2305940, "num_agent_steps_trained": 2305940, "num_env_steps_sampled": 2305940, "num_env_steps_trained": 2305940, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 299.6843491137954, "num_env_steps_trained_throughput_per_sec": 299.6843491137954, "timesteps_total": 2305940, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2305940, "timers": {"training_iteration_time_ms": 51368.674, "sample_time_ms": 39252.492, "load_time_ms": 593.208, "load_throughput": 26361.76, "learn_time_ms": 11173.898, "learn_throughput": 1399.512, "synch_weights_time_ms": 325.741}, "counters": {"num_env_steps_sampled": 2305940, "num_env_steps_trained": 2305940, "num_agent_steps_sampled": 2305940, "num_agent_steps_trained": 2305940}, "done": false, "episodes_total": 280, "training_iteration": 152, "trial_id": "c5092_00000", "date": "2025-06-08_09-58-02", "timestamp": 1749369482, "time_this_iter_s": 52.19257164001465, "time_total_s": 1030.4064095020294, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1030.4064095020294, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 79.16166666666668, "ram_util_percent": 58.80833333333332, "gpu_util_percent0": 0.08416666666666667, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.694060000000002e-05, "total_loss": -0.15957029517888177, "policy_loss": -0.03928308821150991, "vf_loss": 0.013675541827793826, "vf_explained_var": 0.7542568898200989, "kl": 0.027635991698429316, "entropy": 20.55882972197099, "entropy_coeff": 0.006156766666666666}, "model": {}, "num_grad_updates_lifetime": 11275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2321578, "num_env_steps_trained": 2321578, "num_agent_steps_sampled": 2321578, "num_agent_steps_trained": 2321578}, "sampler_results": {"episode_reward_max": 12.514428534474467, "episode_reward_min": 2.3362436362256056, "episode_reward_mean": 6.686630966548231, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.20507303593268, 8.243282457326766, 6.8684067499893136, 8.191018932102365, 6.783147445128466, 8.065729312896284, 4.5613489114151555, 6.5514125478581375, 7.411029056266671, 8.127342432198903, 5.502518481557316, 6.2709847053431425, 5.576227344545815, 7.342772997332744, 7.187575628447334, 4.964732570110797, 8.722121800605393, 6.599100225672838, 8.469468133887421, 3.918344665563585, 8.227915784733527, 9.880893222423676, 6.956679237843526, 7.141995748294636, 2.392962390807395, 4.826869052039529, 2.7384788335976116, 6.167264957187534, 7.056306645642468, 5.7256443650668665, 7.529869123870094, 5.168305722929078, 9.610015639112724, 3.7315859756438554, 3.6426323098029467, 9.334735339274685, 8.368517670310764, 6.273624230412876, 8.08304354911684, 3.8184487949648633, 4.867119250900541, 6.700758089420711, 5.481955626682667, 6.468759954623138, 6.584214805339346, 6.820867554078354, 4.0615071624751256, 9.073580945919414, 8.254937627751973, 4.74501160307902, 6.299498748667449, 2.3362436362256056, 8.661055306049235, 4.596695477797019, 6.150059458252891, 6.968213292992977, 9.371913272525505, 8.354121920391039, 3.3238062474707175, 4.990618706073042, 6.648592964647557, 7.645809581191458, 6.34684776854285, 5.0240205800744455, 6.359219482569622, 4.553164289028838, 12.514428534474467, 7.125985921327465, 6.746863728185306, 6.182974918225453, 10.565694854952396, 5.762065568369346, 8.615755984584514, 9.290814781262355, 7.30499585408052, 7.2885665180052275, 10.781020633097533, 7.216221051880661, 6.273685805720569, 8.398208092264994, 3.753118331070647, 5.948150349649147, 9.166037586756719, 3.9474221313260007, 5.542551814170725, 5.645509222545668, 6.664240325493721, 8.093156370205175, 7.9306316645225206, 4.855480417892128, 6.196492152311427, 6.809166660824364, 5.323414670521446, 3.571660951915303, 9.096697784483835, 7.194097667974603, 9.423359107725709, 7.399277412614379, 7.736022344430795, 5.373308061930758], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.558193166584895, "mean_inference_ms": 6.705518484122208, "mean_action_processing_ms": 0.536883622436185, "mean_env_wait_ms": 24.42633297478395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027599573135375977, "StateBufferConnector_ms": 0.03311610221862793, "ViewRequirementAgentConnector_ms": 0.5912299156188965}}, "episode_reward_max": 12.514428534474467, "episode_reward_min": 2.3362436362256056, "episode_reward_mean": 6.686630966548231, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.20507303593268, 8.243282457326766, 6.8684067499893136, 8.191018932102365, 6.783147445128466, 8.065729312896284, 4.5613489114151555, 6.5514125478581375, 7.411029056266671, 8.127342432198903, 5.502518481557316, 6.2709847053431425, 5.576227344545815, 7.342772997332744, 7.187575628447334, 4.964732570110797, 8.722121800605393, 6.599100225672838, 8.469468133887421, 3.918344665563585, 8.227915784733527, 9.880893222423676, 6.956679237843526, 7.141995748294636, 2.392962390807395, 4.826869052039529, 2.7384788335976116, 6.167264957187534, 7.056306645642468, 5.7256443650668665, 7.529869123870094, 5.168305722929078, 9.610015639112724, 3.7315859756438554, 3.6426323098029467, 9.334735339274685, 8.368517670310764, 6.273624230412876, 8.08304354911684, 3.8184487949648633, 4.867119250900541, 6.700758089420711, 5.481955626682667, 6.468759954623138, 6.584214805339346, 6.820867554078354, 4.0615071624751256, 9.073580945919414, 8.254937627751973, 4.74501160307902, 6.299498748667449, 2.3362436362256056, 8.661055306049235, 4.596695477797019, 6.150059458252891, 6.968213292992977, 9.371913272525505, 8.354121920391039, 3.3238062474707175, 4.990618706073042, 6.648592964647557, 7.645809581191458, 6.34684776854285, 5.0240205800744455, 6.359219482569622, 4.553164289028838, 12.514428534474467, 7.125985921327465, 6.746863728185306, 6.182974918225453, 10.565694854952396, 5.762065568369346, 8.615755984584514, 9.290814781262355, 7.30499585408052, 7.2885665180052275, 10.781020633097533, 7.216221051880661, 6.273685805720569, 8.398208092264994, 3.753118331070647, 5.948150349649147, 9.166037586756719, 3.9474221313260007, 5.542551814170725, 5.645509222545668, 6.664240325493721, 8.093156370205175, 7.9306316645225206, 4.855480417892128, 6.196492152311427, 6.809166660824364, 5.323414670521446, 3.571660951915303, 9.096697784483835, 7.194097667974603, 9.423359107725709, 7.399277412614379, 7.736022344430795, 5.373308061930758], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.558193166584895, "mean_inference_ms": 6.705518484122208, "mean_action_processing_ms": 0.536883622436185, "mean_env_wait_ms": 24.42633297478395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027599573135375977, "StateBufferConnector_ms": 0.03311610221862793, "ViewRequirementAgentConnector_ms": 0.5912299156188965}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2321578, "num_agent_steps_trained": 2321578, "num_env_steps_sampled": 2321578, "num_env_steps_trained": 2321578, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 301.63937802762524, "num_env_steps_trained_throughput_per_sec": 301.63937802762524, "timesteps_total": 2321578, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2321578, "timers": {"training_iteration_time_ms": 51481.869, "sample_time_ms": 39405.225, "load_time_ms": 588.904, "load_throughput": 26554.426, "learn_time_ms": 11136.083, "learn_throughput": 1404.264, "synch_weights_time_ms": 327.355}, "counters": {"num_env_steps_sampled": 2321578, "num_env_steps_trained": 2321578, "num_agent_steps_sampled": 2321578, "num_agent_steps_trained": 2321578}, "done": false, "episodes_total": 294, "training_iteration": 153, "trial_id": "c5092_00000", "date": "2025-06-08_09-58-54", "timestamp": 1749369534, "time_this_iter_s": 51.859206199645996, "time_total_s": 1082.2656157016754, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1082.2656157016754, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 79.04666666666667, "ram_util_percent": 58.92000000000001, "gpu_util_percent0": 0.08750000000000001, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.678421999999999e-05, "total_loss": -0.1525836882505312, "policy_loss": -0.03226168139160357, "vf_loss": 0.01289913180876862, "vf_explained_var": 0.7637779628146778, "kl": 0.029991785788868186, "entropy": 20.64431093042547, "entropy_coeff": 0.0061307033333333335}, "model": {}, "num_grad_updates_lifetime": 11825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2337216, "num_env_steps_trained": 2337216, "num_agent_steps_sampled": 2337216, "num_agent_steps_trained": 2337216}, "sampler_results": {"episode_reward_max": 12.514428534474467, "episode_reward_min": 2.3148552237730087, "episode_reward_mean": 6.561906007887811, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.187575628447334, 4.964732570110797, 8.722121800605393, 6.599100225672838, 8.469468133887421, 3.918344665563585, 8.227915784733527, 9.880893222423676, 6.956679237843526, 7.141995748294636, 2.392962390807395, 4.826869052039529, 2.7384788335976116, 6.167264957187534, 7.056306645642468, 5.7256443650668665, 7.529869123870094, 5.168305722929078, 9.610015639112724, 3.7315859756438554, 3.6426323098029467, 9.334735339274685, 8.368517670310764, 6.273624230412876, 8.08304354911684, 3.8184487949648633, 4.867119250900541, 6.700758089420711, 5.481955626682667, 6.468759954623138, 6.584214805339346, 6.820867554078354, 4.0615071624751256, 9.073580945919414, 8.254937627751973, 4.74501160307902, 6.299498748667449, 2.3362436362256056, 8.661055306049235, 4.596695477797019, 6.150059458252891, 6.968213292992977, 9.371913272525505, 8.354121920391039, 3.3238062474707175, 4.990618706073042, 6.648592964647557, 7.645809581191458, 6.34684776854285, 5.0240205800744455, 6.359219482569622, 4.553164289028838, 12.514428534474467, 7.125985921327465, 6.746863728185306, 6.182974918225453, 10.565694854952396, 5.762065568369346, 8.615755984584514, 9.290814781262355, 7.30499585408052, 7.2885665180052275, 10.781020633097533, 7.216221051880661, 6.273685805720569, 8.398208092264994, 3.753118331070647, 5.948150349649147, 9.166037586756719, 3.9474221313260007, 5.542551814170725, 5.645509222545668, 6.664240325493721, 8.093156370205175, 7.9306316645225206, 4.855480417892128, 6.196492152311427, 6.809166660824364, 5.323414670521446, 3.571660951915303, 9.096697784483835, 7.194097667974603, 9.423359107725709, 7.399277412614379, 7.736022344430795, 5.373308061930758, 2.4308422889606627, 2.3148552237730087, 5.4374977080663465, 5.0270157007392555, 7.190299226918515, 5.58336654945843, 7.191359472230264, 4.682749087786695, 5.603911767056163, 11.155369857081224, 9.391262426191886, 7.691013888324886, 5.05608837634487, 6.472166970919631], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5596438430315684, "mean_inference_ms": 6.722365229527604, "mean_action_processing_ms": 0.5380461929800076, "mean_env_wait_ms": 24.497321414288507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02765941619873047, "StateBufferConnector_ms": 0.03210878372192383, "ViewRequirementAgentConnector_ms": 0.5892636775970459}}, "episode_reward_max": 12.514428534474467, "episode_reward_min": 2.3148552237730087, "episode_reward_mean": 6.561906007887811, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.187575628447334, 4.964732570110797, 8.722121800605393, 6.599100225672838, 8.469468133887421, 3.918344665563585, 8.227915784733527, 9.880893222423676, 6.956679237843526, 7.141995748294636, 2.392962390807395, 4.826869052039529, 2.7384788335976116, 6.167264957187534, 7.056306645642468, 5.7256443650668665, 7.529869123870094, 5.168305722929078, 9.610015639112724, 3.7315859756438554, 3.6426323098029467, 9.334735339274685, 8.368517670310764, 6.273624230412876, 8.08304354911684, 3.8184487949648633, 4.867119250900541, 6.700758089420711, 5.481955626682667, 6.468759954623138, 6.584214805339346, 6.820867554078354, 4.0615071624751256, 9.073580945919414, 8.254937627751973, 4.74501160307902, 6.299498748667449, 2.3362436362256056, 8.661055306049235, 4.596695477797019, 6.150059458252891, 6.968213292992977, 9.371913272525505, 8.354121920391039, 3.3238062474707175, 4.990618706073042, 6.648592964647557, 7.645809581191458, 6.34684776854285, 5.0240205800744455, 6.359219482569622, 4.553164289028838, 12.514428534474467, 7.125985921327465, 6.746863728185306, 6.182974918225453, 10.565694854952396, 5.762065568369346, 8.615755984584514, 9.290814781262355, 7.30499585408052, 7.2885665180052275, 10.781020633097533, 7.216221051880661, 6.273685805720569, 8.398208092264994, 3.753118331070647, 5.948150349649147, 9.166037586756719, 3.9474221313260007, 5.542551814170725, 5.645509222545668, 6.664240325493721, 8.093156370205175, 7.9306316645225206, 4.855480417892128, 6.196492152311427, 6.809166660824364, 5.323414670521446, 3.571660951915303, 9.096697784483835, 7.194097667974603, 9.423359107725709, 7.399277412614379, 7.736022344430795, 5.373308061930758, 2.4308422889606627, 2.3148552237730087, 5.4374977080663465, 5.0270157007392555, 7.190299226918515, 5.58336654945843, 7.191359472230264, 4.682749087786695, 5.603911767056163, 11.155369857081224, 9.391262426191886, 7.691013888324886, 5.05608837634487, 6.472166970919631], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5596438430315684, "mean_inference_ms": 6.722365229527604, "mean_action_processing_ms": 0.5380461929800076, "mean_env_wait_ms": 24.497321414288507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02765941619873047, "StateBufferConnector_ms": 0.03210878372192383, "ViewRequirementAgentConnector_ms": 0.5892636775970459}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2337216, "num_agent_steps_trained": 2337216, "num_env_steps_sampled": 2337216, "num_env_steps_trained": 2337216, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 304.6299859218789, "num_env_steps_trained_throughput_per_sec": 304.6299859218789, "timesteps_total": 2337216, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2337216, "timers": {"training_iteration_time_ms": 51548.341, "sample_time_ms": 39469.293, "load_time_ms": 597.741, "load_throughput": 26161.814, "learn_time_ms": 11133.95, "learn_throughput": 1404.533, "synch_weights_time_ms": 323.133}, "counters": {"num_env_steps_sampled": 2337216, "num_env_steps_trained": 2337216, "num_agent_steps_sampled": 2337216, "num_agent_steps_trained": 2337216}, "done": false, "episodes_total": 308, "training_iteration": 154, "trial_id": "c5092_00000", "date": "2025-06-08_09-59-46", "timestamp": 1749369586, "time_this_iter_s": 51.34743070602417, "time_total_s": 1133.6130464076996, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1133.6130464076996, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 79.6677966101695, "ram_util_percent": 58.76949152542373, "gpu_util_percent0": 0.08440677966101695, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.662784e-05, "total_loss": -0.1418881481144027, "policy_loss": -0.020828380259101158, "vf_loss": 0.0119278397961435, "vf_explained_var": 0.7259750650145791, "kl": 0.027108975030292845, "entropy": 20.76821531642567, "entropy_coeff": 0.006104640000000001}, "model": {}, "num_grad_updates_lifetime": 12375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2352854, "num_env_steps_trained": 2352854, "num_agent_steps_sampled": 2352854, "num_agent_steps_trained": 2352854}, "sampler_results": {"episode_reward_max": 12.514428534474467, "episode_reward_min": 2.1575241135504237, "episode_reward_mean": 6.546311414053372, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.056306645642468, 5.7256443650668665, 7.529869123870094, 5.168305722929078, 9.610015639112724, 3.7315859756438554, 3.6426323098029467, 9.334735339274685, 8.368517670310764, 6.273624230412876, 8.08304354911684, 3.8184487949648633, 4.867119250900541, 6.700758089420711, 5.481955626682667, 6.468759954623138, 6.584214805339346, 6.820867554078354, 4.0615071624751256, 9.073580945919414, 8.254937627751973, 4.74501160307902, 6.299498748667449, 2.3362436362256056, 8.661055306049235, 4.596695477797019, 6.150059458252891, 6.968213292992977, 9.371913272525505, 8.354121920391039, 3.3238062474707175, 4.990618706073042, 6.648592964647557, 7.645809581191458, 6.34684776854285, 5.0240205800744455, 6.359219482569622, 4.553164289028838, 12.514428534474467, 7.125985921327465, 6.746863728185306, 6.182974918225453, 10.565694854952396, 5.762065568369346, 8.615755984584514, 9.290814781262355, 7.30499585408052, 7.2885665180052275, 10.781020633097533, 7.216221051880661, 6.273685805720569, 8.398208092264994, 3.753118331070647, 5.948150349649147, 9.166037586756719, 3.9474221313260007, 5.542551814170725, 5.645509222545668, 6.664240325493721, 8.093156370205175, 7.9306316645225206, 4.855480417892128, 6.196492152311427, 6.809166660824364, 5.323414670521446, 3.571660951915303, 9.096697784483835, 7.194097667974603, 9.423359107725709, 7.399277412614379, 7.736022344430795, 5.373308061930758, 2.4308422889606627, 2.3148552237730087, 5.4374977080663465, 5.0270157007392555, 7.190299226918515, 5.58336654945843, 7.191359472230264, 4.682749087786695, 5.603911767056163, 11.155369857081224, 9.391262426191886, 7.691013888324886, 5.05608837634487, 6.472166970919631, 8.864620076436546, 6.658311759554543, 5.28325283463101, 4.867052172554469, 8.282684400759521, 6.616716016505685, 8.085208843312934, 2.1575241135504237, 4.6035408709565795, 5.767987897461064, 7.213705310259421, 3.946245046880882, 7.299930134334143, 6.988163390573581], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5608539871613976, "mean_inference_ms": 6.737034392322525, "mean_action_processing_ms": 0.5390824086027854, "mean_env_wait_ms": 24.562046312857206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026650428771972656, "StateBufferConnector_ms": 0.03117203712463379, "ViewRequirementAgentConnector_ms": 0.5962183475494385}}, "episode_reward_max": 12.514428534474467, "episode_reward_min": 2.1575241135504237, "episode_reward_mean": 6.546311414053372, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.056306645642468, 5.7256443650668665, 7.529869123870094, 5.168305722929078, 9.610015639112724, 3.7315859756438554, 3.6426323098029467, 9.334735339274685, 8.368517670310764, 6.273624230412876, 8.08304354911684, 3.8184487949648633, 4.867119250900541, 6.700758089420711, 5.481955626682667, 6.468759954623138, 6.584214805339346, 6.820867554078354, 4.0615071624751256, 9.073580945919414, 8.254937627751973, 4.74501160307902, 6.299498748667449, 2.3362436362256056, 8.661055306049235, 4.596695477797019, 6.150059458252891, 6.968213292992977, 9.371913272525505, 8.354121920391039, 3.3238062474707175, 4.990618706073042, 6.648592964647557, 7.645809581191458, 6.34684776854285, 5.0240205800744455, 6.359219482569622, 4.553164289028838, 12.514428534474467, 7.125985921327465, 6.746863728185306, 6.182974918225453, 10.565694854952396, 5.762065568369346, 8.615755984584514, 9.290814781262355, 7.30499585408052, 7.2885665180052275, 10.781020633097533, 7.216221051880661, 6.273685805720569, 8.398208092264994, 3.753118331070647, 5.948150349649147, 9.166037586756719, 3.9474221313260007, 5.542551814170725, 5.645509222545668, 6.664240325493721, 8.093156370205175, 7.9306316645225206, 4.855480417892128, 6.196492152311427, 6.809166660824364, 5.323414670521446, 3.571660951915303, 9.096697784483835, 7.194097667974603, 9.423359107725709, 7.399277412614379, 7.736022344430795, 5.373308061930758, 2.4308422889606627, 2.3148552237730087, 5.4374977080663465, 5.0270157007392555, 7.190299226918515, 5.58336654945843, 7.191359472230264, 4.682749087786695, 5.603911767056163, 11.155369857081224, 9.391262426191886, 7.691013888324886, 5.05608837634487, 6.472166970919631, 8.864620076436546, 6.658311759554543, 5.28325283463101, 4.867052172554469, 8.282684400759521, 6.616716016505685, 8.085208843312934, 2.1575241135504237, 4.6035408709565795, 5.767987897461064, 7.213705310259421, 3.946245046880882, 7.299930134334143, 6.988163390573581], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5608539871613976, "mean_inference_ms": 6.737034392322525, "mean_action_processing_ms": 0.5390824086027854, "mean_env_wait_ms": 24.562046312857206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026650428771972656, "StateBufferConnector_ms": 0.03117203712463379, "ViewRequirementAgentConnector_ms": 0.5962183475494385}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352854, "num_agent_steps_trained": 2352854, "num_env_steps_sampled": 2352854, "num_env_steps_trained": 2352854, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 302.95627970861113, "num_env_steps_trained_throughput_per_sec": 302.95627970861113, "timesteps_total": 2352854, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2352854, "timers": {"training_iteration_time_ms": 51597.556, "sample_time_ms": 39512.698, "load_time_ms": 607.294, "load_throughput": 25750.282, "learn_time_ms": 11127.473, "learn_throughput": 1405.351, "synch_weights_time_ms": 326.002}, "counters": {"num_env_steps_sampled": 2352854, "num_env_steps_trained": 2352854, "num_agent_steps_sampled": 2352854, "num_agent_steps_trained": 2352854}, "done": false, "episodes_total": 322, "training_iteration": 155, "trial_id": "c5092_00000", "date": "2025-06-08_10-00-37", "timestamp": 1749369637, "time_this_iter_s": 51.63001227378845, "time_total_s": 1185.243058681488, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1185.243058681488, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 78.58999999999999, "ram_util_percent": 58.184999999999995, "gpu_util_percent0": 0.08766666666666666, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.647145999999998e-05, "total_loss": -0.14643909529740498, "policy_loss": -0.02627058057529873, "vf_loss": 0.012853997248140249, "vf_explained_var": 0.7505538618564606, "kl": 0.02865790561902641, "entropy": 20.776508580988104, "entropy_coeff": 0.006078576666666668}, "model": {}, "num_grad_updates_lifetime": 12925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2368492, "num_env_steps_trained": 2368492, "num_agent_steps_sampled": 2368492, "num_agent_steps_trained": 2368492}, "sampler_results": {"episode_reward_max": 12.514428534474467, "episode_reward_min": 2.1575241135504237, "episode_reward_mean": 6.641130780013826, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.481955626682667, 6.468759954623138, 6.584214805339346, 6.820867554078354, 4.0615071624751256, 9.073580945919414, 8.254937627751973, 4.74501160307902, 6.299498748667449, 2.3362436362256056, 8.661055306049235, 4.596695477797019, 6.150059458252891, 6.968213292992977, 9.371913272525505, 8.354121920391039, 3.3238062474707175, 4.990618706073042, 6.648592964647557, 7.645809581191458, 6.34684776854285, 5.0240205800744455, 6.359219482569622, 4.553164289028838, 12.514428534474467, 7.125985921327465, 6.746863728185306, 6.182974918225453, 10.565694854952396, 5.762065568369346, 8.615755984584514, 9.290814781262355, 7.30499585408052, 7.2885665180052275, 10.781020633097533, 7.216221051880661, 6.273685805720569, 8.398208092264994, 3.753118331070647, 5.948150349649147, 9.166037586756719, 3.9474221313260007, 5.542551814170725, 5.645509222545668, 6.664240325493721, 8.093156370205175, 7.9306316645225206, 4.855480417892128, 6.196492152311427, 6.809166660824364, 5.323414670521446, 3.571660951915303, 9.096697784483835, 7.194097667974603, 9.423359107725709, 7.399277412614379, 7.736022344430795, 5.373308061930758, 2.4308422889606627, 2.3148552237730087, 5.4374977080663465, 5.0270157007392555, 7.190299226918515, 5.58336654945843, 7.191359472230264, 4.682749087786695, 5.603911767056163, 11.155369857081224, 9.391262426191886, 7.691013888324886, 5.05608837634487, 6.472166970919631, 8.864620076436546, 6.658311759554543, 5.28325283463101, 4.867052172554469, 8.282684400759521, 6.616716016505685, 8.085208843312934, 2.1575241135504237, 4.6035408709565795, 5.767987897461064, 7.213705310259421, 3.946245046880882, 7.299930134334143, 6.988163390573581, 11.088648714795895, 8.609324575201386, 7.240470588414145, 5.426235369168431, 5.368920766731051, 6.34216237487282, 4.801999030974071, 9.046014998188223, 7.883711911723158, 8.065019270918098, 4.164336432907018, 4.602283088958547, 8.158076040449876, 8.595340139212057], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5621948097450027, "mean_inference_ms": 6.750594484907968, "mean_action_processing_ms": 0.5401291495492289, "mean_env_wait_ms": 24.61974046804718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026625871658325195, "StateBufferConnector_ms": 0.031138181686401367, "ViewRequirementAgentConnector_ms": 0.5633842945098877}}, "episode_reward_max": 12.514428534474467, "episode_reward_min": 2.1575241135504237, "episode_reward_mean": 6.641130780013826, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.481955626682667, 6.468759954623138, 6.584214805339346, 6.820867554078354, 4.0615071624751256, 9.073580945919414, 8.254937627751973, 4.74501160307902, 6.299498748667449, 2.3362436362256056, 8.661055306049235, 4.596695477797019, 6.150059458252891, 6.968213292992977, 9.371913272525505, 8.354121920391039, 3.3238062474707175, 4.990618706073042, 6.648592964647557, 7.645809581191458, 6.34684776854285, 5.0240205800744455, 6.359219482569622, 4.553164289028838, 12.514428534474467, 7.125985921327465, 6.746863728185306, 6.182974918225453, 10.565694854952396, 5.762065568369346, 8.615755984584514, 9.290814781262355, 7.30499585408052, 7.2885665180052275, 10.781020633097533, 7.216221051880661, 6.273685805720569, 8.398208092264994, 3.753118331070647, 5.948150349649147, 9.166037586756719, 3.9474221313260007, 5.542551814170725, 5.645509222545668, 6.664240325493721, 8.093156370205175, 7.9306316645225206, 4.855480417892128, 6.196492152311427, 6.809166660824364, 5.323414670521446, 3.571660951915303, 9.096697784483835, 7.194097667974603, 9.423359107725709, 7.399277412614379, 7.736022344430795, 5.373308061930758, 2.4308422889606627, 2.3148552237730087, 5.4374977080663465, 5.0270157007392555, 7.190299226918515, 5.58336654945843, 7.191359472230264, 4.682749087786695, 5.603911767056163, 11.155369857081224, 9.391262426191886, 7.691013888324886, 5.05608837634487, 6.472166970919631, 8.864620076436546, 6.658311759554543, 5.28325283463101, 4.867052172554469, 8.282684400759521, 6.616716016505685, 8.085208843312934, 2.1575241135504237, 4.6035408709565795, 5.767987897461064, 7.213705310259421, 3.946245046880882, 7.299930134334143, 6.988163390573581, 11.088648714795895, 8.609324575201386, 7.240470588414145, 5.426235369168431, 5.368920766731051, 6.34216237487282, 4.801999030974071, 9.046014998188223, 7.883711911723158, 8.065019270918098, 4.164336432907018, 4.602283088958547, 8.158076040449876, 8.595340139212057], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5621948097450027, "mean_inference_ms": 6.750594484907968, "mean_action_processing_ms": 0.5401291495492289, "mean_env_wait_ms": 24.61974046804718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026625871658325195, "StateBufferConnector_ms": 0.031138181686401367, "ViewRequirementAgentConnector_ms": 0.5633842945098877}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2368492, "num_agent_steps_trained": 2368492, "num_env_steps_sampled": 2368492, "num_env_steps_trained": 2368492, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 304.7961874675486, "num_env_steps_trained_throughput_per_sec": 304.7961874675486, "timesteps_total": 2368492, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2368492, "timers": {"training_iteration_time_ms": 51616.785, "sample_time_ms": 39541.7, "load_time_ms": 617.134, "load_throughput": 25339.708, "learn_time_ms": 11110.348, "learn_throughput": 1407.517, "synch_weights_time_ms": 323.43}, "counters": {"num_env_steps_sampled": 2368492, "num_env_steps_trained": 2368492, "num_agent_steps_sampled": 2368492, "num_agent_steps_trained": 2368492}, "done": false, "episodes_total": 336, "training_iteration": 156, "trial_id": "c5092_00000", "date": "2025-06-08_10-01-29", "timestamp": 1749369689, "time_this_iter_s": 51.31741428375244, "time_total_s": 1236.5604729652405, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1236.5604729652405, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 79.99322033898304, "ram_util_percent": 58.250847457627124, "gpu_util_percent0": 0.07966101694915255, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.631508e-05, "total_loss": -0.1443470951359698, "policy_loss": -0.024286028822852215, "vf_loss": 0.012346909380179237, "vf_explained_var": 0.782545546726747, "kl": 0.027195384450156283, "entropy": 20.803975788463244, "entropy_coeff": 0.006052513333333335}, "model": {}, "num_grad_updates_lifetime": 13475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2384130, "num_env_steps_trained": 2384130, "num_agent_steps_sampled": 2384130, "num_agent_steps_trained": 2384130}, "sampler_results": {"episode_reward_max": 12.514428534474467, "episode_reward_min": 2.1575241135504237, "episode_reward_mean": 6.690654084650126, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.371913272525505, 8.354121920391039, 3.3238062474707175, 4.990618706073042, 6.648592964647557, 7.645809581191458, 6.34684776854285, 5.0240205800744455, 6.359219482569622, 4.553164289028838, 12.514428534474467, 7.125985921327465, 6.746863728185306, 6.182974918225453, 10.565694854952396, 5.762065568369346, 8.615755984584514, 9.290814781262355, 7.30499585408052, 7.2885665180052275, 10.781020633097533, 7.216221051880661, 6.273685805720569, 8.398208092264994, 3.753118331070647, 5.948150349649147, 9.166037586756719, 3.9474221313260007, 5.542551814170725, 5.645509222545668, 6.664240325493721, 8.093156370205175, 7.9306316645225206, 4.855480417892128, 6.196492152311427, 6.809166660824364, 5.323414670521446, 3.571660951915303, 9.096697784483835, 7.194097667974603, 9.423359107725709, 7.399277412614379, 7.736022344430795, 5.373308061930758, 2.4308422889606627, 2.3148552237730087, 5.4374977080663465, 5.0270157007392555, 7.190299226918515, 5.58336654945843, 7.191359472230264, 4.682749087786695, 5.603911767056163, 11.155369857081224, 9.391262426191886, 7.691013888324886, 5.05608837634487, 6.472166970919631, 8.864620076436546, 6.658311759554543, 5.28325283463101, 4.867052172554469, 8.282684400759521, 6.616716016505685, 8.085208843312934, 2.1575241135504237, 4.6035408709565795, 5.767987897461064, 7.213705310259421, 3.946245046880882, 7.299930134334143, 6.988163390573581, 11.088648714795895, 8.609324575201386, 7.240470588414145, 5.426235369168431, 5.368920766731051, 6.34216237487282, 4.801999030974071, 9.046014998188223, 7.883711911723158, 8.065019270918098, 4.164336432907018, 4.602283088958547, 8.158076040449876, 8.595340139212057, 6.117433073194994, 5.26467625849594, 6.471206501645298, 9.734433259889723, 9.839466841640872, 6.2163990475182835, 6.9739602950542485, 4.167063183582143, 6.452905100369877, 6.021556215527743, 2.7746322055200277, 7.337691691359622, 8.403456705855097, 5.680051283910458], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5623998494555686, "mean_inference_ms": 6.762954868310769, "mean_action_processing_ms": 0.5410183694086801, "mean_env_wait_ms": 24.671521098958777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022582054138183594, "StateBufferConnector_ms": 0.029150962829589844, "ViewRequirementAgentConnector_ms": 0.5364348888397217}}, "episode_reward_max": 12.514428534474467, "episode_reward_min": 2.1575241135504237, "episode_reward_mean": 6.690654084650126, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.371913272525505, 8.354121920391039, 3.3238062474707175, 4.990618706073042, 6.648592964647557, 7.645809581191458, 6.34684776854285, 5.0240205800744455, 6.359219482569622, 4.553164289028838, 12.514428534474467, 7.125985921327465, 6.746863728185306, 6.182974918225453, 10.565694854952396, 5.762065568369346, 8.615755984584514, 9.290814781262355, 7.30499585408052, 7.2885665180052275, 10.781020633097533, 7.216221051880661, 6.273685805720569, 8.398208092264994, 3.753118331070647, 5.948150349649147, 9.166037586756719, 3.9474221313260007, 5.542551814170725, 5.645509222545668, 6.664240325493721, 8.093156370205175, 7.9306316645225206, 4.855480417892128, 6.196492152311427, 6.809166660824364, 5.323414670521446, 3.571660951915303, 9.096697784483835, 7.194097667974603, 9.423359107725709, 7.399277412614379, 7.736022344430795, 5.373308061930758, 2.4308422889606627, 2.3148552237730087, 5.4374977080663465, 5.0270157007392555, 7.190299226918515, 5.58336654945843, 7.191359472230264, 4.682749087786695, 5.603911767056163, 11.155369857081224, 9.391262426191886, 7.691013888324886, 5.05608837634487, 6.472166970919631, 8.864620076436546, 6.658311759554543, 5.28325283463101, 4.867052172554469, 8.282684400759521, 6.616716016505685, 8.085208843312934, 2.1575241135504237, 4.6035408709565795, 5.767987897461064, 7.213705310259421, 3.946245046880882, 7.299930134334143, 6.988163390573581, 11.088648714795895, 8.609324575201386, 7.240470588414145, 5.426235369168431, 5.368920766731051, 6.34216237487282, 4.801999030974071, 9.046014998188223, 7.883711911723158, 8.065019270918098, 4.164336432907018, 4.602283088958547, 8.158076040449876, 8.595340139212057, 6.117433073194994, 5.26467625849594, 6.471206501645298, 9.734433259889723, 9.839466841640872, 6.2163990475182835, 6.9739602950542485, 4.167063183582143, 6.452905100369877, 6.021556215527743, 2.7746322055200277, 7.337691691359622, 8.403456705855097, 5.680051283910458], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5623998494555686, "mean_inference_ms": 6.762954868310769, "mean_action_processing_ms": 0.5410183694086801, "mean_env_wait_ms": 24.671521098958777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022582054138183594, "StateBufferConnector_ms": 0.029150962829589844, "ViewRequirementAgentConnector_ms": 0.5364348888397217}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2384130, "num_agent_steps_trained": 2384130, "num_env_steps_sampled": 2384130, "num_env_steps_trained": 2384130, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 303.1664964429019, "num_env_steps_trained_throughput_per_sec": 303.1664964429019, "timesteps_total": 2384130, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2384130, "timers": {"training_iteration_time_ms": 51669.909, "sample_time_ms": 39593.92, "load_time_ms": 605.381, "load_throughput": 25831.66, "learn_time_ms": 11123.516, "learn_throughput": 1405.85, "synch_weights_time_ms": 322.852}, "counters": {"num_env_steps_sampled": 2384130, "num_env_steps_trained": 2384130, "num_agent_steps_sampled": 2384130, "num_agent_steps_trained": 2384130}, "done": false, "episodes_total": 350, "training_iteration": 157, "trial_id": "c5092_00000", "date": "2025-06-08_10-02-20", "timestamp": 1749369740, "time_this_iter_s": 51.598198890686035, "time_total_s": 1288.1586718559265, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1288.1586718559265, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 78.36833333333334, "ram_util_percent": 58.29333333333332, "gpu_util_percent0": 0.09000000000000001, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.615869999999999e-05, "total_loss": -0.15364475228739055, "policy_loss": -0.03431273024418095, "vf_loss": 0.012881892284124412, "vf_explained_var": 0.7619155476310037, "kl": 0.0282571878632139, "entropy": 20.813542912223124, "entropy_coeff": 0.006026450000000001}, "model": {}, "num_grad_updates_lifetime": 14025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2399768, "num_env_steps_trained": 2399768, "num_agent_steps_sampled": 2399768, "num_agent_steps_trained": 2399768}, "sampler_results": {"episode_reward_max": 11.155369857081224, "episode_reward_min": 2.1575241135504237, "episode_reward_mean": 6.570757247094641, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.565694854952396, 5.762065568369346, 8.615755984584514, 9.290814781262355, 7.30499585408052, 7.2885665180052275, 10.781020633097533, 7.216221051880661, 6.273685805720569, 8.398208092264994, 3.753118331070647, 5.948150349649147, 9.166037586756719, 3.9474221313260007, 5.542551814170725, 5.645509222545668, 6.664240325493721, 8.093156370205175, 7.9306316645225206, 4.855480417892128, 6.196492152311427, 6.809166660824364, 5.323414670521446, 3.571660951915303, 9.096697784483835, 7.194097667974603, 9.423359107725709, 7.399277412614379, 7.736022344430795, 5.373308061930758, 2.4308422889606627, 2.3148552237730087, 5.4374977080663465, 5.0270157007392555, 7.190299226918515, 5.58336654945843, 7.191359472230264, 4.682749087786695, 5.603911767056163, 11.155369857081224, 9.391262426191886, 7.691013888324886, 5.05608837634487, 6.472166970919631, 8.864620076436546, 6.658311759554543, 5.28325283463101, 4.867052172554469, 8.282684400759521, 6.616716016505685, 8.085208843312934, 2.1575241135504237, 4.6035408709565795, 5.767987897461064, 7.213705310259421, 3.946245046880882, 7.299930134334143, 6.988163390573581, 11.088648714795895, 8.609324575201386, 7.240470588414145, 5.426235369168431, 5.368920766731051, 6.34216237487282, 4.801999030974071, 9.046014998188223, 7.883711911723158, 8.065019270918098, 4.164336432907018, 4.602283088958547, 8.158076040449876, 8.595340139212057, 6.117433073194994, 5.26467625849594, 6.471206501645298, 9.734433259889723, 9.839466841640872, 6.2163990475182835, 6.9739602950542485, 4.167063183582143, 6.452905100369877, 6.021556215527743, 2.7746322055200277, 7.337691691359622, 8.403456705855097, 5.680051283910458, 5.971220085783865, 9.10261388438943, 5.42923826080373, 6.5759480231540515, 3.061717508155422, 5.552639701013438, 3.2014763517484557, 8.8668331888418, 7.621559714609886, 5.211455865510791, 2.7174198442722, 3.954860946033104, 6.822912770880986, 9.10878801398197], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.56217904949841, "mean_inference_ms": 6.7737644225791485, "mean_action_processing_ms": 0.5418223189138738, "mean_env_wait_ms": 24.721587903757708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02213430404663086, "StateBufferConnector_ms": 0.029138803482055664, "ViewRequirementAgentConnector_ms": 0.5436384677886963}}, "episode_reward_max": 11.155369857081224, "episode_reward_min": 2.1575241135504237, "episode_reward_mean": 6.570757247094641, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.565694854952396, 5.762065568369346, 8.615755984584514, 9.290814781262355, 7.30499585408052, 7.2885665180052275, 10.781020633097533, 7.216221051880661, 6.273685805720569, 8.398208092264994, 3.753118331070647, 5.948150349649147, 9.166037586756719, 3.9474221313260007, 5.542551814170725, 5.645509222545668, 6.664240325493721, 8.093156370205175, 7.9306316645225206, 4.855480417892128, 6.196492152311427, 6.809166660824364, 5.323414670521446, 3.571660951915303, 9.096697784483835, 7.194097667974603, 9.423359107725709, 7.399277412614379, 7.736022344430795, 5.373308061930758, 2.4308422889606627, 2.3148552237730087, 5.4374977080663465, 5.0270157007392555, 7.190299226918515, 5.58336654945843, 7.191359472230264, 4.682749087786695, 5.603911767056163, 11.155369857081224, 9.391262426191886, 7.691013888324886, 5.05608837634487, 6.472166970919631, 8.864620076436546, 6.658311759554543, 5.28325283463101, 4.867052172554469, 8.282684400759521, 6.616716016505685, 8.085208843312934, 2.1575241135504237, 4.6035408709565795, 5.767987897461064, 7.213705310259421, 3.946245046880882, 7.299930134334143, 6.988163390573581, 11.088648714795895, 8.609324575201386, 7.240470588414145, 5.426235369168431, 5.368920766731051, 6.34216237487282, 4.801999030974071, 9.046014998188223, 7.883711911723158, 8.065019270918098, 4.164336432907018, 4.602283088958547, 8.158076040449876, 8.595340139212057, 6.117433073194994, 5.26467625849594, 6.471206501645298, 9.734433259889723, 9.839466841640872, 6.2163990475182835, 6.9739602950542485, 4.167063183582143, 6.452905100369877, 6.021556215527743, 2.7746322055200277, 7.337691691359622, 8.403456705855097, 5.680051283910458, 5.971220085783865, 9.10261388438943, 5.42923826080373, 6.5759480231540515, 3.061717508155422, 5.552639701013438, 3.2014763517484557, 8.8668331888418, 7.621559714609886, 5.211455865510791, 2.7174198442722, 3.954860946033104, 6.822912770880986, 9.10878801398197], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.56217904949841, "mean_inference_ms": 6.7737644225791485, "mean_action_processing_ms": 0.5418223189138738, "mean_env_wait_ms": 24.721587903757708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02213430404663086, "StateBufferConnector_ms": 0.029138803482055664, "ViewRequirementAgentConnector_ms": 0.5436384677886963}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2399768, "num_agent_steps_trained": 2399768, "num_env_steps_sampled": 2399768, "num_env_steps_trained": 2399768, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 299.40232194658387, "num_env_steps_trained_throughput_per_sec": 299.40232194658387, "timesteps_total": 2399768, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2399768, "timers": {"training_iteration_time_ms": 51717.153, "sample_time_ms": 39622.684, "load_time_ms": 603.144, "load_throughput": 25927.453, "learn_time_ms": 11139.032, "learn_throughput": 1403.892, "synch_weights_time_ms": 327.265}, "counters": {"num_env_steps_sampled": 2399768, "num_env_steps_trained": 2399768, "num_agent_steps_sampled": 2399768, "num_agent_steps_trained": 2399768}, "done": false, "episodes_total": 364, "training_iteration": 158, "trial_id": "c5092_00000", "date": "2025-06-08_10-03-13", "timestamp": 1749369793, "time_this_iter_s": 52.24571132659912, "time_total_s": 1340.4043831825256, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1340.4043831825256, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 79.16166666666666, "ram_util_percent": 58.49666666666667, "gpu_util_percent0": 0.08600000000000001, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.600231999999999e-05, "total_loss": -0.14612137841886247, "policy_loss": -0.0272291436125736, "vf_loss": 0.013292131826535545, "vf_explained_var": 0.778326915285804, "kl": 0.027853262504267975, "entropy": 20.845841823924673, "entropy_coeff": 0.006000386666666668}, "model": {}, "num_grad_updates_lifetime": 14575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2415406, "num_env_steps_trained": 2415406, "num_agent_steps_sampled": 2415406, "num_agent_steps_trained": 2415406}, "sampler_results": {"episode_reward_max": 11.155369857081224, "episode_reward_min": 1.8548172025717844, "episode_reward_mean": 6.3863621515984255, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.542551814170725, 5.645509222545668, 6.664240325493721, 8.093156370205175, 7.9306316645225206, 4.855480417892128, 6.196492152311427, 6.809166660824364, 5.323414670521446, 3.571660951915303, 9.096697784483835, 7.194097667974603, 9.423359107725709, 7.399277412614379, 7.736022344430795, 5.373308061930758, 2.4308422889606627, 2.3148552237730087, 5.4374977080663465, 5.0270157007392555, 7.190299226918515, 5.58336654945843, 7.191359472230264, 4.682749087786695, 5.603911767056163, 11.155369857081224, 9.391262426191886, 7.691013888324886, 5.05608837634487, 6.472166970919631, 8.864620076436546, 6.658311759554543, 5.28325283463101, 4.867052172554469, 8.282684400759521, 6.616716016505685, 8.085208843312934, 2.1575241135504237, 4.6035408709565795, 5.767987897461064, 7.213705310259421, 3.946245046880882, 7.299930134334143, 6.988163390573581, 11.088648714795895, 8.609324575201386, 7.240470588414145, 5.426235369168431, 5.368920766731051, 6.34216237487282, 4.801999030974071, 9.046014998188223, 7.883711911723158, 8.065019270918098, 4.164336432907018, 4.602283088958547, 8.158076040449876, 8.595340139212057, 6.117433073194994, 5.26467625849594, 6.471206501645298, 9.734433259889723, 9.839466841640872, 6.2163990475182835, 6.9739602950542485, 4.167063183582143, 6.452905100369877, 6.021556215527743, 2.7746322055200277, 7.337691691359622, 8.403456705855097, 5.680051283910458, 5.971220085783865, 9.10261388438943, 5.42923826080373, 6.5759480231540515, 3.061717508155422, 5.552639701013438, 3.2014763517484557, 8.8668331888418, 7.621559714609886, 5.211455865510791, 2.7174198442722, 3.954860946033104, 6.822912770880986, 9.10878801398197, 2.008211482038207, 3.7102900922975888, 6.749202630501433, 7.645347938074518, 7.449154763796649, 8.313825341562552, 8.097823147642284, 7.87469296583052, 1.8548172025717844, 7.434272667641074, 7.164625834745673, 4.97631750302663, 5.39051596337943, 7.203150460290779], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5616818614678767, "mean_inference_ms": 6.78308536296985, "mean_action_processing_ms": 0.5424691798581652, "mean_env_wait_ms": 24.765577524367288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0226438045501709, "StateBufferConnector_ms": 0.03316307067871094, "ViewRequirementAgentConnector_ms": 0.5680835247039795}}, "episode_reward_max": 11.155369857081224, "episode_reward_min": 1.8548172025717844, "episode_reward_mean": 6.3863621515984255, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.542551814170725, 5.645509222545668, 6.664240325493721, 8.093156370205175, 7.9306316645225206, 4.855480417892128, 6.196492152311427, 6.809166660824364, 5.323414670521446, 3.571660951915303, 9.096697784483835, 7.194097667974603, 9.423359107725709, 7.399277412614379, 7.736022344430795, 5.373308061930758, 2.4308422889606627, 2.3148552237730087, 5.4374977080663465, 5.0270157007392555, 7.190299226918515, 5.58336654945843, 7.191359472230264, 4.682749087786695, 5.603911767056163, 11.155369857081224, 9.391262426191886, 7.691013888324886, 5.05608837634487, 6.472166970919631, 8.864620076436546, 6.658311759554543, 5.28325283463101, 4.867052172554469, 8.282684400759521, 6.616716016505685, 8.085208843312934, 2.1575241135504237, 4.6035408709565795, 5.767987897461064, 7.213705310259421, 3.946245046880882, 7.299930134334143, 6.988163390573581, 11.088648714795895, 8.609324575201386, 7.240470588414145, 5.426235369168431, 5.368920766731051, 6.34216237487282, 4.801999030974071, 9.046014998188223, 7.883711911723158, 8.065019270918098, 4.164336432907018, 4.602283088958547, 8.158076040449876, 8.595340139212057, 6.117433073194994, 5.26467625849594, 6.471206501645298, 9.734433259889723, 9.839466841640872, 6.2163990475182835, 6.9739602950542485, 4.167063183582143, 6.452905100369877, 6.021556215527743, 2.7746322055200277, 7.337691691359622, 8.403456705855097, 5.680051283910458, 5.971220085783865, 9.10261388438943, 5.42923826080373, 6.5759480231540515, 3.061717508155422, 5.552639701013438, 3.2014763517484557, 8.8668331888418, 7.621559714609886, 5.211455865510791, 2.7174198442722, 3.954860946033104, 6.822912770880986, 9.10878801398197, 2.008211482038207, 3.7102900922975888, 6.749202630501433, 7.645347938074518, 7.449154763796649, 8.313825341562552, 8.097823147642284, 7.87469296583052, 1.8548172025717844, 7.434272667641074, 7.164625834745673, 4.97631750302663, 5.39051596337943, 7.203150460290779], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5616818614678767, "mean_inference_ms": 6.78308536296985, "mean_action_processing_ms": 0.5424691798581652, "mean_env_wait_ms": 24.765577524367288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0226438045501709, "StateBufferConnector_ms": 0.03316307067871094, "ViewRequirementAgentConnector_ms": 0.5680835247039795}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2415406, "num_agent_steps_trained": 2415406, "num_env_steps_sampled": 2415406, "num_env_steps_trained": 2415406, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 301.93886214725126, "num_env_steps_trained_throughput_per_sec": 301.93886214725126, "timesteps_total": 2415406, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2415406, "timers": {"training_iteration_time_ms": 51758.209, "sample_time_ms": 39644.138, "load_time_ms": 601.855, "load_throughput": 25982.997, "learn_time_ms": 11160.175, "learn_throughput": 1401.233, "synch_weights_time_ms": 327.017}, "counters": {"num_env_steps_sampled": 2415406, "num_env_steps_trained": 2415406, "num_agent_steps_sampled": 2415406, "num_agent_steps_trained": 2415406}, "done": false, "episodes_total": 378, "training_iteration": 159, "trial_id": "c5092_00000", "date": "2025-06-08_10-04-04", "timestamp": 1749369844, "time_this_iter_s": 51.82795000076294, "time_total_s": 1392.2323331832886, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1392.2323331832886, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 78.63666666666667, "ram_util_percent": 58.535, "gpu_util_percent0": 0.08566666666666668, "vram_util_percent0": 0.18831380208333337}}
{"evaluation": {"sampler_results": {"episode_reward_max": -1.540805350504593, "episode_reward_min": -5.577264431978127, "episode_reward_mean": -3.8009132549866167, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.686323845057492, -4.005328707912863, -3.1948439394800077, -1.540805350504593, -5.577264431978127], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.170276210372138, "mean_inference_ms": 3.422332398685408, "mean_action_processing_ms": 0.2803129827794426, "mean_env_wait_ms": 10.587234729082583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01964092254638672, "StateBufferConnector_ms": 0.0202178955078125, "ViewRequirementAgentConnector_ms": 0.48108577728271484}}, "episode_reward_max": -1.540805350504593, "episode_reward_min": -5.577264431978127, "episode_reward_mean": -3.8009132549866167, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.686323845057492, -4.005328707912863, -3.1948439394800077, -1.540805350504593, -5.577264431978127], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.170276210372138, "mean_inference_ms": 3.422332398685408, "mean_action_processing_ms": 0.2803129827794426, "mean_env_wait_ms": 10.587234729082583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01964092254638672, "StateBufferConnector_ms": 0.0202178955078125, "ViewRequirementAgentConnector_ms": 0.48108577728271484}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.584594e-05, "total_loss": -0.14374617903620343, "policy_loss": -0.024913419695698064, "vf_loss": 0.013165998916057024, "vf_explained_var": 0.752461279630661, "kl": 0.027649850667857905, "entropy": 20.91780044035478, "entropy_coeff": 0.005974323333333333}, "model": {}, "num_grad_updates_lifetime": 15125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2431044, "num_env_steps_trained": 2431044, "num_agent_steps_sampled": 2431044, "num_agent_steps_trained": 2431044}, "sampler_results": {"episode_reward_max": 11.155369857081224, "episode_reward_min": 0.8569905718260122, "episode_reward_mean": 6.25316168660704, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.736022344430795, 5.373308061930758, 2.4308422889606627, 2.3148552237730087, 5.4374977080663465, 5.0270157007392555, 7.190299226918515, 5.58336654945843, 7.191359472230264, 4.682749087786695, 5.603911767056163, 11.155369857081224, 9.391262426191886, 7.691013888324886, 5.05608837634487, 6.472166970919631, 8.864620076436546, 6.658311759554543, 5.28325283463101, 4.867052172554469, 8.282684400759521, 6.616716016505685, 8.085208843312934, 2.1575241135504237, 4.6035408709565795, 5.767987897461064, 7.213705310259421, 3.946245046880882, 7.299930134334143, 6.988163390573581, 11.088648714795895, 8.609324575201386, 7.240470588414145, 5.426235369168431, 5.368920766731051, 6.34216237487282, 4.801999030974071, 9.046014998188223, 7.883711911723158, 8.065019270918098, 4.164336432907018, 4.602283088958547, 8.158076040449876, 8.595340139212057, 6.117433073194994, 5.26467625849594, 6.471206501645298, 9.734433259889723, 9.839466841640872, 6.2163990475182835, 6.9739602950542485, 4.167063183582143, 6.452905100369877, 6.021556215527743, 2.7746322055200277, 7.337691691359622, 8.403456705855097, 5.680051283910458, 5.971220085783865, 9.10261388438943, 5.42923826080373, 6.5759480231540515, 3.061717508155422, 5.552639701013438, 3.2014763517484557, 8.8668331888418, 7.621559714609886, 5.211455865510791, 2.7174198442722, 3.954860946033104, 6.822912770880986, 9.10878801398197, 2.008211482038207, 3.7102900922975888, 6.749202630501433, 7.645347938074518, 7.449154763796649, 8.313825341562552, 8.097823147642284, 7.87469296583052, 1.8548172025717844, 7.434272667641074, 7.164625834745673, 4.97631750302663, 5.39051596337943, 7.203150460290779, 5.8543783312468625, 7.2211086723669595, 6.580652847806604, 4.529789708508345, 0.8569905718260122, 8.433557770671243, 7.031427353736648, 4.249294184300676, 3.5287114052808977, 6.2913218109339795, 6.3961427084101325, 7.194375326601598, 6.1002464460488275, 6.15769258632364], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5619769389164586, "mean_inference_ms": 6.79125499225775, "mean_action_processing_ms": 0.5429564631518078, "mean_env_wait_ms": 24.804168229161046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024631023406982422, "StateBufferConnector_ms": 0.0321652889251709, "ViewRequirementAgentConnector_ms": 0.5787224769592285}}, "episode_reward_max": 11.155369857081224, "episode_reward_min": 0.8569905718260122, "episode_reward_mean": 6.25316168660704, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.736022344430795, 5.373308061930758, 2.4308422889606627, 2.3148552237730087, 5.4374977080663465, 5.0270157007392555, 7.190299226918515, 5.58336654945843, 7.191359472230264, 4.682749087786695, 5.603911767056163, 11.155369857081224, 9.391262426191886, 7.691013888324886, 5.05608837634487, 6.472166970919631, 8.864620076436546, 6.658311759554543, 5.28325283463101, 4.867052172554469, 8.282684400759521, 6.616716016505685, 8.085208843312934, 2.1575241135504237, 4.6035408709565795, 5.767987897461064, 7.213705310259421, 3.946245046880882, 7.299930134334143, 6.988163390573581, 11.088648714795895, 8.609324575201386, 7.240470588414145, 5.426235369168431, 5.368920766731051, 6.34216237487282, 4.801999030974071, 9.046014998188223, 7.883711911723158, 8.065019270918098, 4.164336432907018, 4.602283088958547, 8.158076040449876, 8.595340139212057, 6.117433073194994, 5.26467625849594, 6.471206501645298, 9.734433259889723, 9.839466841640872, 6.2163990475182835, 6.9739602950542485, 4.167063183582143, 6.452905100369877, 6.021556215527743, 2.7746322055200277, 7.337691691359622, 8.403456705855097, 5.680051283910458, 5.971220085783865, 9.10261388438943, 5.42923826080373, 6.5759480231540515, 3.061717508155422, 5.552639701013438, 3.2014763517484557, 8.8668331888418, 7.621559714609886, 5.211455865510791, 2.7174198442722, 3.954860946033104, 6.822912770880986, 9.10878801398197, 2.008211482038207, 3.7102900922975888, 6.749202630501433, 7.645347938074518, 7.449154763796649, 8.313825341562552, 8.097823147642284, 7.87469296583052, 1.8548172025717844, 7.434272667641074, 7.164625834745673, 4.97631750302663, 5.39051596337943, 7.203150460290779, 5.8543783312468625, 7.2211086723669595, 6.580652847806604, 4.529789708508345, 0.8569905718260122, 8.433557770671243, 7.031427353736648, 4.249294184300676, 3.5287114052808977, 6.2913218109339795, 6.3961427084101325, 7.194375326601598, 6.1002464460488275, 6.15769258632364], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5619769389164586, "mean_inference_ms": 6.79125499225775, "mean_action_processing_ms": 0.5429564631518078, "mean_env_wait_ms": 24.804168229161046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024631023406982422, "StateBufferConnector_ms": 0.0321652889251709, "ViewRequirementAgentConnector_ms": 0.5787224769592285}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2431044, "num_agent_steps_trained": 2431044, "num_env_steps_sampled": 2431044, "num_env_steps_trained": 2431044, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 302.81930989616234, "num_env_steps_trained_throughput_per_sec": 302.81930989616234, "timesteps_total": 2431044, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2431044, "timers": {"training_iteration_time_ms": 51718.744, "sample_time_ms": 39619.088, "load_time_ms": 597.609, "load_throughput": 26167.599, "learn_time_ms": 11154.189, "learn_throughput": 1401.984, "synch_weights_time_ms": 322.768}, "counters": {"num_env_steps_sampled": 2431044, "num_env_steps_trained": 2431044, "num_agent_steps_sampled": 2431044, "num_agent_steps_trained": 2431044}, "done": false, "episodes_total": 392, "training_iteration": 160, "trial_id": "c5092_00000", "date": "2025-06-08_10-05-11", "timestamp": 1749369911, "time_this_iter_s": 66.07935667037964, "time_total_s": 1458.3116898536682, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1458.3116898536682, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 66.22467532467533, "ram_util_percent": 58.54545454545453, "gpu_util_percent0": 0.06727272727272728, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.568956e-05, "total_loss": -0.1484026166090784, "policy_loss": -0.030243696064783516, "vf_loss": 0.013135786631398581, "vf_explained_var": 0.772385102076964, "kl": 0.027296808558009436, "entropy": 20.889953979145396, "entropy_coeff": 0.00594826}, "model": {}, "num_grad_updates_lifetime": 15675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2446682, "num_env_steps_trained": 2446682, "num_agent_steps_sampled": 2446682, "num_agent_steps_trained": 2446682}, "sampler_results": {"episode_reward_max": 11.088648714795895, "episode_reward_min": 0.8569905718260122, "episode_reward_mean": 6.275826239438709, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.05608837634487, 6.472166970919631, 8.864620076436546, 6.658311759554543, 5.28325283463101, 4.867052172554469, 8.282684400759521, 6.616716016505685, 8.085208843312934, 2.1575241135504237, 4.6035408709565795, 5.767987897461064, 7.213705310259421, 3.946245046880882, 7.299930134334143, 6.988163390573581, 11.088648714795895, 8.609324575201386, 7.240470588414145, 5.426235369168431, 5.368920766731051, 6.34216237487282, 4.801999030974071, 9.046014998188223, 7.883711911723158, 8.065019270918098, 4.164336432907018, 4.602283088958547, 8.158076040449876, 8.595340139212057, 6.117433073194994, 5.26467625849594, 6.471206501645298, 9.734433259889723, 9.839466841640872, 6.2163990475182835, 6.9739602950542485, 4.167063183582143, 6.452905100369877, 6.021556215527743, 2.7746322055200277, 7.337691691359622, 8.403456705855097, 5.680051283910458, 5.971220085783865, 9.10261388438943, 5.42923826080373, 6.5759480231540515, 3.061717508155422, 5.552639701013438, 3.2014763517484557, 8.8668331888418, 7.621559714609886, 5.211455865510791, 2.7174198442722, 3.954860946033104, 6.822912770880986, 9.10878801398197, 2.008211482038207, 3.7102900922975888, 6.749202630501433, 7.645347938074518, 7.449154763796649, 8.313825341562552, 8.097823147642284, 7.87469296583052, 1.8548172025717844, 7.434272667641074, 7.164625834745673, 4.97631750302663, 5.39051596337943, 7.203150460290779, 5.8543783312468625, 7.2211086723669595, 6.580652847806604, 4.529789708508345, 0.8569905718260122, 8.433557770671243, 7.031427353736648, 4.249294184300676, 3.5287114052808977, 6.2913218109339795, 6.3961427084101325, 7.194375326601598, 6.1002464460488275, 6.15769258632364, 9.3094114092202, 9.855633611588624, 7.871669531341925, 1.5379324087514172, 5.503802635476933, 5.894312468082489, 5.522958753538829, 7.5815262589654555, 9.34624920268101, 3.8937442944759106, 6.8971976175364516, 6.122937266139956, 4.843391984380794, 4.894561443935824], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5632656146513546, "mean_inference_ms": 6.79891742032126, "mean_action_processing_ms": 0.5434377900231611, "mean_env_wait_ms": 24.83981594506843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02158522605895996, "StateBufferConnector_ms": 0.031136035919189453, "ViewRequirementAgentConnector_ms": 0.5924444198608398}}, "episode_reward_max": 11.088648714795895, "episode_reward_min": 0.8569905718260122, "episode_reward_mean": 6.275826239438709, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.05608837634487, 6.472166970919631, 8.864620076436546, 6.658311759554543, 5.28325283463101, 4.867052172554469, 8.282684400759521, 6.616716016505685, 8.085208843312934, 2.1575241135504237, 4.6035408709565795, 5.767987897461064, 7.213705310259421, 3.946245046880882, 7.299930134334143, 6.988163390573581, 11.088648714795895, 8.609324575201386, 7.240470588414145, 5.426235369168431, 5.368920766731051, 6.34216237487282, 4.801999030974071, 9.046014998188223, 7.883711911723158, 8.065019270918098, 4.164336432907018, 4.602283088958547, 8.158076040449876, 8.595340139212057, 6.117433073194994, 5.26467625849594, 6.471206501645298, 9.734433259889723, 9.839466841640872, 6.2163990475182835, 6.9739602950542485, 4.167063183582143, 6.452905100369877, 6.021556215527743, 2.7746322055200277, 7.337691691359622, 8.403456705855097, 5.680051283910458, 5.971220085783865, 9.10261388438943, 5.42923826080373, 6.5759480231540515, 3.061717508155422, 5.552639701013438, 3.2014763517484557, 8.8668331888418, 7.621559714609886, 5.211455865510791, 2.7174198442722, 3.954860946033104, 6.822912770880986, 9.10878801398197, 2.008211482038207, 3.7102900922975888, 6.749202630501433, 7.645347938074518, 7.449154763796649, 8.313825341562552, 8.097823147642284, 7.87469296583052, 1.8548172025717844, 7.434272667641074, 7.164625834745673, 4.97631750302663, 5.39051596337943, 7.203150460290779, 5.8543783312468625, 7.2211086723669595, 6.580652847806604, 4.529789708508345, 0.8569905718260122, 8.433557770671243, 7.031427353736648, 4.249294184300676, 3.5287114052808977, 6.2913218109339795, 6.3961427084101325, 7.194375326601598, 6.1002464460488275, 6.15769258632364, 9.3094114092202, 9.855633611588624, 7.871669531341925, 1.5379324087514172, 5.503802635476933, 5.894312468082489, 5.522958753538829, 7.5815262589654555, 9.34624920268101, 3.8937442944759106, 6.8971976175364516, 6.122937266139956, 4.843391984380794, 4.894561443935824], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5632656146513546, "mean_inference_ms": 6.79891742032126, "mean_action_processing_ms": 0.5434377900231611, "mean_env_wait_ms": 24.83981594506843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02158522605895996, "StateBufferConnector_ms": 0.031136035919189453, "ViewRequirementAgentConnector_ms": 0.5924444198608398}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2446682, "num_agent_steps_trained": 2446682, "num_env_steps_sampled": 2446682, "num_env_steps_trained": 2446682, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 303.0146722279061, "num_env_steps_trained_throughput_per_sec": 303.0146722279061, "timesteps_total": 2446682, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2446682, "timers": {"training_iteration_time_ms": 51713.707, "sample_time_ms": 39594.027, "load_time_ms": 589.442, "load_throughput": 26530.193, "learn_time_ms": 11184.422, "learn_throughput": 1398.195, "synch_weights_time_ms": 320.931}, "counters": {"num_env_steps_sampled": 2446682, "num_env_steps_trained": 2446682, "num_agent_steps_sampled": 2446682, "num_agent_steps_trained": 2446682}, "done": false, "episodes_total": 406, "training_iteration": 161, "trial_id": "c5092_00000", "date": "2025-06-08_10-06-02", "timestamp": 1749369962, "time_this_iter_s": 51.621074199676514, "time_total_s": 1509.9327640533447, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1509.9327640533447, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 78.99333333333333, "ram_util_percent": 58.62333333333333, "gpu_util_percent0": 0.07916666666666666, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.553318000000001e-05, "total_loss": -0.15163913909113036, "policy_loss": -0.03445854837133083, "vf_loss": 0.014088706779293716, "vf_explained_var": 0.7707059855894609, "kl": 0.028725547973380793, "entropy": 20.884046977650037, "entropy_coeff": 0.005922196666666665}, "model": {}, "num_grad_updates_lifetime": 16225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2462320, "num_env_steps_trained": 2462320, "num_agent_steps_sampled": 2462320, "num_agent_steps_trained": 2462320}, "sampler_results": {"episode_reward_max": 11.088648714795895, "episode_reward_min": 0.8569905718260122, "episode_reward_mean": 6.277745873048859, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.299930134334143, 6.988163390573581, 11.088648714795895, 8.609324575201386, 7.240470588414145, 5.426235369168431, 5.368920766731051, 6.34216237487282, 4.801999030974071, 9.046014998188223, 7.883711911723158, 8.065019270918098, 4.164336432907018, 4.602283088958547, 8.158076040449876, 8.595340139212057, 6.117433073194994, 5.26467625849594, 6.471206501645298, 9.734433259889723, 9.839466841640872, 6.2163990475182835, 6.9739602950542485, 4.167063183582143, 6.452905100369877, 6.021556215527743, 2.7746322055200277, 7.337691691359622, 8.403456705855097, 5.680051283910458, 5.971220085783865, 9.10261388438943, 5.42923826080373, 6.5759480231540515, 3.061717508155422, 5.552639701013438, 3.2014763517484557, 8.8668331888418, 7.621559714609886, 5.211455865510791, 2.7174198442722, 3.954860946033104, 6.822912770880986, 9.10878801398197, 2.008211482038207, 3.7102900922975888, 6.749202630501433, 7.645347938074518, 7.449154763796649, 8.313825341562552, 8.097823147642284, 7.87469296583052, 1.8548172025717844, 7.434272667641074, 7.164625834745673, 4.97631750302663, 5.39051596337943, 7.203150460290779, 5.8543783312468625, 7.2211086723669595, 6.580652847806604, 4.529789708508345, 0.8569905718260122, 8.433557770671243, 7.031427353736648, 4.249294184300676, 3.5287114052808977, 6.2913218109339795, 6.3961427084101325, 7.194375326601598, 6.1002464460488275, 6.15769258632364, 9.3094114092202, 9.855633611588624, 7.871669531341925, 1.5379324087514172, 5.503802635476933, 5.894312468082489, 5.522958753538829, 7.5815262589654555, 9.34624920268101, 3.8937442944759106, 6.8971976175364516, 6.122937266139956, 4.843391984380794, 4.894561443935824, 5.094515086369472, 6.452215801639129, 7.067791258191591, 6.536273616229799, 7.385978832063406, 6.555367426541239, 3.5323783014206613, 8.001154162247824, 5.923296200528692, 5.598412959247121, 5.577726459031068, 4.5184166971656445, 7.085141253246036, 4.738399997221001], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5647640641627532, "mean_inference_ms": 6.8067436225820295, "mean_action_processing_ms": 0.5439603229743332, "mean_env_wait_ms": 24.87483261944804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022601604461669922, "StateBufferConnector_ms": 0.030088186264038086, "ViewRequirementAgentConnector_ms": 0.5857923030853271}}, "episode_reward_max": 11.088648714795895, "episode_reward_min": 0.8569905718260122, "episode_reward_mean": 6.277745873048859, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.299930134334143, 6.988163390573581, 11.088648714795895, 8.609324575201386, 7.240470588414145, 5.426235369168431, 5.368920766731051, 6.34216237487282, 4.801999030974071, 9.046014998188223, 7.883711911723158, 8.065019270918098, 4.164336432907018, 4.602283088958547, 8.158076040449876, 8.595340139212057, 6.117433073194994, 5.26467625849594, 6.471206501645298, 9.734433259889723, 9.839466841640872, 6.2163990475182835, 6.9739602950542485, 4.167063183582143, 6.452905100369877, 6.021556215527743, 2.7746322055200277, 7.337691691359622, 8.403456705855097, 5.680051283910458, 5.971220085783865, 9.10261388438943, 5.42923826080373, 6.5759480231540515, 3.061717508155422, 5.552639701013438, 3.2014763517484557, 8.8668331888418, 7.621559714609886, 5.211455865510791, 2.7174198442722, 3.954860946033104, 6.822912770880986, 9.10878801398197, 2.008211482038207, 3.7102900922975888, 6.749202630501433, 7.645347938074518, 7.449154763796649, 8.313825341562552, 8.097823147642284, 7.87469296583052, 1.8548172025717844, 7.434272667641074, 7.164625834745673, 4.97631750302663, 5.39051596337943, 7.203150460290779, 5.8543783312468625, 7.2211086723669595, 6.580652847806604, 4.529789708508345, 0.8569905718260122, 8.433557770671243, 7.031427353736648, 4.249294184300676, 3.5287114052808977, 6.2913218109339795, 6.3961427084101325, 7.194375326601598, 6.1002464460488275, 6.15769258632364, 9.3094114092202, 9.855633611588624, 7.871669531341925, 1.5379324087514172, 5.503802635476933, 5.894312468082489, 5.522958753538829, 7.5815262589654555, 9.34624920268101, 3.8937442944759106, 6.8971976175364516, 6.122937266139956, 4.843391984380794, 4.894561443935824, 5.094515086369472, 6.452215801639129, 7.067791258191591, 6.536273616229799, 7.385978832063406, 6.555367426541239, 3.5323783014206613, 8.001154162247824, 5.923296200528692, 5.598412959247121, 5.577726459031068, 4.5184166971656445, 7.085141253246036, 4.738399997221001], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5647640641627532, "mean_inference_ms": 6.8067436225820295, "mean_action_processing_ms": 0.5439603229743332, "mean_env_wait_ms": 24.87483261944804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022601604461669922, "StateBufferConnector_ms": 0.030088186264038086, "ViewRequirementAgentConnector_ms": 0.5857923030853271}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2462320, "num_agent_steps_trained": 2462320, "num_env_steps_sampled": 2462320, "num_env_steps_trained": 2462320, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 298.5389403488296, "num_env_steps_trained_throughput_per_sec": 298.5389403488296, "timesteps_total": 2462320, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2462320, "timers": {"training_iteration_time_ms": 51733.727, "sample_time_ms": 39610.253, "load_time_ms": 604.373, "load_throughput": 25874.766, "learn_time_ms": 11174.359, "learn_throughput": 1399.454, "synch_weights_time_ms": 320.233}, "counters": {"num_env_steps_sampled": 2462320, "num_env_steps_trained": 2462320, "num_agent_steps_sampled": 2462320, "num_agent_steps_trained": 2462320}, "done": false, "episodes_total": 420, "training_iteration": 162, "trial_id": "c5092_00000", "date": "2025-06-08_10-06-55", "timestamp": 1749370015, "time_this_iter_s": 52.39786195755005, "time_total_s": 1562.3306260108948, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1562.3306260108948, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 79.21666666666665, "ram_util_percent": 58.59166666666667, "gpu_util_percent0": 0.08366666666666668, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.537679999999999e-05, "total_loss": -0.14691219494233584, "policy_loss": -0.028730853685675274, "vf_loss": 0.01219778205014088, "vf_explained_var": 0.7830523133277894, "kl": 0.026906333757545906, "entropy": 21.025475536693225, "entropy_coeff": 0.005896133333333333}, "model": {}, "num_grad_updates_lifetime": 16775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2477958, "num_env_steps_trained": 2477958, "num_agent_steps_sampled": 2477958, "num_agent_steps_trained": 2477958}, "sampler_results": {"episode_reward_max": 9.855633611588624, "episode_reward_min": 0.8569905718260122, "episode_reward_mean": 6.147289811222067, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.158076040449876, 8.595340139212057, 6.117433073194994, 5.26467625849594, 6.471206501645298, 9.734433259889723, 9.839466841640872, 6.2163990475182835, 6.9739602950542485, 4.167063183582143, 6.452905100369877, 6.021556215527743, 2.7746322055200277, 7.337691691359622, 8.403456705855097, 5.680051283910458, 5.971220085783865, 9.10261388438943, 5.42923826080373, 6.5759480231540515, 3.061717508155422, 5.552639701013438, 3.2014763517484557, 8.8668331888418, 7.621559714609886, 5.211455865510791, 2.7174198442722, 3.954860946033104, 6.822912770880986, 9.10878801398197, 2.008211482038207, 3.7102900922975888, 6.749202630501433, 7.645347938074518, 7.449154763796649, 8.313825341562552, 8.097823147642284, 7.87469296583052, 1.8548172025717844, 7.434272667641074, 7.164625834745673, 4.97631750302663, 5.39051596337943, 7.203150460290779, 5.8543783312468625, 7.2211086723669595, 6.580652847806604, 4.529789708508345, 0.8569905718260122, 8.433557770671243, 7.031427353736648, 4.249294184300676, 3.5287114052808977, 6.2913218109339795, 6.3961427084101325, 7.194375326601598, 6.1002464460488275, 6.15769258632364, 9.3094114092202, 9.855633611588624, 7.871669531341925, 1.5379324087514172, 5.503802635476933, 5.894312468082489, 5.522958753538829, 7.5815262589654555, 9.34624920268101, 3.8937442944759106, 6.8971976175364516, 6.122937266139956, 4.843391984380794, 4.894561443935824, 5.094515086369472, 6.452215801639129, 7.067791258191591, 6.536273616229799, 7.385978832063406, 6.555367426541239, 3.5323783014206613, 8.001154162247824, 5.923296200528692, 5.598412959247121, 5.577726459031068, 4.5184166971656445, 7.085141253246036, 4.738399997221001, 6.920622317237694, 5.707622456860967, 5.374673397383397, 8.09707048035287, 7.6715591684502655, 5.476120441448986, 6.616471833915727, 4.234197962611504, 3.782026533718167, 3.5171825219490533, 6.977069486559453, 8.954499531346194, 4.441299705478245, 6.111198627768843], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.566058065564431, "mean_inference_ms": 6.814490842815274, "mean_action_processing_ms": 0.5444611128427042, "mean_env_wait_ms": 24.908795447918287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02249598503112793, "StateBufferConnector_ms": 0.025059223175048828, "ViewRequirementAgentConnector_ms": 0.6003546714782715}}, "episode_reward_max": 9.855633611588624, "episode_reward_min": 0.8569905718260122, "episode_reward_mean": 6.147289811222067, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.158076040449876, 8.595340139212057, 6.117433073194994, 5.26467625849594, 6.471206501645298, 9.734433259889723, 9.839466841640872, 6.2163990475182835, 6.9739602950542485, 4.167063183582143, 6.452905100369877, 6.021556215527743, 2.7746322055200277, 7.337691691359622, 8.403456705855097, 5.680051283910458, 5.971220085783865, 9.10261388438943, 5.42923826080373, 6.5759480231540515, 3.061717508155422, 5.552639701013438, 3.2014763517484557, 8.8668331888418, 7.621559714609886, 5.211455865510791, 2.7174198442722, 3.954860946033104, 6.822912770880986, 9.10878801398197, 2.008211482038207, 3.7102900922975888, 6.749202630501433, 7.645347938074518, 7.449154763796649, 8.313825341562552, 8.097823147642284, 7.87469296583052, 1.8548172025717844, 7.434272667641074, 7.164625834745673, 4.97631750302663, 5.39051596337943, 7.203150460290779, 5.8543783312468625, 7.2211086723669595, 6.580652847806604, 4.529789708508345, 0.8569905718260122, 8.433557770671243, 7.031427353736648, 4.249294184300676, 3.5287114052808977, 6.2913218109339795, 6.3961427084101325, 7.194375326601598, 6.1002464460488275, 6.15769258632364, 9.3094114092202, 9.855633611588624, 7.871669531341925, 1.5379324087514172, 5.503802635476933, 5.894312468082489, 5.522958753538829, 7.5815262589654555, 9.34624920268101, 3.8937442944759106, 6.8971976175364516, 6.122937266139956, 4.843391984380794, 4.894561443935824, 5.094515086369472, 6.452215801639129, 7.067791258191591, 6.536273616229799, 7.385978832063406, 6.555367426541239, 3.5323783014206613, 8.001154162247824, 5.923296200528692, 5.598412959247121, 5.577726459031068, 4.5184166971656445, 7.085141253246036, 4.738399997221001, 6.920622317237694, 5.707622456860967, 5.374673397383397, 8.09707048035287, 7.6715591684502655, 5.476120441448986, 6.616471833915727, 4.234197962611504, 3.782026533718167, 3.5171825219490533, 6.977069486559453, 8.954499531346194, 4.441299705478245, 6.111198627768843], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.566058065564431, "mean_inference_ms": 6.814490842815274, "mean_action_processing_ms": 0.5444611128427042, "mean_env_wait_ms": 24.908795447918287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02249598503112793, "StateBufferConnector_ms": 0.025059223175048828, "ViewRequirementAgentConnector_ms": 0.6003546714782715}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2477958, "num_agent_steps_trained": 2477958, "num_env_steps_sampled": 2477958, "num_env_steps_trained": 2477958, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 298.7361056863117, "num_env_steps_trained_throughput_per_sec": 298.7361056863117, "timesteps_total": 2477958, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2477958, "timers": {"training_iteration_time_ms": 51784.111, "sample_time_ms": 39662.419, "load_time_ms": 603.708, "load_throughput": 25903.242, "learn_time_ms": 11171.909, "learn_throughput": 1399.761, "synch_weights_time_ms": 322.614}, "counters": {"num_env_steps_sampled": 2477958, "num_env_steps_trained": 2477958, "num_agent_steps_sampled": 2477958, "num_agent_steps_trained": 2477958}, "done": false, "episodes_total": 434, "training_iteration": 163, "trial_id": "c5092_00000", "date": "2025-06-08_10-07-47", "timestamp": 1749370067, "time_this_iter_s": 52.388667345047, "time_total_s": 1614.7192933559418, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1614.7192933559418, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 78.64098360655736, "ram_util_percent": 58.7, "gpu_util_percent0": 0.08557377049180329, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.522042000000002e-05, "total_loss": -0.14774517701007425, "policy_loss": -0.031054281416687774, "vf_loss": 0.013971398141743108, "vf_explained_var": 0.7772579760984941, "kl": 0.02739874706699075, "entropy": 20.96220339688388, "entropy_coeff": 0.005870069999999998}, "model": {}, "num_grad_updates_lifetime": 17325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2493596, "num_env_steps_trained": 2493596, "num_agent_steps_sampled": 2493596, "num_agent_steps_trained": 2493596}, "sampler_results": {"episode_reward_max": 9.855633611588624, "episode_reward_min": 0.8569905718260122, "episode_reward_mean": 6.0967860077258464, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.403456705855097, 5.680051283910458, 5.971220085783865, 9.10261388438943, 5.42923826080373, 6.5759480231540515, 3.061717508155422, 5.552639701013438, 3.2014763517484557, 8.8668331888418, 7.621559714609886, 5.211455865510791, 2.7174198442722, 3.954860946033104, 6.822912770880986, 9.10878801398197, 2.008211482038207, 3.7102900922975888, 6.749202630501433, 7.645347938074518, 7.449154763796649, 8.313825341562552, 8.097823147642284, 7.87469296583052, 1.8548172025717844, 7.434272667641074, 7.164625834745673, 4.97631750302663, 5.39051596337943, 7.203150460290779, 5.8543783312468625, 7.2211086723669595, 6.580652847806604, 4.529789708508345, 0.8569905718260122, 8.433557770671243, 7.031427353736648, 4.249294184300676, 3.5287114052808977, 6.2913218109339795, 6.3961427084101325, 7.194375326601598, 6.1002464460488275, 6.15769258632364, 9.3094114092202, 9.855633611588624, 7.871669531341925, 1.5379324087514172, 5.503802635476933, 5.894312468082489, 5.522958753538829, 7.5815262589654555, 9.34624920268101, 3.8937442944759106, 6.8971976175364516, 6.122937266139956, 4.843391984380794, 4.894561443935824, 5.094515086369472, 6.452215801639129, 7.067791258191591, 6.536273616229799, 7.385978832063406, 6.555367426541239, 3.5323783014206613, 8.001154162247824, 5.923296200528692, 5.598412959247121, 5.577726459031068, 4.5184166971656445, 7.085141253246036, 4.738399997221001, 6.920622317237694, 5.707622456860967, 5.374673397383397, 8.09707048035287, 7.6715591684502655, 5.476120441448986, 6.616471833915727, 4.234197962611504, 3.782026533718167, 3.5171825219490533, 6.977069486559453, 8.954499531346194, 4.441299705478245, 6.111198627768843, 5.054047245699861, 6.468917520843244, 6.900515548339175, 4.305636584961004, 6.46195972313696, 7.950633050839175, 8.31217938442472, 7.214630562191875, 8.695039063201811, 3.2250455941340865, 8.030007961229074, 6.569273389799968, 3.2323197208254157, 6.654254154212093], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5677932894602788, "mean_inference_ms": 6.821543967969879, "mean_action_processing_ms": 0.5449755554308492, "mean_env_wait_ms": 24.940942942396617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022486448287963867, "StateBufferConnector_ms": 0.02103281021118164, "ViewRequirementAgentConnector_ms": 0.6148161888122559}}, "episode_reward_max": 9.855633611588624, "episode_reward_min": 0.8569905718260122, "episode_reward_mean": 6.0967860077258464, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.403456705855097, 5.680051283910458, 5.971220085783865, 9.10261388438943, 5.42923826080373, 6.5759480231540515, 3.061717508155422, 5.552639701013438, 3.2014763517484557, 8.8668331888418, 7.621559714609886, 5.211455865510791, 2.7174198442722, 3.954860946033104, 6.822912770880986, 9.10878801398197, 2.008211482038207, 3.7102900922975888, 6.749202630501433, 7.645347938074518, 7.449154763796649, 8.313825341562552, 8.097823147642284, 7.87469296583052, 1.8548172025717844, 7.434272667641074, 7.164625834745673, 4.97631750302663, 5.39051596337943, 7.203150460290779, 5.8543783312468625, 7.2211086723669595, 6.580652847806604, 4.529789708508345, 0.8569905718260122, 8.433557770671243, 7.031427353736648, 4.249294184300676, 3.5287114052808977, 6.2913218109339795, 6.3961427084101325, 7.194375326601598, 6.1002464460488275, 6.15769258632364, 9.3094114092202, 9.855633611588624, 7.871669531341925, 1.5379324087514172, 5.503802635476933, 5.894312468082489, 5.522958753538829, 7.5815262589654555, 9.34624920268101, 3.8937442944759106, 6.8971976175364516, 6.122937266139956, 4.843391984380794, 4.894561443935824, 5.094515086369472, 6.452215801639129, 7.067791258191591, 6.536273616229799, 7.385978832063406, 6.555367426541239, 3.5323783014206613, 8.001154162247824, 5.923296200528692, 5.598412959247121, 5.577726459031068, 4.5184166971656445, 7.085141253246036, 4.738399997221001, 6.920622317237694, 5.707622456860967, 5.374673397383397, 8.09707048035287, 7.6715591684502655, 5.476120441448986, 6.616471833915727, 4.234197962611504, 3.782026533718167, 3.5171825219490533, 6.977069486559453, 8.954499531346194, 4.441299705478245, 6.111198627768843, 5.054047245699861, 6.468917520843244, 6.900515548339175, 4.305636584961004, 6.46195972313696, 7.950633050839175, 8.31217938442472, 7.214630562191875, 8.695039063201811, 3.2250455941340865, 8.030007961229074, 6.569273389799968, 3.2323197208254157, 6.654254154212093], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5677932894602788, "mean_inference_ms": 6.821543967969879, "mean_action_processing_ms": 0.5449755554308492, "mean_env_wait_ms": 24.940942942396617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022486448287963867, "StateBufferConnector_ms": 0.02103281021118164, "ViewRequirementAgentConnector_ms": 0.6148161888122559}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2493596, "num_agent_steps_trained": 2493596, "num_env_steps_sampled": 2493596, "num_env_steps_trained": 2493596, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 302.09361146866195, "num_env_steps_trained_throughput_per_sec": 302.09361146866195, "timesteps_total": 2493596, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2493596, "timers": {"training_iteration_time_ms": 51827.312, "sample_time_ms": 39690.746, "load_time_ms": 608.178, "load_throughput": 25712.878, "learn_time_ms": 11174.953, "learn_throughput": 1399.38, "synch_weights_time_ms": 330.634}, "counters": {"num_env_steps_sampled": 2493596, "num_env_steps_trained": 2493596, "num_agent_steps_sampled": 2493596, "num_agent_steps_trained": 2493596}, "done": false, "episodes_total": 448, "training_iteration": 164, "trial_id": "c5092_00000", "date": "2025-06-08_10-08-39", "timestamp": 1749370119, "time_this_iter_s": 51.77841138839722, "time_total_s": 1666.497704744339, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1666.497704744339, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 78.64745762711864, "ram_util_percent": 58.844067796610155, "gpu_util_percent0": 0.0811864406779661, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.506403999999999e-05, "total_loss": -0.15821928635112603, "policy_loss": -0.040766889269103886, "vf_loss": 0.012768235734071244, "vf_explained_var": 0.752903267253529, "kl": 0.026275381059335228, "entropy": 21.109026159806685, "entropy_coeff": 0.005844006666666666}, "model": {}, "num_grad_updates_lifetime": 17875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2509234, "num_env_steps_trained": 2509234, "num_agent_steps_sampled": 2509234, "num_agent_steps_trained": 2509234}, "sampler_results": {"episode_reward_max": 9.855633611588624, "episode_reward_min": -1.9102088003417512, "episode_reward_mean": 6.132436624414728, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.822912770880986, 9.10878801398197, 2.008211482038207, 3.7102900922975888, 6.749202630501433, 7.645347938074518, 7.449154763796649, 8.313825341562552, 8.097823147642284, 7.87469296583052, 1.8548172025717844, 7.434272667641074, 7.164625834745673, 4.97631750302663, 5.39051596337943, 7.203150460290779, 5.8543783312468625, 7.2211086723669595, 6.580652847806604, 4.529789708508345, 0.8569905718260122, 8.433557770671243, 7.031427353736648, 4.249294184300676, 3.5287114052808977, 6.2913218109339795, 6.3961427084101325, 7.194375326601598, 6.1002464460488275, 6.15769258632364, 9.3094114092202, 9.855633611588624, 7.871669531341925, 1.5379324087514172, 5.503802635476933, 5.894312468082489, 5.522958753538829, 7.5815262589654555, 9.34624920268101, 3.8937442944759106, 6.8971976175364516, 6.122937266139956, 4.843391984380794, 4.894561443935824, 5.094515086369472, 6.452215801639129, 7.067791258191591, 6.536273616229799, 7.385978832063406, 6.555367426541239, 3.5323783014206613, 8.001154162247824, 5.923296200528692, 5.598412959247121, 5.577726459031068, 4.5184166971656445, 7.085141253246036, 4.738399997221001, 6.920622317237694, 5.707622456860967, 5.374673397383397, 8.09707048035287, 7.6715591684502655, 5.476120441448986, 6.616471833915727, 4.234197962611504, 3.782026533718167, 3.5171825219490533, 6.977069486559453, 8.954499531346194, 4.441299705478245, 6.111198627768843, 5.054047245699861, 6.468917520843244, 6.900515548339175, 4.305636584961004, 6.46195972313696, 7.950633050839175, 8.31217938442472, 7.214630562191875, 8.695039063201811, 3.2250455941340865, 8.030007961229074, 6.569273389799968, 3.2323197208254157, 6.654254154212093, 6.344609553739686, 3.5764879889747334, -1.9102088003417512, 5.042545216557136, 8.270607265659315, 7.618401918944555, 7.589237094446259, 4.31522319109904, 6.821403837564319, 9.841676749566247, 8.930297072859595, 4.744457188232368, 5.991855403830712, 7.738959351837679], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5694870927032287, "mean_inference_ms": 6.8284495244980725, "mean_action_processing_ms": 0.5454771019860761, "mean_env_wait_ms": 24.971052453126116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021956920623779297, "StateBufferConnector_ms": 0.024077177047729492, "ViewRequirementAgentConnector_ms": 0.6043045520782471}}, "episode_reward_max": 9.855633611588624, "episode_reward_min": -1.9102088003417512, "episode_reward_mean": 6.132436624414728, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.822912770880986, 9.10878801398197, 2.008211482038207, 3.7102900922975888, 6.749202630501433, 7.645347938074518, 7.449154763796649, 8.313825341562552, 8.097823147642284, 7.87469296583052, 1.8548172025717844, 7.434272667641074, 7.164625834745673, 4.97631750302663, 5.39051596337943, 7.203150460290779, 5.8543783312468625, 7.2211086723669595, 6.580652847806604, 4.529789708508345, 0.8569905718260122, 8.433557770671243, 7.031427353736648, 4.249294184300676, 3.5287114052808977, 6.2913218109339795, 6.3961427084101325, 7.194375326601598, 6.1002464460488275, 6.15769258632364, 9.3094114092202, 9.855633611588624, 7.871669531341925, 1.5379324087514172, 5.503802635476933, 5.894312468082489, 5.522958753538829, 7.5815262589654555, 9.34624920268101, 3.8937442944759106, 6.8971976175364516, 6.122937266139956, 4.843391984380794, 4.894561443935824, 5.094515086369472, 6.452215801639129, 7.067791258191591, 6.536273616229799, 7.385978832063406, 6.555367426541239, 3.5323783014206613, 8.001154162247824, 5.923296200528692, 5.598412959247121, 5.577726459031068, 4.5184166971656445, 7.085141253246036, 4.738399997221001, 6.920622317237694, 5.707622456860967, 5.374673397383397, 8.09707048035287, 7.6715591684502655, 5.476120441448986, 6.616471833915727, 4.234197962611504, 3.782026533718167, 3.5171825219490533, 6.977069486559453, 8.954499531346194, 4.441299705478245, 6.111198627768843, 5.054047245699861, 6.468917520843244, 6.900515548339175, 4.305636584961004, 6.46195972313696, 7.950633050839175, 8.31217938442472, 7.214630562191875, 8.695039063201811, 3.2250455941340865, 8.030007961229074, 6.569273389799968, 3.2323197208254157, 6.654254154212093, 6.344609553739686, 3.5764879889747334, -1.9102088003417512, 5.042545216557136, 8.270607265659315, 7.618401918944555, 7.589237094446259, 4.31522319109904, 6.821403837564319, 9.841676749566247, 8.930297072859595, 4.744457188232368, 5.991855403830712, 7.738959351837679], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5694870927032287, "mean_inference_ms": 6.8284495244980725, "mean_action_processing_ms": 0.5454771019860761, "mean_env_wait_ms": 24.971052453126116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021956920623779297, "StateBufferConnector_ms": 0.024077177047729492, "ViewRequirementAgentConnector_ms": 0.6043045520782471}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2509234, "num_agent_steps_trained": 2509234, "num_env_steps_sampled": 2509234, "num_env_steps_trained": 2509234, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 298.6524297188339, "num_env_steps_trained_throughput_per_sec": 298.6524297188339, "timesteps_total": 2509234, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2509234, "timers": {"training_iteration_time_ms": 51901.698, "sample_time_ms": 39768.617, "load_time_ms": 602.394, "load_throughput": 25959.757, "learn_time_ms": 11180.528, "learn_throughput": 1398.682, "synch_weights_time_ms": 327.159}, "counters": {"num_env_steps_sampled": 2509234, "num_env_steps_trained": 2509234, "num_agent_steps_sampled": 2509234, "num_agent_steps_trained": 2509234}, "done": false, "episodes_total": 462, "training_iteration": 165, "trial_id": "c5092_00000", "date": "2025-06-08_10-09-31", "timestamp": 1749370171, "time_this_iter_s": 52.378392934799194, "time_total_s": 1718.8760976791382, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1718.8760976791382, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 79.28333333333335, "ram_util_percent": 59.783333333333324, "gpu_util_percent0": 0.08233333333333333, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.490766e-05, "total_loss": -0.1476806670363823, "policy_loss": -0.03063583010466325, "vf_loss": 0.01288183792875233, "vf_explained_var": 0.7551647088744423, "kl": 0.02570675403012146, "entropy": 21.131665956323797, "entropy_coeff": 0.005817943333333333}, "model": {}, "num_grad_updates_lifetime": 18425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2524872, "num_env_steps_trained": 2524872, "num_agent_steps_sampled": 2524872, "num_agent_steps_trained": 2524872}, "sampler_results": {"episode_reward_max": 9.855633611588624, "episode_reward_min": -1.9102088003417512, "episode_reward_mean": 6.1453341676988495, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.39051596337943, 7.203150460290779, 5.8543783312468625, 7.2211086723669595, 6.580652847806604, 4.529789708508345, 0.8569905718260122, 8.433557770671243, 7.031427353736648, 4.249294184300676, 3.5287114052808977, 6.2913218109339795, 6.3961427084101325, 7.194375326601598, 6.1002464460488275, 6.15769258632364, 9.3094114092202, 9.855633611588624, 7.871669531341925, 1.5379324087514172, 5.503802635476933, 5.894312468082489, 5.522958753538829, 7.5815262589654555, 9.34624920268101, 3.8937442944759106, 6.8971976175364516, 6.122937266139956, 4.843391984380794, 4.894561443935824, 5.094515086369472, 6.452215801639129, 7.067791258191591, 6.536273616229799, 7.385978832063406, 6.555367426541239, 3.5323783014206613, 8.001154162247824, 5.923296200528692, 5.598412959247121, 5.577726459031068, 4.5184166971656445, 7.085141253246036, 4.738399997221001, 6.920622317237694, 5.707622456860967, 5.374673397383397, 8.09707048035287, 7.6715591684502655, 5.476120441448986, 6.616471833915727, 4.234197962611504, 3.782026533718167, 3.5171825219490533, 6.977069486559453, 8.954499531346194, 4.441299705478245, 6.111198627768843, 5.054047245699861, 6.468917520843244, 6.900515548339175, 4.305636584961004, 6.46195972313696, 7.950633050839175, 8.31217938442472, 7.214630562191875, 8.695039063201811, 3.2250455941340865, 8.030007961229074, 6.569273389799968, 3.2323197208254157, 6.654254154212093, 6.344609553739686, 3.5764879889747334, -1.9102088003417512, 5.042545216557136, 8.270607265659315, 7.618401918944555, 7.589237094446259, 4.31522319109904, 6.821403837564319, 9.841676749566247, 8.930297072859595, 4.744457188232368, 5.991855403830712, 7.738959351837679, 9.339794102098713, 4.886174217929147, 8.322636871217213, 6.99366940550196, 6.76969274132237, 4.0178808245903905, 5.818373557654879, 7.93908653464929, 3.9862194533034905, 4.693602217134478, 7.22096749012498, 5.209604436617099, 9.802816398553716, 5.499518432306614], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5710369295199147, "mean_inference_ms": 6.835221386911513, "mean_action_processing_ms": 0.5460778693176025, "mean_env_wait_ms": 24.99966088943436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02601003646850586, "StateBufferConnector_ms": 0.022061824798583984, "ViewRequirementAgentConnector_ms": 0.6044309139251709}}, "episode_reward_max": 9.855633611588624, "episode_reward_min": -1.9102088003417512, "episode_reward_mean": 6.1453341676988495, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.39051596337943, 7.203150460290779, 5.8543783312468625, 7.2211086723669595, 6.580652847806604, 4.529789708508345, 0.8569905718260122, 8.433557770671243, 7.031427353736648, 4.249294184300676, 3.5287114052808977, 6.2913218109339795, 6.3961427084101325, 7.194375326601598, 6.1002464460488275, 6.15769258632364, 9.3094114092202, 9.855633611588624, 7.871669531341925, 1.5379324087514172, 5.503802635476933, 5.894312468082489, 5.522958753538829, 7.5815262589654555, 9.34624920268101, 3.8937442944759106, 6.8971976175364516, 6.122937266139956, 4.843391984380794, 4.894561443935824, 5.094515086369472, 6.452215801639129, 7.067791258191591, 6.536273616229799, 7.385978832063406, 6.555367426541239, 3.5323783014206613, 8.001154162247824, 5.923296200528692, 5.598412959247121, 5.577726459031068, 4.5184166971656445, 7.085141253246036, 4.738399997221001, 6.920622317237694, 5.707622456860967, 5.374673397383397, 8.09707048035287, 7.6715591684502655, 5.476120441448986, 6.616471833915727, 4.234197962611504, 3.782026533718167, 3.5171825219490533, 6.977069486559453, 8.954499531346194, 4.441299705478245, 6.111198627768843, 5.054047245699861, 6.468917520843244, 6.900515548339175, 4.305636584961004, 6.46195972313696, 7.950633050839175, 8.31217938442472, 7.214630562191875, 8.695039063201811, 3.2250455941340865, 8.030007961229074, 6.569273389799968, 3.2323197208254157, 6.654254154212093, 6.344609553739686, 3.5764879889747334, -1.9102088003417512, 5.042545216557136, 8.270607265659315, 7.618401918944555, 7.589237094446259, 4.31522319109904, 6.821403837564319, 9.841676749566247, 8.930297072859595, 4.744457188232368, 5.991855403830712, 7.738959351837679, 9.339794102098713, 4.886174217929147, 8.322636871217213, 6.99366940550196, 6.76969274132237, 4.0178808245903905, 5.818373557654879, 7.93908653464929, 3.9862194533034905, 4.693602217134478, 7.22096749012498, 5.209604436617099, 9.802816398553716, 5.499518432306614], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5710369295199147, "mean_inference_ms": 6.835221386911513, "mean_action_processing_ms": 0.5460778693176025, "mean_env_wait_ms": 24.99966088943436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02601003646850586, "StateBufferConnector_ms": 0.022061824798583984, "ViewRequirementAgentConnector_ms": 0.6044309139251709}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2524872, "num_agent_steps_trained": 2524872, "num_env_steps_sampled": 2524872, "num_env_steps_trained": 2524872, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 302.03256501988557, "num_env_steps_trained_throughput_per_sec": 302.03256501988557, "timesteps_total": 2524872, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2524872, "timers": {"training_iteration_time_ms": 51948.644, "sample_time_ms": 39804.844, "load_time_ms": 605.338, "load_throughput": 25833.509, "learn_time_ms": 11185.473, "learn_throughput": 1398.063, "synch_weights_time_ms": 330.413}, "counters": {"num_env_steps_sampled": 2524872, "num_env_steps_trained": 2524872, "num_agent_steps_sampled": 2524872, "num_agent_steps_trained": 2524872}, "done": false, "episodes_total": 476, "training_iteration": 166, "trial_id": "c5092_00000", "date": "2025-06-08_10-10-23", "timestamp": 1749370223, "time_this_iter_s": 51.7868914604187, "time_total_s": 1770.6629891395569, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1770.6629891395569, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 79.44333333333333, "ram_util_percent": 59.77999999999999, "gpu_util_percent0": 0.08466666666666667, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.475128000000002e-05, "total_loss": -0.15662574587093497, "policy_loss": -0.0399469709776035, "vf_loss": 0.012702117378569463, "vf_explained_var": 0.7256530703197827, "kl": 0.028011508400033396, "entropy": 21.18572206670588, "entropy_coeff": 0.005791880000000001}, "model": {}, "num_grad_updates_lifetime": 18975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2540510, "num_env_steps_trained": 2540510, "num_agent_steps_sampled": 2540510, "num_agent_steps_trained": 2540510}, "sampler_results": {"episode_reward_max": 9.855633611588624, "episode_reward_min": -1.9102088003417512, "episode_reward_mean": 6.174645879225995, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.1002464460488275, 6.15769258632364, 9.3094114092202, 9.855633611588624, 7.871669531341925, 1.5379324087514172, 5.503802635476933, 5.894312468082489, 5.522958753538829, 7.5815262589654555, 9.34624920268101, 3.8937442944759106, 6.8971976175364516, 6.122937266139956, 4.843391984380794, 4.894561443935824, 5.094515086369472, 6.452215801639129, 7.067791258191591, 6.536273616229799, 7.385978832063406, 6.555367426541239, 3.5323783014206613, 8.001154162247824, 5.923296200528692, 5.598412959247121, 5.577726459031068, 4.5184166971656445, 7.085141253246036, 4.738399997221001, 6.920622317237694, 5.707622456860967, 5.374673397383397, 8.09707048035287, 7.6715591684502655, 5.476120441448986, 6.616471833915727, 4.234197962611504, 3.782026533718167, 3.5171825219490533, 6.977069486559453, 8.954499531346194, 4.441299705478245, 6.111198627768843, 5.054047245699861, 6.468917520843244, 6.900515548339175, 4.305636584961004, 6.46195972313696, 7.950633050839175, 8.31217938442472, 7.214630562191875, 8.695039063201811, 3.2250455941340865, 8.030007961229074, 6.569273389799968, 3.2323197208254157, 6.654254154212093, 6.344609553739686, 3.5764879889747334, -1.9102088003417512, 5.042545216557136, 8.270607265659315, 7.618401918944555, 7.589237094446259, 4.31522319109904, 6.821403837564319, 9.841676749566247, 8.930297072859595, 4.744457188232368, 5.991855403830712, 7.738959351837679, 9.339794102098713, 4.886174217929147, 8.322636871217213, 6.99366940550196, 6.76969274132237, 4.0178808245903905, 5.818373557654879, 7.93908653464929, 3.9862194533034905, 4.693602217134478, 7.22096749012498, 5.209604436617099, 9.802816398553716, 5.499518432306614, 4.175180364047572, 6.642220219569313, 6.642722409796515, 7.593029647320572, 5.975649810691008, 5.457302152322953, 5.58731587527725, 6.091565416850834, 8.574995946981979, 4.746862448984855, 7.888968975887409, 7.838398488234611, 4.155027739664188, 2.3233487724452977], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.572284631096163, "mean_inference_ms": 6.841918703788983, "mean_action_processing_ms": 0.5467732124857385, "mean_env_wait_ms": 25.027155800450895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023016691207885742, "StateBufferConnector_ms": 0.021068811416625977, "ViewRequirementAgentConnector_ms": 0.6203896999359131}}, "episode_reward_max": 9.855633611588624, "episode_reward_min": -1.9102088003417512, "episode_reward_mean": 6.174645879225995, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.1002464460488275, 6.15769258632364, 9.3094114092202, 9.855633611588624, 7.871669531341925, 1.5379324087514172, 5.503802635476933, 5.894312468082489, 5.522958753538829, 7.5815262589654555, 9.34624920268101, 3.8937442944759106, 6.8971976175364516, 6.122937266139956, 4.843391984380794, 4.894561443935824, 5.094515086369472, 6.452215801639129, 7.067791258191591, 6.536273616229799, 7.385978832063406, 6.555367426541239, 3.5323783014206613, 8.001154162247824, 5.923296200528692, 5.598412959247121, 5.577726459031068, 4.5184166971656445, 7.085141253246036, 4.738399997221001, 6.920622317237694, 5.707622456860967, 5.374673397383397, 8.09707048035287, 7.6715591684502655, 5.476120441448986, 6.616471833915727, 4.234197962611504, 3.782026533718167, 3.5171825219490533, 6.977069486559453, 8.954499531346194, 4.441299705478245, 6.111198627768843, 5.054047245699861, 6.468917520843244, 6.900515548339175, 4.305636584961004, 6.46195972313696, 7.950633050839175, 8.31217938442472, 7.214630562191875, 8.695039063201811, 3.2250455941340865, 8.030007961229074, 6.569273389799968, 3.2323197208254157, 6.654254154212093, 6.344609553739686, 3.5764879889747334, -1.9102088003417512, 5.042545216557136, 8.270607265659315, 7.618401918944555, 7.589237094446259, 4.31522319109904, 6.821403837564319, 9.841676749566247, 8.930297072859595, 4.744457188232368, 5.991855403830712, 7.738959351837679, 9.339794102098713, 4.886174217929147, 8.322636871217213, 6.99366940550196, 6.76969274132237, 4.0178808245903905, 5.818373557654879, 7.93908653464929, 3.9862194533034905, 4.693602217134478, 7.22096749012498, 5.209604436617099, 9.802816398553716, 5.499518432306614, 4.175180364047572, 6.642220219569313, 6.642722409796515, 7.593029647320572, 5.975649810691008, 5.457302152322953, 5.58731587527725, 6.091565416850834, 8.574995946981979, 4.746862448984855, 7.888968975887409, 7.838398488234611, 4.155027739664188, 2.3233487724452977], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.572284631096163, "mean_inference_ms": 6.841918703788983, "mean_action_processing_ms": 0.5467732124857385, "mean_env_wait_ms": 25.027155800450895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023016691207885742, "StateBufferConnector_ms": 0.021068811416625977, "ViewRequirementAgentConnector_ms": 0.6203896999359131}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2540510, "num_agent_steps_trained": 2540510, "num_env_steps_sampled": 2540510, "num_env_steps_trained": 2540510, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 301.73693851692474, "num_env_steps_trained_throughput_per_sec": 301.73693851692474, "timesteps_total": 2540510, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2540510, "timers": {"training_iteration_time_ms": 51973.082, "sample_time_ms": 39839.394, "load_time_ms": 604.101, "load_throughput": 25886.409, "learn_time_ms": 11176.513, "learn_throughput": 1399.184, "synch_weights_time_ms": 330.654}, "counters": {"num_env_steps_sampled": 2540510, "num_env_steps_trained": 2540510, "num_agent_steps_sampled": 2540510, "num_agent_steps_trained": 2540510}, "done": false, "episodes_total": 490, "training_iteration": 167, "trial_id": "c5092_00000", "date": "2025-06-08_10-11-15", "timestamp": 1749370275, "time_this_iter_s": 51.83760333061218, "time_total_s": 1822.500592470169, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1822.500592470169, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 79.42166666666667, "ram_util_percent": 60.108333333333334, "gpu_util_percent0": 0.08466666666666668, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.459489999999998e-05, "total_loss": -0.1577386422412978, "policy_loss": -0.04142039746173065, "vf_loss": 0.012293570210564543, "vf_explained_var": 0.7518000687252392, "kl": 0.02663977103686193, "entropy": 21.17888417850841, "entropy_coeff": 0.005765816666666667}, "model": {}, "num_grad_updates_lifetime": 19525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2556148, "num_env_steps_trained": 2556148, "num_agent_steps_sampled": 2556148, "num_agent_steps_trained": 2556148}, "sampler_results": {"episode_reward_max": 10.950853290237811, "episode_reward_min": -1.9102088003417512, "episode_reward_mean": 6.222838615328991, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.843391984380794, 4.894561443935824, 5.094515086369472, 6.452215801639129, 7.067791258191591, 6.536273616229799, 7.385978832063406, 6.555367426541239, 3.5323783014206613, 8.001154162247824, 5.923296200528692, 5.598412959247121, 5.577726459031068, 4.5184166971656445, 7.085141253246036, 4.738399997221001, 6.920622317237694, 5.707622456860967, 5.374673397383397, 8.09707048035287, 7.6715591684502655, 5.476120441448986, 6.616471833915727, 4.234197962611504, 3.782026533718167, 3.5171825219490533, 6.977069486559453, 8.954499531346194, 4.441299705478245, 6.111198627768843, 5.054047245699861, 6.468917520843244, 6.900515548339175, 4.305636584961004, 6.46195972313696, 7.950633050839175, 8.31217938442472, 7.214630562191875, 8.695039063201811, 3.2250455941340865, 8.030007961229074, 6.569273389799968, 3.2323197208254157, 6.654254154212093, 6.344609553739686, 3.5764879889747334, -1.9102088003417512, 5.042545216557136, 8.270607265659315, 7.618401918944555, 7.589237094446259, 4.31522319109904, 6.821403837564319, 9.841676749566247, 8.930297072859595, 4.744457188232368, 5.991855403830712, 7.738959351837679, 9.339794102098713, 4.886174217929147, 8.322636871217213, 6.99366940550196, 6.76969274132237, 4.0178808245903905, 5.818373557654879, 7.93908653464929, 3.9862194533034905, 4.693602217134478, 7.22096749012498, 5.209604436617099, 9.802816398553716, 5.499518432306614, 4.175180364047572, 6.642220219569313, 6.642722409796515, 7.593029647320572, 5.975649810691008, 5.457302152322953, 5.58731587527725, 6.091565416850834, 8.574995946981979, 4.746862448984855, 7.888968975887409, 7.838398488234611, 4.155027739664188, 2.3233487724452977, 8.006774650067515, 7.693682249557535, 5.026338901549641, 3.5422953863700273, 7.785781974865556, 6.60273739519073, 5.2794172927525524, 7.734375761225859, 6.655034692509403, 7.793477287505097, 10.950853290237811, 5.119763848967859, 5.823699972509522, 8.400355397162203], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5726944213696457, "mean_inference_ms": 6.848369515390324, "mean_action_processing_ms": 0.5475285077978097, "mean_env_wait_ms": 25.055662192798067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399611473083496, "StateBufferConnector_ms": 0.019063949584960938, "ViewRequirementAgentConnector_ms": 0.615959882736206}}, "episode_reward_max": 10.950853290237811, "episode_reward_min": -1.9102088003417512, "episode_reward_mean": 6.222838615328991, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.843391984380794, 4.894561443935824, 5.094515086369472, 6.452215801639129, 7.067791258191591, 6.536273616229799, 7.385978832063406, 6.555367426541239, 3.5323783014206613, 8.001154162247824, 5.923296200528692, 5.598412959247121, 5.577726459031068, 4.5184166971656445, 7.085141253246036, 4.738399997221001, 6.920622317237694, 5.707622456860967, 5.374673397383397, 8.09707048035287, 7.6715591684502655, 5.476120441448986, 6.616471833915727, 4.234197962611504, 3.782026533718167, 3.5171825219490533, 6.977069486559453, 8.954499531346194, 4.441299705478245, 6.111198627768843, 5.054047245699861, 6.468917520843244, 6.900515548339175, 4.305636584961004, 6.46195972313696, 7.950633050839175, 8.31217938442472, 7.214630562191875, 8.695039063201811, 3.2250455941340865, 8.030007961229074, 6.569273389799968, 3.2323197208254157, 6.654254154212093, 6.344609553739686, 3.5764879889747334, -1.9102088003417512, 5.042545216557136, 8.270607265659315, 7.618401918944555, 7.589237094446259, 4.31522319109904, 6.821403837564319, 9.841676749566247, 8.930297072859595, 4.744457188232368, 5.991855403830712, 7.738959351837679, 9.339794102098713, 4.886174217929147, 8.322636871217213, 6.99366940550196, 6.76969274132237, 4.0178808245903905, 5.818373557654879, 7.93908653464929, 3.9862194533034905, 4.693602217134478, 7.22096749012498, 5.209604436617099, 9.802816398553716, 5.499518432306614, 4.175180364047572, 6.642220219569313, 6.642722409796515, 7.593029647320572, 5.975649810691008, 5.457302152322953, 5.58731587527725, 6.091565416850834, 8.574995946981979, 4.746862448984855, 7.888968975887409, 7.838398488234611, 4.155027739664188, 2.3233487724452977, 8.006774650067515, 7.693682249557535, 5.026338901549641, 3.5422953863700273, 7.785781974865556, 6.60273739519073, 5.2794172927525524, 7.734375761225859, 6.655034692509403, 7.793477287505097, 10.950853290237811, 5.119763848967859, 5.823699972509522, 8.400355397162203], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5726944213696457, "mean_inference_ms": 6.848369515390324, "mean_action_processing_ms": 0.5475285077978097, "mean_env_wait_ms": 25.055662192798067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399611473083496, "StateBufferConnector_ms": 0.019063949584960938, "ViewRequirementAgentConnector_ms": 0.615959882736206}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2556148, "num_agent_steps_trained": 2556148, "num_env_steps_sampled": 2556148, "num_env_steps_trained": 2556148, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 301.0015099104079, "num_env_steps_trained_throughput_per_sec": 301.0015099104079, "timesteps_total": 2556148, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2556148, "timers": {"training_iteration_time_ms": 51945.333, "sample_time_ms": 39823.07, "load_time_ms": 606.848, "load_throughput": 25769.205, "learn_time_ms": 11165.964, "learn_throughput": 1400.506, "synch_weights_time_ms": 327.66}, "counters": {"num_env_steps_sampled": 2556148, "num_env_steps_trained": 2556148, "num_agent_steps_sampled": 2556148, "num_agent_steps_trained": 2556148}, "done": false, "episodes_total": 504, "training_iteration": 168, "trial_id": "c5092_00000", "date": "2025-06-08_10-12-07", "timestamp": 1749370327, "time_this_iter_s": 51.968894243240356, "time_total_s": 1874.4694867134094, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1874.4694867134094, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 79.25333333333334, "ram_util_percent": 60.289999999999985, "gpu_util_percent0": 0.07833333333333334, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.443852e-05, "total_loss": -0.14945968954083086, "policy_loss": -0.033522950063660656, "vf_loss": 0.012183683564971116, "vf_explained_var": 0.7348323182626204, "kl": 0.026552250511092345, "entropy": 21.201638296300715, "entropy_coeff": 0.0057397533333333325}, "model": {}, "num_grad_updates_lifetime": 20075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2571786, "num_env_steps_trained": 2571786, "num_agent_steps_sampled": 2571786, "num_agent_steps_trained": 2571786}, "sampler_results": {"episode_reward_max": 10.950853290237811, "episode_reward_min": -1.9102088003417512, "episode_reward_mean": 6.220323269681126, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.085141253246036, 4.738399997221001, 6.920622317237694, 5.707622456860967, 5.374673397383397, 8.09707048035287, 7.6715591684502655, 5.476120441448986, 6.616471833915727, 4.234197962611504, 3.782026533718167, 3.5171825219490533, 6.977069486559453, 8.954499531346194, 4.441299705478245, 6.111198627768843, 5.054047245699861, 6.468917520843244, 6.900515548339175, 4.305636584961004, 6.46195972313696, 7.950633050839175, 8.31217938442472, 7.214630562191875, 8.695039063201811, 3.2250455941340865, 8.030007961229074, 6.569273389799968, 3.2323197208254157, 6.654254154212093, 6.344609553739686, 3.5764879889747334, -1.9102088003417512, 5.042545216557136, 8.270607265659315, 7.618401918944555, 7.589237094446259, 4.31522319109904, 6.821403837564319, 9.841676749566247, 8.930297072859595, 4.744457188232368, 5.991855403830712, 7.738959351837679, 9.339794102098713, 4.886174217929147, 8.322636871217213, 6.99366940550196, 6.76969274132237, 4.0178808245903905, 5.818373557654879, 7.93908653464929, 3.9862194533034905, 4.693602217134478, 7.22096749012498, 5.209604436617099, 9.802816398553716, 5.499518432306614, 4.175180364047572, 6.642220219569313, 6.642722409796515, 7.593029647320572, 5.975649810691008, 5.457302152322953, 5.58731587527725, 6.091565416850834, 8.574995946981979, 4.746862448984855, 7.888968975887409, 7.838398488234611, 4.155027739664188, 2.3233487724452977, 8.006774650067515, 7.693682249557535, 5.026338901549641, 3.5422953863700273, 7.785781974865556, 6.60273739519073, 5.2794172927525524, 7.734375761225859, 6.655034692509403, 7.793477287505097, 10.950853290237811, 5.119763848967859, 5.823699972509522, 8.400355397162203, 9.886022411121347, 4.960926464336002, 1.9328854098348969, 3.296463889520876, 5.304910635456602, 8.28634152084409, 5.4349527091258905, 7.403620568293353, 9.591989733538279, 4.697233660865034, 6.813949248545595, 1.5912659440079695, 5.976849735169872, 6.552533733546005], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5731307419472627, "mean_inference_ms": 6.8543413792873915, "mean_action_processing_ms": 0.5482264912055649, "mean_env_wait_ms": 25.08153615498809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024983882904052734, "StateBufferConnector_ms": 0.019049882888793945, "ViewRequirementAgentConnector_ms": 0.6319911479949951}}, "episode_reward_max": 10.950853290237811, "episode_reward_min": -1.9102088003417512, "episode_reward_mean": 6.220323269681126, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.085141253246036, 4.738399997221001, 6.920622317237694, 5.707622456860967, 5.374673397383397, 8.09707048035287, 7.6715591684502655, 5.476120441448986, 6.616471833915727, 4.234197962611504, 3.782026533718167, 3.5171825219490533, 6.977069486559453, 8.954499531346194, 4.441299705478245, 6.111198627768843, 5.054047245699861, 6.468917520843244, 6.900515548339175, 4.305636584961004, 6.46195972313696, 7.950633050839175, 8.31217938442472, 7.214630562191875, 8.695039063201811, 3.2250455941340865, 8.030007961229074, 6.569273389799968, 3.2323197208254157, 6.654254154212093, 6.344609553739686, 3.5764879889747334, -1.9102088003417512, 5.042545216557136, 8.270607265659315, 7.618401918944555, 7.589237094446259, 4.31522319109904, 6.821403837564319, 9.841676749566247, 8.930297072859595, 4.744457188232368, 5.991855403830712, 7.738959351837679, 9.339794102098713, 4.886174217929147, 8.322636871217213, 6.99366940550196, 6.76969274132237, 4.0178808245903905, 5.818373557654879, 7.93908653464929, 3.9862194533034905, 4.693602217134478, 7.22096749012498, 5.209604436617099, 9.802816398553716, 5.499518432306614, 4.175180364047572, 6.642220219569313, 6.642722409796515, 7.593029647320572, 5.975649810691008, 5.457302152322953, 5.58731587527725, 6.091565416850834, 8.574995946981979, 4.746862448984855, 7.888968975887409, 7.838398488234611, 4.155027739664188, 2.3233487724452977, 8.006774650067515, 7.693682249557535, 5.026338901549641, 3.5422953863700273, 7.785781974865556, 6.60273739519073, 5.2794172927525524, 7.734375761225859, 6.655034692509403, 7.793477287505097, 10.950853290237811, 5.119763848967859, 5.823699972509522, 8.400355397162203, 9.886022411121347, 4.960926464336002, 1.9328854098348969, 3.296463889520876, 5.304910635456602, 8.28634152084409, 5.4349527091258905, 7.403620568293353, 9.591989733538279, 4.697233660865034, 6.813949248545595, 1.5912659440079695, 5.976849735169872, 6.552533733546005], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5731307419472627, "mean_inference_ms": 6.8543413792873915, "mean_action_processing_ms": 0.5482264912055649, "mean_env_wait_ms": 25.08153615498809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024983882904052734, "StateBufferConnector_ms": 0.019049882888793945, "ViewRequirementAgentConnector_ms": 0.6319911479949951}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2571786, "num_agent_steps_trained": 2571786, "num_env_steps_sampled": 2571786, "num_env_steps_trained": 2571786, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 299.6008254208335, "num_env_steps_trained_throughput_per_sec": 299.6008254208335, "timesteps_total": 2571786, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2571786, "timers": {"training_iteration_time_ms": 51985.75, "sample_time_ms": 39886.959, "load_time_ms": 609.809, "load_throughput": 25644.083, "learn_time_ms": 11141.22, "learn_throughput": 1403.617, "synch_weights_time_ms": 325.361}, "counters": {"num_env_steps_sampled": 2571786, "num_env_steps_trained": 2571786, "num_agent_steps_sampled": 2571786, "num_agent_steps_trained": 2571786}, "done": false, "episodes_total": 518, "training_iteration": 169, "trial_id": "c5092_00000", "date": "2025-06-08_10-12-59", "timestamp": 1749370379, "time_this_iter_s": 52.2312068939209, "time_total_s": 1926.7006936073303, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1926.7006936073303, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 78.76557377049178, "ram_util_percent": 60.32622950819672, "gpu_util_percent0": 0.08754098360655738, "vram_util_percent0": 0.18831380208333337}}
{"evaluation": {"sampler_results": {"episode_reward_max": -0.03863417758965032, "episode_reward_min": -6.553839089637916, "episode_reward_mean": -3.2927787141966776, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.46280781750178973, -5.22797829128838, -4.180634194965651, -0.03863417758965032, -6.553839089637916], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.193105428194182, "mean_inference_ms": 3.3504665060152354, "mean_action_processing_ms": 0.26049948802900236, "mean_env_wait_ms": 10.638972437115681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1354694366455078}}, "episode_reward_max": -0.03863417758965032, "episode_reward_min": -6.553839089637916, "episode_reward_mean": -3.2927787141966776, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.46280781750178973, -5.22797829128838, -4.180634194965651, -0.03863417758965032, -6.553839089637916], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.193105428194182, "mean_inference_ms": 3.3504665060152354, "mean_action_processing_ms": 0.26049948802900236, "mean_env_wait_ms": 10.638972437115681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1354694366455078}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.428214e-05, "total_loss": -0.15062305540195667, "policy_loss": -0.03569323546020314, "vf_loss": 0.012124840099025857, "vf_explained_var": 0.7505381383679129, "kl": 0.028192439383049283, "entropy": 21.141737957000732, "entropy_coeff": 0.0057136900000000004}, "model": {}, "num_grad_updates_lifetime": 20625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2587424, "num_env_steps_trained": 2587424, "num_agent_steps_sampled": 2587424, "num_agent_steps_trained": 2587424}, "sampler_results": {"episode_reward_max": 10.950853290237811, "episode_reward_min": -1.9102088003417512, "episode_reward_mean": 6.340303970615025, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.441299705478245, 6.111198627768843, 5.054047245699861, 6.468917520843244, 6.900515548339175, 4.305636584961004, 6.46195972313696, 7.950633050839175, 8.31217938442472, 7.214630562191875, 8.695039063201811, 3.2250455941340865, 8.030007961229074, 6.569273389799968, 3.2323197208254157, 6.654254154212093, 6.344609553739686, 3.5764879889747334, -1.9102088003417512, 5.042545216557136, 8.270607265659315, 7.618401918944555, 7.589237094446259, 4.31522319109904, 6.821403837564319, 9.841676749566247, 8.930297072859595, 4.744457188232368, 5.991855403830712, 7.738959351837679, 9.339794102098713, 4.886174217929147, 8.322636871217213, 6.99366940550196, 6.76969274132237, 4.0178808245903905, 5.818373557654879, 7.93908653464929, 3.9862194533034905, 4.693602217134478, 7.22096749012498, 5.209604436617099, 9.802816398553716, 5.499518432306614, 4.175180364047572, 6.642220219569313, 6.642722409796515, 7.593029647320572, 5.975649810691008, 5.457302152322953, 5.58731587527725, 6.091565416850834, 8.574995946981979, 4.746862448984855, 7.888968975887409, 7.838398488234611, 4.155027739664188, 2.3233487724452977, 8.006774650067515, 7.693682249557535, 5.026338901549641, 3.5422953863700273, 7.785781974865556, 6.60273739519073, 5.2794172927525524, 7.734375761225859, 6.655034692509403, 7.793477287505097, 10.950853290237811, 5.119763848967859, 5.823699972509522, 8.400355397162203, 9.886022411121347, 4.960926464336002, 1.9328854098348969, 3.296463889520876, 5.304910635456602, 8.28634152084409, 5.4349527091258905, 7.403620568293353, 9.591989733538279, 4.697233660865034, 6.813949248545595, 1.5912659440079695, 5.976849735169872, 6.552533733546005, 6.762887496013998, 5.718845139023541, 4.080465721805531, 5.444247924604826, 3.2810456974531172, 7.74301685920689, 8.339555871119348, 10.33034971486679, 10.039632735357069, 8.104412145688583, 6.010300628243614, 5.509144434491678, 7.506929167804515, 8.279893940011766], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5737664432955123, "mean_inference_ms": 6.860270702669138, "mean_action_processing_ms": 0.5489016597116219, "mean_env_wait_ms": 25.106628092892237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022103071212768555, "StateBufferConnector_ms": 0.021030664443969727, "ViewRequirementAgentConnector_ms": 0.6310334205627441}}, "episode_reward_max": 10.950853290237811, "episode_reward_min": -1.9102088003417512, "episode_reward_mean": 6.340303970615025, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.441299705478245, 6.111198627768843, 5.054047245699861, 6.468917520843244, 6.900515548339175, 4.305636584961004, 6.46195972313696, 7.950633050839175, 8.31217938442472, 7.214630562191875, 8.695039063201811, 3.2250455941340865, 8.030007961229074, 6.569273389799968, 3.2323197208254157, 6.654254154212093, 6.344609553739686, 3.5764879889747334, -1.9102088003417512, 5.042545216557136, 8.270607265659315, 7.618401918944555, 7.589237094446259, 4.31522319109904, 6.821403837564319, 9.841676749566247, 8.930297072859595, 4.744457188232368, 5.991855403830712, 7.738959351837679, 9.339794102098713, 4.886174217929147, 8.322636871217213, 6.99366940550196, 6.76969274132237, 4.0178808245903905, 5.818373557654879, 7.93908653464929, 3.9862194533034905, 4.693602217134478, 7.22096749012498, 5.209604436617099, 9.802816398553716, 5.499518432306614, 4.175180364047572, 6.642220219569313, 6.642722409796515, 7.593029647320572, 5.975649810691008, 5.457302152322953, 5.58731587527725, 6.091565416850834, 8.574995946981979, 4.746862448984855, 7.888968975887409, 7.838398488234611, 4.155027739664188, 2.3233487724452977, 8.006774650067515, 7.693682249557535, 5.026338901549641, 3.5422953863700273, 7.785781974865556, 6.60273739519073, 5.2794172927525524, 7.734375761225859, 6.655034692509403, 7.793477287505097, 10.950853290237811, 5.119763848967859, 5.823699972509522, 8.400355397162203, 9.886022411121347, 4.960926464336002, 1.9328854098348969, 3.296463889520876, 5.304910635456602, 8.28634152084409, 5.4349527091258905, 7.403620568293353, 9.591989733538279, 4.697233660865034, 6.813949248545595, 1.5912659440079695, 5.976849735169872, 6.552533733546005, 6.762887496013998, 5.718845139023541, 4.080465721805531, 5.444247924604826, 3.2810456974531172, 7.74301685920689, 8.339555871119348, 10.33034971486679, 10.039632735357069, 8.104412145688583, 6.010300628243614, 5.509144434491678, 7.506929167804515, 8.279893940011766], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5737664432955123, "mean_inference_ms": 6.860270702669138, "mean_action_processing_ms": 0.5489016597116219, "mean_env_wait_ms": 25.106628092892237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022103071212768555, "StateBufferConnector_ms": 0.021030664443969727, "ViewRequirementAgentConnector_ms": 0.6310334205627441}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2587424, "num_agent_steps_trained": 2587424, "num_env_steps_sampled": 2587424, "num_env_steps_trained": 2587424, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 298.5066461295984, "num_env_steps_trained_throughput_per_sec": 298.5066461295984, "timesteps_total": 2587424, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2587424, "timers": {"training_iteration_time_ms": 52060.359, "sample_time_ms": 39970.373, "load_time_ms": 612.998, "load_throughput": 25510.676, "learn_time_ms": 11126.937, "learn_throughput": 1405.418, "synch_weights_time_ms": 326.954}, "counters": {"num_env_steps_sampled": 2587424, "num_env_steps_trained": 2587424, "num_agent_steps_sampled": 2587424, "num_agent_steps_trained": 2587424}, "done": false, "episodes_total": 532, "training_iteration": 170, "trial_id": "c5092_00000", "date": "2025-06-08_10-14-06", "timestamp": 1749370446, "time_this_iter_s": 66.62730741500854, "time_total_s": 1993.3280010223389, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1993.3280010223389, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 67.5207792207792, "ram_util_percent": 60.2935064935065, "gpu_util_percent0": 0.06493506493506493, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.412575999999998e-05, "total_loss": -0.14005905527325177, "policy_loss": -0.025686783732486552, "vf_loss": 0.012321198281662707, "vf_explained_var": 0.7582959580421448, "kl": 0.02822402770321607, "entropy": 21.15138780073686, "entropy_coeff": 0.005687626666666667}, "model": {}, "num_grad_updates_lifetime": 21175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2603062, "num_env_steps_trained": 2603062, "num_agent_steps_sampled": 2603062, "num_agent_steps_trained": 2603062}, "sampler_results": {"episode_reward_max": 10.950853290237811, "episode_reward_min": -1.9102088003417512, "episode_reward_mean": 6.307869790230546, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.2323197208254157, 6.654254154212093, 6.344609553739686, 3.5764879889747334, -1.9102088003417512, 5.042545216557136, 8.270607265659315, 7.618401918944555, 7.589237094446259, 4.31522319109904, 6.821403837564319, 9.841676749566247, 8.930297072859595, 4.744457188232368, 5.991855403830712, 7.738959351837679, 9.339794102098713, 4.886174217929147, 8.322636871217213, 6.99366940550196, 6.76969274132237, 4.0178808245903905, 5.818373557654879, 7.93908653464929, 3.9862194533034905, 4.693602217134478, 7.22096749012498, 5.209604436617099, 9.802816398553716, 5.499518432306614, 4.175180364047572, 6.642220219569313, 6.642722409796515, 7.593029647320572, 5.975649810691008, 5.457302152322953, 5.58731587527725, 6.091565416850834, 8.574995946981979, 4.746862448984855, 7.888968975887409, 7.838398488234611, 4.155027739664188, 2.3233487724452977, 8.006774650067515, 7.693682249557535, 5.026338901549641, 3.5422953863700273, 7.785781974865556, 6.60273739519073, 5.2794172927525524, 7.734375761225859, 6.655034692509403, 7.793477287505097, 10.950853290237811, 5.119763848967859, 5.823699972509522, 8.400355397162203, 9.886022411121347, 4.960926464336002, 1.9328854098348969, 3.296463889520876, 5.304910635456602, 8.28634152084409, 5.4349527091258905, 7.403620568293353, 9.591989733538279, 4.697233660865034, 6.813949248545595, 1.5912659440079695, 5.976849735169872, 6.552533733546005, 6.762887496013998, 5.718845139023541, 4.080465721805531, 5.444247924604826, 3.2810456974531172, 7.74301685920689, 8.339555871119348, 10.33034971486679, 10.039632735357069, 8.104412145688583, 6.010300628243614, 5.509144434491678, 7.506929167804515, 8.279893940011766, 5.068910881178041, 3.5924980828011908, 6.035827583372805, 6.625453681864411, 6.274818809950948, 5.20080380046533, 5.49940950733804, 2.7038454832924694, 9.676151666590615, 7.112949591435794, 5.58724728354506, 7.180231888795586, 8.77083041222419, 7.167987250745733], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5743060651891205, "mean_inference_ms": 6.866274237947774, "mean_action_processing_ms": 0.549558958252463, "mean_env_wait_ms": 25.132067596272922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025086164474487305, "StateBufferConnector_ms": 0.023042678833007812, "ViewRequirementAgentConnector_ms": 0.6576035022735596}}, "episode_reward_max": 10.950853290237811, "episode_reward_min": -1.9102088003417512, "episode_reward_mean": 6.307869790230546, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.2323197208254157, 6.654254154212093, 6.344609553739686, 3.5764879889747334, -1.9102088003417512, 5.042545216557136, 8.270607265659315, 7.618401918944555, 7.589237094446259, 4.31522319109904, 6.821403837564319, 9.841676749566247, 8.930297072859595, 4.744457188232368, 5.991855403830712, 7.738959351837679, 9.339794102098713, 4.886174217929147, 8.322636871217213, 6.99366940550196, 6.76969274132237, 4.0178808245903905, 5.818373557654879, 7.93908653464929, 3.9862194533034905, 4.693602217134478, 7.22096749012498, 5.209604436617099, 9.802816398553716, 5.499518432306614, 4.175180364047572, 6.642220219569313, 6.642722409796515, 7.593029647320572, 5.975649810691008, 5.457302152322953, 5.58731587527725, 6.091565416850834, 8.574995946981979, 4.746862448984855, 7.888968975887409, 7.838398488234611, 4.155027739664188, 2.3233487724452977, 8.006774650067515, 7.693682249557535, 5.026338901549641, 3.5422953863700273, 7.785781974865556, 6.60273739519073, 5.2794172927525524, 7.734375761225859, 6.655034692509403, 7.793477287505097, 10.950853290237811, 5.119763848967859, 5.823699972509522, 8.400355397162203, 9.886022411121347, 4.960926464336002, 1.9328854098348969, 3.296463889520876, 5.304910635456602, 8.28634152084409, 5.4349527091258905, 7.403620568293353, 9.591989733538279, 4.697233660865034, 6.813949248545595, 1.5912659440079695, 5.976849735169872, 6.552533733546005, 6.762887496013998, 5.718845139023541, 4.080465721805531, 5.444247924604826, 3.2810456974531172, 7.74301685920689, 8.339555871119348, 10.33034971486679, 10.039632735357069, 8.104412145688583, 6.010300628243614, 5.509144434491678, 7.506929167804515, 8.279893940011766, 5.068910881178041, 3.5924980828011908, 6.035827583372805, 6.625453681864411, 6.274818809950948, 5.20080380046533, 5.49940950733804, 2.7038454832924694, 9.676151666590615, 7.112949591435794, 5.58724728354506, 7.180231888795586, 8.77083041222419, 7.167987250745733], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5743060651891205, "mean_inference_ms": 6.866274237947774, "mean_action_processing_ms": 0.549558958252463, "mean_env_wait_ms": 25.132067596272922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025086164474487305, "StateBufferConnector_ms": 0.023042678833007812, "ViewRequirementAgentConnector_ms": 0.6576035022735596}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2603062, "num_agent_steps_trained": 2603062, "num_env_steps_sampled": 2603062, "num_env_steps_trained": 2603062, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 298.6283052098129, "num_env_steps_trained_throughput_per_sec": 298.6283052098129, "timesteps_total": 2603062, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2603062, "timers": {"training_iteration_time_ms": 52136.163, "sample_time_ms": 40058.249, "load_time_ms": 619.853, "load_throughput": 25228.555, "learn_time_ms": 11103.697, "learn_throughput": 1408.36, "synch_weights_time_ms": 330.087}, "counters": {"num_env_steps_sampled": 2603062, "num_env_steps_trained": 2603062, "num_agent_steps_sampled": 2603062, "num_agent_steps_trained": 2603062}, "done": false, "episodes_total": 546, "training_iteration": 171, "trial_id": "c5092_00000", "date": "2025-06-08_10-14-59", "timestamp": 1749370499, "time_this_iter_s": 52.37314224243164, "time_total_s": 2045.7011432647705, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2045.7011432647705, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 78.80327868852459, "ram_util_percent": 60.44754098360657, "gpu_util_percent0": 0.07967213114754097, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.396938000000001e-05, "total_loss": -0.15034651220299897, "policy_loss": -0.036163773588010706, "vf_loss": 0.011726647290316495, "vf_explained_var": 0.7412944753603502, "kl": 0.02604637366116447, "entropy": 21.15335127223622, "entropy_coeff": 0.005661563333333334}, "model": {}, "num_grad_updates_lifetime": 21725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2618700, "num_env_steps_trained": 2618700, "num_agent_steps_sampled": 2618700, "num_agent_steps_trained": 2618700}, "sampler_results": {"episode_reward_max": 10.950853290237811, "episode_reward_min": 1.5912659440079695, "episode_reward_mean": 6.415996650111423, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.991855403830712, 7.738959351837679, 9.339794102098713, 4.886174217929147, 8.322636871217213, 6.99366940550196, 6.76969274132237, 4.0178808245903905, 5.818373557654879, 7.93908653464929, 3.9862194533034905, 4.693602217134478, 7.22096749012498, 5.209604436617099, 9.802816398553716, 5.499518432306614, 4.175180364047572, 6.642220219569313, 6.642722409796515, 7.593029647320572, 5.975649810691008, 5.457302152322953, 5.58731587527725, 6.091565416850834, 8.574995946981979, 4.746862448984855, 7.888968975887409, 7.838398488234611, 4.155027739664188, 2.3233487724452977, 8.006774650067515, 7.693682249557535, 5.026338901549641, 3.5422953863700273, 7.785781974865556, 6.60273739519073, 5.2794172927525524, 7.734375761225859, 6.655034692509403, 7.793477287505097, 10.950853290237811, 5.119763848967859, 5.823699972509522, 8.400355397162203, 9.886022411121347, 4.960926464336002, 1.9328854098348969, 3.296463889520876, 5.304910635456602, 8.28634152084409, 5.4349527091258905, 7.403620568293353, 9.591989733538279, 4.697233660865034, 6.813949248545595, 1.5912659440079695, 5.976849735169872, 6.552533733546005, 6.762887496013998, 5.718845139023541, 4.080465721805531, 5.444247924604826, 3.2810456974531172, 7.74301685920689, 8.339555871119348, 10.33034971486679, 10.039632735357069, 8.104412145688583, 6.010300628243614, 5.509144434491678, 7.506929167804515, 8.279893940011766, 5.068910881178041, 3.5924980828011908, 6.035827583372805, 6.625453681864411, 6.274818809950948, 5.20080380046533, 5.49940950733804, 2.7038454832924694, 9.676151666590615, 7.112949591435794, 5.58724728354506, 7.180231888795586, 8.77083041222419, 7.167987250745733, 7.036015316118383, 9.639218104116583, 8.654186424860915, 4.498941336429941, 7.437990347115195, 1.60825825189038, 4.429381582931218, 5.117099768888129, 7.568109810607887, 8.727125346160992, 7.648080214020983, 5.267102601747326, 7.844717050006672, 6.407771985532078], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5746607859526518, "mean_inference_ms": 6.8722916975615576, "mean_action_processing_ms": 0.5501995451415865, "mean_env_wait_ms": 25.156602425127847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028617382049560547, "StateBufferConnector_ms": 0.018019437789916992, "ViewRequirementAgentConnector_ms": 0.6633467674255371}}, "episode_reward_max": 10.950853290237811, "episode_reward_min": 1.5912659440079695, "episode_reward_mean": 6.415996650111423, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.991855403830712, 7.738959351837679, 9.339794102098713, 4.886174217929147, 8.322636871217213, 6.99366940550196, 6.76969274132237, 4.0178808245903905, 5.818373557654879, 7.93908653464929, 3.9862194533034905, 4.693602217134478, 7.22096749012498, 5.209604436617099, 9.802816398553716, 5.499518432306614, 4.175180364047572, 6.642220219569313, 6.642722409796515, 7.593029647320572, 5.975649810691008, 5.457302152322953, 5.58731587527725, 6.091565416850834, 8.574995946981979, 4.746862448984855, 7.888968975887409, 7.838398488234611, 4.155027739664188, 2.3233487724452977, 8.006774650067515, 7.693682249557535, 5.026338901549641, 3.5422953863700273, 7.785781974865556, 6.60273739519073, 5.2794172927525524, 7.734375761225859, 6.655034692509403, 7.793477287505097, 10.950853290237811, 5.119763848967859, 5.823699972509522, 8.400355397162203, 9.886022411121347, 4.960926464336002, 1.9328854098348969, 3.296463889520876, 5.304910635456602, 8.28634152084409, 5.4349527091258905, 7.403620568293353, 9.591989733538279, 4.697233660865034, 6.813949248545595, 1.5912659440079695, 5.976849735169872, 6.552533733546005, 6.762887496013998, 5.718845139023541, 4.080465721805531, 5.444247924604826, 3.2810456974531172, 7.74301685920689, 8.339555871119348, 10.33034971486679, 10.039632735357069, 8.104412145688583, 6.010300628243614, 5.509144434491678, 7.506929167804515, 8.279893940011766, 5.068910881178041, 3.5924980828011908, 6.035827583372805, 6.625453681864411, 6.274818809950948, 5.20080380046533, 5.49940950733804, 2.7038454832924694, 9.676151666590615, 7.112949591435794, 5.58724728354506, 7.180231888795586, 8.77083041222419, 7.167987250745733, 7.036015316118383, 9.639218104116583, 8.654186424860915, 4.498941336429941, 7.437990347115195, 1.60825825189038, 4.429381582931218, 5.117099768888129, 7.568109810607887, 8.727125346160992, 7.648080214020983, 5.267102601747326, 7.844717050006672, 6.407771985532078], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5746607859526518, "mean_inference_ms": 6.8722916975615576, "mean_action_processing_ms": 0.5501995451415865, "mean_env_wait_ms": 25.156602425127847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028617382049560547, "StateBufferConnector_ms": 0.018019437789916992, "ViewRequirementAgentConnector_ms": 0.6633467674255371}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2618700, "num_agent_steps_trained": 2618700, "num_env_steps_sampled": 2618700, "num_env_steps_trained": 2618700, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 297.7606781200603, "num_env_steps_trained_throughput_per_sec": 297.7606781200603, "timesteps_total": 2618700, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2618700, "timers": {"training_iteration_time_ms": 52149.854, "sample_time_ms": 40078.623, "load_time_ms": 615.442, "load_throughput": 25409.399, "learn_time_ms": 11103.081, "learn_throughput": 1408.438, "synch_weights_time_ms": 328.003}, "counters": {"num_env_steps_sampled": 2618700, "num_env_steps_trained": 2618700, "num_agent_steps_sampled": 2618700, "num_agent_steps_trained": 2618700}, "done": false, "episodes_total": 560, "training_iteration": 172, "trial_id": "c5092_00000", "date": "2025-06-08_10-15-51", "timestamp": 1749370551, "time_this_iter_s": 52.53166913986206, "time_total_s": 2098.2328124046326, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2098.2328124046326, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 80.24500000000002, "ram_util_percent": 60.46000000000002, "gpu_util_percent0": 0.0805, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.3813e-05, "total_loss": -0.13855249565518038, "policy_loss": -0.025210602519959633, "vf_loss": 0.012101773827929388, "vf_explained_var": 0.775153099081733, "kl": 0.027359396540453995, "entropy": 21.140377381064674, "entropy_coeff": 0.005635500000000002}, "model": {}, "num_grad_updates_lifetime": 22275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2634338, "num_env_steps_trained": 2634338, "num_agent_steps_sampled": 2634338, "num_agent_steps_trained": 2634338}, "sampler_results": {"episode_reward_max": 10.950853290237811, "episode_reward_min": 1.5912659440079695, "episode_reward_mean": 6.5464976056886925, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.802816398553716, 5.499518432306614, 4.175180364047572, 6.642220219569313, 6.642722409796515, 7.593029647320572, 5.975649810691008, 5.457302152322953, 5.58731587527725, 6.091565416850834, 8.574995946981979, 4.746862448984855, 7.888968975887409, 7.838398488234611, 4.155027739664188, 2.3233487724452977, 8.006774650067515, 7.693682249557535, 5.026338901549641, 3.5422953863700273, 7.785781974865556, 6.60273739519073, 5.2794172927525524, 7.734375761225859, 6.655034692509403, 7.793477287505097, 10.950853290237811, 5.119763848967859, 5.823699972509522, 8.400355397162203, 9.886022411121347, 4.960926464336002, 1.9328854098348969, 3.296463889520876, 5.304910635456602, 8.28634152084409, 5.4349527091258905, 7.403620568293353, 9.591989733538279, 4.697233660865034, 6.813949248545595, 1.5912659440079695, 5.976849735169872, 6.552533733546005, 6.762887496013998, 5.718845139023541, 4.080465721805531, 5.444247924604826, 3.2810456974531172, 7.74301685920689, 8.339555871119348, 10.33034971486679, 10.039632735357069, 8.104412145688583, 6.010300628243614, 5.509144434491678, 7.506929167804515, 8.279893940011766, 5.068910881178041, 3.5924980828011908, 6.035827583372805, 6.625453681864411, 6.274818809950948, 5.20080380046533, 5.49940950733804, 2.7038454832924694, 9.676151666590615, 7.112949591435794, 5.58724728354506, 7.180231888795586, 8.77083041222419, 7.167987250745733, 7.036015316118383, 9.639218104116583, 8.654186424860915, 4.498941336429941, 7.437990347115195, 1.60825825189038, 4.429381582931218, 5.117099768888129, 7.568109810607887, 8.727125346160992, 7.648080214020983, 5.267102601747326, 7.844717050006672, 6.407771985532078, 8.286425677428104, 8.945666864840314, 8.67767026120606, 5.593320056336561, 10.069023601024906, 4.364531446535536, 8.226969033837515, 5.50076203793335, 8.560774019633318, 8.280977772356, 8.904929331662053, 7.577132828742305, 5.554459901358, 3.4359693326452705], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5749564059886973, "mean_inference_ms": 6.877750184299214, "mean_action_processing_ms": 0.5507657868868435, "mean_env_wait_ms": 25.179500736132706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0295867919921875, "StateBufferConnector_ms": 0.016986846923828125, "ViewRequirementAgentConnector_ms": 0.651360273361206}}, "episode_reward_max": 10.950853290237811, "episode_reward_min": 1.5912659440079695, "episode_reward_mean": 6.5464976056886925, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.802816398553716, 5.499518432306614, 4.175180364047572, 6.642220219569313, 6.642722409796515, 7.593029647320572, 5.975649810691008, 5.457302152322953, 5.58731587527725, 6.091565416850834, 8.574995946981979, 4.746862448984855, 7.888968975887409, 7.838398488234611, 4.155027739664188, 2.3233487724452977, 8.006774650067515, 7.693682249557535, 5.026338901549641, 3.5422953863700273, 7.785781974865556, 6.60273739519073, 5.2794172927525524, 7.734375761225859, 6.655034692509403, 7.793477287505097, 10.950853290237811, 5.119763848967859, 5.823699972509522, 8.400355397162203, 9.886022411121347, 4.960926464336002, 1.9328854098348969, 3.296463889520876, 5.304910635456602, 8.28634152084409, 5.4349527091258905, 7.403620568293353, 9.591989733538279, 4.697233660865034, 6.813949248545595, 1.5912659440079695, 5.976849735169872, 6.552533733546005, 6.762887496013998, 5.718845139023541, 4.080465721805531, 5.444247924604826, 3.2810456974531172, 7.74301685920689, 8.339555871119348, 10.33034971486679, 10.039632735357069, 8.104412145688583, 6.010300628243614, 5.509144434491678, 7.506929167804515, 8.279893940011766, 5.068910881178041, 3.5924980828011908, 6.035827583372805, 6.625453681864411, 6.274818809950948, 5.20080380046533, 5.49940950733804, 2.7038454832924694, 9.676151666590615, 7.112949591435794, 5.58724728354506, 7.180231888795586, 8.77083041222419, 7.167987250745733, 7.036015316118383, 9.639218104116583, 8.654186424860915, 4.498941336429941, 7.437990347115195, 1.60825825189038, 4.429381582931218, 5.117099768888129, 7.568109810607887, 8.727125346160992, 7.648080214020983, 5.267102601747326, 7.844717050006672, 6.407771985532078, 8.286425677428104, 8.945666864840314, 8.67767026120606, 5.593320056336561, 10.069023601024906, 4.364531446535536, 8.226969033837515, 5.50076203793335, 8.560774019633318, 8.280977772356, 8.904929331662053, 7.577132828742305, 5.554459901358, 3.4359693326452705], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5749564059886973, "mean_inference_ms": 6.877750184299214, "mean_action_processing_ms": 0.5507657868868435, "mean_env_wait_ms": 25.179500736132706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0295867919921875, "StateBufferConnector_ms": 0.016986846923828125, "ViewRequirementAgentConnector_ms": 0.651360273361206}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2634338, "num_agent_steps_trained": 2634338, "num_env_steps_sampled": 2634338, "num_env_steps_trained": 2634338, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 302.22746468472286, "num_env_steps_trained_throughput_per_sec": 302.22746468472286, "timesteps_total": 2634338, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2634338, "timers": {"training_iteration_time_ms": 52089.382, "sample_time_ms": 40021.605, "load_time_ms": 616.76, "load_throughput": 25355.071, "learn_time_ms": 11101.523, "learn_throughput": 1408.636, "synch_weights_time_ms": 324.504}, "counters": {"num_env_steps_sampled": 2634338, "num_env_steps_trained": 2634338, "num_agent_steps_sampled": 2634338, "num_agent_steps_trained": 2634338}, "done": false, "episodes_total": 574, "training_iteration": 173, "trial_id": "c5092_00000", "date": "2025-06-08_10-16-43", "timestamp": 1749370603, "time_this_iter_s": 51.75347375869751, "time_total_s": 2149.98628616333, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2149.98628616333, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 79.20666666666668, "ram_util_percent": 60.45166666666668, "gpu_util_percent0": 0.08116666666666668, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.365661999999999e-05, "total_loss": -0.1407275140717287, "policy_loss": -0.02782954573223833, "vf_loss": 0.013103346975350922, "vf_explained_var": 0.7534971452843059, "kl": 0.026728964841381007, "entropy": 21.204138308438388, "entropy_coeff": 0.005609436666666669}, "model": {}, "num_grad_updates_lifetime": 22825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2649976, "num_env_steps_trained": 2649976, "num_agent_steps_sampled": 2649976, "num_agent_steps_trained": 2649976}, "sampler_results": {"episode_reward_max": 10.950853290237811, "episode_reward_min": 1.5912659440079695, "episode_reward_mean": 6.5609497681517315, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.155027739664188, 2.3233487724452977, 8.006774650067515, 7.693682249557535, 5.026338901549641, 3.5422953863700273, 7.785781974865556, 6.60273739519073, 5.2794172927525524, 7.734375761225859, 6.655034692509403, 7.793477287505097, 10.950853290237811, 5.119763848967859, 5.823699972509522, 8.400355397162203, 9.886022411121347, 4.960926464336002, 1.9328854098348969, 3.296463889520876, 5.304910635456602, 8.28634152084409, 5.4349527091258905, 7.403620568293353, 9.591989733538279, 4.697233660865034, 6.813949248545595, 1.5912659440079695, 5.976849735169872, 6.552533733546005, 6.762887496013998, 5.718845139023541, 4.080465721805531, 5.444247924604826, 3.2810456974531172, 7.74301685920689, 8.339555871119348, 10.33034971486679, 10.039632735357069, 8.104412145688583, 6.010300628243614, 5.509144434491678, 7.506929167804515, 8.279893940011766, 5.068910881178041, 3.5924980828011908, 6.035827583372805, 6.625453681864411, 6.274818809950948, 5.20080380046533, 5.49940950733804, 2.7038454832924694, 9.676151666590615, 7.112949591435794, 5.58724728354506, 7.180231888795586, 8.77083041222419, 7.167987250745733, 7.036015316118383, 9.639218104116583, 8.654186424860915, 4.498941336429941, 7.437990347115195, 1.60825825189038, 4.429381582931218, 5.117099768888129, 7.568109810607887, 8.727125346160992, 7.648080214020983, 5.267102601747326, 7.844717050006672, 6.407771985532078, 8.286425677428104, 8.945666864840314, 8.67767026120606, 5.593320056336561, 10.069023601024906, 4.364531446535536, 8.226969033837515, 5.50076203793335, 8.560774019633318, 8.280977772356, 8.904929331662053, 7.577132828742305, 5.554459901358, 3.4359693326452705, 8.321736331512879, 4.087237838830925, 9.147226514584972, 8.792637323471778, 4.702607000376513, 5.542430932533736, 6.630049665322046, 7.708605631761572, 4.651895071197041, 6.411539474938867, 7.3221014577279995, 7.2903645724590085, 7.116569746452186, 6.23676127195952], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.57538716305376, "mean_inference_ms": 6.882672873992114, "mean_action_processing_ms": 0.5512419580873621, "mean_env_wait_ms": 25.201907663924626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030556917190551758, "StateBufferConnector_ms": 0.016984224319458008, "ViewRequirementAgentConnector_ms": 0.6653196811676025}}, "episode_reward_max": 10.950853290237811, "episode_reward_min": 1.5912659440079695, "episode_reward_mean": 6.5609497681517315, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.155027739664188, 2.3233487724452977, 8.006774650067515, 7.693682249557535, 5.026338901549641, 3.5422953863700273, 7.785781974865556, 6.60273739519073, 5.2794172927525524, 7.734375761225859, 6.655034692509403, 7.793477287505097, 10.950853290237811, 5.119763848967859, 5.823699972509522, 8.400355397162203, 9.886022411121347, 4.960926464336002, 1.9328854098348969, 3.296463889520876, 5.304910635456602, 8.28634152084409, 5.4349527091258905, 7.403620568293353, 9.591989733538279, 4.697233660865034, 6.813949248545595, 1.5912659440079695, 5.976849735169872, 6.552533733546005, 6.762887496013998, 5.718845139023541, 4.080465721805531, 5.444247924604826, 3.2810456974531172, 7.74301685920689, 8.339555871119348, 10.33034971486679, 10.039632735357069, 8.104412145688583, 6.010300628243614, 5.509144434491678, 7.506929167804515, 8.279893940011766, 5.068910881178041, 3.5924980828011908, 6.035827583372805, 6.625453681864411, 6.274818809950948, 5.20080380046533, 5.49940950733804, 2.7038454832924694, 9.676151666590615, 7.112949591435794, 5.58724728354506, 7.180231888795586, 8.77083041222419, 7.167987250745733, 7.036015316118383, 9.639218104116583, 8.654186424860915, 4.498941336429941, 7.437990347115195, 1.60825825189038, 4.429381582931218, 5.117099768888129, 7.568109810607887, 8.727125346160992, 7.648080214020983, 5.267102601747326, 7.844717050006672, 6.407771985532078, 8.286425677428104, 8.945666864840314, 8.67767026120606, 5.593320056336561, 10.069023601024906, 4.364531446535536, 8.226969033837515, 5.50076203793335, 8.560774019633318, 8.280977772356, 8.904929331662053, 7.577132828742305, 5.554459901358, 3.4359693326452705, 8.321736331512879, 4.087237838830925, 9.147226514584972, 8.792637323471778, 4.702607000376513, 5.542430932533736, 6.630049665322046, 7.708605631761572, 4.651895071197041, 6.411539474938867, 7.3221014577279995, 7.2903645724590085, 7.116569746452186, 6.23676127195952], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.57538716305376, "mean_inference_ms": 6.882672873992114, "mean_action_processing_ms": 0.5512419580873621, "mean_env_wait_ms": 25.201907663924626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030556917190551758, "StateBufferConnector_ms": 0.016984224319458008, "ViewRequirementAgentConnector_ms": 0.6653196811676025}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2649976, "num_agent_steps_trained": 2649976, "num_env_steps_sampled": 2649976, "num_env_steps_trained": 2649976, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 299.78900970236793, "num_env_steps_trained_throughput_per_sec": 299.78900970236793, "timesteps_total": 2649976, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2649976, "timers": {"training_iteration_time_ms": 52129.176, "sample_time_ms": 40065.348, "load_time_ms": 610.086, "load_throughput": 25632.433, "learn_time_ms": 11109.95, "learn_throughput": 1407.567, "synch_weights_time_ms": 318.599}, "counters": {"num_env_steps_sampled": 2649976, "num_env_steps_trained": 2649976, "num_agent_steps_sampled": 2649976, "num_agent_steps_trained": 2649976}, "done": false, "episodes_total": 588, "training_iteration": 174, "trial_id": "c5092_00000", "date": "2025-06-08_10-17-35", "timestamp": 1749370655, "time_this_iter_s": 52.18088674545288, "time_total_s": 2202.167172908783, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2202.167172908783, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 79.24166666666666, "ram_util_percent": 60.51999999999999, "gpu_util_percent0": 0.08483333333333333, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.350023999999999e-05, "total_loss": -0.14710982670012693, "policy_loss": -0.03406406819439409, "vf_loss": 0.012402975030920723, "vf_explained_var": 0.7352809581973336, "kl": 0.02627768723225486, "entropy": 21.28556524103338, "entropy_coeff": 0.005583373333333335}, "model": {}, "num_grad_updates_lifetime": 23375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2665614, "num_env_steps_trained": 2665614, "num_agent_steps_sampled": 2665614, "num_agent_steps_trained": 2665614}, "sampler_results": {"episode_reward_max": 10.33034971486679, "episode_reward_min": 0.3053346299401557, "episode_reward_mean": 6.460156137238249, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.823699972509522, 8.400355397162203, 9.886022411121347, 4.960926464336002, 1.9328854098348969, 3.296463889520876, 5.304910635456602, 8.28634152084409, 5.4349527091258905, 7.403620568293353, 9.591989733538279, 4.697233660865034, 6.813949248545595, 1.5912659440079695, 5.976849735169872, 6.552533733546005, 6.762887496013998, 5.718845139023541, 4.080465721805531, 5.444247924604826, 3.2810456974531172, 7.74301685920689, 8.339555871119348, 10.33034971486679, 10.039632735357069, 8.104412145688583, 6.010300628243614, 5.509144434491678, 7.506929167804515, 8.279893940011766, 5.068910881178041, 3.5924980828011908, 6.035827583372805, 6.625453681864411, 6.274818809950948, 5.20080380046533, 5.49940950733804, 2.7038454832924694, 9.676151666590615, 7.112949591435794, 5.58724728354506, 7.180231888795586, 8.77083041222419, 7.167987250745733, 7.036015316118383, 9.639218104116583, 8.654186424860915, 4.498941336429941, 7.437990347115195, 1.60825825189038, 4.429381582931218, 5.117099768888129, 7.568109810607887, 8.727125346160992, 7.648080214020983, 5.267102601747326, 7.844717050006672, 6.407771985532078, 8.286425677428104, 8.945666864840314, 8.67767026120606, 5.593320056336561, 10.069023601024906, 4.364531446535536, 8.226969033837515, 5.50076203793335, 8.560774019633318, 8.280977772356, 8.904929331662053, 7.577132828742305, 5.554459901358, 3.4359693326452705, 8.321736331512879, 4.087237838830925, 9.147226514584972, 8.792637323471778, 4.702607000376513, 5.542430932533736, 6.630049665322046, 7.708605631761572, 4.651895071197041, 6.411539474938867, 7.3221014577279995, 7.2903645724590085, 7.116569746452186, 6.23676127195952, 4.682299845444444, 6.982506248954314, 6.404357055359338, 7.6019037376317495, 6.8119412893817906, 0.3053346299401557, 4.946274461358539, 3.643569128256422, 8.275944985784415, 4.567390042508609, 6.9099018586945755, 7.963749485945324, 5.983103988813295, 3.511269393488104], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5760038513635666, "mean_inference_ms": 6.887736025059982, "mean_action_processing_ms": 0.5515815596871805, "mean_env_wait_ms": 25.224043769173367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03157329559326172, "StateBufferConnector_ms": 0.017981529235839844, "ViewRequirementAgentConnector_ms": 0.6655147075653076}}, "episode_reward_max": 10.33034971486679, "episode_reward_min": 0.3053346299401557, "episode_reward_mean": 6.460156137238249, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.823699972509522, 8.400355397162203, 9.886022411121347, 4.960926464336002, 1.9328854098348969, 3.296463889520876, 5.304910635456602, 8.28634152084409, 5.4349527091258905, 7.403620568293353, 9.591989733538279, 4.697233660865034, 6.813949248545595, 1.5912659440079695, 5.976849735169872, 6.552533733546005, 6.762887496013998, 5.718845139023541, 4.080465721805531, 5.444247924604826, 3.2810456974531172, 7.74301685920689, 8.339555871119348, 10.33034971486679, 10.039632735357069, 8.104412145688583, 6.010300628243614, 5.509144434491678, 7.506929167804515, 8.279893940011766, 5.068910881178041, 3.5924980828011908, 6.035827583372805, 6.625453681864411, 6.274818809950948, 5.20080380046533, 5.49940950733804, 2.7038454832924694, 9.676151666590615, 7.112949591435794, 5.58724728354506, 7.180231888795586, 8.77083041222419, 7.167987250745733, 7.036015316118383, 9.639218104116583, 8.654186424860915, 4.498941336429941, 7.437990347115195, 1.60825825189038, 4.429381582931218, 5.117099768888129, 7.568109810607887, 8.727125346160992, 7.648080214020983, 5.267102601747326, 7.844717050006672, 6.407771985532078, 8.286425677428104, 8.945666864840314, 8.67767026120606, 5.593320056336561, 10.069023601024906, 4.364531446535536, 8.226969033837515, 5.50076203793335, 8.560774019633318, 8.280977772356, 8.904929331662053, 7.577132828742305, 5.554459901358, 3.4359693326452705, 8.321736331512879, 4.087237838830925, 9.147226514584972, 8.792637323471778, 4.702607000376513, 5.542430932533736, 6.630049665322046, 7.708605631761572, 4.651895071197041, 6.411539474938867, 7.3221014577279995, 7.2903645724590085, 7.116569746452186, 6.23676127195952, 4.682299845444444, 6.982506248954314, 6.404357055359338, 7.6019037376317495, 6.8119412893817906, 0.3053346299401557, 4.946274461358539, 3.643569128256422, 8.275944985784415, 4.567390042508609, 6.9099018586945755, 7.963749485945324, 5.983103988813295, 3.511269393488104], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5760038513635666, "mean_inference_ms": 6.887736025059982, "mean_action_processing_ms": 0.5515815596871805, "mean_env_wait_ms": 25.224043769173367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03157329559326172, "StateBufferConnector_ms": 0.017981529235839844, "ViewRequirementAgentConnector_ms": 0.6655147075653076}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2665614, "num_agent_steps_trained": 2665614, "num_env_steps_sampled": 2665614, "num_env_steps_trained": 2665614, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 298.4514079524518, "num_env_steps_trained_throughput_per_sec": 298.4514079524518, "timesteps_total": 2665614, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2665614, "timers": {"training_iteration_time_ms": 52132.703, "sample_time_ms": 40076.686, "load_time_ms": 607.853, "load_throughput": 25726.603, "learn_time_ms": 11108.867, "learn_throughput": 1407.704, "synch_weights_time_ms": 314.868}, "counters": {"num_env_steps_sampled": 2665614, "num_env_steps_trained": 2665614, "num_agent_steps_sampled": 2665614, "num_agent_steps_trained": 2665614}, "done": false, "episodes_total": 602, "training_iteration": 175, "trial_id": "c5092_00000", "date": "2025-06-08_10-18-28", "timestamp": 1749370708, "time_this_iter_s": 52.412973165512085, "time_total_s": 2254.580146074295, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2254.580146074295, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 79.30163934426228, "ram_util_percent": 60.400000000000006, "gpu_util_percent0": 0.08393442622950818, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.334386000000001e-05, "total_loss": -0.13930926400099203, "policy_loss": -0.02721484038150679, "vf_loss": 0.011242006123065949, "vf_explained_var": 0.7503244455294176, "kl": 0.026713576540246316, "entropy": 21.157739106958562, "entropy_coeff": 0.005557310000000001}, "model": {}, "num_grad_updates_lifetime": 23925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2681252, "num_env_steps_trained": 2681252, "num_agent_steps_sampled": 2681252, "num_agent_steps_trained": 2681252}, "sampler_results": {"episode_reward_max": 10.33034971486679, "episode_reward_min": 0.3053346299401557, "episode_reward_mean": 6.600066233190845, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.976849735169872, 6.552533733546005, 6.762887496013998, 5.718845139023541, 4.080465721805531, 5.444247924604826, 3.2810456974531172, 7.74301685920689, 8.339555871119348, 10.33034971486679, 10.039632735357069, 8.104412145688583, 6.010300628243614, 5.509144434491678, 7.506929167804515, 8.279893940011766, 5.068910881178041, 3.5924980828011908, 6.035827583372805, 6.625453681864411, 6.274818809950948, 5.20080380046533, 5.49940950733804, 2.7038454832924694, 9.676151666590615, 7.112949591435794, 5.58724728354506, 7.180231888795586, 8.77083041222419, 7.167987250745733, 7.036015316118383, 9.639218104116583, 8.654186424860915, 4.498941336429941, 7.437990347115195, 1.60825825189038, 4.429381582931218, 5.117099768888129, 7.568109810607887, 8.727125346160992, 7.648080214020983, 5.267102601747326, 7.844717050006672, 6.407771985532078, 8.286425677428104, 8.945666864840314, 8.67767026120606, 5.593320056336561, 10.069023601024906, 4.364531446535536, 8.226969033837515, 5.50076203793335, 8.560774019633318, 8.280977772356, 8.904929331662053, 7.577132828742305, 5.554459901358, 3.4359693326452705, 8.321736331512879, 4.087237838830925, 9.147226514584972, 8.792637323471778, 4.702607000376513, 5.542430932533736, 6.630049665322046, 7.708605631761572, 4.651895071197041, 6.411539474938867, 7.3221014577279995, 7.2903645724590085, 7.116569746452186, 6.23676127195952, 4.682299845444444, 6.982506248954314, 6.404357055359338, 7.6019037376317495, 6.8119412893817906, 0.3053346299401557, 4.946274461358539, 3.643569128256422, 8.275944985784415, 4.567390042508609, 6.9099018586945755, 7.963749485945324, 5.983103988813295, 3.511269393488104, 8.90181071924953, 7.228229245037699, 8.168512744457269, 2.167393869892729, 7.869271722417587, 2.006983150355338, 9.105166419976102, 8.394748215761053, 10.06869091153073, 7.36886110637146, 6.265870328156384, 7.315165069957641, 6.797019705853401, 5.757903951404076], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.576504258489863, "mean_inference_ms": 6.8924895290490715, "mean_action_processing_ms": 0.5518557351647291, "mean_env_wait_ms": 25.24452773192329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03060150146484375, "StateBufferConnector_ms": 0.017981290817260742, "ViewRequirementAgentConnector_ms": 0.6559364795684814}}, "episode_reward_max": 10.33034971486679, "episode_reward_min": 0.3053346299401557, "episode_reward_mean": 6.600066233190845, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.976849735169872, 6.552533733546005, 6.762887496013998, 5.718845139023541, 4.080465721805531, 5.444247924604826, 3.2810456974531172, 7.74301685920689, 8.339555871119348, 10.33034971486679, 10.039632735357069, 8.104412145688583, 6.010300628243614, 5.509144434491678, 7.506929167804515, 8.279893940011766, 5.068910881178041, 3.5924980828011908, 6.035827583372805, 6.625453681864411, 6.274818809950948, 5.20080380046533, 5.49940950733804, 2.7038454832924694, 9.676151666590615, 7.112949591435794, 5.58724728354506, 7.180231888795586, 8.77083041222419, 7.167987250745733, 7.036015316118383, 9.639218104116583, 8.654186424860915, 4.498941336429941, 7.437990347115195, 1.60825825189038, 4.429381582931218, 5.117099768888129, 7.568109810607887, 8.727125346160992, 7.648080214020983, 5.267102601747326, 7.844717050006672, 6.407771985532078, 8.286425677428104, 8.945666864840314, 8.67767026120606, 5.593320056336561, 10.069023601024906, 4.364531446535536, 8.226969033837515, 5.50076203793335, 8.560774019633318, 8.280977772356, 8.904929331662053, 7.577132828742305, 5.554459901358, 3.4359693326452705, 8.321736331512879, 4.087237838830925, 9.147226514584972, 8.792637323471778, 4.702607000376513, 5.542430932533736, 6.630049665322046, 7.708605631761572, 4.651895071197041, 6.411539474938867, 7.3221014577279995, 7.2903645724590085, 7.116569746452186, 6.23676127195952, 4.682299845444444, 6.982506248954314, 6.404357055359338, 7.6019037376317495, 6.8119412893817906, 0.3053346299401557, 4.946274461358539, 3.643569128256422, 8.275944985784415, 4.567390042508609, 6.9099018586945755, 7.963749485945324, 5.983103988813295, 3.511269393488104, 8.90181071924953, 7.228229245037699, 8.168512744457269, 2.167393869892729, 7.869271722417587, 2.006983150355338, 9.105166419976102, 8.394748215761053, 10.06869091153073, 7.36886110637146, 6.265870328156384, 7.315165069957641, 6.797019705853401, 5.757903951404076], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.576504258489863, "mean_inference_ms": 6.8924895290490715, "mean_action_processing_ms": 0.5518557351647291, "mean_env_wait_ms": 25.24452773192329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03060150146484375, "StateBufferConnector_ms": 0.017981290817260742, "ViewRequirementAgentConnector_ms": 0.6559364795684814}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2681252, "num_agent_steps_trained": 2681252, "num_env_steps_sampled": 2681252, "num_env_steps_trained": 2681252, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 302.8671604902517, "num_env_steps_trained_throughput_per_sec": 302.8671604902517, "timesteps_total": 2681252, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2681252, "timers": {"training_iteration_time_ms": 52118.435, "sample_time_ms": 40062.231, "load_time_ms": 605.027, "load_throughput": 25846.789, "learn_time_ms": 11109.269, "learn_throughput": 1407.653, "synch_weights_time_ms": 317.949}, "counters": {"num_env_steps_sampled": 2681252, "num_env_steps_trained": 2681252, "num_agent_steps_sampled": 2681252, "num_agent_steps_trained": 2681252}, "done": false, "episodes_total": 616, "training_iteration": 176, "trial_id": "c5092_00000", "date": "2025-06-08_10-19-19", "timestamp": 1749370759, "time_this_iter_s": 51.64886665344238, "time_total_s": 2306.2290127277374, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2306.2290127277374, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 78.58999999999997, "ram_util_percent": 60.411666666666676, "gpu_util_percent0": 0.08733333333333333, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.318748e-05, "total_loss": -0.14223916807963344, "policy_loss": -0.031083546402356162, "vf_loss": 0.013010136449116874, "vf_explained_var": 0.7458364074880427, "kl": 0.025533671610916124, "entropy": 21.166731525767933, "entropy_coeff": 0.005531246666666666}, "model": {}, "num_grad_updates_lifetime": 24475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2696890, "num_env_steps_trained": 2696890, "num_agent_steps_sampled": 2696890, "num_agent_steps_trained": 2696890}, "sampler_results": {"episode_reward_max": 10.574965798994137, "episode_reward_min": 0.3053346299401557, "episode_reward_mean": 6.56677173547694, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.506929167804515, 8.279893940011766, 5.068910881178041, 3.5924980828011908, 6.035827583372805, 6.625453681864411, 6.274818809950948, 5.20080380046533, 5.49940950733804, 2.7038454832924694, 9.676151666590615, 7.112949591435794, 5.58724728354506, 7.180231888795586, 8.77083041222419, 7.167987250745733, 7.036015316118383, 9.639218104116583, 8.654186424860915, 4.498941336429941, 7.437990347115195, 1.60825825189038, 4.429381582931218, 5.117099768888129, 7.568109810607887, 8.727125346160992, 7.648080214020983, 5.267102601747326, 7.844717050006672, 6.407771985532078, 8.286425677428104, 8.945666864840314, 8.67767026120606, 5.593320056336561, 10.069023601024906, 4.364531446535536, 8.226969033837515, 5.50076203793335, 8.560774019633318, 8.280977772356, 8.904929331662053, 7.577132828742305, 5.554459901358, 3.4359693326452705, 8.321736331512879, 4.087237838830925, 9.147226514584972, 8.792637323471778, 4.702607000376513, 5.542430932533736, 6.630049665322046, 7.708605631761572, 4.651895071197041, 6.411539474938867, 7.3221014577279995, 7.2903645724590085, 7.116569746452186, 6.23676127195952, 4.682299845444444, 6.982506248954314, 6.404357055359338, 7.6019037376317495, 6.8119412893817906, 0.3053346299401557, 4.946274461358539, 3.643569128256422, 8.275944985784415, 4.567390042508609, 6.9099018586945755, 7.963749485945324, 5.983103988813295, 3.511269393488104, 8.90181071924953, 7.228229245037699, 8.168512744457269, 2.167393869892729, 7.869271722417587, 2.006983150355338, 9.105166419976102, 8.394748215761053, 10.06869091153073, 7.36886110637146, 6.265870328156384, 7.315165069957641, 6.797019705853401, 5.757903951404076, 8.72004283882164, 1.0317561071326233, 1.722249585859612, 5.3607071891870985, 10.366799531927589, 8.966252320630089, 10.574965798994137, 5.4065827362776915, 8.285518850188733, 6.760853366201647, 0.44002638508364944, 6.209364753951128, 9.260677071974763, 7.458041528969908], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5768712356050427, "mean_inference_ms": 6.8966061469520445, "mean_action_processing_ms": 0.5520916295936679, "mean_env_wait_ms": 25.26314957763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04078793525695801, "StateBufferConnector_ms": 0.012001752853393555, "ViewRequirementAgentConnector_ms": 0.6441378593444824}}, "episode_reward_max": 10.574965798994137, "episode_reward_min": 0.3053346299401557, "episode_reward_mean": 6.56677173547694, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.506929167804515, 8.279893940011766, 5.068910881178041, 3.5924980828011908, 6.035827583372805, 6.625453681864411, 6.274818809950948, 5.20080380046533, 5.49940950733804, 2.7038454832924694, 9.676151666590615, 7.112949591435794, 5.58724728354506, 7.180231888795586, 8.77083041222419, 7.167987250745733, 7.036015316118383, 9.639218104116583, 8.654186424860915, 4.498941336429941, 7.437990347115195, 1.60825825189038, 4.429381582931218, 5.117099768888129, 7.568109810607887, 8.727125346160992, 7.648080214020983, 5.267102601747326, 7.844717050006672, 6.407771985532078, 8.286425677428104, 8.945666864840314, 8.67767026120606, 5.593320056336561, 10.069023601024906, 4.364531446535536, 8.226969033837515, 5.50076203793335, 8.560774019633318, 8.280977772356, 8.904929331662053, 7.577132828742305, 5.554459901358, 3.4359693326452705, 8.321736331512879, 4.087237838830925, 9.147226514584972, 8.792637323471778, 4.702607000376513, 5.542430932533736, 6.630049665322046, 7.708605631761572, 4.651895071197041, 6.411539474938867, 7.3221014577279995, 7.2903645724590085, 7.116569746452186, 6.23676127195952, 4.682299845444444, 6.982506248954314, 6.404357055359338, 7.6019037376317495, 6.8119412893817906, 0.3053346299401557, 4.946274461358539, 3.643569128256422, 8.275944985784415, 4.567390042508609, 6.9099018586945755, 7.963749485945324, 5.983103988813295, 3.511269393488104, 8.90181071924953, 7.228229245037699, 8.168512744457269, 2.167393869892729, 7.869271722417587, 2.006983150355338, 9.105166419976102, 8.394748215761053, 10.06869091153073, 7.36886110637146, 6.265870328156384, 7.315165069957641, 6.797019705853401, 5.757903951404076, 8.72004283882164, 1.0317561071326233, 1.722249585859612, 5.3607071891870985, 10.366799531927589, 8.966252320630089, 10.574965798994137, 5.4065827362776915, 8.285518850188733, 6.760853366201647, 0.44002638508364944, 6.209364753951128, 9.260677071974763, 7.458041528969908], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5768712356050427, "mean_inference_ms": 6.8966061469520445, "mean_action_processing_ms": 0.5520916295936679, "mean_env_wait_ms": 25.26314957763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04078793525695801, "StateBufferConnector_ms": 0.012001752853393555, "ViewRequirementAgentConnector_ms": 0.6441378593444824}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2696890, "num_agent_steps_trained": 2696890, "num_env_steps_sampled": 2696890, "num_env_steps_trained": 2696890, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 300.7259833451042, "num_env_steps_trained_throughput_per_sec": 300.7259833451042, "timesteps_total": 2696890, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2696890, "timers": {"training_iteration_time_ms": 52135.858, "sample_time_ms": 40083.546, "load_time_ms": 604.413, "load_throughput": 25873.03, "learn_time_ms": 11105.704, "learn_throughput": 1408.105, "synch_weights_time_ms": 318.235}, "counters": {"num_env_steps_sampled": 2696890, "num_env_steps_trained": 2696890, "num_agent_steps_sampled": 2696890, "num_agent_steps_trained": 2696890}, "done": false, "episodes_total": 630, "training_iteration": 177, "trial_id": "c5092_00000", "date": "2025-06-08_10-20-11", "timestamp": 1749370811, "time_this_iter_s": 52.01184296607971, "time_total_s": 2358.240855693817, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2358.240855693817, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 79.35666666666664, "ram_util_percent": 60.441666666666684, "gpu_util_percent0": 0.0805, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.303110000000002e-05, "total_loss": -0.13360347433587197, "policy_loss": -0.022254629102958876, "vf_loss": 0.011470255739140239, "vf_explained_var": 0.74313640832901, "kl": 0.025661636211445134, "entropy": 21.219965151006527, "entropy_coeff": 0.0055051833333333335}, "model": {}, "num_grad_updates_lifetime": 25025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2712528, "num_env_steps_trained": 2712528, "num_agent_steps_sampled": 2712528, "num_agent_steps_trained": 2712528}, "sampler_results": {"episode_reward_max": 10.574965798994137, "episode_reward_min": 0.3053346299401557, "episode_reward_mean": 6.4714914579441745, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.77083041222419, 7.167987250745733, 7.036015316118383, 9.639218104116583, 8.654186424860915, 4.498941336429941, 7.437990347115195, 1.60825825189038, 4.429381582931218, 5.117099768888129, 7.568109810607887, 8.727125346160992, 7.648080214020983, 5.267102601747326, 7.844717050006672, 6.407771985532078, 8.286425677428104, 8.945666864840314, 8.67767026120606, 5.593320056336561, 10.069023601024906, 4.364531446535536, 8.226969033837515, 5.50076203793335, 8.560774019633318, 8.280977772356, 8.904929331662053, 7.577132828742305, 5.554459901358, 3.4359693326452705, 8.321736331512879, 4.087237838830925, 9.147226514584972, 8.792637323471778, 4.702607000376513, 5.542430932533736, 6.630049665322046, 7.708605631761572, 4.651895071197041, 6.411539474938867, 7.3221014577279995, 7.2903645724590085, 7.116569746452186, 6.23676127195952, 4.682299845444444, 6.982506248954314, 6.404357055359338, 7.6019037376317495, 6.8119412893817906, 0.3053346299401557, 4.946274461358539, 3.643569128256422, 8.275944985784415, 4.567390042508609, 6.9099018586945755, 7.963749485945324, 5.983103988813295, 3.511269393488104, 8.90181071924953, 7.228229245037699, 8.168512744457269, 2.167393869892729, 7.869271722417587, 2.006983150355338, 9.105166419976102, 8.394748215761053, 10.06869091153073, 7.36886110637146, 6.265870328156384, 7.315165069957641, 6.797019705853401, 5.757903951404076, 8.72004283882164, 1.0317561071326233, 1.722249585859612, 5.3607071891870985, 10.366799531927589, 8.966252320630089, 10.574965798994137, 5.4065827362776915, 8.285518850188733, 6.760853366201647, 0.44002638508364944, 6.209364753951128, 9.260677071974763, 7.458041528969908, 3.9999696469931054, 3.9298422457929942, 3.8284994335593647, 8.003725619599798, 4.7672355797814205, 5.9418913946283505, 5.188284617259408, 5.869275374996845, 6.867653160287267, 4.467676672497823, 6.135242043920109, 6.823857852440962, 7.723552758220386, 3.270237215192168], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5771636248923766, "mean_inference_ms": 6.900233676019272, "mean_action_processing_ms": 0.5522859060900603, "mean_env_wait_ms": 25.280007930713868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0377655029296875, "StateBufferConnector_ms": 0.010009765625, "ViewRequirementAgentConnector_ms": 0.6261415481567383}}, "episode_reward_max": 10.574965798994137, "episode_reward_min": 0.3053346299401557, "episode_reward_mean": 6.4714914579441745, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.77083041222419, 7.167987250745733, 7.036015316118383, 9.639218104116583, 8.654186424860915, 4.498941336429941, 7.437990347115195, 1.60825825189038, 4.429381582931218, 5.117099768888129, 7.568109810607887, 8.727125346160992, 7.648080214020983, 5.267102601747326, 7.844717050006672, 6.407771985532078, 8.286425677428104, 8.945666864840314, 8.67767026120606, 5.593320056336561, 10.069023601024906, 4.364531446535536, 8.226969033837515, 5.50076203793335, 8.560774019633318, 8.280977772356, 8.904929331662053, 7.577132828742305, 5.554459901358, 3.4359693326452705, 8.321736331512879, 4.087237838830925, 9.147226514584972, 8.792637323471778, 4.702607000376513, 5.542430932533736, 6.630049665322046, 7.708605631761572, 4.651895071197041, 6.411539474938867, 7.3221014577279995, 7.2903645724590085, 7.116569746452186, 6.23676127195952, 4.682299845444444, 6.982506248954314, 6.404357055359338, 7.6019037376317495, 6.8119412893817906, 0.3053346299401557, 4.946274461358539, 3.643569128256422, 8.275944985784415, 4.567390042508609, 6.9099018586945755, 7.963749485945324, 5.983103988813295, 3.511269393488104, 8.90181071924953, 7.228229245037699, 8.168512744457269, 2.167393869892729, 7.869271722417587, 2.006983150355338, 9.105166419976102, 8.394748215761053, 10.06869091153073, 7.36886110637146, 6.265870328156384, 7.315165069957641, 6.797019705853401, 5.757903951404076, 8.72004283882164, 1.0317561071326233, 1.722249585859612, 5.3607071891870985, 10.366799531927589, 8.966252320630089, 10.574965798994137, 5.4065827362776915, 8.285518850188733, 6.760853366201647, 0.44002638508364944, 6.209364753951128, 9.260677071974763, 7.458041528969908, 3.9999696469931054, 3.9298422457929942, 3.8284994335593647, 8.003725619599798, 4.7672355797814205, 5.9418913946283505, 5.188284617259408, 5.869275374996845, 6.867653160287267, 4.467676672497823, 6.135242043920109, 6.823857852440962, 7.723552758220386, 3.270237215192168], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5771636248923766, "mean_inference_ms": 6.900233676019272, "mean_action_processing_ms": 0.5522859060900603, "mean_env_wait_ms": 25.280007930713868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0377655029296875, "StateBufferConnector_ms": 0.010009765625, "ViewRequirementAgentConnector_ms": 0.6261415481567383}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2712528, "num_agent_steps_trained": 2712528, "num_env_steps_sampled": 2712528, "num_env_steps_trained": 2712528, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 300.0544835468097, "num_env_steps_trained_throughput_per_sec": 300.0544835468097, "timesteps_total": 2712528, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2712528, "timers": {"training_iteration_time_ms": 52152.255, "sample_time_ms": 40109.802, "load_time_ms": 600.22, "load_throughput": 26053.78, "learn_time_ms": 11101.594, "learn_throughput": 1408.627, "synch_weights_time_ms": 316.697}, "counters": {"num_env_steps_sampled": 2712528, "num_env_steps_trained": 2712528, "num_agent_steps_sampled": 2712528, "num_agent_steps_trained": 2712528}, "done": false, "episodes_total": 644, "training_iteration": 178, "trial_id": "c5092_00000", "date": "2025-06-08_10-21-04", "timestamp": 1749370864, "time_this_iter_s": 52.132925271987915, "time_total_s": 2410.373780965805, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2410.373780965805, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 79.35166666666666, "ram_util_percent": 60.491666666666674, "gpu_util_percent0": 0.07800000000000001, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.287472000000002e-05, "total_loss": -0.13263614309253172, "policy_loss": -0.02196476348308021, "vf_loss": 0.010802466230974956, "vf_explained_var": 0.7772653253511949, "kl": 0.024823721921157466, "entropy": 21.14859919461337, "entropy_coeff": 0.005479120000000001}, "model": {}, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2728166, "num_env_steps_trained": 2728166, "num_agent_steps_sampled": 2728166, "num_agent_steps_trained": 2728166}, "sampler_results": {"episode_reward_max": 10.574965798994137, "episode_reward_min": 0.3053346299401557, "episode_reward_mean": 6.44139876090681, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.844717050006672, 6.407771985532078, 8.286425677428104, 8.945666864840314, 8.67767026120606, 5.593320056336561, 10.069023601024906, 4.364531446535536, 8.226969033837515, 5.50076203793335, 8.560774019633318, 8.280977772356, 8.904929331662053, 7.577132828742305, 5.554459901358, 3.4359693326452705, 8.321736331512879, 4.087237838830925, 9.147226514584972, 8.792637323471778, 4.702607000376513, 5.542430932533736, 6.630049665322046, 7.708605631761572, 4.651895071197041, 6.411539474938867, 7.3221014577279995, 7.2903645724590085, 7.116569746452186, 6.23676127195952, 4.682299845444444, 6.982506248954314, 6.404357055359338, 7.6019037376317495, 6.8119412893817906, 0.3053346299401557, 4.946274461358539, 3.643569128256422, 8.275944985784415, 4.567390042508609, 6.9099018586945755, 7.963749485945324, 5.983103988813295, 3.511269393488104, 8.90181071924953, 7.228229245037699, 8.168512744457269, 2.167393869892729, 7.869271722417587, 2.006983150355338, 9.105166419976102, 8.394748215761053, 10.06869091153073, 7.36886110637146, 6.265870328156384, 7.315165069957641, 6.797019705853401, 5.757903951404076, 8.72004283882164, 1.0317561071326233, 1.722249585859612, 5.3607071891870985, 10.366799531927589, 8.966252320630089, 10.574965798994137, 5.4065827362776915, 8.285518850188733, 6.760853366201647, 0.44002638508364944, 6.209364753951128, 9.260677071974763, 7.458041528969908, 3.9999696469931054, 3.9298422457929942, 3.8284994335593647, 8.003725619599798, 4.7672355797814205, 5.9418913946283505, 5.188284617259408, 5.869275374996845, 6.867653160287267, 4.467676672497823, 6.135242043920109, 6.823857852440962, 7.723552758220386, 3.270237215192168, 6.652312640064416, 4.918123189624691, 8.275690220800094, 5.984642887207112, 7.19229763827368, 7.763558738738352, 8.857941823152322, 7.918242358429905, 4.584906191147344, 8.078772851652879, 3.0199282435753165, 6.811538808472911, 6.65370952191264, 3.8493919510697228], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5774347981734442, "mean_inference_ms": 6.903452291062339, "mean_action_processing_ms": 0.5524614012863627, "mean_env_wait_ms": 25.29586585170131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032619476318359375, "StateBufferConnector_ms": 0.013917684555053711, "ViewRequirementAgentConnector_ms": 0.6381499767303467}}, "episode_reward_max": 10.574965798994137, "episode_reward_min": 0.3053346299401557, "episode_reward_mean": 6.44139876090681, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.844717050006672, 6.407771985532078, 8.286425677428104, 8.945666864840314, 8.67767026120606, 5.593320056336561, 10.069023601024906, 4.364531446535536, 8.226969033837515, 5.50076203793335, 8.560774019633318, 8.280977772356, 8.904929331662053, 7.577132828742305, 5.554459901358, 3.4359693326452705, 8.321736331512879, 4.087237838830925, 9.147226514584972, 8.792637323471778, 4.702607000376513, 5.542430932533736, 6.630049665322046, 7.708605631761572, 4.651895071197041, 6.411539474938867, 7.3221014577279995, 7.2903645724590085, 7.116569746452186, 6.23676127195952, 4.682299845444444, 6.982506248954314, 6.404357055359338, 7.6019037376317495, 6.8119412893817906, 0.3053346299401557, 4.946274461358539, 3.643569128256422, 8.275944985784415, 4.567390042508609, 6.9099018586945755, 7.963749485945324, 5.983103988813295, 3.511269393488104, 8.90181071924953, 7.228229245037699, 8.168512744457269, 2.167393869892729, 7.869271722417587, 2.006983150355338, 9.105166419976102, 8.394748215761053, 10.06869091153073, 7.36886110637146, 6.265870328156384, 7.315165069957641, 6.797019705853401, 5.757903951404076, 8.72004283882164, 1.0317561071326233, 1.722249585859612, 5.3607071891870985, 10.366799531927589, 8.966252320630089, 10.574965798994137, 5.4065827362776915, 8.285518850188733, 6.760853366201647, 0.44002638508364944, 6.209364753951128, 9.260677071974763, 7.458041528969908, 3.9999696469931054, 3.9298422457929942, 3.8284994335593647, 8.003725619599798, 4.7672355797814205, 5.9418913946283505, 5.188284617259408, 5.869275374996845, 6.867653160287267, 4.467676672497823, 6.135242043920109, 6.823857852440962, 7.723552758220386, 3.270237215192168, 6.652312640064416, 4.918123189624691, 8.275690220800094, 5.984642887207112, 7.19229763827368, 7.763558738738352, 8.857941823152322, 7.918242358429905, 4.584906191147344, 8.078772851652879, 3.0199282435753165, 6.811538808472911, 6.65370952191264, 3.8493919510697228], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5774347981734442, "mean_inference_ms": 6.903452291062339, "mean_action_processing_ms": 0.5524614012863627, "mean_env_wait_ms": 25.29586585170131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032619476318359375, "StateBufferConnector_ms": 0.013917684555053711, "ViewRequirementAgentConnector_ms": 0.6381499767303467}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2728166, "num_agent_steps_trained": 2728166, "num_env_steps_sampled": 2728166, "num_env_steps_trained": 2728166, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 299.031860552062, "num_env_steps_trained_throughput_per_sec": 299.031860552062, "timesteps_total": 2728166, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2728166, "timers": {"training_iteration_time_ms": 52162.187, "sample_time_ms": 40114.686, "load_time_ms": 590.339, "load_throughput": 26489.879, "learn_time_ms": 11109.693, "learn_throughput": 1407.6, "synch_weights_time_ms": 322.389}, "counters": {"num_env_steps_sampled": 2728166, "num_env_steps_trained": 2728166, "num_agent_steps_sampled": 2728166, "num_agent_steps_trained": 2728166}, "done": false, "episodes_total": 658, "training_iteration": 179, "trial_id": "c5092_00000", "date": "2025-06-08_10-21-56", "timestamp": 1749370916, "time_this_iter_s": 52.305267095565796, "time_total_s": 2462.679048061371, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2462.679048061371, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 79.43166666666666, "ram_util_percent": 60.570000000000014, "gpu_util_percent0": 0.0836666666666667, "vram_util_percent0": 0.18831380208333337}}
{"evaluation": {"sampler_results": {"episode_reward_max": -0.6636790422997618, "episode_reward_min": -4.962418069942877, "episode_reward_mean": -2.9499857691426263, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6636790422997618, -3.0740961078036775, -2.924433692910961, -4.962418069942877, -3.1253019327558547], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1613224712101127, "mean_inference_ms": 3.306035586528587, "mean_action_processing_ms": 0.25256441944207014, "mean_env_wait_ms": 10.717719598702882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1403331756591797}}, "episode_reward_max": -0.6636790422997618, "episode_reward_min": -4.962418069942877, "episode_reward_mean": -2.9499857691426263, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6636790422997618, -3.0740961078036775, -2.924433692910961, -4.962418069942877, -3.1253019327558547], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1613224712101127, "mean_inference_ms": 3.306035586528587, "mean_action_processing_ms": 0.25256441944207014, "mean_env_wait_ms": 10.717719598702882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1403331756591797}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.271834e-05, "total_loss": -0.13349195831624622, "policy_loss": -0.024279742407421014, "vf_loss": 0.012345105084929276, "vf_explained_var": 0.7839791359684684, "kl": 0.025858929891520263, "entropy": 21.08197985909202, "entropy_coeff": 0.005453056666666666}, "model": {}, "num_grad_updates_lifetime": 26125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2743804, "num_env_steps_trained": 2743804, "num_agent_steps_sampled": 2743804, "num_agent_steps_trained": 2743804}, "sampler_results": {"episode_reward_max": 11.077549325368548, "episode_reward_min": 0.3053346299401557, "episode_reward_mean": 6.282081677401074, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.554459901358, 3.4359693326452705, 8.321736331512879, 4.087237838830925, 9.147226514584972, 8.792637323471778, 4.702607000376513, 5.542430932533736, 6.630049665322046, 7.708605631761572, 4.651895071197041, 6.411539474938867, 7.3221014577279995, 7.2903645724590085, 7.116569746452186, 6.23676127195952, 4.682299845444444, 6.982506248954314, 6.404357055359338, 7.6019037376317495, 6.8119412893817906, 0.3053346299401557, 4.946274461358539, 3.643569128256422, 8.275944985784415, 4.567390042508609, 6.9099018586945755, 7.963749485945324, 5.983103988813295, 3.511269393488104, 8.90181071924953, 7.228229245037699, 8.168512744457269, 2.167393869892729, 7.869271722417587, 2.006983150355338, 9.105166419976102, 8.394748215761053, 10.06869091153073, 7.36886110637146, 6.265870328156384, 7.315165069957641, 6.797019705853401, 5.757903951404076, 8.72004283882164, 1.0317561071326233, 1.722249585859612, 5.3607071891870985, 10.366799531927589, 8.966252320630089, 10.574965798994137, 5.4065827362776915, 8.285518850188733, 6.760853366201647, 0.44002638508364944, 6.209364753951128, 9.260677071974763, 7.458041528969908, 3.9999696469931054, 3.9298422457929942, 3.8284994335593647, 8.003725619599798, 4.7672355797814205, 5.9418913946283505, 5.188284617259408, 5.869275374996845, 6.867653160287267, 4.467676672497823, 6.135242043920109, 6.823857852440962, 7.723552758220386, 3.270237215192168, 6.652312640064416, 4.918123189624691, 8.275690220800094, 5.984642887207112, 7.19229763827368, 7.763558738738352, 8.857941823152322, 7.918242358429905, 4.584906191147344, 8.078772851652879, 3.0199282435753165, 6.811538808472911, 6.65370952191264, 3.8493919510697228, 7.488169916617051, 10.096622412861928, 7.689518982116211, 5.655806319942658, 5.823948846606034, 6.292053761301091, 11.077549325368548, 5.0404153025064025, 1.668511254474344, 6.668868051693255, 3.2523417692451777, 5.274573061594888, 6.920913810664565, 8.359670801509019], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5780261987803488, "mean_inference_ms": 6.906602944485964, "mean_action_processing_ms": 0.5526443323731364, "mean_env_wait_ms": 25.311396359820833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02860713005065918, "StateBufferConnector_ms": 0.013924360275268555, "ViewRequirementAgentConnector_ms": 0.6661949157714844}}, "episode_reward_max": 11.077549325368548, "episode_reward_min": 0.3053346299401557, "episode_reward_mean": 6.282081677401074, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.554459901358, 3.4359693326452705, 8.321736331512879, 4.087237838830925, 9.147226514584972, 8.792637323471778, 4.702607000376513, 5.542430932533736, 6.630049665322046, 7.708605631761572, 4.651895071197041, 6.411539474938867, 7.3221014577279995, 7.2903645724590085, 7.116569746452186, 6.23676127195952, 4.682299845444444, 6.982506248954314, 6.404357055359338, 7.6019037376317495, 6.8119412893817906, 0.3053346299401557, 4.946274461358539, 3.643569128256422, 8.275944985784415, 4.567390042508609, 6.9099018586945755, 7.963749485945324, 5.983103988813295, 3.511269393488104, 8.90181071924953, 7.228229245037699, 8.168512744457269, 2.167393869892729, 7.869271722417587, 2.006983150355338, 9.105166419976102, 8.394748215761053, 10.06869091153073, 7.36886110637146, 6.265870328156384, 7.315165069957641, 6.797019705853401, 5.757903951404076, 8.72004283882164, 1.0317561071326233, 1.722249585859612, 5.3607071891870985, 10.366799531927589, 8.966252320630089, 10.574965798994137, 5.4065827362776915, 8.285518850188733, 6.760853366201647, 0.44002638508364944, 6.209364753951128, 9.260677071974763, 7.458041528969908, 3.9999696469931054, 3.9298422457929942, 3.8284994335593647, 8.003725619599798, 4.7672355797814205, 5.9418913946283505, 5.188284617259408, 5.869275374996845, 6.867653160287267, 4.467676672497823, 6.135242043920109, 6.823857852440962, 7.723552758220386, 3.270237215192168, 6.652312640064416, 4.918123189624691, 8.275690220800094, 5.984642887207112, 7.19229763827368, 7.763558738738352, 8.857941823152322, 7.918242358429905, 4.584906191147344, 8.078772851652879, 3.0199282435753165, 6.811538808472911, 6.65370952191264, 3.8493919510697228, 7.488169916617051, 10.096622412861928, 7.689518982116211, 5.655806319942658, 5.823948846606034, 6.292053761301091, 11.077549325368548, 5.0404153025064025, 1.668511254474344, 6.668868051693255, 3.2523417692451777, 5.274573061594888, 6.920913810664565, 8.359670801509019], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5780261987803488, "mean_inference_ms": 6.906602944485964, "mean_action_processing_ms": 0.5526443323731364, "mean_env_wait_ms": 25.311396359820833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02860713005065918, "StateBufferConnector_ms": 0.013924360275268555, "ViewRequirementAgentConnector_ms": 0.6661949157714844}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2743804, "num_agent_steps_trained": 2743804, "num_env_steps_sampled": 2743804, "num_env_steps_trained": 2743804, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 298.8869771171705, "num_env_steps_trained_throughput_per_sec": 298.8869771171705, "timesteps_total": 2743804, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2743804, "timers": {"training_iteration_time_ms": 52155.42, "sample_time_ms": 40062.839, "load_time_ms": 586.963, "load_throughput": 26642.237, "learn_time_ms": 11127.057, "learn_throughput": 1405.403, "synch_weights_time_ms": 354.126}, "counters": {"num_env_steps_sampled": 2743804, "num_env_steps_trained": 2743804, "num_agent_steps_sampled": 2743804, "num_agent_steps_trained": 2743804}, "done": false, "episodes_total": 672, "training_iteration": 180, "trial_id": "c5092_00000", "date": "2025-06-08_10-23-03", "timestamp": 1749370983, "time_this_iter_s": 66.5738525390625, "time_total_s": 2529.2529006004333, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2529.2529006004333, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 66.64871794871796, "ram_util_percent": 60.57564102564101, "gpu_util_percent0": 0.06679487179487179, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.256196e-05, "total_loss": -0.1423836813078643, "policy_loss": -0.03328545552450867, "vf_loss": 0.011013958303427154, "vf_explained_var": 0.7685658825527538, "kl": 0.026898938303772497, "entropy": 21.10379714792425, "entropy_coeff": 0.005426993333333332}, "model": {}, "num_grad_updates_lifetime": 26675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2759442, "num_env_steps_trained": 2759442, "num_agent_steps_sampled": 2759442, "num_agent_steps_trained": 2759442}, "sampler_results": {"episode_reward_max": 11.077549325368548, "episode_reward_min": 0.3053346299401557, "episode_reward_mean": 6.2750455103954925, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.116569746452186, 6.23676127195952, 4.682299845444444, 6.982506248954314, 6.404357055359338, 7.6019037376317495, 6.8119412893817906, 0.3053346299401557, 4.946274461358539, 3.643569128256422, 8.275944985784415, 4.567390042508609, 6.9099018586945755, 7.963749485945324, 5.983103988813295, 3.511269393488104, 8.90181071924953, 7.228229245037699, 8.168512744457269, 2.167393869892729, 7.869271722417587, 2.006983150355338, 9.105166419976102, 8.394748215761053, 10.06869091153073, 7.36886110637146, 6.265870328156384, 7.315165069957641, 6.797019705853401, 5.757903951404076, 8.72004283882164, 1.0317561071326233, 1.722249585859612, 5.3607071891870985, 10.366799531927589, 8.966252320630089, 10.574965798994137, 5.4065827362776915, 8.285518850188733, 6.760853366201647, 0.44002638508364944, 6.209364753951128, 9.260677071974763, 7.458041528969908, 3.9999696469931054, 3.9298422457929942, 3.8284994335593647, 8.003725619599798, 4.7672355797814205, 5.9418913946283505, 5.188284617259408, 5.869275374996845, 6.867653160287267, 4.467676672497823, 6.135242043920109, 6.823857852440962, 7.723552758220386, 3.270237215192168, 6.652312640064416, 4.918123189624691, 8.275690220800094, 5.984642887207112, 7.19229763827368, 7.763558738738352, 8.857941823152322, 7.918242358429905, 4.584906191147344, 8.078772851652879, 3.0199282435753165, 6.811538808472911, 6.65370952191264, 3.8493919510697228, 7.488169916617051, 10.096622412861928, 7.689518982116211, 5.655806319942658, 5.823948846606034, 6.292053761301091, 11.077549325368548, 5.0404153025064025, 1.668511254474344, 6.668868051693255, 3.2523417692451777, 5.274573061594888, 6.920913810664565, 8.359670801509019, 4.851108488917196, 8.431685998639335, 9.858731463125654, 3.709560257111408, 8.662162164681396, 6.381876750140429, 6.137016852203541, 6.238574515428385, 4.851656987988034, 6.207621843854691, 5.685105056987011, 5.30566319627703, 6.536068724866921, 6.038412047941585], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5785634082397388, "mean_inference_ms": 6.9100159090531585, "mean_action_processing_ms": 0.5528823389550341, "mean_env_wait_ms": 25.327438529001338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025615930557250977, "StateBufferConnector_ms": 0.015820741653442383, "ViewRequirementAgentConnector_ms": 0.6395206451416016}}, "episode_reward_max": 11.077549325368548, "episode_reward_min": 0.3053346299401557, "episode_reward_mean": 6.2750455103954925, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.116569746452186, 6.23676127195952, 4.682299845444444, 6.982506248954314, 6.404357055359338, 7.6019037376317495, 6.8119412893817906, 0.3053346299401557, 4.946274461358539, 3.643569128256422, 8.275944985784415, 4.567390042508609, 6.9099018586945755, 7.963749485945324, 5.983103988813295, 3.511269393488104, 8.90181071924953, 7.228229245037699, 8.168512744457269, 2.167393869892729, 7.869271722417587, 2.006983150355338, 9.105166419976102, 8.394748215761053, 10.06869091153073, 7.36886110637146, 6.265870328156384, 7.315165069957641, 6.797019705853401, 5.757903951404076, 8.72004283882164, 1.0317561071326233, 1.722249585859612, 5.3607071891870985, 10.366799531927589, 8.966252320630089, 10.574965798994137, 5.4065827362776915, 8.285518850188733, 6.760853366201647, 0.44002638508364944, 6.209364753951128, 9.260677071974763, 7.458041528969908, 3.9999696469931054, 3.9298422457929942, 3.8284994335593647, 8.003725619599798, 4.7672355797814205, 5.9418913946283505, 5.188284617259408, 5.869275374996845, 6.867653160287267, 4.467676672497823, 6.135242043920109, 6.823857852440962, 7.723552758220386, 3.270237215192168, 6.652312640064416, 4.918123189624691, 8.275690220800094, 5.984642887207112, 7.19229763827368, 7.763558738738352, 8.857941823152322, 7.918242358429905, 4.584906191147344, 8.078772851652879, 3.0199282435753165, 6.811538808472911, 6.65370952191264, 3.8493919510697228, 7.488169916617051, 10.096622412861928, 7.689518982116211, 5.655806319942658, 5.823948846606034, 6.292053761301091, 11.077549325368548, 5.0404153025064025, 1.668511254474344, 6.668868051693255, 3.2523417692451777, 5.274573061594888, 6.920913810664565, 8.359670801509019, 4.851108488917196, 8.431685998639335, 9.858731463125654, 3.709560257111408, 8.662162164681396, 6.381876750140429, 6.137016852203541, 6.238574515428385, 4.851656987988034, 6.207621843854691, 5.685105056987011, 5.30566319627703, 6.536068724866921, 6.038412047941585], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5785634082397388, "mean_inference_ms": 6.9100159090531585, "mean_action_processing_ms": 0.5528823389550341, "mean_env_wait_ms": 25.327438529001338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025615930557250977, "StateBufferConnector_ms": 0.015820741653442383, "ViewRequirementAgentConnector_ms": 0.6395206451416016}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2759442, "num_agent_steps_trained": 2759442, "num_env_steps_sampled": 2759442, "num_env_steps_trained": 2759442, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 297.91905662731796, "num_env_steps_trained_throughput_per_sec": 297.91905662731796, "timesteps_total": 2759442, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2759442, "timers": {"training_iteration_time_ms": 52167.887, "sample_time_ms": 40087.222, "load_time_ms": 587.311, "load_throughput": 26626.443, "learn_time_ms": 11120.075, "learn_throughput": 1406.286, "synch_weights_time_ms": 350.547}, "counters": {"num_env_steps_sampled": 2759442, "num_env_steps_trained": 2759442, "num_agent_steps_sampled": 2759442, "num_agent_steps_trained": 2759442}, "done": false, "episodes_total": 686, "training_iteration": 181, "trial_id": "c5092_00000", "date": "2025-06-08_10-23-55", "timestamp": 1749371035, "time_this_iter_s": 52.50606155395508, "time_total_s": 2581.7589621543884, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2581.7589621543884, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 79.80833333333335, "ram_util_percent": 60.68666666666666, "gpu_util_percent0": 0.08166666666666665, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.240558000000001e-05, "total_loss": -0.13118582786071453, "policy_loss": -0.02310268197077014, "vf_loss": 0.01287370891775936, "vf_explained_var": 0.7666091607917439, "kl": 0.027769279261013833, "entropy": 21.13373961015181, "entropy_coeff": 0.00540093}, "model": {}, "num_grad_updates_lifetime": 27225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2775080, "num_env_steps_trained": 2775080, "num_agent_steps_sampled": 2775080, "num_agent_steps_trained": 2775080}, "sampler_results": {"episode_reward_max": 11.077549325368548, "episode_reward_min": 0.44002638508364944, "episode_reward_mean": 6.212301280572323, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.983103988813295, 3.511269393488104, 8.90181071924953, 7.228229245037699, 8.168512744457269, 2.167393869892729, 7.869271722417587, 2.006983150355338, 9.105166419976102, 8.394748215761053, 10.06869091153073, 7.36886110637146, 6.265870328156384, 7.315165069957641, 6.797019705853401, 5.757903951404076, 8.72004283882164, 1.0317561071326233, 1.722249585859612, 5.3607071891870985, 10.366799531927589, 8.966252320630089, 10.574965798994137, 5.4065827362776915, 8.285518850188733, 6.760853366201647, 0.44002638508364944, 6.209364753951128, 9.260677071974763, 7.458041528969908, 3.9999696469931054, 3.9298422457929942, 3.8284994335593647, 8.003725619599798, 4.7672355797814205, 5.9418913946283505, 5.188284617259408, 5.869275374996845, 6.867653160287267, 4.467676672497823, 6.135242043920109, 6.823857852440962, 7.723552758220386, 3.270237215192168, 6.652312640064416, 4.918123189624691, 8.275690220800094, 5.984642887207112, 7.19229763827368, 7.763558738738352, 8.857941823152322, 7.918242358429905, 4.584906191147344, 8.078772851652879, 3.0199282435753165, 6.811538808472911, 6.65370952191264, 3.8493919510697228, 7.488169916617051, 10.096622412861928, 7.689518982116211, 5.655806319942658, 5.823948846606034, 6.292053761301091, 11.077549325368548, 5.0404153025064025, 1.668511254474344, 6.668868051693255, 3.2523417692451777, 5.274573061594888, 6.920913810664565, 8.359670801509019, 4.851108488917196, 8.431685998639335, 9.858731463125654, 3.709560257111408, 8.662162164681396, 6.381876750140429, 6.137016852203541, 6.238574515428385, 4.851656987988034, 6.207621843854691, 5.685105056987011, 5.30566319627703, 6.536068724866921, 6.038412047941585, 1.0722996334459356, 6.593384363461241, 7.688592167365702, 6.039415028249047, 5.9041336666864055, 6.593324794569423, 4.513899630912648, 6.576298930899447, 5.406471764588815, 5.294405155786472, 2.3647364862960014, 7.057958032943145, 6.481091346171737, 4.5880698039783], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5790963562189833, "mean_inference_ms": 6.913310351712989, "mean_action_processing_ms": 0.5531533064486599, "mean_env_wait_ms": 25.34252006721934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01959991455078125, "StateBufferConnector_ms": 0.01485586166381836, "ViewRequirementAgentConnector_ms": 0.642432451248169}}, "episode_reward_max": 11.077549325368548, "episode_reward_min": 0.44002638508364944, "episode_reward_mean": 6.212301280572323, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.983103988813295, 3.511269393488104, 8.90181071924953, 7.228229245037699, 8.168512744457269, 2.167393869892729, 7.869271722417587, 2.006983150355338, 9.105166419976102, 8.394748215761053, 10.06869091153073, 7.36886110637146, 6.265870328156384, 7.315165069957641, 6.797019705853401, 5.757903951404076, 8.72004283882164, 1.0317561071326233, 1.722249585859612, 5.3607071891870985, 10.366799531927589, 8.966252320630089, 10.574965798994137, 5.4065827362776915, 8.285518850188733, 6.760853366201647, 0.44002638508364944, 6.209364753951128, 9.260677071974763, 7.458041528969908, 3.9999696469931054, 3.9298422457929942, 3.8284994335593647, 8.003725619599798, 4.7672355797814205, 5.9418913946283505, 5.188284617259408, 5.869275374996845, 6.867653160287267, 4.467676672497823, 6.135242043920109, 6.823857852440962, 7.723552758220386, 3.270237215192168, 6.652312640064416, 4.918123189624691, 8.275690220800094, 5.984642887207112, 7.19229763827368, 7.763558738738352, 8.857941823152322, 7.918242358429905, 4.584906191147344, 8.078772851652879, 3.0199282435753165, 6.811538808472911, 6.65370952191264, 3.8493919510697228, 7.488169916617051, 10.096622412861928, 7.689518982116211, 5.655806319942658, 5.823948846606034, 6.292053761301091, 11.077549325368548, 5.0404153025064025, 1.668511254474344, 6.668868051693255, 3.2523417692451777, 5.274573061594888, 6.920913810664565, 8.359670801509019, 4.851108488917196, 8.431685998639335, 9.858731463125654, 3.709560257111408, 8.662162164681396, 6.381876750140429, 6.137016852203541, 6.238574515428385, 4.851656987988034, 6.207621843854691, 5.685105056987011, 5.30566319627703, 6.536068724866921, 6.038412047941585, 1.0722996334459356, 6.593384363461241, 7.688592167365702, 6.039415028249047, 5.9041336666864055, 6.593324794569423, 4.513899630912648, 6.576298930899447, 5.406471764588815, 5.294405155786472, 2.3647364862960014, 7.057958032943145, 6.481091346171737, 4.5880698039783], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5790963562189833, "mean_inference_ms": 6.913310351712989, "mean_action_processing_ms": 0.5531533064486599, "mean_env_wait_ms": 25.34252006721934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01959991455078125, "StateBufferConnector_ms": 0.01485586166381836, "ViewRequirementAgentConnector_ms": 0.642432451248169}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2775080, "num_agent_steps_trained": 2775080, "num_env_steps_sampled": 2775080, "num_env_steps_trained": 2775080, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 298.9056334136687, "num_env_steps_trained_throughput_per_sec": 298.9056334136687, "timesteps_total": 2775080, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2775080, "timers": {"training_iteration_time_ms": 52147.77, "sample_time_ms": 40063.409, "load_time_ms": 584.03, "load_throughput": 26776.032, "learn_time_ms": 11126.416, "learn_throughput": 1405.484, "synch_weights_time_ms": 351.039}, "counters": {"num_env_steps_sampled": 2775080, "num_env_steps_trained": 2775080, "num_agent_steps_sampled": 2775080, "num_agent_steps_trained": 2775080}, "done": false, "episodes_total": 700, "training_iteration": 182, "trial_id": "c5092_00000", "date": "2025-06-08_10-24-48", "timestamp": 1749371088, "time_this_iter_s": 52.33003568649292, "time_total_s": 2634.0889978408813, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2634.0889978408813, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 79.69499999999998, "ram_util_percent": 60.80333333333332, "gpu_util_percent0": 0.08566666666666665, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.22492e-05, "total_loss": -0.13132760107496075, "policy_loss": -0.023668145466134858, "vf_loss": 0.012495255596004427, "vf_explained_var": 0.76670966592702, "kl": 0.026860772680773002, "entropy": 21.122898531827058, "entropy_coeff": 0.005374866666666665}, "model": {}, "num_grad_updates_lifetime": 27775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2790718, "num_env_steps_trained": 2790718, "num_agent_steps_sampled": 2790718, "num_agent_steps_trained": 2790718}, "sampler_results": {"episode_reward_max": 11.077549325368548, "episode_reward_min": 0.44002638508364944, "episode_reward_mean": 6.215303969814484, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.797019705853401, 5.757903951404076, 8.72004283882164, 1.0317561071326233, 1.722249585859612, 5.3607071891870985, 10.366799531927589, 8.966252320630089, 10.574965798994137, 5.4065827362776915, 8.285518850188733, 6.760853366201647, 0.44002638508364944, 6.209364753951128, 9.260677071974763, 7.458041528969908, 3.9999696469931054, 3.9298422457929942, 3.8284994335593647, 8.003725619599798, 4.7672355797814205, 5.9418913946283505, 5.188284617259408, 5.869275374996845, 6.867653160287267, 4.467676672497823, 6.135242043920109, 6.823857852440962, 7.723552758220386, 3.270237215192168, 6.652312640064416, 4.918123189624691, 8.275690220800094, 5.984642887207112, 7.19229763827368, 7.763558738738352, 8.857941823152322, 7.918242358429905, 4.584906191147344, 8.078772851652879, 3.0199282435753165, 6.811538808472911, 6.65370952191264, 3.8493919510697228, 7.488169916617051, 10.096622412861928, 7.689518982116211, 5.655806319942658, 5.823948846606034, 6.292053761301091, 11.077549325368548, 5.0404153025064025, 1.668511254474344, 6.668868051693255, 3.2523417692451777, 5.274573061594888, 6.920913810664565, 8.359670801509019, 4.851108488917196, 8.431685998639335, 9.858731463125654, 3.709560257111408, 8.662162164681396, 6.381876750140429, 6.137016852203541, 6.238574515428385, 4.851656987988034, 6.207621843854691, 5.685105056987011, 5.30566319627703, 6.536068724866921, 6.038412047941585, 1.0722996334459356, 6.593384363461241, 7.688592167365702, 6.039415028249047, 5.9041336666864055, 6.593324794569423, 4.513899630912648, 6.576298930899447, 5.406471764588815, 5.294405155786472, 2.3647364862960014, 7.057958032943145, 6.481091346171737, 4.5880698039783, 7.779454051084735, 3.038932916021041, 7.292365738976827, 9.165736201111503, 8.088462315960859, 3.123109302524438, 6.844695954072184, 8.213847990260117, 6.225198683271155, 8.539202790748092, 6.489426393316806, 9.500854629208412, 4.393955491113741, 5.9601033520114495], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5793427026547022, "mean_inference_ms": 6.916362723992832, "mean_action_processing_ms": 0.553416211133145, "mean_env_wait_ms": 25.35704613665837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01859569549560547, "StateBufferConnector_ms": 0.01995372772216797, "ViewRequirementAgentConnector_ms": 0.6310486793518066}}, "episode_reward_max": 11.077549325368548, "episode_reward_min": 0.44002638508364944, "episode_reward_mean": 6.215303969814484, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.797019705853401, 5.757903951404076, 8.72004283882164, 1.0317561071326233, 1.722249585859612, 5.3607071891870985, 10.366799531927589, 8.966252320630089, 10.574965798994137, 5.4065827362776915, 8.285518850188733, 6.760853366201647, 0.44002638508364944, 6.209364753951128, 9.260677071974763, 7.458041528969908, 3.9999696469931054, 3.9298422457929942, 3.8284994335593647, 8.003725619599798, 4.7672355797814205, 5.9418913946283505, 5.188284617259408, 5.869275374996845, 6.867653160287267, 4.467676672497823, 6.135242043920109, 6.823857852440962, 7.723552758220386, 3.270237215192168, 6.652312640064416, 4.918123189624691, 8.275690220800094, 5.984642887207112, 7.19229763827368, 7.763558738738352, 8.857941823152322, 7.918242358429905, 4.584906191147344, 8.078772851652879, 3.0199282435753165, 6.811538808472911, 6.65370952191264, 3.8493919510697228, 7.488169916617051, 10.096622412861928, 7.689518982116211, 5.655806319942658, 5.823948846606034, 6.292053761301091, 11.077549325368548, 5.0404153025064025, 1.668511254474344, 6.668868051693255, 3.2523417692451777, 5.274573061594888, 6.920913810664565, 8.359670801509019, 4.851108488917196, 8.431685998639335, 9.858731463125654, 3.709560257111408, 8.662162164681396, 6.381876750140429, 6.137016852203541, 6.238574515428385, 4.851656987988034, 6.207621843854691, 5.685105056987011, 5.30566319627703, 6.536068724866921, 6.038412047941585, 1.0722996334459356, 6.593384363461241, 7.688592167365702, 6.039415028249047, 5.9041336666864055, 6.593324794569423, 4.513899630912648, 6.576298930899447, 5.406471764588815, 5.294405155786472, 2.3647364862960014, 7.057958032943145, 6.481091346171737, 4.5880698039783, 7.779454051084735, 3.038932916021041, 7.292365738976827, 9.165736201111503, 8.088462315960859, 3.123109302524438, 6.844695954072184, 8.213847990260117, 6.225198683271155, 8.539202790748092, 6.489426393316806, 9.500854629208412, 4.393955491113741, 5.9601033520114495], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5793427026547022, "mean_inference_ms": 6.916362723992832, "mean_action_processing_ms": 0.553416211133145, "mean_env_wait_ms": 25.35704613665837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01859569549560547, "StateBufferConnector_ms": 0.01995372772216797, "ViewRequirementAgentConnector_ms": 0.6310486793518066}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2790718, "num_agent_steps_trained": 2790718, "num_env_steps_sampled": 2790718, "num_env_steps_trained": 2790718, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 301.57536184638155, "num_env_steps_trained_throughput_per_sec": 301.57536184638155, "timesteps_total": 2790718, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2790718, "timers": {"training_iteration_time_ms": 52158.958, "sample_time_ms": 40050.039, "load_time_ms": 590.27, "load_throughput": 26492.955, "learn_time_ms": 11144.252, "learn_throughput": 1403.235, "synch_weights_time_ms": 351.123}, "counters": {"num_env_steps_sampled": 2790718, "num_env_steps_trained": 2790718, "num_agent_steps_sampled": 2790718, "num_agent_steps_trained": 2790718}, "done": false, "episodes_total": 714, "training_iteration": 183, "trial_id": "c5092_00000", "date": "2025-06-08_10-25-39", "timestamp": 1749371139, "time_this_iter_s": 51.86538124084473, "time_total_s": 2685.954379081726, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2685.954379081726, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 79.45333333333333, "ram_util_percent": 60.761666666666656, "gpu_util_percent0": 0.08666666666666668, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.209282000000003e-05, "total_loss": -0.13062048720703884, "policy_loss": -0.023474351762084882, "vf_loss": 0.01375732751436193, "vf_explained_var": 0.7703560480204495, "kl": 0.026792122747706756, "entropy": 21.1996259394559, "entropy_coeff": 0.005348803333333333}, "model": {}, "num_grad_updates_lifetime": 28325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2806356, "num_env_steps_trained": 2806356, "num_agent_steps_sampled": 2806356, "num_agent_steps_trained": 2806356}, "sampler_results": {"episode_reward_max": 13.700105825610036, "episode_reward_min": 1.0722996334459356, "episode_reward_mean": 6.210842841405359, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.260677071974763, 7.458041528969908, 3.9999696469931054, 3.9298422457929942, 3.8284994335593647, 8.003725619599798, 4.7672355797814205, 5.9418913946283505, 5.188284617259408, 5.869275374996845, 6.867653160287267, 4.467676672497823, 6.135242043920109, 6.823857852440962, 7.723552758220386, 3.270237215192168, 6.652312640064416, 4.918123189624691, 8.275690220800094, 5.984642887207112, 7.19229763827368, 7.763558738738352, 8.857941823152322, 7.918242358429905, 4.584906191147344, 8.078772851652879, 3.0199282435753165, 6.811538808472911, 6.65370952191264, 3.8493919510697228, 7.488169916617051, 10.096622412861928, 7.689518982116211, 5.655806319942658, 5.823948846606034, 6.292053761301091, 11.077549325368548, 5.0404153025064025, 1.668511254474344, 6.668868051693255, 3.2523417692451777, 5.274573061594888, 6.920913810664565, 8.359670801509019, 4.851108488917196, 8.431685998639335, 9.858731463125654, 3.709560257111408, 8.662162164681396, 6.381876750140429, 6.137016852203541, 6.238574515428385, 4.851656987988034, 6.207621843854691, 5.685105056987011, 5.30566319627703, 6.536068724866921, 6.038412047941585, 1.0722996334459356, 6.593384363461241, 7.688592167365702, 6.039415028249047, 5.9041336666864055, 6.593324794569423, 4.513899630912648, 6.576298930899447, 5.406471764588815, 5.294405155786472, 2.3647364862960014, 7.057958032943145, 6.481091346171737, 4.5880698039783, 7.779454051084735, 3.038932916021041, 7.292365738976827, 9.165736201111503, 8.088462315960859, 3.123109302524438, 6.844695954072184, 8.213847990260117, 6.225198683271155, 8.539202790748092, 6.489426393316806, 9.500854629208412, 4.393955491113741, 5.9601033520114495, 6.071029268942526, 6.938119055343779, 6.353171325402394, 7.782711428320298, 4.722873455052833, 5.022126793741986, 13.700105825610036, 4.663916505445222, 3.6532606142917277, 8.202414662785676, 4.788255351706532, 5.584669119410232, 3.8229956631012243, 4.648281211445893], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5799138899329552, "mean_inference_ms": 6.919195712683136, "mean_action_processing_ms": 0.553667861557052, "mean_env_wait_ms": 25.371842073289635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01473236083984375, "StateBufferConnector_ms": 0.025005340576171875, "ViewRequirementAgentConnector_ms": 0.6387896537780762}}, "episode_reward_max": 13.700105825610036, "episode_reward_min": 1.0722996334459356, "episode_reward_mean": 6.210842841405359, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.260677071974763, 7.458041528969908, 3.9999696469931054, 3.9298422457929942, 3.8284994335593647, 8.003725619599798, 4.7672355797814205, 5.9418913946283505, 5.188284617259408, 5.869275374996845, 6.867653160287267, 4.467676672497823, 6.135242043920109, 6.823857852440962, 7.723552758220386, 3.270237215192168, 6.652312640064416, 4.918123189624691, 8.275690220800094, 5.984642887207112, 7.19229763827368, 7.763558738738352, 8.857941823152322, 7.918242358429905, 4.584906191147344, 8.078772851652879, 3.0199282435753165, 6.811538808472911, 6.65370952191264, 3.8493919510697228, 7.488169916617051, 10.096622412861928, 7.689518982116211, 5.655806319942658, 5.823948846606034, 6.292053761301091, 11.077549325368548, 5.0404153025064025, 1.668511254474344, 6.668868051693255, 3.2523417692451777, 5.274573061594888, 6.920913810664565, 8.359670801509019, 4.851108488917196, 8.431685998639335, 9.858731463125654, 3.709560257111408, 8.662162164681396, 6.381876750140429, 6.137016852203541, 6.238574515428385, 4.851656987988034, 6.207621843854691, 5.685105056987011, 5.30566319627703, 6.536068724866921, 6.038412047941585, 1.0722996334459356, 6.593384363461241, 7.688592167365702, 6.039415028249047, 5.9041336666864055, 6.593324794569423, 4.513899630912648, 6.576298930899447, 5.406471764588815, 5.294405155786472, 2.3647364862960014, 7.057958032943145, 6.481091346171737, 4.5880698039783, 7.779454051084735, 3.038932916021041, 7.292365738976827, 9.165736201111503, 8.088462315960859, 3.123109302524438, 6.844695954072184, 8.213847990260117, 6.225198683271155, 8.539202790748092, 6.489426393316806, 9.500854629208412, 4.393955491113741, 5.9601033520114495, 6.071029268942526, 6.938119055343779, 6.353171325402394, 7.782711428320298, 4.722873455052833, 5.022126793741986, 13.700105825610036, 4.663916505445222, 3.6532606142917277, 8.202414662785676, 4.788255351706532, 5.584669119410232, 3.8229956631012243, 4.648281211445893], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5799138899329552, "mean_inference_ms": 6.919195712683136, "mean_action_processing_ms": 0.553667861557052, "mean_env_wait_ms": 25.371842073289635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01473236083984375, "StateBufferConnector_ms": 0.025005340576171875, "ViewRequirementAgentConnector_ms": 0.6387896537780762}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2806356, "num_agent_steps_trained": 2806356, "num_env_steps_sampled": 2806356, "num_env_steps_trained": 2806356, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 298.1839739269187, "num_env_steps_trained_throughput_per_sec": 298.1839739269187, "timesteps_total": 2806356, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2806356, "timers": {"training_iteration_time_ms": 52187.036, "sample_time_ms": 40084.092, "load_time_ms": 593.55, "load_throughput": 26346.562, "learn_time_ms": 11137.393, "learn_throughput": 1404.099, "synch_weights_time_ms": 349.631}, "counters": {"num_env_steps_sampled": 2806356, "num_env_steps_trained": 2806356, "num_agent_steps_sampled": 2806356, "num_agent_steps_trained": 2806356}, "done": false, "episodes_total": 728, "training_iteration": 184, "trial_id": "c5092_00000", "date": "2025-06-08_10-26-32", "timestamp": 1749371192, "time_this_iter_s": 52.460020780563354, "time_total_s": 2738.4143998622894, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2738.4143998622894, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 79.61999999999998, "ram_util_percent": 60.898333333333326, "gpu_util_percent0": 0.08066666666666666, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.193644e-05, "total_loss": -0.13119178088254888, "policy_loss": -0.024495439386545595, "vf_loss": 0.01208800286647271, "vf_explained_var": 0.7520657134056091, "kl": 0.026787954337171432, "entropy": 21.124779992537064, "entropy_coeff": 0.00532274}, "model": {}, "num_grad_updates_lifetime": 28875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2821994, "num_env_steps_trained": 2821994, "num_agent_steps_sampled": 2821994, "num_agent_steps_trained": 2821994}, "sampler_results": {"episode_reward_max": 13.700105825610036, "episode_reward_min": 1.0722996334459356, "episode_reward_mean": 6.252502725281613, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.723552758220386, 3.270237215192168, 6.652312640064416, 4.918123189624691, 8.275690220800094, 5.984642887207112, 7.19229763827368, 7.763558738738352, 8.857941823152322, 7.918242358429905, 4.584906191147344, 8.078772851652879, 3.0199282435753165, 6.811538808472911, 6.65370952191264, 3.8493919510697228, 7.488169916617051, 10.096622412861928, 7.689518982116211, 5.655806319942658, 5.823948846606034, 6.292053761301091, 11.077549325368548, 5.0404153025064025, 1.668511254474344, 6.668868051693255, 3.2523417692451777, 5.274573061594888, 6.920913810664565, 8.359670801509019, 4.851108488917196, 8.431685998639335, 9.858731463125654, 3.709560257111408, 8.662162164681396, 6.381876750140429, 6.137016852203541, 6.238574515428385, 4.851656987988034, 6.207621843854691, 5.685105056987011, 5.30566319627703, 6.536068724866921, 6.038412047941585, 1.0722996334459356, 6.593384363461241, 7.688592167365702, 6.039415028249047, 5.9041336666864055, 6.593324794569423, 4.513899630912648, 6.576298930899447, 5.406471764588815, 5.294405155786472, 2.3647364862960014, 7.057958032943145, 6.481091346171737, 4.5880698039783, 7.779454051084735, 3.038932916021041, 7.292365738976827, 9.165736201111503, 8.088462315960859, 3.123109302524438, 6.844695954072184, 8.213847990260117, 6.225198683271155, 8.539202790748092, 6.489426393316806, 9.500854629208412, 4.393955491113741, 5.9601033520114495, 6.071029268942526, 6.938119055343779, 6.353171325402394, 7.782711428320298, 4.722873455052833, 5.022126793741986, 13.700105825610036, 4.663916505445222, 3.6532606142917277, 8.202414662785676, 4.788255351706532, 5.584669119410232, 3.8229956631012243, 4.648281211445893, 5.668625418366437, 7.035389870408629, 5.532015022935711, 6.254218367907452, 4.5196585885627005, 6.728035199399309, 6.353879211068306, 6.828390202340564, 3.409660683725519, 9.033564053875331, 8.609197157618334, 5.902984474937345, 6.60256627528034, 4.22967610390148], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5803524358009897, "mean_inference_ms": 6.9222116783268, "mean_action_processing_ms": 0.5539591916604911, "mean_env_wait_ms": 25.386147241131216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013778209686279297, "StateBufferConnector_ms": 0.02799248695373535, "ViewRequirementAgentConnector_ms": 0.6315915584564209}}, "episode_reward_max": 13.700105825610036, "episode_reward_min": 1.0722996334459356, "episode_reward_mean": 6.252502725281613, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.723552758220386, 3.270237215192168, 6.652312640064416, 4.918123189624691, 8.275690220800094, 5.984642887207112, 7.19229763827368, 7.763558738738352, 8.857941823152322, 7.918242358429905, 4.584906191147344, 8.078772851652879, 3.0199282435753165, 6.811538808472911, 6.65370952191264, 3.8493919510697228, 7.488169916617051, 10.096622412861928, 7.689518982116211, 5.655806319942658, 5.823948846606034, 6.292053761301091, 11.077549325368548, 5.0404153025064025, 1.668511254474344, 6.668868051693255, 3.2523417692451777, 5.274573061594888, 6.920913810664565, 8.359670801509019, 4.851108488917196, 8.431685998639335, 9.858731463125654, 3.709560257111408, 8.662162164681396, 6.381876750140429, 6.137016852203541, 6.238574515428385, 4.851656987988034, 6.207621843854691, 5.685105056987011, 5.30566319627703, 6.536068724866921, 6.038412047941585, 1.0722996334459356, 6.593384363461241, 7.688592167365702, 6.039415028249047, 5.9041336666864055, 6.593324794569423, 4.513899630912648, 6.576298930899447, 5.406471764588815, 5.294405155786472, 2.3647364862960014, 7.057958032943145, 6.481091346171737, 4.5880698039783, 7.779454051084735, 3.038932916021041, 7.292365738976827, 9.165736201111503, 8.088462315960859, 3.123109302524438, 6.844695954072184, 8.213847990260117, 6.225198683271155, 8.539202790748092, 6.489426393316806, 9.500854629208412, 4.393955491113741, 5.9601033520114495, 6.071029268942526, 6.938119055343779, 6.353171325402394, 7.782711428320298, 4.722873455052833, 5.022126793741986, 13.700105825610036, 4.663916505445222, 3.6532606142917277, 8.202414662785676, 4.788255351706532, 5.584669119410232, 3.8229956631012243, 4.648281211445893, 5.668625418366437, 7.035389870408629, 5.532015022935711, 6.254218367907452, 4.5196585885627005, 6.728035199399309, 6.353879211068306, 6.828390202340564, 3.409660683725519, 9.033564053875331, 8.609197157618334, 5.902984474937345, 6.60256627528034, 4.22967610390148], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5803524358009897, "mean_inference_ms": 6.9222116783268, "mean_action_processing_ms": 0.5539591916604911, "mean_env_wait_ms": 25.386147241131216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013778209686279297, "StateBufferConnector_ms": 0.02799248695373535, "ViewRequirementAgentConnector_ms": 0.6315915584564209}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2821994, "num_agent_steps_trained": 2821994, "num_env_steps_sampled": 2821994, "num_env_steps_trained": 2821994, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 300.0824469888981, "num_env_steps_trained_throughput_per_sec": 300.0824469888981, "timesteps_total": 2821994, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2821994, "timers": {"training_iteration_time_ms": 52158.557, "sample_time_ms": 40048.851, "load_time_ms": 592.703, "load_throughput": 26384.195, "learn_time_ms": 11140.437, "learn_throughput": 1403.715, "synch_weights_time_ms": 352.394}, "counters": {"num_env_steps_sampled": 2821994, "num_env_steps_trained": 2821994, "num_agent_steps_sampled": 2821994, "num_agent_steps_trained": 2821994}, "done": false, "episodes_total": 742, "training_iteration": 185, "trial_id": "c5092_00000", "date": "2025-06-08_10-27-24", "timestamp": 1749371244, "time_this_iter_s": 52.126307010650635, "time_total_s": 2790.54070687294, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2790.54070687294, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 79.29666666666667, "ram_util_percent": 61.11000000000001, "gpu_util_percent0": 0.08149999999999999, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.178006e-05, "total_loss": -0.14032349769195374, "policy_loss": -0.033642676561562855, "vf_loss": 0.0115754442949864, "vf_explained_var": 0.7502356094663793, "kl": 0.027962328688671923, "entropy": 21.214304894534024, "entropy_coeff": 0.0052966766666666665}, "model": {}, "num_grad_updates_lifetime": 29425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2837632, "num_env_steps_trained": 2837632, "num_agent_steps_sampled": 2837632, "num_agent_steps_trained": 2837632}, "sampler_results": {"episode_reward_max": 13.700105825610036, "episode_reward_min": 1.0722996334459356, "episode_reward_mean": 6.114056570796114, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.65370952191264, 3.8493919510697228, 7.488169916617051, 10.096622412861928, 7.689518982116211, 5.655806319942658, 5.823948846606034, 6.292053761301091, 11.077549325368548, 5.0404153025064025, 1.668511254474344, 6.668868051693255, 3.2523417692451777, 5.274573061594888, 6.920913810664565, 8.359670801509019, 4.851108488917196, 8.431685998639335, 9.858731463125654, 3.709560257111408, 8.662162164681396, 6.381876750140429, 6.137016852203541, 6.238574515428385, 4.851656987988034, 6.207621843854691, 5.685105056987011, 5.30566319627703, 6.536068724866921, 6.038412047941585, 1.0722996334459356, 6.593384363461241, 7.688592167365702, 6.039415028249047, 5.9041336666864055, 6.593324794569423, 4.513899630912648, 6.576298930899447, 5.406471764588815, 5.294405155786472, 2.3647364862960014, 7.057958032943145, 6.481091346171737, 4.5880698039783, 7.779454051084735, 3.038932916021041, 7.292365738976827, 9.165736201111503, 8.088462315960859, 3.123109302524438, 6.844695954072184, 8.213847990260117, 6.225198683271155, 8.539202790748092, 6.489426393316806, 9.500854629208412, 4.393955491113741, 5.9601033520114495, 6.071029268942526, 6.938119055343779, 6.353171325402394, 7.782711428320298, 4.722873455052833, 5.022126793741986, 13.700105825610036, 4.663916505445222, 3.6532606142917277, 8.202414662785676, 4.788255351706532, 5.584669119410232, 3.8229956631012243, 4.648281211445893, 5.668625418366437, 7.035389870408629, 5.532015022935711, 6.254218367907452, 4.5196585885627005, 6.728035199399309, 6.353879211068306, 6.828390202340564, 3.409660683725519, 9.033564053875331, 8.609197157618334, 5.902984474937345, 6.60256627528034, 4.22967610390148, 2.62499946278112, 8.09985733600772, 3.7733372434930623, 5.528799715121695, 3.872404143077997, 3.8829498765606743, 5.503531108395532, 5.103729481566463, 4.620981283453503, 10.051439327521079, 6.712787628740704, 7.177597143297563, 4.431818994132144, 5.822897371852482], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.580779696470943, "mean_inference_ms": 6.925066661366094, "mean_action_processing_ms": 0.5542219566917397, "mean_env_wait_ms": 25.399141504344293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013782501220703125, "StateBufferConnector_ms": 0.030284643173217773, "ViewRequirementAgentConnector_ms": 0.6439075469970703}}, "episode_reward_max": 13.700105825610036, "episode_reward_min": 1.0722996334459356, "episode_reward_mean": 6.114056570796114, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.65370952191264, 3.8493919510697228, 7.488169916617051, 10.096622412861928, 7.689518982116211, 5.655806319942658, 5.823948846606034, 6.292053761301091, 11.077549325368548, 5.0404153025064025, 1.668511254474344, 6.668868051693255, 3.2523417692451777, 5.274573061594888, 6.920913810664565, 8.359670801509019, 4.851108488917196, 8.431685998639335, 9.858731463125654, 3.709560257111408, 8.662162164681396, 6.381876750140429, 6.137016852203541, 6.238574515428385, 4.851656987988034, 6.207621843854691, 5.685105056987011, 5.30566319627703, 6.536068724866921, 6.038412047941585, 1.0722996334459356, 6.593384363461241, 7.688592167365702, 6.039415028249047, 5.9041336666864055, 6.593324794569423, 4.513899630912648, 6.576298930899447, 5.406471764588815, 5.294405155786472, 2.3647364862960014, 7.057958032943145, 6.481091346171737, 4.5880698039783, 7.779454051084735, 3.038932916021041, 7.292365738976827, 9.165736201111503, 8.088462315960859, 3.123109302524438, 6.844695954072184, 8.213847990260117, 6.225198683271155, 8.539202790748092, 6.489426393316806, 9.500854629208412, 4.393955491113741, 5.9601033520114495, 6.071029268942526, 6.938119055343779, 6.353171325402394, 7.782711428320298, 4.722873455052833, 5.022126793741986, 13.700105825610036, 4.663916505445222, 3.6532606142917277, 8.202414662785676, 4.788255351706532, 5.584669119410232, 3.8229956631012243, 4.648281211445893, 5.668625418366437, 7.035389870408629, 5.532015022935711, 6.254218367907452, 4.5196585885627005, 6.728035199399309, 6.353879211068306, 6.828390202340564, 3.409660683725519, 9.033564053875331, 8.609197157618334, 5.902984474937345, 6.60256627528034, 4.22967610390148, 2.62499946278112, 8.09985733600772, 3.7733372434930623, 5.528799715121695, 3.872404143077997, 3.8829498765606743, 5.503531108395532, 5.103729481566463, 4.620981283453503, 10.051439327521079, 6.712787628740704, 7.177597143297563, 4.431818994132144, 5.822897371852482], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.580779696470943, "mean_inference_ms": 6.925066661366094, "mean_action_processing_ms": 0.5542219566917397, "mean_env_wait_ms": 25.399141504344293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013782501220703125, "StateBufferConnector_ms": 0.030284643173217773, "ViewRequirementAgentConnector_ms": 0.6439075469970703}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2837632, "num_agent_steps_trained": 2837632, "num_env_steps_sampled": 2837632, "num_env_steps_trained": 2837632, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 300.1900264610878, "num_env_steps_trained_throughput_per_sec": 300.1900264610878, "timesteps_total": 2837632, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2837632, "timers": {"training_iteration_time_ms": 52204.504, "sample_time_ms": 40076.928, "load_time_ms": 595.202, "load_throughput": 26273.418, "learn_time_ms": 11160.125, "learn_throughput": 1401.239, "synch_weights_time_ms": 347.586}, "counters": {"num_env_steps_sampled": 2837632, "num_env_steps_trained": 2837632, "num_agent_steps_sampled": 2837632, "num_agent_steps_trained": 2837632}, "done": false, "episodes_total": 756, "training_iteration": 186, "trial_id": "c5092_00000", "date": "2025-06-08_10-28-16", "timestamp": 1749371296, "time_this_iter_s": 52.1036696434021, "time_total_s": 2842.644376516342, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2842.644376516342, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 80.05166666666666, "ram_util_percent": 61.12833333333333, "gpu_util_percent0": 0.08299999999999999, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.162368000000002e-05, "total_loss": -0.13025251077742062, "policy_loss": -0.02458399293520911, "vf_loss": 0.012068384971723637, "vf_explained_var": 0.7578273488174785, "kl": 0.02628215051446901, "entropy": 21.129987222498112, "entropy_coeff": 0.005270613333333334}, "model": {}, "num_grad_updates_lifetime": 29975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2853270, "num_env_steps_trained": 2853270, "num_agent_steps_sampled": 2853270, "num_agent_steps_trained": 2853270}, "sampler_results": {"episode_reward_max": 13.700105825610036, "episode_reward_min": 0.33930846963199257, "episode_reward_mean": 6.011791627972033, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.920913810664565, 8.359670801509019, 4.851108488917196, 8.431685998639335, 9.858731463125654, 3.709560257111408, 8.662162164681396, 6.381876750140429, 6.137016852203541, 6.238574515428385, 4.851656987988034, 6.207621843854691, 5.685105056987011, 5.30566319627703, 6.536068724866921, 6.038412047941585, 1.0722996334459356, 6.593384363461241, 7.688592167365702, 6.039415028249047, 5.9041336666864055, 6.593324794569423, 4.513899630912648, 6.576298930899447, 5.406471764588815, 5.294405155786472, 2.3647364862960014, 7.057958032943145, 6.481091346171737, 4.5880698039783, 7.779454051084735, 3.038932916021041, 7.292365738976827, 9.165736201111503, 8.088462315960859, 3.123109302524438, 6.844695954072184, 8.213847990260117, 6.225198683271155, 8.539202790748092, 6.489426393316806, 9.500854629208412, 4.393955491113741, 5.9601033520114495, 6.071029268942526, 6.938119055343779, 6.353171325402394, 7.782711428320298, 4.722873455052833, 5.022126793741986, 13.700105825610036, 4.663916505445222, 3.6532606142917277, 8.202414662785676, 4.788255351706532, 5.584669119410232, 3.8229956631012243, 4.648281211445893, 5.668625418366437, 7.035389870408629, 5.532015022935711, 6.254218367907452, 4.5196585885627005, 6.728035199399309, 6.353879211068306, 6.828390202340564, 3.409660683725519, 9.033564053875331, 8.609197157618334, 5.902984474937345, 6.60256627528034, 4.22967610390148, 2.62499946278112, 8.09985733600772, 3.7733372434930623, 5.528799715121695, 3.872404143077997, 3.8829498765606743, 5.503531108395532, 5.103729481566463, 4.620981283453503, 10.051439327521079, 6.712787628740704, 7.177597143297563, 4.431818994132144, 5.822897371852482, 5.275053807791634, 7.923521707482864, 6.585982466798622, 6.4429299623524106, 4.556877652753484, 5.954140992327261, 6.281158840578806, 2.7695558628842245, 5.288026745610046, 4.235842196445439, 3.799510385794304, 9.870864751635478, 0.33930846963199257, 6.982212352815277], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5809179867351433, "mean_inference_ms": 6.927877790924004, "mean_action_processing_ms": 0.5544641500962473, "mean_env_wait_ms": 25.412068474140234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012408971786499023, "StateBufferConnector_ms": 0.030299901962280273, "ViewRequirementAgentConnector_ms": 0.5981020927429199}}, "episode_reward_max": 13.700105825610036, "episode_reward_min": 0.33930846963199257, "episode_reward_mean": 6.011791627972033, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.920913810664565, 8.359670801509019, 4.851108488917196, 8.431685998639335, 9.858731463125654, 3.709560257111408, 8.662162164681396, 6.381876750140429, 6.137016852203541, 6.238574515428385, 4.851656987988034, 6.207621843854691, 5.685105056987011, 5.30566319627703, 6.536068724866921, 6.038412047941585, 1.0722996334459356, 6.593384363461241, 7.688592167365702, 6.039415028249047, 5.9041336666864055, 6.593324794569423, 4.513899630912648, 6.576298930899447, 5.406471764588815, 5.294405155786472, 2.3647364862960014, 7.057958032943145, 6.481091346171737, 4.5880698039783, 7.779454051084735, 3.038932916021041, 7.292365738976827, 9.165736201111503, 8.088462315960859, 3.123109302524438, 6.844695954072184, 8.213847990260117, 6.225198683271155, 8.539202790748092, 6.489426393316806, 9.500854629208412, 4.393955491113741, 5.9601033520114495, 6.071029268942526, 6.938119055343779, 6.353171325402394, 7.782711428320298, 4.722873455052833, 5.022126793741986, 13.700105825610036, 4.663916505445222, 3.6532606142917277, 8.202414662785676, 4.788255351706532, 5.584669119410232, 3.8229956631012243, 4.648281211445893, 5.668625418366437, 7.035389870408629, 5.532015022935711, 6.254218367907452, 4.5196585885627005, 6.728035199399309, 6.353879211068306, 6.828390202340564, 3.409660683725519, 9.033564053875331, 8.609197157618334, 5.902984474937345, 6.60256627528034, 4.22967610390148, 2.62499946278112, 8.09985733600772, 3.7733372434930623, 5.528799715121695, 3.872404143077997, 3.8829498765606743, 5.503531108395532, 5.103729481566463, 4.620981283453503, 10.051439327521079, 6.712787628740704, 7.177597143297563, 4.431818994132144, 5.822897371852482, 5.275053807791634, 7.923521707482864, 6.585982466798622, 6.4429299623524106, 4.556877652753484, 5.954140992327261, 6.281158840578806, 2.7695558628842245, 5.288026745610046, 4.235842196445439, 3.799510385794304, 9.870864751635478, 0.33930846963199257, 6.982212352815277], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5809179867351433, "mean_inference_ms": 6.927877790924004, "mean_action_processing_ms": 0.5544641500962473, "mean_env_wait_ms": 25.412068474140234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012408971786499023, "StateBufferConnector_ms": 0.030299901962280273, "ViewRequirementAgentConnector_ms": 0.5981020927429199}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2853270, "num_agent_steps_trained": 2853270, "num_env_steps_sampled": 2853270, "num_env_steps_trained": 2853270, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 300.4115740767437, "num_env_steps_trained_throughput_per_sec": 300.4115740767437, "timesteps_total": 2853270, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2853270, "timers": {"training_iteration_time_ms": 52209.946, "sample_time_ms": 40068.036, "load_time_ms": 605.793, "load_throughput": 25814.094, "learn_time_ms": 11160.163, "learn_throughput": 1401.234, "synch_weights_time_ms": 351.206}, "counters": {"num_env_steps_sampled": 2853270, "num_env_steps_trained": 2853270, "num_agent_steps_sampled": 2853270, "num_agent_steps_trained": 2853270}, "done": false, "episodes_total": 770, "training_iteration": 187, "trial_id": "c5092_00000", "date": "2025-06-08_10-29-08", "timestamp": 1749371348, "time_this_iter_s": 52.06722545623779, "time_total_s": 2894.71160197258, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2894.71160197258, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 78.76666666666667, "ram_util_percent": 61.163333333333334, "gpu_util_percent0": 0.08366666666666668, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.14673e-05, "total_loss": -0.15061293060965414, "policy_loss": -0.04543509822127155, "vf_loss": 0.012139739897525446, "vf_explained_var": 0.7741715960069137, "kl": 0.026502041549276368, "entropy": 21.148832936720414, "entropy_coeff": 0.00524455}, "model": {}, "num_grad_updates_lifetime": 30525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2868908, "num_env_steps_trained": 2868908, "num_agent_steps_sampled": 2868908, "num_agent_steps_trained": 2868908}, "sampler_results": {"episode_reward_max": 13.700105825610036, "episode_reward_min": 0.33930846963199257, "episode_reward_mean": 5.864025711291813, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.536068724866921, 6.038412047941585, 1.0722996334459356, 6.593384363461241, 7.688592167365702, 6.039415028249047, 5.9041336666864055, 6.593324794569423, 4.513899630912648, 6.576298930899447, 5.406471764588815, 5.294405155786472, 2.3647364862960014, 7.057958032943145, 6.481091346171737, 4.5880698039783, 7.779454051084735, 3.038932916021041, 7.292365738976827, 9.165736201111503, 8.088462315960859, 3.123109302524438, 6.844695954072184, 8.213847990260117, 6.225198683271155, 8.539202790748092, 6.489426393316806, 9.500854629208412, 4.393955491113741, 5.9601033520114495, 6.071029268942526, 6.938119055343779, 6.353171325402394, 7.782711428320298, 4.722873455052833, 5.022126793741986, 13.700105825610036, 4.663916505445222, 3.6532606142917277, 8.202414662785676, 4.788255351706532, 5.584669119410232, 3.8229956631012243, 4.648281211445893, 5.668625418366437, 7.035389870408629, 5.532015022935711, 6.254218367907452, 4.5196585885627005, 6.728035199399309, 6.353879211068306, 6.828390202340564, 3.409660683725519, 9.033564053875331, 8.609197157618334, 5.902984474937345, 6.60256627528034, 4.22967610390148, 2.62499946278112, 8.09985733600772, 3.7733372434930623, 5.528799715121695, 3.872404143077997, 3.8829498765606743, 5.503531108395532, 5.103729481566463, 4.620981283453503, 10.051439327521079, 6.712787628740704, 7.177597143297563, 4.431818994132144, 5.822897371852482, 5.275053807791634, 7.923521707482864, 6.585982466798622, 6.4429299623524106, 4.556877652753484, 5.954140992327261, 6.281158840578806, 2.7695558628842245, 5.288026745610046, 4.235842196445439, 3.799510385794304, 9.870864751635478, 0.33930846963199257, 6.982212352815277, 9.48330516375612, 2.6038655723918893, 2.2151445404419983, 9.07203588459203, 4.337093959003152, 1.5777755520911536, 2.9316709822103406, 8.767994938781111, 6.589110905967515, 5.232634254193093, 7.718161488552261, 5.246422431838162, 3.149302064610747, 7.900238781076111], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.58124073667316, "mean_inference_ms": 6.933356452116792, "mean_action_processing_ms": 0.5550115193760725, "mean_env_wait_ms": 25.431246685716154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012392520904541016, "StateBufferConnector_ms": 0.029750585556030273, "ViewRequirementAgentConnector_ms": 0.6109638214111328}}, "episode_reward_max": 13.700105825610036, "episode_reward_min": 0.33930846963199257, "episode_reward_mean": 5.864025711291813, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.536068724866921, 6.038412047941585, 1.0722996334459356, 6.593384363461241, 7.688592167365702, 6.039415028249047, 5.9041336666864055, 6.593324794569423, 4.513899630912648, 6.576298930899447, 5.406471764588815, 5.294405155786472, 2.3647364862960014, 7.057958032943145, 6.481091346171737, 4.5880698039783, 7.779454051084735, 3.038932916021041, 7.292365738976827, 9.165736201111503, 8.088462315960859, 3.123109302524438, 6.844695954072184, 8.213847990260117, 6.225198683271155, 8.539202790748092, 6.489426393316806, 9.500854629208412, 4.393955491113741, 5.9601033520114495, 6.071029268942526, 6.938119055343779, 6.353171325402394, 7.782711428320298, 4.722873455052833, 5.022126793741986, 13.700105825610036, 4.663916505445222, 3.6532606142917277, 8.202414662785676, 4.788255351706532, 5.584669119410232, 3.8229956631012243, 4.648281211445893, 5.668625418366437, 7.035389870408629, 5.532015022935711, 6.254218367907452, 4.5196585885627005, 6.728035199399309, 6.353879211068306, 6.828390202340564, 3.409660683725519, 9.033564053875331, 8.609197157618334, 5.902984474937345, 6.60256627528034, 4.22967610390148, 2.62499946278112, 8.09985733600772, 3.7733372434930623, 5.528799715121695, 3.872404143077997, 3.8829498765606743, 5.503531108395532, 5.103729481566463, 4.620981283453503, 10.051439327521079, 6.712787628740704, 7.177597143297563, 4.431818994132144, 5.822897371852482, 5.275053807791634, 7.923521707482864, 6.585982466798622, 6.4429299623524106, 4.556877652753484, 5.954140992327261, 6.281158840578806, 2.7695558628842245, 5.288026745610046, 4.235842196445439, 3.799510385794304, 9.870864751635478, 0.33930846963199257, 6.982212352815277, 9.48330516375612, 2.6038655723918893, 2.2151445404419983, 9.07203588459203, 4.337093959003152, 1.5777755520911536, 2.9316709822103406, 8.767994938781111, 6.589110905967515, 5.232634254193093, 7.718161488552261, 5.246422431838162, 3.149302064610747, 7.900238781076111], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.58124073667316, "mean_inference_ms": 6.933356452116792, "mean_action_processing_ms": 0.5550115193760725, "mean_env_wait_ms": 25.431246685716154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012392520904541016, "StateBufferConnector_ms": 0.029750585556030273, "ViewRequirementAgentConnector_ms": 0.6109638214111328}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2868908, "num_agent_steps_trained": 2868908, "num_env_steps_sampled": 2868908, "num_env_steps_trained": 2868908, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 264.7186910101083, "num_env_steps_trained_throughput_per_sec": 264.7186910101083, "timesteps_total": 2868908, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2868908, "timers": {"training_iteration_time_ms": 52905.629, "sample_time_ms": 40558.278, "load_time_ms": 614.947, "load_throughput": 25429.816, "learn_time_ms": 11345.758, "learn_throughput": 1378.312, "synch_weights_time_ms": 361.354}, "counters": {"num_env_steps_sampled": 2868908, "num_env_steps_trained": 2868908, "num_agent_steps_sampled": 2868908, "num_agent_steps_trained": 2868908}, "done": false, "episodes_total": 784, "training_iteration": 188, "trial_id": "c5092_00000", "date": "2025-06-08_10-30-08", "timestamp": 1749371408, "time_this_iter_s": 59.0900354385376, "time_total_s": 2953.8016374111176, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2953.8016374111176, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 79.55074626865671, "ram_util_percent": 61.84029850746268, "gpu_util_percent0": 0.0764179104477612, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.131092e-05, "total_loss": -0.13849605694222689, "policy_loss": -0.03421775998992168, "vf_loss": 0.013236721646125344, "vf_explained_var": 0.7880886245857586, "kl": 0.02557575770525688, "entropy": 21.13110567266291, "entropy_coeff": 0.005218486666666668}, "model": {}, "num_grad_updates_lifetime": 31075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2884546, "num_env_steps_trained": 2884546, "num_agent_steps_sampled": 2884546, "num_agent_steps_trained": 2884546}, "sampler_results": {"episode_reward_max": 13.700105825610036, "episode_reward_min": 0.33930846963199257, "episode_reward_mean": 5.955562954874206, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.481091346171737, 4.5880698039783, 7.779454051084735, 3.038932916021041, 7.292365738976827, 9.165736201111503, 8.088462315960859, 3.123109302524438, 6.844695954072184, 8.213847990260117, 6.225198683271155, 8.539202790748092, 6.489426393316806, 9.500854629208412, 4.393955491113741, 5.9601033520114495, 6.071029268942526, 6.938119055343779, 6.353171325402394, 7.782711428320298, 4.722873455052833, 5.022126793741986, 13.700105825610036, 4.663916505445222, 3.6532606142917277, 8.202414662785676, 4.788255351706532, 5.584669119410232, 3.8229956631012243, 4.648281211445893, 5.668625418366437, 7.035389870408629, 5.532015022935711, 6.254218367907452, 4.5196585885627005, 6.728035199399309, 6.353879211068306, 6.828390202340564, 3.409660683725519, 9.033564053875331, 8.609197157618334, 5.902984474937345, 6.60256627528034, 4.22967610390148, 2.62499946278112, 8.09985733600772, 3.7733372434930623, 5.528799715121695, 3.872404143077997, 3.8829498765606743, 5.503531108395532, 5.103729481566463, 4.620981283453503, 10.051439327521079, 6.712787628740704, 7.177597143297563, 4.431818994132144, 5.822897371852482, 5.275053807791634, 7.923521707482864, 6.585982466798622, 6.4429299623524106, 4.556877652753484, 5.954140992327261, 6.281158840578806, 2.7695558628842245, 5.288026745610046, 4.235842196445439, 3.799510385794304, 9.870864751635478, 0.33930846963199257, 6.982212352815277, 9.48330516375612, 2.6038655723918893, 2.2151445404419983, 9.07203588459203, 4.337093959003152, 1.5777755520911536, 2.9316709822103406, 8.767994938781111, 6.589110905967515, 5.232634254193093, 7.718161488552261, 5.246422431838162, 3.149302064610747, 7.900238781076111, 9.131511516051487, 3.1001468920812116, 6.223455288286242, 8.688298111579938, 6.326753108162209, 7.596535759702415, 1.8879200689331035, 7.654712271158421, 11.532481531862596, 6.1906741756796695, 1.8898645220997445, 3.5588506448545028, 7.098370237110624, 5.953550658689939], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.581830663585389, "mean_inference_ms": 6.939975339225087, "mean_action_processing_ms": 0.5557846670213308, "mean_env_wait_ms": 25.452922536766906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01742386817932129, "StateBufferConnector_ms": 0.03435063362121582, "ViewRequirementAgentConnector_ms": 0.627934455871582}}, "episode_reward_max": 13.700105825610036, "episode_reward_min": 0.33930846963199257, "episode_reward_mean": 5.955562954874206, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.481091346171737, 4.5880698039783, 7.779454051084735, 3.038932916021041, 7.292365738976827, 9.165736201111503, 8.088462315960859, 3.123109302524438, 6.844695954072184, 8.213847990260117, 6.225198683271155, 8.539202790748092, 6.489426393316806, 9.500854629208412, 4.393955491113741, 5.9601033520114495, 6.071029268942526, 6.938119055343779, 6.353171325402394, 7.782711428320298, 4.722873455052833, 5.022126793741986, 13.700105825610036, 4.663916505445222, 3.6532606142917277, 8.202414662785676, 4.788255351706532, 5.584669119410232, 3.8229956631012243, 4.648281211445893, 5.668625418366437, 7.035389870408629, 5.532015022935711, 6.254218367907452, 4.5196585885627005, 6.728035199399309, 6.353879211068306, 6.828390202340564, 3.409660683725519, 9.033564053875331, 8.609197157618334, 5.902984474937345, 6.60256627528034, 4.22967610390148, 2.62499946278112, 8.09985733600772, 3.7733372434930623, 5.528799715121695, 3.872404143077997, 3.8829498765606743, 5.503531108395532, 5.103729481566463, 4.620981283453503, 10.051439327521079, 6.712787628740704, 7.177597143297563, 4.431818994132144, 5.822897371852482, 5.275053807791634, 7.923521707482864, 6.585982466798622, 6.4429299623524106, 4.556877652753484, 5.954140992327261, 6.281158840578806, 2.7695558628842245, 5.288026745610046, 4.235842196445439, 3.799510385794304, 9.870864751635478, 0.33930846963199257, 6.982212352815277, 9.48330516375612, 2.6038655723918893, 2.2151445404419983, 9.07203588459203, 4.337093959003152, 1.5777755520911536, 2.9316709822103406, 8.767994938781111, 6.589110905967515, 5.232634254193093, 7.718161488552261, 5.246422431838162, 3.149302064610747, 7.900238781076111, 9.131511516051487, 3.1001468920812116, 6.223455288286242, 8.688298111579938, 6.326753108162209, 7.596535759702415, 1.8879200689331035, 7.654712271158421, 11.532481531862596, 6.1906741756796695, 1.8898645220997445, 3.5588506448545028, 7.098370237110624, 5.953550658689939], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.581830663585389, "mean_inference_ms": 6.939975339225087, "mean_action_processing_ms": 0.5557846670213308, "mean_env_wait_ms": 25.452922536766906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01742386817932129, "StateBufferConnector_ms": 0.03435063362121582, "ViewRequirementAgentConnector_ms": 0.627934455871582}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2884546, "num_agent_steps_trained": 2884546, "num_env_steps_sampled": 2884546, "num_env_steps_trained": 2884546, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.0623811903851, "num_env_steps_trained_throughput_per_sec": 278.0623811903851, "timesteps_total": 2884546, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2884546, "timers": {"training_iteration_time_ms": 53300.004, "sample_time_ms": 40775.664, "load_time_ms": 627.244, "load_throughput": 24931.272, "learn_time_ms": 11506.598, "learn_throughput": 1359.046, "synch_weights_time_ms": 366.806}, "counters": {"num_env_steps_sampled": 2884546, "num_env_steps_trained": 2884546, "num_agent_steps_sampled": 2884546, "num_agent_steps_trained": 2884546}, "done": false, "episodes_total": 798, "training_iteration": 189, "trial_id": "c5092_00000", "date": "2025-06-08_10-31-04", "timestamp": 1749371464, "time_this_iter_s": 56.254178285598755, "time_total_s": 3010.0558156967163, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3010.0558156967163, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 79.42307692307692, "ram_util_percent": 62.38, "gpu_util_percent0": 0.07830769230769229, "vram_util_percent0": 0.18831380208333331}}
{"evaluation": {"sampler_results": {"episode_reward_max": -0.293942886625175, "episode_reward_min": -6.566384981937494, "episode_reward_mean": -3.812072213895828, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.575466703575393, -0.293942886625175, -3.8491917866656613, -6.566384981937494, -2.7753747106754134], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2010978882754675, "mean_inference_ms": 3.5358407508648084, "mean_action_processing_ms": 0.2524096074206353, "mean_env_wait_ms": 11.149641954686965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20351409912109375}}, "episode_reward_max": -0.293942886625175, "episode_reward_min": -6.566384981937494, "episode_reward_mean": -3.812072213895828, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.575466703575393, -0.293942886625175, -3.8491917866656613, -6.566384981937494, -2.7753747106754134], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2010978882754675, "mean_inference_ms": 3.5358407508648084, "mean_action_processing_ms": 0.2524096074206353, "mean_env_wait_ms": 11.149641954686965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20351409912109375}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.115454000000001e-05, "total_loss": -0.13594860530416059, "policy_loss": -0.03193902826165413, "vf_loss": 0.011602876550009982, "vf_explained_var": 0.8018365752696991, "kl": 0.02621151212550089, "entropy": 21.10070908286355, "entropy_coeff": 0.005192423333333333}, "model": {}, "num_grad_updates_lifetime": 31625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2900184, "num_env_steps_trained": 2900184, "num_agent_steps_sampled": 2900184, "num_agent_steps_trained": 2900184}, "sampler_results": {"episode_reward_max": 13.700105825610036, "episode_reward_min": 0.33930846963199257, "episode_reward_mean": 5.927601493431876, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.393955491113741, 5.9601033520114495, 6.071029268942526, 6.938119055343779, 6.353171325402394, 7.782711428320298, 4.722873455052833, 5.022126793741986, 13.700105825610036, 4.663916505445222, 3.6532606142917277, 8.202414662785676, 4.788255351706532, 5.584669119410232, 3.8229956631012243, 4.648281211445893, 5.668625418366437, 7.035389870408629, 5.532015022935711, 6.254218367907452, 4.5196585885627005, 6.728035199399309, 6.353879211068306, 6.828390202340564, 3.409660683725519, 9.033564053875331, 8.609197157618334, 5.902984474937345, 6.60256627528034, 4.22967610390148, 2.62499946278112, 8.09985733600772, 3.7733372434930623, 5.528799715121695, 3.872404143077997, 3.8829498765606743, 5.503531108395532, 5.103729481566463, 4.620981283453503, 10.051439327521079, 6.712787628740704, 7.177597143297563, 4.431818994132144, 5.822897371852482, 5.275053807791634, 7.923521707482864, 6.585982466798622, 6.4429299623524106, 4.556877652753484, 5.954140992327261, 6.281158840578806, 2.7695558628842245, 5.288026745610046, 4.235842196445439, 3.799510385794304, 9.870864751635478, 0.33930846963199257, 6.982212352815277, 9.48330516375612, 2.6038655723918893, 2.2151445404419983, 9.07203588459203, 4.337093959003152, 1.5777755520911536, 2.9316709822103406, 8.767994938781111, 6.589110905967515, 5.232634254193093, 7.718161488552261, 5.246422431838162, 3.149302064610747, 7.900238781076111, 9.131511516051487, 3.1001468920812116, 6.223455288286242, 8.688298111579938, 6.326753108162209, 7.596535759702415, 1.8879200689331035, 7.654712271158421, 11.532481531862596, 6.1906741756796695, 1.8898645220997445, 3.5588506448545028, 7.098370237110624, 5.953550658689939, 8.075837293298694, 7.114535057395168, 8.525571669554049, 7.571540504832172, 4.476294639642316, 7.98139105907124, 5.781550380487196, 2.7025231624787205, 8.819307869494097, 7.4599040309979605, 7.413936088421091, 6.216744854632418, 4.763029171374678, 5.672136190793367], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5826282761921118, "mean_inference_ms": 6.948062491816436, "mean_action_processing_ms": 0.556763866328842, "mean_env_wait_ms": 25.477819426266116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0194242000579834, "StateBufferConnector_ms": 0.030212879180908203, "ViewRequirementAgentConnector_ms": 0.6498744487762451}}, "episode_reward_max": 13.700105825610036, "episode_reward_min": 0.33930846963199257, "episode_reward_mean": 5.927601493431876, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.393955491113741, 5.9601033520114495, 6.071029268942526, 6.938119055343779, 6.353171325402394, 7.782711428320298, 4.722873455052833, 5.022126793741986, 13.700105825610036, 4.663916505445222, 3.6532606142917277, 8.202414662785676, 4.788255351706532, 5.584669119410232, 3.8229956631012243, 4.648281211445893, 5.668625418366437, 7.035389870408629, 5.532015022935711, 6.254218367907452, 4.5196585885627005, 6.728035199399309, 6.353879211068306, 6.828390202340564, 3.409660683725519, 9.033564053875331, 8.609197157618334, 5.902984474937345, 6.60256627528034, 4.22967610390148, 2.62499946278112, 8.09985733600772, 3.7733372434930623, 5.528799715121695, 3.872404143077997, 3.8829498765606743, 5.503531108395532, 5.103729481566463, 4.620981283453503, 10.051439327521079, 6.712787628740704, 7.177597143297563, 4.431818994132144, 5.822897371852482, 5.275053807791634, 7.923521707482864, 6.585982466798622, 6.4429299623524106, 4.556877652753484, 5.954140992327261, 6.281158840578806, 2.7695558628842245, 5.288026745610046, 4.235842196445439, 3.799510385794304, 9.870864751635478, 0.33930846963199257, 6.982212352815277, 9.48330516375612, 2.6038655723918893, 2.2151445404419983, 9.07203588459203, 4.337093959003152, 1.5777755520911536, 2.9316709822103406, 8.767994938781111, 6.589110905967515, 5.232634254193093, 7.718161488552261, 5.246422431838162, 3.149302064610747, 7.900238781076111, 9.131511516051487, 3.1001468920812116, 6.223455288286242, 8.688298111579938, 6.326753108162209, 7.596535759702415, 1.8879200689331035, 7.654712271158421, 11.532481531862596, 6.1906741756796695, 1.8898645220997445, 3.5588506448545028, 7.098370237110624, 5.953550658689939, 8.075837293298694, 7.114535057395168, 8.525571669554049, 7.571540504832172, 4.476294639642316, 7.98139105907124, 5.781550380487196, 2.7025231624787205, 8.819307869494097, 7.4599040309979605, 7.413936088421091, 6.216744854632418, 4.763029171374678, 5.672136190793367], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5826282761921118, "mean_inference_ms": 6.948062491816436, "mean_action_processing_ms": 0.556763866328842, "mean_env_wait_ms": 25.477819426266116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0194242000579834, "StateBufferConnector_ms": 0.030212879180908203, "ViewRequirementAgentConnector_ms": 0.6498744487762451}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2900184, "num_agent_steps_trained": 2900184, "num_env_steps_sampled": 2900184, "num_env_steps_trained": 2900184, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.2120572643625, "num_env_steps_trained_throughput_per_sec": 278.2120572643625, "timesteps_total": 2900184, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2900184, "timers": {"training_iteration_time_ms": 53688.918, "sample_time_ms": 41012.103, "load_time_ms": 629.055, "load_throughput": 24859.525, "learn_time_ms": 11682.201, "learn_throughput": 1338.618, "synch_weights_time_ms": 342.118}, "counters": {"num_env_steps_sampled": 2900184, "num_env_steps_trained": 2900184, "num_agent_steps_sampled": 2900184, "num_agent_steps_trained": 2900184}, "done": false, "episodes_total": 812, "training_iteration": 190, "trial_id": "c5092_00000", "date": "2025-06-08_10-32-18", "timestamp": 1749371538, "time_this_iter_s": 74.36143136024475, "time_total_s": 3084.417247056961, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3084.417247056961, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 66.37954545454545, "ram_util_percent": 62.4840909090909, "gpu_util_percent0": 0.061136363636363635, "vram_util_percent0": 0.18831380208333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.099815999999998e-05, "total_loss": -0.12770887266982092, "policy_loss": -0.024337977763709866, "vf_loss": 0.011888310413130305, "vf_explained_var": 0.7932121789455414, "kl": 0.02640933921931193, "entropy": 21.103137234774504, "entropy_coeff": 0.005166360000000001}, "model": {}, "num_grad_updates_lifetime": 32175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2915822, "num_env_steps_trained": 2915822, "num_agent_steps_sampled": 2915822, "num_agent_steps_trained": 2915822}, "sampler_results": {"episode_reward_max": 11.532481531862596, "episode_reward_min": 0.33930846963199257, "episode_reward_mean": 5.867363729389434, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.8229956631012243, 4.648281211445893, 5.668625418366437, 7.035389870408629, 5.532015022935711, 6.254218367907452, 4.5196585885627005, 6.728035199399309, 6.353879211068306, 6.828390202340564, 3.409660683725519, 9.033564053875331, 8.609197157618334, 5.902984474937345, 6.60256627528034, 4.22967610390148, 2.62499946278112, 8.09985733600772, 3.7733372434930623, 5.528799715121695, 3.872404143077997, 3.8829498765606743, 5.503531108395532, 5.103729481566463, 4.620981283453503, 10.051439327521079, 6.712787628740704, 7.177597143297563, 4.431818994132144, 5.822897371852482, 5.275053807791634, 7.923521707482864, 6.585982466798622, 6.4429299623524106, 4.556877652753484, 5.954140992327261, 6.281158840578806, 2.7695558628842245, 5.288026745610046, 4.235842196445439, 3.799510385794304, 9.870864751635478, 0.33930846963199257, 6.982212352815277, 9.48330516375612, 2.6038655723918893, 2.2151445404419983, 9.07203588459203, 4.337093959003152, 1.5777755520911536, 2.9316709822103406, 8.767994938781111, 6.589110905967515, 5.232634254193093, 7.718161488552261, 5.246422431838162, 3.149302064610747, 7.900238781076111, 9.131511516051487, 3.1001468920812116, 6.223455288286242, 8.688298111579938, 6.326753108162209, 7.596535759702415, 1.8879200689331035, 7.654712271158421, 11.532481531862596, 6.1906741756796695, 1.8898645220997445, 3.5588506448545028, 7.098370237110624, 5.953550658689939, 8.075837293298694, 7.114535057395168, 8.525571669554049, 7.571540504832172, 4.476294639642316, 7.98139105907124, 5.781550380487196, 2.7025231624787205, 8.819307869494097, 7.4599040309979605, 7.413936088421091, 6.216744854632418, 4.763029171374678, 5.672136190793367, 5.920242934266444, 7.819688725668522, 7.1595771176835425, 6.644097520189918, 6.414401833535498, 4.758795129405483, 3.4926901415639566, 8.542706715227046, 3.4975110521626376, 2.7278587666567677, 3.864073625297869, 7.82689479779037, 4.203317853555708, 8.941079631930462], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.583353378764953, "mean_inference_ms": 6.957917543108513, "mean_action_processing_ms": 0.5580078101267285, "mean_env_wait_ms": 25.507117009836506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015093326568603516, "StateBufferConnector_ms": 0.027194499969482422, "ViewRequirementAgentConnector_ms": 0.6633453369140625}}, "episode_reward_max": 11.532481531862596, "episode_reward_min": 0.33930846963199257, "episode_reward_mean": 5.867363729389434, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.8229956631012243, 4.648281211445893, 5.668625418366437, 7.035389870408629, 5.532015022935711, 6.254218367907452, 4.5196585885627005, 6.728035199399309, 6.353879211068306, 6.828390202340564, 3.409660683725519, 9.033564053875331, 8.609197157618334, 5.902984474937345, 6.60256627528034, 4.22967610390148, 2.62499946278112, 8.09985733600772, 3.7733372434930623, 5.528799715121695, 3.872404143077997, 3.8829498765606743, 5.503531108395532, 5.103729481566463, 4.620981283453503, 10.051439327521079, 6.712787628740704, 7.177597143297563, 4.431818994132144, 5.822897371852482, 5.275053807791634, 7.923521707482864, 6.585982466798622, 6.4429299623524106, 4.556877652753484, 5.954140992327261, 6.281158840578806, 2.7695558628842245, 5.288026745610046, 4.235842196445439, 3.799510385794304, 9.870864751635478, 0.33930846963199257, 6.982212352815277, 9.48330516375612, 2.6038655723918893, 2.2151445404419983, 9.07203588459203, 4.337093959003152, 1.5777755520911536, 2.9316709822103406, 8.767994938781111, 6.589110905967515, 5.232634254193093, 7.718161488552261, 5.246422431838162, 3.149302064610747, 7.900238781076111, 9.131511516051487, 3.1001468920812116, 6.223455288286242, 8.688298111579938, 6.326753108162209, 7.596535759702415, 1.8879200689331035, 7.654712271158421, 11.532481531862596, 6.1906741756796695, 1.8898645220997445, 3.5588506448545028, 7.098370237110624, 5.953550658689939, 8.075837293298694, 7.114535057395168, 8.525571669554049, 7.571540504832172, 4.476294639642316, 7.98139105907124, 5.781550380487196, 2.7025231624787205, 8.819307869494097, 7.4599040309979605, 7.413936088421091, 6.216744854632418, 4.763029171374678, 5.672136190793367, 5.920242934266444, 7.819688725668522, 7.1595771176835425, 6.644097520189918, 6.414401833535498, 4.758795129405483, 3.4926901415639566, 8.542706715227046, 3.4975110521626376, 2.7278587666567677, 3.864073625297869, 7.82689479779037, 4.203317853555708, 8.941079631930462], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.583353378764953, "mean_inference_ms": 6.957917543108513, "mean_action_processing_ms": 0.5580078101267285, "mean_env_wait_ms": 25.507117009836506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015093326568603516, "StateBufferConnector_ms": 0.027194499969482422, "ViewRequirementAgentConnector_ms": 0.6633453369140625}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2915822, "num_agent_steps_trained": 2915822, "num_env_steps_sampled": 2915822, "num_env_steps_trained": 2915822, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 274.1702444621326, "num_env_steps_trained_throughput_per_sec": 274.1702444621326, "timesteps_total": 2915822, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2915822, "timers": {"training_iteration_time_ms": 54143.597, "sample_time_ms": 41311.328, "load_time_ms": 617.524, "load_throughput": 25323.714, "learn_time_ms": 11840.242, "learn_throughput": 1320.75, "synch_weights_time_ms": 349.982}, "counters": {"num_env_steps_sampled": 2915822, "num_env_steps_trained": 2915822, "num_agent_steps_sampled": 2915822, "num_agent_steps_trained": 2915822}, "done": false, "episodes_total": 826, "training_iteration": 191, "trial_id": "c5092_00000", "date": "2025-06-08_10-33-15", "timestamp": 1749371595, "time_this_iter_s": 57.057557582855225, "time_total_s": 3141.4748046398163, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3141.4748046398163, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 79.90447761194031, "ram_util_percent": 62.5955223880597, "gpu_util_percent0": 0.07522388059701493, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.084178000000002e-05, "total_loss": -0.12763816788771443, "policy_loss": -0.02457807997223757, "vf_loss": 0.013078722328116948, "vf_explained_var": 0.7653827324780551, "kl": 0.026969393748601876, "entropy": 21.227768304998225, "entropy_coeff": 0.005140296666666668}, "model": {}, "num_grad_updates_lifetime": 32725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2931460, "num_env_steps_trained": 2931460, "num_agent_steps_sampled": 2931460, "num_agent_steps_trained": 2931460}, "sampler_results": {"episode_reward_max": 11.532481531862596, "episode_reward_min": -0.1459251554395895, "episode_reward_mean": 5.641758600083404, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.60256627528034, 4.22967610390148, 2.62499946278112, 8.09985733600772, 3.7733372434930623, 5.528799715121695, 3.872404143077997, 3.8829498765606743, 5.503531108395532, 5.103729481566463, 4.620981283453503, 10.051439327521079, 6.712787628740704, 7.177597143297563, 4.431818994132144, 5.822897371852482, 5.275053807791634, 7.923521707482864, 6.585982466798622, 6.4429299623524106, 4.556877652753484, 5.954140992327261, 6.281158840578806, 2.7695558628842245, 5.288026745610046, 4.235842196445439, 3.799510385794304, 9.870864751635478, 0.33930846963199257, 6.982212352815277, 9.48330516375612, 2.6038655723918893, 2.2151445404419983, 9.07203588459203, 4.337093959003152, 1.5777755520911536, 2.9316709822103406, 8.767994938781111, 6.589110905967515, 5.232634254193093, 7.718161488552261, 5.246422431838162, 3.149302064610747, 7.900238781076111, 9.131511516051487, 3.1001468920812116, 6.223455288286242, 8.688298111579938, 6.326753108162209, 7.596535759702415, 1.8879200689331035, 7.654712271158421, 11.532481531862596, 6.1906741756796695, 1.8898645220997445, 3.5588506448545028, 7.098370237110624, 5.953550658689939, 8.075837293298694, 7.114535057395168, 8.525571669554049, 7.571540504832172, 4.476294639642316, 7.98139105907124, 5.781550380487196, 2.7025231624787205, 8.819307869494097, 7.4599040309979605, 7.413936088421091, 6.216744854632418, 4.763029171374678, 5.672136190793367, 5.920242934266444, 7.819688725668522, 7.1595771176835425, 6.644097520189918, 6.414401833535498, 4.758795129405483, 3.4926901415639566, 8.542706715227046, 3.4975110521626376, 2.7278587666567677, 3.864073625297869, 7.82689479779037, 4.203317853555708, 8.941079631930462, 7.834233604489833, 6.27348086897371, 2.954660926790853, 5.101135055777357, 2.9597273116388645, 5.635986045887494, 4.266624462405603, 4.216391485008098, 3.7537778452892736, 2.0715867804827326, 7.062599708682397, 5.916594030580998, 3.8855092245222482, -0.1459251554395895], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.584233261350731, "mean_inference_ms": 6.970040067907355, "mean_action_processing_ms": 0.5595044665399483, "mean_env_wait_ms": 25.540582316283167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01709437370300293, "StateBufferConnector_ms": 0.029285430908203125, "ViewRequirementAgentConnector_ms": 0.6666944026947021}}, "episode_reward_max": 11.532481531862596, "episode_reward_min": -0.1459251554395895, "episode_reward_mean": 5.641758600083404, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.60256627528034, 4.22967610390148, 2.62499946278112, 8.09985733600772, 3.7733372434930623, 5.528799715121695, 3.872404143077997, 3.8829498765606743, 5.503531108395532, 5.103729481566463, 4.620981283453503, 10.051439327521079, 6.712787628740704, 7.177597143297563, 4.431818994132144, 5.822897371852482, 5.275053807791634, 7.923521707482864, 6.585982466798622, 6.4429299623524106, 4.556877652753484, 5.954140992327261, 6.281158840578806, 2.7695558628842245, 5.288026745610046, 4.235842196445439, 3.799510385794304, 9.870864751635478, 0.33930846963199257, 6.982212352815277, 9.48330516375612, 2.6038655723918893, 2.2151445404419983, 9.07203588459203, 4.337093959003152, 1.5777755520911536, 2.9316709822103406, 8.767994938781111, 6.589110905967515, 5.232634254193093, 7.718161488552261, 5.246422431838162, 3.149302064610747, 7.900238781076111, 9.131511516051487, 3.1001468920812116, 6.223455288286242, 8.688298111579938, 6.326753108162209, 7.596535759702415, 1.8879200689331035, 7.654712271158421, 11.532481531862596, 6.1906741756796695, 1.8898645220997445, 3.5588506448545028, 7.098370237110624, 5.953550658689939, 8.075837293298694, 7.114535057395168, 8.525571669554049, 7.571540504832172, 4.476294639642316, 7.98139105907124, 5.781550380487196, 2.7025231624787205, 8.819307869494097, 7.4599040309979605, 7.413936088421091, 6.216744854632418, 4.763029171374678, 5.672136190793367, 5.920242934266444, 7.819688725668522, 7.1595771176835425, 6.644097520189918, 6.414401833535498, 4.758795129405483, 3.4926901415639566, 8.542706715227046, 3.4975110521626376, 2.7278587666567677, 3.864073625297869, 7.82689479779037, 4.203317853555708, 8.941079631930462, 7.834233604489833, 6.27348086897371, 2.954660926790853, 5.101135055777357, 2.9597273116388645, 5.635986045887494, 4.266624462405603, 4.216391485008098, 3.7537778452892736, 2.0715867804827326, 7.062599708682397, 5.916594030580998, 3.8855092245222482, -0.1459251554395895], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.584233261350731, "mean_inference_ms": 6.970040067907355, "mean_action_processing_ms": 0.5595044665399483, "mean_env_wait_ms": 25.540582316283167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01709437370300293, "StateBufferConnector_ms": 0.029285430908203125, "ViewRequirementAgentConnector_ms": 0.6666944026947021}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2931460, "num_agent_steps_trained": 2931460, "num_env_steps_sampled": 2931460, "num_env_steps_trained": 2931460, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 272.16009022746266, "num_env_steps_trained_throughput_per_sec": 272.16009022746266, "timesteps_total": 2931460, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2931460, "timers": {"training_iteration_time_ms": 54657.728, "sample_time_ms": 41666.336, "load_time_ms": 619.118, "load_throughput": 25258.493, "learn_time_ms": 11992.662, "learn_throughput": 1303.964, "synch_weights_time_ms": 355.136}, "counters": {"num_env_steps_sampled": 2931460, "num_env_steps_trained": 2931460, "num_agent_steps_sampled": 2931460, "num_agent_steps_trained": 2931460}, "done": false, "episodes_total": 840, "training_iteration": 192, "trial_id": "c5092_00000", "date": "2025-06-08_10-34-13", "timestamp": 1749371653, "time_this_iter_s": 57.4748260974884, "time_total_s": 3198.9496307373047, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3198.9496307373047, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 80.43333333333334, "ram_util_percent": 62.653030303030306, "gpu_util_percent0": 0.0762121212121212, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.06854e-05, "total_loss": -0.1336149051218209, "policy_loss": -0.031294747021059846, "vf_loss": 0.01189526917709207, "vf_explained_var": 0.7699184424226935, "kl": 0.02646840638798577, "entropy": 21.114100288044323, "entropy_coeff": 0.005114233333333333}, "model": {}, "num_grad_updates_lifetime": 33275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2947098, "num_env_steps_trained": 2947098, "num_agent_steps_sampled": 2947098, "num_agent_steps_trained": 2947098}, "sampler_results": {"episode_reward_max": 11.532481531862596, "episode_reward_min": -0.1459251554395895, "episode_reward_mean": 5.688674896172392, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.431818994132144, 5.822897371852482, 5.275053807791634, 7.923521707482864, 6.585982466798622, 6.4429299623524106, 4.556877652753484, 5.954140992327261, 6.281158840578806, 2.7695558628842245, 5.288026745610046, 4.235842196445439, 3.799510385794304, 9.870864751635478, 0.33930846963199257, 6.982212352815277, 9.48330516375612, 2.6038655723918893, 2.2151445404419983, 9.07203588459203, 4.337093959003152, 1.5777755520911536, 2.9316709822103406, 8.767994938781111, 6.589110905967515, 5.232634254193093, 7.718161488552261, 5.246422431838162, 3.149302064610747, 7.900238781076111, 9.131511516051487, 3.1001468920812116, 6.223455288286242, 8.688298111579938, 6.326753108162209, 7.596535759702415, 1.8879200689331035, 7.654712271158421, 11.532481531862596, 6.1906741756796695, 1.8898645220997445, 3.5588506448545028, 7.098370237110624, 5.953550658689939, 8.075837293298694, 7.114535057395168, 8.525571669554049, 7.571540504832172, 4.476294639642316, 7.98139105907124, 5.781550380487196, 2.7025231624787205, 8.819307869494097, 7.4599040309979605, 7.413936088421091, 6.216744854632418, 4.763029171374678, 5.672136190793367, 5.920242934266444, 7.819688725668522, 7.1595771176835425, 6.644097520189918, 6.414401833535498, 4.758795129405483, 3.4926901415639566, 8.542706715227046, 3.4975110521626376, 2.7278587666567677, 3.864073625297869, 7.82689479779037, 4.203317853555708, 8.941079631930462, 7.834233604489833, 6.27348086897371, 2.954660926790853, 5.101135055777357, 2.9597273116388645, 5.635986045887494, 4.266624462405603, 4.216391485008098, 3.7537778452892736, 2.0715867804827326, 7.062599708682397, 5.916594030580998, 3.8855092245222482, -0.1459251554395895, 6.029854900352927, 7.110087531391013, 7.729922174191424, 5.990936508763553, 8.437363917174855, 6.399188849585409, 3.536349618259066, 6.430270703665812, 6.844571170807605, 2.471742730486311, 4.284491101030982, 4.736656270413109, 3.9434190475157456, 8.531431214459847], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5855289797685626, "mean_inference_ms": 6.984648956333144, "mean_action_processing_ms": 0.5612405397755293, "mean_env_wait_ms": 25.579334204972994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022129535675048828, "StateBufferConnector_ms": 0.02613663673400879, "ViewRequirementAgentConnector_ms": 0.6625547409057617}}, "episode_reward_max": 11.532481531862596, "episode_reward_min": -0.1459251554395895, "episode_reward_mean": 5.688674896172392, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.431818994132144, 5.822897371852482, 5.275053807791634, 7.923521707482864, 6.585982466798622, 6.4429299623524106, 4.556877652753484, 5.954140992327261, 6.281158840578806, 2.7695558628842245, 5.288026745610046, 4.235842196445439, 3.799510385794304, 9.870864751635478, 0.33930846963199257, 6.982212352815277, 9.48330516375612, 2.6038655723918893, 2.2151445404419983, 9.07203588459203, 4.337093959003152, 1.5777755520911536, 2.9316709822103406, 8.767994938781111, 6.589110905967515, 5.232634254193093, 7.718161488552261, 5.246422431838162, 3.149302064610747, 7.900238781076111, 9.131511516051487, 3.1001468920812116, 6.223455288286242, 8.688298111579938, 6.326753108162209, 7.596535759702415, 1.8879200689331035, 7.654712271158421, 11.532481531862596, 6.1906741756796695, 1.8898645220997445, 3.5588506448545028, 7.098370237110624, 5.953550658689939, 8.075837293298694, 7.114535057395168, 8.525571669554049, 7.571540504832172, 4.476294639642316, 7.98139105907124, 5.781550380487196, 2.7025231624787205, 8.819307869494097, 7.4599040309979605, 7.413936088421091, 6.216744854632418, 4.763029171374678, 5.672136190793367, 5.920242934266444, 7.819688725668522, 7.1595771176835425, 6.644097520189918, 6.414401833535498, 4.758795129405483, 3.4926901415639566, 8.542706715227046, 3.4975110521626376, 2.7278587666567677, 3.864073625297869, 7.82689479779037, 4.203317853555708, 8.941079631930462, 7.834233604489833, 6.27348086897371, 2.954660926790853, 5.101135055777357, 2.9597273116388645, 5.635986045887494, 4.266624462405603, 4.216391485008098, 3.7537778452892736, 2.0715867804827326, 7.062599708682397, 5.916594030580998, 3.8855092245222482, -0.1459251554395895, 6.029854900352927, 7.110087531391013, 7.729922174191424, 5.990936508763553, 8.437363917174855, 6.399188849585409, 3.536349618259066, 6.430270703665812, 6.844571170807605, 2.471742730486311, 4.284491101030982, 4.736656270413109, 3.9434190475157456, 8.531431214459847], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5855289797685626, "mean_inference_ms": 6.984648956333144, "mean_action_processing_ms": 0.5612405397755293, "mean_env_wait_ms": 25.579334204972994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022129535675048828, "StateBufferConnector_ms": 0.02613663673400879, "ViewRequirementAgentConnector_ms": 0.6625547409057617}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2947098, "num_agent_steps_trained": 2947098, "num_env_steps_sampled": 2947098, "num_env_steps_trained": 2947098, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 266.21912806559834, "num_env_steps_trained_throughput_per_sec": 266.21912806559834, "timesteps_total": 2947098, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2947098, "timers": {"training_iteration_time_ms": 55346.4, "sample_time_ms": 42157.672, "load_time_ms": 623.117, "load_throughput": 25096.419, "learn_time_ms": 12178.666, "learn_throughput": 1284.049, "synch_weights_time_ms": 362.33}, "counters": {"num_env_steps_sampled": 2947098, "num_env_steps_trained": 2947098, "num_agent_steps_sampled": 2947098, "num_agent_steps_trained": 2947098}, "done": false, "episodes_total": 854, "training_iteration": 193, "trial_id": "c5092_00000", "date": "2025-06-08_10-35-12", "timestamp": 1749371712, "time_this_iter_s": 58.752082109451294, "time_total_s": 3257.701712846756, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3257.701712846756, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 79.91617647058824, "ram_util_percent": 62.8235294117647, "gpu_util_percent0": 0.08338235294117646, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.052901999999998e-05, "total_loss": -0.13901758279736068, "policy_loss": -0.03679873008566739, "vf_loss": 0.012130690597167069, "vf_explained_var": 0.7585680732943795, "kl": 0.027208532785988723, "entropy": 21.227729389884257, "entropy_coeff": 0.00508817}, "model": {}, "num_grad_updates_lifetime": 33825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2962736, "num_env_steps_trained": 2962736, "num_agent_steps_sampled": 2962736, "num_agent_steps_trained": 2962736}, "sampler_results": {"episode_reward_max": 11.532481531862596, "episode_reward_min": -0.1459251554395895, "episode_reward_mean": 5.6667387120779305, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.33930846963199257, 6.982212352815277, 9.48330516375612, 2.6038655723918893, 2.2151445404419983, 9.07203588459203, 4.337093959003152, 1.5777755520911536, 2.9316709822103406, 8.767994938781111, 6.589110905967515, 5.232634254193093, 7.718161488552261, 5.246422431838162, 3.149302064610747, 7.900238781076111, 9.131511516051487, 3.1001468920812116, 6.223455288286242, 8.688298111579938, 6.326753108162209, 7.596535759702415, 1.8879200689331035, 7.654712271158421, 11.532481531862596, 6.1906741756796695, 1.8898645220997445, 3.5588506448545028, 7.098370237110624, 5.953550658689939, 8.075837293298694, 7.114535057395168, 8.525571669554049, 7.571540504832172, 4.476294639642316, 7.98139105907124, 5.781550380487196, 2.7025231624787205, 8.819307869494097, 7.4599040309979605, 7.413936088421091, 6.216744854632418, 4.763029171374678, 5.672136190793367, 5.920242934266444, 7.819688725668522, 7.1595771176835425, 6.644097520189918, 6.414401833535498, 4.758795129405483, 3.4926901415639566, 8.542706715227046, 3.4975110521626376, 2.7278587666567677, 3.864073625297869, 7.82689479779037, 4.203317853555708, 8.941079631930462, 7.834233604489833, 6.27348086897371, 2.954660926790853, 5.101135055777357, 2.9597273116388645, 5.635986045887494, 4.266624462405603, 4.216391485008098, 3.7537778452892736, 2.0715867804827326, 7.062599708682397, 5.916594030580998, 3.8855092245222482, -0.1459251554395895, 6.029854900352927, 7.110087531391013, 7.729922174191424, 5.990936508763553, 8.437363917174855, 6.399188849585409, 3.536349618259066, 6.430270703665812, 6.844571170807605, 2.471742730486311, 4.284491101030982, 4.736656270413109, 3.9434190475157456, 8.531431214459847, 8.483899405193238, 5.372873116369736, 6.437767389285494, 0.7988724416185855, 6.436711042223351, 3.9087004628779085, 5.543978520674428, 1.230167934055221, 7.954290646780821, 6.749356368183013, 6.202381014728004, 5.937674282761598, 4.631024382315129, 7.356866321926497], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5868502374952658, "mean_inference_ms": 7.000141833639277, "mean_action_processing_ms": 0.5631415329056442, "mean_env_wait_ms": 25.620382861924227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025098323822021484, "StateBufferConnector_ms": 0.026094436645507812, "ViewRequirementAgentConnector_ms": 0.699578046798706}}, "episode_reward_max": 11.532481531862596, "episode_reward_min": -0.1459251554395895, "episode_reward_mean": 5.6667387120779305, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.33930846963199257, 6.982212352815277, 9.48330516375612, 2.6038655723918893, 2.2151445404419983, 9.07203588459203, 4.337093959003152, 1.5777755520911536, 2.9316709822103406, 8.767994938781111, 6.589110905967515, 5.232634254193093, 7.718161488552261, 5.246422431838162, 3.149302064610747, 7.900238781076111, 9.131511516051487, 3.1001468920812116, 6.223455288286242, 8.688298111579938, 6.326753108162209, 7.596535759702415, 1.8879200689331035, 7.654712271158421, 11.532481531862596, 6.1906741756796695, 1.8898645220997445, 3.5588506448545028, 7.098370237110624, 5.953550658689939, 8.075837293298694, 7.114535057395168, 8.525571669554049, 7.571540504832172, 4.476294639642316, 7.98139105907124, 5.781550380487196, 2.7025231624787205, 8.819307869494097, 7.4599040309979605, 7.413936088421091, 6.216744854632418, 4.763029171374678, 5.672136190793367, 5.920242934266444, 7.819688725668522, 7.1595771176835425, 6.644097520189918, 6.414401833535498, 4.758795129405483, 3.4926901415639566, 8.542706715227046, 3.4975110521626376, 2.7278587666567677, 3.864073625297869, 7.82689479779037, 4.203317853555708, 8.941079631930462, 7.834233604489833, 6.27348086897371, 2.954660926790853, 5.101135055777357, 2.9597273116388645, 5.635986045887494, 4.266624462405603, 4.216391485008098, 3.7537778452892736, 2.0715867804827326, 7.062599708682397, 5.916594030580998, 3.8855092245222482, -0.1459251554395895, 6.029854900352927, 7.110087531391013, 7.729922174191424, 5.990936508763553, 8.437363917174855, 6.399188849585409, 3.536349618259066, 6.430270703665812, 6.844571170807605, 2.471742730486311, 4.284491101030982, 4.736656270413109, 3.9434190475157456, 8.531431214459847, 8.483899405193238, 5.372873116369736, 6.437767389285494, 0.7988724416185855, 6.436711042223351, 3.9087004628779085, 5.543978520674428, 1.230167934055221, 7.954290646780821, 6.749356368183013, 6.202381014728004, 5.937674282761598, 4.631024382315129, 7.356866321926497], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5868502374952658, "mean_inference_ms": 7.000141833639277, "mean_action_processing_ms": 0.5631415329056442, "mean_env_wait_ms": 25.620382861924227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025098323822021484, "StateBufferConnector_ms": 0.026094436645507812, "ViewRequirementAgentConnector_ms": 0.699578046798706}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2962736, "num_agent_steps_trained": 2962736, "num_env_steps_sampled": 2962736, "num_env_steps_trained": 2962736, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.0791376544787, "num_env_steps_trained_throughput_per_sec": 282.0791376544787, "timesteps_total": 2962736, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2962736, "timers": {"training_iteration_time_ms": 55645.821, "sample_time_ms": 42341.297, "load_time_ms": 613.934, "load_throughput": 25471.781, "learn_time_ms": 12297.029, "learn_throughput": 1271.689, "synch_weights_time_ms": 368.042}, "counters": {"num_env_steps_sampled": 2962736, "num_env_steps_trained": 2962736, "num_agent_steps_sampled": 2962736, "num_agent_steps_trained": 2962736}, "done": false, "episodes_total": 868, "training_iteration": 194, "trial_id": "c5092_00000", "date": "2025-06-08_10-36-07", "timestamp": 1749371767, "time_this_iter_s": 55.45390343666077, "time_total_s": 3313.1556162834167, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3313.1556162834167, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 78.775, "ram_util_percent": 62.9671875, "gpu_util_percent0": 0.0809375, "vram_util_percent0": 0.18831380208333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.037264e-05, "total_loss": -0.14397915894250302, "policy_loss": -0.042722044665345245, "vf_loss": 0.012512830271893604, "vf_explained_var": 0.7727962041984905, "kl": 0.028319476355154485, "entropy": 21.187044970772483, "entropy_coeff": 0.0050621066666666666}, "model": {}, "num_grad_updates_lifetime": 34375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2978374, "num_env_steps_trained": 2978374, "num_agent_steps_sampled": 2978374, "num_agent_steps_trained": 2978374}, "sampler_results": {"episode_reward_max": 11.532481531862596, "episode_reward_min": -0.1459251554395895, "episode_reward_mean": 5.690535445763121, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.149302064610747, 7.900238781076111, 9.131511516051487, 3.1001468920812116, 6.223455288286242, 8.688298111579938, 6.326753108162209, 7.596535759702415, 1.8879200689331035, 7.654712271158421, 11.532481531862596, 6.1906741756796695, 1.8898645220997445, 3.5588506448545028, 7.098370237110624, 5.953550658689939, 8.075837293298694, 7.114535057395168, 8.525571669554049, 7.571540504832172, 4.476294639642316, 7.98139105907124, 5.781550380487196, 2.7025231624787205, 8.819307869494097, 7.4599040309979605, 7.413936088421091, 6.216744854632418, 4.763029171374678, 5.672136190793367, 5.920242934266444, 7.819688725668522, 7.1595771176835425, 6.644097520189918, 6.414401833535498, 4.758795129405483, 3.4926901415639566, 8.542706715227046, 3.4975110521626376, 2.7278587666567677, 3.864073625297869, 7.82689479779037, 4.203317853555708, 8.941079631930462, 7.834233604489833, 6.27348086897371, 2.954660926790853, 5.101135055777357, 2.9597273116388645, 5.635986045887494, 4.266624462405603, 4.216391485008098, 3.7537778452892736, 2.0715867804827326, 7.062599708682397, 5.916594030580998, 3.8855092245222482, -0.1459251554395895, 6.029854900352927, 7.110087531391013, 7.729922174191424, 5.990936508763553, 8.437363917174855, 6.399188849585409, 3.536349618259066, 6.430270703665812, 6.844571170807605, 2.471742730486311, 4.284491101030982, 4.736656270413109, 3.9434190475157456, 8.531431214459847, 8.483899405193238, 5.372873116369736, 6.437767389285494, 0.7988724416185855, 6.436711042223351, 3.9087004628779085, 5.543978520674428, 1.230167934055221, 7.954290646780821, 6.749356368183013, 6.202381014728004, 5.937674282761598, 4.631024382315129, 7.356866321926497, 5.751749092527105, 7.898529340495853, 6.314265956328143, 7.638458190953357, 8.245704507259125, 2.908663358729584, 4.230428085796285, 4.718777099445056, 3.585066314453785, 8.797912198022049, 0.6440064359487456, 6.6806756618687535, 3.4677296379434313, 4.594443985013926], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5880442906839216, "mean_inference_ms": 7.014602458157537, "mean_action_processing_ms": 0.5650009823926084, "mean_env_wait_ms": 25.658903597300604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024105548858642578, "StateBufferConnector_ms": 0.026916027069091797, "ViewRequirementAgentConnector_ms": 0.7076892852783203}}, "episode_reward_max": 11.532481531862596, "episode_reward_min": -0.1459251554395895, "episode_reward_mean": 5.690535445763121, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.149302064610747, 7.900238781076111, 9.131511516051487, 3.1001468920812116, 6.223455288286242, 8.688298111579938, 6.326753108162209, 7.596535759702415, 1.8879200689331035, 7.654712271158421, 11.532481531862596, 6.1906741756796695, 1.8898645220997445, 3.5588506448545028, 7.098370237110624, 5.953550658689939, 8.075837293298694, 7.114535057395168, 8.525571669554049, 7.571540504832172, 4.476294639642316, 7.98139105907124, 5.781550380487196, 2.7025231624787205, 8.819307869494097, 7.4599040309979605, 7.413936088421091, 6.216744854632418, 4.763029171374678, 5.672136190793367, 5.920242934266444, 7.819688725668522, 7.1595771176835425, 6.644097520189918, 6.414401833535498, 4.758795129405483, 3.4926901415639566, 8.542706715227046, 3.4975110521626376, 2.7278587666567677, 3.864073625297869, 7.82689479779037, 4.203317853555708, 8.941079631930462, 7.834233604489833, 6.27348086897371, 2.954660926790853, 5.101135055777357, 2.9597273116388645, 5.635986045887494, 4.266624462405603, 4.216391485008098, 3.7537778452892736, 2.0715867804827326, 7.062599708682397, 5.916594030580998, 3.8855092245222482, -0.1459251554395895, 6.029854900352927, 7.110087531391013, 7.729922174191424, 5.990936508763553, 8.437363917174855, 6.399188849585409, 3.536349618259066, 6.430270703665812, 6.844571170807605, 2.471742730486311, 4.284491101030982, 4.736656270413109, 3.9434190475157456, 8.531431214459847, 8.483899405193238, 5.372873116369736, 6.437767389285494, 0.7988724416185855, 6.436711042223351, 3.9087004628779085, 5.543978520674428, 1.230167934055221, 7.954290646780821, 6.749356368183013, 6.202381014728004, 5.937674282761598, 4.631024382315129, 7.356866321926497, 5.751749092527105, 7.898529340495853, 6.314265956328143, 7.638458190953357, 8.245704507259125, 2.908663358729584, 4.230428085796285, 4.718777099445056, 3.585066314453785, 8.797912198022049, 0.6440064359487456, 6.6806756618687535, 3.4677296379434313, 4.594443985013926], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5880442906839216, "mean_inference_ms": 7.014602458157537, "mean_action_processing_ms": 0.5650009823926084, "mean_env_wait_ms": 25.658903597300604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024105548858642578, "StateBufferConnector_ms": 0.026916027069091797, "ViewRequirementAgentConnector_ms": 0.7076892852783203}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2978374, "num_agent_steps_trained": 2978374, "num_env_steps_sampled": 2978374, "num_env_steps_trained": 2978374, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 272.87902630055527, "num_env_steps_trained_throughput_per_sec": 272.87902630055527, "timesteps_total": 2978374, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2978374, "timers": {"training_iteration_time_ms": 56165.331, "sample_time_ms": 42680.689, "load_time_ms": 620.988, "load_throughput": 25182.454, "learn_time_ms": 12462.766, "learn_throughput": 1254.778, "synch_weights_time_ms": 376.25}, "counters": {"num_env_steps_sampled": 2978374, "num_env_steps_trained": 2978374, "num_agent_steps_sampled": 2978374, "num_agent_steps_trained": 2978374}, "done": false, "episodes_total": 882, "training_iteration": 195, "trial_id": "c5092_00000", "date": "2025-06-08_10-37-05", "timestamp": 1749371825, "time_this_iter_s": 57.32944297790527, "time_total_s": 3370.485059261322, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3370.485059261322, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 79.31969696969698, "ram_util_percent": 63.20454545454545, "gpu_util_percent0": 0.08545454545454544, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.021626000000001e-05, "total_loss": -0.13868197459304196, "policy_loss": -0.037903804755928416, "vf_loss": 0.012111092879944904, "vf_explained_var": 0.7861194301735271, "kl": 0.02632010171446547, "entropy": 21.146254986849698, "entropy_coeff": 0.005036043333333334}, "model": {}, "num_grad_updates_lifetime": 34925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2994012, "num_env_steps_trained": 2994012, "num_agent_steps_sampled": 2994012, "num_agent_steps_trained": 2994012}, "sampler_results": {"episode_reward_max": 8.941079631930462, "episode_reward_min": -0.1459251554395895, "episode_reward_mean": 5.787591613819393, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.098370237110624, 5.953550658689939, 8.075837293298694, 7.114535057395168, 8.525571669554049, 7.571540504832172, 4.476294639642316, 7.98139105907124, 5.781550380487196, 2.7025231624787205, 8.819307869494097, 7.4599040309979605, 7.413936088421091, 6.216744854632418, 4.763029171374678, 5.672136190793367, 5.920242934266444, 7.819688725668522, 7.1595771176835425, 6.644097520189918, 6.414401833535498, 4.758795129405483, 3.4926901415639566, 8.542706715227046, 3.4975110521626376, 2.7278587666567677, 3.864073625297869, 7.82689479779037, 4.203317853555708, 8.941079631930462, 7.834233604489833, 6.27348086897371, 2.954660926790853, 5.101135055777357, 2.9597273116388645, 5.635986045887494, 4.266624462405603, 4.216391485008098, 3.7537778452892736, 2.0715867804827326, 7.062599708682397, 5.916594030580998, 3.8855092245222482, -0.1459251554395895, 6.029854900352927, 7.110087531391013, 7.729922174191424, 5.990936508763553, 8.437363917174855, 6.399188849585409, 3.536349618259066, 6.430270703665812, 6.844571170807605, 2.471742730486311, 4.284491101030982, 4.736656270413109, 3.9434190475157456, 8.531431214459847, 8.483899405193238, 5.372873116369736, 6.437767389285494, 0.7988724416185855, 6.436711042223351, 3.9087004628779085, 5.543978520674428, 1.230167934055221, 7.954290646780821, 6.749356368183013, 6.202381014728004, 5.937674282761598, 4.631024382315129, 7.356866321926497, 5.751749092527105, 7.898529340495853, 6.314265956328143, 7.638458190953357, 8.245704507259125, 2.908663358729584, 4.230428085796285, 4.718777099445056, 3.585066314453785, 8.797912198022049, 0.6440064359487456, 6.6806756618687535, 3.4677296379434313, 4.594443985013926, 7.977461589779924, 8.14171242466327, 8.581137323559545, 7.703051145336178, 6.600033412908561, 5.769942419978375, 7.159662783416678, 4.328551239667081, 7.129393364035272, 3.773293180139753, 8.108612161699165, 5.535513030832425, 6.562511080111334, 7.165486385637922], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5891646262485515, "mean_inference_ms": 7.029482083564674, "mean_action_processing_ms": 0.5668769494310584, "mean_env_wait_ms": 25.69844685140332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02310466766357422, "StateBufferConnector_ms": 0.026952505111694336, "ViewRequirementAgentConnector_ms": 0.6931242942810059}}, "episode_reward_max": 8.941079631930462, "episode_reward_min": -0.1459251554395895, "episode_reward_mean": 5.787591613819393, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.098370237110624, 5.953550658689939, 8.075837293298694, 7.114535057395168, 8.525571669554049, 7.571540504832172, 4.476294639642316, 7.98139105907124, 5.781550380487196, 2.7025231624787205, 8.819307869494097, 7.4599040309979605, 7.413936088421091, 6.216744854632418, 4.763029171374678, 5.672136190793367, 5.920242934266444, 7.819688725668522, 7.1595771176835425, 6.644097520189918, 6.414401833535498, 4.758795129405483, 3.4926901415639566, 8.542706715227046, 3.4975110521626376, 2.7278587666567677, 3.864073625297869, 7.82689479779037, 4.203317853555708, 8.941079631930462, 7.834233604489833, 6.27348086897371, 2.954660926790853, 5.101135055777357, 2.9597273116388645, 5.635986045887494, 4.266624462405603, 4.216391485008098, 3.7537778452892736, 2.0715867804827326, 7.062599708682397, 5.916594030580998, 3.8855092245222482, -0.1459251554395895, 6.029854900352927, 7.110087531391013, 7.729922174191424, 5.990936508763553, 8.437363917174855, 6.399188849585409, 3.536349618259066, 6.430270703665812, 6.844571170807605, 2.471742730486311, 4.284491101030982, 4.736656270413109, 3.9434190475157456, 8.531431214459847, 8.483899405193238, 5.372873116369736, 6.437767389285494, 0.7988724416185855, 6.436711042223351, 3.9087004628779085, 5.543978520674428, 1.230167934055221, 7.954290646780821, 6.749356368183013, 6.202381014728004, 5.937674282761598, 4.631024382315129, 7.356866321926497, 5.751749092527105, 7.898529340495853, 6.314265956328143, 7.638458190953357, 8.245704507259125, 2.908663358729584, 4.230428085796285, 4.718777099445056, 3.585066314453785, 8.797912198022049, 0.6440064359487456, 6.6806756618687535, 3.4677296379434313, 4.594443985013926, 7.977461589779924, 8.14171242466327, 8.581137323559545, 7.703051145336178, 6.600033412908561, 5.769942419978375, 7.159662783416678, 4.328551239667081, 7.129393364035272, 3.773293180139753, 8.108612161699165, 5.535513030832425, 6.562511080111334, 7.165486385637922], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5891646262485515, "mean_inference_ms": 7.029482083564674, "mean_action_processing_ms": 0.5668769494310584, "mean_env_wait_ms": 25.69844685140332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02310466766357422, "StateBufferConnector_ms": 0.026952505111694336, "ViewRequirementAgentConnector_ms": 0.6931242942810059}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2994012, "num_agent_steps_trained": 2994012, "num_env_steps_sampled": 2994012, "num_env_steps_trained": 2994012, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 263.8704676175239, "num_env_steps_trained_throughput_per_sec": 263.8704676175239, "timesteps_total": 2994012, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2994012, "timers": {"training_iteration_time_ms": 56882.456, "sample_time_ms": 43147.933, "load_time_ms": 620.339, "load_throughput": 25208.784, "learn_time_ms": 12698.897, "learn_throughput": 1231.446, "synch_weights_time_ms": 390.451}, "counters": {"num_env_steps_sampled": 2994012, "num_env_steps_trained": 2994012, "num_agent_steps_sampled": 2994012, "num_agent_steps_trained": 2994012}, "done": false, "episodes_total": 896, "training_iteration": 196, "trial_id": "c5092_00000", "date": "2025-06-08_10-38-04", "timestamp": 1749371884, "time_this_iter_s": 59.28494143486023, "time_total_s": 3429.7700006961823, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3429.7700006961823, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 79.65942028985508, "ram_util_percent": 63.11014492753624, "gpu_util_percent0": 0.0781159420289855, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 7.005988e-05, "total_loss": -0.1333917459522755, "policy_loss": -0.03330602964941962, "vf_loss": 0.012978650494478643, "vf_explained_var": 0.7881666620211167, "kl": 0.02672732921428494, "entropy": 21.17642895785245, "entropy_coeff": 0.00500998}, "model": {}, "num_grad_updates_lifetime": 35475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3009650, "num_env_steps_trained": 3009650, "num_agent_steps_sampled": 3009650, "num_agent_steps_trained": 3009650}, "sampler_results": {"episode_reward_max": 9.874746780438663, "episode_reward_min": -0.1459251554395895, "episode_reward_mean": 5.670456649978984, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.763029171374678, 5.672136190793367, 5.920242934266444, 7.819688725668522, 7.1595771176835425, 6.644097520189918, 6.414401833535498, 4.758795129405483, 3.4926901415639566, 8.542706715227046, 3.4975110521626376, 2.7278587666567677, 3.864073625297869, 7.82689479779037, 4.203317853555708, 8.941079631930462, 7.834233604489833, 6.27348086897371, 2.954660926790853, 5.101135055777357, 2.9597273116388645, 5.635986045887494, 4.266624462405603, 4.216391485008098, 3.7537778452892736, 2.0715867804827326, 7.062599708682397, 5.916594030580998, 3.8855092245222482, -0.1459251554395895, 6.029854900352927, 7.110087531391013, 7.729922174191424, 5.990936508763553, 8.437363917174855, 6.399188849585409, 3.536349618259066, 6.430270703665812, 6.844571170807605, 2.471742730486311, 4.284491101030982, 4.736656270413109, 3.9434190475157456, 8.531431214459847, 8.483899405193238, 5.372873116369736, 6.437767389285494, 0.7988724416185855, 6.436711042223351, 3.9087004628779085, 5.543978520674428, 1.230167934055221, 7.954290646780821, 6.749356368183013, 6.202381014728004, 5.937674282761598, 4.631024382315129, 7.356866321926497, 5.751749092527105, 7.898529340495853, 6.314265956328143, 7.638458190953357, 8.245704507259125, 2.908663358729584, 4.230428085796285, 4.718777099445056, 3.585066314453785, 8.797912198022049, 0.6440064359487456, 6.6806756618687535, 3.4677296379434313, 4.594443985013926, 7.977461589779924, 8.14171242466327, 8.581137323559545, 7.703051145336178, 6.600033412908561, 5.769942419978375, 7.159662783416678, 4.328551239667081, 7.129393364035272, 3.773293180139753, 8.108612161699165, 5.535513030832425, 6.562511080111334, 7.165486385637922, 5.678876423176244, 4.145661442306123, 6.817163605212528, 3.872308678706981, 5.394305174872514, 5.560675749344192, 6.118210127331687, 7.739735765865424, 7.0389977349935196, 1.6388763039575227, 7.134739360116683, 8.525795974187144, 9.874746780438663, 3.937468001555617], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5905115812577943, "mean_inference_ms": 7.045080813247882, "mean_action_processing_ms": 0.568815112044837, "mean_env_wait_ms": 25.74177656028921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017052173614501953, "StateBufferConnector_ms": 0.02338123321533203, "ViewRequirementAgentConnector_ms": 0.6713178157806396}}, "episode_reward_max": 9.874746780438663, "episode_reward_min": -0.1459251554395895, "episode_reward_mean": 5.670456649978984, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.763029171374678, 5.672136190793367, 5.920242934266444, 7.819688725668522, 7.1595771176835425, 6.644097520189918, 6.414401833535498, 4.758795129405483, 3.4926901415639566, 8.542706715227046, 3.4975110521626376, 2.7278587666567677, 3.864073625297869, 7.82689479779037, 4.203317853555708, 8.941079631930462, 7.834233604489833, 6.27348086897371, 2.954660926790853, 5.101135055777357, 2.9597273116388645, 5.635986045887494, 4.266624462405603, 4.216391485008098, 3.7537778452892736, 2.0715867804827326, 7.062599708682397, 5.916594030580998, 3.8855092245222482, -0.1459251554395895, 6.029854900352927, 7.110087531391013, 7.729922174191424, 5.990936508763553, 8.437363917174855, 6.399188849585409, 3.536349618259066, 6.430270703665812, 6.844571170807605, 2.471742730486311, 4.284491101030982, 4.736656270413109, 3.9434190475157456, 8.531431214459847, 8.483899405193238, 5.372873116369736, 6.437767389285494, 0.7988724416185855, 6.436711042223351, 3.9087004628779085, 5.543978520674428, 1.230167934055221, 7.954290646780821, 6.749356368183013, 6.202381014728004, 5.937674282761598, 4.631024382315129, 7.356866321926497, 5.751749092527105, 7.898529340495853, 6.314265956328143, 7.638458190953357, 8.245704507259125, 2.908663358729584, 4.230428085796285, 4.718777099445056, 3.585066314453785, 8.797912198022049, 0.6440064359487456, 6.6806756618687535, 3.4677296379434313, 4.594443985013926, 7.977461589779924, 8.14171242466327, 8.581137323559545, 7.703051145336178, 6.600033412908561, 5.769942419978375, 7.159662783416678, 4.328551239667081, 7.129393364035272, 3.773293180139753, 8.108612161699165, 5.535513030832425, 6.562511080111334, 7.165486385637922, 5.678876423176244, 4.145661442306123, 6.817163605212528, 3.872308678706981, 5.394305174872514, 5.560675749344192, 6.118210127331687, 7.739735765865424, 7.0389977349935196, 1.6388763039575227, 7.134739360116683, 8.525795974187144, 9.874746780438663, 3.937468001555617], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5905115812577943, "mean_inference_ms": 7.045080813247882, "mean_action_processing_ms": 0.568815112044837, "mean_env_wait_ms": 25.74177656028921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017052173614501953, "StateBufferConnector_ms": 0.02338123321533203, "ViewRequirementAgentConnector_ms": 0.6713178157806396}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3009650, "num_agent_steps_trained": 3009650, "num_env_steps_sampled": 3009650, "num_env_steps_trained": 3009650, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 260.32698200654494, "num_env_steps_trained_throughput_per_sec": 260.32698200654494, "timesteps_total": 3009650, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3009650, "timers": {"training_iteration_time_ms": 57683.992, "sample_time_ms": 43721.301, "load_time_ms": 624.031, "load_throughput": 25059.663, "learn_time_ms": 12928.793, "learn_throughput": 1209.548, "synch_weights_time_ms": 384.815}, "counters": {"num_env_steps_sampled": 3009650, "num_env_steps_trained": 3009650, "num_agent_steps_sampled": 3009650, "num_agent_steps_trained": 3009650}, "done": false, "episodes_total": 910, "training_iteration": 197, "trial_id": "c5092_00000", "date": "2025-06-08_10-39-04", "timestamp": 1749371944, "time_this_iter_s": 60.087599992752075, "time_total_s": 3489.8576006889343, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3489.8576006889343, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 81.0072463768116, "ram_util_percent": 60.79420289855073, "gpu_util_percent0": 0.07159420289855072, "vram_util_percent0": 0.18831380208333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.99035e-05, "total_loss": -0.1285302144246684, "policy_loss": -0.029371748640392485, "vf_loss": 0.012939654012972658, "vf_explained_var": 0.7791586373069069, "kl": 0.029778593055380043, "entropy": 21.16085963162509, "entropy_coeff": 0.0049807}, "model": {}, "num_grad_updates_lifetime": 36025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3025288, "num_env_steps_trained": 3025288, "num_agent_steps_sampled": 3025288, "num_agent_steps_trained": 3025288}, "sampler_results": {"episode_reward_max": 10.212520558823302, "episode_reward_min": -0.1459251554395895, "episode_reward_mean": 5.862918355081954, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.203317853555708, 8.941079631930462, 7.834233604489833, 6.27348086897371, 2.954660926790853, 5.101135055777357, 2.9597273116388645, 5.635986045887494, 4.266624462405603, 4.216391485008098, 3.7537778452892736, 2.0715867804827326, 7.062599708682397, 5.916594030580998, 3.8855092245222482, -0.1459251554395895, 6.029854900352927, 7.110087531391013, 7.729922174191424, 5.990936508763553, 8.437363917174855, 6.399188849585409, 3.536349618259066, 6.430270703665812, 6.844571170807605, 2.471742730486311, 4.284491101030982, 4.736656270413109, 3.9434190475157456, 8.531431214459847, 8.483899405193238, 5.372873116369736, 6.437767389285494, 0.7988724416185855, 6.436711042223351, 3.9087004628779085, 5.543978520674428, 1.230167934055221, 7.954290646780821, 6.749356368183013, 6.202381014728004, 5.937674282761598, 4.631024382315129, 7.356866321926497, 5.751749092527105, 7.898529340495853, 6.314265956328143, 7.638458190953357, 8.245704507259125, 2.908663358729584, 4.230428085796285, 4.718777099445056, 3.585066314453785, 8.797912198022049, 0.6440064359487456, 6.6806756618687535, 3.4677296379434313, 4.594443985013926, 7.977461589779924, 8.14171242466327, 8.581137323559545, 7.703051145336178, 6.600033412908561, 5.769942419978375, 7.159662783416678, 4.328551239667081, 7.129393364035272, 3.773293180139753, 8.108612161699165, 5.535513030832425, 6.562511080111334, 7.165486385637922, 5.678876423176244, 4.145661442306123, 6.817163605212528, 3.872308678706981, 5.394305174872514, 5.560675749344192, 6.118210127331687, 7.739735765865424, 7.0389977349935196, 1.6388763039575227, 7.134739360116683, 8.525795974187144, 9.874746780438663, 3.937468001555617, 7.76791609473754, 7.518389558684755, 8.553924653350448, 10.212520558823302, 7.68926789475501, 7.89280654380878, 4.309482408369576, 9.22513233469865, 5.76646791079732, 5.207801371723332, 5.894631472341354, 7.144190261919277, 3.3997363096570252, 7.767606858246901], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5918139754729141, "mean_inference_ms": 7.061290156755371, "mean_action_processing_ms": 0.5707722683385074, "mean_env_wait_ms": 25.78652946432232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021072864532470703, "StateBufferConnector_ms": 0.02536177635192871, "ViewRequirementAgentConnector_ms": 0.6633334159851074}}, "episode_reward_max": 10.212520558823302, "episode_reward_min": -0.1459251554395895, "episode_reward_mean": 5.862918355081954, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.203317853555708, 8.941079631930462, 7.834233604489833, 6.27348086897371, 2.954660926790853, 5.101135055777357, 2.9597273116388645, 5.635986045887494, 4.266624462405603, 4.216391485008098, 3.7537778452892736, 2.0715867804827326, 7.062599708682397, 5.916594030580998, 3.8855092245222482, -0.1459251554395895, 6.029854900352927, 7.110087531391013, 7.729922174191424, 5.990936508763553, 8.437363917174855, 6.399188849585409, 3.536349618259066, 6.430270703665812, 6.844571170807605, 2.471742730486311, 4.284491101030982, 4.736656270413109, 3.9434190475157456, 8.531431214459847, 8.483899405193238, 5.372873116369736, 6.437767389285494, 0.7988724416185855, 6.436711042223351, 3.9087004628779085, 5.543978520674428, 1.230167934055221, 7.954290646780821, 6.749356368183013, 6.202381014728004, 5.937674282761598, 4.631024382315129, 7.356866321926497, 5.751749092527105, 7.898529340495853, 6.314265956328143, 7.638458190953357, 8.245704507259125, 2.908663358729584, 4.230428085796285, 4.718777099445056, 3.585066314453785, 8.797912198022049, 0.6440064359487456, 6.6806756618687535, 3.4677296379434313, 4.594443985013926, 7.977461589779924, 8.14171242466327, 8.581137323559545, 7.703051145336178, 6.600033412908561, 5.769942419978375, 7.159662783416678, 4.328551239667081, 7.129393364035272, 3.773293180139753, 8.108612161699165, 5.535513030832425, 6.562511080111334, 7.165486385637922, 5.678876423176244, 4.145661442306123, 6.817163605212528, 3.872308678706981, 5.394305174872514, 5.560675749344192, 6.118210127331687, 7.739735765865424, 7.0389977349935196, 1.6388763039575227, 7.134739360116683, 8.525795974187144, 9.874746780438663, 3.937468001555617, 7.76791609473754, 7.518389558684755, 8.553924653350448, 10.212520558823302, 7.68926789475501, 7.89280654380878, 4.309482408369576, 9.22513233469865, 5.76646791079732, 5.207801371723332, 5.894631472341354, 7.144190261919277, 3.3997363096570252, 7.767606858246901], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5918139754729141, "mean_inference_ms": 7.061290156755371, "mean_action_processing_ms": 0.5707722683385074, "mean_env_wait_ms": 25.78652946432232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021072864532470703, "StateBufferConnector_ms": 0.02536177635192871, "ViewRequirementAgentConnector_ms": 0.6633334159851074}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3025288, "num_agent_steps_trained": 3025288, "num_env_steps_sampled": 3025288, "num_env_steps_trained": 3025288, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 263.66961930186994, "num_env_steps_trained_throughput_per_sec": 263.66961930186994, "timesteps_total": 3025288, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3025288, "timers": {"training_iteration_time_ms": 57707.395, "sample_time_ms": 43755.857, "load_time_ms": 623.9, "load_throughput": 25064.918, "learn_time_ms": 12925.228, "learn_throughput": 1209.882, "synch_weights_time_ms": 377.31}, "counters": {"num_env_steps_sampled": 3025288, "num_env_steps_trained": 3025288, "num_agent_steps_sampled": 3025288, "num_agent_steps_trained": 3025288}, "done": false, "episodes_total": 924, "training_iteration": 198, "trial_id": "c5092_00000", "date": "2025-06-08_10-40-04", "timestamp": 1749372004, "time_this_iter_s": 59.32206988334656, "time_total_s": 3549.179670572281, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3549.179670572281, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 79.67205882352944, "ram_util_percent": 60.736764705882344, "gpu_util_percent0": 0.07999999999999999, "vram_util_percent0": 0.18831380208333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.974711999999999e-05, "total_loss": -0.14146266034169291, "policy_loss": -0.04170024072920734, "vf_loss": 0.011152946864339439, "vf_explained_var": 0.7545957787470384, "kl": 0.026129058539571072, "entropy": 21.249978696649723, "entropy_coeff": 0.004949424}, "model": {}, "num_grad_updates_lifetime": 36575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3040926, "num_env_steps_trained": 3040926, "num_agent_steps_sampled": 3040926, "num_agent_steps_trained": 3040926}, "sampler_results": {"episode_reward_max": 10.212520558823302, "episode_reward_min": -0.1459251554395895, "episode_reward_mean": 6.00740032327598, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.8855092245222482, -0.1459251554395895, 6.029854900352927, 7.110087531391013, 7.729922174191424, 5.990936508763553, 8.437363917174855, 6.399188849585409, 3.536349618259066, 6.430270703665812, 6.844571170807605, 2.471742730486311, 4.284491101030982, 4.736656270413109, 3.9434190475157456, 8.531431214459847, 8.483899405193238, 5.372873116369736, 6.437767389285494, 0.7988724416185855, 6.436711042223351, 3.9087004628779085, 5.543978520674428, 1.230167934055221, 7.954290646780821, 6.749356368183013, 6.202381014728004, 5.937674282761598, 4.631024382315129, 7.356866321926497, 5.751749092527105, 7.898529340495853, 6.314265956328143, 7.638458190953357, 8.245704507259125, 2.908663358729584, 4.230428085796285, 4.718777099445056, 3.585066314453785, 8.797912198022049, 0.6440064359487456, 6.6806756618687535, 3.4677296379434313, 4.594443985013926, 7.977461589779924, 8.14171242466327, 8.581137323559545, 7.703051145336178, 6.600033412908561, 5.769942419978375, 7.159662783416678, 4.328551239667081, 7.129393364035272, 3.773293180139753, 8.108612161699165, 5.535513030832425, 6.562511080111334, 7.165486385637922, 5.678876423176244, 4.145661442306123, 6.817163605212528, 3.872308678706981, 5.394305174872514, 5.560675749344192, 6.118210127331687, 7.739735765865424, 7.0389977349935196, 1.6388763039575227, 7.134739360116683, 8.525795974187144, 9.874746780438663, 3.937468001555617, 7.76791609473754, 7.518389558684755, 8.553924653350448, 10.212520558823302, 7.68926789475501, 7.89280654380878, 4.309482408369576, 9.22513233469865, 5.76646791079732, 5.207801371723332, 5.894631472341354, 7.144190261919277, 3.3997363096570252, 7.767606858246901, 5.734280217658546, 4.657403581219524, 7.363964753149711, 7.121932560846187, 9.096035483824554, 6.401209178263617, 5.8589238399817445, 2.7902876663808795, 6.873846656397988, 9.048723507666404, 4.1466274725670305, 7.084022772193444, 4.975121160533118, 4.487013580213062], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5932685933930577, "mean_inference_ms": 7.0759974825436895, "mean_action_processing_ms": 0.5726399971360222, "mean_env_wait_ms": 25.83051270184917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024086475372314453, "StateBufferConnector_ms": 0.027043581008911133, "ViewRequirementAgentConnector_ms": 0.6901819705963135}}, "episode_reward_max": 10.212520558823302, "episode_reward_min": -0.1459251554395895, "episode_reward_mean": 6.00740032327598, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.8855092245222482, -0.1459251554395895, 6.029854900352927, 7.110087531391013, 7.729922174191424, 5.990936508763553, 8.437363917174855, 6.399188849585409, 3.536349618259066, 6.430270703665812, 6.844571170807605, 2.471742730486311, 4.284491101030982, 4.736656270413109, 3.9434190475157456, 8.531431214459847, 8.483899405193238, 5.372873116369736, 6.437767389285494, 0.7988724416185855, 6.436711042223351, 3.9087004628779085, 5.543978520674428, 1.230167934055221, 7.954290646780821, 6.749356368183013, 6.202381014728004, 5.937674282761598, 4.631024382315129, 7.356866321926497, 5.751749092527105, 7.898529340495853, 6.314265956328143, 7.638458190953357, 8.245704507259125, 2.908663358729584, 4.230428085796285, 4.718777099445056, 3.585066314453785, 8.797912198022049, 0.6440064359487456, 6.6806756618687535, 3.4677296379434313, 4.594443985013926, 7.977461589779924, 8.14171242466327, 8.581137323559545, 7.703051145336178, 6.600033412908561, 5.769942419978375, 7.159662783416678, 4.328551239667081, 7.129393364035272, 3.773293180139753, 8.108612161699165, 5.535513030832425, 6.562511080111334, 7.165486385637922, 5.678876423176244, 4.145661442306123, 6.817163605212528, 3.872308678706981, 5.394305174872514, 5.560675749344192, 6.118210127331687, 7.739735765865424, 7.0389977349935196, 1.6388763039575227, 7.134739360116683, 8.525795974187144, 9.874746780438663, 3.937468001555617, 7.76791609473754, 7.518389558684755, 8.553924653350448, 10.212520558823302, 7.68926789475501, 7.89280654380878, 4.309482408369576, 9.22513233469865, 5.76646791079732, 5.207801371723332, 5.894631472341354, 7.144190261919277, 3.3997363096570252, 7.767606858246901, 5.734280217658546, 4.657403581219524, 7.363964753149711, 7.121932560846187, 9.096035483824554, 6.401209178263617, 5.8589238399817445, 2.7902876663808795, 6.873846656397988, 9.048723507666404, 4.1466274725670305, 7.084022772193444, 4.975121160533118, 4.487013580213062], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5932685933930577, "mean_inference_ms": 7.0759974825436895, "mean_action_processing_ms": 0.5726399971360222, "mean_env_wait_ms": 25.83051270184917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024086475372314453, "StateBufferConnector_ms": 0.027043581008911133, "ViewRequirementAgentConnector_ms": 0.6901819705963135}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040926, "num_agent_steps_trained": 3040926, "num_env_steps_sampled": 3040926, "num_env_steps_trained": 3040926, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 268.1185007721784, "num_env_steps_trained_throughput_per_sec": 268.1185007721784, "timesteps_total": 3040926, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3040926, "timers": {"training_iteration_time_ms": 57915.973, "sample_time_ms": 43879.821, "load_time_ms": 619.965, "load_throughput": 25224.014, "learn_time_ms": 13015.568, "learn_throughput": 1201.484, "synch_weights_time_ms": 375.32}, "counters": {"num_env_steps_sampled": 3040926, "num_env_steps_trained": 3040926, "num_agent_steps_sampled": 3040926, "num_agent_steps_trained": 3040926}, "done": false, "episodes_total": 938, "training_iteration": 199, "trial_id": "c5092_00000", "date": "2025-06-08_10-41-02", "timestamp": 1749372062, "time_this_iter_s": 58.34097361564636, "time_total_s": 3607.5206441879272, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3607.5206441879272, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 78.81323529411763, "ram_util_percent": 60.81323529411764, "gpu_util_percent0": 0.08323529411764705, "vram_util_percent0": 0.18837603400735292}}
{"evaluation": {"sampler_results": {"episode_reward_max": -1.2237802222030676, "episode_reward_min": -5.465191802312147, "episode_reward_mean": -3.110513940647434, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9879739943218266, -5.069981327757838, -1.2237802222030676, -1.8056423566422892, -5.465191802312147], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.25627959408225, "mean_inference_ms": 3.6188958407856497, "mean_action_processing_ms": 0.26249288956793637, "mean_env_wait_ms": 11.526973750749137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040078163146972656, "StateBufferConnector_ms": 0.020074844360351562, "ViewRequirementAgentConnector_ms": 0.6214094161987305}}, "episode_reward_max": -1.2237802222030676, "episode_reward_min": -5.465191802312147, "episode_reward_mean": -3.110513940647434, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9879739943218266, -5.069981327757838, -1.2237802222030676, -1.8056423566422892, -5.465191802312147], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.25627959408225, "mean_inference_ms": 3.6188958407856497, "mean_action_processing_ms": 0.26249288956793637, "mean_env_wait_ms": 11.526973750749137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040078163146972656, "StateBufferConnector_ms": 0.020074844360351562, "ViewRequirementAgentConnector_ms": 0.6214094161987305}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.959074e-05, "total_loss": -0.13606273526103574, "policy_loss": -0.03747729261077686, "vf_loss": 0.012356722304512832, "vf_explained_var": 0.7604230363802477, "kl": 0.02624853190167092, "entropy": 21.221151379671962, "entropy_coeff": 0.004918148}, "model": {}, "num_grad_updates_lifetime": 37125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3056564, "num_env_steps_trained": 3056564, "num_agent_steps_sampled": 3056564, "num_agent_steps_trained": 3056564}, "sampler_results": {"episode_reward_max": 10.212520558823302, "episode_reward_min": 0.6440064359487456, "episode_reward_mean": 6.052141548540235, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.9434190475157456, 8.531431214459847, 8.483899405193238, 5.372873116369736, 6.437767389285494, 0.7988724416185855, 6.436711042223351, 3.9087004628779085, 5.543978520674428, 1.230167934055221, 7.954290646780821, 6.749356368183013, 6.202381014728004, 5.937674282761598, 4.631024382315129, 7.356866321926497, 5.751749092527105, 7.898529340495853, 6.314265956328143, 7.638458190953357, 8.245704507259125, 2.908663358729584, 4.230428085796285, 4.718777099445056, 3.585066314453785, 8.797912198022049, 0.6440064359487456, 6.6806756618687535, 3.4677296379434313, 4.594443985013926, 7.977461589779924, 8.14171242466327, 8.581137323559545, 7.703051145336178, 6.600033412908561, 5.769942419978375, 7.159662783416678, 4.328551239667081, 7.129393364035272, 3.773293180139753, 8.108612161699165, 5.535513030832425, 6.562511080111334, 7.165486385637922, 5.678876423176244, 4.145661442306123, 6.817163605212528, 3.872308678706981, 5.394305174872514, 5.560675749344192, 6.118210127331687, 7.739735765865424, 7.0389977349935196, 1.6388763039575227, 7.134739360116683, 8.525795974187144, 9.874746780438663, 3.937468001555617, 7.76791609473754, 7.518389558684755, 8.553924653350448, 10.212520558823302, 7.68926789475501, 7.89280654380878, 4.309482408369576, 9.22513233469865, 5.76646791079732, 5.207801371723332, 5.894631472341354, 7.144190261919277, 3.3997363096570252, 7.767606858246901, 5.734280217658546, 4.657403581219524, 7.363964753149711, 7.121932560846187, 9.096035483824554, 6.401209178263617, 5.8589238399817445, 2.7902876663808795, 6.873846656397988, 9.048723507666404, 4.1466274725670305, 7.084022772193444, 4.975121160533118, 4.487013580213062, 8.593500192018396, 3.567799311072552, 7.155542823177063, 6.642485863260897, 6.673912113765506, 7.050746381860062, 4.708477068786997, 4.97778074181699, 3.504666436215178, 4.441151371057397, 3.4559549433905588, 5.2960161882389984, 2.4471500637439707, 9.699958573225617], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.594512939471982, "mean_inference_ms": 7.090068425315495, "mean_action_processing_ms": 0.5744571609603404, "mean_env_wait_ms": 25.87572961837174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025079011917114258, "StateBufferConnector_ms": 0.029829740524291992, "ViewRequirementAgentConnector_ms": 0.6858973503112793}}, "episode_reward_max": 10.212520558823302, "episode_reward_min": 0.6440064359487456, "episode_reward_mean": 6.052141548540235, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.9434190475157456, 8.531431214459847, 8.483899405193238, 5.372873116369736, 6.437767389285494, 0.7988724416185855, 6.436711042223351, 3.9087004628779085, 5.543978520674428, 1.230167934055221, 7.954290646780821, 6.749356368183013, 6.202381014728004, 5.937674282761598, 4.631024382315129, 7.356866321926497, 5.751749092527105, 7.898529340495853, 6.314265956328143, 7.638458190953357, 8.245704507259125, 2.908663358729584, 4.230428085796285, 4.718777099445056, 3.585066314453785, 8.797912198022049, 0.6440064359487456, 6.6806756618687535, 3.4677296379434313, 4.594443985013926, 7.977461589779924, 8.14171242466327, 8.581137323559545, 7.703051145336178, 6.600033412908561, 5.769942419978375, 7.159662783416678, 4.328551239667081, 7.129393364035272, 3.773293180139753, 8.108612161699165, 5.535513030832425, 6.562511080111334, 7.165486385637922, 5.678876423176244, 4.145661442306123, 6.817163605212528, 3.872308678706981, 5.394305174872514, 5.560675749344192, 6.118210127331687, 7.739735765865424, 7.0389977349935196, 1.6388763039575227, 7.134739360116683, 8.525795974187144, 9.874746780438663, 3.937468001555617, 7.76791609473754, 7.518389558684755, 8.553924653350448, 10.212520558823302, 7.68926789475501, 7.89280654380878, 4.309482408369576, 9.22513233469865, 5.76646791079732, 5.207801371723332, 5.894631472341354, 7.144190261919277, 3.3997363096570252, 7.767606858246901, 5.734280217658546, 4.657403581219524, 7.363964753149711, 7.121932560846187, 9.096035483824554, 6.401209178263617, 5.8589238399817445, 2.7902876663808795, 6.873846656397988, 9.048723507666404, 4.1466274725670305, 7.084022772193444, 4.975121160533118, 4.487013580213062, 8.593500192018396, 3.567799311072552, 7.155542823177063, 6.642485863260897, 6.673912113765506, 7.050746381860062, 4.708477068786997, 4.97778074181699, 3.504666436215178, 4.441151371057397, 3.4559549433905588, 5.2960161882389984, 2.4471500637439707, 9.699958573225617], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.594512939471982, "mean_inference_ms": 7.090068425315495, "mean_action_processing_ms": 0.5744571609603404, "mean_env_wait_ms": 25.87572961837174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025079011917114258, "StateBufferConnector_ms": 0.029829740524291992, "ViewRequirementAgentConnector_ms": 0.6858973503112793}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3056564, "num_agent_steps_trained": 3056564, "num_env_steps_sampled": 3056564, "num_env_steps_trained": 3056564, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 261.64486928677786, "num_env_steps_trained_throughput_per_sec": 261.64486928677786, "timesteps_total": 3056564, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3056564, "timers": {"training_iteration_time_ms": 58271.885, "sample_time_ms": 44215.743, "load_time_ms": 636.04, "load_throughput": 24586.495, "learn_time_ms": 13021.469, "learn_throughput": 1200.94, "synch_weights_time_ms": 373.033}, "counters": {"num_env_steps_sampled": 3056564, "num_env_steps_trained": 3056564, "num_agent_steps_sampled": 3056564, "num_agent_steps_trained": 3056564}, "done": false, "episodes_total": 952, "training_iteration": 200, "trial_id": "c5092_00000", "date": "2025-06-08_10-42-20", "timestamp": 1749372140, "time_this_iter_s": 78.06944155693054, "time_total_s": 3685.590085744858, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3685.590085744858, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 66.68804347826087, "ram_util_percent": 60.77065217391305, "gpu_util_percent0": 0.06239130434782609, "vram_util_percent0": 0.18863932291666674}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.943436e-05, "total_loss": -0.1265075620837425, "policy_loss": -0.02944291585970735, "vf_loss": 0.012916263876144182, "vf_explained_var": 0.7564996226267381, "kl": 0.027759862047588447, "entropy": 21.1045779505643, "entropy_coeff": 0.004886872}, "model": {}, "num_grad_updates_lifetime": 37675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3072202, "num_env_steps_trained": 3072202, "num_agent_steps_sampled": 3072202, "num_agent_steps_trained": 3072202}, "sampler_results": {"episode_reward_max": 10.212520558823302, "episode_reward_min": 0.6440064359487456, "episode_reward_mean": 6.172650256581326, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.631024382315129, 7.356866321926497, 5.751749092527105, 7.898529340495853, 6.314265956328143, 7.638458190953357, 8.245704507259125, 2.908663358729584, 4.230428085796285, 4.718777099445056, 3.585066314453785, 8.797912198022049, 0.6440064359487456, 6.6806756618687535, 3.4677296379434313, 4.594443985013926, 7.977461589779924, 8.14171242466327, 8.581137323559545, 7.703051145336178, 6.600033412908561, 5.769942419978375, 7.159662783416678, 4.328551239667081, 7.129393364035272, 3.773293180139753, 8.108612161699165, 5.535513030832425, 6.562511080111334, 7.165486385637922, 5.678876423176244, 4.145661442306123, 6.817163605212528, 3.872308678706981, 5.394305174872514, 5.560675749344192, 6.118210127331687, 7.739735765865424, 7.0389977349935196, 1.6388763039575227, 7.134739360116683, 8.525795974187144, 9.874746780438663, 3.937468001555617, 7.76791609473754, 7.518389558684755, 8.553924653350448, 10.212520558823302, 7.68926789475501, 7.89280654380878, 4.309482408369576, 9.22513233469865, 5.76646791079732, 5.207801371723332, 5.894631472341354, 7.144190261919277, 3.3997363096570252, 7.767606858246901, 5.734280217658546, 4.657403581219524, 7.363964753149711, 7.121932560846187, 9.096035483824554, 6.401209178263617, 5.8589238399817445, 2.7902876663808795, 6.873846656397988, 9.048723507666404, 4.1466274725670305, 7.084022772193444, 4.975121160533118, 4.487013580213062, 8.593500192018396, 3.567799311072552, 7.155542823177063, 6.642485863260897, 6.673912113765506, 7.050746381860062, 4.708477068786997, 4.97778074181699, 3.504666436215178, 4.441151371057397, 3.4559549433905588, 5.2960161882389984, 2.4471500637439707, 9.699958573225617, 7.080927300733387, 8.492123081153345, 2.2117898387066375, 4.389632354437747, 8.82736922185494, 7.676861045790909, 8.447188942072696, 8.16776521911822, 5.42843222828993, 7.427737316068562, 6.107182790306522, 7.908999579901613, 4.031738273594407, 3.3846464988072187], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5960231297916783, "mean_inference_ms": 7.104397935874474, "mean_action_processing_ms": 0.5762827712896754, "mean_env_wait_ms": 25.922064742043386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02208089828491211, "StateBufferConnector_ms": 0.02882552146911621, "ViewRequirementAgentConnector_ms": 0.6803703308105469}}, "episode_reward_max": 10.212520558823302, "episode_reward_min": 0.6440064359487456, "episode_reward_mean": 6.172650256581326, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.631024382315129, 7.356866321926497, 5.751749092527105, 7.898529340495853, 6.314265956328143, 7.638458190953357, 8.245704507259125, 2.908663358729584, 4.230428085796285, 4.718777099445056, 3.585066314453785, 8.797912198022049, 0.6440064359487456, 6.6806756618687535, 3.4677296379434313, 4.594443985013926, 7.977461589779924, 8.14171242466327, 8.581137323559545, 7.703051145336178, 6.600033412908561, 5.769942419978375, 7.159662783416678, 4.328551239667081, 7.129393364035272, 3.773293180139753, 8.108612161699165, 5.535513030832425, 6.562511080111334, 7.165486385637922, 5.678876423176244, 4.145661442306123, 6.817163605212528, 3.872308678706981, 5.394305174872514, 5.560675749344192, 6.118210127331687, 7.739735765865424, 7.0389977349935196, 1.6388763039575227, 7.134739360116683, 8.525795974187144, 9.874746780438663, 3.937468001555617, 7.76791609473754, 7.518389558684755, 8.553924653350448, 10.212520558823302, 7.68926789475501, 7.89280654380878, 4.309482408369576, 9.22513233469865, 5.76646791079732, 5.207801371723332, 5.894631472341354, 7.144190261919277, 3.3997363096570252, 7.767606858246901, 5.734280217658546, 4.657403581219524, 7.363964753149711, 7.121932560846187, 9.096035483824554, 6.401209178263617, 5.8589238399817445, 2.7902876663808795, 6.873846656397988, 9.048723507666404, 4.1466274725670305, 7.084022772193444, 4.975121160533118, 4.487013580213062, 8.593500192018396, 3.567799311072552, 7.155542823177063, 6.642485863260897, 6.673912113765506, 7.050746381860062, 4.708477068786997, 4.97778074181699, 3.504666436215178, 4.441151371057397, 3.4559549433905588, 5.2960161882389984, 2.4471500637439707, 9.699958573225617, 7.080927300733387, 8.492123081153345, 2.2117898387066375, 4.389632354437747, 8.82736922185494, 7.676861045790909, 8.447188942072696, 8.16776521911822, 5.42843222828993, 7.427737316068562, 6.107182790306522, 7.908999579901613, 4.031738273594407, 3.3846464988072187], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5960231297916783, "mean_inference_ms": 7.104397935874474, "mean_action_processing_ms": 0.5762827712896754, "mean_env_wait_ms": 25.922064742043386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02208089828491211, "StateBufferConnector_ms": 0.02882552146911621, "ViewRequirementAgentConnector_ms": 0.6803703308105469}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072202, "num_agent_steps_trained": 3072202, "num_env_steps_sampled": 3072202, "num_env_steps_trained": 3072202, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 256.9524217759598, "num_env_steps_trained_throughput_per_sec": 256.9524217759598, "timesteps_total": 3072202, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3072202, "timers": {"training_iteration_time_ms": 58654.081, "sample_time_ms": 44310.575, "load_time_ms": 656.059, "load_throughput": 23836.259, "learn_time_ms": 13296.29, "learn_throughput": 1176.118, "synch_weights_time_ms": 365.91}, "counters": {"num_env_steps_sampled": 3072202, "num_env_steps_trained": 3072202, "num_agent_steps_sampled": 3072202, "num_agent_steps_trained": 3072202}, "done": false, "episodes_total": 966, "training_iteration": 201, "trial_id": "c5092_00000", "date": "2025-06-08_10-43-21", "timestamp": 1749372201, "time_this_iter_s": 60.87206721305847, "time_total_s": 3746.4621529579163, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3746.4621529579163, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 79.65142857142857, "ram_util_percent": 59.34857142857144, "gpu_util_percent0": 0.07857142857142858, "vram_util_percent0": 0.18863932291666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.927798e-05, "total_loss": -0.12851703321878713, "policy_loss": -0.031414409081652675, "vf_loss": 0.012480607775293967, "vf_explained_var": 0.7503225379640406, "kl": 0.025792566240788246, "entropy": 21.189373937086625, "entropy_coeff": 0.004855596}, "model": {}, "num_grad_updates_lifetime": 38225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3087840, "num_env_steps_trained": 3087840, "num_agent_steps_sampled": 3087840, "num_agent_steps_trained": 3087840}, "sampler_results": {"episode_reward_max": 10.212520558823302, "episode_reward_min": 0.172383156654481, "episode_reward_mean": 6.244676213314619, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.4677296379434313, 4.594443985013926, 7.977461589779924, 8.14171242466327, 8.581137323559545, 7.703051145336178, 6.600033412908561, 5.769942419978375, 7.159662783416678, 4.328551239667081, 7.129393364035272, 3.773293180139753, 8.108612161699165, 5.535513030832425, 6.562511080111334, 7.165486385637922, 5.678876423176244, 4.145661442306123, 6.817163605212528, 3.872308678706981, 5.394305174872514, 5.560675749344192, 6.118210127331687, 7.739735765865424, 7.0389977349935196, 1.6388763039575227, 7.134739360116683, 8.525795974187144, 9.874746780438663, 3.937468001555617, 7.76791609473754, 7.518389558684755, 8.553924653350448, 10.212520558823302, 7.68926789475501, 7.89280654380878, 4.309482408369576, 9.22513233469865, 5.76646791079732, 5.207801371723332, 5.894631472341354, 7.144190261919277, 3.3997363096570252, 7.767606858246901, 5.734280217658546, 4.657403581219524, 7.363964753149711, 7.121932560846187, 9.096035483824554, 6.401209178263617, 5.8589238399817445, 2.7902876663808795, 6.873846656397988, 9.048723507666404, 4.1466274725670305, 7.084022772193444, 4.975121160533118, 4.487013580213062, 8.593500192018396, 3.567799311072552, 7.155542823177063, 6.642485863260897, 6.673912113765506, 7.050746381860062, 4.708477068786997, 4.97778074181699, 3.504666436215178, 4.441151371057397, 3.4559549433905588, 5.2960161882389984, 2.4471500637439707, 9.699958573225617, 7.080927300733387, 8.492123081153345, 2.2117898387066375, 4.389632354437747, 8.82736922185494, 7.676861045790909, 8.447188942072696, 8.16776521911822, 5.42843222828993, 7.427737316068562, 6.107182790306522, 7.908999579901613, 4.031738273594407, 3.3846464988072187, 8.467923564932333, 2.359118068258604, 6.2571455719887945, 7.432237297354226, 6.53703746590876, 5.442127668793366, 7.787609215018729, 0.172383156654481, 7.149608191858095, 6.114905033017736, 8.623139849969998, 7.488689321171734, 4.457991616788028, 8.314806597683965], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5979689675490827, "mean_inference_ms": 7.118937612019712, "mean_action_processing_ms": 0.578076802551223, "mean_env_wait_ms": 25.969009249046096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02611064910888672, "StateBufferConnector_ms": 0.026018857955932617, "ViewRequirementAgentConnector_ms": 0.6962921619415283}}, "episode_reward_max": 10.212520558823302, "episode_reward_min": 0.172383156654481, "episode_reward_mean": 6.244676213314619, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.4677296379434313, 4.594443985013926, 7.977461589779924, 8.14171242466327, 8.581137323559545, 7.703051145336178, 6.600033412908561, 5.769942419978375, 7.159662783416678, 4.328551239667081, 7.129393364035272, 3.773293180139753, 8.108612161699165, 5.535513030832425, 6.562511080111334, 7.165486385637922, 5.678876423176244, 4.145661442306123, 6.817163605212528, 3.872308678706981, 5.394305174872514, 5.560675749344192, 6.118210127331687, 7.739735765865424, 7.0389977349935196, 1.6388763039575227, 7.134739360116683, 8.525795974187144, 9.874746780438663, 3.937468001555617, 7.76791609473754, 7.518389558684755, 8.553924653350448, 10.212520558823302, 7.68926789475501, 7.89280654380878, 4.309482408369576, 9.22513233469865, 5.76646791079732, 5.207801371723332, 5.894631472341354, 7.144190261919277, 3.3997363096570252, 7.767606858246901, 5.734280217658546, 4.657403581219524, 7.363964753149711, 7.121932560846187, 9.096035483824554, 6.401209178263617, 5.8589238399817445, 2.7902876663808795, 6.873846656397988, 9.048723507666404, 4.1466274725670305, 7.084022772193444, 4.975121160533118, 4.487013580213062, 8.593500192018396, 3.567799311072552, 7.155542823177063, 6.642485863260897, 6.673912113765506, 7.050746381860062, 4.708477068786997, 4.97778074181699, 3.504666436215178, 4.441151371057397, 3.4559549433905588, 5.2960161882389984, 2.4471500637439707, 9.699958573225617, 7.080927300733387, 8.492123081153345, 2.2117898387066375, 4.389632354437747, 8.82736922185494, 7.676861045790909, 8.447188942072696, 8.16776521911822, 5.42843222828993, 7.427737316068562, 6.107182790306522, 7.908999579901613, 4.031738273594407, 3.3846464988072187, 8.467923564932333, 2.359118068258604, 6.2571455719887945, 7.432237297354226, 6.53703746590876, 5.442127668793366, 7.787609215018729, 0.172383156654481, 7.149608191858095, 6.114905033017736, 8.623139849969998, 7.488689321171734, 4.457991616788028, 8.314806597683965], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5979689675490827, "mean_inference_ms": 7.118937612019712, "mean_action_processing_ms": 0.578076802551223, "mean_env_wait_ms": 25.969009249046096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02611064910888672, "StateBufferConnector_ms": 0.026018857955932617, "ViewRequirementAgentConnector_ms": 0.6962921619415283}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3087840, "num_agent_steps_trained": 3087840, "num_env_steps_sampled": 3087840, "num_env_steps_trained": 3087840, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 264.2562056138043, "num_env_steps_trained_throughput_per_sec": 264.2562056138043, "timesteps_total": 3087840, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3087840, "timers": {"training_iteration_time_ms": 58825.94, "sample_time_ms": 44403.268, "load_time_ms": 672.571, "load_throughput": 23251.08, "learn_time_ms": 13356.28, "learn_throughput": 1170.835, "synch_weights_time_ms": 368.228}, "counters": {"num_env_steps_sampled": 3087840, "num_env_steps_trained": 3087840, "num_agent_steps_sampled": 3087840, "num_agent_steps_trained": 3087840}, "done": false, "episodes_total": 980, "training_iteration": 202, "trial_id": "c5092_00000", "date": "2025-06-08_10-44-20", "timestamp": 1749372260, "time_this_iter_s": 59.19243383407593, "time_total_s": 3805.654586791992, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3805.654586791992, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 79.03623188405797, "ram_util_percent": 53.13913043478262, "gpu_util_percent0": 0.07956521739130434, "vram_util_percent0": 0.18863932291666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.91216e-05, "total_loss": -0.13163645000239327, "policy_loss": -0.03491839338908903, "vf_loss": 0.011400544912215661, "vf_explained_var": 0.7903837438063188, "kl": 0.027055625683940227, "entropy": 21.200576659115878, "entropy_coeff": 0.004824319999999999}, "model": {}, "num_grad_updates_lifetime": 38775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3103478, "num_env_steps_trained": 3103478, "num_agent_steps_sampled": 3103478, "num_agent_steps_trained": 3103478}, "sampler_results": {"episode_reward_max": 10.212520558823302, "episode_reward_min": 0.172383156654481, "episode_reward_mean": 6.261222311097254, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.562511080111334, 7.165486385637922, 5.678876423176244, 4.145661442306123, 6.817163605212528, 3.872308678706981, 5.394305174872514, 5.560675749344192, 6.118210127331687, 7.739735765865424, 7.0389977349935196, 1.6388763039575227, 7.134739360116683, 8.525795974187144, 9.874746780438663, 3.937468001555617, 7.76791609473754, 7.518389558684755, 8.553924653350448, 10.212520558823302, 7.68926789475501, 7.89280654380878, 4.309482408369576, 9.22513233469865, 5.76646791079732, 5.207801371723332, 5.894631472341354, 7.144190261919277, 3.3997363096570252, 7.767606858246901, 5.734280217658546, 4.657403581219524, 7.363964753149711, 7.121932560846187, 9.096035483824554, 6.401209178263617, 5.8589238399817445, 2.7902876663808795, 6.873846656397988, 9.048723507666404, 4.1466274725670305, 7.084022772193444, 4.975121160533118, 4.487013580213062, 8.593500192018396, 3.567799311072552, 7.155542823177063, 6.642485863260897, 6.673912113765506, 7.050746381860062, 4.708477068786997, 4.97778074181699, 3.504666436215178, 4.441151371057397, 3.4559549433905588, 5.2960161882389984, 2.4471500637439707, 9.699958573225617, 7.080927300733387, 8.492123081153345, 2.2117898387066375, 4.389632354437747, 8.82736922185494, 7.676861045790909, 8.447188942072696, 8.16776521911822, 5.42843222828993, 7.427737316068562, 6.107182790306522, 7.908999579901613, 4.031738273594407, 3.3846464988072187, 8.467923564932333, 2.359118068258604, 6.2571455719887945, 7.432237297354226, 6.53703746590876, 5.442127668793366, 7.787609215018729, 0.172383156654481, 7.149608191858095, 6.114905033017736, 8.623139849969998, 7.488689321171734, 4.457991616788028, 8.314806597683965, 6.090892418471067, 6.5883688713594015, 4.0475897996495735, 6.536413786642056, 6.295055435575683, 6.583083340303729, 6.000840976653165, 7.695895787688047, 5.380610832843903, 7.091170544778946, 4.287062275024336, 7.8252842374743725, 6.673450487586664, 9.429428683185991], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6004467330721153, "mean_inference_ms": 7.136159794384566, "mean_action_processing_ms": 0.5800760901141665, "mean_env_wait_ms": 26.02228834176964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02808523178100586, "StateBufferConnector_ms": 0.025988340377807617, "ViewRequirementAgentConnector_ms": 0.7165627479553223}}, "episode_reward_max": 10.212520558823302, "episode_reward_min": 0.172383156654481, "episode_reward_mean": 6.261222311097254, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.562511080111334, 7.165486385637922, 5.678876423176244, 4.145661442306123, 6.817163605212528, 3.872308678706981, 5.394305174872514, 5.560675749344192, 6.118210127331687, 7.739735765865424, 7.0389977349935196, 1.6388763039575227, 7.134739360116683, 8.525795974187144, 9.874746780438663, 3.937468001555617, 7.76791609473754, 7.518389558684755, 8.553924653350448, 10.212520558823302, 7.68926789475501, 7.89280654380878, 4.309482408369576, 9.22513233469865, 5.76646791079732, 5.207801371723332, 5.894631472341354, 7.144190261919277, 3.3997363096570252, 7.767606858246901, 5.734280217658546, 4.657403581219524, 7.363964753149711, 7.121932560846187, 9.096035483824554, 6.401209178263617, 5.8589238399817445, 2.7902876663808795, 6.873846656397988, 9.048723507666404, 4.1466274725670305, 7.084022772193444, 4.975121160533118, 4.487013580213062, 8.593500192018396, 3.567799311072552, 7.155542823177063, 6.642485863260897, 6.673912113765506, 7.050746381860062, 4.708477068786997, 4.97778074181699, 3.504666436215178, 4.441151371057397, 3.4559549433905588, 5.2960161882389984, 2.4471500637439707, 9.699958573225617, 7.080927300733387, 8.492123081153345, 2.2117898387066375, 4.389632354437747, 8.82736922185494, 7.676861045790909, 8.447188942072696, 8.16776521911822, 5.42843222828993, 7.427737316068562, 6.107182790306522, 7.908999579901613, 4.031738273594407, 3.3846464988072187, 8.467923564932333, 2.359118068258604, 6.2571455719887945, 7.432237297354226, 6.53703746590876, 5.442127668793366, 7.787609215018729, 0.172383156654481, 7.149608191858095, 6.114905033017736, 8.623139849969998, 7.488689321171734, 4.457991616788028, 8.314806597683965, 6.090892418471067, 6.5883688713594015, 4.0475897996495735, 6.536413786642056, 6.295055435575683, 6.583083340303729, 6.000840976653165, 7.695895787688047, 5.380610832843903, 7.091170544778946, 4.287062275024336, 7.8252842374743725, 6.673450487586664, 9.429428683185991], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6004467330721153, "mean_inference_ms": 7.136159794384566, "mean_action_processing_ms": 0.5800760901141665, "mean_env_wait_ms": 26.02228834176964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02808523178100586, "StateBufferConnector_ms": 0.025988340377807617, "ViewRequirementAgentConnector_ms": 0.7165627479553223}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3103478, "num_agent_steps_trained": 3103478, "num_env_steps_sampled": 3103478, "num_env_steps_trained": 3103478, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 238.21887954795565, "num_env_steps_trained_throughput_per_sec": 238.21887954795565, "timesteps_total": 3103478, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3103478, "timers": {"training_iteration_time_ms": 59516.383, "sample_time_ms": 45054.197, "load_time_ms": 670.589, "load_throughput": 23319.806, "learn_time_ms": 13396.348, "learn_throughput": 1167.333, "synch_weights_time_ms": 369.923}, "counters": {"num_env_steps_sampled": 3103478, "num_env_steps_trained": 3103478, "num_agent_steps_sampled": 3103478, "num_agent_steps_trained": 3103478}, "done": false, "episodes_total": 994, "training_iteration": 203, "trial_id": "c5092_00000", "date": "2025-06-08_10-45-26", "timestamp": 1749372326, "time_this_iter_s": 65.66365098953247, "time_total_s": 3871.3182377815247, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3871.3182377815247, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 81.27333333333333, "ram_util_percent": 53.459999999999994, "gpu_util_percent0": 0.06879999999999999, "vram_util_percent0": 0.18863932291666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.896522e-05, "total_loss": -0.11943391350986944, "policy_loss": -0.02379348153762583, "vf_loss": 0.01269699723502113, "vf_explained_var": 0.7801933351430026, "kl": 0.027587827088337655, "entropy": 21.204013012972744, "entropy_coeff": 0.004793044000000001}, "model": {}, "num_grad_updates_lifetime": 39325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3119116, "num_env_steps_trained": 3119116, "num_agent_steps_sampled": 3119116, "num_agent_steps_trained": 3119116}, "sampler_results": {"episode_reward_max": 10.212520558823302, "episode_reward_min": 0.172383156654481, "episode_reward_mean": 6.17574269283198, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.874746780438663, 3.937468001555617, 7.76791609473754, 7.518389558684755, 8.553924653350448, 10.212520558823302, 7.68926789475501, 7.89280654380878, 4.309482408369576, 9.22513233469865, 5.76646791079732, 5.207801371723332, 5.894631472341354, 7.144190261919277, 3.3997363096570252, 7.767606858246901, 5.734280217658546, 4.657403581219524, 7.363964753149711, 7.121932560846187, 9.096035483824554, 6.401209178263617, 5.8589238399817445, 2.7902876663808795, 6.873846656397988, 9.048723507666404, 4.1466274725670305, 7.084022772193444, 4.975121160533118, 4.487013580213062, 8.593500192018396, 3.567799311072552, 7.155542823177063, 6.642485863260897, 6.673912113765506, 7.050746381860062, 4.708477068786997, 4.97778074181699, 3.504666436215178, 4.441151371057397, 3.4559549433905588, 5.2960161882389984, 2.4471500637439707, 9.699958573225617, 7.080927300733387, 8.492123081153345, 2.2117898387066375, 4.389632354437747, 8.82736922185494, 7.676861045790909, 8.447188942072696, 8.16776521911822, 5.42843222828993, 7.427737316068562, 6.107182790306522, 7.908999579901613, 4.031738273594407, 3.3846464988072187, 8.467923564932333, 2.359118068258604, 6.2571455719887945, 7.432237297354226, 6.53703746590876, 5.442127668793366, 7.787609215018729, 0.172383156654481, 7.149608191858095, 6.114905033017736, 8.623139849969998, 7.488689321171734, 4.457991616788028, 8.314806597683965, 6.090892418471067, 6.5883688713594015, 4.0475897996495735, 6.536413786642056, 6.295055435575683, 6.583083340303729, 6.000840976653165, 7.695895787688047, 5.380610832843903, 7.091170544778946, 4.287062275024336, 7.8252842374743725, 6.673450487586664, 9.429428683185991, 5.883468599048778, 4.916774225948476, 6.400980024623894, 6.6500867394461824, 5.466460402235529, 6.667491316662975, 7.827185439153695, 4.5122123584513325, 1.571731988088558, 3.42404017041952, 4.49244621329341, 4.545136346506834, 3.77259643413208, 8.714771721281249], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6030043698324588, "mean_inference_ms": 7.155085118971108, "mean_action_processing_ms": 0.5821974300790406, "mean_env_wait_ms": 26.081218560886388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0310821533203125, "StateBufferConnector_ms": 0.030112266540527344, "ViewRequirementAgentConnector_ms": 0.7347631454467773}}, "episode_reward_max": 10.212520558823302, "episode_reward_min": 0.172383156654481, "episode_reward_mean": 6.17574269283198, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.874746780438663, 3.937468001555617, 7.76791609473754, 7.518389558684755, 8.553924653350448, 10.212520558823302, 7.68926789475501, 7.89280654380878, 4.309482408369576, 9.22513233469865, 5.76646791079732, 5.207801371723332, 5.894631472341354, 7.144190261919277, 3.3997363096570252, 7.767606858246901, 5.734280217658546, 4.657403581219524, 7.363964753149711, 7.121932560846187, 9.096035483824554, 6.401209178263617, 5.8589238399817445, 2.7902876663808795, 6.873846656397988, 9.048723507666404, 4.1466274725670305, 7.084022772193444, 4.975121160533118, 4.487013580213062, 8.593500192018396, 3.567799311072552, 7.155542823177063, 6.642485863260897, 6.673912113765506, 7.050746381860062, 4.708477068786997, 4.97778074181699, 3.504666436215178, 4.441151371057397, 3.4559549433905588, 5.2960161882389984, 2.4471500637439707, 9.699958573225617, 7.080927300733387, 8.492123081153345, 2.2117898387066375, 4.389632354437747, 8.82736922185494, 7.676861045790909, 8.447188942072696, 8.16776521911822, 5.42843222828993, 7.427737316068562, 6.107182790306522, 7.908999579901613, 4.031738273594407, 3.3846464988072187, 8.467923564932333, 2.359118068258604, 6.2571455719887945, 7.432237297354226, 6.53703746590876, 5.442127668793366, 7.787609215018729, 0.172383156654481, 7.149608191858095, 6.114905033017736, 8.623139849969998, 7.488689321171734, 4.457991616788028, 8.314806597683965, 6.090892418471067, 6.5883688713594015, 4.0475897996495735, 6.536413786642056, 6.295055435575683, 6.583083340303729, 6.000840976653165, 7.695895787688047, 5.380610832843903, 7.091170544778946, 4.287062275024336, 7.8252842374743725, 6.673450487586664, 9.429428683185991, 5.883468599048778, 4.916774225948476, 6.400980024623894, 6.6500867394461824, 5.466460402235529, 6.667491316662975, 7.827185439153695, 4.5122123584513325, 1.571731988088558, 3.42404017041952, 4.49244621329341, 4.545136346506834, 3.77259643413208, 8.714771721281249], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6030043698324588, "mean_inference_ms": 7.155085118971108, "mean_action_processing_ms": 0.5821974300790406, "mean_env_wait_ms": 26.081218560886388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0310821533203125, "StateBufferConnector_ms": 0.030112266540527344, "ViewRequirementAgentConnector_ms": 0.7347631454467773}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3119116, "num_agent_steps_trained": 3119116, "num_env_steps_sampled": 3119116, "num_env_steps_trained": 3119116, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 233.19195931560702, "num_env_steps_trained_throughput_per_sec": 233.19195931560702, "timesteps_total": 3119116, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3119116, "timers": {"training_iteration_time_ms": 60678.611, "sample_time_ms": 45982.857, "load_time_ms": 691.256, "load_throughput": 22622.599, "learn_time_ms": 13601.513, "learn_throughput": 1149.725, "synch_weights_time_ms": 377.412}, "counters": {"num_env_steps_sampled": 3119116, "num_env_steps_trained": 3119116, "num_agent_steps_sampled": 3119116, "num_agent_steps_trained": 3119116}, "done": false, "episodes_total": 1008, "training_iteration": 204, "trial_id": "c5092_00000", "date": "2025-06-08_10-46-33", "timestamp": 1749372393, "time_this_iter_s": 67.07765293121338, "time_total_s": 3938.395890712738, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3938.395890712738, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 81.38684210526317, "ram_util_percent": 54.086842105263166, "gpu_util_percent0": 0.07513157894736842, "vram_util_percent0": 0.18863932291666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.880884e-05, "total_loss": -0.12202390986071392, "policy_loss": -0.027452165789859876, "vf_loss": 0.012298438281498172, "vf_explained_var": 0.7682035126469352, "kl": 0.02585532228695401, "entropy": 21.06496405514804, "entropy_coeff": 0.004761768000000001}, "model": {}, "num_grad_updates_lifetime": 39875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3134754, "num_env_steps_trained": 3134754, "num_agent_steps_sampled": 3134754, "num_agent_steps_trained": 3134754}, "sampler_results": {"episode_reward_max": 9.699958573225617, "episode_reward_min": 0.172383156654481, "episode_reward_mean": 5.998851059221813, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.3997363096570252, 7.767606858246901, 5.734280217658546, 4.657403581219524, 7.363964753149711, 7.121932560846187, 9.096035483824554, 6.401209178263617, 5.8589238399817445, 2.7902876663808795, 6.873846656397988, 9.048723507666404, 4.1466274725670305, 7.084022772193444, 4.975121160533118, 4.487013580213062, 8.593500192018396, 3.567799311072552, 7.155542823177063, 6.642485863260897, 6.673912113765506, 7.050746381860062, 4.708477068786997, 4.97778074181699, 3.504666436215178, 4.441151371057397, 3.4559549433905588, 5.2960161882389984, 2.4471500637439707, 9.699958573225617, 7.080927300733387, 8.492123081153345, 2.2117898387066375, 4.389632354437747, 8.82736922185494, 7.676861045790909, 8.447188942072696, 8.16776521911822, 5.42843222828993, 7.427737316068562, 6.107182790306522, 7.908999579901613, 4.031738273594407, 3.3846464988072187, 8.467923564932333, 2.359118068258604, 6.2571455719887945, 7.432237297354226, 6.53703746590876, 5.442127668793366, 7.787609215018729, 0.172383156654481, 7.149608191858095, 6.114905033017736, 8.623139849969998, 7.488689321171734, 4.457991616788028, 8.314806597683965, 6.090892418471067, 6.5883688713594015, 4.0475897996495735, 6.536413786642056, 6.295055435575683, 6.583083340303729, 6.000840976653165, 7.695895787688047, 5.380610832843903, 7.091170544778946, 4.287062275024336, 7.8252842374743725, 6.673450487586664, 9.429428683185991, 5.883468599048778, 4.916774225948476, 6.400980024623894, 6.6500867394461824, 5.466460402235529, 6.667491316662975, 7.827185439153695, 4.5122123584513325, 1.571731988088558, 3.42404017041952, 4.49244621329341, 4.545136346506834, 3.77259643413208, 8.714771721281249, 4.916305074298134, 7.6921541363078125, 3.4972861645733855, 5.023908252537204, 7.965903330323421, 4.953427728511535, 6.5580123647088, 5.663998630132595, 7.763842541649078, 5.375992917019083, 7.715018698200282, 6.498228448885903, 4.9778822012556265, 4.703621996584068], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6056713903284199, "mean_inference_ms": 7.1744030383787925, "mean_action_processing_ms": 0.5843470094560486, "mean_env_wait_ms": 26.14071729319749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02806258201599121, "StateBufferConnector_ms": 0.029088973999023438, "ViewRequirementAgentConnector_ms": 0.7406878471374512}}, "episode_reward_max": 9.699958573225617, "episode_reward_min": 0.172383156654481, "episode_reward_mean": 5.998851059221813, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.3997363096570252, 7.767606858246901, 5.734280217658546, 4.657403581219524, 7.363964753149711, 7.121932560846187, 9.096035483824554, 6.401209178263617, 5.8589238399817445, 2.7902876663808795, 6.873846656397988, 9.048723507666404, 4.1466274725670305, 7.084022772193444, 4.975121160533118, 4.487013580213062, 8.593500192018396, 3.567799311072552, 7.155542823177063, 6.642485863260897, 6.673912113765506, 7.050746381860062, 4.708477068786997, 4.97778074181699, 3.504666436215178, 4.441151371057397, 3.4559549433905588, 5.2960161882389984, 2.4471500637439707, 9.699958573225617, 7.080927300733387, 8.492123081153345, 2.2117898387066375, 4.389632354437747, 8.82736922185494, 7.676861045790909, 8.447188942072696, 8.16776521911822, 5.42843222828993, 7.427737316068562, 6.107182790306522, 7.908999579901613, 4.031738273594407, 3.3846464988072187, 8.467923564932333, 2.359118068258604, 6.2571455719887945, 7.432237297354226, 6.53703746590876, 5.442127668793366, 7.787609215018729, 0.172383156654481, 7.149608191858095, 6.114905033017736, 8.623139849969998, 7.488689321171734, 4.457991616788028, 8.314806597683965, 6.090892418471067, 6.5883688713594015, 4.0475897996495735, 6.536413786642056, 6.295055435575683, 6.583083340303729, 6.000840976653165, 7.695895787688047, 5.380610832843903, 7.091170544778946, 4.287062275024336, 7.8252842374743725, 6.673450487586664, 9.429428683185991, 5.883468599048778, 4.916774225948476, 6.400980024623894, 6.6500867394461824, 5.466460402235529, 6.667491316662975, 7.827185439153695, 4.5122123584513325, 1.571731988088558, 3.42404017041952, 4.49244621329341, 4.545136346506834, 3.77259643413208, 8.714771721281249, 4.916305074298134, 7.6921541363078125, 3.4972861645733855, 5.023908252537204, 7.965903330323421, 4.953427728511535, 6.5580123647088, 5.663998630132595, 7.763842541649078, 5.375992917019083, 7.715018698200282, 6.498228448885903, 4.9778822012556265, 4.703621996584068], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6056713903284199, "mean_inference_ms": 7.1744030383787925, "mean_action_processing_ms": 0.5843470094560486, "mean_env_wait_ms": 26.14071729319749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02806258201599121, "StateBufferConnector_ms": 0.029088973999023438, "ViewRequirementAgentConnector_ms": 0.7406878471374512}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3134754, "num_agent_steps_trained": 3134754, "num_env_steps_sampled": 3134754, "num_env_steps_trained": 3134754, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 252.27241605520936, "num_env_steps_trained_throughput_per_sec": 252.27241605520936, "timesteps_total": 3134754, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3134754, "timers": {"training_iteration_time_ms": 61146.721, "sample_time_ms": 46378.982, "load_time_ms": 695.218, "load_throughput": 22493.66, "learn_time_ms": 13666.736, "learn_throughput": 1144.238, "synch_weights_time_ms": 379.583}, "counters": {"num_env_steps_sampled": 3134754, "num_env_steps_trained": 3134754, "num_agent_steps_sampled": 3134754, "num_agent_steps_trained": 3134754}, "done": false, "episodes_total": 1022, "training_iteration": 205, "trial_id": "c5092_00000", "date": "2025-06-08_10-47-35", "timestamp": 1749372455, "time_this_iter_s": 62.004499435424805, "time_total_s": 4000.400390148163, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4000.400390148163, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 80.09027777777777, "ram_util_percent": 54.23472222222222, "gpu_util_percent0": 0.07361111111111113, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.865246e-05, "total_loss": -0.12988257648846643, "policy_loss": -0.03593561214749405, "vf_loss": 0.013061259741979567, "vf_explained_var": 0.76443998336792, "kl": 0.026670040841406575, "entropy": 21.134162706895307, "entropy_coeff": 0.004730492}, "model": {}, "num_grad_updates_lifetime": 40425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3150392, "num_env_steps_trained": 3150392, "num_agent_steps_sampled": 3150392, "num_agent_steps_trained": 3150392}, "sampler_results": {"episode_reward_max": 9.699958573225617, "episode_reward_min": 0.172383156654481, "episode_reward_mean": 5.999697016537201, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.975121160533118, 4.487013580213062, 8.593500192018396, 3.567799311072552, 7.155542823177063, 6.642485863260897, 6.673912113765506, 7.050746381860062, 4.708477068786997, 4.97778074181699, 3.504666436215178, 4.441151371057397, 3.4559549433905588, 5.2960161882389984, 2.4471500637439707, 9.699958573225617, 7.080927300733387, 8.492123081153345, 2.2117898387066375, 4.389632354437747, 8.82736922185494, 7.676861045790909, 8.447188942072696, 8.16776521911822, 5.42843222828993, 7.427737316068562, 6.107182790306522, 7.908999579901613, 4.031738273594407, 3.3846464988072187, 8.467923564932333, 2.359118068258604, 6.2571455719887945, 7.432237297354226, 6.53703746590876, 5.442127668793366, 7.787609215018729, 0.172383156654481, 7.149608191858095, 6.114905033017736, 8.623139849969998, 7.488689321171734, 4.457991616788028, 8.314806597683965, 6.090892418471067, 6.5883688713594015, 4.0475897996495735, 6.536413786642056, 6.295055435575683, 6.583083340303729, 6.000840976653165, 7.695895787688047, 5.380610832843903, 7.091170544778946, 4.287062275024336, 7.8252842374743725, 6.673450487586664, 9.429428683185991, 5.883468599048778, 4.916774225948476, 6.400980024623894, 6.6500867394461824, 5.466460402235529, 6.667491316662975, 7.827185439153695, 4.5122123584513325, 1.571731988088558, 3.42404017041952, 4.49244621329341, 4.545136346506834, 3.77259643413208, 8.714771721281249, 4.916305074298134, 7.6921541363078125, 3.4972861645733855, 5.023908252537204, 7.965903330323421, 4.953427728511535, 6.5580123647088, 5.663998630132595, 7.763842541649078, 5.375992917019083, 7.715018698200282, 6.498228448885903, 4.9778822012556265, 4.703621996584068, 3.9067521319497143, 8.835465860885888, 4.046856146185741, 9.071874908522762, 6.5876574939966215, 7.169594043134028, 2.944861036261643, 7.189430305734002, 7.609271328702018, 5.923214564267473, 4.356759196376317, 5.506611973218712, 7.533549468745727, 6.747298131611856], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6082458090408676, "mean_inference_ms": 7.1947787997288035, "mean_action_processing_ms": 0.5865649548381462, "mean_env_wait_ms": 26.200868982133287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02104949951171875, "StateBufferConnector_ms": 0.0293734073638916, "ViewRequirementAgentConnector_ms": 0.692157506942749}}, "episode_reward_max": 9.699958573225617, "episode_reward_min": 0.172383156654481, "episode_reward_mean": 5.999697016537201, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.975121160533118, 4.487013580213062, 8.593500192018396, 3.567799311072552, 7.155542823177063, 6.642485863260897, 6.673912113765506, 7.050746381860062, 4.708477068786997, 4.97778074181699, 3.504666436215178, 4.441151371057397, 3.4559549433905588, 5.2960161882389984, 2.4471500637439707, 9.699958573225617, 7.080927300733387, 8.492123081153345, 2.2117898387066375, 4.389632354437747, 8.82736922185494, 7.676861045790909, 8.447188942072696, 8.16776521911822, 5.42843222828993, 7.427737316068562, 6.107182790306522, 7.908999579901613, 4.031738273594407, 3.3846464988072187, 8.467923564932333, 2.359118068258604, 6.2571455719887945, 7.432237297354226, 6.53703746590876, 5.442127668793366, 7.787609215018729, 0.172383156654481, 7.149608191858095, 6.114905033017736, 8.623139849969998, 7.488689321171734, 4.457991616788028, 8.314806597683965, 6.090892418471067, 6.5883688713594015, 4.0475897996495735, 6.536413786642056, 6.295055435575683, 6.583083340303729, 6.000840976653165, 7.695895787688047, 5.380610832843903, 7.091170544778946, 4.287062275024336, 7.8252842374743725, 6.673450487586664, 9.429428683185991, 5.883468599048778, 4.916774225948476, 6.400980024623894, 6.6500867394461824, 5.466460402235529, 6.667491316662975, 7.827185439153695, 4.5122123584513325, 1.571731988088558, 3.42404017041952, 4.49244621329341, 4.545136346506834, 3.77259643413208, 8.714771721281249, 4.916305074298134, 7.6921541363078125, 3.4972861645733855, 5.023908252537204, 7.965903330323421, 4.953427728511535, 6.5580123647088, 5.663998630132595, 7.763842541649078, 5.375992917019083, 7.715018698200282, 6.498228448885903, 4.9778822012556265, 4.703621996584068, 3.9067521319497143, 8.835465860885888, 4.046856146185741, 9.071874908522762, 6.5876574939966215, 7.169594043134028, 2.944861036261643, 7.189430305734002, 7.609271328702018, 5.923214564267473, 4.356759196376317, 5.506611973218712, 7.533549468745727, 6.747298131611856], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6082458090408676, "mean_inference_ms": 7.1947787997288035, "mean_action_processing_ms": 0.5865649548381462, "mean_env_wait_ms": 26.200868982133287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02104949951171875, "StateBufferConnector_ms": 0.0293734073638916, "ViewRequirementAgentConnector_ms": 0.692157506942749}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3150392, "num_agent_steps_trained": 3150392, "num_env_steps_sampled": 3150392, "num_env_steps_trained": 3150392, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 254.30768110436964, "num_env_steps_trained_throughput_per_sec": 254.30768110436964, "timesteps_total": 3150392, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3150392, "timers": {"training_iteration_time_ms": 61369.573, "sample_time_ms": 46529.755, "load_time_ms": 715.667, "load_throughput": 21850.955, "learn_time_ms": 13732.264, "learn_throughput": 1138.778, "synch_weights_time_ms": 365.883}, "counters": {"num_env_steps_sampled": 3150392, "num_env_steps_trained": 3150392, "num_agent_steps_sampled": 3150392, "num_agent_steps_trained": 3150392}, "done": false, "episodes_total": 1036, "training_iteration": 206, "trial_id": "c5092_00000", "date": "2025-06-08_10-48-37", "timestamp": 1749372517, "time_this_iter_s": 61.50843906402588, "time_total_s": 4061.9088292121887, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4061.9088292121887, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 79.54929577464789, "ram_util_percent": 53.52253521126762, "gpu_util_percent0": 0.07901408450704224, "vram_util_percent0": 0.18863932291666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.849608000000002e-05, "total_loss": -0.12022530823776668, "policy_loss": -0.02701702800193082, "vf_loss": 0.012563970618119294, "vf_explained_var": 0.7634881639480591, "kl": 0.026346458618489284, "entropy": 21.08043395129117, "entropy_coeff": 0.004699215999999999}, "model": {}, "num_grad_updates_lifetime": 40975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3166030, "num_env_steps_trained": 3166030, "num_agent_steps_sampled": 3166030, "num_agent_steps_trained": 3166030}, "sampler_results": {"episode_reward_max": 9.83902390456975, "episode_reward_min": 0.172383156654481, "episode_reward_mean": 6.175015404756245, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.4471500637439707, 9.699958573225617, 7.080927300733387, 8.492123081153345, 2.2117898387066375, 4.389632354437747, 8.82736922185494, 7.676861045790909, 8.447188942072696, 8.16776521911822, 5.42843222828993, 7.427737316068562, 6.107182790306522, 7.908999579901613, 4.031738273594407, 3.3846464988072187, 8.467923564932333, 2.359118068258604, 6.2571455719887945, 7.432237297354226, 6.53703746590876, 5.442127668793366, 7.787609215018729, 0.172383156654481, 7.149608191858095, 6.114905033017736, 8.623139849969998, 7.488689321171734, 4.457991616788028, 8.314806597683965, 6.090892418471067, 6.5883688713594015, 4.0475897996495735, 6.536413786642056, 6.295055435575683, 6.583083340303729, 6.000840976653165, 7.695895787688047, 5.380610832843903, 7.091170544778946, 4.287062275024336, 7.8252842374743725, 6.673450487586664, 9.429428683185991, 5.883468599048778, 4.916774225948476, 6.400980024623894, 6.6500867394461824, 5.466460402235529, 6.667491316662975, 7.827185439153695, 4.5122123584513325, 1.571731988088558, 3.42404017041952, 4.49244621329341, 4.545136346506834, 3.77259643413208, 8.714771721281249, 4.916305074298134, 7.6921541363078125, 3.4972861645733855, 5.023908252537204, 7.965903330323421, 4.953427728511535, 6.5580123647088, 5.663998630132595, 7.763842541649078, 5.375992917019083, 7.715018698200282, 6.498228448885903, 4.9778822012556265, 4.703621996584068, 3.9067521319497143, 8.835465860885888, 4.046856146185741, 9.071874908522762, 6.5876574939966215, 7.169594043134028, 2.944861036261643, 7.189430305734002, 7.609271328702018, 5.923214564267473, 4.356759196376317, 5.506611973218712, 7.533549468745727, 6.747298131611856, 7.014602190860056, 5.315750877124534, 5.942038208968803, 6.312973636746529, 8.083984267600965, 4.49273108540897, 4.938810046051434, 6.068004237353178, 9.83902390456975, 8.082181832815865, 7.266707573104436, 7.265775137706546, 3.4723136147901696, 8.96711038420972], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6108084406803669, "mean_inference_ms": 7.216256823154602, "mean_action_processing_ms": 0.588865317237746, "mean_env_wait_ms": 26.26349542822958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021575450897216797, "StateBufferConnector_ms": 0.023545503616333008, "ViewRequirementAgentConnector_ms": 0.7095017433166504}}, "episode_reward_max": 9.83902390456975, "episode_reward_min": 0.172383156654481, "episode_reward_mean": 6.175015404756245, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.4471500637439707, 9.699958573225617, 7.080927300733387, 8.492123081153345, 2.2117898387066375, 4.389632354437747, 8.82736922185494, 7.676861045790909, 8.447188942072696, 8.16776521911822, 5.42843222828993, 7.427737316068562, 6.107182790306522, 7.908999579901613, 4.031738273594407, 3.3846464988072187, 8.467923564932333, 2.359118068258604, 6.2571455719887945, 7.432237297354226, 6.53703746590876, 5.442127668793366, 7.787609215018729, 0.172383156654481, 7.149608191858095, 6.114905033017736, 8.623139849969998, 7.488689321171734, 4.457991616788028, 8.314806597683965, 6.090892418471067, 6.5883688713594015, 4.0475897996495735, 6.536413786642056, 6.295055435575683, 6.583083340303729, 6.000840976653165, 7.695895787688047, 5.380610832843903, 7.091170544778946, 4.287062275024336, 7.8252842374743725, 6.673450487586664, 9.429428683185991, 5.883468599048778, 4.916774225948476, 6.400980024623894, 6.6500867394461824, 5.466460402235529, 6.667491316662975, 7.827185439153695, 4.5122123584513325, 1.571731988088558, 3.42404017041952, 4.49244621329341, 4.545136346506834, 3.77259643413208, 8.714771721281249, 4.916305074298134, 7.6921541363078125, 3.4972861645733855, 5.023908252537204, 7.965903330323421, 4.953427728511535, 6.5580123647088, 5.663998630132595, 7.763842541649078, 5.375992917019083, 7.715018698200282, 6.498228448885903, 4.9778822012556265, 4.703621996584068, 3.9067521319497143, 8.835465860885888, 4.046856146185741, 9.071874908522762, 6.5876574939966215, 7.169594043134028, 2.944861036261643, 7.189430305734002, 7.609271328702018, 5.923214564267473, 4.356759196376317, 5.506611973218712, 7.533549468745727, 6.747298131611856, 7.014602190860056, 5.315750877124534, 5.942038208968803, 6.312973636746529, 8.083984267600965, 4.49273108540897, 4.938810046051434, 6.068004237353178, 9.83902390456975, 8.082181832815865, 7.266707573104436, 7.265775137706546, 3.4723136147901696, 8.96711038420972], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6108084406803669, "mean_inference_ms": 7.216256823154602, "mean_action_processing_ms": 0.588865317237746, "mean_env_wait_ms": 26.26349542822958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021575450897216797, "StateBufferConnector_ms": 0.023545503616333008, "ViewRequirementAgentConnector_ms": 0.7095017433166504}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3166030, "num_agent_steps_trained": 3166030, "num_env_steps_sampled": 3166030, "num_env_steps_trained": 3166030, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 252.98847794257085, "num_env_steps_trained_throughput_per_sec": 252.98847794257085, "timesteps_total": 3166030, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3166030, "timers": {"training_iteration_time_ms": 61543.821, "sample_time_ms": 46833.503, "load_time_ms": 723.141, "load_throughput": 21625.098, "learn_time_ms": 13594.406, "learn_throughput": 1150.326, "synch_weights_time_ms": 367.845}, "counters": {"num_env_steps_sampled": 3166030, "num_env_steps_trained": 3166030, "num_agent_steps_sampled": 3166030, "num_agent_steps_trained": 3166030}, "done": false, "episodes_total": 1050, "training_iteration": 207, "trial_id": "c5092_00000", "date": "2025-06-08_10-49-39", "timestamp": 1749372579, "time_this_iter_s": 62.007715940475464, "time_total_s": 4123.916545152664, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4123.916545152664, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 80.62957746478874, "ram_util_percent": 51.57887323943661, "gpu_util_percent0": 0.07422535211267604, "vram_util_percent0": 0.18863932291666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.833969999999998e-05, "total_loss": -0.12243021400444294, "policy_loss": -0.02956048301431689, "vf_loss": 0.01155938482674008, "vf_explained_var": 0.7537409973144531, "kl": 0.025384650278762362, "entropy": 21.068289392644708, "entropy_coeff": 0.00466794}, "model": {}, "num_grad_updates_lifetime": 41525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3181668, "num_env_steps_trained": 3181668, "num_agent_steps_sampled": 3181668, "num_agent_steps_trained": 3181668}, "sampler_results": {"episode_reward_max": 9.83902390456975, "episode_reward_min": 0.172383156654481, "episode_reward_mean": 6.151642520421787, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.031738273594407, 3.3846464988072187, 8.467923564932333, 2.359118068258604, 6.2571455719887945, 7.432237297354226, 6.53703746590876, 5.442127668793366, 7.787609215018729, 0.172383156654481, 7.149608191858095, 6.114905033017736, 8.623139849969998, 7.488689321171734, 4.457991616788028, 8.314806597683965, 6.090892418471067, 6.5883688713594015, 4.0475897996495735, 6.536413786642056, 6.295055435575683, 6.583083340303729, 6.000840976653165, 7.695895787688047, 5.380610832843903, 7.091170544778946, 4.287062275024336, 7.8252842374743725, 6.673450487586664, 9.429428683185991, 5.883468599048778, 4.916774225948476, 6.400980024623894, 6.6500867394461824, 5.466460402235529, 6.667491316662975, 7.827185439153695, 4.5122123584513325, 1.571731988088558, 3.42404017041952, 4.49244621329341, 4.545136346506834, 3.77259643413208, 8.714771721281249, 4.916305074298134, 7.6921541363078125, 3.4972861645733855, 5.023908252537204, 7.965903330323421, 4.953427728511535, 6.5580123647088, 5.663998630132595, 7.763842541649078, 5.375992917019083, 7.715018698200282, 6.498228448885903, 4.9778822012556265, 4.703621996584068, 3.9067521319497143, 8.835465860885888, 4.046856146185741, 9.071874908522762, 6.5876574939966215, 7.169594043134028, 2.944861036261643, 7.189430305734002, 7.609271328702018, 5.923214564267473, 4.356759196376317, 5.506611973218712, 7.533549468745727, 6.747298131611856, 7.014602190860056, 5.315750877124534, 5.942038208968803, 6.312973636746529, 8.083984267600965, 4.49273108540897, 4.938810046051434, 6.068004237353178, 9.83902390456975, 8.082181832815865, 7.266707573104436, 7.265775137706546, 3.4723136147901696, 8.96711038420972, 7.6315321355993495, 7.849598330566741, 4.03373539372637, 4.903857930780172, 8.719795031363788, 8.302326801801525, 5.471413088116824, 3.5931210592015344, 5.975007851190665, 2.6908798271412633, 7.551235157334393, 9.294503576801345, 9.370569236727244, 6.588253701607202], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6134611547483484, "mean_inference_ms": 7.239633498901273, "mean_action_processing_ms": 0.5912679521451242, "mean_env_wait_ms": 26.335235205038426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024604082107543945, "StateBufferConnector_ms": 0.023551225662231445, "ViewRequirementAgentConnector_ms": 0.7167398929595947}}, "episode_reward_max": 9.83902390456975, "episode_reward_min": 0.172383156654481, "episode_reward_mean": 6.151642520421787, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.031738273594407, 3.3846464988072187, 8.467923564932333, 2.359118068258604, 6.2571455719887945, 7.432237297354226, 6.53703746590876, 5.442127668793366, 7.787609215018729, 0.172383156654481, 7.149608191858095, 6.114905033017736, 8.623139849969998, 7.488689321171734, 4.457991616788028, 8.314806597683965, 6.090892418471067, 6.5883688713594015, 4.0475897996495735, 6.536413786642056, 6.295055435575683, 6.583083340303729, 6.000840976653165, 7.695895787688047, 5.380610832843903, 7.091170544778946, 4.287062275024336, 7.8252842374743725, 6.673450487586664, 9.429428683185991, 5.883468599048778, 4.916774225948476, 6.400980024623894, 6.6500867394461824, 5.466460402235529, 6.667491316662975, 7.827185439153695, 4.5122123584513325, 1.571731988088558, 3.42404017041952, 4.49244621329341, 4.545136346506834, 3.77259643413208, 8.714771721281249, 4.916305074298134, 7.6921541363078125, 3.4972861645733855, 5.023908252537204, 7.965903330323421, 4.953427728511535, 6.5580123647088, 5.663998630132595, 7.763842541649078, 5.375992917019083, 7.715018698200282, 6.498228448885903, 4.9778822012556265, 4.703621996584068, 3.9067521319497143, 8.835465860885888, 4.046856146185741, 9.071874908522762, 6.5876574939966215, 7.169594043134028, 2.944861036261643, 7.189430305734002, 7.609271328702018, 5.923214564267473, 4.356759196376317, 5.506611973218712, 7.533549468745727, 6.747298131611856, 7.014602190860056, 5.315750877124534, 5.942038208968803, 6.312973636746529, 8.083984267600965, 4.49273108540897, 4.938810046051434, 6.068004237353178, 9.83902390456975, 8.082181832815865, 7.266707573104436, 7.265775137706546, 3.4723136147901696, 8.96711038420972, 7.6315321355993495, 7.849598330566741, 4.03373539372637, 4.903857930780172, 8.719795031363788, 8.302326801801525, 5.471413088116824, 3.5931210592015344, 5.975007851190665, 2.6908798271412633, 7.551235157334393, 9.294503576801345, 9.370569236727244, 6.588253701607202], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6134611547483484, "mean_inference_ms": 7.239633498901273, "mean_action_processing_ms": 0.5912679521451242, "mean_env_wait_ms": 26.335235205038426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024604082107543945, "StateBufferConnector_ms": 0.023551225662231445, "ViewRequirementAgentConnector_ms": 0.7167398929595947}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3181668, "num_agent_steps_trained": 3181668, "num_env_steps_sampled": 3181668, "num_env_steps_trained": 3181668, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 229.90736651856741, "num_env_steps_trained_throughput_per_sec": 229.90736651856741, "timesteps_total": 3181668, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3181668, "timers": {"training_iteration_time_ms": 62414.885, "sample_time_ms": 47559.047, "load_time_ms": 738.778, "load_throughput": 21167.397, "learn_time_ms": 13714.332, "learn_throughput": 1140.267, "synch_weights_time_ms": 377.202}, "counters": {"num_env_steps_sampled": 3181668, "num_env_steps_trained": 3181668, "num_agent_steps_sampled": 3181668, "num_agent_steps_trained": 3181668}, "done": false, "episodes_total": 1064, "training_iteration": 208, "trial_id": "c5092_00000", "date": "2025-06-08_10-50-47", "timestamp": 1749372647, "time_this_iter_s": 68.06972861289978, "time_total_s": 4191.986273765564, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4191.986273765564, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 82.59342105263158, "ram_util_percent": 52.025, "gpu_util_percent0": 0.07407894736842105, "vram_util_percent0": 0.18863932291666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.818332e-05, "total_loss": -0.12919988434677096, "policy_loss": -0.0373733929280107, "vf_loss": 0.013363930605436591, "vf_explained_var": 0.7612310128862207, "kl": 0.02802638417477795, "entropy": 21.14723049510609, "entropy_coeff": 0.0046366639999999995}, "model": {}, "num_grad_updates_lifetime": 42075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3197306, "num_env_steps_trained": 3197306, "num_agent_steps_sampled": 3197306, "num_agent_steps_trained": 3197306}, "sampler_results": {"episode_reward_max": 9.83902390456975, "episode_reward_min": -0.6324059675850165, "episode_reward_mean": 6.1229554841164004, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.457991616788028, 8.314806597683965, 6.090892418471067, 6.5883688713594015, 4.0475897996495735, 6.536413786642056, 6.295055435575683, 6.583083340303729, 6.000840976653165, 7.695895787688047, 5.380610832843903, 7.091170544778946, 4.287062275024336, 7.8252842374743725, 6.673450487586664, 9.429428683185991, 5.883468599048778, 4.916774225948476, 6.400980024623894, 6.6500867394461824, 5.466460402235529, 6.667491316662975, 7.827185439153695, 4.5122123584513325, 1.571731988088558, 3.42404017041952, 4.49244621329341, 4.545136346506834, 3.77259643413208, 8.714771721281249, 4.916305074298134, 7.6921541363078125, 3.4972861645733855, 5.023908252537204, 7.965903330323421, 4.953427728511535, 6.5580123647088, 5.663998630132595, 7.763842541649078, 5.375992917019083, 7.715018698200282, 6.498228448885903, 4.9778822012556265, 4.703621996584068, 3.9067521319497143, 8.835465860885888, 4.046856146185741, 9.071874908522762, 6.5876574939966215, 7.169594043134028, 2.944861036261643, 7.189430305734002, 7.609271328702018, 5.923214564267473, 4.356759196376317, 5.506611973218712, 7.533549468745727, 6.747298131611856, 7.014602190860056, 5.315750877124534, 5.942038208968803, 6.312973636746529, 8.083984267600965, 4.49273108540897, 4.938810046051434, 6.068004237353178, 9.83902390456975, 8.082181832815865, 7.266707573104436, 7.265775137706546, 3.4723136147901696, 8.96711038420972, 7.6315321355993495, 7.849598330566741, 4.03373539372637, 4.903857930780172, 8.719795031363788, 8.302326801801525, 5.471413088116824, 3.5931210592015344, 5.975007851190665, 2.6908798271412633, 7.551235157334393, 9.294503576801345, 9.370569236727244, 6.588253701607202, -0.6324059675850165, 5.930675529517143, 4.731556413719103, 6.2147257168987045, 4.877710712549211, 5.571316572453224, 5.37761733027617, 4.452229714883069, 7.047368126175572, 5.515179775300753, 8.705462594321522, 6.814214859108464, 9.27476338088106, 4.499190788290853], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6163436905079533, "mean_inference_ms": 7.264370805867253, "mean_action_processing_ms": 0.5937167493560355, "mean_env_wait_ms": 26.414715426889305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024589061737060547, "StateBufferConnector_ms": 0.026540517807006836, "ViewRequirementAgentConnector_ms": 0.7228438854217529}}, "episode_reward_max": 9.83902390456975, "episode_reward_min": -0.6324059675850165, "episode_reward_mean": 6.1229554841164004, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.457991616788028, 8.314806597683965, 6.090892418471067, 6.5883688713594015, 4.0475897996495735, 6.536413786642056, 6.295055435575683, 6.583083340303729, 6.000840976653165, 7.695895787688047, 5.380610832843903, 7.091170544778946, 4.287062275024336, 7.8252842374743725, 6.673450487586664, 9.429428683185991, 5.883468599048778, 4.916774225948476, 6.400980024623894, 6.6500867394461824, 5.466460402235529, 6.667491316662975, 7.827185439153695, 4.5122123584513325, 1.571731988088558, 3.42404017041952, 4.49244621329341, 4.545136346506834, 3.77259643413208, 8.714771721281249, 4.916305074298134, 7.6921541363078125, 3.4972861645733855, 5.023908252537204, 7.965903330323421, 4.953427728511535, 6.5580123647088, 5.663998630132595, 7.763842541649078, 5.375992917019083, 7.715018698200282, 6.498228448885903, 4.9778822012556265, 4.703621996584068, 3.9067521319497143, 8.835465860885888, 4.046856146185741, 9.071874908522762, 6.5876574939966215, 7.169594043134028, 2.944861036261643, 7.189430305734002, 7.609271328702018, 5.923214564267473, 4.356759196376317, 5.506611973218712, 7.533549468745727, 6.747298131611856, 7.014602190860056, 5.315750877124534, 5.942038208968803, 6.312973636746529, 8.083984267600965, 4.49273108540897, 4.938810046051434, 6.068004237353178, 9.83902390456975, 8.082181832815865, 7.266707573104436, 7.265775137706546, 3.4723136147901696, 8.96711038420972, 7.6315321355993495, 7.849598330566741, 4.03373539372637, 4.903857930780172, 8.719795031363788, 8.302326801801525, 5.471413088116824, 3.5931210592015344, 5.975007851190665, 2.6908798271412633, 7.551235157334393, 9.294503576801345, 9.370569236727244, 6.588253701607202, -0.6324059675850165, 5.930675529517143, 4.731556413719103, 6.2147257168987045, 4.877710712549211, 5.571316572453224, 5.37761733027617, 4.452229714883069, 7.047368126175572, 5.515179775300753, 8.705462594321522, 6.814214859108464, 9.27476338088106, 4.499190788290853], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6163436905079533, "mean_inference_ms": 7.264370805867253, "mean_action_processing_ms": 0.5937167493560355, "mean_env_wait_ms": 26.414715426889305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024589061737060547, "StateBufferConnector_ms": 0.026540517807006836, "ViewRequirementAgentConnector_ms": 0.7228438854217529}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3197306, "num_agent_steps_trained": 3197306, "num_env_steps_sampled": 3197306, "num_env_steps_trained": 3197306, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 235.09990727553358, "num_env_steps_trained_throughput_per_sec": 235.09990727553358, "timesteps_total": 3197306, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3197306, "timers": {"training_iteration_time_ms": 63234.029, "sample_time_ms": 48393.874, "load_time_ms": 746.518, "load_throughput": 20947.926, "learn_time_ms": 13697.895, "learn_throughput": 1141.635, "synch_weights_time_ms": 370.414}, "counters": {"num_env_steps_sampled": 3197306, "num_env_steps_trained": 3197306, "num_agent_steps_sampled": 3197306, "num_agent_steps_trained": 3197306}, "done": false, "episodes_total": 1078, "training_iteration": 209, "trial_id": "c5092_00000", "date": "2025-06-08_10-51-54", "timestamp": 1749372714, "time_this_iter_s": 66.53039741516113, "time_total_s": 4258.516671180725, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4258.516671180725, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 83.1337837837838, "ram_util_percent": 52.31486486486487, "gpu_util_percent0": 0.06810810810810809, "vram_util_percent0": 0.18863932291666669}}
{"evaluation": {"sampler_results": {"episode_reward_max": -2.0306106991904933, "episode_reward_min": -5.841235388358478, "episode_reward_mean": -3.4885079399034082, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0306106991904933, -5.841235388358478, -2.8183908803179643, -2.4825060174733093, -4.269796714176795], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2569194064375044, "mean_inference_ms": 3.67302323347335, "mean_action_processing_ms": 0.27787646489977225, "mean_env_wait_ms": 11.550695214674855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.040030479431152344, "ViewRequirementAgentConnector_ms": 0.18068313598632812}}, "episode_reward_max": -2.0306106991904933, "episode_reward_min": -5.841235388358478, "episode_reward_mean": -3.4885079399034082, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0306106991904933, -5.841235388358478, -2.8183908803179643, -2.4825060174733093, -4.269796714176795], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2569194064375044, "mean_inference_ms": 3.67302323347335, "mean_action_processing_ms": 0.27787646489977225, "mean_env_wait_ms": 11.550695214674855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.040030479431152344, "ViewRequirementAgentConnector_ms": 0.18068313598632812}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.802694000000003e-05, "total_loss": -0.12403182514879683, "policy_loss": -0.032287327835005354, "vf_loss": 0.012440808492458679, "vf_explained_var": 0.7431279737299139, "kl": 0.025429133170455313, "entropy": 21.168298698772084, "entropy_coeff": 0.004605388000000001}, "model": {}, "num_grad_updates_lifetime": 42625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3212944, "num_env_steps_trained": 3212944, "num_agent_steps_sampled": 3212944, "num_agent_steps_trained": 3212944}, "sampler_results": {"episode_reward_max": 9.83902390456975, "episode_reward_min": -0.6324059675850165, "episode_reward_mean": 6.1090636139477805, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.673450487586664, 9.429428683185991, 5.883468599048778, 4.916774225948476, 6.400980024623894, 6.6500867394461824, 5.466460402235529, 6.667491316662975, 7.827185439153695, 4.5122123584513325, 1.571731988088558, 3.42404017041952, 4.49244621329341, 4.545136346506834, 3.77259643413208, 8.714771721281249, 4.916305074298134, 7.6921541363078125, 3.4972861645733855, 5.023908252537204, 7.965903330323421, 4.953427728511535, 6.5580123647088, 5.663998630132595, 7.763842541649078, 5.375992917019083, 7.715018698200282, 6.498228448885903, 4.9778822012556265, 4.703621996584068, 3.9067521319497143, 8.835465860885888, 4.046856146185741, 9.071874908522762, 6.5876574939966215, 7.169594043134028, 2.944861036261643, 7.189430305734002, 7.609271328702018, 5.923214564267473, 4.356759196376317, 5.506611973218712, 7.533549468745727, 6.747298131611856, 7.014602190860056, 5.315750877124534, 5.942038208968803, 6.312973636746529, 8.083984267600965, 4.49273108540897, 4.938810046051434, 6.068004237353178, 9.83902390456975, 8.082181832815865, 7.266707573104436, 7.265775137706546, 3.4723136147901696, 8.96711038420972, 7.6315321355993495, 7.849598330566741, 4.03373539372637, 4.903857930780172, 8.719795031363788, 8.302326801801525, 5.471413088116824, 3.5931210592015344, 5.975007851190665, 2.6908798271412633, 7.551235157334393, 9.294503576801345, 9.370569236727244, 6.588253701607202, -0.6324059675850165, 5.930675529517143, 4.731556413719103, 6.2147257168987045, 4.877710712549211, 5.571316572453224, 5.37761733027617, 4.452229714883069, 7.047368126175572, 5.515179775300753, 8.705462594321522, 6.814214859108464, 9.27476338088106, 4.499190788290853, 3.151882694097102, 8.790147140078078, 4.74126514725546, 7.185808900558087, 6.1331910612082865, 6.8150511428941885, 3.159061172999553, 6.890971740932423, 5.312270788594364, 6.132734845685297, 3.0667786323508657, 8.655002146326222, 6.378050035958296, 9.393664055136078], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6187847420178558, "mean_inference_ms": 7.286100496862158, "mean_action_processing_ms": 0.5958734650003135, "mean_env_wait_ms": 26.491047194255433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02418804168701172, "StateBufferConnector_ms": 0.027378082275390625, "ViewRequirementAgentConnector_ms": 0.7124812602996826}}, "episode_reward_max": 9.83902390456975, "episode_reward_min": -0.6324059675850165, "episode_reward_mean": 6.1090636139477805, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.673450487586664, 9.429428683185991, 5.883468599048778, 4.916774225948476, 6.400980024623894, 6.6500867394461824, 5.466460402235529, 6.667491316662975, 7.827185439153695, 4.5122123584513325, 1.571731988088558, 3.42404017041952, 4.49244621329341, 4.545136346506834, 3.77259643413208, 8.714771721281249, 4.916305074298134, 7.6921541363078125, 3.4972861645733855, 5.023908252537204, 7.965903330323421, 4.953427728511535, 6.5580123647088, 5.663998630132595, 7.763842541649078, 5.375992917019083, 7.715018698200282, 6.498228448885903, 4.9778822012556265, 4.703621996584068, 3.9067521319497143, 8.835465860885888, 4.046856146185741, 9.071874908522762, 6.5876574939966215, 7.169594043134028, 2.944861036261643, 7.189430305734002, 7.609271328702018, 5.923214564267473, 4.356759196376317, 5.506611973218712, 7.533549468745727, 6.747298131611856, 7.014602190860056, 5.315750877124534, 5.942038208968803, 6.312973636746529, 8.083984267600965, 4.49273108540897, 4.938810046051434, 6.068004237353178, 9.83902390456975, 8.082181832815865, 7.266707573104436, 7.265775137706546, 3.4723136147901696, 8.96711038420972, 7.6315321355993495, 7.849598330566741, 4.03373539372637, 4.903857930780172, 8.719795031363788, 8.302326801801525, 5.471413088116824, 3.5931210592015344, 5.975007851190665, 2.6908798271412633, 7.551235157334393, 9.294503576801345, 9.370569236727244, 6.588253701607202, -0.6324059675850165, 5.930675529517143, 4.731556413719103, 6.2147257168987045, 4.877710712549211, 5.571316572453224, 5.37761733027617, 4.452229714883069, 7.047368126175572, 5.515179775300753, 8.705462594321522, 6.814214859108464, 9.27476338088106, 4.499190788290853, 3.151882694097102, 8.790147140078078, 4.74126514725546, 7.185808900558087, 6.1331910612082865, 6.8150511428941885, 3.159061172999553, 6.890971740932423, 5.312270788594364, 6.132734845685297, 3.0667786323508657, 8.655002146326222, 6.378050035958296, 9.393664055136078], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6187847420178558, "mean_inference_ms": 7.286100496862158, "mean_action_processing_ms": 0.5958734650003135, "mean_env_wait_ms": 26.491047194255433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02418804168701172, "StateBufferConnector_ms": 0.027378082275390625, "ViewRequirementAgentConnector_ms": 0.7124812602996826}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3212944, "num_agent_steps_trained": 3212944, "num_env_steps_sampled": 3212944, "num_env_steps_trained": 3212944, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 257.7045588065949, "num_env_steps_trained_throughput_per_sec": 257.7045588065949, "timesteps_total": 3212944, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3212944, "timers": {"training_iteration_time_ms": 63325.415, "sample_time_ms": 48595.483, "load_time_ms": 737.389, "load_throughput": 21207.256, "learn_time_ms": 13597.412, "learn_throughput": 1150.072, "synch_weights_time_ms": 369.552}, "counters": {"num_env_steps_sampled": 3212944, "num_env_steps_trained": 3212944, "num_agent_steps_sampled": 3212944, "num_agent_steps_trained": 3212944}, "done": false, "episodes_total": 1092, "training_iteration": 210, "trial_id": "c5092_00000", "date": "2025-06-08_10-53-10", "timestamp": 1749372790, "time_this_iter_s": 76.75817108154297, "time_total_s": 4335.274842262268, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4335.274842262268, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 67.60449438202247, "ram_util_percent": 52.20112359550562, "gpu_util_percent0": 0.06078651685393258, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.787055999999998e-05, "total_loss": -0.12866643567590721, "policy_loss": -0.03740680133733391, "vf_loss": 0.012825481760823591, "vf_explained_var": 0.7446353323893113, "kl": 0.02519594029245623, "entropy": 21.228233233365145, "entropy_coeff": 0.004574112}, "model": {}, "num_grad_updates_lifetime": 43175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3228582, "num_env_steps_trained": 3228582, "num_agent_steps_sampled": 3228582, "num_agent_steps_trained": 3228582}, "sampler_results": {"episode_reward_max": 9.83902390456975, "episode_reward_min": -0.6324059675850165, "episode_reward_mean": 6.1022926695282855, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.77259643413208, 8.714771721281249, 4.916305074298134, 7.6921541363078125, 3.4972861645733855, 5.023908252537204, 7.965903330323421, 4.953427728511535, 6.5580123647088, 5.663998630132595, 7.763842541649078, 5.375992917019083, 7.715018698200282, 6.498228448885903, 4.9778822012556265, 4.703621996584068, 3.9067521319497143, 8.835465860885888, 4.046856146185741, 9.071874908522762, 6.5876574939966215, 7.169594043134028, 2.944861036261643, 7.189430305734002, 7.609271328702018, 5.923214564267473, 4.356759196376317, 5.506611973218712, 7.533549468745727, 6.747298131611856, 7.014602190860056, 5.315750877124534, 5.942038208968803, 6.312973636746529, 8.083984267600965, 4.49273108540897, 4.938810046051434, 6.068004237353178, 9.83902390456975, 8.082181832815865, 7.266707573104436, 7.265775137706546, 3.4723136147901696, 8.96711038420972, 7.6315321355993495, 7.849598330566741, 4.03373539372637, 4.903857930780172, 8.719795031363788, 8.302326801801525, 5.471413088116824, 3.5931210592015344, 5.975007851190665, 2.6908798271412633, 7.551235157334393, 9.294503576801345, 9.370569236727244, 6.588253701607202, -0.6324059675850165, 5.930675529517143, 4.731556413719103, 6.2147257168987045, 4.877710712549211, 5.571316572453224, 5.37761733027617, 4.452229714883069, 7.047368126175572, 5.515179775300753, 8.705462594321522, 6.814214859108464, 9.27476338088106, 4.499190788290853, 3.151882694097102, 8.790147140078078, 4.74126514725546, 7.185808900558087, 6.1331910612082865, 6.8150511428941885, 3.159061172999553, 6.890971740932423, 5.312270788594364, 6.132734845685297, 3.0667786323508657, 8.655002146326222, 6.378050035958296, 9.393664055136078, 0.2900840511572276, 4.775607282614329, 5.472723909607266, 0.9690042380674534, 7.320288663331478, 8.238960548386201, 4.508238567081902, 9.789218185526517, 8.808405428782615, 9.117215736604036, 4.658717337355421, 2.6257986812644, 5.887067098551778, 5.322468824371498], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6207135479938364, "mean_inference_ms": 7.304067229507098, "mean_action_processing_ms": 0.5976602691370673, "mean_env_wait_ms": 26.557653508357983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022180795669555664, "StateBufferConnector_ms": 0.02385878562927246, "ViewRequirementAgentConnector_ms": 0.6957828998565674}}, "episode_reward_max": 9.83902390456975, "episode_reward_min": -0.6324059675850165, "episode_reward_mean": 6.1022926695282855, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.77259643413208, 8.714771721281249, 4.916305074298134, 7.6921541363078125, 3.4972861645733855, 5.023908252537204, 7.965903330323421, 4.953427728511535, 6.5580123647088, 5.663998630132595, 7.763842541649078, 5.375992917019083, 7.715018698200282, 6.498228448885903, 4.9778822012556265, 4.703621996584068, 3.9067521319497143, 8.835465860885888, 4.046856146185741, 9.071874908522762, 6.5876574939966215, 7.169594043134028, 2.944861036261643, 7.189430305734002, 7.609271328702018, 5.923214564267473, 4.356759196376317, 5.506611973218712, 7.533549468745727, 6.747298131611856, 7.014602190860056, 5.315750877124534, 5.942038208968803, 6.312973636746529, 8.083984267600965, 4.49273108540897, 4.938810046051434, 6.068004237353178, 9.83902390456975, 8.082181832815865, 7.266707573104436, 7.265775137706546, 3.4723136147901696, 8.96711038420972, 7.6315321355993495, 7.849598330566741, 4.03373539372637, 4.903857930780172, 8.719795031363788, 8.302326801801525, 5.471413088116824, 3.5931210592015344, 5.975007851190665, 2.6908798271412633, 7.551235157334393, 9.294503576801345, 9.370569236727244, 6.588253701607202, -0.6324059675850165, 5.930675529517143, 4.731556413719103, 6.2147257168987045, 4.877710712549211, 5.571316572453224, 5.37761733027617, 4.452229714883069, 7.047368126175572, 5.515179775300753, 8.705462594321522, 6.814214859108464, 9.27476338088106, 4.499190788290853, 3.151882694097102, 8.790147140078078, 4.74126514725546, 7.185808900558087, 6.1331910612082865, 6.8150511428941885, 3.159061172999553, 6.890971740932423, 5.312270788594364, 6.132734845685297, 3.0667786323508657, 8.655002146326222, 6.378050035958296, 9.393664055136078, 0.2900840511572276, 4.775607282614329, 5.472723909607266, 0.9690042380674534, 7.320288663331478, 8.238960548386201, 4.508238567081902, 9.789218185526517, 8.808405428782615, 9.117215736604036, 4.658717337355421, 2.6257986812644, 5.887067098551778, 5.322468824371498], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6207135479938364, "mean_inference_ms": 7.304067229507098, "mean_action_processing_ms": 0.5976602691370673, "mean_env_wait_ms": 26.557653508357983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022180795669555664, "StateBufferConnector_ms": 0.02385878562927246, "ViewRequirementAgentConnector_ms": 0.6957828998565674}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3228582, "num_agent_steps_trained": 3228582, "num_env_steps_sampled": 3228582, "num_env_steps_trained": 3228582, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 274.7128093145517, "num_env_steps_trained_throughput_per_sec": 274.7128093145517, "timesteps_total": 3228582, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3228582, "timers": {"training_iteration_time_ms": 62931.953, "sample_time_ms": 48550.395, "load_time_ms": 728.387, "load_throughput": 21469.37, "learn_time_ms": 13245.213, "learn_throughput": 1180.653, "synch_weights_time_ms": 382.548}, "counters": {"num_env_steps_sampled": 3228582, "num_env_steps_trained": 3228582, "num_agent_steps_sampled": 3228582, "num_agent_steps_trained": 3228582}, "done": false, "episodes_total": 1106, "training_iteration": 211, "trial_id": "c5092_00000", "date": "2025-06-08_10-54-07", "timestamp": 1749372847, "time_this_iter_s": 56.93831658363342, "time_total_s": 4392.2131588459015, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4392.2131588459015, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 79.75538461538461, "ram_util_percent": 52.26615384615384, "gpu_util_percent0": 0.07430769230769231, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.771418000000001e-05, "total_loss": -0.11068192483476279, "policy_loss": -0.02094125962033021, "vf_loss": 0.013948687582954087, "vf_explained_var": 0.7722182700850747, "kl": 0.026253336249556104, "entropy": 21.132603326277298, "entropy_coeff": 0.0045428360000000015}, "model": {}, "num_grad_updates_lifetime": 43725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3244220, "num_env_steps_trained": 3244220, "num_agent_steps_sampled": 3244220, "num_agent_steps_trained": 3244220}, "sampler_results": {"episode_reward_max": 10.316093146042675, "episode_reward_min": -0.6324059675850165, "episode_reward_mean": 6.093318252488526, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.9778822012556265, 4.703621996584068, 3.9067521319497143, 8.835465860885888, 4.046856146185741, 9.071874908522762, 6.5876574939966215, 7.169594043134028, 2.944861036261643, 7.189430305734002, 7.609271328702018, 5.923214564267473, 4.356759196376317, 5.506611973218712, 7.533549468745727, 6.747298131611856, 7.014602190860056, 5.315750877124534, 5.942038208968803, 6.312973636746529, 8.083984267600965, 4.49273108540897, 4.938810046051434, 6.068004237353178, 9.83902390456975, 8.082181832815865, 7.266707573104436, 7.265775137706546, 3.4723136147901696, 8.96711038420972, 7.6315321355993495, 7.849598330566741, 4.03373539372637, 4.903857930780172, 8.719795031363788, 8.302326801801525, 5.471413088116824, 3.5931210592015344, 5.975007851190665, 2.6908798271412633, 7.551235157334393, 9.294503576801345, 9.370569236727244, 6.588253701607202, -0.6324059675850165, 5.930675529517143, 4.731556413719103, 6.2147257168987045, 4.877710712549211, 5.571316572453224, 5.37761733027617, 4.452229714883069, 7.047368126175572, 5.515179775300753, 8.705462594321522, 6.814214859108464, 9.27476338088106, 4.499190788290853, 3.151882694097102, 8.790147140078078, 4.74126514725546, 7.185808900558087, 6.1331910612082865, 6.8150511428941885, 3.159061172999553, 6.890971740932423, 5.312270788594364, 6.132734845685297, 3.0667786323508657, 8.655002146326222, 6.378050035958296, 9.393664055136078, 0.2900840511572276, 4.775607282614329, 5.472723909607266, 0.9690042380674534, 7.320288663331478, 8.238960548386201, 4.508238567081902, 9.789218185526517, 8.808405428782615, 9.117215736604036, 4.658717337355421, 2.6257986812644, 5.887067098551778, 5.322468824371498, 5.372737385867829, 7.749196686570715, 8.2845924352768, 10.316093146042675, 7.982262639640306, 5.496084908994124, 5.762031777503208, 6.8937835471127675, 4.602690303869543, 2.445001189393687, 7.149669158776584, 2.717536873834352, 6.531582384635204, 3.910742301067103], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6225305600457258, "mean_inference_ms": 7.319680126037224, "mean_action_processing_ms": 0.5991936007109042, "mean_env_wait_ms": 26.61965341466093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02420496940612793, "StateBufferConnector_ms": 0.025897502899169922, "ViewRequirementAgentConnector_ms": 0.7008438110351562}}, "episode_reward_max": 10.316093146042675, "episode_reward_min": -0.6324059675850165, "episode_reward_mean": 6.093318252488526, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.9778822012556265, 4.703621996584068, 3.9067521319497143, 8.835465860885888, 4.046856146185741, 9.071874908522762, 6.5876574939966215, 7.169594043134028, 2.944861036261643, 7.189430305734002, 7.609271328702018, 5.923214564267473, 4.356759196376317, 5.506611973218712, 7.533549468745727, 6.747298131611856, 7.014602190860056, 5.315750877124534, 5.942038208968803, 6.312973636746529, 8.083984267600965, 4.49273108540897, 4.938810046051434, 6.068004237353178, 9.83902390456975, 8.082181832815865, 7.266707573104436, 7.265775137706546, 3.4723136147901696, 8.96711038420972, 7.6315321355993495, 7.849598330566741, 4.03373539372637, 4.903857930780172, 8.719795031363788, 8.302326801801525, 5.471413088116824, 3.5931210592015344, 5.975007851190665, 2.6908798271412633, 7.551235157334393, 9.294503576801345, 9.370569236727244, 6.588253701607202, -0.6324059675850165, 5.930675529517143, 4.731556413719103, 6.2147257168987045, 4.877710712549211, 5.571316572453224, 5.37761733027617, 4.452229714883069, 7.047368126175572, 5.515179775300753, 8.705462594321522, 6.814214859108464, 9.27476338088106, 4.499190788290853, 3.151882694097102, 8.790147140078078, 4.74126514725546, 7.185808900558087, 6.1331910612082865, 6.8150511428941885, 3.159061172999553, 6.890971740932423, 5.312270788594364, 6.132734845685297, 3.0667786323508657, 8.655002146326222, 6.378050035958296, 9.393664055136078, 0.2900840511572276, 4.775607282614329, 5.472723909607266, 0.9690042380674534, 7.320288663331478, 8.238960548386201, 4.508238567081902, 9.789218185526517, 8.808405428782615, 9.117215736604036, 4.658717337355421, 2.6257986812644, 5.887067098551778, 5.322468824371498, 5.372737385867829, 7.749196686570715, 8.2845924352768, 10.316093146042675, 7.982262639640306, 5.496084908994124, 5.762031777503208, 6.8937835471127675, 4.602690303869543, 2.445001189393687, 7.149669158776584, 2.717536873834352, 6.531582384635204, 3.910742301067103], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6225305600457258, "mean_inference_ms": 7.319680126037224, "mean_action_processing_ms": 0.5991936007109042, "mean_env_wait_ms": 26.61965341466093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02420496940612793, "StateBufferConnector_ms": 0.025897502899169922, "ViewRequirementAgentConnector_ms": 0.7008438110351562}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3244220, "num_agent_steps_trained": 3244220, "num_env_steps_sampled": 3244220, "num_env_steps_trained": 3244220, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 270.6469970363711, "num_env_steps_trained_throughput_per_sec": 270.6469970363711, "timesteps_total": 3244220, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3244220, "timers": {"training_iteration_time_ms": 62792.218, "sample_time_ms": 48572.073, "load_time_ms": 719.464, "load_throughput": 21735.617, "learn_time_ms": 13098.116, "learn_throughput": 1193.912, "synch_weights_time_ms": 377.648}, "counters": {"num_env_steps_sampled": 3244220, "num_env_steps_trained": 3244220, "num_agent_steps_sampled": 3244220, "num_agent_steps_trained": 3244220}, "done": false, "episodes_total": 1120, "training_iteration": 212, "trial_id": "c5092_00000", "date": "2025-06-08_10-55-05", "timestamp": 1749372905, "time_this_iter_s": 57.79257822036743, "time_total_s": 4450.005737066269, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4450.005737066269, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 79.81060606060605, "ram_util_percent": 52.231818181818184, "gpu_util_percent0": 0.07636363636363637, "vram_util_percent0": 0.18863932291666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.75578e-05, "total_loss": -0.12245606897187165, "policy_loss": -0.03326812876367264, "vf_loss": 0.01337421981448477, "vf_explained_var": 0.7682833629304713, "kl": 0.027525010923249136, "entropy": 21.140687807256526, "entropy_coeff": 0.00451156}, "model": {}, "num_grad_updates_lifetime": 44275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3259858, "num_env_steps_trained": 3259858, "num_agent_steps_sampled": 3259858, "num_agent_steps_trained": 3259858}, "sampler_results": {"episode_reward_max": 10.316093146042675, "episode_reward_min": -0.6324059675850165, "episode_reward_mean": 6.14871363552157, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.533549468745727, 6.747298131611856, 7.014602190860056, 5.315750877124534, 5.942038208968803, 6.312973636746529, 8.083984267600965, 4.49273108540897, 4.938810046051434, 6.068004237353178, 9.83902390456975, 8.082181832815865, 7.266707573104436, 7.265775137706546, 3.4723136147901696, 8.96711038420972, 7.6315321355993495, 7.849598330566741, 4.03373539372637, 4.903857930780172, 8.719795031363788, 8.302326801801525, 5.471413088116824, 3.5931210592015344, 5.975007851190665, 2.6908798271412633, 7.551235157334393, 9.294503576801345, 9.370569236727244, 6.588253701607202, -0.6324059675850165, 5.930675529517143, 4.731556413719103, 6.2147257168987045, 4.877710712549211, 5.571316572453224, 5.37761733027617, 4.452229714883069, 7.047368126175572, 5.515179775300753, 8.705462594321522, 6.814214859108464, 9.27476338088106, 4.499190788290853, 3.151882694097102, 8.790147140078078, 4.74126514725546, 7.185808900558087, 6.1331910612082865, 6.8150511428941885, 3.159061172999553, 6.890971740932423, 5.312270788594364, 6.132734845685297, 3.0667786323508657, 8.655002146326222, 6.378050035958296, 9.393664055136078, 0.2900840511572276, 4.775607282614329, 5.472723909607266, 0.9690042380674534, 7.320288663331478, 8.238960548386201, 4.508238567081902, 9.789218185526517, 8.808405428782615, 9.117215736604036, 4.658717337355421, 2.6257986812644, 5.887067098551778, 5.322468824371498, 5.372737385867829, 7.749196686570715, 8.2845924352768, 10.316093146042675, 7.982262639640306, 5.496084908994124, 5.762031777503208, 6.8937835471127675, 4.602690303869543, 2.445001189393687, 7.149669158776584, 2.717536873834352, 6.531582384635204, 3.910742301067103, 6.9123078769346, 3.929183721776769, 4.654079030328785, 4.636655383695438, 4.282655474923615, 8.901974542820813, 6.533831010232737, 4.233785471071355, 4.210457312926787, 9.139249001901614, 6.676496493484971, 9.529798699094654, 8.613488851157527, 6.115428620029431], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6242543937243212, "mean_inference_ms": 7.3339526711804535, "mean_action_processing_ms": 0.6005657253423314, "mean_env_wait_ms": 26.681527578664628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030220746994018555, "StateBufferConnector_ms": 0.026888608932495117, "ViewRequirementAgentConnector_ms": 0.718379020690918}}, "episode_reward_max": 10.316093146042675, "episode_reward_min": -0.6324059675850165, "episode_reward_mean": 6.14871363552157, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.533549468745727, 6.747298131611856, 7.014602190860056, 5.315750877124534, 5.942038208968803, 6.312973636746529, 8.083984267600965, 4.49273108540897, 4.938810046051434, 6.068004237353178, 9.83902390456975, 8.082181832815865, 7.266707573104436, 7.265775137706546, 3.4723136147901696, 8.96711038420972, 7.6315321355993495, 7.849598330566741, 4.03373539372637, 4.903857930780172, 8.719795031363788, 8.302326801801525, 5.471413088116824, 3.5931210592015344, 5.975007851190665, 2.6908798271412633, 7.551235157334393, 9.294503576801345, 9.370569236727244, 6.588253701607202, -0.6324059675850165, 5.930675529517143, 4.731556413719103, 6.2147257168987045, 4.877710712549211, 5.571316572453224, 5.37761733027617, 4.452229714883069, 7.047368126175572, 5.515179775300753, 8.705462594321522, 6.814214859108464, 9.27476338088106, 4.499190788290853, 3.151882694097102, 8.790147140078078, 4.74126514725546, 7.185808900558087, 6.1331910612082865, 6.8150511428941885, 3.159061172999553, 6.890971740932423, 5.312270788594364, 6.132734845685297, 3.0667786323508657, 8.655002146326222, 6.378050035958296, 9.393664055136078, 0.2900840511572276, 4.775607282614329, 5.472723909607266, 0.9690042380674534, 7.320288663331478, 8.238960548386201, 4.508238567081902, 9.789218185526517, 8.808405428782615, 9.117215736604036, 4.658717337355421, 2.6257986812644, 5.887067098551778, 5.322468824371498, 5.372737385867829, 7.749196686570715, 8.2845924352768, 10.316093146042675, 7.982262639640306, 5.496084908994124, 5.762031777503208, 6.8937835471127675, 4.602690303869543, 2.445001189393687, 7.149669158776584, 2.717536873834352, 6.531582384635204, 3.910742301067103, 6.9123078769346, 3.929183721776769, 4.654079030328785, 4.636655383695438, 4.282655474923615, 8.901974542820813, 6.533831010232737, 4.233785471071355, 4.210457312926787, 9.139249001901614, 6.676496493484971, 9.529798699094654, 8.613488851157527, 6.115428620029431], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6242543937243212, "mean_inference_ms": 7.3339526711804535, "mean_action_processing_ms": 0.6005657253423314, "mean_env_wait_ms": 26.681527578664628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030220746994018555, "StateBufferConnector_ms": 0.026888608932495117, "ViewRequirementAgentConnector_ms": 0.718379020690918}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3259858, "num_agent_steps_trained": 3259858, "num_env_steps_sampled": 3259858, "num_env_steps_trained": 3259858, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 262.6686065516129, "num_env_steps_trained_throughput_per_sec": 262.6686065516129, "timesteps_total": 3259858, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3259858, "timers": {"training_iteration_time_ms": 62181.176, "sample_time_ms": 48097.284, "load_time_ms": 717.945, "load_throughput": 21781.609, "learn_time_ms": 12967.773, "learn_throughput": 1205.913, "synch_weights_time_ms": 373.579}, "counters": {"num_env_steps_sampled": 3259858, "num_env_steps_trained": 3259858, "num_agent_steps_sampled": 3259858, "num_agent_steps_trained": 3259858}, "done": false, "episodes_total": 1134, "training_iteration": 213, "trial_id": "c5092_00000", "date": "2025-06-08_10-56-05", "timestamp": 1749372965, "time_this_iter_s": 59.54609251022339, "time_total_s": 4509.551829576492, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4509.551829576492, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 81.02089552238806, "ram_util_percent": 52.20447761194029, "gpu_util_percent0": 0.07850746268656716, "vram_util_percent0": 0.18863932291666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.740141999999999e-05, "total_loss": -0.11525658615917729, "policy_loss": -0.02649959391055745, "vf_loss": 0.013502536091360855, "vf_explained_var": 0.7269280286268754, "kl": 0.02600150906809089, "entropy": 21.1737715252963, "entropy_coeff": 0.004480284}, "model": {}, "num_grad_updates_lifetime": 44825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3275496, "num_env_steps_trained": 3275496, "num_agent_steps_sampled": 3275496, "num_agent_steps_trained": 3275496}, "sampler_results": {"episode_reward_max": 10.316093146042675, "episode_reward_min": -0.6324059675850165, "episode_reward_mean": 5.979683441415497, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.4723136147901696, 8.96711038420972, 7.6315321355993495, 7.849598330566741, 4.03373539372637, 4.903857930780172, 8.719795031363788, 8.302326801801525, 5.471413088116824, 3.5931210592015344, 5.975007851190665, 2.6908798271412633, 7.551235157334393, 9.294503576801345, 9.370569236727244, 6.588253701607202, -0.6324059675850165, 5.930675529517143, 4.731556413719103, 6.2147257168987045, 4.877710712549211, 5.571316572453224, 5.37761733027617, 4.452229714883069, 7.047368126175572, 5.515179775300753, 8.705462594321522, 6.814214859108464, 9.27476338088106, 4.499190788290853, 3.151882694097102, 8.790147140078078, 4.74126514725546, 7.185808900558087, 6.1331910612082865, 6.8150511428941885, 3.159061172999553, 6.890971740932423, 5.312270788594364, 6.132734845685297, 3.0667786323508657, 8.655002146326222, 6.378050035958296, 9.393664055136078, 0.2900840511572276, 4.775607282614329, 5.472723909607266, 0.9690042380674534, 7.320288663331478, 8.238960548386201, 4.508238567081902, 9.789218185526517, 8.808405428782615, 9.117215736604036, 4.658717337355421, 2.6257986812644, 5.887067098551778, 5.322468824371498, 5.372737385867829, 7.749196686570715, 8.2845924352768, 10.316093146042675, 7.982262639640306, 5.496084908994124, 5.762031777503208, 6.8937835471127675, 4.602690303869543, 2.445001189393687, 7.149669158776584, 2.717536873834352, 6.531582384635204, 3.910742301067103, 6.9123078769346, 3.929183721776769, 4.654079030328785, 4.636655383695438, 4.282655474923615, 8.901974542820813, 6.533831010232737, 4.233785471071355, 4.210457312926787, 9.139249001901614, 6.676496493484971, 9.529798699094654, 8.613488851157527, 6.115428620029431, 6.060391863747036, 8.591150610684402, 0.2295059816667508, 5.395269137060551, 3.770361015960488, 7.284557189728, 1.326127040991789, 3.6228351231198728, 7.620801047736567, 6.688072578170032, 4.4224510244410755, 5.515860600845141, 7.454481429540805, 10.018546544368531], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6260778754495124, "mean_inference_ms": 7.346666265976949, "mean_action_processing_ms": 0.6017603733917715, "mean_env_wait_ms": 26.742723745534967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027671337127685547, "StateBufferConnector_ms": 0.02889561653137207, "ViewRequirementAgentConnector_ms": 0.7150130271911621}}, "episode_reward_max": 10.316093146042675, "episode_reward_min": -0.6324059675850165, "episode_reward_mean": 5.979683441415497, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.4723136147901696, 8.96711038420972, 7.6315321355993495, 7.849598330566741, 4.03373539372637, 4.903857930780172, 8.719795031363788, 8.302326801801525, 5.471413088116824, 3.5931210592015344, 5.975007851190665, 2.6908798271412633, 7.551235157334393, 9.294503576801345, 9.370569236727244, 6.588253701607202, -0.6324059675850165, 5.930675529517143, 4.731556413719103, 6.2147257168987045, 4.877710712549211, 5.571316572453224, 5.37761733027617, 4.452229714883069, 7.047368126175572, 5.515179775300753, 8.705462594321522, 6.814214859108464, 9.27476338088106, 4.499190788290853, 3.151882694097102, 8.790147140078078, 4.74126514725546, 7.185808900558087, 6.1331910612082865, 6.8150511428941885, 3.159061172999553, 6.890971740932423, 5.312270788594364, 6.132734845685297, 3.0667786323508657, 8.655002146326222, 6.378050035958296, 9.393664055136078, 0.2900840511572276, 4.775607282614329, 5.472723909607266, 0.9690042380674534, 7.320288663331478, 8.238960548386201, 4.508238567081902, 9.789218185526517, 8.808405428782615, 9.117215736604036, 4.658717337355421, 2.6257986812644, 5.887067098551778, 5.322468824371498, 5.372737385867829, 7.749196686570715, 8.2845924352768, 10.316093146042675, 7.982262639640306, 5.496084908994124, 5.762031777503208, 6.8937835471127675, 4.602690303869543, 2.445001189393687, 7.149669158776584, 2.717536873834352, 6.531582384635204, 3.910742301067103, 6.9123078769346, 3.929183721776769, 4.654079030328785, 4.636655383695438, 4.282655474923615, 8.901974542820813, 6.533831010232737, 4.233785471071355, 4.210457312926787, 9.139249001901614, 6.676496493484971, 9.529798699094654, 8.613488851157527, 6.115428620029431, 6.060391863747036, 8.591150610684402, 0.2295059816667508, 5.395269137060551, 3.770361015960488, 7.284557189728, 1.326127040991789, 3.6228351231198728, 7.620801047736567, 6.688072578170032, 4.4224510244410755, 5.515860600845141, 7.454481429540805, 10.018546544368531], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6260778754495124, "mean_inference_ms": 7.346666265976949, "mean_action_processing_ms": 0.6017603733917715, "mean_env_wait_ms": 26.742723745534967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027671337127685547, "StateBufferConnector_ms": 0.02889561653137207, "ViewRequirementAgentConnector_ms": 0.7150130271911621}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3275496, "num_agent_steps_trained": 3275496, "num_env_steps_sampled": 3275496, "num_env_steps_trained": 3275496, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 253.1919325644773, "num_env_steps_trained_throughput_per_sec": 253.1919325644773, "timesteps_total": 3275496, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3275496, "timers": {"training_iteration_time_ms": 61651.455, "sample_time_ms": 47778.826, "load_time_ms": 716.768, "load_throughput": 21817.39, "learn_time_ms": 12771.259, "learn_throughput": 1224.468, "synch_weights_time_ms": 359.581}, "counters": {"num_env_steps_sampled": 3275496, "num_env_steps_trained": 3275496, "num_agent_steps_sampled": 3275496, "num_agent_steps_trained": 3275496}, "done": false, "episodes_total": 1148, "training_iteration": 214, "trial_id": "c5092_00000", "date": "2025-06-08_10-57-07", "timestamp": 1749373027, "time_this_iter_s": 61.77958941459656, "time_total_s": 4571.331418991089, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4571.331418991089, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 81.39710144927537, "ram_util_percent": 52.04057971014493, "gpu_util_percent0": 0.06869565217391303, "vram_util_percent0": 0.18863932291666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.724504000000001e-05, "total_loss": -0.11342276616418862, "policy_loss": -0.025528465580480934, "vf_loss": 0.012553820211270994, "vf_explained_var": 0.7296657224134966, "kl": 0.026046978933101688, "entropy": 21.06555055618286, "entropy_coeff": 0.004449007999999999}, "model": {}, "num_grad_updates_lifetime": 45375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3291134, "num_env_steps_trained": 3291134, "num_agent_steps_sampled": 3291134, "num_agent_steps_trained": 3291134}, "sampler_results": {"episode_reward_max": 11.059922657729041, "episode_reward_min": -0.6324059675850165, "episode_reward_mean": 5.9207559485254775, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.370569236727244, 6.588253701607202, -0.6324059675850165, 5.930675529517143, 4.731556413719103, 6.2147257168987045, 4.877710712549211, 5.571316572453224, 5.37761733027617, 4.452229714883069, 7.047368126175572, 5.515179775300753, 8.705462594321522, 6.814214859108464, 9.27476338088106, 4.499190788290853, 3.151882694097102, 8.790147140078078, 4.74126514725546, 7.185808900558087, 6.1331910612082865, 6.8150511428941885, 3.159061172999553, 6.890971740932423, 5.312270788594364, 6.132734845685297, 3.0667786323508657, 8.655002146326222, 6.378050035958296, 9.393664055136078, 0.2900840511572276, 4.775607282614329, 5.472723909607266, 0.9690042380674534, 7.320288663331478, 8.238960548386201, 4.508238567081902, 9.789218185526517, 8.808405428782615, 9.117215736604036, 4.658717337355421, 2.6257986812644, 5.887067098551778, 5.322468824371498, 5.372737385867829, 7.749196686570715, 8.2845924352768, 10.316093146042675, 7.982262639640306, 5.496084908994124, 5.762031777503208, 6.8937835471127675, 4.602690303869543, 2.445001189393687, 7.149669158776584, 2.717536873834352, 6.531582384635204, 3.910742301067103, 6.9123078769346, 3.929183721776769, 4.654079030328785, 4.636655383695438, 4.282655474923615, 8.901974542820813, 6.533831010232737, 4.233785471071355, 4.210457312926787, 9.139249001901614, 6.676496493484971, 9.529798699094654, 8.613488851157527, 6.115428620029431, 6.060391863747036, 8.591150610684402, 0.2295059816667508, 5.395269137060551, 3.770361015960488, 7.284557189728, 1.326127040991789, 3.6228351231198728, 7.620801047736567, 6.688072578170032, 4.4224510244410755, 5.515860600845141, 7.454481429540805, 10.018546544368531, 5.037480698796111, 5.340111905907153, 7.461531062475129, 6.972537376736861, 7.32912830752488, 4.7087506316396315, 11.059922657729041, 5.028526976584154, 3.554257159425628, 5.880568283173317, 4.929784501602144, 4.582345146985683, 5.317723507046434, 5.361012677995755], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6279202280490284, "mean_inference_ms": 7.358004978869582, "mean_action_processing_ms": 0.6028063288044745, "mean_env_wait_ms": 26.79995027921547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023635387420654297, "StateBufferConnector_ms": 0.03294110298156738, "ViewRequirementAgentConnector_ms": 0.7099065780639648}}, "episode_reward_max": 11.059922657729041, "episode_reward_min": -0.6324059675850165, "episode_reward_mean": 5.9207559485254775, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.370569236727244, 6.588253701607202, -0.6324059675850165, 5.930675529517143, 4.731556413719103, 6.2147257168987045, 4.877710712549211, 5.571316572453224, 5.37761733027617, 4.452229714883069, 7.047368126175572, 5.515179775300753, 8.705462594321522, 6.814214859108464, 9.27476338088106, 4.499190788290853, 3.151882694097102, 8.790147140078078, 4.74126514725546, 7.185808900558087, 6.1331910612082865, 6.8150511428941885, 3.159061172999553, 6.890971740932423, 5.312270788594364, 6.132734845685297, 3.0667786323508657, 8.655002146326222, 6.378050035958296, 9.393664055136078, 0.2900840511572276, 4.775607282614329, 5.472723909607266, 0.9690042380674534, 7.320288663331478, 8.238960548386201, 4.508238567081902, 9.789218185526517, 8.808405428782615, 9.117215736604036, 4.658717337355421, 2.6257986812644, 5.887067098551778, 5.322468824371498, 5.372737385867829, 7.749196686570715, 8.2845924352768, 10.316093146042675, 7.982262639640306, 5.496084908994124, 5.762031777503208, 6.8937835471127675, 4.602690303869543, 2.445001189393687, 7.149669158776584, 2.717536873834352, 6.531582384635204, 3.910742301067103, 6.9123078769346, 3.929183721776769, 4.654079030328785, 4.636655383695438, 4.282655474923615, 8.901974542820813, 6.533831010232737, 4.233785471071355, 4.210457312926787, 9.139249001901614, 6.676496493484971, 9.529798699094654, 8.613488851157527, 6.115428620029431, 6.060391863747036, 8.591150610684402, 0.2295059816667508, 5.395269137060551, 3.770361015960488, 7.284557189728, 1.326127040991789, 3.6228351231198728, 7.620801047736567, 6.688072578170032, 4.4224510244410755, 5.515860600845141, 7.454481429540805, 10.018546544368531, 5.037480698796111, 5.340111905907153, 7.461531062475129, 6.972537376736861, 7.32912830752488, 4.7087506316396315, 11.059922657729041, 5.028526976584154, 3.554257159425628, 5.880568283173317, 4.929784501602144, 4.582345146985683, 5.317723507046434, 5.361012677995755], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6279202280490284, "mean_inference_ms": 7.358004978869582, "mean_action_processing_ms": 0.6028063288044745, "mean_env_wait_ms": 26.79995027921547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023635387420654297, "StateBufferConnector_ms": 0.03294110298156738, "ViewRequirementAgentConnector_ms": 0.7099065780639648}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3291134, "num_agent_steps_trained": 3291134, "num_env_steps_sampled": 3291134, "num_env_steps_trained": 3291134, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 244.67419609811463, "num_env_steps_trained_throughput_per_sec": 244.67419609811463, "timesteps_total": 3291134, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3291134, "timers": {"training_iteration_time_ms": 61843.857, "sample_time_ms": 48026.294, "load_time_ms": 712.418, "load_throughput": 21950.593, "learn_time_ms": 12726.401, "learn_throughput": 1228.784, "synch_weights_time_ms": 354.704}, "counters": {"num_env_steps_sampled": 3291134, "num_env_steps_trained": 3291134, "num_agent_steps_sampled": 3291134, "num_agent_steps_trained": 3291134}, "done": false, "episodes_total": 1162, "training_iteration": 215, "trial_id": "c5092_00000", "date": "2025-06-08_10-58-11", "timestamp": 1749373091, "time_this_iter_s": 63.92462491989136, "time_total_s": 4635.25604391098, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4635.25604391098, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 81.75416666666666, "ram_util_percent": 51.54027777777779, "gpu_util_percent0": 0.06972222222222221, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.708866e-05, "total_loss": -0.12295725743487393, "policy_loss": -0.035400292186214675, "vf_loss": 0.012252143044871364, "vf_explained_var": 0.7567404844544151, "kl": 0.02550296387983362, "entropy": 21.108101439042525, "entropy_coeff": 0.004417731999999999}, "model": {}, "num_grad_updates_lifetime": 45925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3306772, "num_env_steps_trained": 3306772, "num_agent_steps_sampled": 3306772, "num_agent_steps_trained": 3306772}, "sampler_results": {"episode_reward_max": 11.059922657729041, "episode_reward_min": 0.2295059816667508, "episode_reward_mean": 6.096343261637371, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.27476338088106, 4.499190788290853, 3.151882694097102, 8.790147140078078, 4.74126514725546, 7.185808900558087, 6.1331910612082865, 6.8150511428941885, 3.159061172999553, 6.890971740932423, 5.312270788594364, 6.132734845685297, 3.0667786323508657, 8.655002146326222, 6.378050035958296, 9.393664055136078, 0.2900840511572276, 4.775607282614329, 5.472723909607266, 0.9690042380674534, 7.320288663331478, 8.238960548386201, 4.508238567081902, 9.789218185526517, 8.808405428782615, 9.117215736604036, 4.658717337355421, 2.6257986812644, 5.887067098551778, 5.322468824371498, 5.372737385867829, 7.749196686570715, 8.2845924352768, 10.316093146042675, 7.982262639640306, 5.496084908994124, 5.762031777503208, 6.8937835471127675, 4.602690303869543, 2.445001189393687, 7.149669158776584, 2.717536873834352, 6.531582384635204, 3.910742301067103, 6.9123078769346, 3.929183721776769, 4.654079030328785, 4.636655383695438, 4.282655474923615, 8.901974542820813, 6.533831010232737, 4.233785471071355, 4.210457312926787, 9.139249001901614, 6.676496493484971, 9.529798699094654, 8.613488851157527, 6.115428620029431, 6.060391863747036, 8.591150610684402, 0.2295059816667508, 5.395269137060551, 3.770361015960488, 7.284557189728, 1.326127040991789, 3.6228351231198728, 7.620801047736567, 6.688072578170032, 4.4224510244410755, 5.515860600845141, 7.454481429540805, 10.018546544368531, 5.037480698796111, 5.340111905907153, 7.461531062475129, 6.972537376736861, 7.32912830752488, 4.7087506316396315, 11.059922657729041, 5.028526976584154, 3.554257159425628, 5.880568283173317, 4.929784501602144, 4.582345146985683, 5.317723507046434, 5.361012677995755, 5.562303879202305, 8.348087489132977, 4.501254440512614, 7.452900148563127, 6.755801484731055, 8.353674256297952, 7.1233114716090915, 7.713419593842238, 6.829166333422806, 3.1413548296681912, 8.121246329928319, 5.744762428648144, 8.40909842828933, 10.066824513293625], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6298772096410632, "mean_inference_ms": 7.368525708537142, "mean_action_processing_ms": 0.6037537563086849, "mean_env_wait_ms": 26.85512544671765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021666765213012695, "StateBufferConnector_ms": 0.03163743019104004, "ViewRequirementAgentConnector_ms": 0.6629250049591064}}, "episode_reward_max": 11.059922657729041, "episode_reward_min": 0.2295059816667508, "episode_reward_mean": 6.096343261637371, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.27476338088106, 4.499190788290853, 3.151882694097102, 8.790147140078078, 4.74126514725546, 7.185808900558087, 6.1331910612082865, 6.8150511428941885, 3.159061172999553, 6.890971740932423, 5.312270788594364, 6.132734845685297, 3.0667786323508657, 8.655002146326222, 6.378050035958296, 9.393664055136078, 0.2900840511572276, 4.775607282614329, 5.472723909607266, 0.9690042380674534, 7.320288663331478, 8.238960548386201, 4.508238567081902, 9.789218185526517, 8.808405428782615, 9.117215736604036, 4.658717337355421, 2.6257986812644, 5.887067098551778, 5.322468824371498, 5.372737385867829, 7.749196686570715, 8.2845924352768, 10.316093146042675, 7.982262639640306, 5.496084908994124, 5.762031777503208, 6.8937835471127675, 4.602690303869543, 2.445001189393687, 7.149669158776584, 2.717536873834352, 6.531582384635204, 3.910742301067103, 6.9123078769346, 3.929183721776769, 4.654079030328785, 4.636655383695438, 4.282655474923615, 8.901974542820813, 6.533831010232737, 4.233785471071355, 4.210457312926787, 9.139249001901614, 6.676496493484971, 9.529798699094654, 8.613488851157527, 6.115428620029431, 6.060391863747036, 8.591150610684402, 0.2295059816667508, 5.395269137060551, 3.770361015960488, 7.284557189728, 1.326127040991789, 3.6228351231198728, 7.620801047736567, 6.688072578170032, 4.4224510244410755, 5.515860600845141, 7.454481429540805, 10.018546544368531, 5.037480698796111, 5.340111905907153, 7.461531062475129, 6.972537376736861, 7.32912830752488, 4.7087506316396315, 11.059922657729041, 5.028526976584154, 3.554257159425628, 5.880568283173317, 4.929784501602144, 4.582345146985683, 5.317723507046434, 5.361012677995755, 5.562303879202305, 8.348087489132977, 4.501254440512614, 7.452900148563127, 6.755801484731055, 8.353674256297952, 7.1233114716090915, 7.713419593842238, 6.829166333422806, 3.1413548296681912, 8.121246329928319, 5.744762428648144, 8.40909842828933, 10.066824513293625], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6298772096410632, "mean_inference_ms": 7.368525708537142, "mean_action_processing_ms": 0.6037537563086849, "mean_env_wait_ms": 26.85512544671765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021666765213012695, "StateBufferConnector_ms": 0.03163743019104004, "ViewRequirementAgentConnector_ms": 0.6629250049591064}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3306772, "num_agent_steps_trained": 3306772, "num_env_steps_sampled": 3306772, "num_env_steps_trained": 3306772, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 238.32173700453416, "num_env_steps_trained_throughput_per_sec": 238.32173700453416, "timesteps_total": 3306772, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3306772, "timers": {"training_iteration_time_ms": 62256.33, "sample_time_ms": 48592.32, "load_time_ms": 694.052, "load_throughput": 22531.447, "learn_time_ms": 12588.713, "learn_throughput": 1242.224, "synch_weights_time_ms": 356.907}, "counters": {"num_env_steps_sampled": 3306772, "num_env_steps_trained": 3306772, "num_agent_steps_sampled": 3306772, "num_agent_steps_trained": 3306772}, "done": false, "episodes_total": 1176, "training_iteration": 216, "trial_id": "c5092_00000", "date": "2025-06-08_10-59-16", "timestamp": 1749373156, "time_this_iter_s": 65.63073968887329, "time_total_s": 4700.8867835998535, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4700.8867835998535, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 81.95753424657535, "ram_util_percent": 51.57671232876712, "gpu_util_percent0": 0.0710958904109589, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.693228e-05, "total_loss": -0.10236673588293012, "policy_loss": -0.01584660572391427, "vf_loss": 0.012805981018834494, "vf_explained_var": 0.7495481916991147, "kl": 0.026605777988286256, "entropy": 21.079996641332453, "entropy_coeff": 0.004386456}, "model": {}, "num_grad_updates_lifetime": 46475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3322410, "num_env_steps_trained": 3322410, "num_agent_steps_sampled": 3322410, "num_agent_steps_trained": 3322410}, "sampler_results": {"episode_reward_max": 11.059922657729041, "episode_reward_min": 0.2295059816667508, "episode_reward_mean": 6.213137053945511, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.378050035958296, 9.393664055136078, 0.2900840511572276, 4.775607282614329, 5.472723909607266, 0.9690042380674534, 7.320288663331478, 8.238960548386201, 4.508238567081902, 9.789218185526517, 8.808405428782615, 9.117215736604036, 4.658717337355421, 2.6257986812644, 5.887067098551778, 5.322468824371498, 5.372737385867829, 7.749196686570715, 8.2845924352768, 10.316093146042675, 7.982262639640306, 5.496084908994124, 5.762031777503208, 6.8937835471127675, 4.602690303869543, 2.445001189393687, 7.149669158776584, 2.717536873834352, 6.531582384635204, 3.910742301067103, 6.9123078769346, 3.929183721776769, 4.654079030328785, 4.636655383695438, 4.282655474923615, 8.901974542820813, 6.533831010232737, 4.233785471071355, 4.210457312926787, 9.139249001901614, 6.676496493484971, 9.529798699094654, 8.613488851157527, 6.115428620029431, 6.060391863747036, 8.591150610684402, 0.2295059816667508, 5.395269137060551, 3.770361015960488, 7.284557189728, 1.326127040991789, 3.6228351231198728, 7.620801047736567, 6.688072578170032, 4.4224510244410755, 5.515860600845141, 7.454481429540805, 10.018546544368531, 5.037480698796111, 5.340111905907153, 7.461531062475129, 6.972537376736861, 7.32912830752488, 4.7087506316396315, 11.059922657729041, 5.028526976584154, 3.554257159425628, 5.880568283173317, 4.929784501602144, 4.582345146985683, 5.317723507046434, 5.361012677995755, 5.562303879202305, 8.348087489132977, 4.501254440512614, 7.452900148563127, 6.755801484731055, 8.353674256297952, 7.1233114716090915, 7.713419593842238, 6.829166333422806, 3.1413548296681912, 8.121246329928319, 5.744762428648144, 8.40909842828933, 10.066824513293625, 7.9933881940755676, 6.770969030054203, 9.618024426530564, 7.703602532554715, 4.950632415957131, 5.213860733411601, 8.356348590484686, 1.9059821738532658, 10.345562666017704, 9.294996557008863, 5.456243224293668, 6.120057008547327, 6.060646559092177, 5.697184701084413], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.632015446343863, "mean_inference_ms": 7.379748501213013, "mean_action_processing_ms": 0.6047505092006914, "mean_env_wait_ms": 26.914958657415013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023598432540893555, "StateBufferConnector_ms": 0.028804779052734375, "ViewRequirementAgentConnector_ms": 0.6599936485290527}}, "episode_reward_max": 11.059922657729041, "episode_reward_min": 0.2295059816667508, "episode_reward_mean": 6.213137053945511, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.378050035958296, 9.393664055136078, 0.2900840511572276, 4.775607282614329, 5.472723909607266, 0.9690042380674534, 7.320288663331478, 8.238960548386201, 4.508238567081902, 9.789218185526517, 8.808405428782615, 9.117215736604036, 4.658717337355421, 2.6257986812644, 5.887067098551778, 5.322468824371498, 5.372737385867829, 7.749196686570715, 8.2845924352768, 10.316093146042675, 7.982262639640306, 5.496084908994124, 5.762031777503208, 6.8937835471127675, 4.602690303869543, 2.445001189393687, 7.149669158776584, 2.717536873834352, 6.531582384635204, 3.910742301067103, 6.9123078769346, 3.929183721776769, 4.654079030328785, 4.636655383695438, 4.282655474923615, 8.901974542820813, 6.533831010232737, 4.233785471071355, 4.210457312926787, 9.139249001901614, 6.676496493484971, 9.529798699094654, 8.613488851157527, 6.115428620029431, 6.060391863747036, 8.591150610684402, 0.2295059816667508, 5.395269137060551, 3.770361015960488, 7.284557189728, 1.326127040991789, 3.6228351231198728, 7.620801047736567, 6.688072578170032, 4.4224510244410755, 5.515860600845141, 7.454481429540805, 10.018546544368531, 5.037480698796111, 5.340111905907153, 7.461531062475129, 6.972537376736861, 7.32912830752488, 4.7087506316396315, 11.059922657729041, 5.028526976584154, 3.554257159425628, 5.880568283173317, 4.929784501602144, 4.582345146985683, 5.317723507046434, 5.361012677995755, 5.562303879202305, 8.348087489132977, 4.501254440512614, 7.452900148563127, 6.755801484731055, 8.353674256297952, 7.1233114716090915, 7.713419593842238, 6.829166333422806, 3.1413548296681912, 8.121246329928319, 5.744762428648144, 8.40909842828933, 10.066824513293625, 7.9933881940755676, 6.770969030054203, 9.618024426530564, 7.703602532554715, 4.950632415957131, 5.213860733411601, 8.356348590484686, 1.9059821738532658, 10.345562666017704, 9.294996557008863, 5.456243224293668, 6.120057008547327, 6.060646559092177, 5.697184701084413], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.632015446343863, "mean_inference_ms": 7.379748501213013, "mean_action_processing_ms": 0.6047505092006914, "mean_env_wait_ms": 26.914958657415013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023598432540893555, "StateBufferConnector_ms": 0.028804779052734375, "ViewRequirementAgentConnector_ms": 0.6599936485290527}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3322410, "num_agent_steps_trained": 3322410, "num_env_steps_sampled": 3322410, "num_env_steps_trained": 3322410, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 231.57159923892885, "num_env_steps_trained_throughput_per_sec": 231.57159923892885, "timesteps_total": 3322410, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3322410, "timers": {"training_iteration_time_ms": 62828.008, "sample_time_ms": 49061.551, "load_time_ms": 697.286, "load_throughput": 22426.959, "learn_time_ms": 12682.195, "learn_throughput": 1233.067, "synch_weights_time_ms": 360.013}, "counters": {"num_env_steps_sampled": 3322410, "num_env_steps_trained": 3322410, "num_agent_steps_sampled": 3322410, "num_agent_steps_trained": 3322410}, "done": false, "episodes_total": 1190, "training_iteration": 217, "trial_id": "c5092_00000", "date": "2025-06-08_11-00-24", "timestamp": 1749373224, "time_this_iter_s": 67.53970265388489, "time_total_s": 4768.426486253738, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4768.426486253738, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 82.79866666666665, "ram_util_percent": 52.18666666666667, "gpu_util_percent0": 0.07200000000000002, "vram_util_percent0": 0.18863932291666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.677589999999999e-05, "total_loss": -0.12406947421756657, "policy_loss": -0.037283950680655174, "vf_loss": 0.011478110778314824, "vf_explained_var": 0.7609401441704143, "kl": 0.02523193041709477, "entropy": 21.175896146947686, "entropy_coeff": 0.004355180000000001}, "model": {}, "num_grad_updates_lifetime": 47025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3338048, "num_env_steps_trained": 3338048, "num_agent_steps_sampled": 3338048, "num_agent_steps_trained": 3338048}, "sampler_results": {"episode_reward_max": 11.059922657729041, "episode_reward_min": 0.2295059816667508, "episode_reward_mean": 6.1991337236707285, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.887067098551778, 5.322468824371498, 5.372737385867829, 7.749196686570715, 8.2845924352768, 10.316093146042675, 7.982262639640306, 5.496084908994124, 5.762031777503208, 6.8937835471127675, 4.602690303869543, 2.445001189393687, 7.149669158776584, 2.717536873834352, 6.531582384635204, 3.910742301067103, 6.9123078769346, 3.929183721776769, 4.654079030328785, 4.636655383695438, 4.282655474923615, 8.901974542820813, 6.533831010232737, 4.233785471071355, 4.210457312926787, 9.139249001901614, 6.676496493484971, 9.529798699094654, 8.613488851157527, 6.115428620029431, 6.060391863747036, 8.591150610684402, 0.2295059816667508, 5.395269137060551, 3.770361015960488, 7.284557189728, 1.326127040991789, 3.6228351231198728, 7.620801047736567, 6.688072578170032, 4.4224510244410755, 5.515860600845141, 7.454481429540805, 10.018546544368531, 5.037480698796111, 5.340111905907153, 7.461531062475129, 6.972537376736861, 7.32912830752488, 4.7087506316396315, 11.059922657729041, 5.028526976584154, 3.554257159425628, 5.880568283173317, 4.929784501602144, 4.582345146985683, 5.317723507046434, 5.361012677995755, 5.562303879202305, 8.348087489132977, 4.501254440512614, 7.452900148563127, 6.755801484731055, 8.353674256297952, 7.1233114716090915, 7.713419593842238, 6.829166333422806, 3.1413548296681912, 8.121246329928319, 5.744762428648144, 8.40909842828933, 10.066824513293625, 7.9933881940755676, 6.770969030054203, 9.618024426530564, 7.703602532554715, 4.950632415957131, 5.213860733411601, 8.356348590484686, 1.9059821738532658, 10.345562666017704, 9.294996557008863, 5.456243224293668, 6.120057008547327, 6.060646559092177, 5.697184701084413, 6.523413746972268, 8.509379120319299, 4.628809745584517, 0.4424194648598335, 7.400641839463932, 4.612549322480883, 5.159802899857641, 6.359236122568693, 5.725086212720067, 7.8713007983932695, 7.456828759783862, 4.155138956381736, 4.372351389709849, 7.728685314299159], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.634209164882755, "mean_inference_ms": 7.392186355525158, "mean_action_processing_ms": 0.605875458050752, "mean_env_wait_ms": 26.980977915394696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028081178665161133, "StateBufferConnector_ms": 0.02479696273803711, "ViewRequirementAgentConnector_ms": 0.6583292484283447}}, "episode_reward_max": 11.059922657729041, "episode_reward_min": 0.2295059816667508, "episode_reward_mean": 6.1991337236707285, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.887067098551778, 5.322468824371498, 5.372737385867829, 7.749196686570715, 8.2845924352768, 10.316093146042675, 7.982262639640306, 5.496084908994124, 5.762031777503208, 6.8937835471127675, 4.602690303869543, 2.445001189393687, 7.149669158776584, 2.717536873834352, 6.531582384635204, 3.910742301067103, 6.9123078769346, 3.929183721776769, 4.654079030328785, 4.636655383695438, 4.282655474923615, 8.901974542820813, 6.533831010232737, 4.233785471071355, 4.210457312926787, 9.139249001901614, 6.676496493484971, 9.529798699094654, 8.613488851157527, 6.115428620029431, 6.060391863747036, 8.591150610684402, 0.2295059816667508, 5.395269137060551, 3.770361015960488, 7.284557189728, 1.326127040991789, 3.6228351231198728, 7.620801047736567, 6.688072578170032, 4.4224510244410755, 5.515860600845141, 7.454481429540805, 10.018546544368531, 5.037480698796111, 5.340111905907153, 7.461531062475129, 6.972537376736861, 7.32912830752488, 4.7087506316396315, 11.059922657729041, 5.028526976584154, 3.554257159425628, 5.880568283173317, 4.929784501602144, 4.582345146985683, 5.317723507046434, 5.361012677995755, 5.562303879202305, 8.348087489132977, 4.501254440512614, 7.452900148563127, 6.755801484731055, 8.353674256297952, 7.1233114716090915, 7.713419593842238, 6.829166333422806, 3.1413548296681912, 8.121246329928319, 5.744762428648144, 8.40909842828933, 10.066824513293625, 7.9933881940755676, 6.770969030054203, 9.618024426530564, 7.703602532554715, 4.950632415957131, 5.213860733411601, 8.356348590484686, 1.9059821738532658, 10.345562666017704, 9.294996557008863, 5.456243224293668, 6.120057008547327, 6.060646559092177, 5.697184701084413, 6.523413746972268, 8.509379120319299, 4.628809745584517, 0.4424194648598335, 7.400641839463932, 4.612549322480883, 5.159802899857641, 6.359236122568693, 5.725086212720067, 7.8713007983932695, 7.456828759783862, 4.155138956381736, 4.372351389709849, 7.728685314299159], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.634209164882755, "mean_inference_ms": 7.392186355525158, "mean_action_processing_ms": 0.605875458050752, "mean_env_wait_ms": 26.980977915394696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028081178665161133, "StateBufferConnector_ms": 0.02479696273803711, "ViewRequirementAgentConnector_ms": 0.6583292484283447}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3338048, "num_agent_steps_trained": 3338048, "num_env_steps_sampled": 3338048, "num_env_steps_trained": 3338048, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 237.13168004962205, "num_env_steps_trained_throughput_per_sec": 237.13168004962205, "timesteps_total": 3338048, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3338048, "timers": {"training_iteration_time_ms": 62620.787, "sample_time_ms": 48880.119, "load_time_ms": 687.058, "load_throughput": 22760.826, "learn_time_ms": 12653.812, "learn_throughput": 1235.833, "synch_weights_time_ms": 372.128}, "counters": {"num_env_steps_sampled": 3338048, "num_env_steps_trained": 3338048, "num_agent_steps_sampled": 3338048, "num_agent_steps_trained": 3338048}, "done": false, "episodes_total": 1204, "training_iteration": 218, "trial_id": "c5092_00000", "date": "2025-06-08_11-01-30", "timestamp": 1749373290, "time_this_iter_s": 65.95440244674683, "time_total_s": 4834.380888700485, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4834.380888700485, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 79.05675675675676, "ram_util_percent": 52.836486486486486, "gpu_util_percent0": 0.07567567567567568, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.661952000000002e-05, "total_loss": -0.11325421283317899, "policy_loss": -0.027993634387967176, "vf_loss": 0.012514789084988561, "vf_explained_var": 0.7646903320876035, "kl": 0.026358140298345295, "entropy": 21.068920081745496, "entropy_coeff": 0.004323904}, "model": {}, "num_grad_updates_lifetime": 47575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3353686, "num_env_steps_trained": 3353686, "num_agent_steps_sampled": 3353686, "num_agent_steps_trained": 3353686}, "sampler_results": {"episode_reward_max": 11.059922657729041, "episode_reward_min": 0.2295059816667508, "episode_reward_mean": 6.2666578713724554, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.531582384635204, 3.910742301067103, 6.9123078769346, 3.929183721776769, 4.654079030328785, 4.636655383695438, 4.282655474923615, 8.901974542820813, 6.533831010232737, 4.233785471071355, 4.210457312926787, 9.139249001901614, 6.676496493484971, 9.529798699094654, 8.613488851157527, 6.115428620029431, 6.060391863747036, 8.591150610684402, 0.2295059816667508, 5.395269137060551, 3.770361015960488, 7.284557189728, 1.326127040991789, 3.6228351231198728, 7.620801047736567, 6.688072578170032, 4.4224510244410755, 5.515860600845141, 7.454481429540805, 10.018546544368531, 5.037480698796111, 5.340111905907153, 7.461531062475129, 6.972537376736861, 7.32912830752488, 4.7087506316396315, 11.059922657729041, 5.028526976584154, 3.554257159425628, 5.880568283173317, 4.929784501602144, 4.582345146985683, 5.317723507046434, 5.361012677995755, 5.562303879202305, 8.348087489132977, 4.501254440512614, 7.452900148563127, 6.755801484731055, 8.353674256297952, 7.1233114716090915, 7.713419593842238, 6.829166333422806, 3.1413548296681912, 8.121246329928319, 5.744762428648144, 8.40909842828933, 10.066824513293625, 7.9933881940755676, 6.770969030054203, 9.618024426530564, 7.703602532554715, 4.950632415957131, 5.213860733411601, 8.356348590484686, 1.9059821738532658, 10.345562666017704, 9.294996557008863, 5.456243224293668, 6.120057008547327, 6.060646559092177, 5.697184701084413, 6.523413746972268, 8.509379120319299, 4.628809745584517, 0.4424194648598335, 7.400641839463932, 4.612549322480883, 5.159802899857641, 6.359236122568693, 5.725086212720067, 7.8713007983932695, 7.456828759783862, 4.155138956381736, 4.372351389709849, 7.728685314299159, 10.873474234517948, 4.372384803198978, 5.364379053536868, 7.182184166623192, 9.527848461974527, 1.8091695170417506, 5.232929123565665, 8.994914442756402, 7.1362421380795205, 5.358743770019857, 6.547232829763641, 7.1016862914532295, 5.6461905867268545, 7.586251326719968], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6364273332209762, "mean_inference_ms": 7.404799211538723, "mean_action_processing_ms": 0.6070656911625189, "mean_env_wait_ms": 27.04897023195034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028044939041137695, "StateBufferConnector_ms": 0.023764610290527344, "ViewRequirementAgentConnector_ms": 0.6639328002929688}}, "episode_reward_max": 11.059922657729041, "episode_reward_min": 0.2295059816667508, "episode_reward_mean": 6.2666578713724554, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.531582384635204, 3.910742301067103, 6.9123078769346, 3.929183721776769, 4.654079030328785, 4.636655383695438, 4.282655474923615, 8.901974542820813, 6.533831010232737, 4.233785471071355, 4.210457312926787, 9.139249001901614, 6.676496493484971, 9.529798699094654, 8.613488851157527, 6.115428620029431, 6.060391863747036, 8.591150610684402, 0.2295059816667508, 5.395269137060551, 3.770361015960488, 7.284557189728, 1.326127040991789, 3.6228351231198728, 7.620801047736567, 6.688072578170032, 4.4224510244410755, 5.515860600845141, 7.454481429540805, 10.018546544368531, 5.037480698796111, 5.340111905907153, 7.461531062475129, 6.972537376736861, 7.32912830752488, 4.7087506316396315, 11.059922657729041, 5.028526976584154, 3.554257159425628, 5.880568283173317, 4.929784501602144, 4.582345146985683, 5.317723507046434, 5.361012677995755, 5.562303879202305, 8.348087489132977, 4.501254440512614, 7.452900148563127, 6.755801484731055, 8.353674256297952, 7.1233114716090915, 7.713419593842238, 6.829166333422806, 3.1413548296681912, 8.121246329928319, 5.744762428648144, 8.40909842828933, 10.066824513293625, 7.9933881940755676, 6.770969030054203, 9.618024426530564, 7.703602532554715, 4.950632415957131, 5.213860733411601, 8.356348590484686, 1.9059821738532658, 10.345562666017704, 9.294996557008863, 5.456243224293668, 6.120057008547327, 6.060646559092177, 5.697184701084413, 6.523413746972268, 8.509379120319299, 4.628809745584517, 0.4424194648598335, 7.400641839463932, 4.612549322480883, 5.159802899857641, 6.359236122568693, 5.725086212720067, 7.8713007983932695, 7.456828759783862, 4.155138956381736, 4.372351389709849, 7.728685314299159, 10.873474234517948, 4.372384803198978, 5.364379053536868, 7.182184166623192, 9.527848461974527, 1.8091695170417506, 5.232929123565665, 8.994914442756402, 7.1362421380795205, 5.358743770019857, 6.547232829763641, 7.1016862914532295, 5.6461905867268545, 7.586251326719968], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6364273332209762, "mean_inference_ms": 7.404799211538723, "mean_action_processing_ms": 0.6070656911625189, "mean_env_wait_ms": 27.04897023195034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028044939041137695, "StateBufferConnector_ms": 0.023764610290527344, "ViewRequirementAgentConnector_ms": 0.6639328002929688}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3353686, "num_agent_steps_trained": 3353686, "num_env_steps_sampled": 3353686, "num_env_steps_trained": 3353686, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 250.77561631159688, "num_env_steps_trained_throughput_per_sec": 250.77561631159688, "timesteps_total": 3353686, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3353686, "timers": {"training_iteration_time_ms": 62205.0, "sample_time_ms": 48391.674, "load_time_ms": 684.247, "load_throughput": 22854.309, "learn_time_ms": 12719.586, "learn_throughput": 1229.442, "synch_weights_time_ms": 381.821}, "counters": {"num_env_steps_sampled": 3353686, "num_env_steps_trained": 3353686, "num_agent_steps_sampled": 3353686, "num_agent_steps_trained": 3353686}, "done": false, "episodes_total": 1218, "training_iteration": 219, "trial_id": "c5092_00000", "date": "2025-06-08_11-02-32", "timestamp": 1749373352, "time_this_iter_s": 62.37352776527405, "time_total_s": 4896.754416465759, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4896.754416465759, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 79.1394366197183, "ram_util_percent": 52.74366197183098, "gpu_util_percent0": 0.07507042253521126, "vram_util_percent0": 0.18863932291666663}}
{"evaluation": {"sampler_results": {"episode_reward_max": -1.3617533261709656, "episode_reward_min": -7.564625534760449, "episode_reward_mean": -3.583586713450835, "episode_len_mean": 174.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.7607779198684272, -1.6789710115507526, -4.551805774903579, -1.3617533261709656, -7.564625534760449], "episode_lengths": [184, 184, 184, 184, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.288512047626629, "mean_inference_ms": 3.6996288174321217, "mean_action_processing_ms": 0.28711595076067437, "mean_env_wait_ms": 11.926280994127696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020003318786621094, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5361461639404297}}, "episode_reward_max": -1.3617533261709656, "episode_reward_min": -7.564625534760449, "episode_reward_mean": -3.583586713450835, "episode_len_mean": 174.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.7607779198684272, -1.6789710115507526, -4.551805774903579, -1.3617533261709656, -7.564625534760449], "episode_lengths": [184, 184, 184, 184, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.288512047626629, "mean_inference_ms": 3.6996288174321217, "mean_action_processing_ms": 0.28711595076067437, "mean_env_wait_ms": 11.926280994127696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020003318786621094, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5361461639404297}, "num_agent_steps_sampled_this_iter": 870, "num_env_steps_sampled_this_iter": 870, "timesteps_this_iter": 870, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.646314e-05, "total_loss": -0.12086991205980832, "policy_loss": -0.03619072256498674, "vf_loss": 0.013441429978067224, "vf_explained_var": 0.7511243419213729, "kl": 0.026379145472206374, "entropy": 21.15213725523515, "entropy_coeff": 0.004292628}, "model": {}, "num_grad_updates_lifetime": 48125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3369324, "num_env_steps_trained": 3369324, "num_agent_steps_sampled": 3369324, "num_agent_steps_trained": 3369324}, "sampler_results": {"episode_reward_max": 11.059922657729041, "episode_reward_min": -0.31132512165246795, "episode_reward_mean": 6.217147056450517, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.613488851157527, 6.115428620029431, 6.060391863747036, 8.591150610684402, 0.2295059816667508, 5.395269137060551, 3.770361015960488, 7.284557189728, 1.326127040991789, 3.6228351231198728, 7.620801047736567, 6.688072578170032, 4.4224510244410755, 5.515860600845141, 7.454481429540805, 10.018546544368531, 5.037480698796111, 5.340111905907153, 7.461531062475129, 6.972537376736861, 7.32912830752488, 4.7087506316396315, 11.059922657729041, 5.028526976584154, 3.554257159425628, 5.880568283173317, 4.929784501602144, 4.582345146985683, 5.317723507046434, 5.361012677995755, 5.562303879202305, 8.348087489132977, 4.501254440512614, 7.452900148563127, 6.755801484731055, 8.353674256297952, 7.1233114716090915, 7.713419593842238, 6.829166333422806, 3.1413548296681912, 8.121246329928319, 5.744762428648144, 8.40909842828933, 10.066824513293625, 7.9933881940755676, 6.770969030054203, 9.618024426530564, 7.703602532554715, 4.950632415957131, 5.213860733411601, 8.356348590484686, 1.9059821738532658, 10.345562666017704, 9.294996557008863, 5.456243224293668, 6.120057008547327, 6.060646559092177, 5.697184701084413, 6.523413746972268, 8.509379120319299, 4.628809745584517, 0.4424194648598335, 7.400641839463932, 4.612549322480883, 5.159802899857641, 6.359236122568693, 5.725086212720067, 7.8713007983932695, 7.456828759783862, 4.155138956381736, 4.372351389709849, 7.728685314299159, 10.873474234517948, 4.372384803198978, 5.364379053536868, 7.182184166623192, 9.527848461974527, 1.8091695170417506, 5.232929123565665, 8.994914442756402, 7.1362421380795205, 5.358743770019857, 6.547232829763641, 7.1016862914532295, 5.6461905867268545, 7.586251326719968, -0.31132512165246795, 9.0298536163417, 7.03763591524252, 4.523782176653259, 6.539558399709382, 3.563232130672744, 8.946398908524127, 4.608789107031532, 4.1738631468809055, 6.528926233891724, 9.162201032898578, 5.776227081512591, 1.9428109187246143, 7.609763666269522], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6388649369847557, "mean_inference_ms": 7.417113667382022, "mean_action_processing_ms": 0.6083061235797342, "mean_env_wait_ms": 27.118355457463544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027033090591430664, "StateBufferConnector_ms": 0.02474498748779297, "ViewRequirementAgentConnector_ms": 0.6653609275817871}}, "episode_reward_max": 11.059922657729041, "episode_reward_min": -0.31132512165246795, "episode_reward_mean": 6.217147056450517, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.613488851157527, 6.115428620029431, 6.060391863747036, 8.591150610684402, 0.2295059816667508, 5.395269137060551, 3.770361015960488, 7.284557189728, 1.326127040991789, 3.6228351231198728, 7.620801047736567, 6.688072578170032, 4.4224510244410755, 5.515860600845141, 7.454481429540805, 10.018546544368531, 5.037480698796111, 5.340111905907153, 7.461531062475129, 6.972537376736861, 7.32912830752488, 4.7087506316396315, 11.059922657729041, 5.028526976584154, 3.554257159425628, 5.880568283173317, 4.929784501602144, 4.582345146985683, 5.317723507046434, 5.361012677995755, 5.562303879202305, 8.348087489132977, 4.501254440512614, 7.452900148563127, 6.755801484731055, 8.353674256297952, 7.1233114716090915, 7.713419593842238, 6.829166333422806, 3.1413548296681912, 8.121246329928319, 5.744762428648144, 8.40909842828933, 10.066824513293625, 7.9933881940755676, 6.770969030054203, 9.618024426530564, 7.703602532554715, 4.950632415957131, 5.213860733411601, 8.356348590484686, 1.9059821738532658, 10.345562666017704, 9.294996557008863, 5.456243224293668, 6.120057008547327, 6.060646559092177, 5.697184701084413, 6.523413746972268, 8.509379120319299, 4.628809745584517, 0.4424194648598335, 7.400641839463932, 4.612549322480883, 5.159802899857641, 6.359236122568693, 5.725086212720067, 7.8713007983932695, 7.456828759783862, 4.155138956381736, 4.372351389709849, 7.728685314299159, 10.873474234517948, 4.372384803198978, 5.364379053536868, 7.182184166623192, 9.527848461974527, 1.8091695170417506, 5.232929123565665, 8.994914442756402, 7.1362421380795205, 5.358743770019857, 6.547232829763641, 7.1016862914532295, 5.6461905867268545, 7.586251326719968, -0.31132512165246795, 9.0298536163417, 7.03763591524252, 4.523782176653259, 6.539558399709382, 3.563232130672744, 8.946398908524127, 4.608789107031532, 4.1738631468809055, 6.528926233891724, 9.162201032898578, 5.776227081512591, 1.9428109187246143, 7.609763666269522], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6388649369847557, "mean_inference_ms": 7.417113667382022, "mean_action_processing_ms": 0.6083061235797342, "mean_env_wait_ms": 27.118355457463544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027033090591430664, "StateBufferConnector_ms": 0.02474498748779297, "ViewRequirementAgentConnector_ms": 0.6653609275817871}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3369324, "num_agent_steps_trained": 3369324, "num_env_steps_sampled": 3369324, "num_env_steps_trained": 3369324, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 245.74606059372613, "num_env_steps_trained_throughput_per_sec": 245.74606059372613, "timesteps_total": 3369324, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3369324, "timers": {"training_iteration_time_ms": 62500.29, "sample_time_ms": 48444.896, "load_time_ms": 685.835, "load_throughput": 22801.401, "learn_time_ms": 12956.118, "learn_throughput": 1206.997, "synch_weights_time_ms": 386.07}, "counters": {"num_env_steps_sampled": 3369324, "num_env_steps_trained": 3369324, "num_agent_steps_sampled": 3369324, "num_agent_steps_trained": 3369324}, "done": false, "episodes_total": 1232, "training_iteration": 220, "trial_id": "c5092_00000", "date": "2025-06-08_11-03-54", "timestamp": 1749373434, "time_this_iter_s": 81.9375593662262, "time_total_s": 4978.6919758319855, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4978.6919758319855, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 67.29468085106383, "ram_util_percent": 52.80957446808511, "gpu_util_percent0": 0.058617021276595745, "vram_util_percent0": 0.18863932291666677}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.630676000000002e-05, "total_loss": -0.11613448352256621, "policy_loss": -0.03223628813832131, "vf_loss": 0.012041951977139847, "vf_explained_var": 0.7707372916828502, "kl": 0.02630177321119143, "entropy": 21.02414696259932, "entropy_coeff": 0.004261352000000001}, "model": {}, "num_grad_updates_lifetime": 48675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3384962, "num_env_steps_trained": 3384962, "num_agent_steps_sampled": 3384962, "num_agent_steps_trained": 3384962}, "sampler_results": {"episode_reward_max": 11.059922657729041, "episode_reward_min": -0.31132512165246795, "episode_reward_mean": 6.37037396273861, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.454481429540805, 10.018546544368531, 5.037480698796111, 5.340111905907153, 7.461531062475129, 6.972537376736861, 7.32912830752488, 4.7087506316396315, 11.059922657729041, 5.028526976584154, 3.554257159425628, 5.880568283173317, 4.929784501602144, 4.582345146985683, 5.317723507046434, 5.361012677995755, 5.562303879202305, 8.348087489132977, 4.501254440512614, 7.452900148563127, 6.755801484731055, 8.353674256297952, 7.1233114716090915, 7.713419593842238, 6.829166333422806, 3.1413548296681912, 8.121246329928319, 5.744762428648144, 8.40909842828933, 10.066824513293625, 7.9933881940755676, 6.770969030054203, 9.618024426530564, 7.703602532554715, 4.950632415957131, 5.213860733411601, 8.356348590484686, 1.9059821738532658, 10.345562666017704, 9.294996557008863, 5.456243224293668, 6.120057008547327, 6.060646559092177, 5.697184701084413, 6.523413746972268, 8.509379120319299, 4.628809745584517, 0.4424194648598335, 7.400641839463932, 4.612549322480883, 5.159802899857641, 6.359236122568693, 5.725086212720067, 7.8713007983932695, 7.456828759783862, 4.155138956381736, 4.372351389709849, 7.728685314299159, 10.873474234517948, 4.372384803198978, 5.364379053536868, 7.182184166623192, 9.527848461974527, 1.8091695170417506, 5.232929123565665, 8.994914442756402, 7.1362421380795205, 5.358743770019857, 6.547232829763641, 7.1016862914532295, 5.6461905867268545, 7.586251326719968, -0.31132512165246795, 9.0298536163417, 7.03763591524252, 4.523782176653259, 6.539558399709382, 3.563232130672744, 8.946398908524127, 4.608789107031532, 4.1738631468809055, 6.528926233891724, 9.162201032898578, 5.776227081512591, 1.9428109187246143, 7.609763666269522, 6.429623184277901, 5.547362130873994, 7.548520074886431, 6.4271471352673535, 6.41791185381454, 7.985997479008638, 4.930700108065039, 4.510586496958702, 8.8505237200848, 5.613479392967256, 5.700358835756116, 6.547002590059684, 7.335116063249339, 6.734662248878144], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6412860097358957, "mean_inference_ms": 7.429058458171557, "mean_action_processing_ms": 0.6095671444803806, "mean_env_wait_ms": 27.186597605348478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03001689910888672, "StateBufferConnector_ms": 0.027234792709350586, "ViewRequirementAgentConnector_ms": 0.6688058376312256}}, "episode_reward_max": 11.059922657729041, "episode_reward_min": -0.31132512165246795, "episode_reward_mean": 6.37037396273861, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.454481429540805, 10.018546544368531, 5.037480698796111, 5.340111905907153, 7.461531062475129, 6.972537376736861, 7.32912830752488, 4.7087506316396315, 11.059922657729041, 5.028526976584154, 3.554257159425628, 5.880568283173317, 4.929784501602144, 4.582345146985683, 5.317723507046434, 5.361012677995755, 5.562303879202305, 8.348087489132977, 4.501254440512614, 7.452900148563127, 6.755801484731055, 8.353674256297952, 7.1233114716090915, 7.713419593842238, 6.829166333422806, 3.1413548296681912, 8.121246329928319, 5.744762428648144, 8.40909842828933, 10.066824513293625, 7.9933881940755676, 6.770969030054203, 9.618024426530564, 7.703602532554715, 4.950632415957131, 5.213860733411601, 8.356348590484686, 1.9059821738532658, 10.345562666017704, 9.294996557008863, 5.456243224293668, 6.120057008547327, 6.060646559092177, 5.697184701084413, 6.523413746972268, 8.509379120319299, 4.628809745584517, 0.4424194648598335, 7.400641839463932, 4.612549322480883, 5.159802899857641, 6.359236122568693, 5.725086212720067, 7.8713007983932695, 7.456828759783862, 4.155138956381736, 4.372351389709849, 7.728685314299159, 10.873474234517948, 4.372384803198978, 5.364379053536868, 7.182184166623192, 9.527848461974527, 1.8091695170417506, 5.232929123565665, 8.994914442756402, 7.1362421380795205, 5.358743770019857, 6.547232829763641, 7.1016862914532295, 5.6461905867268545, 7.586251326719968, -0.31132512165246795, 9.0298536163417, 7.03763591524252, 4.523782176653259, 6.539558399709382, 3.563232130672744, 8.946398908524127, 4.608789107031532, 4.1738631468809055, 6.528926233891724, 9.162201032898578, 5.776227081512591, 1.9428109187246143, 7.609763666269522, 6.429623184277901, 5.547362130873994, 7.548520074886431, 6.4271471352673535, 6.41791185381454, 7.985997479008638, 4.930700108065039, 4.510586496958702, 8.8505237200848, 5.613479392967256, 5.700358835756116, 6.547002590059684, 7.335116063249339, 6.734662248878144], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6412860097358957, "mean_inference_ms": 7.429058458171557, "mean_action_processing_ms": 0.6095671444803806, "mean_env_wait_ms": 27.186597605348478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03001689910888672, "StateBufferConnector_ms": 0.027234792709350586, "ViewRequirementAgentConnector_ms": 0.6688058376312256}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3384962, "num_agent_steps_trained": 3384962, "num_env_steps_sampled": 3384962, "num_env_steps_trained": 3384962, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 246.4161852216153, "num_env_steps_trained_throughput_per_sec": 246.4161852216153, "timesteps_total": 3384962, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3384962, "timers": {"training_iteration_time_ms": 63153.874, "sample_time_ms": 48861.132, "load_time_ms": 710.972, "load_throughput": 21995.232, "learn_time_ms": 13169.199, "learn_throughput": 1187.468, "synch_weights_time_ms": 384.632}, "counters": {"num_env_steps_sampled": 3384962, "num_env_steps_trained": 3384962, "num_agent_steps_sampled": 3384962, "num_agent_steps_trained": 3384962}, "done": false, "episodes_total": 1246, "training_iteration": 221, "trial_id": "c5092_00000", "date": "2025-06-08_11-04-58", "timestamp": 1749373498, "time_this_iter_s": 63.479748487472534, "time_total_s": 5042.171724319458, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5042.171724319458, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 79.5625, "ram_util_percent": 51.390277777777776, "gpu_util_percent0": 0.07152777777777779, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.615038000000002e-05, "total_loss": -0.13255573243003296, "policy_loss": -0.04901030275436245, "vf_loss": 0.011363158082081513, "vf_explained_var": 0.7720228458534587, "kl": 0.024474676271653444, "entropy": 21.01389222751964, "entropy_coeff": 0.004230076}, "model": {}, "num_grad_updates_lifetime": 49225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3400600, "num_env_steps_trained": 3400600, "num_agent_steps_sampled": 3400600, "num_agent_steps_trained": 3400600}, "sampler_results": {"episode_reward_max": 10.873474234517948, "episode_reward_min": -0.31132512165246795, "episode_reward_mean": 6.360051610829969, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.317723507046434, 5.361012677995755, 5.562303879202305, 8.348087489132977, 4.501254440512614, 7.452900148563127, 6.755801484731055, 8.353674256297952, 7.1233114716090915, 7.713419593842238, 6.829166333422806, 3.1413548296681912, 8.121246329928319, 5.744762428648144, 8.40909842828933, 10.066824513293625, 7.9933881940755676, 6.770969030054203, 9.618024426530564, 7.703602532554715, 4.950632415957131, 5.213860733411601, 8.356348590484686, 1.9059821738532658, 10.345562666017704, 9.294996557008863, 5.456243224293668, 6.120057008547327, 6.060646559092177, 5.697184701084413, 6.523413746972268, 8.509379120319299, 4.628809745584517, 0.4424194648598335, 7.400641839463932, 4.612549322480883, 5.159802899857641, 6.359236122568693, 5.725086212720067, 7.8713007983932695, 7.456828759783862, 4.155138956381736, 4.372351389709849, 7.728685314299159, 10.873474234517948, 4.372384803198978, 5.364379053536868, 7.182184166623192, 9.527848461974527, 1.8091695170417506, 5.232929123565665, 8.994914442756402, 7.1362421380795205, 5.358743770019857, 6.547232829763641, 7.1016862914532295, 5.6461905867268545, 7.586251326719968, -0.31132512165246795, 9.0298536163417, 7.03763591524252, 4.523782176653259, 6.539558399709382, 3.563232130672744, 8.946398908524127, 4.608789107031532, 4.1738631468809055, 6.528926233891724, 9.162201032898578, 5.776227081512591, 1.9428109187246143, 7.609763666269522, 6.429623184277901, 5.547362130873994, 7.548520074886431, 6.4271471352673535, 6.41791185381454, 7.985997479008638, 4.930700108065039, 4.510586496958702, 8.8505237200848, 5.613479392967256, 5.700358835756116, 6.547002590059684, 7.335116063249339, 6.734662248878144, 6.690851900439172, 2.434659661061662, 3.1396851852567425, 9.039320935425081, 6.592381471919565, 3.6394769441544277, 8.700995674739163, 6.740411179284152, 6.827904937488274, 7.381801768672062, 5.818293608504147, 8.574962793158177, 6.98031294576039, 5.764678485761946], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6435839982142355, "mean_inference_ms": 7.439451030617735, "mean_action_processing_ms": 0.6107809029980633, "mean_env_wait_ms": 27.251318586470312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030028820037841797, "StateBufferConnector_ms": 0.028222084045410156, "ViewRequirementAgentConnector_ms": 0.6802752017974854}}, "episode_reward_max": 10.873474234517948, "episode_reward_min": -0.31132512165246795, "episode_reward_mean": 6.360051610829969, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.317723507046434, 5.361012677995755, 5.562303879202305, 8.348087489132977, 4.501254440512614, 7.452900148563127, 6.755801484731055, 8.353674256297952, 7.1233114716090915, 7.713419593842238, 6.829166333422806, 3.1413548296681912, 8.121246329928319, 5.744762428648144, 8.40909842828933, 10.066824513293625, 7.9933881940755676, 6.770969030054203, 9.618024426530564, 7.703602532554715, 4.950632415957131, 5.213860733411601, 8.356348590484686, 1.9059821738532658, 10.345562666017704, 9.294996557008863, 5.456243224293668, 6.120057008547327, 6.060646559092177, 5.697184701084413, 6.523413746972268, 8.509379120319299, 4.628809745584517, 0.4424194648598335, 7.400641839463932, 4.612549322480883, 5.159802899857641, 6.359236122568693, 5.725086212720067, 7.8713007983932695, 7.456828759783862, 4.155138956381736, 4.372351389709849, 7.728685314299159, 10.873474234517948, 4.372384803198978, 5.364379053536868, 7.182184166623192, 9.527848461974527, 1.8091695170417506, 5.232929123565665, 8.994914442756402, 7.1362421380795205, 5.358743770019857, 6.547232829763641, 7.1016862914532295, 5.6461905867268545, 7.586251326719968, -0.31132512165246795, 9.0298536163417, 7.03763591524252, 4.523782176653259, 6.539558399709382, 3.563232130672744, 8.946398908524127, 4.608789107031532, 4.1738631468809055, 6.528926233891724, 9.162201032898578, 5.776227081512591, 1.9428109187246143, 7.609763666269522, 6.429623184277901, 5.547362130873994, 7.548520074886431, 6.4271471352673535, 6.41791185381454, 7.985997479008638, 4.930700108065039, 4.510586496958702, 8.8505237200848, 5.613479392967256, 5.700358835756116, 6.547002590059684, 7.335116063249339, 6.734662248878144, 6.690851900439172, 2.434659661061662, 3.1396851852567425, 9.039320935425081, 6.592381471919565, 3.6394769441544277, 8.700995674739163, 6.740411179284152, 6.827904937488274, 7.381801768672062, 5.818293608504147, 8.574962793158177, 6.98031294576039, 5.764678485761946], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6435839982142355, "mean_inference_ms": 7.439451030617735, "mean_action_processing_ms": 0.6107809029980633, "mean_env_wait_ms": 27.251318586470312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030028820037841797, "StateBufferConnector_ms": 0.028222084045410156, "ViewRequirementAgentConnector_ms": 0.6802752017974854}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3400600, "num_agent_steps_trained": 3400600, "num_env_steps_sampled": 3400600, "num_env_steps_trained": 3400600, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 251.92851170405578, "num_env_steps_trained_throughput_per_sec": 251.92851170405578, "timesteps_total": 3400600, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3400600, "timers": {"training_iteration_time_ms": 63583.184, "sample_time_ms": 49087.652, "load_time_ms": 704.374, "load_throughput": 22201.288, "learn_time_ms": 13381.637, "learn_throughput": 1168.616, "synch_weights_time_ms": 381.23}, "counters": {"num_env_steps_sampled": 3400600, "num_env_steps_trained": 3400600, "num_agent_steps_sampled": 3400600, "num_agent_steps_trained": 3400600}, "done": false, "episodes_total": 1260, "training_iteration": 222, "trial_id": "c5092_00000", "date": "2025-06-08_11-06-00", "timestamp": 1749373560, "time_this_iter_s": 62.08916211128235, "time_total_s": 5104.26088643074, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5104.26088643074, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 79.59577464788732, "ram_util_percent": 51.08732394366197, "gpu_util_percent0": 0.07366197183098593, "vram_util_percent0": 0.18863932291666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.5994e-05, "total_loss": -0.11462309321928346, "policy_loss": -0.032024310547699726, "vf_loss": 0.012705826968039301, "vf_explained_var": 0.7517539184743708, "kl": 0.02508254842459928, "entropy": 21.0523490264199, "entropy_coeff": 0.0041988}, "model": {}, "num_grad_updates_lifetime": 49775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3416238, "num_env_steps_trained": 3416238, "num_agent_steps_sampled": 3416238, "num_agent_steps_trained": 3416238}, "sampler_results": {"episode_reward_max": 10.873474234517948, "episode_reward_min": -0.31132512165246795, "episode_reward_mean": 6.269670535699821, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.40909842828933, 10.066824513293625, 7.9933881940755676, 6.770969030054203, 9.618024426530564, 7.703602532554715, 4.950632415957131, 5.213860733411601, 8.356348590484686, 1.9059821738532658, 10.345562666017704, 9.294996557008863, 5.456243224293668, 6.120057008547327, 6.060646559092177, 5.697184701084413, 6.523413746972268, 8.509379120319299, 4.628809745584517, 0.4424194648598335, 7.400641839463932, 4.612549322480883, 5.159802899857641, 6.359236122568693, 5.725086212720067, 7.8713007983932695, 7.456828759783862, 4.155138956381736, 4.372351389709849, 7.728685314299159, 10.873474234517948, 4.372384803198978, 5.364379053536868, 7.182184166623192, 9.527848461974527, 1.8091695170417506, 5.232929123565665, 8.994914442756402, 7.1362421380795205, 5.358743770019857, 6.547232829763641, 7.1016862914532295, 5.6461905867268545, 7.586251326719968, -0.31132512165246795, 9.0298536163417, 7.03763591524252, 4.523782176653259, 6.539558399709382, 3.563232130672744, 8.946398908524127, 4.608789107031532, 4.1738631468809055, 6.528926233891724, 9.162201032898578, 5.776227081512591, 1.9428109187246143, 7.609763666269522, 6.429623184277901, 5.547362130873994, 7.548520074886431, 6.4271471352673535, 6.41791185381454, 7.985997479008638, 4.930700108065039, 4.510586496958702, 8.8505237200848, 5.613479392967256, 5.700358835756116, 6.547002590059684, 7.335116063249339, 6.734662248878144, 6.690851900439172, 2.434659661061662, 3.1396851852567425, 9.039320935425081, 6.592381471919565, 3.6394769441544277, 8.700995674739163, 6.740411179284152, 6.827904937488274, 7.381801768672062, 5.818293608504147, 8.574962793158177, 6.98031294576039, 5.764678485761946, 5.772202109977876, 2.0801953433961042, 1.9067644898908993, 8.160635819321206, 6.645434796665756, 8.004440742538481, 5.488314986083713, 5.014038267026472, 8.574753891912556, 5.09841761760934, 6.55959563968283, 5.144719374017166, 8.082111199092353, 4.756287080371518], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6454271038667667, "mean_inference_ms": 7.448745124799708, "mean_action_processing_ms": 0.6120086272394802, "mean_env_wait_ms": 27.31360590366198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029000520706176758, "StateBufferConnector_ms": 0.027873754501342773, "ViewRequirementAgentConnector_ms": 0.668698787689209}}, "episode_reward_max": 10.873474234517948, "episode_reward_min": -0.31132512165246795, "episode_reward_mean": 6.269670535699821, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.40909842828933, 10.066824513293625, 7.9933881940755676, 6.770969030054203, 9.618024426530564, 7.703602532554715, 4.950632415957131, 5.213860733411601, 8.356348590484686, 1.9059821738532658, 10.345562666017704, 9.294996557008863, 5.456243224293668, 6.120057008547327, 6.060646559092177, 5.697184701084413, 6.523413746972268, 8.509379120319299, 4.628809745584517, 0.4424194648598335, 7.400641839463932, 4.612549322480883, 5.159802899857641, 6.359236122568693, 5.725086212720067, 7.8713007983932695, 7.456828759783862, 4.155138956381736, 4.372351389709849, 7.728685314299159, 10.873474234517948, 4.372384803198978, 5.364379053536868, 7.182184166623192, 9.527848461974527, 1.8091695170417506, 5.232929123565665, 8.994914442756402, 7.1362421380795205, 5.358743770019857, 6.547232829763641, 7.1016862914532295, 5.6461905867268545, 7.586251326719968, -0.31132512165246795, 9.0298536163417, 7.03763591524252, 4.523782176653259, 6.539558399709382, 3.563232130672744, 8.946398908524127, 4.608789107031532, 4.1738631468809055, 6.528926233891724, 9.162201032898578, 5.776227081512591, 1.9428109187246143, 7.609763666269522, 6.429623184277901, 5.547362130873994, 7.548520074886431, 6.4271471352673535, 6.41791185381454, 7.985997479008638, 4.930700108065039, 4.510586496958702, 8.8505237200848, 5.613479392967256, 5.700358835756116, 6.547002590059684, 7.335116063249339, 6.734662248878144, 6.690851900439172, 2.434659661061662, 3.1396851852567425, 9.039320935425081, 6.592381471919565, 3.6394769441544277, 8.700995674739163, 6.740411179284152, 6.827904937488274, 7.381801768672062, 5.818293608504147, 8.574962793158177, 6.98031294576039, 5.764678485761946, 5.772202109977876, 2.0801953433961042, 1.9067644898908993, 8.160635819321206, 6.645434796665756, 8.004440742538481, 5.488314986083713, 5.014038267026472, 8.574753891912556, 5.09841761760934, 6.55959563968283, 5.144719374017166, 8.082111199092353, 4.756287080371518], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6454271038667667, "mean_inference_ms": 7.448745124799708, "mean_action_processing_ms": 0.6120086272394802, "mean_env_wait_ms": 27.31360590366198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029000520706176758, "StateBufferConnector_ms": 0.027873754501342773, "ViewRequirementAgentConnector_ms": 0.668698787689209}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3416238, "num_agent_steps_trained": 3416238, "num_env_steps_sampled": 3416238, "num_env_steps_trained": 3416238, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 239.1636174868705, "num_env_steps_trained_throughput_per_sec": 239.1636174868705, "timesteps_total": 3416238, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3416238, "timers": {"training_iteration_time_ms": 64168.295, "sample_time_ms": 49453.405, "load_time_ms": 712.47, "load_throughput": 21949.006, "learn_time_ms": 13584.538, "learn_throughput": 1151.162, "synch_weights_time_ms": 388.643}, "counters": {"num_env_steps_sampled": 3416238, "num_env_steps_trained": 3416238, "num_agent_steps_sampled": 3416238, "num_agent_steps_trained": 3416238}, "done": false, "episodes_total": 1274, "training_iteration": 223, "trial_id": "c5092_00000", "date": "2025-06-08_11-07-06", "timestamp": 1749373626, "time_this_iter_s": 65.40221810340881, "time_total_s": 5169.663104534149, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5169.663104534149, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 79.50266666666667, "ram_util_percent": 51.15466666666667, "gpu_util_percent0": 0.0736, "vram_util_percent0": 0.18863932291666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.583762e-05, "total_loss": -0.10577918135561049, "policy_loss": -0.024517493962246756, "vf_loss": 0.013852654617195103, "vf_explained_var": 0.7505874094096097, "kl": 0.026095065775803148, "entropy": 20.99127519607544, "entropy_coeff": 0.004167523999999999}, "model": {}, "num_grad_updates_lifetime": 50325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3431876, "num_env_steps_trained": 3431876, "num_agent_steps_sampled": 3431876, "num_agent_steps_trained": 3431876}, "sampler_results": {"episode_reward_max": 11.437234566358862, "episode_reward_min": -0.31132512165246795, "episode_reward_mean": 6.172712064568175, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.060646559092177, 5.697184701084413, 6.523413746972268, 8.509379120319299, 4.628809745584517, 0.4424194648598335, 7.400641839463932, 4.612549322480883, 5.159802899857641, 6.359236122568693, 5.725086212720067, 7.8713007983932695, 7.456828759783862, 4.155138956381736, 4.372351389709849, 7.728685314299159, 10.873474234517948, 4.372384803198978, 5.364379053536868, 7.182184166623192, 9.527848461974527, 1.8091695170417506, 5.232929123565665, 8.994914442756402, 7.1362421380795205, 5.358743770019857, 6.547232829763641, 7.1016862914532295, 5.6461905867268545, 7.586251326719968, -0.31132512165246795, 9.0298536163417, 7.03763591524252, 4.523782176653259, 6.539558399709382, 3.563232130672744, 8.946398908524127, 4.608789107031532, 4.1738631468809055, 6.528926233891724, 9.162201032898578, 5.776227081512591, 1.9428109187246143, 7.609763666269522, 6.429623184277901, 5.547362130873994, 7.548520074886431, 6.4271471352673535, 6.41791185381454, 7.985997479008638, 4.930700108065039, 4.510586496958702, 8.8505237200848, 5.613479392967256, 5.700358835756116, 6.547002590059684, 7.335116063249339, 6.734662248878144, 6.690851900439172, 2.434659661061662, 3.1396851852567425, 9.039320935425081, 6.592381471919565, 3.6394769441544277, 8.700995674739163, 6.740411179284152, 6.827904937488274, 7.381801768672062, 5.818293608504147, 8.574962793158177, 6.98031294576039, 5.764678485761946, 5.772202109977876, 2.0801953433961042, 1.9067644898908993, 8.160635819321206, 6.645434796665756, 8.004440742538481, 5.488314986083713, 5.014038267026472, 8.574753891912556, 5.09841761760934, 6.55959563968283, 5.144719374017166, 8.082111199092353, 4.756287080371518, 7.114238131626559, 9.753668199304864, 4.8252413821411375, 5.545650419303648, 11.016390096221373, 5.519409243756667, 7.994766702777632, 5.372824321927679, 5.57812351939178, 4.092118590154193, 11.437234566358862, 1.395291478359329, 6.828159894184229, 6.0366268356997805], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6469768492224026, "mean_inference_ms": 7.45624613241157, "mean_action_processing_ms": 0.6131695382401324, "mean_env_wait_ms": 27.3688008838099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03102707862854004, "StateBufferConnector_ms": 0.026567459106445312, "ViewRequirementAgentConnector_ms": 0.6575334072113037}}, "episode_reward_max": 11.437234566358862, "episode_reward_min": -0.31132512165246795, "episode_reward_mean": 6.172712064568175, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.060646559092177, 5.697184701084413, 6.523413746972268, 8.509379120319299, 4.628809745584517, 0.4424194648598335, 7.400641839463932, 4.612549322480883, 5.159802899857641, 6.359236122568693, 5.725086212720067, 7.8713007983932695, 7.456828759783862, 4.155138956381736, 4.372351389709849, 7.728685314299159, 10.873474234517948, 4.372384803198978, 5.364379053536868, 7.182184166623192, 9.527848461974527, 1.8091695170417506, 5.232929123565665, 8.994914442756402, 7.1362421380795205, 5.358743770019857, 6.547232829763641, 7.1016862914532295, 5.6461905867268545, 7.586251326719968, -0.31132512165246795, 9.0298536163417, 7.03763591524252, 4.523782176653259, 6.539558399709382, 3.563232130672744, 8.946398908524127, 4.608789107031532, 4.1738631468809055, 6.528926233891724, 9.162201032898578, 5.776227081512591, 1.9428109187246143, 7.609763666269522, 6.429623184277901, 5.547362130873994, 7.548520074886431, 6.4271471352673535, 6.41791185381454, 7.985997479008638, 4.930700108065039, 4.510586496958702, 8.8505237200848, 5.613479392967256, 5.700358835756116, 6.547002590059684, 7.335116063249339, 6.734662248878144, 6.690851900439172, 2.434659661061662, 3.1396851852567425, 9.039320935425081, 6.592381471919565, 3.6394769441544277, 8.700995674739163, 6.740411179284152, 6.827904937488274, 7.381801768672062, 5.818293608504147, 8.574962793158177, 6.98031294576039, 5.764678485761946, 5.772202109977876, 2.0801953433961042, 1.9067644898908993, 8.160635819321206, 6.645434796665756, 8.004440742538481, 5.488314986083713, 5.014038267026472, 8.574753891912556, 5.09841761760934, 6.55959563968283, 5.144719374017166, 8.082111199092353, 4.756287080371518, 7.114238131626559, 9.753668199304864, 4.8252413821411375, 5.545650419303648, 11.016390096221373, 5.519409243756667, 7.994766702777632, 5.372824321927679, 5.57812351939178, 4.092118590154193, 11.437234566358862, 1.395291478359329, 6.828159894184229, 6.0366268356997805], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6469768492224026, "mean_inference_ms": 7.45624613241157, "mean_action_processing_ms": 0.6131695382401324, "mean_env_wait_ms": 27.3688008838099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03102707862854004, "StateBufferConnector_ms": 0.026567459106445312, "ViewRequirementAgentConnector_ms": 0.6575334072113037}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3431876, "num_agent_steps_trained": 3431876, "num_env_steps_sampled": 3431876, "num_env_steps_trained": 3431876, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 248.79292664205363, "num_env_steps_trained_throughput_per_sec": 248.79292664205363, "timesteps_total": 3431876, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3431876, "timers": {"training_iteration_time_ms": 64277.501, "sample_time_ms": 49405.608, "load_time_ms": 711.665, "load_throughput": 21973.836, "learn_time_ms": 13738.161, "learn_throughput": 1138.289, "synch_weights_time_ms": 393.35}, "counters": {"num_env_steps_sampled": 3431876, "num_env_steps_trained": 3431876, "num_agent_steps_sampled": 3431876, "num_agent_steps_trained": 3431876}, "done": false, "episodes_total": 1288, "training_iteration": 224, "trial_id": "c5092_00000", "date": "2025-06-08_11-08-09", "timestamp": 1749373689, "time_this_iter_s": 62.871487617492676, "time_total_s": 5232.534592151642, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5232.534592151642, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 80.1943661971831, "ram_util_percent": 51.228169014084514, "gpu_util_percent0": 0.07309859154929578, "vram_util_percent0": 0.18863932291666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.568124000000001e-05, "total_loss": -0.11487156424364499, "policy_loss": -0.033995070037834176, "vf_loss": 0.012650085257535632, "vf_explained_var": 0.752981546683745, "kl": 0.02541117136675192, "entropy": 20.95657325744629, "entropy_coeff": 0.004136248000000001}, "model": {}, "num_grad_updates_lifetime": 50875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3447514, "num_env_steps_trained": 3447514, "num_agent_steps_sampled": 3447514, "num_agent_steps_trained": 3447514}, "sampler_results": {"episode_reward_max": 11.437234566358862, "episode_reward_min": -0.31132512165246795, "episode_reward_mean": 6.278735471301076, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.372351389709849, 7.728685314299159, 10.873474234517948, 4.372384803198978, 5.364379053536868, 7.182184166623192, 9.527848461974527, 1.8091695170417506, 5.232929123565665, 8.994914442756402, 7.1362421380795205, 5.358743770019857, 6.547232829763641, 7.1016862914532295, 5.6461905867268545, 7.586251326719968, -0.31132512165246795, 9.0298536163417, 7.03763591524252, 4.523782176653259, 6.539558399709382, 3.563232130672744, 8.946398908524127, 4.608789107031532, 4.1738631468809055, 6.528926233891724, 9.162201032898578, 5.776227081512591, 1.9428109187246143, 7.609763666269522, 6.429623184277901, 5.547362130873994, 7.548520074886431, 6.4271471352673535, 6.41791185381454, 7.985997479008638, 4.930700108065039, 4.510586496958702, 8.8505237200848, 5.613479392967256, 5.700358835756116, 6.547002590059684, 7.335116063249339, 6.734662248878144, 6.690851900439172, 2.434659661061662, 3.1396851852567425, 9.039320935425081, 6.592381471919565, 3.6394769441544277, 8.700995674739163, 6.740411179284152, 6.827904937488274, 7.381801768672062, 5.818293608504147, 8.574962793158177, 6.98031294576039, 5.764678485761946, 5.772202109977876, 2.0801953433961042, 1.9067644898908993, 8.160635819321206, 6.645434796665756, 8.004440742538481, 5.488314986083713, 5.014038267026472, 8.574753891912556, 5.09841761760934, 6.55959563968283, 5.144719374017166, 8.082111199092353, 4.756287080371518, 7.114238131626559, 9.753668199304864, 4.8252413821411375, 5.545650419303648, 11.016390096221373, 5.519409243756667, 7.994766702777632, 5.372824321927679, 5.57812351939178, 4.092118590154193, 11.437234566358862, 1.395291478359329, 6.828159894184229, 6.0366268356997805, 7.754736478001086, 8.688256704832877, 9.831084868489294, 9.256461294508094, 1.8857246089472581, 5.791400067666062, 6.175771298699717, 6.036662132708946, 5.235442512277192, 7.063869696792369, 7.6492961438143965, 6.179343054727423, 3.929147037313109, 5.727583024074744], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6486553981460979, "mean_inference_ms": 7.462576245518306, "mean_action_processing_ms": 0.6142860474240321, "mean_env_wait_ms": 27.419801527725905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02601337432861328, "StateBufferConnector_ms": 0.029575109481811523, "ViewRequirementAgentConnector_ms": 0.6769156455993652}}, "episode_reward_max": 11.437234566358862, "episode_reward_min": -0.31132512165246795, "episode_reward_mean": 6.278735471301076, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.372351389709849, 7.728685314299159, 10.873474234517948, 4.372384803198978, 5.364379053536868, 7.182184166623192, 9.527848461974527, 1.8091695170417506, 5.232929123565665, 8.994914442756402, 7.1362421380795205, 5.358743770019857, 6.547232829763641, 7.1016862914532295, 5.6461905867268545, 7.586251326719968, -0.31132512165246795, 9.0298536163417, 7.03763591524252, 4.523782176653259, 6.539558399709382, 3.563232130672744, 8.946398908524127, 4.608789107031532, 4.1738631468809055, 6.528926233891724, 9.162201032898578, 5.776227081512591, 1.9428109187246143, 7.609763666269522, 6.429623184277901, 5.547362130873994, 7.548520074886431, 6.4271471352673535, 6.41791185381454, 7.985997479008638, 4.930700108065039, 4.510586496958702, 8.8505237200848, 5.613479392967256, 5.700358835756116, 6.547002590059684, 7.335116063249339, 6.734662248878144, 6.690851900439172, 2.434659661061662, 3.1396851852567425, 9.039320935425081, 6.592381471919565, 3.6394769441544277, 8.700995674739163, 6.740411179284152, 6.827904937488274, 7.381801768672062, 5.818293608504147, 8.574962793158177, 6.98031294576039, 5.764678485761946, 5.772202109977876, 2.0801953433961042, 1.9067644898908993, 8.160635819321206, 6.645434796665756, 8.004440742538481, 5.488314986083713, 5.014038267026472, 8.574753891912556, 5.09841761760934, 6.55959563968283, 5.144719374017166, 8.082111199092353, 4.756287080371518, 7.114238131626559, 9.753668199304864, 4.8252413821411375, 5.545650419303648, 11.016390096221373, 5.519409243756667, 7.994766702777632, 5.372824321927679, 5.57812351939178, 4.092118590154193, 11.437234566358862, 1.395291478359329, 6.828159894184229, 6.0366268356997805, 7.754736478001086, 8.688256704832877, 9.831084868489294, 9.256461294508094, 1.8857246089472581, 5.791400067666062, 6.175771298699717, 6.036662132708946, 5.235442512277192, 7.063869696792369, 7.6492961438143965, 6.179343054727423, 3.929147037313109, 5.727583024074744], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6486553981460979, "mean_inference_ms": 7.462576245518306, "mean_action_processing_ms": 0.6142860474240321, "mean_env_wait_ms": 27.419801527725905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02601337432861328, "StateBufferConnector_ms": 0.029575109481811523, "ViewRequirementAgentConnector_ms": 0.6769156455993652}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3447514, "num_agent_steps_trained": 3447514, "num_env_steps_sampled": 3447514, "num_env_steps_trained": 3447514, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 244.36608414913906, "num_env_steps_trained_throughput_per_sec": 244.36608414913906, "timesteps_total": 3447514, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3447514, "timers": {"training_iteration_time_ms": 64285.66, "sample_time_ms": 49234.457, "load_time_ms": 720.258, "load_throughput": 21711.654, "learn_time_ms": 13898.751, "learn_throughput": 1125.137, "synch_weights_time_ms": 402.52}, "counters": {"num_env_steps_sampled": 3447514, "num_env_steps_trained": 3447514, "num_agent_steps_sampled": 3447514, "num_agent_steps_trained": 3447514}, "done": false, "episodes_total": 1302, "training_iteration": 225, "trial_id": "c5092_00000", "date": "2025-06-08_11-09-13", "timestamp": 1749373753, "time_this_iter_s": 64.01267695426941, "time_total_s": 5296.547269105911, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5296.547269105911, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 78.886301369863, "ram_util_percent": 51.32876712328767, "gpu_util_percent0": 0.07794520547945206, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.552486e-05, "total_loss": -0.10516167563767258, "policy_loss": -0.024862146095309238, "vf_loss": 0.012685406401499429, "vf_explained_var": 0.7504804356531664, "kl": 0.027571373942246534, "entropy": 21.01989793430675, "entropy_coeff": 0.004104971999999999}, "model": {}, "num_grad_updates_lifetime": 51425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3463152, "num_env_steps_trained": 3463152, "num_agent_steps_sampled": 3463152, "num_agent_steps_trained": 3463152}, "sampler_results": {"episode_reward_max": 11.437234566358862, "episode_reward_min": -0.31132512165246795, "episode_reward_mean": 6.242495855271273, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.6461905867268545, 7.586251326719968, -0.31132512165246795, 9.0298536163417, 7.03763591524252, 4.523782176653259, 6.539558399709382, 3.563232130672744, 8.946398908524127, 4.608789107031532, 4.1738631468809055, 6.528926233891724, 9.162201032898578, 5.776227081512591, 1.9428109187246143, 7.609763666269522, 6.429623184277901, 5.547362130873994, 7.548520074886431, 6.4271471352673535, 6.41791185381454, 7.985997479008638, 4.930700108065039, 4.510586496958702, 8.8505237200848, 5.613479392967256, 5.700358835756116, 6.547002590059684, 7.335116063249339, 6.734662248878144, 6.690851900439172, 2.434659661061662, 3.1396851852567425, 9.039320935425081, 6.592381471919565, 3.6394769441544277, 8.700995674739163, 6.740411179284152, 6.827904937488274, 7.381801768672062, 5.818293608504147, 8.574962793158177, 6.98031294576039, 5.764678485761946, 5.772202109977876, 2.0801953433961042, 1.9067644898908993, 8.160635819321206, 6.645434796665756, 8.004440742538481, 5.488314986083713, 5.014038267026472, 8.574753891912556, 5.09841761760934, 6.55959563968283, 5.144719374017166, 8.082111199092353, 4.756287080371518, 7.114238131626559, 9.753668199304864, 4.8252413821411375, 5.545650419303648, 11.016390096221373, 5.519409243756667, 7.994766702777632, 5.372824321927679, 5.57812351939178, 4.092118590154193, 11.437234566358862, 1.395291478359329, 6.828159894184229, 6.0366268356997805, 7.754736478001086, 8.688256704832877, 9.831084868489294, 9.256461294508094, 1.8857246089472581, 5.791400067666062, 6.175771298699717, 6.036662132708946, 5.235442512277192, 7.063869696792369, 7.6492961438143965, 6.179343054727423, 3.929147037313109, 5.727583024074744, 3.85890048288816, 4.495574879985766, 10.962084073659414, 5.7645629720522455, 4.589885566391687, 7.526617228742972, 4.755496827340607, 8.770757981138544, 4.493566187861989, 5.2211100271411475, 7.546723954030889, 7.744722732389732, 7.9720391903295935, 4.276221829607438], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6504746767872587, "mean_inference_ms": 7.468902986937945, "mean_action_processing_ms": 0.6153996878280928, "mean_env_wait_ms": 27.47081493900189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02601146697998047, "StateBufferConnector_ms": 0.027581214904785156, "ViewRequirementAgentConnector_ms": 0.7063751220703125}}, "episode_reward_max": 11.437234566358862, "episode_reward_min": -0.31132512165246795, "episode_reward_mean": 6.242495855271273, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.6461905867268545, 7.586251326719968, -0.31132512165246795, 9.0298536163417, 7.03763591524252, 4.523782176653259, 6.539558399709382, 3.563232130672744, 8.946398908524127, 4.608789107031532, 4.1738631468809055, 6.528926233891724, 9.162201032898578, 5.776227081512591, 1.9428109187246143, 7.609763666269522, 6.429623184277901, 5.547362130873994, 7.548520074886431, 6.4271471352673535, 6.41791185381454, 7.985997479008638, 4.930700108065039, 4.510586496958702, 8.8505237200848, 5.613479392967256, 5.700358835756116, 6.547002590059684, 7.335116063249339, 6.734662248878144, 6.690851900439172, 2.434659661061662, 3.1396851852567425, 9.039320935425081, 6.592381471919565, 3.6394769441544277, 8.700995674739163, 6.740411179284152, 6.827904937488274, 7.381801768672062, 5.818293608504147, 8.574962793158177, 6.98031294576039, 5.764678485761946, 5.772202109977876, 2.0801953433961042, 1.9067644898908993, 8.160635819321206, 6.645434796665756, 8.004440742538481, 5.488314986083713, 5.014038267026472, 8.574753891912556, 5.09841761760934, 6.55959563968283, 5.144719374017166, 8.082111199092353, 4.756287080371518, 7.114238131626559, 9.753668199304864, 4.8252413821411375, 5.545650419303648, 11.016390096221373, 5.519409243756667, 7.994766702777632, 5.372824321927679, 5.57812351939178, 4.092118590154193, 11.437234566358862, 1.395291478359329, 6.828159894184229, 6.0366268356997805, 7.754736478001086, 8.688256704832877, 9.831084868489294, 9.256461294508094, 1.8857246089472581, 5.791400067666062, 6.175771298699717, 6.036662132708946, 5.235442512277192, 7.063869696792369, 7.6492961438143965, 6.179343054727423, 3.929147037313109, 5.727583024074744, 3.85890048288816, 4.495574879985766, 10.962084073659414, 5.7645629720522455, 4.589885566391687, 7.526617228742972, 4.755496827340607, 8.770757981138544, 4.493566187861989, 5.2211100271411475, 7.546723954030889, 7.744722732389732, 7.9720391903295935, 4.276221829607438], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6504746767872587, "mean_inference_ms": 7.468902986937945, "mean_action_processing_ms": 0.6153996878280928, "mean_env_wait_ms": 27.47081493900189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02601146697998047, "StateBufferConnector_ms": 0.027581214904785156, "ViewRequirementAgentConnector_ms": 0.7063751220703125}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3463152, "num_agent_steps_trained": 3463152, "num_env_steps_sampled": 3463152, "num_env_steps_trained": 3463152, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 240.95332830233872, "num_env_steps_trained_throughput_per_sec": 240.95332830233872, "timesteps_total": 3463152, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3463152, "timers": {"training_iteration_time_ms": 64213.996, "sample_time_ms": 48959.334, "load_time_ms": 731.768, "load_throughput": 21370.152, "learn_time_ms": 14093.057, "learn_throughput": 1109.624, "synch_weights_time_ms": 401.157}, "counters": {"num_env_steps_sampled": 3463152, "num_env_steps_trained": 3463152, "num_agent_steps_sampled": 3463152, "num_agent_steps_trained": 3463152}, "done": false, "episodes_total": 1316, "training_iteration": 226, "trial_id": "c5092_00000", "date": "2025-06-08_11-10-18", "timestamp": 1749373818, "time_this_iter_s": 64.92209959030151, "time_total_s": 5361.469368696213, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5361.469368696213, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 79.56849315068492, "ram_util_percent": 50.802739726027404, "gpu_util_percent0": 0.07383561643835616, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.536848000000004e-05, "total_loss": -0.10149702438322658, "policy_loss": -0.021397990318152798, "vf_loss": 0.012780004655095665, "vf_explained_var": 0.7564400866898623, "kl": 0.026956334008030932, "entropy": 21.127084565596146, "entropy_coeff": 0.004073696000000001}, "model": {}, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3478790, "num_env_steps_trained": 3478790, "num_agent_steps_sampled": 3478790, "num_agent_steps_trained": 3478790}, "sampler_results": {"episode_reward_max": 11.437234566358862, "episode_reward_min": 1.395291478359329, "episode_reward_mean": 6.21435531057217, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.9428109187246143, 7.609763666269522, 6.429623184277901, 5.547362130873994, 7.548520074886431, 6.4271471352673535, 6.41791185381454, 7.985997479008638, 4.930700108065039, 4.510586496958702, 8.8505237200848, 5.613479392967256, 5.700358835756116, 6.547002590059684, 7.335116063249339, 6.734662248878144, 6.690851900439172, 2.434659661061662, 3.1396851852567425, 9.039320935425081, 6.592381471919565, 3.6394769441544277, 8.700995674739163, 6.740411179284152, 6.827904937488274, 7.381801768672062, 5.818293608504147, 8.574962793158177, 6.98031294576039, 5.764678485761946, 5.772202109977876, 2.0801953433961042, 1.9067644898908993, 8.160635819321206, 6.645434796665756, 8.004440742538481, 5.488314986083713, 5.014038267026472, 8.574753891912556, 5.09841761760934, 6.55959563968283, 5.144719374017166, 8.082111199092353, 4.756287080371518, 7.114238131626559, 9.753668199304864, 4.8252413821411375, 5.545650419303648, 11.016390096221373, 5.519409243756667, 7.994766702777632, 5.372824321927679, 5.57812351939178, 4.092118590154193, 11.437234566358862, 1.395291478359329, 6.828159894184229, 6.0366268356997805, 7.754736478001086, 8.688256704832877, 9.831084868489294, 9.256461294508094, 1.8857246089472581, 5.791400067666062, 6.175771298699717, 6.036662132708946, 5.235442512277192, 7.063869696792369, 7.6492961438143965, 6.179343054727423, 3.929147037313109, 5.727583024074744, 3.85890048288816, 4.495574879985766, 10.962084073659414, 5.7645629720522455, 4.589885566391687, 7.526617228742972, 4.755496827340607, 8.770757981138544, 4.493566187861989, 5.2211100271411475, 7.546723954030889, 7.744722732389732, 7.9720391903295935, 4.276221829607438, 4.470211711911897, 8.908311943122882, 4.435887060801876, 6.86648430197767, 3.371795516955776, 6.684580103629779, 9.975801067232995, 7.168809800388821, 7.675120621826583, 4.625910596897119, 4.01131618801918, 2.946114012385951, 4.575563148937973, 4.281623997154726], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6522150614323743, "mean_inference_ms": 7.4753184475421195, "mean_action_processing_ms": 0.6165170502606501, "mean_env_wait_ms": 27.521046472431035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024024486541748047, "StateBufferConnector_ms": 0.026604175567626953, "ViewRequirementAgentConnector_ms": 0.6859455108642578}}, "episode_reward_max": 11.437234566358862, "episode_reward_min": 1.395291478359329, "episode_reward_mean": 6.21435531057217, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.9428109187246143, 7.609763666269522, 6.429623184277901, 5.547362130873994, 7.548520074886431, 6.4271471352673535, 6.41791185381454, 7.985997479008638, 4.930700108065039, 4.510586496958702, 8.8505237200848, 5.613479392967256, 5.700358835756116, 6.547002590059684, 7.335116063249339, 6.734662248878144, 6.690851900439172, 2.434659661061662, 3.1396851852567425, 9.039320935425081, 6.592381471919565, 3.6394769441544277, 8.700995674739163, 6.740411179284152, 6.827904937488274, 7.381801768672062, 5.818293608504147, 8.574962793158177, 6.98031294576039, 5.764678485761946, 5.772202109977876, 2.0801953433961042, 1.9067644898908993, 8.160635819321206, 6.645434796665756, 8.004440742538481, 5.488314986083713, 5.014038267026472, 8.574753891912556, 5.09841761760934, 6.55959563968283, 5.144719374017166, 8.082111199092353, 4.756287080371518, 7.114238131626559, 9.753668199304864, 4.8252413821411375, 5.545650419303648, 11.016390096221373, 5.519409243756667, 7.994766702777632, 5.372824321927679, 5.57812351939178, 4.092118590154193, 11.437234566358862, 1.395291478359329, 6.828159894184229, 6.0366268356997805, 7.754736478001086, 8.688256704832877, 9.831084868489294, 9.256461294508094, 1.8857246089472581, 5.791400067666062, 6.175771298699717, 6.036662132708946, 5.235442512277192, 7.063869696792369, 7.6492961438143965, 6.179343054727423, 3.929147037313109, 5.727583024074744, 3.85890048288816, 4.495574879985766, 10.962084073659414, 5.7645629720522455, 4.589885566391687, 7.526617228742972, 4.755496827340607, 8.770757981138544, 4.493566187861989, 5.2211100271411475, 7.546723954030889, 7.744722732389732, 7.9720391903295935, 4.276221829607438, 4.470211711911897, 8.908311943122882, 4.435887060801876, 6.86648430197767, 3.371795516955776, 6.684580103629779, 9.975801067232995, 7.168809800388821, 7.675120621826583, 4.625910596897119, 4.01131618801918, 2.946114012385951, 4.575563148937973, 4.281623997154726], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6522150614323743, "mean_inference_ms": 7.4753184475421195, "mean_action_processing_ms": 0.6165170502606501, "mean_env_wait_ms": 27.521046472431035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024024486541748047, "StateBufferConnector_ms": 0.026604175567626953, "ViewRequirementAgentConnector_ms": 0.6859455108642578}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3478790, "num_agent_steps_trained": 3478790, "num_env_steps_sampled": 3478790, "num_env_steps_trained": 3478790, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 245.50245449955978, "num_env_steps_trained_throughput_per_sec": 245.50245449955978, "timesteps_total": 3478790, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3478790, "timers": {"training_iteration_time_ms": 63830.802, "sample_time_ms": 48465.912, "load_time_ms": 726.472, "load_throughput": 21525.959, "learn_time_ms": 14210.896, "learn_throughput": 1100.423, "synch_weights_time_ms": 400.788}, "counters": {"num_env_steps_sampled": 3478790, "num_env_steps_trained": 3478790, "num_agent_steps_sampled": 3478790, "num_agent_steps_trained": 3478790}, "done": false, "episodes_total": 1330, "training_iteration": 227, "trial_id": "c5092_00000", "date": "2025-06-08_11-11-21", "timestamp": 1749373881, "time_this_iter_s": 63.71046423912048, "time_total_s": 5425.179832935333, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5425.179832935333, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 78.93472222222222, "ram_util_percent": 51.2513888888889, "gpu_util_percent0": 0.07458333333333333, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.52121e-05, "total_loss": -0.11052961914556694, "policy_loss": -0.0313401898955503, "vf_loss": 0.013035662683065642, "vf_explained_var": 0.7867865205894817, "kl": 0.025539197767664362, "entropy": 21.056772051724522, "entropy_coeff": 0.004042419999999999}, "model": {}, "num_grad_updates_lifetime": 52525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3494428, "num_env_steps_trained": 3494428, "num_agent_steps_sampled": 3494428, "num_agent_steps_trained": 3494428}, "sampler_results": {"episode_reward_max": 11.437234566358862, "episode_reward_min": 1.0380424658027352, "episode_reward_mean": 6.222402552766247, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.335116063249339, 6.734662248878144, 6.690851900439172, 2.434659661061662, 3.1396851852567425, 9.039320935425081, 6.592381471919565, 3.6394769441544277, 8.700995674739163, 6.740411179284152, 6.827904937488274, 7.381801768672062, 5.818293608504147, 8.574962793158177, 6.98031294576039, 5.764678485761946, 5.772202109977876, 2.0801953433961042, 1.9067644898908993, 8.160635819321206, 6.645434796665756, 8.004440742538481, 5.488314986083713, 5.014038267026472, 8.574753891912556, 5.09841761760934, 6.55959563968283, 5.144719374017166, 8.082111199092353, 4.756287080371518, 7.114238131626559, 9.753668199304864, 4.8252413821411375, 5.545650419303648, 11.016390096221373, 5.519409243756667, 7.994766702777632, 5.372824321927679, 5.57812351939178, 4.092118590154193, 11.437234566358862, 1.395291478359329, 6.828159894184229, 6.0366268356997805, 7.754736478001086, 8.688256704832877, 9.831084868489294, 9.256461294508094, 1.8857246089472581, 5.791400067666062, 6.175771298699717, 6.036662132708946, 5.235442512277192, 7.063869696792369, 7.6492961438143965, 6.179343054727423, 3.929147037313109, 5.727583024074744, 3.85890048288816, 4.495574879985766, 10.962084073659414, 5.7645629720522455, 4.589885566391687, 7.526617228742972, 4.755496827340607, 8.770757981138544, 4.493566187861989, 5.2211100271411475, 7.546723954030889, 7.744722732389732, 7.9720391903295935, 4.276221829607438, 4.470211711911897, 8.908311943122882, 4.435887060801876, 6.86648430197767, 3.371795516955776, 6.684580103629779, 9.975801067232995, 7.168809800388821, 7.675120621826583, 4.625910596897119, 4.01131618801918, 2.946114012385951, 4.575563148937973, 4.281623997154726, 4.092277142881127, 9.27016175456269, 3.665457363194567, 5.212352427705076, 9.256448941179114, 6.897520830846015, 7.141016393715923, 7.641901048962975, 5.822970700289437, 9.285296767761512, 7.823093602760696, 1.0380424658027352, 7.966231442405786, 1.7537409243546835], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6538136243607433, "mean_inference_ms": 7.481438826620092, "mean_action_processing_ms": 0.6176183953678364, "mean_env_wait_ms": 27.57041314594219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018035173416137695, "StateBufferConnector_ms": 0.023650646209716797, "ViewRequirementAgentConnector_ms": 0.6887621879577637}}, "episode_reward_max": 11.437234566358862, "episode_reward_min": 1.0380424658027352, "episode_reward_mean": 6.222402552766247, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.335116063249339, 6.734662248878144, 6.690851900439172, 2.434659661061662, 3.1396851852567425, 9.039320935425081, 6.592381471919565, 3.6394769441544277, 8.700995674739163, 6.740411179284152, 6.827904937488274, 7.381801768672062, 5.818293608504147, 8.574962793158177, 6.98031294576039, 5.764678485761946, 5.772202109977876, 2.0801953433961042, 1.9067644898908993, 8.160635819321206, 6.645434796665756, 8.004440742538481, 5.488314986083713, 5.014038267026472, 8.574753891912556, 5.09841761760934, 6.55959563968283, 5.144719374017166, 8.082111199092353, 4.756287080371518, 7.114238131626559, 9.753668199304864, 4.8252413821411375, 5.545650419303648, 11.016390096221373, 5.519409243756667, 7.994766702777632, 5.372824321927679, 5.57812351939178, 4.092118590154193, 11.437234566358862, 1.395291478359329, 6.828159894184229, 6.0366268356997805, 7.754736478001086, 8.688256704832877, 9.831084868489294, 9.256461294508094, 1.8857246089472581, 5.791400067666062, 6.175771298699717, 6.036662132708946, 5.235442512277192, 7.063869696792369, 7.6492961438143965, 6.179343054727423, 3.929147037313109, 5.727583024074744, 3.85890048288816, 4.495574879985766, 10.962084073659414, 5.7645629720522455, 4.589885566391687, 7.526617228742972, 4.755496827340607, 8.770757981138544, 4.493566187861989, 5.2211100271411475, 7.546723954030889, 7.744722732389732, 7.9720391903295935, 4.276221829607438, 4.470211711911897, 8.908311943122882, 4.435887060801876, 6.86648430197767, 3.371795516955776, 6.684580103629779, 9.975801067232995, 7.168809800388821, 7.675120621826583, 4.625910596897119, 4.01131618801918, 2.946114012385951, 4.575563148937973, 4.281623997154726, 4.092277142881127, 9.27016175456269, 3.665457363194567, 5.212352427705076, 9.256448941179114, 6.897520830846015, 7.141016393715923, 7.641901048962975, 5.822970700289437, 9.285296767761512, 7.823093602760696, 1.0380424658027352, 7.966231442405786, 1.7537409243546835], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6538136243607433, "mean_inference_ms": 7.481438826620092, "mean_action_processing_ms": 0.6176183953678364, "mean_env_wait_ms": 27.57041314594219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018035173416137695, "StateBufferConnector_ms": 0.023650646209716797, "ViewRequirementAgentConnector_ms": 0.6887621879577637}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3494428, "num_agent_steps_trained": 3494428, "num_env_steps_sampled": 3494428, "num_env_steps_trained": 3494428, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 248.08873803150226, "num_env_steps_trained_throughput_per_sec": 248.08873803150226, "timesteps_total": 3494428, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3494428, "timers": {"training_iteration_time_ms": 63539.544, "sample_time_ms": 48161.403, "load_time_ms": 730.377, "load_throughput": 21410.867, "learn_time_ms": 14217.705, "learn_throughput": 1099.896, "synch_weights_time_ms": 404.617}, "counters": {"num_env_steps_sampled": 3494428, "num_env_steps_trained": 3494428, "num_agent_steps_sampled": 3494428, "num_agent_steps_trained": 3494428}, "done": false, "episodes_total": 1344, "training_iteration": 228, "trial_id": "c5092_00000", "date": "2025-06-08_11-12-25", "timestamp": 1749373945, "time_this_iter_s": 63.051745891571045, "time_total_s": 5488.231578826904, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5488.231578826904, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 79.02361111111112, "ram_util_percent": 51.28055555555556, "gpu_util_percent0": 0.07666666666666667, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.505572e-05, "total_loss": -0.10661944673396646, "policy_loss": -0.027872186444014502, "vf_loss": 0.01233499548228627, "vf_explained_var": 0.7982591824098066, "kl": 0.026058673021803598, "entropy": 21.068563532395796, "entropy_coeff": 0.004011144}, "model": {}, "num_grad_updates_lifetime": 53075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3510066, "num_env_steps_trained": 3510066, "num_agent_steps_sampled": 3510066, "num_agent_steps_trained": 3510066}, "sampler_results": {"episode_reward_max": 11.437234566358862, "episode_reward_min": 1.0380424658027352, "episode_reward_mean": 6.250386714517419, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.98031294576039, 5.764678485761946, 5.772202109977876, 2.0801953433961042, 1.9067644898908993, 8.160635819321206, 6.645434796665756, 8.004440742538481, 5.488314986083713, 5.014038267026472, 8.574753891912556, 5.09841761760934, 6.55959563968283, 5.144719374017166, 8.082111199092353, 4.756287080371518, 7.114238131626559, 9.753668199304864, 4.8252413821411375, 5.545650419303648, 11.016390096221373, 5.519409243756667, 7.994766702777632, 5.372824321927679, 5.57812351939178, 4.092118590154193, 11.437234566358862, 1.395291478359329, 6.828159894184229, 6.0366268356997805, 7.754736478001086, 8.688256704832877, 9.831084868489294, 9.256461294508094, 1.8857246089472581, 5.791400067666062, 6.175771298699717, 6.036662132708946, 5.235442512277192, 7.063869696792369, 7.6492961438143965, 6.179343054727423, 3.929147037313109, 5.727583024074744, 3.85890048288816, 4.495574879985766, 10.962084073659414, 5.7645629720522455, 4.589885566391687, 7.526617228742972, 4.755496827340607, 8.770757981138544, 4.493566187861989, 5.2211100271411475, 7.546723954030889, 7.744722732389732, 7.9720391903295935, 4.276221829607438, 4.470211711911897, 8.908311943122882, 4.435887060801876, 6.86648430197767, 3.371795516955776, 6.684580103629779, 9.975801067232995, 7.168809800388821, 7.675120621826583, 4.625910596897119, 4.01131618801918, 2.946114012385951, 4.575563148937973, 4.281623997154726, 4.092277142881127, 9.27016175456269, 3.665457363194567, 5.212352427705076, 9.256448941179114, 6.897520830846015, 7.141016393715923, 7.641901048962975, 5.822970700289437, 9.285296767761512, 7.823093602760696, 1.0380424658027352, 7.966231442405786, 1.7537409243546835, 8.272540298050355, 4.3596276292030645, 4.994537432087427, 9.394827105353166, 7.074885003107022, 9.539379903286488, 3.6530691996733484, 3.5707368315667294, 5.498045795486883, 7.341564293222218, 6.768685226487793, 8.820773828429264, 7.21259487932, 5.947673122073385], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.655307874223511, "mean_inference_ms": 7.487587014171741, "mean_action_processing_ms": 0.618722200260304, "mean_env_wait_ms": 27.61896629059733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02020716667175293, "StateBufferConnector_ms": 0.017130136489868164, "ViewRequirementAgentConnector_ms": 0.6751785278320312}}, "episode_reward_max": 11.437234566358862, "episode_reward_min": 1.0380424658027352, "episode_reward_mean": 6.250386714517419, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.98031294576039, 5.764678485761946, 5.772202109977876, 2.0801953433961042, 1.9067644898908993, 8.160635819321206, 6.645434796665756, 8.004440742538481, 5.488314986083713, 5.014038267026472, 8.574753891912556, 5.09841761760934, 6.55959563968283, 5.144719374017166, 8.082111199092353, 4.756287080371518, 7.114238131626559, 9.753668199304864, 4.8252413821411375, 5.545650419303648, 11.016390096221373, 5.519409243756667, 7.994766702777632, 5.372824321927679, 5.57812351939178, 4.092118590154193, 11.437234566358862, 1.395291478359329, 6.828159894184229, 6.0366268356997805, 7.754736478001086, 8.688256704832877, 9.831084868489294, 9.256461294508094, 1.8857246089472581, 5.791400067666062, 6.175771298699717, 6.036662132708946, 5.235442512277192, 7.063869696792369, 7.6492961438143965, 6.179343054727423, 3.929147037313109, 5.727583024074744, 3.85890048288816, 4.495574879985766, 10.962084073659414, 5.7645629720522455, 4.589885566391687, 7.526617228742972, 4.755496827340607, 8.770757981138544, 4.493566187861989, 5.2211100271411475, 7.546723954030889, 7.744722732389732, 7.9720391903295935, 4.276221829607438, 4.470211711911897, 8.908311943122882, 4.435887060801876, 6.86648430197767, 3.371795516955776, 6.684580103629779, 9.975801067232995, 7.168809800388821, 7.675120621826583, 4.625910596897119, 4.01131618801918, 2.946114012385951, 4.575563148937973, 4.281623997154726, 4.092277142881127, 9.27016175456269, 3.665457363194567, 5.212352427705076, 9.256448941179114, 6.897520830846015, 7.141016393715923, 7.641901048962975, 5.822970700289437, 9.285296767761512, 7.823093602760696, 1.0380424658027352, 7.966231442405786, 1.7537409243546835, 8.272540298050355, 4.3596276292030645, 4.994537432087427, 9.394827105353166, 7.074885003107022, 9.539379903286488, 3.6530691996733484, 3.5707368315667294, 5.498045795486883, 7.341564293222218, 6.768685226487793, 8.820773828429264, 7.21259487932, 5.947673122073385], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.655307874223511, "mean_inference_ms": 7.487587014171741, "mean_action_processing_ms": 0.618722200260304, "mean_env_wait_ms": 27.61896629059733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02020716667175293, "StateBufferConnector_ms": 0.017130136489868164, "ViewRequirementAgentConnector_ms": 0.6751785278320312}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3510066, "num_agent_steps_trained": 3510066, "num_env_steps_sampled": 3510066, "num_env_steps_trained": 3510066, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 247.15543930856327, "num_env_steps_trained_throughput_per_sec": 247.15543930856327, "timesteps_total": 3510066, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3510066, "timers": {"training_iteration_time_ms": 63630.883, "sample_time_ms": 48192.614, "load_time_ms": 730.635, "load_throughput": 21403.286, "learn_time_ms": 14282.643, "learn_throughput": 1094.895, "synch_weights_time_ms": 398.699}, "counters": {"num_env_steps_sampled": 3510066, "num_env_steps_trained": 3510066, "num_agent_steps_sampled": 3510066, "num_agent_steps_trained": 3510066}, "done": false, "episodes_total": 1358, "training_iteration": 229, "trial_id": "c5092_00000", "date": "2025-06-08_11-13-28", "timestamp": 1749374008, "time_this_iter_s": 63.29193162918091, "time_total_s": 5551.523510456085, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5551.523510456085, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 79.46666666666667, "ram_util_percent": 51.3125, "gpu_util_percent0": 0.07486111111111111, "vram_util_percent0": 0.18863932291666669}}
{"evaluation": {"sampler_results": {"episode_reward_max": -2.590911802764949, "episode_reward_min": -5.9859004970594025, "episode_reward_mean": -4.650377458611396, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.590911802764949, -4.5639329094991075, -5.9859004970594025, -4.466150499648115, -5.644991584085403], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3184874128690438, "mean_inference_ms": 3.761122910890888, "mean_action_processing_ms": 0.28884622055714526, "mean_env_wait_ms": 12.219034519929794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4671955108642578}}, "episode_reward_max": -2.590911802764949, "episode_reward_min": -5.9859004970594025, "episode_reward_mean": -4.650377458611396, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.590911802764949, -4.5639329094991075, -5.9859004970594025, -4.466150499648115, -5.644991584085403], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3184874128690438, "mean_inference_ms": 3.761122910890888, "mean_action_processing_ms": 0.28884622055714526, "mean_env_wait_ms": 12.219034519929794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4671955108642578}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.489934e-05, "total_loss": -0.10545122937563892, "policy_loss": -0.027388893059264362, "vf_loss": 0.013017300545153293, "vf_explained_var": 0.7832360289313577, "kl": 0.02503485472116322, "entropy": 21.09311820463701, "entropy_coeff": 0.003979868}, "model": {}, "num_grad_updates_lifetime": 53625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3525704, "num_env_steps_trained": 3525704, "num_agent_steps_sampled": 3525704, "num_agent_steps_trained": 3525704}, "sampler_results": {"episode_reward_max": 11.437234566358862, "episode_reward_min": 1.0380424658027352, "episode_reward_mean": 6.3329848252629946, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.082111199092353, 4.756287080371518, 7.114238131626559, 9.753668199304864, 4.8252413821411375, 5.545650419303648, 11.016390096221373, 5.519409243756667, 7.994766702777632, 5.372824321927679, 5.57812351939178, 4.092118590154193, 11.437234566358862, 1.395291478359329, 6.828159894184229, 6.0366268356997805, 7.754736478001086, 8.688256704832877, 9.831084868489294, 9.256461294508094, 1.8857246089472581, 5.791400067666062, 6.175771298699717, 6.036662132708946, 5.235442512277192, 7.063869696792369, 7.6492961438143965, 6.179343054727423, 3.929147037313109, 5.727583024074744, 3.85890048288816, 4.495574879985766, 10.962084073659414, 5.7645629720522455, 4.589885566391687, 7.526617228742972, 4.755496827340607, 8.770757981138544, 4.493566187861989, 5.2211100271411475, 7.546723954030889, 7.744722732389732, 7.9720391903295935, 4.276221829607438, 4.470211711911897, 8.908311943122882, 4.435887060801876, 6.86648430197767, 3.371795516955776, 6.684580103629779, 9.975801067232995, 7.168809800388821, 7.675120621826583, 4.625910596897119, 4.01131618801918, 2.946114012385951, 4.575563148937973, 4.281623997154726, 4.092277142881127, 9.27016175456269, 3.665457363194567, 5.212352427705076, 9.256448941179114, 6.897520830846015, 7.141016393715923, 7.641901048962975, 5.822970700289437, 9.285296767761512, 7.823093602760696, 1.0380424658027352, 7.966231442405786, 1.7537409243546835, 8.272540298050355, 4.3596276292030645, 4.994537432087427, 9.394827105353166, 7.074885003107022, 9.539379903286488, 3.6530691996733484, 3.5707368315667294, 5.498045795486883, 7.341564293222218, 6.768685226487793, 8.820773828429264, 7.21259487932, 5.947673122073385, 5.489845939753881, 6.775508597633805, 6.072128651746205, 9.742528324633193, 10.050126808277971, 7.003638453980461, 5.5335864128634595, 6.38772405616269, 5.273724071265598, 4.854011448023663, 5.651734257187368, 6.0962678868000415, 3.295785578437502, 7.227705097436432], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.65686058334284, "mean_inference_ms": 7.493209844067653, "mean_action_processing_ms": 0.619787171942343, "mean_env_wait_ms": 27.665825470611498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019198179244995117, "StateBufferConnector_ms": 0.016074419021606445, "ViewRequirementAgentConnector_ms": 0.6805057525634766}}, "episode_reward_max": 11.437234566358862, "episode_reward_min": 1.0380424658027352, "episode_reward_mean": 6.3329848252629946, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.082111199092353, 4.756287080371518, 7.114238131626559, 9.753668199304864, 4.8252413821411375, 5.545650419303648, 11.016390096221373, 5.519409243756667, 7.994766702777632, 5.372824321927679, 5.57812351939178, 4.092118590154193, 11.437234566358862, 1.395291478359329, 6.828159894184229, 6.0366268356997805, 7.754736478001086, 8.688256704832877, 9.831084868489294, 9.256461294508094, 1.8857246089472581, 5.791400067666062, 6.175771298699717, 6.036662132708946, 5.235442512277192, 7.063869696792369, 7.6492961438143965, 6.179343054727423, 3.929147037313109, 5.727583024074744, 3.85890048288816, 4.495574879985766, 10.962084073659414, 5.7645629720522455, 4.589885566391687, 7.526617228742972, 4.755496827340607, 8.770757981138544, 4.493566187861989, 5.2211100271411475, 7.546723954030889, 7.744722732389732, 7.9720391903295935, 4.276221829607438, 4.470211711911897, 8.908311943122882, 4.435887060801876, 6.86648430197767, 3.371795516955776, 6.684580103629779, 9.975801067232995, 7.168809800388821, 7.675120621826583, 4.625910596897119, 4.01131618801918, 2.946114012385951, 4.575563148937973, 4.281623997154726, 4.092277142881127, 9.27016175456269, 3.665457363194567, 5.212352427705076, 9.256448941179114, 6.897520830846015, 7.141016393715923, 7.641901048962975, 5.822970700289437, 9.285296767761512, 7.823093602760696, 1.0380424658027352, 7.966231442405786, 1.7537409243546835, 8.272540298050355, 4.3596276292030645, 4.994537432087427, 9.394827105353166, 7.074885003107022, 9.539379903286488, 3.6530691996733484, 3.5707368315667294, 5.498045795486883, 7.341564293222218, 6.768685226487793, 8.820773828429264, 7.21259487932, 5.947673122073385, 5.489845939753881, 6.775508597633805, 6.072128651746205, 9.742528324633193, 10.050126808277971, 7.003638453980461, 5.5335864128634595, 6.38772405616269, 5.273724071265598, 4.854011448023663, 5.651734257187368, 6.0962678868000415, 3.295785578437502, 7.227705097436432], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.65686058334284, "mean_inference_ms": 7.493209844067653, "mean_action_processing_ms": 0.619787171942343, "mean_env_wait_ms": 27.665825470611498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019198179244995117, "StateBufferConnector_ms": 0.016074419021606445, "ViewRequirementAgentConnector_ms": 0.6805057525634766}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3525704, "num_agent_steps_trained": 3525704, "num_env_steps_sampled": 3525704, "num_env_steps_trained": 3525704, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 244.72153866088559, "num_env_steps_trained_throughput_per_sec": 244.72153866088559, "timesteps_total": 3525704, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3525704, "timers": {"training_iteration_time_ms": 63657.523, "sample_time_ms": 48277.638, "load_time_ms": 729.072, "load_throughput": 21449.178, "learn_time_ms": 14226.819, "learn_throughput": 1099.192, "synch_weights_time_ms": 396.899}, "counters": {"num_env_steps_sampled": 3525704, "num_env_steps_trained": 3525704, "num_agent_steps_sampled": 3525704, "num_agent_steps_trained": 3525704}, "done": false, "episodes_total": 1372, "training_iteration": 230, "trial_id": "c5092_00000", "date": "2025-06-08_11-14-51", "timestamp": 1749374091, "time_this_iter_s": 83.35470867156982, "time_total_s": 5634.878219127655, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5634.878219127655, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 65.88020833333333, "ram_util_percent": 51.25104166666667, "gpu_util_percent0": 0.05937499999999999, "vram_util_percent0": 0.18863932291666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.474295999999998e-05, "total_loss": -0.09644638413478705, "policy_loss": -0.019437126665937037, "vf_loss": 0.012911997278728946, "vf_explained_var": 0.7687506025487726, "kl": 0.026556377564981748, "entropy": 21.015973708412865, "entropy_coeff": 0.003948592}, "model": {}, "num_grad_updates_lifetime": 54175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3541342, "num_env_steps_trained": 3541342, "num_agent_steps_sampled": 3541342, "num_agent_steps_trained": 3541342}, "sampler_results": {"episode_reward_max": 10.962084073659414, "episode_reward_min": 1.0380424658027352, "episode_reward_mean": 6.401034015219916, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.828159894184229, 6.0366268356997805, 7.754736478001086, 8.688256704832877, 9.831084868489294, 9.256461294508094, 1.8857246089472581, 5.791400067666062, 6.175771298699717, 6.036662132708946, 5.235442512277192, 7.063869696792369, 7.6492961438143965, 6.179343054727423, 3.929147037313109, 5.727583024074744, 3.85890048288816, 4.495574879985766, 10.962084073659414, 5.7645629720522455, 4.589885566391687, 7.526617228742972, 4.755496827340607, 8.770757981138544, 4.493566187861989, 5.2211100271411475, 7.546723954030889, 7.744722732389732, 7.9720391903295935, 4.276221829607438, 4.470211711911897, 8.908311943122882, 4.435887060801876, 6.86648430197767, 3.371795516955776, 6.684580103629779, 9.975801067232995, 7.168809800388821, 7.675120621826583, 4.625910596897119, 4.01131618801918, 2.946114012385951, 4.575563148937973, 4.281623997154726, 4.092277142881127, 9.27016175456269, 3.665457363194567, 5.212352427705076, 9.256448941179114, 6.897520830846015, 7.141016393715923, 7.641901048962975, 5.822970700289437, 9.285296767761512, 7.823093602760696, 1.0380424658027352, 7.966231442405786, 1.7537409243546835, 8.272540298050355, 4.3596276292030645, 4.994537432087427, 9.394827105353166, 7.074885003107022, 9.539379903286488, 3.6530691996733484, 3.5707368315667294, 5.498045795486883, 7.341564293222218, 6.768685226487793, 8.820773828429264, 7.21259487932, 5.947673122073385, 5.489845939753881, 6.775508597633805, 6.072128651746205, 9.742528324633193, 10.050126808277971, 7.003638453980461, 5.5335864128634595, 6.38772405616269, 5.273724071265598, 4.854011448023663, 5.651734257187368, 6.0962678868000415, 3.295785578437502, 7.227705097436432, 6.516355979363771, 6.088094132629207, 8.499278283240365, 3.7692261478419304, 8.725929096438133, 7.3686219140651525, 5.988774166269176, 4.098258141570106, 9.005450500498059, 6.3779995989789064, 7.80872925929029, 6.566656313364491, 10.866644799080383, 7.608255593849792], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6583706579644297, "mean_inference_ms": 7.498614685444368, "mean_action_processing_ms": 0.6207897601797248, "mean_env_wait_ms": 27.710947414051926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019191265106201172, "StateBufferConnector_ms": 0.017047405242919922, "ViewRequirementAgentConnector_ms": 0.6900861263275146}}, "episode_reward_max": 10.962084073659414, "episode_reward_min": 1.0380424658027352, "episode_reward_mean": 6.401034015219916, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.828159894184229, 6.0366268356997805, 7.754736478001086, 8.688256704832877, 9.831084868489294, 9.256461294508094, 1.8857246089472581, 5.791400067666062, 6.175771298699717, 6.036662132708946, 5.235442512277192, 7.063869696792369, 7.6492961438143965, 6.179343054727423, 3.929147037313109, 5.727583024074744, 3.85890048288816, 4.495574879985766, 10.962084073659414, 5.7645629720522455, 4.589885566391687, 7.526617228742972, 4.755496827340607, 8.770757981138544, 4.493566187861989, 5.2211100271411475, 7.546723954030889, 7.744722732389732, 7.9720391903295935, 4.276221829607438, 4.470211711911897, 8.908311943122882, 4.435887060801876, 6.86648430197767, 3.371795516955776, 6.684580103629779, 9.975801067232995, 7.168809800388821, 7.675120621826583, 4.625910596897119, 4.01131618801918, 2.946114012385951, 4.575563148937973, 4.281623997154726, 4.092277142881127, 9.27016175456269, 3.665457363194567, 5.212352427705076, 9.256448941179114, 6.897520830846015, 7.141016393715923, 7.641901048962975, 5.822970700289437, 9.285296767761512, 7.823093602760696, 1.0380424658027352, 7.966231442405786, 1.7537409243546835, 8.272540298050355, 4.3596276292030645, 4.994537432087427, 9.394827105353166, 7.074885003107022, 9.539379903286488, 3.6530691996733484, 3.5707368315667294, 5.498045795486883, 7.341564293222218, 6.768685226487793, 8.820773828429264, 7.21259487932, 5.947673122073385, 5.489845939753881, 6.775508597633805, 6.072128651746205, 9.742528324633193, 10.050126808277971, 7.003638453980461, 5.5335864128634595, 6.38772405616269, 5.273724071265598, 4.854011448023663, 5.651734257187368, 6.0962678868000415, 3.295785578437502, 7.227705097436432, 6.516355979363771, 6.088094132629207, 8.499278283240365, 3.7692261478419304, 8.725929096438133, 7.3686219140651525, 5.988774166269176, 4.098258141570106, 9.005450500498059, 6.3779995989789064, 7.80872925929029, 6.566656313364491, 10.866644799080383, 7.608255593849792], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6583706579644297, "mean_inference_ms": 7.498614685444368, "mean_action_processing_ms": 0.6207897601797248, "mean_env_wait_ms": 27.710947414051926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019191265106201172, "StateBufferConnector_ms": 0.017047405242919922, "ViewRequirementAgentConnector_ms": 0.6900861263275146}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3541342, "num_agent_steps_trained": 3541342, "num_env_steps_sampled": 3541342, "num_env_steps_trained": 3541342, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 251.86483971262356, "num_env_steps_trained_throughput_per_sec": 251.86483971262356, "timesteps_total": 3541342, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3541342, "timers": {"training_iteration_time_ms": 63520.335, "sample_time_ms": 48194.811, "load_time_ms": 713.359, "load_throughput": 21921.653, "learn_time_ms": 14194.749, "learn_throughput": 1101.675, "synch_weights_time_ms": 390.321}, "counters": {"num_env_steps_sampled": 3541342, "num_env_steps_trained": 3541342, "num_agent_steps_sampled": 3541342, "num_agent_steps_trained": 3541342}, "done": false, "episodes_total": 1386, "training_iteration": 231, "trial_id": "c5092_00000", "date": "2025-06-08_11-15-54", "timestamp": 1749374154, "time_this_iter_s": 62.10383939743042, "time_total_s": 5696.982058525085, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5696.982058525085, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 79.32816901408451, "ram_util_percent": 51.294366197183095, "gpu_util_percent0": 0.07253521126760563, "vram_util_percent0": 0.18863932291666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.458658000000001e-05, "total_loss": -0.09841448986543004, "policy_loss": -0.021888597090000985, "vf_loss": 0.012637572939592329, "vf_explained_var": 0.7506538302248175, "kl": 0.025827689785591437, "entropy": 21.024644255204635, "entropy_coeff": 0.003917316000000001}, "model": {}, "num_grad_updates_lifetime": 54725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3556980, "num_env_steps_trained": 3556980, "num_agent_steps_sampled": 3556980, "num_agent_steps_trained": 3556980}, "sampler_results": {"episode_reward_max": 10.962084073659414, "episode_reward_min": 1.0380424658027352, "episode_reward_mean": 6.369641214189709, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.929147037313109, 5.727583024074744, 3.85890048288816, 4.495574879985766, 10.962084073659414, 5.7645629720522455, 4.589885566391687, 7.526617228742972, 4.755496827340607, 8.770757981138544, 4.493566187861989, 5.2211100271411475, 7.546723954030889, 7.744722732389732, 7.9720391903295935, 4.276221829607438, 4.470211711911897, 8.908311943122882, 4.435887060801876, 6.86648430197767, 3.371795516955776, 6.684580103629779, 9.975801067232995, 7.168809800388821, 7.675120621826583, 4.625910596897119, 4.01131618801918, 2.946114012385951, 4.575563148937973, 4.281623997154726, 4.092277142881127, 9.27016175456269, 3.665457363194567, 5.212352427705076, 9.256448941179114, 6.897520830846015, 7.141016393715923, 7.641901048962975, 5.822970700289437, 9.285296767761512, 7.823093602760696, 1.0380424658027352, 7.966231442405786, 1.7537409243546835, 8.272540298050355, 4.3596276292030645, 4.994537432087427, 9.394827105353166, 7.074885003107022, 9.539379903286488, 3.6530691996733484, 3.5707368315667294, 5.498045795486883, 7.341564293222218, 6.768685226487793, 8.820773828429264, 7.21259487932, 5.947673122073385, 5.489845939753881, 6.775508597633805, 6.072128651746205, 9.742528324633193, 10.050126808277971, 7.003638453980461, 5.5335864128634595, 6.38772405616269, 5.273724071265598, 4.854011448023663, 5.651734257187368, 6.0962678868000415, 3.295785578437502, 7.227705097436432, 6.516355979363771, 6.088094132629207, 8.499278283240365, 3.7692261478419304, 8.725929096438133, 7.3686219140651525, 5.988774166269176, 4.098258141570106, 9.005450500498059, 6.3779995989789064, 7.80872925929029, 6.566656313364491, 10.866644799080383, 7.608255593849792, 7.715963680053121, 6.148901939665959, 7.2452841914605886, 8.223888931394168, 3.0831637565118255, 10.405161445079555, 5.186786826813447, 4.522023990370467, 3.909524310444245, 7.448710374575818, 3.218316355669882, 6.685307629058307, 9.357705531863953, 8.122816525366643], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.659734176879738, "mean_inference_ms": 7.504162077611734, "mean_action_processing_ms": 0.6217856024752506, "mean_env_wait_ms": 27.75595914667126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01919388771057129, "StateBufferConnector_ms": 0.01998138427734375, "ViewRequirementAgentConnector_ms": 0.6750621795654297}}, "episode_reward_max": 10.962084073659414, "episode_reward_min": 1.0380424658027352, "episode_reward_mean": 6.369641214189709, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.929147037313109, 5.727583024074744, 3.85890048288816, 4.495574879985766, 10.962084073659414, 5.7645629720522455, 4.589885566391687, 7.526617228742972, 4.755496827340607, 8.770757981138544, 4.493566187861989, 5.2211100271411475, 7.546723954030889, 7.744722732389732, 7.9720391903295935, 4.276221829607438, 4.470211711911897, 8.908311943122882, 4.435887060801876, 6.86648430197767, 3.371795516955776, 6.684580103629779, 9.975801067232995, 7.168809800388821, 7.675120621826583, 4.625910596897119, 4.01131618801918, 2.946114012385951, 4.575563148937973, 4.281623997154726, 4.092277142881127, 9.27016175456269, 3.665457363194567, 5.212352427705076, 9.256448941179114, 6.897520830846015, 7.141016393715923, 7.641901048962975, 5.822970700289437, 9.285296767761512, 7.823093602760696, 1.0380424658027352, 7.966231442405786, 1.7537409243546835, 8.272540298050355, 4.3596276292030645, 4.994537432087427, 9.394827105353166, 7.074885003107022, 9.539379903286488, 3.6530691996733484, 3.5707368315667294, 5.498045795486883, 7.341564293222218, 6.768685226487793, 8.820773828429264, 7.21259487932, 5.947673122073385, 5.489845939753881, 6.775508597633805, 6.072128651746205, 9.742528324633193, 10.050126808277971, 7.003638453980461, 5.5335864128634595, 6.38772405616269, 5.273724071265598, 4.854011448023663, 5.651734257187368, 6.0962678868000415, 3.295785578437502, 7.227705097436432, 6.516355979363771, 6.088094132629207, 8.499278283240365, 3.7692261478419304, 8.725929096438133, 7.3686219140651525, 5.988774166269176, 4.098258141570106, 9.005450500498059, 6.3779995989789064, 7.80872925929029, 6.566656313364491, 10.866644799080383, 7.608255593849792, 7.715963680053121, 6.148901939665959, 7.2452841914605886, 8.223888931394168, 3.0831637565118255, 10.405161445079555, 5.186786826813447, 4.522023990370467, 3.909524310444245, 7.448710374575818, 3.218316355669882, 6.685307629058307, 9.357705531863953, 8.122816525366643], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.659734176879738, "mean_inference_ms": 7.504162077611734, "mean_action_processing_ms": 0.6217856024752506, "mean_env_wait_ms": 27.75595914667126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01919388771057129, "StateBufferConnector_ms": 0.01998138427734375, "ViewRequirementAgentConnector_ms": 0.6750621795654297}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3556980, "num_agent_steps_trained": 3556980, "num_env_steps_sampled": 3556980, "num_env_steps_trained": 3556980, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 241.44565600470366, "num_env_steps_trained_throughput_per_sec": 241.44565600470366, "timesteps_total": 3556980, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3556980, "timers": {"training_iteration_time_ms": 63789.838, "sample_time_ms": 48371.404, "load_time_ms": 721.417, "load_throughput": 21676.774, "learn_time_ms": 14277.258, "learn_throughput": 1095.308, "synch_weights_time_ms": 392.319}, "counters": {"num_env_steps_sampled": 3556980, "num_env_steps_trained": 3556980, "num_agent_steps_sampled": 3556980, "num_agent_steps_trained": 3556980}, "done": false, "episodes_total": 1400, "training_iteration": 232, "trial_id": "c5092_00000", "date": "2025-06-08_11-16-58", "timestamp": 1749374218, "time_this_iter_s": 64.78273820877075, "time_total_s": 5761.764796733856, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5761.764796733856, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 79.87260273972602, "ram_util_percent": 51.342465753424655, "gpu_util_percent0": 0.07178082191780823, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.443019999999999e-05, "total_loss": -0.11042798622119748, "policy_loss": -0.03395674865391232, "vf_loss": 0.012706716821782968, "vf_explained_var": 0.7684873627532612, "kl": 0.02473451239715988, "entropy": 21.162878112792967, "entropy_coeff": 0.0038860400000000003}, "model": {}, "num_grad_updates_lifetime": 55275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3572618, "num_env_steps_trained": 3572618, "num_agent_steps_sampled": 3572618, "num_agent_steps_trained": 3572618}, "sampler_results": {"episode_reward_max": 10.866644799080383, "episode_reward_min": 1.0380424658027352, "episode_reward_mean": 6.36652942322648, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.9720391903295935, 4.276221829607438, 4.470211711911897, 8.908311943122882, 4.435887060801876, 6.86648430197767, 3.371795516955776, 6.684580103629779, 9.975801067232995, 7.168809800388821, 7.675120621826583, 4.625910596897119, 4.01131618801918, 2.946114012385951, 4.575563148937973, 4.281623997154726, 4.092277142881127, 9.27016175456269, 3.665457363194567, 5.212352427705076, 9.256448941179114, 6.897520830846015, 7.141016393715923, 7.641901048962975, 5.822970700289437, 9.285296767761512, 7.823093602760696, 1.0380424658027352, 7.966231442405786, 1.7537409243546835, 8.272540298050355, 4.3596276292030645, 4.994537432087427, 9.394827105353166, 7.074885003107022, 9.539379903286488, 3.6530691996733484, 3.5707368315667294, 5.498045795486883, 7.341564293222218, 6.768685226487793, 8.820773828429264, 7.21259487932, 5.947673122073385, 5.489845939753881, 6.775508597633805, 6.072128651746205, 9.742528324633193, 10.050126808277971, 7.003638453980461, 5.5335864128634595, 6.38772405616269, 5.273724071265598, 4.854011448023663, 5.651734257187368, 6.0962678868000415, 3.295785578437502, 7.227705097436432, 6.516355979363771, 6.088094132629207, 8.499278283240365, 3.7692261478419304, 8.725929096438133, 7.3686219140651525, 5.988774166269176, 4.098258141570106, 9.005450500498059, 6.3779995989789064, 7.80872925929029, 6.566656313364491, 10.866644799080383, 7.608255593849792, 7.715963680053121, 6.148901939665959, 7.2452841914605886, 8.223888931394168, 3.0831637565118255, 10.405161445079555, 5.186786826813447, 4.522023990370467, 3.909524310444245, 7.448710374575818, 3.218316355669882, 6.685307629058307, 9.357705531863953, 8.122816525366643, 3.8647089642423675, 5.483518180475065, 10.102396092402088, 5.953229480073216, 6.194468353531042, 6.15884372370312, 7.838483857774463, 6.731632593117193, 4.556737952453087, 1.4062590687078578, 6.7163338217788535, 3.370336404355818, 10.373663229923444, 6.324942156150725], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6610511733484237, "mean_inference_ms": 7.509914671803065, "mean_action_processing_ms": 0.6228121032790224, "mean_env_wait_ms": 27.800585499577675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019959211349487305, "StateBufferConnector_ms": 0.022993803024291992, "ViewRequirementAgentConnector_ms": 0.634615421295166}}, "episode_reward_max": 10.866644799080383, "episode_reward_min": 1.0380424658027352, "episode_reward_mean": 6.36652942322648, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.9720391903295935, 4.276221829607438, 4.470211711911897, 8.908311943122882, 4.435887060801876, 6.86648430197767, 3.371795516955776, 6.684580103629779, 9.975801067232995, 7.168809800388821, 7.675120621826583, 4.625910596897119, 4.01131618801918, 2.946114012385951, 4.575563148937973, 4.281623997154726, 4.092277142881127, 9.27016175456269, 3.665457363194567, 5.212352427705076, 9.256448941179114, 6.897520830846015, 7.141016393715923, 7.641901048962975, 5.822970700289437, 9.285296767761512, 7.823093602760696, 1.0380424658027352, 7.966231442405786, 1.7537409243546835, 8.272540298050355, 4.3596276292030645, 4.994537432087427, 9.394827105353166, 7.074885003107022, 9.539379903286488, 3.6530691996733484, 3.5707368315667294, 5.498045795486883, 7.341564293222218, 6.768685226487793, 8.820773828429264, 7.21259487932, 5.947673122073385, 5.489845939753881, 6.775508597633805, 6.072128651746205, 9.742528324633193, 10.050126808277971, 7.003638453980461, 5.5335864128634595, 6.38772405616269, 5.273724071265598, 4.854011448023663, 5.651734257187368, 6.0962678868000415, 3.295785578437502, 7.227705097436432, 6.516355979363771, 6.088094132629207, 8.499278283240365, 3.7692261478419304, 8.725929096438133, 7.3686219140651525, 5.988774166269176, 4.098258141570106, 9.005450500498059, 6.3779995989789064, 7.80872925929029, 6.566656313364491, 10.866644799080383, 7.608255593849792, 7.715963680053121, 6.148901939665959, 7.2452841914605886, 8.223888931394168, 3.0831637565118255, 10.405161445079555, 5.186786826813447, 4.522023990370467, 3.909524310444245, 7.448710374575818, 3.218316355669882, 6.685307629058307, 9.357705531863953, 8.122816525366643, 3.8647089642423675, 5.483518180475065, 10.102396092402088, 5.953229480073216, 6.194468353531042, 6.15884372370312, 7.838483857774463, 6.731632593117193, 4.556737952453087, 1.4062590687078578, 6.7163338217788535, 3.370336404355818, 10.373663229923444, 6.324942156150725], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6610511733484237, "mean_inference_ms": 7.509914671803065, "mean_action_processing_ms": 0.6228121032790224, "mean_env_wait_ms": 27.800585499577675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019959211349487305, "StateBufferConnector_ms": 0.022993803024291992, "ViewRequirementAgentConnector_ms": 0.634615421295166}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3572618, "num_agent_steps_trained": 3572618, "num_env_steps_sampled": 3572618, "num_env_steps_trained": 3572618, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 238.66392802460157, "num_env_steps_trained_throughput_per_sec": 238.66392802460157, "timesteps_total": 3572618, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3572618, "timers": {"training_iteration_time_ms": 63803.528, "sample_time_ms": 48342.471, "load_time_ms": 726.793, "load_throughput": 21516.437, "learn_time_ms": 14320.27, "learn_throughput": 1092.019, "synch_weights_time_ms": 386.089}, "counters": {"num_env_steps_sampled": 3572618, "num_env_steps_trained": 3572618, "num_agent_steps_sampled": 3572618, "num_agent_steps_trained": 3572618}, "done": false, "episodes_total": 1414, "training_iteration": 233, "trial_id": "c5092_00000", "date": "2025-06-08_11-18-04", "timestamp": 1749374284, "time_this_iter_s": 65.53612351417542, "time_total_s": 5827.300920248032, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5827.300920248032, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 79.44189189189187, "ram_util_percent": 51.11486486486487, "gpu_util_percent0": 0.07418918918918918, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.427381999999999e-05, "total_loss": -0.11601553908559832, "policy_loss": -0.04065036788297055, "vf_loss": 0.014328021536242555, "vf_explained_var": 0.7575325840169733, "kl": 0.023571110446398053, "entropy": 21.149956651167436, "entropy_coeff": 0.0038547639999999992}, "model": {}, "num_grad_updates_lifetime": 55825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3588256, "num_env_steps_trained": 3588256, "num_agent_steps_sampled": 3588256, "num_agent_steps_trained": 3588256}, "sampler_results": {"episode_reward_max": 10.866644799080383, "episode_reward_min": 0.2107705337097525, "episode_reward_mean": 6.319121000957173, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.575563148937973, 4.281623997154726, 4.092277142881127, 9.27016175456269, 3.665457363194567, 5.212352427705076, 9.256448941179114, 6.897520830846015, 7.141016393715923, 7.641901048962975, 5.822970700289437, 9.285296767761512, 7.823093602760696, 1.0380424658027352, 7.966231442405786, 1.7537409243546835, 8.272540298050355, 4.3596276292030645, 4.994537432087427, 9.394827105353166, 7.074885003107022, 9.539379903286488, 3.6530691996733484, 3.5707368315667294, 5.498045795486883, 7.341564293222218, 6.768685226487793, 8.820773828429264, 7.21259487932, 5.947673122073385, 5.489845939753881, 6.775508597633805, 6.072128651746205, 9.742528324633193, 10.050126808277971, 7.003638453980461, 5.5335864128634595, 6.38772405616269, 5.273724071265598, 4.854011448023663, 5.651734257187368, 6.0962678868000415, 3.295785578437502, 7.227705097436432, 6.516355979363771, 6.088094132629207, 8.499278283240365, 3.7692261478419304, 8.725929096438133, 7.3686219140651525, 5.988774166269176, 4.098258141570106, 9.005450500498059, 6.3779995989789064, 7.80872925929029, 6.566656313364491, 10.866644799080383, 7.608255593849792, 7.715963680053121, 6.148901939665959, 7.2452841914605886, 8.223888931394168, 3.0831637565118255, 10.405161445079555, 5.186786826813447, 4.522023990370467, 3.909524310444245, 7.448710374575818, 3.218316355669882, 6.685307629058307, 9.357705531863953, 8.122816525366643, 3.8647089642423675, 5.483518180475065, 10.102396092402088, 5.953229480073216, 6.194468353531042, 6.15884372370312, 7.838483857774463, 6.731632593117193, 4.556737952453087, 1.4062590687078578, 6.7163338217788535, 3.370336404355818, 10.373663229923444, 6.324942156150725, 3.848772233391767, 7.1925114246659305, 2.9958267199659008, 7.148067338810849, 8.642827331765492, 1.6392573335444054, 6.7285444344864, 5.010988368616089, 8.735045032958123, 6.2489294594464635, 3.8428626857816948, 10.158602528319037, 0.2107705337097525, 6.244756292694858], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6622702290824138, "mean_inference_ms": 7.515277404205348, "mean_action_processing_ms": 0.623769629523001, "mean_env_wait_ms": 27.843974478089457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199840545654297, "StateBufferConnector_ms": 0.02601790428161621, "ViewRequirementAgentConnector_ms": 0.6467063426971436}}, "episode_reward_max": 10.866644799080383, "episode_reward_min": 0.2107705337097525, "episode_reward_mean": 6.319121000957173, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.575563148937973, 4.281623997154726, 4.092277142881127, 9.27016175456269, 3.665457363194567, 5.212352427705076, 9.256448941179114, 6.897520830846015, 7.141016393715923, 7.641901048962975, 5.822970700289437, 9.285296767761512, 7.823093602760696, 1.0380424658027352, 7.966231442405786, 1.7537409243546835, 8.272540298050355, 4.3596276292030645, 4.994537432087427, 9.394827105353166, 7.074885003107022, 9.539379903286488, 3.6530691996733484, 3.5707368315667294, 5.498045795486883, 7.341564293222218, 6.768685226487793, 8.820773828429264, 7.21259487932, 5.947673122073385, 5.489845939753881, 6.775508597633805, 6.072128651746205, 9.742528324633193, 10.050126808277971, 7.003638453980461, 5.5335864128634595, 6.38772405616269, 5.273724071265598, 4.854011448023663, 5.651734257187368, 6.0962678868000415, 3.295785578437502, 7.227705097436432, 6.516355979363771, 6.088094132629207, 8.499278283240365, 3.7692261478419304, 8.725929096438133, 7.3686219140651525, 5.988774166269176, 4.098258141570106, 9.005450500498059, 6.3779995989789064, 7.80872925929029, 6.566656313364491, 10.866644799080383, 7.608255593849792, 7.715963680053121, 6.148901939665959, 7.2452841914605886, 8.223888931394168, 3.0831637565118255, 10.405161445079555, 5.186786826813447, 4.522023990370467, 3.909524310444245, 7.448710374575818, 3.218316355669882, 6.685307629058307, 9.357705531863953, 8.122816525366643, 3.8647089642423675, 5.483518180475065, 10.102396092402088, 5.953229480073216, 6.194468353531042, 6.15884372370312, 7.838483857774463, 6.731632593117193, 4.556737952453087, 1.4062590687078578, 6.7163338217788535, 3.370336404355818, 10.373663229923444, 6.324942156150725, 3.848772233391767, 7.1925114246659305, 2.9958267199659008, 7.148067338810849, 8.642827331765492, 1.6392573335444054, 6.7285444344864, 5.010988368616089, 8.735045032958123, 6.2489294594464635, 3.8428626857816948, 10.158602528319037, 0.2107705337097525, 6.244756292694858], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6622702290824138, "mean_inference_ms": 7.515277404205348, "mean_action_processing_ms": 0.623769629523001, "mean_env_wait_ms": 27.843974478089457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199840545654297, "StateBufferConnector_ms": 0.02601790428161621, "ViewRequirementAgentConnector_ms": 0.6467063426971436}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3588256, "num_agent_steps_trained": 3588256, "num_env_steps_sampled": 3588256, "num_env_steps_trained": 3588256, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 247.23066634093342, "num_env_steps_trained_throughput_per_sec": 247.23066634093342, "timesteps_total": 3588256, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3588256, "timers": {"training_iteration_time_ms": 63843.247, "sample_time_ms": 48337.426, "load_time_ms": 727.485, "load_throughput": 21495.964, "learn_time_ms": 14370.825, "learn_throughput": 1088.177, "synch_weights_time_ms": 380.691}, "counters": {"num_env_steps_sampled": 3588256, "num_env_steps_trained": 3588256, "num_agent_steps_sampled": 3588256, "num_agent_steps_trained": 3588256}, "done": false, "episodes_total": 1428, "training_iteration": 234, "trial_id": "c5092_00000", "date": "2025-06-08_11-19-07", "timestamp": 1749374347, "time_this_iter_s": 63.26868438720703, "time_total_s": 5890.569604635239, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5890.569604635239, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 79.27638888888889, "ram_util_percent": 50.45000000000001, "gpu_util_percent0": 0.07708333333333334, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.411744e-05, "total_loss": -0.11152551251590591, "policy_loss": -0.036492735216902064, "vf_loss": 0.013186790550296958, "vf_explained_var": 0.7849953660097989, "kl": 0.02581854637380501, "entropy": 21.19297914505005, "entropy_coeff": 0.0038234880000000003}, "model": {}, "num_grad_updates_lifetime": 56375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3603894, "num_env_steps_trained": 3603894, "num_agent_steps_sampled": 3603894, "num_agent_steps_trained": 3603894}, "sampler_results": {"episode_reward_max": 10.866644799080383, "episode_reward_min": -1.7848152083391782, "episode_reward_mean": 6.2916251584579195, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.966231442405786, 1.7537409243546835, 8.272540298050355, 4.3596276292030645, 4.994537432087427, 9.394827105353166, 7.074885003107022, 9.539379903286488, 3.6530691996733484, 3.5707368315667294, 5.498045795486883, 7.341564293222218, 6.768685226487793, 8.820773828429264, 7.21259487932, 5.947673122073385, 5.489845939753881, 6.775508597633805, 6.072128651746205, 9.742528324633193, 10.050126808277971, 7.003638453980461, 5.5335864128634595, 6.38772405616269, 5.273724071265598, 4.854011448023663, 5.651734257187368, 6.0962678868000415, 3.295785578437502, 7.227705097436432, 6.516355979363771, 6.088094132629207, 8.499278283240365, 3.7692261478419304, 8.725929096438133, 7.3686219140651525, 5.988774166269176, 4.098258141570106, 9.005450500498059, 6.3779995989789064, 7.80872925929029, 6.566656313364491, 10.866644799080383, 7.608255593849792, 7.715963680053121, 6.148901939665959, 7.2452841914605886, 8.223888931394168, 3.0831637565118255, 10.405161445079555, 5.186786826813447, 4.522023990370467, 3.909524310444245, 7.448710374575818, 3.218316355669882, 6.685307629058307, 9.357705531863953, 8.122816525366643, 3.8647089642423675, 5.483518180475065, 10.102396092402088, 5.953229480073216, 6.194468353531042, 6.15884372370312, 7.838483857774463, 6.731632593117193, 4.556737952453087, 1.4062590687078578, 6.7163338217788535, 3.370336404355818, 10.373663229923444, 6.324942156150725, 3.848772233391767, 7.1925114246659305, 2.9958267199659008, 7.148067338810849, 8.642827331765492, 1.6392573335444054, 6.7285444344864, 5.010988368616089, 8.735045032958123, 6.2489294594464635, 3.8428626857816948, 10.158602528319037, 0.2107705337097525, 6.244756292694858, 8.556116990689201, 4.468499142423251, 6.32544169361051, -1.7848152083391782, 5.628995379429845, 6.439819054976645, 3.1825308817903637, 7.4167327740433535, 8.411335332466859, 6.550874064456201, 6.284487502075391, 8.875070477499786, 5.177828502240878, 7.721225748466], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6633153885338066, "mean_inference_ms": 7.520568852930138, "mean_action_processing_ms": 0.6247107904567532, "mean_env_wait_ms": 27.886440255823064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021012067794799805, "StateBufferConnector_ms": 0.02599191665649414, "ViewRequirementAgentConnector_ms": 0.630526065826416}}, "episode_reward_max": 10.866644799080383, "episode_reward_min": -1.7848152083391782, "episode_reward_mean": 6.2916251584579195, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.966231442405786, 1.7537409243546835, 8.272540298050355, 4.3596276292030645, 4.994537432087427, 9.394827105353166, 7.074885003107022, 9.539379903286488, 3.6530691996733484, 3.5707368315667294, 5.498045795486883, 7.341564293222218, 6.768685226487793, 8.820773828429264, 7.21259487932, 5.947673122073385, 5.489845939753881, 6.775508597633805, 6.072128651746205, 9.742528324633193, 10.050126808277971, 7.003638453980461, 5.5335864128634595, 6.38772405616269, 5.273724071265598, 4.854011448023663, 5.651734257187368, 6.0962678868000415, 3.295785578437502, 7.227705097436432, 6.516355979363771, 6.088094132629207, 8.499278283240365, 3.7692261478419304, 8.725929096438133, 7.3686219140651525, 5.988774166269176, 4.098258141570106, 9.005450500498059, 6.3779995989789064, 7.80872925929029, 6.566656313364491, 10.866644799080383, 7.608255593849792, 7.715963680053121, 6.148901939665959, 7.2452841914605886, 8.223888931394168, 3.0831637565118255, 10.405161445079555, 5.186786826813447, 4.522023990370467, 3.909524310444245, 7.448710374575818, 3.218316355669882, 6.685307629058307, 9.357705531863953, 8.122816525366643, 3.8647089642423675, 5.483518180475065, 10.102396092402088, 5.953229480073216, 6.194468353531042, 6.15884372370312, 7.838483857774463, 6.731632593117193, 4.556737952453087, 1.4062590687078578, 6.7163338217788535, 3.370336404355818, 10.373663229923444, 6.324942156150725, 3.848772233391767, 7.1925114246659305, 2.9958267199659008, 7.148067338810849, 8.642827331765492, 1.6392573335444054, 6.7285444344864, 5.010988368616089, 8.735045032958123, 6.2489294594464635, 3.8428626857816948, 10.158602528319037, 0.2107705337097525, 6.244756292694858, 8.556116990689201, 4.468499142423251, 6.32544169361051, -1.7848152083391782, 5.628995379429845, 6.439819054976645, 3.1825308817903637, 7.4167327740433535, 8.411335332466859, 6.550874064456201, 6.284487502075391, 8.875070477499786, 5.177828502240878, 7.721225748466], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6633153885338066, "mean_inference_ms": 7.520568852930138, "mean_action_processing_ms": 0.6247107904567532, "mean_env_wait_ms": 27.886440255823064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021012067794799805, "StateBufferConnector_ms": 0.02599191665649414, "ViewRequirementAgentConnector_ms": 0.630526065826416}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3603894, "num_agent_steps_trained": 3603894, "num_env_steps_sampled": 3603894, "num_env_steps_trained": 3603894, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 245.4112292086694, "num_env_steps_trained_throughput_per_sec": 245.4112292086694, "timesteps_total": 3603894, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3603894, "timers": {"training_iteration_time_ms": 63815.993, "sample_time_ms": 48325.744, "load_time_ms": 724.851, "load_throughput": 21574.098, "learn_time_ms": 14370.451, "learn_throughput": 1088.205, "synch_weights_time_ms": 368.074}, "counters": {"num_env_steps_sampled": 3603894, "num_env_steps_trained": 3603894, "num_agent_steps_sampled": 3603894, "num_agent_steps_trained": 3603894}, "done": false, "episodes_total": 1442, "training_iteration": 235, "trial_id": "c5092_00000", "date": "2025-06-08_11-20-11", "timestamp": 1749374411, "time_this_iter_s": 63.739797830581665, "time_total_s": 5954.30940246582, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5954.30940246582, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 79.27671232876712, "ram_util_percent": 50.424657534246585, "gpu_util_percent0": 0.07643835616438356, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.396106e-05, "total_loss": -0.10271761023270136, "policy_loss": -0.02877406444665129, "vf_loss": 0.013000153947452252, "vf_explained_var": 0.7865087471225045, "kl": 0.02653654838785494, "entropy": 21.08074950131503, "entropy_coeff": 0.003792212}, "model": {}, "num_grad_updates_lifetime": 56925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3619532, "num_env_steps_trained": 3619532, "num_agent_steps_sampled": 3619532, "num_agent_steps_trained": 3619532}, "sampler_results": {"episode_reward_max": 10.866644799080383, "episode_reward_min": -1.7848152083391782, "episode_reward_mean": 6.316178488569527, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.21259487932, 5.947673122073385, 5.489845939753881, 6.775508597633805, 6.072128651746205, 9.742528324633193, 10.050126808277971, 7.003638453980461, 5.5335864128634595, 6.38772405616269, 5.273724071265598, 4.854011448023663, 5.651734257187368, 6.0962678868000415, 3.295785578437502, 7.227705097436432, 6.516355979363771, 6.088094132629207, 8.499278283240365, 3.7692261478419304, 8.725929096438133, 7.3686219140651525, 5.988774166269176, 4.098258141570106, 9.005450500498059, 6.3779995989789064, 7.80872925929029, 6.566656313364491, 10.866644799080383, 7.608255593849792, 7.715963680053121, 6.148901939665959, 7.2452841914605886, 8.223888931394168, 3.0831637565118255, 10.405161445079555, 5.186786826813447, 4.522023990370467, 3.909524310444245, 7.448710374575818, 3.218316355669882, 6.685307629058307, 9.357705531863953, 8.122816525366643, 3.8647089642423675, 5.483518180475065, 10.102396092402088, 5.953229480073216, 6.194468353531042, 6.15884372370312, 7.838483857774463, 6.731632593117193, 4.556737952453087, 1.4062590687078578, 6.7163338217788535, 3.370336404355818, 10.373663229923444, 6.324942156150725, 3.848772233391767, 7.1925114246659305, 2.9958267199659008, 7.148067338810849, 8.642827331765492, 1.6392573335444054, 6.7285444344864, 5.010988368616089, 8.735045032958123, 6.2489294594464635, 3.8428626857816948, 10.158602528319037, 0.2107705337097525, 6.244756292694858, 8.556116990689201, 4.468499142423251, 6.32544169361051, -1.7848152083391782, 5.628995379429845, 6.439819054976645, 3.1825308817903637, 7.4167327740433535, 8.411335332466859, 6.550874064456201, 6.284487502075391, 8.875070477499786, 5.177828502240878, 7.721225748466, 9.04493049484398, 4.687735619215525, 6.180311239999414, 7.534324620006529, 6.5805917338328745, 3.697980807404432, 5.2779307605479024, 7.542008384347875, 7.13862915322944, 5.303755376503877, 10.239671369223442, 9.919851152079975, 3.961702121665654, 4.3545550909740935], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6644798511390915, "mean_inference_ms": 7.525966845969463, "mean_action_processing_ms": 0.6256753318063926, "mean_env_wait_ms": 27.929987871493886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020815610885620117, "StateBufferConnector_ms": 0.03302788734436035, "ViewRequirementAgentConnector_ms": 0.6512994766235352}}, "episode_reward_max": 10.866644799080383, "episode_reward_min": -1.7848152083391782, "episode_reward_mean": 6.316178488569527, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.21259487932, 5.947673122073385, 5.489845939753881, 6.775508597633805, 6.072128651746205, 9.742528324633193, 10.050126808277971, 7.003638453980461, 5.5335864128634595, 6.38772405616269, 5.273724071265598, 4.854011448023663, 5.651734257187368, 6.0962678868000415, 3.295785578437502, 7.227705097436432, 6.516355979363771, 6.088094132629207, 8.499278283240365, 3.7692261478419304, 8.725929096438133, 7.3686219140651525, 5.988774166269176, 4.098258141570106, 9.005450500498059, 6.3779995989789064, 7.80872925929029, 6.566656313364491, 10.866644799080383, 7.608255593849792, 7.715963680053121, 6.148901939665959, 7.2452841914605886, 8.223888931394168, 3.0831637565118255, 10.405161445079555, 5.186786826813447, 4.522023990370467, 3.909524310444245, 7.448710374575818, 3.218316355669882, 6.685307629058307, 9.357705531863953, 8.122816525366643, 3.8647089642423675, 5.483518180475065, 10.102396092402088, 5.953229480073216, 6.194468353531042, 6.15884372370312, 7.838483857774463, 6.731632593117193, 4.556737952453087, 1.4062590687078578, 6.7163338217788535, 3.370336404355818, 10.373663229923444, 6.324942156150725, 3.848772233391767, 7.1925114246659305, 2.9958267199659008, 7.148067338810849, 8.642827331765492, 1.6392573335444054, 6.7285444344864, 5.010988368616089, 8.735045032958123, 6.2489294594464635, 3.8428626857816948, 10.158602528319037, 0.2107705337097525, 6.244756292694858, 8.556116990689201, 4.468499142423251, 6.32544169361051, -1.7848152083391782, 5.628995379429845, 6.439819054976645, 3.1825308817903637, 7.4167327740433535, 8.411335332466859, 6.550874064456201, 6.284487502075391, 8.875070477499786, 5.177828502240878, 7.721225748466, 9.04493049484398, 4.687735619215525, 6.180311239999414, 7.534324620006529, 6.5805917338328745, 3.697980807404432, 5.2779307605479024, 7.542008384347875, 7.13862915322944, 5.303755376503877, 10.239671369223442, 9.919851152079975, 3.961702121665654, 4.3545550909740935], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6644798511390915, "mean_inference_ms": 7.525966845969463, "mean_action_processing_ms": 0.6256753318063926, "mean_env_wait_ms": 27.929987871493886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020815610885620117, "StateBufferConnector_ms": 0.03302788734436035, "ViewRequirementAgentConnector_ms": 0.6512994766235352}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3619532, "num_agent_steps_trained": 3619532, "num_env_steps_sampled": 3619532, "num_env_steps_trained": 3619532, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 241.4638775126266, "num_env_steps_trained_throughput_per_sec": 241.4638775126266, "timesteps_total": 3619532, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3619532, "timers": {"training_iteration_time_ms": 63802.271, "sample_time_ms": 48381.471, "load_time_ms": 718.203, "load_throughput": 21773.798, "learn_time_ms": 14299.157, "learn_throughput": 1093.631, "synch_weights_time_ms": 374.572}, "counters": {"num_env_steps_sampled": 3619532, "num_env_steps_trained": 3619532, "num_agent_steps_sampled": 3619532, "num_agent_steps_trained": 3619532}, "done": false, "episodes_total": 1456, "training_iteration": 236, "trial_id": "c5092_00000", "date": "2025-06-08_11-21-16", "timestamp": 1749374476, "time_this_iter_s": 64.78132009506226, "time_total_s": 6019.090722560883, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6019.090722560883, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 79.73108108108109, "ram_util_percent": 50.45, "gpu_util_percent0": 0.07027027027027027, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.380467999999998e-05, "total_loss": -0.09977690744266676, "policy_loss": -0.026508917728576557, "vf_loss": 0.0135109570203349, "vf_explained_var": 0.7755038046836853, "kl": 0.02454975408315689, "entropy": 21.075392430045387, "entropy_coeff": 0.003760936}, "model": {}, "num_grad_updates_lifetime": 57475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3635170, "num_env_steps_trained": 3635170, "num_agent_steps_sampled": 3635170, "num_agent_steps_trained": 3635170}, "sampler_results": {"episode_reward_max": 10.866644799080383, "episode_reward_min": -1.7848152083391782, "episode_reward_mean": 6.335353553345901, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.295785578437502, 7.227705097436432, 6.516355979363771, 6.088094132629207, 8.499278283240365, 3.7692261478419304, 8.725929096438133, 7.3686219140651525, 5.988774166269176, 4.098258141570106, 9.005450500498059, 6.3779995989789064, 7.80872925929029, 6.566656313364491, 10.866644799080383, 7.608255593849792, 7.715963680053121, 6.148901939665959, 7.2452841914605886, 8.223888931394168, 3.0831637565118255, 10.405161445079555, 5.186786826813447, 4.522023990370467, 3.909524310444245, 7.448710374575818, 3.218316355669882, 6.685307629058307, 9.357705531863953, 8.122816525366643, 3.8647089642423675, 5.483518180475065, 10.102396092402088, 5.953229480073216, 6.194468353531042, 6.15884372370312, 7.838483857774463, 6.731632593117193, 4.556737952453087, 1.4062590687078578, 6.7163338217788535, 3.370336404355818, 10.373663229923444, 6.324942156150725, 3.848772233391767, 7.1925114246659305, 2.9958267199659008, 7.148067338810849, 8.642827331765492, 1.6392573335444054, 6.7285444344864, 5.010988368616089, 8.735045032958123, 6.2489294594464635, 3.8428626857816948, 10.158602528319037, 0.2107705337097525, 6.244756292694858, 8.556116990689201, 4.468499142423251, 6.32544169361051, -1.7848152083391782, 5.628995379429845, 6.439819054976645, 3.1825308817903637, 7.4167327740433535, 8.411335332466859, 6.550874064456201, 6.284487502075391, 8.875070477499786, 5.177828502240878, 7.721225748466, 9.04493049484398, 4.687735619215525, 6.180311239999414, 7.534324620006529, 6.5805917338328745, 3.697980807404432, 5.2779307605479024, 7.542008384347875, 7.13862915322944, 5.303755376503877, 10.239671369223442, 9.919851152079975, 3.961702121665654, 4.3545550909740935, 0.27037663443309307, 7.668863118806609, 7.89422774543834, 9.501727368877813, 9.924503094677172, 7.283267612856248, 8.06145899526528, 4.402672996806252, 8.016076300396005, 6.36724012535597, 3.2124082079832306, 7.602335884996886, 6.1415260198096435, 7.661915281656673], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6655767848421033, "mean_inference_ms": 7.531438768098617, "mean_action_processing_ms": 0.6266169826400669, "mean_env_wait_ms": 27.97240596411885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025612592697143555, "StateBufferConnector_ms": 0.035070180892944336, "ViewRequirementAgentConnector_ms": 0.6705958843231201}}, "episode_reward_max": 10.866644799080383, "episode_reward_min": -1.7848152083391782, "episode_reward_mean": 6.335353553345901, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.295785578437502, 7.227705097436432, 6.516355979363771, 6.088094132629207, 8.499278283240365, 3.7692261478419304, 8.725929096438133, 7.3686219140651525, 5.988774166269176, 4.098258141570106, 9.005450500498059, 6.3779995989789064, 7.80872925929029, 6.566656313364491, 10.866644799080383, 7.608255593849792, 7.715963680053121, 6.148901939665959, 7.2452841914605886, 8.223888931394168, 3.0831637565118255, 10.405161445079555, 5.186786826813447, 4.522023990370467, 3.909524310444245, 7.448710374575818, 3.218316355669882, 6.685307629058307, 9.357705531863953, 8.122816525366643, 3.8647089642423675, 5.483518180475065, 10.102396092402088, 5.953229480073216, 6.194468353531042, 6.15884372370312, 7.838483857774463, 6.731632593117193, 4.556737952453087, 1.4062590687078578, 6.7163338217788535, 3.370336404355818, 10.373663229923444, 6.324942156150725, 3.848772233391767, 7.1925114246659305, 2.9958267199659008, 7.148067338810849, 8.642827331765492, 1.6392573335444054, 6.7285444344864, 5.010988368616089, 8.735045032958123, 6.2489294594464635, 3.8428626857816948, 10.158602528319037, 0.2107705337097525, 6.244756292694858, 8.556116990689201, 4.468499142423251, 6.32544169361051, -1.7848152083391782, 5.628995379429845, 6.439819054976645, 3.1825308817903637, 7.4167327740433535, 8.411335332466859, 6.550874064456201, 6.284487502075391, 8.875070477499786, 5.177828502240878, 7.721225748466, 9.04493049484398, 4.687735619215525, 6.180311239999414, 7.534324620006529, 6.5805917338328745, 3.697980807404432, 5.2779307605479024, 7.542008384347875, 7.13862915322944, 5.303755376503877, 10.239671369223442, 9.919851152079975, 3.961702121665654, 4.3545550909740935, 0.27037663443309307, 7.668863118806609, 7.89422774543834, 9.501727368877813, 9.924503094677172, 7.283267612856248, 8.06145899526528, 4.402672996806252, 8.016076300396005, 6.36724012535597, 3.2124082079832306, 7.602335884996886, 6.1415260198096435, 7.661915281656673], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6655767848421033, "mean_inference_ms": 7.531438768098617, "mean_action_processing_ms": 0.6266169826400669, "mean_env_wait_ms": 27.97240596411885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025612592697143555, "StateBufferConnector_ms": 0.035070180892944336, "ViewRequirementAgentConnector_ms": 0.6705958843231201}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3635170, "num_agent_steps_trained": 3635170, "num_env_steps_sampled": 3635170, "num_env_steps_trained": 3635170, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 242.54358335128669, "num_env_steps_trained_throughput_per_sec": 242.54358335128669, "timesteps_total": 3635170, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3635170, "timers": {"training_iteration_time_ms": 63879.978, "sample_time_ms": 48417.002, "load_time_ms": 713.655, "load_throughput": 21912.553, "learn_time_ms": 14347.254, "learn_throughput": 1089.965, "synch_weights_time_ms": 372.043}, "counters": {"num_env_steps_sampled": 3635170, "num_env_steps_trained": 3635170, "num_agent_steps_sampled": 3635170, "num_agent_steps_trained": 3635170}, "done": false, "episodes_total": 1470, "training_iteration": 237, "trial_id": "c5092_00000", "date": "2025-06-08_11-22-21", "timestamp": 1749374541, "time_this_iter_s": 64.4907214641571, "time_total_s": 6083.58144402504, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6083.58144402504, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 79.91506849315068, "ram_util_percent": 50.54657534246575, "gpu_util_percent0": 0.07219178082191781, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.36483e-05, "total_loss": -0.10707989977503364, "policy_loss": -0.03437487733788492, "vf_loss": 0.012642182484269142, "vf_explained_var": 0.7732391194863752, "kl": 0.026214590702438728, "entropy": 21.06660936528986, "entropy_coeff": 0.0037296600000000005}, "model": {}, "num_grad_updates_lifetime": 58025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3650808, "num_env_steps_trained": 3650808, "num_agent_steps_sampled": 3650808, "num_agent_steps_trained": 3650808}, "sampler_results": {"episode_reward_max": 10.866644799080383, "episode_reward_min": -1.7848152083391782, "episode_reward_mean": 6.384991840033831, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.866644799080383, 7.608255593849792, 7.715963680053121, 6.148901939665959, 7.2452841914605886, 8.223888931394168, 3.0831637565118255, 10.405161445079555, 5.186786826813447, 4.522023990370467, 3.909524310444245, 7.448710374575818, 3.218316355669882, 6.685307629058307, 9.357705531863953, 8.122816525366643, 3.8647089642423675, 5.483518180475065, 10.102396092402088, 5.953229480073216, 6.194468353531042, 6.15884372370312, 7.838483857774463, 6.731632593117193, 4.556737952453087, 1.4062590687078578, 6.7163338217788535, 3.370336404355818, 10.373663229923444, 6.324942156150725, 3.848772233391767, 7.1925114246659305, 2.9958267199659008, 7.148067338810849, 8.642827331765492, 1.6392573335444054, 6.7285444344864, 5.010988368616089, 8.735045032958123, 6.2489294594464635, 3.8428626857816948, 10.158602528319037, 0.2107705337097525, 6.244756292694858, 8.556116990689201, 4.468499142423251, 6.32544169361051, -1.7848152083391782, 5.628995379429845, 6.439819054976645, 3.1825308817903637, 7.4167327740433535, 8.411335332466859, 6.550874064456201, 6.284487502075391, 8.875070477499786, 5.177828502240878, 7.721225748466, 9.04493049484398, 4.687735619215525, 6.180311239999414, 7.534324620006529, 6.5805917338328745, 3.697980807404432, 5.2779307605479024, 7.542008384347875, 7.13862915322944, 5.303755376503877, 10.239671369223442, 9.919851152079975, 3.961702121665654, 4.3545550909740935, 0.27037663443309307, 7.668863118806609, 7.89422774543834, 9.501727368877813, 9.924503094677172, 7.283267612856248, 8.06145899526528, 4.402672996806252, 8.016076300396005, 6.36724012535597, 3.2124082079832306, 7.602335884996886, 6.1415260198096435, 7.661915281656673, 4.301162393431326, 8.713290317981228, 7.699682287026355, 6.2102964788940325, 6.939619558748735, 6.986404176668627, 3.9920004186721227, 6.48720395872614, 7.873977608328691, 5.469017543784997, 6.817324147082974, 8.893204735501358, 6.89333578403335, 9.024173469336523], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.666695574854178, "mean_inference_ms": 7.53742554584048, "mean_action_processing_ms": 0.6276344759231801, "mean_env_wait_ms": 28.0160327259846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0216372013092041, "StateBufferConnector_ms": 0.03903985023498535, "ViewRequirementAgentConnector_ms": 0.6775672435760498}}, "episode_reward_max": 10.866644799080383, "episode_reward_min": -1.7848152083391782, "episode_reward_mean": 6.384991840033831, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.866644799080383, 7.608255593849792, 7.715963680053121, 6.148901939665959, 7.2452841914605886, 8.223888931394168, 3.0831637565118255, 10.405161445079555, 5.186786826813447, 4.522023990370467, 3.909524310444245, 7.448710374575818, 3.218316355669882, 6.685307629058307, 9.357705531863953, 8.122816525366643, 3.8647089642423675, 5.483518180475065, 10.102396092402088, 5.953229480073216, 6.194468353531042, 6.15884372370312, 7.838483857774463, 6.731632593117193, 4.556737952453087, 1.4062590687078578, 6.7163338217788535, 3.370336404355818, 10.373663229923444, 6.324942156150725, 3.848772233391767, 7.1925114246659305, 2.9958267199659008, 7.148067338810849, 8.642827331765492, 1.6392573335444054, 6.7285444344864, 5.010988368616089, 8.735045032958123, 6.2489294594464635, 3.8428626857816948, 10.158602528319037, 0.2107705337097525, 6.244756292694858, 8.556116990689201, 4.468499142423251, 6.32544169361051, -1.7848152083391782, 5.628995379429845, 6.439819054976645, 3.1825308817903637, 7.4167327740433535, 8.411335332466859, 6.550874064456201, 6.284487502075391, 8.875070477499786, 5.177828502240878, 7.721225748466, 9.04493049484398, 4.687735619215525, 6.180311239999414, 7.534324620006529, 6.5805917338328745, 3.697980807404432, 5.2779307605479024, 7.542008384347875, 7.13862915322944, 5.303755376503877, 10.239671369223442, 9.919851152079975, 3.961702121665654, 4.3545550909740935, 0.27037663443309307, 7.668863118806609, 7.89422774543834, 9.501727368877813, 9.924503094677172, 7.283267612856248, 8.06145899526528, 4.402672996806252, 8.016076300396005, 6.36724012535597, 3.2124082079832306, 7.602335884996886, 6.1415260198096435, 7.661915281656673, 4.301162393431326, 8.713290317981228, 7.699682287026355, 6.2102964788940325, 6.939619558748735, 6.986404176668627, 3.9920004186721227, 6.48720395872614, 7.873977608328691, 5.469017543784997, 6.817324147082974, 8.893204735501358, 6.89333578403335, 9.024173469336523], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.666695574854178, "mean_inference_ms": 7.53742554584048, "mean_action_processing_ms": 0.6276344759231801, "mean_env_wait_ms": 28.0160327259846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0216372013092041, "StateBufferConnector_ms": 0.03903985023498535, "ViewRequirementAgentConnector_ms": 0.6775672435760498}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3650808, "num_agent_steps_trained": 3650808, "num_env_steps_sampled": 3650808, "num_env_steps_trained": 3650808, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 241.67572244018982, "num_env_steps_trained_throughput_per_sec": 241.67572244018982, "timesteps_total": 3650808, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3650808, "timers": {"training_iteration_time_ms": 64047.242, "sample_time_ms": 48607.319, "load_time_ms": 709.137, "load_throughput": 22052.165, "learn_time_ms": 14344.859, "learn_throughput": 1090.147, "synch_weights_time_ms": 355.711}, "counters": {"num_env_steps_sampled": 3650808, "num_env_steps_trained": 3650808, "num_agent_steps_sampled": 3650808, "num_agent_steps_trained": 3650808}, "done": false, "episodes_total": 1484, "training_iteration": 238, "trial_id": "c5092_00000", "date": "2025-06-08_11-23-25", "timestamp": 1749374605, "time_this_iter_s": 64.7206060886383, "time_total_s": 6148.302050113678, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6148.302050113678, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 79.15675675675676, "ram_util_percent": 50.84864864864865, "gpu_util_percent0": 0.07040540540540542, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.349192000000002e-05, "total_loss": -0.1031303735716607, "policy_loss": -0.030927946705117143, "vf_loss": 0.012787079039791769, "vf_explained_var": 0.7540260556611148, "kl": 0.024153643465899884, "entropy": 21.07654126253995, "entropy_coeff": 0.003698384}, "model": {}, "num_grad_updates_lifetime": 58575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3666446, "num_env_steps_trained": 3666446, "num_agent_steps_sampled": 3666446, "num_agent_steps_trained": 3666446}, "sampler_results": {"episode_reward_max": 10.373663229923444, "episode_reward_min": -1.7848152083391782, "episode_reward_mean": 6.238903542595492, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.357705531863953, 8.122816525366643, 3.8647089642423675, 5.483518180475065, 10.102396092402088, 5.953229480073216, 6.194468353531042, 6.15884372370312, 7.838483857774463, 6.731632593117193, 4.556737952453087, 1.4062590687078578, 6.7163338217788535, 3.370336404355818, 10.373663229923444, 6.324942156150725, 3.848772233391767, 7.1925114246659305, 2.9958267199659008, 7.148067338810849, 8.642827331765492, 1.6392573335444054, 6.7285444344864, 5.010988368616089, 8.735045032958123, 6.2489294594464635, 3.8428626857816948, 10.158602528319037, 0.2107705337097525, 6.244756292694858, 8.556116990689201, 4.468499142423251, 6.32544169361051, -1.7848152083391782, 5.628995379429845, 6.439819054976645, 3.1825308817903637, 7.4167327740433535, 8.411335332466859, 6.550874064456201, 6.284487502075391, 8.875070477499786, 5.177828502240878, 7.721225748466, 9.04493049484398, 4.687735619215525, 6.180311239999414, 7.534324620006529, 6.5805917338328745, 3.697980807404432, 5.2779307605479024, 7.542008384347875, 7.13862915322944, 5.303755376503877, 10.239671369223442, 9.919851152079975, 3.961702121665654, 4.3545550909740935, 0.27037663443309307, 7.668863118806609, 7.89422774543834, 9.501727368877813, 9.924503094677172, 7.283267612856248, 8.06145899526528, 4.402672996806252, 8.016076300396005, 6.36724012535597, 3.2124082079832306, 7.602335884996886, 6.1415260198096435, 7.661915281656673, 4.301162393431326, 8.713290317981228, 7.699682287026355, 6.2102964788940325, 6.939619558748735, 6.986404176668627, 3.9920004186721227, 6.48720395872614, 7.873977608328691, 5.469017543784997, 6.817324147082974, 8.893204735501358, 6.89333578403335, 9.024173469336523, 7.114323807779421, 4.23088628671347, 3.5615256035052547, 6.0770324656231445, 1.1561267029086655, 8.118154125626859, 6.703383458278758, 7.8429826218702905, 2.876017899651495, 6.347182487338127, 3.104638794882868, 9.184821840967636, 4.541779841919768, 6.800248143128126], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6677892891561492, "mean_inference_ms": 7.5436683421040325, "mean_action_processing_ms": 0.6286910351405998, "mean_env_wait_ms": 28.06045868061728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02162456512451172, "StateBufferConnector_ms": 0.03710818290710449, "ViewRequirementAgentConnector_ms": 0.6730437278747559}}, "episode_reward_max": 10.373663229923444, "episode_reward_min": -1.7848152083391782, "episode_reward_mean": 6.238903542595492, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.357705531863953, 8.122816525366643, 3.8647089642423675, 5.483518180475065, 10.102396092402088, 5.953229480073216, 6.194468353531042, 6.15884372370312, 7.838483857774463, 6.731632593117193, 4.556737952453087, 1.4062590687078578, 6.7163338217788535, 3.370336404355818, 10.373663229923444, 6.324942156150725, 3.848772233391767, 7.1925114246659305, 2.9958267199659008, 7.148067338810849, 8.642827331765492, 1.6392573335444054, 6.7285444344864, 5.010988368616089, 8.735045032958123, 6.2489294594464635, 3.8428626857816948, 10.158602528319037, 0.2107705337097525, 6.244756292694858, 8.556116990689201, 4.468499142423251, 6.32544169361051, -1.7848152083391782, 5.628995379429845, 6.439819054976645, 3.1825308817903637, 7.4167327740433535, 8.411335332466859, 6.550874064456201, 6.284487502075391, 8.875070477499786, 5.177828502240878, 7.721225748466, 9.04493049484398, 4.687735619215525, 6.180311239999414, 7.534324620006529, 6.5805917338328745, 3.697980807404432, 5.2779307605479024, 7.542008384347875, 7.13862915322944, 5.303755376503877, 10.239671369223442, 9.919851152079975, 3.961702121665654, 4.3545550909740935, 0.27037663443309307, 7.668863118806609, 7.89422774543834, 9.501727368877813, 9.924503094677172, 7.283267612856248, 8.06145899526528, 4.402672996806252, 8.016076300396005, 6.36724012535597, 3.2124082079832306, 7.602335884996886, 6.1415260198096435, 7.661915281656673, 4.301162393431326, 8.713290317981228, 7.699682287026355, 6.2102964788940325, 6.939619558748735, 6.986404176668627, 3.9920004186721227, 6.48720395872614, 7.873977608328691, 5.469017543784997, 6.817324147082974, 8.893204735501358, 6.89333578403335, 9.024173469336523, 7.114323807779421, 4.23088628671347, 3.5615256035052547, 6.0770324656231445, 1.1561267029086655, 8.118154125626859, 6.703383458278758, 7.8429826218702905, 2.876017899651495, 6.347182487338127, 3.104638794882868, 9.184821840967636, 4.541779841919768, 6.800248143128126], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6677892891561492, "mean_inference_ms": 7.5436683421040325, "mean_action_processing_ms": 0.6286910351405998, "mean_env_wait_ms": 28.06045868061728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02162456512451172, "StateBufferConnector_ms": 0.03710818290710449, "ViewRequirementAgentConnector_ms": 0.6730437278747559}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3666446, "num_agent_steps_trained": 3666446, "num_env_steps_sampled": 3666446, "num_env_steps_trained": 3666446, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 235.6259081623792, "num_env_steps_trained_throughput_per_sec": 235.6259081623792, "timesteps_total": 3666446, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3666446, "timers": {"training_iteration_time_ms": 64356.841, "sample_time_ms": 48913.341, "load_time_ms": 706.622, "load_throughput": 22130.657, "learn_time_ms": 14350.034, "learn_throughput": 1089.753, "synch_weights_time_ms": 355.537}, "counters": {"num_env_steps_sampled": 3666446, "num_env_steps_trained": 3666446, "num_agent_steps_sampled": 3666446, "num_agent_steps_trained": 3666446}, "done": false, "episodes_total": 1498, "training_iteration": 239, "trial_id": "c5092_00000", "date": "2025-06-08_11-24-32", "timestamp": 1749374672, "time_this_iter_s": 66.386953830719, "time_total_s": 6214.689003944397, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6214.689003944397, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 79.97466666666665, "ram_util_percent": 50.97333333333332, "gpu_util_percent0": 0.0728, "vram_util_percent0": 0.18863932291666666}}
{"evaluation": {"sampler_results": {"episode_reward_max": -0.8292203373658346, "episode_reward_min": -4.222870496386644, "episode_reward_mean": -3.1647471558311255, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.172699486814271, -4.090151390493456, -2.508794068095422, -0.8292203373658346, -4.222870496386644], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3312646239664294, "mean_inference_ms": 3.8084935971398037, "mean_action_processing_ms": 0.2963865362403882, "mean_env_wait_ms": 12.495390111388009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.7197761535644531}}, "episode_reward_max": -0.8292203373658346, "episode_reward_min": -4.222870496386644, "episode_reward_mean": -3.1647471558311255, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.172699486814271, -4.090151390493456, -2.508794068095422, -0.8292203373658346, -4.222870496386644], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3312646239664294, "mean_inference_ms": 3.8084935971398037, "mean_action_processing_ms": 0.2963865362403882, "mean_env_wait_ms": 12.495390111388009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.7197761535644531}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.333554e-05, "total_loss": -0.09996527224546298, "policy_loss": -0.0285694959193775, "vf_loss": 0.013678093550472774, "vf_explained_var": 0.7544653951038014, "kl": 0.024303048709089954, "entropy": 21.112444208318536, "entropy_coeff": 0.003667107999999999}, "model": {}, "num_grad_updates_lifetime": 59125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3682084, "num_env_steps_trained": 3682084, "num_agent_steps_sampled": 3682084, "num_agent_steps_trained": 3682084}, "sampler_results": {"episode_reward_max": 11.855635575773709, "episode_reward_min": -1.7848152083391782, "episode_reward_mean": 6.2011708448880976, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.373663229923444, 6.324942156150725, 3.848772233391767, 7.1925114246659305, 2.9958267199659008, 7.148067338810849, 8.642827331765492, 1.6392573335444054, 6.7285444344864, 5.010988368616089, 8.735045032958123, 6.2489294594464635, 3.8428626857816948, 10.158602528319037, 0.2107705337097525, 6.244756292694858, 8.556116990689201, 4.468499142423251, 6.32544169361051, -1.7848152083391782, 5.628995379429845, 6.439819054976645, 3.1825308817903637, 7.4167327740433535, 8.411335332466859, 6.550874064456201, 6.284487502075391, 8.875070477499786, 5.177828502240878, 7.721225748466, 9.04493049484398, 4.687735619215525, 6.180311239999414, 7.534324620006529, 6.5805917338328745, 3.697980807404432, 5.2779307605479024, 7.542008384347875, 7.13862915322944, 5.303755376503877, 10.239671369223442, 9.919851152079975, 3.961702121665654, 4.3545550909740935, 0.27037663443309307, 7.668863118806609, 7.89422774543834, 9.501727368877813, 9.924503094677172, 7.283267612856248, 8.06145899526528, 4.402672996806252, 8.016076300396005, 6.36724012535597, 3.2124082079832306, 7.602335884996886, 6.1415260198096435, 7.661915281656673, 4.301162393431326, 8.713290317981228, 7.699682287026355, 6.2102964788940325, 6.939619558748735, 6.986404176668627, 3.9920004186721227, 6.48720395872614, 7.873977608328691, 5.469017543784997, 6.817324147082974, 8.893204735501358, 6.89333578403335, 9.024173469336523, 7.114323807779421, 4.23088628671347, 3.5615256035052547, 6.0770324656231445, 1.1561267029086655, 8.118154125626859, 6.703383458278758, 7.8429826218702905, 2.876017899651495, 6.347182487338127, 3.104638794882868, 9.184821840967636, 4.541779841919768, 6.800248143128126, 8.986592613335658, 5.940270205182136, 7.66045711158356, 3.537339802119938, 4.148425874083028, 1.4363258771667555, 11.855635575773709, 7.605565206027578, 4.31687674564281, 2.1658126602021364, 3.2461293968657183, 8.338362324680062, 7.284231658653075, 5.562175727788937], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6689239565159286, "mean_inference_ms": 7.549706345945766, "mean_action_processing_ms": 0.6297208304143642, "mean_env_wait_ms": 28.10437678558794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024944543838500977, "StateBufferConnector_ms": 0.04418611526489258, "ViewRequirementAgentConnector_ms": 0.7197451591491699}}, "episode_reward_max": 11.855635575773709, "episode_reward_min": -1.7848152083391782, "episode_reward_mean": 6.2011708448880976, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.373663229923444, 6.324942156150725, 3.848772233391767, 7.1925114246659305, 2.9958267199659008, 7.148067338810849, 8.642827331765492, 1.6392573335444054, 6.7285444344864, 5.010988368616089, 8.735045032958123, 6.2489294594464635, 3.8428626857816948, 10.158602528319037, 0.2107705337097525, 6.244756292694858, 8.556116990689201, 4.468499142423251, 6.32544169361051, -1.7848152083391782, 5.628995379429845, 6.439819054976645, 3.1825308817903637, 7.4167327740433535, 8.411335332466859, 6.550874064456201, 6.284487502075391, 8.875070477499786, 5.177828502240878, 7.721225748466, 9.04493049484398, 4.687735619215525, 6.180311239999414, 7.534324620006529, 6.5805917338328745, 3.697980807404432, 5.2779307605479024, 7.542008384347875, 7.13862915322944, 5.303755376503877, 10.239671369223442, 9.919851152079975, 3.961702121665654, 4.3545550909740935, 0.27037663443309307, 7.668863118806609, 7.89422774543834, 9.501727368877813, 9.924503094677172, 7.283267612856248, 8.06145899526528, 4.402672996806252, 8.016076300396005, 6.36724012535597, 3.2124082079832306, 7.602335884996886, 6.1415260198096435, 7.661915281656673, 4.301162393431326, 8.713290317981228, 7.699682287026355, 6.2102964788940325, 6.939619558748735, 6.986404176668627, 3.9920004186721227, 6.48720395872614, 7.873977608328691, 5.469017543784997, 6.817324147082974, 8.893204735501358, 6.89333578403335, 9.024173469336523, 7.114323807779421, 4.23088628671347, 3.5615256035052547, 6.0770324656231445, 1.1561267029086655, 8.118154125626859, 6.703383458278758, 7.8429826218702905, 2.876017899651495, 6.347182487338127, 3.104638794882868, 9.184821840967636, 4.541779841919768, 6.800248143128126, 8.986592613335658, 5.940270205182136, 7.66045711158356, 3.537339802119938, 4.148425874083028, 1.4363258771667555, 11.855635575773709, 7.605565206027578, 4.31687674564281, 2.1658126602021364, 3.2461293968657183, 8.338362324680062, 7.284231658653075, 5.562175727788937], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6689239565159286, "mean_inference_ms": 7.549706345945766, "mean_action_processing_ms": 0.6297208304143642, "mean_env_wait_ms": 28.10437678558794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024944543838500977, "StateBufferConnector_ms": 0.04418611526489258, "ViewRequirementAgentConnector_ms": 0.7197451591491699}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3682084, "num_agent_steps_trained": 3682084, "num_env_steps_sampled": 3682084, "num_env_steps_trained": 3682084, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 240.27398015283237, "num_env_steps_trained_throughput_per_sec": 240.27398015283237, "timesteps_total": 3682084, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3682084, "timers": {"training_iteration_time_ms": 64475.125, "sample_time_ms": 48991.866, "load_time_ms": 710.542, "load_throughput": 22008.566, "learn_time_ms": 14388.191, "learn_throughput": 1086.864, "synch_weights_time_ms": 352.653}, "counters": {"num_env_steps_sampled": 3682084, "num_env_steps_trained": 3682084, "num_agent_steps_sampled": 3682084, "num_agent_steps_trained": 3682084}, "done": false, "episodes_total": 1512, "training_iteration": 240, "trial_id": "c5092_00000", "date": "2025-06-08_11-25-57", "timestamp": 1749374757, "time_this_iter_s": 84.8093192577362, "time_total_s": 6299.498323202133, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6299.498323202133, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 66.45102040816327, "ram_util_percent": 50.72857142857143, "gpu_util_percent0": 0.05336734693877551, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.317916000000001e-05, "total_loss": -0.10579783338111487, "policy_loss": -0.035277839866387446, "vf_loss": 0.013056364867158912, "vf_explained_var": 0.7396255900643088, "kl": 0.025137749915834732, "entropy": 21.020040099404074, "entropy_coeff": 0.003635832}, "model": {}, "num_grad_updates_lifetime": 59675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3697722, "num_env_steps_trained": 3697722, "num_agent_steps_sampled": 3697722, "num_agent_steps_trained": 3697722}, "sampler_results": {"episode_reward_max": 11.855635575773709, "episode_reward_min": -1.7848152083391782, "episode_reward_mean": 6.249839878595541, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.2107705337097525, 6.244756292694858, 8.556116990689201, 4.468499142423251, 6.32544169361051, -1.7848152083391782, 5.628995379429845, 6.439819054976645, 3.1825308817903637, 7.4167327740433535, 8.411335332466859, 6.550874064456201, 6.284487502075391, 8.875070477499786, 5.177828502240878, 7.721225748466, 9.04493049484398, 4.687735619215525, 6.180311239999414, 7.534324620006529, 6.5805917338328745, 3.697980807404432, 5.2779307605479024, 7.542008384347875, 7.13862915322944, 5.303755376503877, 10.239671369223442, 9.919851152079975, 3.961702121665654, 4.3545550909740935, 0.27037663443309307, 7.668863118806609, 7.89422774543834, 9.501727368877813, 9.924503094677172, 7.283267612856248, 8.06145899526528, 4.402672996806252, 8.016076300396005, 6.36724012535597, 3.2124082079832306, 7.602335884996886, 6.1415260198096435, 7.661915281656673, 4.301162393431326, 8.713290317981228, 7.699682287026355, 6.2102964788940325, 6.939619558748735, 6.986404176668627, 3.9920004186721227, 6.48720395872614, 7.873977608328691, 5.469017543784997, 6.817324147082974, 8.893204735501358, 6.89333578403335, 9.024173469336523, 7.114323807779421, 4.23088628671347, 3.5615256035052547, 6.0770324656231445, 1.1561267029086655, 8.118154125626859, 6.703383458278758, 7.8429826218702905, 2.876017899651495, 6.347182487338127, 3.104638794882868, 9.184821840967636, 4.541779841919768, 6.800248143128126, 8.986592613335658, 5.940270205182136, 7.66045711158356, 3.537339802119938, 4.148425874083028, 1.4363258771667555, 11.855635575773709, 7.605565206027578, 4.31687674564281, 2.1658126602021364, 3.2461293968657183, 8.338362324680062, 7.284231658653075, 5.562175727788937, 9.356312117227382, 7.727720640776493, 3.1901770956447297, 7.950692851560612, 5.654176008114475, 1.0509089265465303, 3.0092806947417885, 7.439460602207216, 5.855303129458215, 10.407627063922982, 6.656727089141242, 6.854599516276036, 9.360999209610188, 9.243758703342783], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6702082067969313, "mean_inference_ms": 7.555844983770015, "mean_action_processing_ms": 0.630757694787007, "mean_env_wait_ms": 28.14814935541218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025925397872924805, "StateBufferConnector_ms": 0.0442044734954834, "ViewRequirementAgentConnector_ms": 0.7492644786834717}}, "episode_reward_max": 11.855635575773709, "episode_reward_min": -1.7848152083391782, "episode_reward_mean": 6.249839878595541, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.2107705337097525, 6.244756292694858, 8.556116990689201, 4.468499142423251, 6.32544169361051, -1.7848152083391782, 5.628995379429845, 6.439819054976645, 3.1825308817903637, 7.4167327740433535, 8.411335332466859, 6.550874064456201, 6.284487502075391, 8.875070477499786, 5.177828502240878, 7.721225748466, 9.04493049484398, 4.687735619215525, 6.180311239999414, 7.534324620006529, 6.5805917338328745, 3.697980807404432, 5.2779307605479024, 7.542008384347875, 7.13862915322944, 5.303755376503877, 10.239671369223442, 9.919851152079975, 3.961702121665654, 4.3545550909740935, 0.27037663443309307, 7.668863118806609, 7.89422774543834, 9.501727368877813, 9.924503094677172, 7.283267612856248, 8.06145899526528, 4.402672996806252, 8.016076300396005, 6.36724012535597, 3.2124082079832306, 7.602335884996886, 6.1415260198096435, 7.661915281656673, 4.301162393431326, 8.713290317981228, 7.699682287026355, 6.2102964788940325, 6.939619558748735, 6.986404176668627, 3.9920004186721227, 6.48720395872614, 7.873977608328691, 5.469017543784997, 6.817324147082974, 8.893204735501358, 6.89333578403335, 9.024173469336523, 7.114323807779421, 4.23088628671347, 3.5615256035052547, 6.0770324656231445, 1.1561267029086655, 8.118154125626859, 6.703383458278758, 7.8429826218702905, 2.876017899651495, 6.347182487338127, 3.104638794882868, 9.184821840967636, 4.541779841919768, 6.800248143128126, 8.986592613335658, 5.940270205182136, 7.66045711158356, 3.537339802119938, 4.148425874083028, 1.4363258771667555, 11.855635575773709, 7.605565206027578, 4.31687674564281, 2.1658126602021364, 3.2461293968657183, 8.338362324680062, 7.284231658653075, 5.562175727788937, 9.356312117227382, 7.727720640776493, 3.1901770956447297, 7.950692851560612, 5.654176008114475, 1.0509089265465303, 3.0092806947417885, 7.439460602207216, 5.855303129458215, 10.407627063922982, 6.656727089141242, 6.854599516276036, 9.360999209610188, 9.243758703342783], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6702082067969313, "mean_inference_ms": 7.555844983770015, "mean_action_processing_ms": 0.630757694787007, "mean_env_wait_ms": 28.14814935541218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025925397872924805, "StateBufferConnector_ms": 0.0442044734954834, "ViewRequirementAgentConnector_ms": 0.7492644786834717}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3697722, "num_agent_steps_trained": 3697722, "num_env_steps_sampled": 3697722, "num_env_steps_trained": 3697722, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 239.91292635909647, "num_env_steps_trained_throughput_per_sec": 239.91292635909647, "timesteps_total": 3697722, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3697722, "timers": {"training_iteration_time_ms": 64784.437, "sample_time_ms": 49181.61, "load_time_ms": 712.441, "load_throughput": 21949.902, "learn_time_ms": 14506.616, "learn_throughput": 1077.991, "synch_weights_time_ms": 352.985}, "counters": {"num_env_steps_sampled": 3697722, "num_env_steps_trained": 3697722, "num_agent_steps_sampled": 3697722, "num_agent_steps_trained": 3697722}, "done": false, "episodes_total": 1526, "training_iteration": 241, "trial_id": "c5092_00000", "date": "2025-06-08_11-27-02", "timestamp": 1749374822, "time_this_iter_s": 65.20635342597961, "time_total_s": 6364.704676628113, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6364.704676628113, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 80.2041095890411, "ram_util_percent": 50.917808219178085, "gpu_util_percent0": 0.0747945205479452, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.302278e-05, "total_loss": -0.09955538028851152, "policy_loss": -0.02938400734226558, "vf_loss": 0.01258601442572068, "vf_explained_var": 0.7601732263781807, "kl": 0.025242151179653734, "entropy": 21.068856111006305, "entropy_coeff": 0.0036045560000000005}, "model": {}, "num_grad_updates_lifetime": 60225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3713360, "num_env_steps_trained": 3713360, "num_agent_steps_sampled": 3713360, "num_agent_steps_trained": 3713360}, "sampler_results": {"episode_reward_max": 11.855635575773709, "episode_reward_min": 0.27037663443309307, "episode_reward_mean": 6.47440421890032, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.177828502240878, 7.721225748466, 9.04493049484398, 4.687735619215525, 6.180311239999414, 7.534324620006529, 6.5805917338328745, 3.697980807404432, 5.2779307605479024, 7.542008384347875, 7.13862915322944, 5.303755376503877, 10.239671369223442, 9.919851152079975, 3.961702121665654, 4.3545550909740935, 0.27037663443309307, 7.668863118806609, 7.89422774543834, 9.501727368877813, 9.924503094677172, 7.283267612856248, 8.06145899526528, 4.402672996806252, 8.016076300396005, 6.36724012535597, 3.2124082079832306, 7.602335884996886, 6.1415260198096435, 7.661915281656673, 4.301162393431326, 8.713290317981228, 7.699682287026355, 6.2102964788940325, 6.939619558748735, 6.986404176668627, 3.9920004186721227, 6.48720395872614, 7.873977608328691, 5.469017543784997, 6.817324147082974, 8.893204735501358, 6.89333578403335, 9.024173469336523, 7.114323807779421, 4.23088628671347, 3.5615256035052547, 6.0770324656231445, 1.1561267029086655, 8.118154125626859, 6.703383458278758, 7.8429826218702905, 2.876017899651495, 6.347182487338127, 3.104638794882868, 9.184821840967636, 4.541779841919768, 6.800248143128126, 8.986592613335658, 5.940270205182136, 7.66045711158356, 3.537339802119938, 4.148425874083028, 1.4363258771667555, 11.855635575773709, 7.605565206027578, 4.31687674564281, 2.1658126602021364, 3.2461293968657183, 8.338362324680062, 7.284231658653075, 5.562175727788937, 9.356312117227382, 7.727720640776493, 3.1901770956447297, 7.950692851560612, 5.654176008114475, 1.0509089265465303, 3.0092806947417885, 7.439460602207216, 5.855303129458215, 10.407627063922982, 6.656727089141242, 6.854599516276036, 9.360999209610188, 9.243758703342783, 6.737914194713802, 8.347579925279684, 5.988293112278853, 7.163332762132596, 8.748724283679179, 6.657751820858547, 5.845972383186187, 7.293054612854666, 3.103323288681523, 6.2759000971676215, 7.834042931956886, 5.942718630720076, 11.492542926245564, 7.835897972249556], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6716215637850267, "mean_inference_ms": 7.5630175812008495, "mean_action_processing_ms": 0.6318710852079027, "mean_env_wait_ms": 28.195606881474284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02897787094116211, "StateBufferConnector_ms": 0.043149471282958984, "ViewRequirementAgentConnector_ms": 0.7519323825836182}}, "episode_reward_max": 11.855635575773709, "episode_reward_min": 0.27037663443309307, "episode_reward_mean": 6.47440421890032, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.177828502240878, 7.721225748466, 9.04493049484398, 4.687735619215525, 6.180311239999414, 7.534324620006529, 6.5805917338328745, 3.697980807404432, 5.2779307605479024, 7.542008384347875, 7.13862915322944, 5.303755376503877, 10.239671369223442, 9.919851152079975, 3.961702121665654, 4.3545550909740935, 0.27037663443309307, 7.668863118806609, 7.89422774543834, 9.501727368877813, 9.924503094677172, 7.283267612856248, 8.06145899526528, 4.402672996806252, 8.016076300396005, 6.36724012535597, 3.2124082079832306, 7.602335884996886, 6.1415260198096435, 7.661915281656673, 4.301162393431326, 8.713290317981228, 7.699682287026355, 6.2102964788940325, 6.939619558748735, 6.986404176668627, 3.9920004186721227, 6.48720395872614, 7.873977608328691, 5.469017543784997, 6.817324147082974, 8.893204735501358, 6.89333578403335, 9.024173469336523, 7.114323807779421, 4.23088628671347, 3.5615256035052547, 6.0770324656231445, 1.1561267029086655, 8.118154125626859, 6.703383458278758, 7.8429826218702905, 2.876017899651495, 6.347182487338127, 3.104638794882868, 9.184821840967636, 4.541779841919768, 6.800248143128126, 8.986592613335658, 5.940270205182136, 7.66045711158356, 3.537339802119938, 4.148425874083028, 1.4363258771667555, 11.855635575773709, 7.605565206027578, 4.31687674564281, 2.1658126602021364, 3.2461293968657183, 8.338362324680062, 7.284231658653075, 5.562175727788937, 9.356312117227382, 7.727720640776493, 3.1901770956447297, 7.950692851560612, 5.654176008114475, 1.0509089265465303, 3.0092806947417885, 7.439460602207216, 5.855303129458215, 10.407627063922982, 6.656727089141242, 6.854599516276036, 9.360999209610188, 9.243758703342783, 6.737914194713802, 8.347579925279684, 5.988293112278853, 7.163332762132596, 8.748724283679179, 6.657751820858547, 5.845972383186187, 7.293054612854666, 3.103323288681523, 6.2759000971676215, 7.834042931956886, 5.942718630720076, 11.492542926245564, 7.835897972249556], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6716215637850267, "mean_inference_ms": 7.5630175812008495, "mean_action_processing_ms": 0.6318710852079027, "mean_env_wait_ms": 28.195606881474284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02897787094116211, "StateBufferConnector_ms": 0.043149471282958984, "ViewRequirementAgentConnector_ms": 0.7519323825836182}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3713360, "num_agent_steps_trained": 3713360, "num_env_steps_sampled": 3713360, "num_env_steps_trained": 3713360, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 223.60105805713155, "num_env_steps_trained_throughput_per_sec": 223.60105805713155, "timesteps_total": 3713360, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3713360, "timers": {"training_iteration_time_ms": 65301.323, "sample_time_ms": 49594.937, "load_time_ms": 715.633, "load_throughput": 21851.99, "learn_time_ms": 14594.284, "learn_throughput": 1071.515, "synch_weights_time_ms": 364.726}, "counters": {"num_env_steps_sampled": 3713360, "num_env_steps_trained": 3713360, "num_agent_steps_sampled": 3713360, "num_agent_steps_trained": 3713360}, "done": false, "episodes_total": 1540, "training_iteration": 242, "trial_id": "c5092_00000", "date": "2025-06-08_11-28-12", "timestamp": 1749374892, "time_this_iter_s": 69.97856831550598, "time_total_s": 6434.683244943619, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6434.683244943619, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 81.57848101265824, "ram_util_percent": 50.96835443037976, "gpu_util_percent0": 0.07721518987341769, "vram_util_percent0": 0.18863932291666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.28664e-05, "total_loss": -0.10613525820663199, "policy_loss": -0.03675362523576372, "vf_loss": 0.012212941525503992, "vf_explained_var": 0.7710706580768932, "kl": 0.025358985236805485, "entropy": 21.003517721349542, "entropy_coeff": 0.003573279999999999}, "model": {}, "num_grad_updates_lifetime": 60775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3728998, "num_env_steps_trained": 3728998, "num_agent_steps_sampled": 3728998, "num_agent_steps_trained": 3728998}, "sampler_results": {"episode_reward_max": 11.855635575773709, "episode_reward_min": 0.27037663443309307, "episode_reward_mean": 6.543808880519782, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.961702121665654, 4.3545550909740935, 0.27037663443309307, 7.668863118806609, 7.89422774543834, 9.501727368877813, 9.924503094677172, 7.283267612856248, 8.06145899526528, 4.402672996806252, 8.016076300396005, 6.36724012535597, 3.2124082079832306, 7.602335884996886, 6.1415260198096435, 7.661915281656673, 4.301162393431326, 8.713290317981228, 7.699682287026355, 6.2102964788940325, 6.939619558748735, 6.986404176668627, 3.9920004186721227, 6.48720395872614, 7.873977608328691, 5.469017543784997, 6.817324147082974, 8.893204735501358, 6.89333578403335, 9.024173469336523, 7.114323807779421, 4.23088628671347, 3.5615256035052547, 6.0770324656231445, 1.1561267029086655, 8.118154125626859, 6.703383458278758, 7.8429826218702905, 2.876017899651495, 6.347182487338127, 3.104638794882868, 9.184821840967636, 4.541779841919768, 6.800248143128126, 8.986592613335658, 5.940270205182136, 7.66045711158356, 3.537339802119938, 4.148425874083028, 1.4363258771667555, 11.855635575773709, 7.605565206027578, 4.31687674564281, 2.1658126602021364, 3.2461293968657183, 8.338362324680062, 7.284231658653075, 5.562175727788937, 9.356312117227382, 7.727720640776493, 3.1901770956447297, 7.950692851560612, 5.654176008114475, 1.0509089265465303, 3.0092806947417885, 7.439460602207216, 5.855303129458215, 10.407627063922982, 6.656727089141242, 6.854599516276036, 9.360999209610188, 9.243758703342783, 6.737914194713802, 8.347579925279684, 5.988293112278853, 7.163332762132596, 8.748724283679179, 6.657751820858547, 5.845972383186187, 7.293054612854666, 3.103323288681523, 6.2759000971676215, 7.834042931956886, 5.942718630720076, 11.492542926245564, 7.835897972249556, 8.560820739642272, 8.904075349232755, 6.968594039825617, 5.837829282873279, 4.968330469092385, 7.2391121282779265, 9.470850301198334, 7.760652969735039, 6.546080783733729, 6.081882775689101, 4.877937494922708, 9.012267422421427, 9.614865774973806, 7.143941592270088], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6731567503440075, "mean_inference_ms": 7.571432814775154, "mean_action_processing_ms": 0.6330605874663885, "mean_env_wait_ms": 28.24796272886242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031047344207763672, "StateBufferConnector_ms": 0.04113316535949707, "ViewRequirementAgentConnector_ms": 0.7538433074951172}}, "episode_reward_max": 11.855635575773709, "episode_reward_min": 0.27037663443309307, "episode_reward_mean": 6.543808880519782, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.961702121665654, 4.3545550909740935, 0.27037663443309307, 7.668863118806609, 7.89422774543834, 9.501727368877813, 9.924503094677172, 7.283267612856248, 8.06145899526528, 4.402672996806252, 8.016076300396005, 6.36724012535597, 3.2124082079832306, 7.602335884996886, 6.1415260198096435, 7.661915281656673, 4.301162393431326, 8.713290317981228, 7.699682287026355, 6.2102964788940325, 6.939619558748735, 6.986404176668627, 3.9920004186721227, 6.48720395872614, 7.873977608328691, 5.469017543784997, 6.817324147082974, 8.893204735501358, 6.89333578403335, 9.024173469336523, 7.114323807779421, 4.23088628671347, 3.5615256035052547, 6.0770324656231445, 1.1561267029086655, 8.118154125626859, 6.703383458278758, 7.8429826218702905, 2.876017899651495, 6.347182487338127, 3.104638794882868, 9.184821840967636, 4.541779841919768, 6.800248143128126, 8.986592613335658, 5.940270205182136, 7.66045711158356, 3.537339802119938, 4.148425874083028, 1.4363258771667555, 11.855635575773709, 7.605565206027578, 4.31687674564281, 2.1658126602021364, 3.2461293968657183, 8.338362324680062, 7.284231658653075, 5.562175727788937, 9.356312117227382, 7.727720640776493, 3.1901770956447297, 7.950692851560612, 5.654176008114475, 1.0509089265465303, 3.0092806947417885, 7.439460602207216, 5.855303129458215, 10.407627063922982, 6.656727089141242, 6.854599516276036, 9.360999209610188, 9.243758703342783, 6.737914194713802, 8.347579925279684, 5.988293112278853, 7.163332762132596, 8.748724283679179, 6.657751820858547, 5.845972383186187, 7.293054612854666, 3.103323288681523, 6.2759000971676215, 7.834042931956886, 5.942718630720076, 11.492542926245564, 7.835897972249556, 8.560820739642272, 8.904075349232755, 6.968594039825617, 5.837829282873279, 4.968330469092385, 7.2391121282779265, 9.470850301198334, 7.760652969735039, 6.546080783733729, 6.081882775689101, 4.877937494922708, 9.012267422421427, 9.614865774973806, 7.143941592270088], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6731567503440075, "mean_inference_ms": 7.571432814775154, "mean_action_processing_ms": 0.6330605874663885, "mean_env_wait_ms": 28.24796272886242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031047344207763672, "StateBufferConnector_ms": 0.04113316535949707, "ViewRequirementAgentConnector_ms": 0.7538433074951172}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3728998, "num_agent_steps_trained": 3728998, "num_env_steps_sampled": 3728998, "num_env_steps_trained": 3728998, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 217.10471824250482, "num_env_steps_trained_throughput_per_sec": 217.10471824250482, "timesteps_total": 3728998, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3728998, "timers": {"training_iteration_time_ms": 65951.989, "sample_time_ms": 50222.847, "load_time_ms": 725.015, "load_throughput": 21569.216, "learn_time_ms": 14605.045, "learn_throughput": 1070.726, "synch_weights_time_ms": 368.35}, "counters": {"num_env_steps_sampled": 3728998, "num_env_steps_trained": 3728998, "num_agent_steps_sampled": 3728998, "num_agent_steps_trained": 3728998}, "done": false, "episodes_total": 1554, "training_iteration": 243, "trial_id": "c5092_00000", "date": "2025-06-08_11-29-24", "timestamp": 1749374964, "time_this_iter_s": 72.04474711418152, "time_total_s": 6506.7279920578, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6506.7279920578, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 81.88624999999999, "ram_util_percent": 51.542500000000004, "gpu_util_percent0": 0.07062500000000001, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.271002e-05, "total_loss": -0.0980451644912616, "policy_loss": -0.02964328667185989, "vf_loss": 0.013677957919002934, "vf_explained_var": 0.7594632794640281, "kl": 0.02495102341609626, "entropy": 21.027342858748003, "entropy_coeff": 0.003542004}, "model": {}, "num_grad_updates_lifetime": 61325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3744636, "num_env_steps_trained": 3744636, "num_agent_steps_sampled": 3744636, "num_agent_steps_trained": 3744636}, "sampler_results": {"episode_reward_max": 11.855635575773709, "episode_reward_min": 0.9864094626724368, "episode_reward_mean": 6.503652780704974, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.1415260198096435, 7.661915281656673, 4.301162393431326, 8.713290317981228, 7.699682287026355, 6.2102964788940325, 6.939619558748735, 6.986404176668627, 3.9920004186721227, 6.48720395872614, 7.873977608328691, 5.469017543784997, 6.817324147082974, 8.893204735501358, 6.89333578403335, 9.024173469336523, 7.114323807779421, 4.23088628671347, 3.5615256035052547, 6.0770324656231445, 1.1561267029086655, 8.118154125626859, 6.703383458278758, 7.8429826218702905, 2.876017899651495, 6.347182487338127, 3.104638794882868, 9.184821840967636, 4.541779841919768, 6.800248143128126, 8.986592613335658, 5.940270205182136, 7.66045711158356, 3.537339802119938, 4.148425874083028, 1.4363258771667555, 11.855635575773709, 7.605565206027578, 4.31687674564281, 2.1658126602021364, 3.2461293968657183, 8.338362324680062, 7.284231658653075, 5.562175727788937, 9.356312117227382, 7.727720640776493, 3.1901770956447297, 7.950692851560612, 5.654176008114475, 1.0509089265465303, 3.0092806947417885, 7.439460602207216, 5.855303129458215, 10.407627063922982, 6.656727089141242, 6.854599516276036, 9.360999209610188, 9.243758703342783, 6.737914194713802, 8.347579925279684, 5.988293112278853, 7.163332762132596, 8.748724283679179, 6.657751820858547, 5.845972383186187, 7.293054612854666, 3.103323288681523, 6.2759000971676215, 7.834042931956886, 5.942718630720076, 11.492542926245564, 7.835897972249556, 8.560820739642272, 8.904075349232755, 6.968594039825617, 5.837829282873279, 4.968330469092385, 7.2391121282779265, 9.470850301198334, 7.760652969735039, 6.546080783733729, 6.081882775689101, 4.877937494922708, 9.012267422421427, 9.614865774973806, 7.143941592270088, 7.020736583702276, 6.453965486348487, 8.422233420910462, 6.378460062393016, 6.378865584657963, 0.9864094626724368, 4.629324057719977, 7.171302947320471, 1.0884388369540543, 6.540381773775315, 10.337521715975367, 7.431904701895002, 5.324787958137345, 6.34147272458964], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6747316914079706, "mean_inference_ms": 7.581284271075671, "mean_action_processing_ms": 0.6344025735926205, "mean_env_wait_ms": 28.305727025383625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02822279930114746, "StateBufferConnector_ms": 0.0401456356048584, "ViewRequirementAgentConnector_ms": 0.7504699230194092}}, "episode_reward_max": 11.855635575773709, "episode_reward_min": 0.9864094626724368, "episode_reward_mean": 6.503652780704974, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.1415260198096435, 7.661915281656673, 4.301162393431326, 8.713290317981228, 7.699682287026355, 6.2102964788940325, 6.939619558748735, 6.986404176668627, 3.9920004186721227, 6.48720395872614, 7.873977608328691, 5.469017543784997, 6.817324147082974, 8.893204735501358, 6.89333578403335, 9.024173469336523, 7.114323807779421, 4.23088628671347, 3.5615256035052547, 6.0770324656231445, 1.1561267029086655, 8.118154125626859, 6.703383458278758, 7.8429826218702905, 2.876017899651495, 6.347182487338127, 3.104638794882868, 9.184821840967636, 4.541779841919768, 6.800248143128126, 8.986592613335658, 5.940270205182136, 7.66045711158356, 3.537339802119938, 4.148425874083028, 1.4363258771667555, 11.855635575773709, 7.605565206027578, 4.31687674564281, 2.1658126602021364, 3.2461293968657183, 8.338362324680062, 7.284231658653075, 5.562175727788937, 9.356312117227382, 7.727720640776493, 3.1901770956447297, 7.950692851560612, 5.654176008114475, 1.0509089265465303, 3.0092806947417885, 7.439460602207216, 5.855303129458215, 10.407627063922982, 6.656727089141242, 6.854599516276036, 9.360999209610188, 9.243758703342783, 6.737914194713802, 8.347579925279684, 5.988293112278853, 7.163332762132596, 8.748724283679179, 6.657751820858547, 5.845972383186187, 7.293054612854666, 3.103323288681523, 6.2759000971676215, 7.834042931956886, 5.942718630720076, 11.492542926245564, 7.835897972249556, 8.560820739642272, 8.904075349232755, 6.968594039825617, 5.837829282873279, 4.968330469092385, 7.2391121282779265, 9.470850301198334, 7.760652969735039, 6.546080783733729, 6.081882775689101, 4.877937494922708, 9.012267422421427, 9.614865774973806, 7.143941592270088, 7.020736583702276, 6.453965486348487, 8.422233420910462, 6.378460062393016, 6.378865584657963, 0.9864094626724368, 4.629324057719977, 7.171302947320471, 1.0884388369540543, 6.540381773775315, 10.337521715975367, 7.431904701895002, 5.324787958137345, 6.34147272458964], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6747316914079706, "mean_inference_ms": 7.581284271075671, "mean_action_processing_ms": 0.6344025735926205, "mean_env_wait_ms": 28.305727025383625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02822279930114746, "StateBufferConnector_ms": 0.0401456356048584, "ViewRequirementAgentConnector_ms": 0.7504699230194092}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3744636, "num_agent_steps_trained": 3744636, "num_env_steps_sampled": 3744636, "num_env_steps_trained": 3744636, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 214.6004134618928, "num_env_steps_trained_throughput_per_sec": 214.6004134618928, "timesteps_total": 3744636, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3744636, "timers": {"training_iteration_time_ms": 66913.754, "sample_time_ms": 51071.795, "load_time_ms": 737.154, "load_throughput": 21214.007, "learn_time_ms": 14686.686, "learn_throughput": 1064.774, "synch_weights_time_ms": 385.793}, "counters": {"num_env_steps_sampled": 3744636, "num_env_steps_trained": 3744636, "num_agent_steps_sampled": 3744636, "num_agent_steps_trained": 3744636}, "done": false, "episodes_total": 1568, "training_iteration": 244, "trial_id": "c5092_00000", "date": "2025-06-08_11-30-37", "timestamp": 1749375037, "time_this_iter_s": 72.8861255645752, "time_total_s": 6579.6141176223755, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6579.6141176223755, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 81.61851851851851, "ram_util_percent": 51.598765432098766, "gpu_util_percent0": 0.06679012345679013, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.255364e-05, "total_loss": -0.09271077279022641, "policy_loss": -0.024772541694368225, "vf_loss": 0.012451980233361776, "vf_explained_var": 0.7828262603282928, "kl": 0.024583531453418996, "entropy": 20.969559766596014, "entropy_coeff": 0.003510728000000001}, "model": {}, "num_grad_updates_lifetime": 61875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3760274, "num_env_steps_trained": 3760274, "num_agent_steps_sampled": 3760274, "num_agent_steps_trained": 3760274}, "sampler_results": {"episode_reward_max": 11.855635575773709, "episode_reward_min": 0.9864094626724368, "episode_reward_mean": 6.51361220944894, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.89333578403335, 9.024173469336523, 7.114323807779421, 4.23088628671347, 3.5615256035052547, 6.0770324656231445, 1.1561267029086655, 8.118154125626859, 6.703383458278758, 7.8429826218702905, 2.876017899651495, 6.347182487338127, 3.104638794882868, 9.184821840967636, 4.541779841919768, 6.800248143128126, 8.986592613335658, 5.940270205182136, 7.66045711158356, 3.537339802119938, 4.148425874083028, 1.4363258771667555, 11.855635575773709, 7.605565206027578, 4.31687674564281, 2.1658126602021364, 3.2461293968657183, 8.338362324680062, 7.284231658653075, 5.562175727788937, 9.356312117227382, 7.727720640776493, 3.1901770956447297, 7.950692851560612, 5.654176008114475, 1.0509089265465303, 3.0092806947417885, 7.439460602207216, 5.855303129458215, 10.407627063922982, 6.656727089141242, 6.854599516276036, 9.360999209610188, 9.243758703342783, 6.737914194713802, 8.347579925279684, 5.988293112278853, 7.163332762132596, 8.748724283679179, 6.657751820858547, 5.845972383186187, 7.293054612854666, 3.103323288681523, 6.2759000971676215, 7.834042931956886, 5.942718630720076, 11.492542926245564, 7.835897972249556, 8.560820739642272, 8.904075349232755, 6.968594039825617, 5.837829282873279, 4.968330469092385, 7.2391121282779265, 9.470850301198334, 7.760652969735039, 6.546080783733729, 6.081882775689101, 4.877937494922708, 9.012267422421427, 9.614865774973806, 7.143941592270088, 7.020736583702276, 6.453965486348487, 8.422233420910462, 6.378460062393016, 6.378865584657963, 0.9864094626724368, 4.629324057719977, 7.171302947320471, 1.0884388369540543, 6.540381773775315, 10.337521715975367, 7.431904701895002, 5.324787958137345, 6.34147272458964, 9.174429272799875, 1.9761610326386572, 5.596646043345529, 7.16875252288799, 8.707605619933528, 8.09915489457136, 3.8113723106901203, 6.796800992194755, 7.637283842375259, 8.32547379255949, 6.258267055485625, 9.654450063544944, 2.617313287670475, 9.358857070011847], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6766188415473027, "mean_inference_ms": 7.593568943746168, "mean_action_processing_ms": 0.6358674091825907, "mean_env_wait_ms": 28.36572897937701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027210474014282227, "StateBufferConnector_ms": 0.03615832328796387, "ViewRequirementAgentConnector_ms": 0.775681734085083}}, "episode_reward_max": 11.855635575773709, "episode_reward_min": 0.9864094626724368, "episode_reward_mean": 6.51361220944894, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.89333578403335, 9.024173469336523, 7.114323807779421, 4.23088628671347, 3.5615256035052547, 6.0770324656231445, 1.1561267029086655, 8.118154125626859, 6.703383458278758, 7.8429826218702905, 2.876017899651495, 6.347182487338127, 3.104638794882868, 9.184821840967636, 4.541779841919768, 6.800248143128126, 8.986592613335658, 5.940270205182136, 7.66045711158356, 3.537339802119938, 4.148425874083028, 1.4363258771667555, 11.855635575773709, 7.605565206027578, 4.31687674564281, 2.1658126602021364, 3.2461293968657183, 8.338362324680062, 7.284231658653075, 5.562175727788937, 9.356312117227382, 7.727720640776493, 3.1901770956447297, 7.950692851560612, 5.654176008114475, 1.0509089265465303, 3.0092806947417885, 7.439460602207216, 5.855303129458215, 10.407627063922982, 6.656727089141242, 6.854599516276036, 9.360999209610188, 9.243758703342783, 6.737914194713802, 8.347579925279684, 5.988293112278853, 7.163332762132596, 8.748724283679179, 6.657751820858547, 5.845972383186187, 7.293054612854666, 3.103323288681523, 6.2759000971676215, 7.834042931956886, 5.942718630720076, 11.492542926245564, 7.835897972249556, 8.560820739642272, 8.904075349232755, 6.968594039825617, 5.837829282873279, 4.968330469092385, 7.2391121282779265, 9.470850301198334, 7.760652969735039, 6.546080783733729, 6.081882775689101, 4.877937494922708, 9.012267422421427, 9.614865774973806, 7.143941592270088, 7.020736583702276, 6.453965486348487, 8.422233420910462, 6.378460062393016, 6.378865584657963, 0.9864094626724368, 4.629324057719977, 7.171302947320471, 1.0884388369540543, 6.540381773775315, 10.337521715975367, 7.431904701895002, 5.324787958137345, 6.34147272458964, 9.174429272799875, 1.9761610326386572, 5.596646043345529, 7.16875252288799, 8.707605619933528, 8.09915489457136, 3.8113723106901203, 6.796800992194755, 7.637283842375259, 8.32547379255949, 6.258267055485625, 9.654450063544944, 2.617313287670475, 9.358857070011847], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6766188415473027, "mean_inference_ms": 7.593568943746168, "mean_action_processing_ms": 0.6358674091825907, "mean_env_wait_ms": 28.36572897937701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027210474014282227, "StateBufferConnector_ms": 0.03615832328796387, "ViewRequirementAgentConnector_ms": 0.775681734085083}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3760274, "num_agent_steps_trained": 3760274, "num_env_steps_sampled": 3760274, "num_env_steps_trained": 3760274, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 217.3946507457324, "num_env_steps_trained_throughput_per_sec": 217.3946507457324, "timesteps_total": 3760274, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3760274, "timers": {"training_iteration_time_ms": 67734.961, "sample_time_ms": 51808.378, "load_time_ms": 735.437, "load_throughput": 21263.539, "learn_time_ms": 14762.551, "learn_throughput": 1059.302, "synch_weights_time_ms": 396.482}, "counters": {"num_env_steps_sampled": 3760274, "num_env_steps_trained": 3760274, "num_agent_steps_sampled": 3760274, "num_agent_steps_trained": 3760274}, "done": false, "episodes_total": 1582, "training_iteration": 245, "trial_id": "c5092_00000", "date": "2025-06-08_11-31-49", "timestamp": 1749375109, "time_this_iter_s": 71.95070767402649, "time_total_s": 6651.564825296402, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6651.564825296402, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 81.07926829268293, "ram_util_percent": 51.3670731707317, "gpu_util_percent0": 0.06914634146341464, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.239726e-05, "total_loss": -0.10589151645821403, "policy_loss": -0.03839812879196622, "vf_loss": 0.013374358906241304, "vf_explained_var": 0.766751507954164, "kl": 0.023365833123312956, "entropy": 21.08204617587003, "entropy_coeff": 0.0034794520000000005}, "model": {}, "num_grad_updates_lifetime": 62425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3775912, "num_env_steps_trained": 3775912, "num_agent_steps_sampled": 3775912, "num_agent_steps_trained": 3775912}, "sampler_results": {"episode_reward_max": 11.855635575773709, "episode_reward_min": 0.9864094626724368, "episode_reward_mean": 6.530849678201784, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.541779841919768, 6.800248143128126, 8.986592613335658, 5.940270205182136, 7.66045711158356, 3.537339802119938, 4.148425874083028, 1.4363258771667555, 11.855635575773709, 7.605565206027578, 4.31687674564281, 2.1658126602021364, 3.2461293968657183, 8.338362324680062, 7.284231658653075, 5.562175727788937, 9.356312117227382, 7.727720640776493, 3.1901770956447297, 7.950692851560612, 5.654176008114475, 1.0509089265465303, 3.0092806947417885, 7.439460602207216, 5.855303129458215, 10.407627063922982, 6.656727089141242, 6.854599516276036, 9.360999209610188, 9.243758703342783, 6.737914194713802, 8.347579925279684, 5.988293112278853, 7.163332762132596, 8.748724283679179, 6.657751820858547, 5.845972383186187, 7.293054612854666, 3.103323288681523, 6.2759000971676215, 7.834042931956886, 5.942718630720076, 11.492542926245564, 7.835897972249556, 8.560820739642272, 8.904075349232755, 6.968594039825617, 5.837829282873279, 4.968330469092385, 7.2391121282779265, 9.470850301198334, 7.760652969735039, 6.546080783733729, 6.081882775689101, 4.877937494922708, 9.012267422421427, 9.614865774973806, 7.143941592270088, 7.020736583702276, 6.453965486348487, 8.422233420910462, 6.378460062393016, 6.378865584657963, 0.9864094626724368, 4.629324057719977, 7.171302947320471, 1.0884388369540543, 6.540381773775315, 10.337521715975367, 7.431904701895002, 5.324787958137345, 6.34147272458964, 9.174429272799875, 1.9761610326386572, 5.596646043345529, 7.16875252288799, 8.707605619933528, 8.09915489457136, 3.8113723106901203, 6.796800992194755, 7.637283842375259, 8.32547379255949, 6.258267055485625, 9.654450063544944, 2.617313287670475, 9.358857070011847, 7.495730150952544, 4.754910860441184, 4.724237138973497, 6.763087444335556, 6.647759578216378, 6.842334052189653, 6.96317966326361, 5.054351181097935, 6.241030910485813, 4.9881675164045465, 8.27415023699291, 5.726865352842306, 4.145754209837049, 5.3367739277673865], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6788076683088888, "mean_inference_ms": 7.607307598755683, "mean_action_processing_ms": 0.6374055986383248, "mean_env_wait_ms": 28.4259336929377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029217958450317383, "StateBufferConnector_ms": 0.031154155731201172, "ViewRequirementAgentConnector_ms": 0.7726876735687256}}, "episode_reward_max": 11.855635575773709, "episode_reward_min": 0.9864094626724368, "episode_reward_mean": 6.530849678201784, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.541779841919768, 6.800248143128126, 8.986592613335658, 5.940270205182136, 7.66045711158356, 3.537339802119938, 4.148425874083028, 1.4363258771667555, 11.855635575773709, 7.605565206027578, 4.31687674564281, 2.1658126602021364, 3.2461293968657183, 8.338362324680062, 7.284231658653075, 5.562175727788937, 9.356312117227382, 7.727720640776493, 3.1901770956447297, 7.950692851560612, 5.654176008114475, 1.0509089265465303, 3.0092806947417885, 7.439460602207216, 5.855303129458215, 10.407627063922982, 6.656727089141242, 6.854599516276036, 9.360999209610188, 9.243758703342783, 6.737914194713802, 8.347579925279684, 5.988293112278853, 7.163332762132596, 8.748724283679179, 6.657751820858547, 5.845972383186187, 7.293054612854666, 3.103323288681523, 6.2759000971676215, 7.834042931956886, 5.942718630720076, 11.492542926245564, 7.835897972249556, 8.560820739642272, 8.904075349232755, 6.968594039825617, 5.837829282873279, 4.968330469092385, 7.2391121282779265, 9.470850301198334, 7.760652969735039, 6.546080783733729, 6.081882775689101, 4.877937494922708, 9.012267422421427, 9.614865774973806, 7.143941592270088, 7.020736583702276, 6.453965486348487, 8.422233420910462, 6.378460062393016, 6.378865584657963, 0.9864094626724368, 4.629324057719977, 7.171302947320471, 1.0884388369540543, 6.540381773775315, 10.337521715975367, 7.431904701895002, 5.324787958137345, 6.34147272458964, 9.174429272799875, 1.9761610326386572, 5.596646043345529, 7.16875252288799, 8.707605619933528, 8.09915489457136, 3.8113723106901203, 6.796800992194755, 7.637283842375259, 8.32547379255949, 6.258267055485625, 9.654450063544944, 2.617313287670475, 9.358857070011847, 7.495730150952544, 4.754910860441184, 4.724237138973497, 6.763087444335556, 6.647759578216378, 6.842334052189653, 6.96317966326361, 5.054351181097935, 6.241030910485813, 4.9881675164045465, 8.27415023699291, 5.726865352842306, 4.145754209837049, 5.3367739277673865], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6788076683088888, "mean_inference_ms": 7.607307598755683, "mean_action_processing_ms": 0.6374055986383248, "mean_env_wait_ms": 28.4259336929377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029217958450317383, "StateBufferConnector_ms": 0.031154155731201172, "ViewRequirementAgentConnector_ms": 0.7726876735687256}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3775912, "num_agent_steps_trained": 3775912, "num_env_steps_sampled": 3775912, "num_env_steps_trained": 3775912, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 227.1506690357794, "num_env_steps_trained_throughput_per_sec": 227.1506690357794, "timesteps_total": 3775912, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3775912, "timers": {"training_iteration_time_ms": 68143.048, "sample_time_ms": 52182.948, "load_time_ms": 741.438, "load_throughput": 21091.453, "learn_time_ms": 14793.994, "learn_throughput": 1057.051, "synch_weights_time_ms": 394.585}, "counters": {"num_env_steps_sampled": 3775912, "num_env_steps_trained": 3775912, "num_agent_steps_sampled": 3775912, "num_agent_steps_trained": 3775912}, "done": false, "episodes_total": 1596, "training_iteration": 246, "trial_id": "c5092_00000", "date": "2025-06-08_11-32-58", "timestamp": 1749375178, "time_this_iter_s": 68.87210249900818, "time_total_s": 6720.43692779541, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6720.43692779541, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 80.73589743589744, "ram_util_percent": 51.266666666666666, "gpu_util_percent0": 0.0696153846153846, "vram_util_percent0": 0.18863932291666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.224088000000001e-05, "total_loss": -0.11501946867083793, "policy_loss": -0.04831315731508022, "vf_loss": 0.013769157224504109, "vf_explained_var": 0.7787177240848542, "kl": 0.0236793075104011, "entropy": 21.08654841336337, "entropy_coeff": 0.0034481760000000007}, "model": {}, "num_grad_updates_lifetime": 62975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3791550, "num_env_steps_trained": 3791550, "num_agent_steps_sampled": 3791550, "num_agent_steps_trained": 3791550}, "sampler_results": {"episode_reward_max": 11.492542926245564, "episode_reward_min": 0.9864094626724368, "episode_reward_mean": 6.508958767971194, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.284231658653075, 5.562175727788937, 9.356312117227382, 7.727720640776493, 3.1901770956447297, 7.950692851560612, 5.654176008114475, 1.0509089265465303, 3.0092806947417885, 7.439460602207216, 5.855303129458215, 10.407627063922982, 6.656727089141242, 6.854599516276036, 9.360999209610188, 9.243758703342783, 6.737914194713802, 8.347579925279684, 5.988293112278853, 7.163332762132596, 8.748724283679179, 6.657751820858547, 5.845972383186187, 7.293054612854666, 3.103323288681523, 6.2759000971676215, 7.834042931956886, 5.942718630720076, 11.492542926245564, 7.835897972249556, 8.560820739642272, 8.904075349232755, 6.968594039825617, 5.837829282873279, 4.968330469092385, 7.2391121282779265, 9.470850301198334, 7.760652969735039, 6.546080783733729, 6.081882775689101, 4.877937494922708, 9.012267422421427, 9.614865774973806, 7.143941592270088, 7.020736583702276, 6.453965486348487, 8.422233420910462, 6.378460062393016, 6.378865584657963, 0.9864094626724368, 4.629324057719977, 7.171302947320471, 1.0884388369540543, 6.540381773775315, 10.337521715975367, 7.431904701895002, 5.324787958137345, 6.34147272458964, 9.174429272799875, 1.9761610326386572, 5.596646043345529, 7.16875252288799, 8.707605619933528, 8.09915489457136, 3.8113723106901203, 6.796800992194755, 7.637283842375259, 8.32547379255949, 6.258267055485625, 9.654450063544944, 2.617313287670475, 9.358857070011847, 7.495730150952544, 4.754910860441184, 4.724237138973497, 6.763087444335556, 6.647759578216378, 6.842334052189653, 6.96317966326361, 5.054351181097935, 6.241030910485813, 4.9881675164045465, 8.27415023699291, 5.726865352842306, 4.145754209837049, 5.3367739277673865, 7.19753040598827, 7.456400467391662, 6.271368794606521, 1.664674169928649, 5.442185866909565, 6.327519511175855, 1.3051132017218878, 5.732243691733517, 3.214223749832143, 4.4604231423115595, 7.110513346973921, 7.231089253950026, 7.475277172664712, 7.50216757946356], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6810406582326272, "mean_inference_ms": 7.622617160507716, "mean_action_processing_ms": 0.639056115478683, "mean_env_wait_ms": 28.486767785961476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029160022735595703, "StateBufferConnector_ms": 0.025090932846069336, "ViewRequirementAgentConnector_ms": 0.7366831302642822}}, "episode_reward_max": 11.492542926245564, "episode_reward_min": 0.9864094626724368, "episode_reward_mean": 6.508958767971194, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.284231658653075, 5.562175727788937, 9.356312117227382, 7.727720640776493, 3.1901770956447297, 7.950692851560612, 5.654176008114475, 1.0509089265465303, 3.0092806947417885, 7.439460602207216, 5.855303129458215, 10.407627063922982, 6.656727089141242, 6.854599516276036, 9.360999209610188, 9.243758703342783, 6.737914194713802, 8.347579925279684, 5.988293112278853, 7.163332762132596, 8.748724283679179, 6.657751820858547, 5.845972383186187, 7.293054612854666, 3.103323288681523, 6.2759000971676215, 7.834042931956886, 5.942718630720076, 11.492542926245564, 7.835897972249556, 8.560820739642272, 8.904075349232755, 6.968594039825617, 5.837829282873279, 4.968330469092385, 7.2391121282779265, 9.470850301198334, 7.760652969735039, 6.546080783733729, 6.081882775689101, 4.877937494922708, 9.012267422421427, 9.614865774973806, 7.143941592270088, 7.020736583702276, 6.453965486348487, 8.422233420910462, 6.378460062393016, 6.378865584657963, 0.9864094626724368, 4.629324057719977, 7.171302947320471, 1.0884388369540543, 6.540381773775315, 10.337521715975367, 7.431904701895002, 5.324787958137345, 6.34147272458964, 9.174429272799875, 1.9761610326386572, 5.596646043345529, 7.16875252288799, 8.707605619933528, 8.09915489457136, 3.8113723106901203, 6.796800992194755, 7.637283842375259, 8.32547379255949, 6.258267055485625, 9.654450063544944, 2.617313287670475, 9.358857070011847, 7.495730150952544, 4.754910860441184, 4.724237138973497, 6.763087444335556, 6.647759578216378, 6.842334052189653, 6.96317966326361, 5.054351181097935, 6.241030910485813, 4.9881675164045465, 8.27415023699291, 5.726865352842306, 4.145754209837049, 5.3367739277673865, 7.19753040598827, 7.456400467391662, 6.271368794606521, 1.664674169928649, 5.442185866909565, 6.327519511175855, 1.3051132017218878, 5.732243691733517, 3.214223749832143, 4.4604231423115595, 7.110513346973921, 7.231089253950026, 7.475277172664712, 7.50216757946356], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6810406582326272, "mean_inference_ms": 7.622617160507716, "mean_action_processing_ms": 0.639056115478683, "mean_env_wait_ms": 28.486767785961476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029160022735595703, "StateBufferConnector_ms": 0.025090932846069336, "ViewRequirementAgentConnector_ms": 0.7366831302642822}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3791550, "num_agent_steps_trained": 3791550, "num_env_steps_sampled": 3791550, "num_env_steps_trained": 3791550, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 223.92491401389807, "num_env_steps_trained_throughput_per_sec": 223.92491401389807, "timesteps_total": 3791550, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3791550, "timers": {"training_iteration_time_ms": 68679.138, "sample_time_ms": 52621.806, "load_time_ms": 754.826, "load_throughput": 20717.347, "learn_time_ms": 14862.334, "learn_throughput": 1052.19, "synch_weights_time_ms": 409.733}, "counters": {"num_env_steps_sampled": 3791550, "num_env_steps_trained": 3791550, "num_agent_steps_sampled": 3791550, "num_agent_steps_trained": 3791550}, "done": false, "episodes_total": 1610, "training_iteration": 247, "trial_id": "c5092_00000", "date": "2025-06-08_11-34-08", "timestamp": 1749375248, "time_this_iter_s": 69.85954713821411, "time_total_s": 6790.296474933624, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6790.296474933624, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 81.11772151898734, "ram_util_percent": 51.248101265822775, "gpu_util_percent0": 0.07164556962025316, "vram_util_percent0": 0.18863932291666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.208449999999998e-05, "total_loss": -0.0950371526739433, "policy_loss": -0.029253582951390522, "vf_loss": 0.0131342547763647, "vf_explained_var": 0.764190218557011, "kl": 0.025044358705320485, "entropy": 20.98536473534324, "entropy_coeff": 0.0034169000000000005}, "model": {}, "num_grad_updates_lifetime": 63525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3807188, "num_env_steps_trained": 3807188, "num_agent_steps_sampled": 3807188, "num_agent_steps_trained": 3807188}, "sampler_results": {"episode_reward_max": 11.492542926245564, "episode_reward_min": 0.9864094626724368, "episode_reward_mean": 6.48336366916867, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.360999209610188, 9.243758703342783, 6.737914194713802, 8.347579925279684, 5.988293112278853, 7.163332762132596, 8.748724283679179, 6.657751820858547, 5.845972383186187, 7.293054612854666, 3.103323288681523, 6.2759000971676215, 7.834042931956886, 5.942718630720076, 11.492542926245564, 7.835897972249556, 8.560820739642272, 8.904075349232755, 6.968594039825617, 5.837829282873279, 4.968330469092385, 7.2391121282779265, 9.470850301198334, 7.760652969735039, 6.546080783733729, 6.081882775689101, 4.877937494922708, 9.012267422421427, 9.614865774973806, 7.143941592270088, 7.020736583702276, 6.453965486348487, 8.422233420910462, 6.378460062393016, 6.378865584657963, 0.9864094626724368, 4.629324057719977, 7.171302947320471, 1.0884388369540543, 6.540381773775315, 10.337521715975367, 7.431904701895002, 5.324787958137345, 6.34147272458964, 9.174429272799875, 1.9761610326386572, 5.596646043345529, 7.16875252288799, 8.707605619933528, 8.09915489457136, 3.8113723106901203, 6.796800992194755, 7.637283842375259, 8.32547379255949, 6.258267055485625, 9.654450063544944, 2.617313287670475, 9.358857070011847, 7.495730150952544, 4.754910860441184, 4.724237138973497, 6.763087444335556, 6.647759578216378, 6.842334052189653, 6.96317966326361, 5.054351181097935, 6.241030910485813, 4.9881675164045465, 8.27415023699291, 5.726865352842306, 4.145754209837049, 5.3367739277673865, 7.19753040598827, 7.456400467391662, 6.271368794606521, 1.664674169928649, 5.442185866909565, 6.327519511175855, 1.3051132017218878, 5.732243691733517, 3.214223749832143, 4.4604231423115595, 7.110513346973921, 7.231089253950026, 7.475277172664712, 7.50216757946356, 7.353362600869607, 3.274305047466048, 3.524061785532541, 5.862619418312776, 9.870376173145514, 6.0024303854533745, 8.779633151708794, 5.588584627518851, 7.543389930102901, 6.48617668527829, 5.895425141558397, 7.011708232158913, 1.0413263637776355, 7.2064836989237495], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6833879323526382, "mean_inference_ms": 7.639850411282104, "mean_action_processing_ms": 0.6408429647952802, "mean_env_wait_ms": 28.549145577025993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03070688247680664, "StateBufferConnector_ms": 0.0209808349609375, "ViewRequirementAgentConnector_ms": 0.7275364398956299}}, "episode_reward_max": 11.492542926245564, "episode_reward_min": 0.9864094626724368, "episode_reward_mean": 6.48336366916867, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.360999209610188, 9.243758703342783, 6.737914194713802, 8.347579925279684, 5.988293112278853, 7.163332762132596, 8.748724283679179, 6.657751820858547, 5.845972383186187, 7.293054612854666, 3.103323288681523, 6.2759000971676215, 7.834042931956886, 5.942718630720076, 11.492542926245564, 7.835897972249556, 8.560820739642272, 8.904075349232755, 6.968594039825617, 5.837829282873279, 4.968330469092385, 7.2391121282779265, 9.470850301198334, 7.760652969735039, 6.546080783733729, 6.081882775689101, 4.877937494922708, 9.012267422421427, 9.614865774973806, 7.143941592270088, 7.020736583702276, 6.453965486348487, 8.422233420910462, 6.378460062393016, 6.378865584657963, 0.9864094626724368, 4.629324057719977, 7.171302947320471, 1.0884388369540543, 6.540381773775315, 10.337521715975367, 7.431904701895002, 5.324787958137345, 6.34147272458964, 9.174429272799875, 1.9761610326386572, 5.596646043345529, 7.16875252288799, 8.707605619933528, 8.09915489457136, 3.8113723106901203, 6.796800992194755, 7.637283842375259, 8.32547379255949, 6.258267055485625, 9.654450063544944, 2.617313287670475, 9.358857070011847, 7.495730150952544, 4.754910860441184, 4.724237138973497, 6.763087444335556, 6.647759578216378, 6.842334052189653, 6.96317966326361, 5.054351181097935, 6.241030910485813, 4.9881675164045465, 8.27415023699291, 5.726865352842306, 4.145754209837049, 5.3367739277673865, 7.19753040598827, 7.456400467391662, 6.271368794606521, 1.664674169928649, 5.442185866909565, 6.327519511175855, 1.3051132017218878, 5.732243691733517, 3.214223749832143, 4.4604231423115595, 7.110513346973921, 7.231089253950026, 7.475277172664712, 7.50216757946356, 7.353362600869607, 3.274305047466048, 3.524061785532541, 5.862619418312776, 9.870376173145514, 6.0024303854533745, 8.779633151708794, 5.588584627518851, 7.543389930102901, 6.48617668527829, 5.895425141558397, 7.011708232158913, 1.0413263637776355, 7.2064836989237495], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6833879323526382, "mean_inference_ms": 7.639850411282104, "mean_action_processing_ms": 0.6408429647952802, "mean_env_wait_ms": 28.549145577025993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03070688247680664, "StateBufferConnector_ms": 0.0209808349609375, "ViewRequirementAgentConnector_ms": 0.7275364398956299}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3807188, "num_agent_steps_trained": 3807188, "num_env_steps_sampled": 3807188, "num_env_steps_trained": 3807188, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 226.70558857837716, "num_env_steps_trained_throughput_per_sec": 226.70558857837716, "timesteps_total": 3807188, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3807188, "timers": {"training_iteration_time_ms": 69106.417, "sample_time_ms": 53009.091, "load_time_ms": 759.208, "load_throughput": 20597.791, "learn_time_ms": 14896.835, "learn_throughput": 1049.753, "synch_weights_time_ms": 410.211}, "counters": {"num_env_steps_sampled": 3807188, "num_env_steps_trained": 3807188, "num_agent_steps_sampled": 3807188, "num_agent_steps_trained": 3807188}, "done": false, "episodes_total": 1624, "training_iteration": 248, "trial_id": "c5092_00000", "date": "2025-06-08_11-35-17", "timestamp": 1749375317, "time_this_iter_s": 68.99538660049438, "time_total_s": 6859.291861534119, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6859.291861534119, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 80.52692307692308, "ram_util_percent": 51.59999999999999, "gpu_util_percent0": 0.06756410256410256, "vram_util_percent0": 0.18863932291666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.192812e-05, "total_loss": -0.09426443006737496, "policy_loss": -0.028738867359034803, "vf_loss": 0.013207640940408138, "vf_explained_var": 0.7743246418779547, "kl": 0.02376401495343461, "entropy": 21.079608407454057, "entropy_coeff": 0.0033856240000000003}, "model": {}, "num_grad_updates_lifetime": 64075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3822826, "num_env_steps_trained": 3822826, "num_agent_steps_sampled": 3822826, "num_agent_steps_trained": 3822826}, "sampler_results": {"episode_reward_max": 11.492542926245564, "episode_reward_min": 0.9864094626724368, "episode_reward_mean": 6.338152747000378, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.492542926245564, 7.835897972249556, 8.560820739642272, 8.904075349232755, 6.968594039825617, 5.837829282873279, 4.968330469092385, 7.2391121282779265, 9.470850301198334, 7.760652969735039, 6.546080783733729, 6.081882775689101, 4.877937494922708, 9.012267422421427, 9.614865774973806, 7.143941592270088, 7.020736583702276, 6.453965486348487, 8.422233420910462, 6.378460062393016, 6.378865584657963, 0.9864094626724368, 4.629324057719977, 7.171302947320471, 1.0884388369540543, 6.540381773775315, 10.337521715975367, 7.431904701895002, 5.324787958137345, 6.34147272458964, 9.174429272799875, 1.9761610326386572, 5.596646043345529, 7.16875252288799, 8.707605619933528, 8.09915489457136, 3.8113723106901203, 6.796800992194755, 7.637283842375259, 8.32547379255949, 6.258267055485625, 9.654450063544944, 2.617313287670475, 9.358857070011847, 7.495730150952544, 4.754910860441184, 4.724237138973497, 6.763087444335556, 6.647759578216378, 6.842334052189653, 6.96317966326361, 5.054351181097935, 6.241030910485813, 4.9881675164045465, 8.27415023699291, 5.726865352842306, 4.145754209837049, 5.3367739277673865, 7.19753040598827, 7.456400467391662, 6.271368794606521, 1.664674169928649, 5.442185866909565, 6.327519511175855, 1.3051132017218878, 5.732243691733517, 3.214223749832143, 4.4604231423115595, 7.110513346973921, 7.231089253950026, 7.475277172664712, 7.50216757946356, 7.353362600869607, 3.274305047466048, 3.524061785532541, 5.862619418312776, 9.870376173145514, 6.0024303854533745, 8.779633151708794, 5.588584627518851, 7.543389930102901, 6.48617668527829, 5.895425141558397, 7.011708232158913, 1.0413263637776355, 7.2064836989237495, 4.596970120466119, 5.792351174704511, 3.870584778607858, 4.81613156495033, 6.9674475801223705, 5.836094783039906, 7.522571533588224, 7.850013443797263, 6.083352941238142, 4.448961249538272, 8.09597837469563, 8.014481313511562, 4.752709324053056, 5.374625557320126], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.686084753548291, "mean_inference_ms": 7.658191320869799, "mean_action_processing_ms": 0.6426999308564458, "mean_env_wait_ms": 28.610329532122563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03065633773803711, "StateBufferConnector_ms": 0.028043508529663086, "ViewRequirementAgentConnector_ms": 0.7557923793792725}}, "episode_reward_max": 11.492542926245564, "episode_reward_min": 0.9864094626724368, "episode_reward_mean": 6.338152747000378, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.492542926245564, 7.835897972249556, 8.560820739642272, 8.904075349232755, 6.968594039825617, 5.837829282873279, 4.968330469092385, 7.2391121282779265, 9.470850301198334, 7.760652969735039, 6.546080783733729, 6.081882775689101, 4.877937494922708, 9.012267422421427, 9.614865774973806, 7.143941592270088, 7.020736583702276, 6.453965486348487, 8.422233420910462, 6.378460062393016, 6.378865584657963, 0.9864094626724368, 4.629324057719977, 7.171302947320471, 1.0884388369540543, 6.540381773775315, 10.337521715975367, 7.431904701895002, 5.324787958137345, 6.34147272458964, 9.174429272799875, 1.9761610326386572, 5.596646043345529, 7.16875252288799, 8.707605619933528, 8.09915489457136, 3.8113723106901203, 6.796800992194755, 7.637283842375259, 8.32547379255949, 6.258267055485625, 9.654450063544944, 2.617313287670475, 9.358857070011847, 7.495730150952544, 4.754910860441184, 4.724237138973497, 6.763087444335556, 6.647759578216378, 6.842334052189653, 6.96317966326361, 5.054351181097935, 6.241030910485813, 4.9881675164045465, 8.27415023699291, 5.726865352842306, 4.145754209837049, 5.3367739277673865, 7.19753040598827, 7.456400467391662, 6.271368794606521, 1.664674169928649, 5.442185866909565, 6.327519511175855, 1.3051132017218878, 5.732243691733517, 3.214223749832143, 4.4604231423115595, 7.110513346973921, 7.231089253950026, 7.475277172664712, 7.50216757946356, 7.353362600869607, 3.274305047466048, 3.524061785532541, 5.862619418312776, 9.870376173145514, 6.0024303854533745, 8.779633151708794, 5.588584627518851, 7.543389930102901, 6.48617668527829, 5.895425141558397, 7.011708232158913, 1.0413263637776355, 7.2064836989237495, 4.596970120466119, 5.792351174704511, 3.870584778607858, 4.81613156495033, 6.9674475801223705, 5.836094783039906, 7.522571533588224, 7.850013443797263, 6.083352941238142, 4.448961249538272, 8.09597837469563, 8.014481313511562, 4.752709324053056, 5.374625557320126], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.686084753548291, "mean_inference_ms": 7.658191320869799, "mean_action_processing_ms": 0.6426999308564458, "mean_env_wait_ms": 28.610329532122563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03065633773803711, "StateBufferConnector_ms": 0.028043508529663086, "ViewRequirementAgentConnector_ms": 0.7557923793792725}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3822826, "num_agent_steps_trained": 3822826, "num_env_steps_sampled": 3822826, "num_env_steps_trained": 3822826, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 223.20821510720708, "num_env_steps_trained_throughput_per_sec": 223.20821510720708, "timesteps_total": 3822826, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3822826, "timers": {"training_iteration_time_ms": 69475.64, "sample_time_ms": 53362.456, "load_time_ms": 769.927, "load_throughput": 20311.016, "learn_time_ms": 14905.424, "learn_throughput": 1049.148, "synch_weights_time_ms": 408.703}, "counters": {"num_env_steps_sampled": 3822826, "num_env_steps_trained": 3822826, "num_agent_steps_sampled": 3822826, "num_agent_steps_trained": 3822826}, "done": false, "episodes_total": 1638, "training_iteration": 249, "trial_id": "c5092_00000", "date": "2025-06-08_11-36-27", "timestamp": 1749375387, "time_this_iter_s": 70.07214426994324, "time_total_s": 6929.364005804062, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6929.364005804062, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 80.95822784810129, "ram_util_percent": 51.61645569620253, "gpu_util_percent0": 0.06987341772151899, "vram_util_percent0": 0.18863932291666663}}
{"evaluation": {"sampler_results": {"episode_reward_max": -0.40134672095298496, "episode_reward_min": -4.458942783085522, "episode_reward_mean": -3.161782614712354, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.458942783085522, -3.9926172389020587, -3.7816177609523893, -3.1743885696688148, -0.40134672095298496], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3454845588917466, "mean_inference_ms": 3.8287669355124345, "mean_action_processing_ms": 0.3024815254114183, "mean_env_wait_ms": 12.78177702505052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.019998550415039062, "ViewRequirementAgentConnector_ms": 0.9115362167358398}}, "episode_reward_max": -0.40134672095298496, "episode_reward_min": -4.458942783085522, "episode_reward_mean": -3.161782614712354, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.458942783085522, -3.9926172389020587, -3.7816177609523893, -3.1743885696688148, -0.40134672095298496], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3454845588917466, "mean_inference_ms": 3.8287669355124345, "mean_action_processing_ms": 0.3024815254114183, "mean_env_wait_ms": 12.78177702505052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.019998550415039062, "ViewRequirementAgentConnector_ms": 0.9115362167358398}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.177174000000003e-05, "total_loss": -0.10919961134754969, "policy_loss": -0.0444942308987348, "vf_loss": 0.013282542544925077, "vf_explained_var": 0.7574894389239224, "kl": 0.02391565256454421, "entropy": 21.041916132840242, "entropy_coeff": 0.003354348}, "model": {}, "num_grad_updates_lifetime": 64625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3838464, "num_env_steps_trained": 3838464, "num_agent_steps_sampled": 3838464, "num_agent_steps_trained": 3838464}, "sampler_results": {"episode_reward_max": 10.337521715975367, "episode_reward_min": 0.10372827280038519, "episode_reward_mean": 6.090429765413189, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.614865774973806, 7.143941592270088, 7.020736583702276, 6.453965486348487, 8.422233420910462, 6.378460062393016, 6.378865584657963, 0.9864094626724368, 4.629324057719977, 7.171302947320471, 1.0884388369540543, 6.540381773775315, 10.337521715975367, 7.431904701895002, 5.324787958137345, 6.34147272458964, 9.174429272799875, 1.9761610326386572, 5.596646043345529, 7.16875252288799, 8.707605619933528, 8.09915489457136, 3.8113723106901203, 6.796800992194755, 7.637283842375259, 8.32547379255949, 6.258267055485625, 9.654450063544944, 2.617313287670475, 9.358857070011847, 7.495730150952544, 4.754910860441184, 4.724237138973497, 6.763087444335556, 6.647759578216378, 6.842334052189653, 6.96317966326361, 5.054351181097935, 6.241030910485813, 4.9881675164045465, 8.27415023699291, 5.726865352842306, 4.145754209837049, 5.3367739277673865, 7.19753040598827, 7.456400467391662, 6.271368794606521, 1.664674169928649, 5.442185866909565, 6.327519511175855, 1.3051132017218878, 5.732243691733517, 3.214223749832143, 4.4604231423115595, 7.110513346973921, 7.231089253950026, 7.475277172664712, 7.50216757946356, 7.353362600869607, 3.274305047466048, 3.524061785532541, 5.862619418312776, 9.870376173145514, 6.0024303854533745, 8.779633151708794, 5.588584627518851, 7.543389930102901, 6.48617668527829, 5.895425141558397, 7.011708232158913, 1.0413263637776355, 7.2064836989237495, 4.596970120466119, 5.792351174704511, 3.870584778607858, 4.81613156495033, 6.9674475801223705, 5.836094783039906, 7.522571533588224, 7.850013443797263, 6.083352941238142, 4.448961249538272, 8.09597837469563, 8.014481313511562, 4.752709324053056, 5.374625557320126, 4.868293747799298, 7.229614577912186, 8.491795717276922, 4.133834834989428, 7.526796144168401, 6.6702932097676415, 7.502393580895231, 6.610555175872363, 0.10372827280038519, 8.98349411910225, 6.943921785387693, 3.68494256729246, 3.6362378088526692, 4.398674954303839], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6887069368013605, "mean_inference_ms": 7.676743419761192, "mean_action_processing_ms": 0.6445669357852993, "mean_env_wait_ms": 28.667275316449967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028601884841918945, "StateBufferConnector_ms": 0.028056859970092773, "ViewRequirementAgentConnector_ms": 0.7743968963623047}}, "episode_reward_max": 10.337521715975367, "episode_reward_min": 0.10372827280038519, "episode_reward_mean": 6.090429765413189, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.614865774973806, 7.143941592270088, 7.020736583702276, 6.453965486348487, 8.422233420910462, 6.378460062393016, 6.378865584657963, 0.9864094626724368, 4.629324057719977, 7.171302947320471, 1.0884388369540543, 6.540381773775315, 10.337521715975367, 7.431904701895002, 5.324787958137345, 6.34147272458964, 9.174429272799875, 1.9761610326386572, 5.596646043345529, 7.16875252288799, 8.707605619933528, 8.09915489457136, 3.8113723106901203, 6.796800992194755, 7.637283842375259, 8.32547379255949, 6.258267055485625, 9.654450063544944, 2.617313287670475, 9.358857070011847, 7.495730150952544, 4.754910860441184, 4.724237138973497, 6.763087444335556, 6.647759578216378, 6.842334052189653, 6.96317966326361, 5.054351181097935, 6.241030910485813, 4.9881675164045465, 8.27415023699291, 5.726865352842306, 4.145754209837049, 5.3367739277673865, 7.19753040598827, 7.456400467391662, 6.271368794606521, 1.664674169928649, 5.442185866909565, 6.327519511175855, 1.3051132017218878, 5.732243691733517, 3.214223749832143, 4.4604231423115595, 7.110513346973921, 7.231089253950026, 7.475277172664712, 7.50216757946356, 7.353362600869607, 3.274305047466048, 3.524061785532541, 5.862619418312776, 9.870376173145514, 6.0024303854533745, 8.779633151708794, 5.588584627518851, 7.543389930102901, 6.48617668527829, 5.895425141558397, 7.011708232158913, 1.0413263637776355, 7.2064836989237495, 4.596970120466119, 5.792351174704511, 3.870584778607858, 4.81613156495033, 6.9674475801223705, 5.836094783039906, 7.522571533588224, 7.850013443797263, 6.083352941238142, 4.448961249538272, 8.09597837469563, 8.014481313511562, 4.752709324053056, 5.374625557320126, 4.868293747799298, 7.229614577912186, 8.491795717276922, 4.133834834989428, 7.526796144168401, 6.6702932097676415, 7.502393580895231, 6.610555175872363, 0.10372827280038519, 8.98349411910225, 6.943921785387693, 3.68494256729246, 3.6362378088526692, 4.398674954303839], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6887069368013605, "mean_inference_ms": 7.676743419761192, "mean_action_processing_ms": 0.6445669357852993, "mean_env_wait_ms": 28.667275316449967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028601884841918945, "StateBufferConnector_ms": 0.028056859970092773, "ViewRequirementAgentConnector_ms": 0.7743968963623047}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3838464, "num_agent_steps_trained": 3838464, "num_env_steps_sampled": 3838464, "num_env_steps_trained": 3838464, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 227.7845376421279, "num_env_steps_trained_throughput_per_sec": 227.7845376421279, "timesteps_total": 3838464, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3838464, "timers": {"training_iteration_time_ms": 69832.496, "sample_time_ms": 53671.314, "load_time_ms": 767.894, "load_throughput": 20364.778, "learn_time_ms": 14958.955, "learn_throughput": 1045.394, "synch_weights_time_ms": 405.79}, "counters": {"num_env_steps_sampled": 3838464, "num_env_steps_trained": 3838464, "num_agent_steps_sampled": 3838464, "num_agent_steps_trained": 3838464}, "done": false, "episodes_total": 1652, "training_iteration": 250, "trial_id": "c5092_00000", "date": "2025-06-08_11-37-56", "timestamp": 1749375476, "time_this_iter_s": 88.81273221969604, "time_total_s": 7018.176738023758, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7018.176738023758, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 67.50388349514562, "ram_util_percent": 51.59902912621357, "gpu_util_percent0": 0.056504854368932045, "vram_util_percent0": 0.18863932291666674}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.161535999999998e-05, "total_loss": -0.09546746610949577, "policy_loss": -0.031687974897213284, "vf_loss": 0.013628591441718692, "vf_explained_var": 0.7582813193581321, "kl": 0.02441361648795216, "entropy": 21.004426703019575, "entropy_coeff": 0.003323072}, "model": {}, "num_grad_updates_lifetime": 65175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3854102, "num_env_steps_trained": 3854102, "num_agent_steps_sampled": 3854102, "num_agent_steps_trained": 3854102}, "sampler_results": {"episode_reward_max": 10.219994424023033, "episode_reward_min": 0.10372827280038519, "episode_reward_mean": 6.093731541118082, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.324787958137345, 6.34147272458964, 9.174429272799875, 1.9761610326386572, 5.596646043345529, 7.16875252288799, 8.707605619933528, 8.09915489457136, 3.8113723106901203, 6.796800992194755, 7.637283842375259, 8.32547379255949, 6.258267055485625, 9.654450063544944, 2.617313287670475, 9.358857070011847, 7.495730150952544, 4.754910860441184, 4.724237138973497, 6.763087444335556, 6.647759578216378, 6.842334052189653, 6.96317966326361, 5.054351181097935, 6.241030910485813, 4.9881675164045465, 8.27415023699291, 5.726865352842306, 4.145754209837049, 5.3367739277673865, 7.19753040598827, 7.456400467391662, 6.271368794606521, 1.664674169928649, 5.442185866909565, 6.327519511175855, 1.3051132017218878, 5.732243691733517, 3.214223749832143, 4.4604231423115595, 7.110513346973921, 7.231089253950026, 7.475277172664712, 7.50216757946356, 7.353362600869607, 3.274305047466048, 3.524061785532541, 5.862619418312776, 9.870376173145514, 6.0024303854533745, 8.779633151708794, 5.588584627518851, 7.543389930102901, 6.48617668527829, 5.895425141558397, 7.011708232158913, 1.0413263637776355, 7.2064836989237495, 4.596970120466119, 5.792351174704511, 3.870584778607858, 4.81613156495033, 6.9674475801223705, 5.836094783039906, 7.522571533588224, 7.850013443797263, 6.083352941238142, 4.448961249538272, 8.09597837469563, 8.014481313511562, 4.752709324053056, 5.374625557320126, 4.868293747799298, 7.229614577912186, 8.491795717276922, 4.133834834989428, 7.526796144168401, 6.6702932097676415, 7.502393580895231, 6.610555175872363, 0.10372827280038519, 8.98349411910225, 6.943921785387693, 3.68494256729246, 3.6362378088526692, 4.398674954303839, 4.585409509054421, 1.1523637512815201, 8.346074291393478, 6.908521956545898, 6.005420622659301, 4.915736376165571, 8.225593310758807, 10.219994424023033, 6.048062024867451, 8.869049522263818, 8.566596044045028, 5.818196088345101, 5.403359797293778, 4.864151853360773], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6913487812885604, "mean_inference_ms": 7.695654977536576, "mean_action_processing_ms": 0.6464056511297591, "mean_env_wait_ms": 28.720518579943796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026633262634277344, "StateBufferConnector_ms": 0.033985137939453125, "ViewRequirementAgentConnector_ms": 0.7501966953277588}}, "episode_reward_max": 10.219994424023033, "episode_reward_min": 0.10372827280038519, "episode_reward_mean": 6.093731541118082, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.324787958137345, 6.34147272458964, 9.174429272799875, 1.9761610326386572, 5.596646043345529, 7.16875252288799, 8.707605619933528, 8.09915489457136, 3.8113723106901203, 6.796800992194755, 7.637283842375259, 8.32547379255949, 6.258267055485625, 9.654450063544944, 2.617313287670475, 9.358857070011847, 7.495730150952544, 4.754910860441184, 4.724237138973497, 6.763087444335556, 6.647759578216378, 6.842334052189653, 6.96317966326361, 5.054351181097935, 6.241030910485813, 4.9881675164045465, 8.27415023699291, 5.726865352842306, 4.145754209837049, 5.3367739277673865, 7.19753040598827, 7.456400467391662, 6.271368794606521, 1.664674169928649, 5.442185866909565, 6.327519511175855, 1.3051132017218878, 5.732243691733517, 3.214223749832143, 4.4604231423115595, 7.110513346973921, 7.231089253950026, 7.475277172664712, 7.50216757946356, 7.353362600869607, 3.274305047466048, 3.524061785532541, 5.862619418312776, 9.870376173145514, 6.0024303854533745, 8.779633151708794, 5.588584627518851, 7.543389930102901, 6.48617668527829, 5.895425141558397, 7.011708232158913, 1.0413263637776355, 7.2064836989237495, 4.596970120466119, 5.792351174704511, 3.870584778607858, 4.81613156495033, 6.9674475801223705, 5.836094783039906, 7.522571533588224, 7.850013443797263, 6.083352941238142, 4.448961249538272, 8.09597837469563, 8.014481313511562, 4.752709324053056, 5.374625557320126, 4.868293747799298, 7.229614577912186, 8.491795717276922, 4.133834834989428, 7.526796144168401, 6.6702932097676415, 7.502393580895231, 6.610555175872363, 0.10372827280038519, 8.98349411910225, 6.943921785387693, 3.68494256729246, 3.6362378088526692, 4.398674954303839, 4.585409509054421, 1.1523637512815201, 8.346074291393478, 6.908521956545898, 6.005420622659301, 4.915736376165571, 8.225593310758807, 10.219994424023033, 6.048062024867451, 8.869049522263818, 8.566596044045028, 5.818196088345101, 5.403359797293778, 4.864151853360773], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6913487812885604, "mean_inference_ms": 7.695654977536576, "mean_action_processing_ms": 0.6464056511297591, "mean_env_wait_ms": 28.720518579943796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026633262634277344, "StateBufferConnector_ms": 0.033985137939453125, "ViewRequirementAgentConnector_ms": 0.7501966953277588}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3854102, "num_agent_steps_trained": 3854102, "num_env_steps_sampled": 3854102, "num_env_steps_trained": 3854102, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 221.77453570508933, "num_env_steps_trained_throughput_per_sec": 221.77453570508933, "timesteps_total": 3854102, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3854102, "timers": {"training_iteration_time_ms": 70365.603, "sample_time_ms": 54173.527, "load_time_ms": 768.937, "load_throughput": 20337.157, "learn_time_ms": 14978.343, "learn_throughput": 1044.041, "synch_weights_time_ms": 416.087}, "counters": {"num_env_steps_sampled": 3854102, "num_env_steps_trained": 3854102, "num_agent_steps_sampled": 3854102, "num_agent_steps_trained": 3854102}, "done": false, "episodes_total": 1666, "training_iteration": 251, "trial_id": "c5092_00000", "date": "2025-06-08_11-39-07", "timestamp": 1749375547, "time_this_iter_s": 70.54516339302063, "time_total_s": 7088.721901416779, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7088.721901416779, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 80.98625000000001, "ram_util_percent": 51.78125, "gpu_util_percent0": 0.06937499999999999, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.145898000000001e-05, "total_loss": -0.09964681837199764, "policy_loss": -0.036674119226074914, "vf_loss": 0.012514255092987283, "vf_explained_var": 0.7663609710606661, "kl": 0.025620902932187606, "entropy": 20.886358098116787, "entropy_coeff": 0.0032917960000000005}, "model": {}, "num_grad_updates_lifetime": 65725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3869740, "num_env_steps_trained": 3869740, "num_agent_steps_sampled": 3869740, "num_agent_steps_trained": 3869740}, "sampler_results": {"episode_reward_max": 10.38206127964765, "episode_reward_min": 0.10372827280038519, "episode_reward_mean": 6.23283060025584, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.617313287670475, 9.358857070011847, 7.495730150952544, 4.754910860441184, 4.724237138973497, 6.763087444335556, 6.647759578216378, 6.842334052189653, 6.96317966326361, 5.054351181097935, 6.241030910485813, 4.9881675164045465, 8.27415023699291, 5.726865352842306, 4.145754209837049, 5.3367739277673865, 7.19753040598827, 7.456400467391662, 6.271368794606521, 1.664674169928649, 5.442185866909565, 6.327519511175855, 1.3051132017218878, 5.732243691733517, 3.214223749832143, 4.4604231423115595, 7.110513346973921, 7.231089253950026, 7.475277172664712, 7.50216757946356, 7.353362600869607, 3.274305047466048, 3.524061785532541, 5.862619418312776, 9.870376173145514, 6.0024303854533745, 8.779633151708794, 5.588584627518851, 7.543389930102901, 6.48617668527829, 5.895425141558397, 7.011708232158913, 1.0413263637776355, 7.2064836989237495, 4.596970120466119, 5.792351174704511, 3.870584778607858, 4.81613156495033, 6.9674475801223705, 5.836094783039906, 7.522571533588224, 7.850013443797263, 6.083352941238142, 4.448961249538272, 8.09597837469563, 8.014481313511562, 4.752709324053056, 5.374625557320126, 4.868293747799298, 7.229614577912186, 8.491795717276922, 4.133834834989428, 7.526796144168401, 6.6702932097676415, 7.502393580895231, 6.610555175872363, 0.10372827280038519, 8.98349411910225, 6.943921785387693, 3.68494256729246, 3.6362378088526692, 4.398674954303839, 4.585409509054421, 1.1523637512815201, 8.346074291393478, 6.908521956545898, 6.005420622659301, 4.915736376165571, 8.225593310758807, 10.219994424023033, 6.048062024867451, 8.869049522263818, 8.566596044045028, 5.818196088345101, 5.403359797293778, 4.864151853360773, 7.69086401085176, 10.316079421448723, 10.358018128681417, 6.4249378874021765, 8.896634244751967, 7.493438173597641, 8.60462754002123, 6.869927690056333, 6.044803369020392, 10.38206127964765, 8.557101708405352, 5.608714522054915, 4.956338584169146, 6.579017479421401], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.693779410948836, "mean_inference_ms": 7.713481214473306, "mean_action_processing_ms": 0.6481678066876444, "mean_env_wait_ms": 28.77141789412727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027645111083984375, "StateBufferConnector_ms": 0.03600955009460449, "ViewRequirementAgentConnector_ms": 0.7483904361724854}}, "episode_reward_max": 10.38206127964765, "episode_reward_min": 0.10372827280038519, "episode_reward_mean": 6.23283060025584, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.617313287670475, 9.358857070011847, 7.495730150952544, 4.754910860441184, 4.724237138973497, 6.763087444335556, 6.647759578216378, 6.842334052189653, 6.96317966326361, 5.054351181097935, 6.241030910485813, 4.9881675164045465, 8.27415023699291, 5.726865352842306, 4.145754209837049, 5.3367739277673865, 7.19753040598827, 7.456400467391662, 6.271368794606521, 1.664674169928649, 5.442185866909565, 6.327519511175855, 1.3051132017218878, 5.732243691733517, 3.214223749832143, 4.4604231423115595, 7.110513346973921, 7.231089253950026, 7.475277172664712, 7.50216757946356, 7.353362600869607, 3.274305047466048, 3.524061785532541, 5.862619418312776, 9.870376173145514, 6.0024303854533745, 8.779633151708794, 5.588584627518851, 7.543389930102901, 6.48617668527829, 5.895425141558397, 7.011708232158913, 1.0413263637776355, 7.2064836989237495, 4.596970120466119, 5.792351174704511, 3.870584778607858, 4.81613156495033, 6.9674475801223705, 5.836094783039906, 7.522571533588224, 7.850013443797263, 6.083352941238142, 4.448961249538272, 8.09597837469563, 8.014481313511562, 4.752709324053056, 5.374625557320126, 4.868293747799298, 7.229614577912186, 8.491795717276922, 4.133834834989428, 7.526796144168401, 6.6702932097676415, 7.502393580895231, 6.610555175872363, 0.10372827280038519, 8.98349411910225, 6.943921785387693, 3.68494256729246, 3.6362378088526692, 4.398674954303839, 4.585409509054421, 1.1523637512815201, 8.346074291393478, 6.908521956545898, 6.005420622659301, 4.915736376165571, 8.225593310758807, 10.219994424023033, 6.048062024867451, 8.869049522263818, 8.566596044045028, 5.818196088345101, 5.403359797293778, 4.864151853360773, 7.69086401085176, 10.316079421448723, 10.358018128681417, 6.4249378874021765, 8.896634244751967, 7.493438173597641, 8.60462754002123, 6.869927690056333, 6.044803369020392, 10.38206127964765, 8.557101708405352, 5.608714522054915, 4.956338584169146, 6.579017479421401], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.693779410948836, "mean_inference_ms": 7.713481214473306, "mean_action_processing_ms": 0.6481678066876444, "mean_env_wait_ms": 28.77141789412727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027645111083984375, "StateBufferConnector_ms": 0.03600955009460449, "ViewRequirementAgentConnector_ms": 0.7483904361724854}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3869740, "num_agent_steps_trained": 3869740, "num_env_steps_sampled": 3869740, "num_env_steps_trained": 3869740, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 225.902634809528, "num_env_steps_trained_throughput_per_sec": 225.902634809528, "timesteps_total": 3869740, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3869740, "timers": {"training_iteration_time_ms": 70294.349, "sample_time_ms": 54188.632, "load_time_ms": 774.086, "load_throughput": 20201.879, "learn_time_ms": 14895.686, "learn_throughput": 1049.834, "synch_weights_time_ms": 408.057}, "counters": {"num_env_steps_sampled": 3869740, "num_env_steps_trained": 3869740, "num_agent_steps_sampled": 3869740, "num_agent_steps_trained": 3869740}, "done": false, "episodes_total": 1680, "training_iteration": 252, "trial_id": "c5092_00000", "date": "2025-06-08_11-40-16", "timestamp": 1749375616, "time_this_iter_s": 69.24152612686157, "time_total_s": 7157.96342754364, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7157.96342754364, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 80.41666666666666, "ram_util_percent": 51.23974358974359, "gpu_util_percent0": 0.06910256410256412, "vram_util_percent0": 0.18863932291666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.13026e-05, "total_loss": -0.0948058263359549, "policy_loss": -0.032103959464849056, "vf_loss": 0.013049178356728093, "vf_explained_var": 0.7790664300051603, "kl": 0.024049039941485238, "entropy": 21.014726874611593, "entropy_coeff": 0.0032605199999999994}, "model": {}, "num_grad_updates_lifetime": 66275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3885378, "num_env_steps_trained": 3885378, "num_agent_steps_sampled": 3885378, "num_agent_steps_trained": 3885378}, "sampler_results": {"episode_reward_max": 10.38206127964765, "episode_reward_min": -1.4473349077796944, "episode_reward_mean": 6.262883317168307, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.145754209837049, 5.3367739277673865, 7.19753040598827, 7.456400467391662, 6.271368794606521, 1.664674169928649, 5.442185866909565, 6.327519511175855, 1.3051132017218878, 5.732243691733517, 3.214223749832143, 4.4604231423115595, 7.110513346973921, 7.231089253950026, 7.475277172664712, 7.50216757946356, 7.353362600869607, 3.274305047466048, 3.524061785532541, 5.862619418312776, 9.870376173145514, 6.0024303854533745, 8.779633151708794, 5.588584627518851, 7.543389930102901, 6.48617668527829, 5.895425141558397, 7.011708232158913, 1.0413263637776355, 7.2064836989237495, 4.596970120466119, 5.792351174704511, 3.870584778607858, 4.81613156495033, 6.9674475801223705, 5.836094783039906, 7.522571533588224, 7.850013443797263, 6.083352941238142, 4.448961249538272, 8.09597837469563, 8.014481313511562, 4.752709324053056, 5.374625557320126, 4.868293747799298, 7.229614577912186, 8.491795717276922, 4.133834834989428, 7.526796144168401, 6.6702932097676415, 7.502393580895231, 6.610555175872363, 0.10372827280038519, 8.98349411910225, 6.943921785387693, 3.68494256729246, 3.6362378088526692, 4.398674954303839, 4.585409509054421, 1.1523637512815201, 8.346074291393478, 6.908521956545898, 6.005420622659301, 4.915736376165571, 8.225593310758807, 10.219994424023033, 6.048062024867451, 8.869049522263818, 8.566596044045028, 5.818196088345101, 5.403359797293778, 4.864151853360773, 7.69086401085176, 10.316079421448723, 10.358018128681417, 6.4249378874021765, 8.896634244751967, 7.493438173597641, 8.60462754002123, 6.869927690056333, 6.044803369020392, 10.38206127964765, 8.557101708405352, 5.608714522054915, 4.956338584169146, 6.579017479421401, 3.4040233274423666, 7.820087694599941, 6.241223595674777, 9.765609926235784, 6.72625411570949, 8.679700061173625, 8.08872800641856, 9.68535899062292, 9.18554219954176, 5.9267712198317355, -1.4473349077796944, 3.1099956532351265, 5.885759050097722, 6.385527202320767], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6959745356157896, "mean_inference_ms": 7.730915494199405, "mean_action_processing_ms": 0.6499149549448763, "mean_env_wait_ms": 28.821633794790323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031717538833618164, "StateBufferConnector_ms": 0.04513835906982422, "ViewRequirementAgentConnector_ms": 0.7511138916015625}}, "episode_reward_max": 10.38206127964765, "episode_reward_min": -1.4473349077796944, "episode_reward_mean": 6.262883317168307, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.145754209837049, 5.3367739277673865, 7.19753040598827, 7.456400467391662, 6.271368794606521, 1.664674169928649, 5.442185866909565, 6.327519511175855, 1.3051132017218878, 5.732243691733517, 3.214223749832143, 4.4604231423115595, 7.110513346973921, 7.231089253950026, 7.475277172664712, 7.50216757946356, 7.353362600869607, 3.274305047466048, 3.524061785532541, 5.862619418312776, 9.870376173145514, 6.0024303854533745, 8.779633151708794, 5.588584627518851, 7.543389930102901, 6.48617668527829, 5.895425141558397, 7.011708232158913, 1.0413263637776355, 7.2064836989237495, 4.596970120466119, 5.792351174704511, 3.870584778607858, 4.81613156495033, 6.9674475801223705, 5.836094783039906, 7.522571533588224, 7.850013443797263, 6.083352941238142, 4.448961249538272, 8.09597837469563, 8.014481313511562, 4.752709324053056, 5.374625557320126, 4.868293747799298, 7.229614577912186, 8.491795717276922, 4.133834834989428, 7.526796144168401, 6.6702932097676415, 7.502393580895231, 6.610555175872363, 0.10372827280038519, 8.98349411910225, 6.943921785387693, 3.68494256729246, 3.6362378088526692, 4.398674954303839, 4.585409509054421, 1.1523637512815201, 8.346074291393478, 6.908521956545898, 6.005420622659301, 4.915736376165571, 8.225593310758807, 10.219994424023033, 6.048062024867451, 8.869049522263818, 8.566596044045028, 5.818196088345101, 5.403359797293778, 4.864151853360773, 7.69086401085176, 10.316079421448723, 10.358018128681417, 6.4249378874021765, 8.896634244751967, 7.493438173597641, 8.60462754002123, 6.869927690056333, 6.044803369020392, 10.38206127964765, 8.557101708405352, 5.608714522054915, 4.956338584169146, 6.579017479421401, 3.4040233274423666, 7.820087694599941, 6.241223595674777, 9.765609926235784, 6.72625411570949, 8.679700061173625, 8.08872800641856, 9.68535899062292, 9.18554219954176, 5.9267712198317355, -1.4473349077796944, 3.1099956532351265, 5.885759050097722, 6.385527202320767], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6959745356157896, "mean_inference_ms": 7.730915494199405, "mean_action_processing_ms": 0.6499149549448763, "mean_env_wait_ms": 28.821633794790323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031717538833618164, "StateBufferConnector_ms": 0.04513835906982422, "ViewRequirementAgentConnector_ms": 0.7511138916015625}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3885378, "num_agent_steps_trained": 3885378, "num_env_steps_sampled": 3885378, "num_env_steps_trained": 3885378, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 221.91732811811832, "num_env_steps_trained_throughput_per_sec": 221.91732811811832, "timesteps_total": 3885378, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3885378, "timers": {"training_iteration_time_ms": 70138.142, "sample_time_ms": 53942.422, "load_time_ms": 756.564, "load_throughput": 20669.771, "learn_time_ms": 14983.224, "learn_throughput": 1043.701, "synch_weights_time_ms": 427.347}, "counters": {"num_env_steps_sampled": 3885378, "num_env_steps_trained": 3885378, "num_agent_steps_sampled": 3885378, "num_agent_steps_trained": 3885378}, "done": false, "episodes_total": 1694, "training_iteration": 253, "trial_id": "c5092_00000", "date": "2025-06-08_11-41-27", "timestamp": 1749375687, "time_this_iter_s": 70.49368786811829, "time_total_s": 7228.457115411758, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7228.457115411758, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 80.35875, "ram_util_percent": 50.83375, "gpu_util_percent0": 0.071875, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.114621999999999e-05, "total_loss": -0.09725845911238469, "policy_loss": -0.035898544684856794, "vf_loss": 0.015099792848341167, "vf_explained_var": 0.7702298214218833, "kl": 0.02379161763195078, "entropy": 20.986896376176315, "entropy_coeff": 0.0032292439999999996}, "model": {}, "num_grad_updates_lifetime": 66825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3901016, "num_env_steps_trained": 3901016, "num_agent_steps_sampled": 3901016, "num_agent_steps_trained": 3901016}, "sampler_results": {"episode_reward_max": 10.38206127964765, "episode_reward_min": -1.4473349077796944, "episode_reward_mean": 6.362050225052527, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.475277172664712, 7.50216757946356, 7.353362600869607, 3.274305047466048, 3.524061785532541, 5.862619418312776, 9.870376173145514, 6.0024303854533745, 8.779633151708794, 5.588584627518851, 7.543389930102901, 6.48617668527829, 5.895425141558397, 7.011708232158913, 1.0413263637776355, 7.2064836989237495, 4.596970120466119, 5.792351174704511, 3.870584778607858, 4.81613156495033, 6.9674475801223705, 5.836094783039906, 7.522571533588224, 7.850013443797263, 6.083352941238142, 4.448961249538272, 8.09597837469563, 8.014481313511562, 4.752709324053056, 5.374625557320126, 4.868293747799298, 7.229614577912186, 8.491795717276922, 4.133834834989428, 7.526796144168401, 6.6702932097676415, 7.502393580895231, 6.610555175872363, 0.10372827280038519, 8.98349411910225, 6.943921785387693, 3.68494256729246, 3.6362378088526692, 4.398674954303839, 4.585409509054421, 1.1523637512815201, 8.346074291393478, 6.908521956545898, 6.005420622659301, 4.915736376165571, 8.225593310758807, 10.219994424023033, 6.048062024867451, 8.869049522263818, 8.566596044045028, 5.818196088345101, 5.403359797293778, 4.864151853360773, 7.69086401085176, 10.316079421448723, 10.358018128681417, 6.4249378874021765, 8.896634244751967, 7.493438173597641, 8.60462754002123, 6.869927690056333, 6.044803369020392, 10.38206127964765, 8.557101708405352, 5.608714522054915, 4.956338584169146, 6.579017479421401, 3.4040233274423666, 7.820087694599941, 6.241223595674777, 9.765609926235784, 6.72625411570949, 8.679700061173625, 8.08872800641856, 9.68535899062292, 9.18554219954176, 5.9267712198317355, -1.4473349077796944, 3.1099956532351265, 5.885759050097722, 6.385527202320767, 5.221025147551248, 5.784336871296869, 3.643590174498263, 8.54892093738201, 2.778779839429617, 9.68778649458887, 3.868679105734419, 8.827249763251146, 9.394324622693789, 5.641247008143924, 6.513715554414921, 4.697467048750592, 7.628774857225916, 0.5766071035884782], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6981179204396097, "mean_inference_ms": 7.748434723279497, "mean_action_processing_ms": 0.6516673935479735, "mean_env_wait_ms": 28.872519205736776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028705835342407227, "StateBufferConnector_ms": 0.05068016052246094, "ViewRequirementAgentConnector_ms": 0.7442412376403809}}, "episode_reward_max": 10.38206127964765, "episode_reward_min": -1.4473349077796944, "episode_reward_mean": 6.362050225052527, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.475277172664712, 7.50216757946356, 7.353362600869607, 3.274305047466048, 3.524061785532541, 5.862619418312776, 9.870376173145514, 6.0024303854533745, 8.779633151708794, 5.588584627518851, 7.543389930102901, 6.48617668527829, 5.895425141558397, 7.011708232158913, 1.0413263637776355, 7.2064836989237495, 4.596970120466119, 5.792351174704511, 3.870584778607858, 4.81613156495033, 6.9674475801223705, 5.836094783039906, 7.522571533588224, 7.850013443797263, 6.083352941238142, 4.448961249538272, 8.09597837469563, 8.014481313511562, 4.752709324053056, 5.374625557320126, 4.868293747799298, 7.229614577912186, 8.491795717276922, 4.133834834989428, 7.526796144168401, 6.6702932097676415, 7.502393580895231, 6.610555175872363, 0.10372827280038519, 8.98349411910225, 6.943921785387693, 3.68494256729246, 3.6362378088526692, 4.398674954303839, 4.585409509054421, 1.1523637512815201, 8.346074291393478, 6.908521956545898, 6.005420622659301, 4.915736376165571, 8.225593310758807, 10.219994424023033, 6.048062024867451, 8.869049522263818, 8.566596044045028, 5.818196088345101, 5.403359797293778, 4.864151853360773, 7.69086401085176, 10.316079421448723, 10.358018128681417, 6.4249378874021765, 8.896634244751967, 7.493438173597641, 8.60462754002123, 6.869927690056333, 6.044803369020392, 10.38206127964765, 8.557101708405352, 5.608714522054915, 4.956338584169146, 6.579017479421401, 3.4040233274423666, 7.820087694599941, 6.241223595674777, 9.765609926235784, 6.72625411570949, 8.679700061173625, 8.08872800641856, 9.68535899062292, 9.18554219954176, 5.9267712198317355, -1.4473349077796944, 3.1099956532351265, 5.885759050097722, 6.385527202320767, 5.221025147551248, 5.784336871296869, 3.643590174498263, 8.54892093738201, 2.778779839429617, 9.68778649458887, 3.868679105734419, 8.827249763251146, 9.394324622693789, 5.641247008143924, 6.513715554414921, 4.697467048750592, 7.628774857225916, 0.5766071035884782], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6981179204396097, "mean_inference_ms": 7.748434723279497, "mean_action_processing_ms": 0.6516673935479735, "mean_env_wait_ms": 28.872519205736776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028705835342407227, "StateBufferConnector_ms": 0.05068016052246094, "ViewRequirementAgentConnector_ms": 0.7442412376403809}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3901016, "num_agent_steps_trained": 3901016, "num_env_steps_sampled": 3901016, "num_env_steps_trained": 3901016, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 217.7975561683074, "num_env_steps_trained_throughput_per_sec": 217.7975561683074, "timesteps_total": 3901016, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3901016, "timers": {"training_iteration_time_ms": 70031.172, "sample_time_ms": 53821.738, "load_time_ms": 752.49, "load_throughput": 20781.676, "learn_time_ms": 15006.984, "learn_throughput": 1042.048, "synch_weights_time_ms": 421.789}, "counters": {"num_env_steps_sampled": 3901016, "num_env_steps_trained": 3901016, "num_agent_steps_sampled": 3901016, "num_agent_steps_trained": 3901016}, "done": false, "episodes_total": 1708, "training_iteration": 254, "trial_id": "c5092_00000", "date": "2025-06-08_11-42-38", "timestamp": 1749375758, "time_this_iter_s": 71.82116889953613, "time_total_s": 7300.278284311295, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7300.278284311295, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 81.07901234567902, "ram_util_percent": 50.82469135802468, "gpu_util_percent0": 0.0728395061728395, "vram_util_percent0": 0.18863932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.098984000000002e-05, "total_loss": -0.09897933598882942, "policy_loss": -0.03796269179485865, "vf_loss": 0.014915720985525033, "vf_explained_var": 0.7649128272316673, "kl": 0.02382620843385562, "entropy": 21.068394598527387, "entropy_coeff": 0.0031979679999999994}, "model": {}, "num_grad_updates_lifetime": 67375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3916654, "num_env_steps_trained": 3916654, "num_agent_steps_sampled": 3916654, "num_agent_steps_trained": 3916654}, "sampler_results": {"episode_reward_max": 10.38206127964765, "episode_reward_min": -1.4473349077796944, "episode_reward_mean": 6.292927574579926, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0413263637776355, 7.2064836989237495, 4.596970120466119, 5.792351174704511, 3.870584778607858, 4.81613156495033, 6.9674475801223705, 5.836094783039906, 7.522571533588224, 7.850013443797263, 6.083352941238142, 4.448961249538272, 8.09597837469563, 8.014481313511562, 4.752709324053056, 5.374625557320126, 4.868293747799298, 7.229614577912186, 8.491795717276922, 4.133834834989428, 7.526796144168401, 6.6702932097676415, 7.502393580895231, 6.610555175872363, 0.10372827280038519, 8.98349411910225, 6.943921785387693, 3.68494256729246, 3.6362378088526692, 4.398674954303839, 4.585409509054421, 1.1523637512815201, 8.346074291393478, 6.908521956545898, 6.005420622659301, 4.915736376165571, 8.225593310758807, 10.219994424023033, 6.048062024867451, 8.869049522263818, 8.566596044045028, 5.818196088345101, 5.403359797293778, 4.864151853360773, 7.69086401085176, 10.316079421448723, 10.358018128681417, 6.4249378874021765, 8.896634244751967, 7.493438173597641, 8.60462754002123, 6.869927690056333, 6.044803369020392, 10.38206127964765, 8.557101708405352, 5.608714522054915, 4.956338584169146, 6.579017479421401, 3.4040233274423666, 7.820087694599941, 6.241223595674777, 9.765609926235784, 6.72625411570949, 8.679700061173625, 8.08872800641856, 9.68535899062292, 9.18554219954176, 5.9267712198317355, -1.4473349077796944, 3.1099956532351265, 5.885759050097722, 6.385527202320767, 5.221025147551248, 5.784336871296869, 3.643590174498263, 8.54892093738201, 2.778779839429617, 9.68778649458887, 3.868679105734419, 8.827249763251146, 9.394324622693789, 5.641247008143924, 6.513715554414921, 4.697467048750592, 7.628774857225916, 0.5766071035884782, 6.881736691915166, 9.179517149753172, 5.460696920679577, 5.538098976469248, 1.251033026617898, 5.783257092131426, 7.704607895429443, 5.082305566901233, 3.6127444757340936, 8.625541695976706, 7.292843014725511, 6.767212902734501, 6.809335410528683, 5.268322064377317], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7003895164009295, "mean_inference_ms": 7.765458883803753, "mean_action_processing_ms": 0.6533737089210184, "mean_env_wait_ms": 28.922984574076292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024120092391967773, "StateBufferConnector_ms": 0.05068182945251465, "ViewRequirementAgentConnector_ms": 0.7473618984222412}}, "episode_reward_max": 10.38206127964765, "episode_reward_min": -1.4473349077796944, "episode_reward_mean": 6.292927574579926, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.0413263637776355, 7.2064836989237495, 4.596970120466119, 5.792351174704511, 3.870584778607858, 4.81613156495033, 6.9674475801223705, 5.836094783039906, 7.522571533588224, 7.850013443797263, 6.083352941238142, 4.448961249538272, 8.09597837469563, 8.014481313511562, 4.752709324053056, 5.374625557320126, 4.868293747799298, 7.229614577912186, 8.491795717276922, 4.133834834989428, 7.526796144168401, 6.6702932097676415, 7.502393580895231, 6.610555175872363, 0.10372827280038519, 8.98349411910225, 6.943921785387693, 3.68494256729246, 3.6362378088526692, 4.398674954303839, 4.585409509054421, 1.1523637512815201, 8.346074291393478, 6.908521956545898, 6.005420622659301, 4.915736376165571, 8.225593310758807, 10.219994424023033, 6.048062024867451, 8.869049522263818, 8.566596044045028, 5.818196088345101, 5.403359797293778, 4.864151853360773, 7.69086401085176, 10.316079421448723, 10.358018128681417, 6.4249378874021765, 8.896634244751967, 7.493438173597641, 8.60462754002123, 6.869927690056333, 6.044803369020392, 10.38206127964765, 8.557101708405352, 5.608714522054915, 4.956338584169146, 6.579017479421401, 3.4040233274423666, 7.820087694599941, 6.241223595674777, 9.765609926235784, 6.72625411570949, 8.679700061173625, 8.08872800641856, 9.68535899062292, 9.18554219954176, 5.9267712198317355, -1.4473349077796944, 3.1099956532351265, 5.885759050097722, 6.385527202320767, 5.221025147551248, 5.784336871296869, 3.643590174498263, 8.54892093738201, 2.778779839429617, 9.68778649458887, 3.868679105734419, 8.827249763251146, 9.394324622693789, 5.641247008143924, 6.513715554414921, 4.697467048750592, 7.628774857225916, 0.5766071035884782, 6.881736691915166, 9.179517149753172, 5.460696920679577, 5.538098976469248, 1.251033026617898, 5.783257092131426, 7.704607895429443, 5.082305566901233, 3.6127444757340936, 8.625541695976706, 7.292843014725511, 6.767212902734501, 6.809335410528683, 5.268322064377317], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7003895164009295, "mean_inference_ms": 7.765458883803753, "mean_action_processing_ms": 0.6533737089210184, "mean_env_wait_ms": 28.922984574076292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024120092391967773, "StateBufferConnector_ms": 0.05068182945251465, "ViewRequirementAgentConnector_ms": 0.7473618984222412}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3916654, "num_agent_steps_trained": 3916654, "num_env_steps_sampled": 3916654, "num_env_steps_trained": 3916654, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 223.0355526837545, "num_env_steps_trained_throughput_per_sec": 223.0355526837545, "timesteps_total": 3916654, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3916654, "timers": {"training_iteration_time_ms": 69849.241, "sample_time_ms": 53662.354, "load_time_ms": 749.783, "load_throughput": 20856.7, "learn_time_ms": 14991.985, "learn_throughput": 1043.091, "synch_weights_time_ms": 417.447}, "counters": {"num_env_steps_sampled": 3916654, "num_env_steps_trained": 3916654, "num_agent_steps_sampled": 3916654, "num_agent_steps_trained": 3916654}, "done": false, "episodes_total": 1722, "training_iteration": 255, "trial_id": "c5092_00000", "date": "2025-06-08_11-43-49", "timestamp": 1749375829, "time_this_iter_s": 70.12737488746643, "time_total_s": 7370.405659198761, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7370.405659198761, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 81.4227848101266, "ram_util_percent": 51.04177215189873, "gpu_util_percent0": 0.06632911392405064, "vram_util_percent0": 0.18863932291666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0791015625, "cur_lr": 6.083346e-05, "total_loss": -0.08987337967592546, "policy_loss": -0.029120740725669416, "vf_loss": 0.013179972496476363, "vf_explained_var": 0.7757670260559428, "kl": 0.02331225168531631, "entropy": 21.0158310768821, "entropy_coeff": 0.0031666919999999996}, "model": {}, "num_grad_updates_lifetime": 67925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 3932292, "num_env_steps_trained": 3932292, "num_agent_steps_sampled": 3932292, "num_agent_steps_trained": 3932292}, "sampler_results": {"episode_reward_max": 10.615694027506015, "episode_reward_min": -1.4473349077796944, "episode_reward_mean": 6.410726966329423, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.752709324053056, 5.374625557320126, 4.868293747799298, 7.229614577912186, 8.491795717276922, 4.133834834989428, 7.526796144168401, 6.6702932097676415, 7.502393580895231, 6.610555175872363, 0.10372827280038519, 8.98349411910225, 6.943921785387693, 3.68494256729246, 3.6362378088526692, 4.398674954303839, 4.585409509054421, 1.1523637512815201, 8.346074291393478, 6.908521956545898, 6.005420622659301, 4.915736376165571, 8.225593310758807, 10.219994424023033, 6.048062024867451, 8.869049522263818, 8.566596044045028, 5.818196088345101, 5.403359797293778, 4.864151853360773, 7.69086401085176, 10.316079421448723, 10.358018128681417, 6.4249378874021765, 8.896634244751967, 7.493438173597641, 8.60462754002123, 6.869927690056333, 6.044803369020392, 10.38206127964765, 8.557101708405352, 5.608714522054915, 4.956338584169146, 6.579017479421401, 3.4040233274423666, 7.820087694599941, 6.241223595674777, 9.765609926235784, 6.72625411570949, 8.679700061173625, 8.08872800641856, 9.68535899062292, 9.18554219954176, 5.9267712198317355, -1.4473349077796944, 3.1099956532351265, 5.885759050097722, 6.385527202320767, 5.221025147551248, 5.784336871296869, 3.643590174498263, 8.54892093738201, 2.778779839429617, 9.68778649458887, 3.868679105734419, 8.827249763251146, 9.394324622693789, 5.641247008143924, 6.513715554414921, 4.697467048750592, 7.628774857225916, 0.5766071035884782, 6.881736691915166, 9.179517149753172, 5.460696920679577, 5.538098976469248, 1.251033026617898, 5.783257092131426, 7.704607895429443, 5.082305566901233, 3.6127444757340936, 8.625541695976706, 7.292843014725511, 6.767212902734501, 6.809335410528683, 5.268322064377317, 2.4553386645426, 7.681068733846629, 7.424319139177558, 7.9412622950022165, 5.7262122537146665, 5.567396529656943, 5.695339465021933, 5.77139866257222, 6.749787259644532, 10.615694027506015, 6.82036207990816, 7.43874005209721, 9.095577773477828, 4.940191159742902], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7025045051032333, "mean_inference_ms": 7.781667697184194, "mean_action_processing_ms": 0.6550022329680328, "mean_env_wait_ms": 28.971657269379538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023139238357543945, "StateBufferConnector_ms": 0.04469037055969238, "ViewRequirementAgentConnector_ms": 0.7443695068359375}}, "episode_reward_max": 10.615694027506015, "episode_reward_min": -1.4473349077796944, "episode_reward_mean": 6.410726966329423, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.752709324053056, 5.374625557320126, 4.868293747799298, 7.229614577912186, 8.491795717276922, 4.133834834989428, 7.526796144168401, 6.6702932097676415, 7.502393580895231, 6.610555175872363, 0.10372827280038519, 8.98349411910225, 6.943921785387693, 3.68494256729246, 3.6362378088526692, 4.398674954303839, 4.585409509054421, 1.1523637512815201, 8.346074291393478, 6.908521956545898, 6.005420622659301, 4.915736376165571, 8.225593310758807, 10.219994424023033, 6.048062024867451, 8.869049522263818, 8.566596044045028, 5.818196088345101, 5.403359797293778, 4.864151853360773, 7.69086401085176, 10.316079421448723, 10.358018128681417, 6.4249378874021765, 8.896634244751967, 7.493438173597641, 8.60462754002123, 6.869927690056333, 6.044803369020392, 10.38206127964765, 8.557101708405352, 5.608714522054915, 4.956338584169146, 6.579017479421401, 3.4040233274423666, 7.820087694599941, 6.241223595674777, 9.765609926235784, 6.72625411570949, 8.679700061173625, 8.08872800641856, 9.68535899062292, 9.18554219954176, 5.9267712198317355, -1.4473349077796944, 3.1099956532351265, 5.885759050097722, 6.385527202320767, 5.221025147551248, 5.784336871296869, 3.643590174498263, 8.54892093738201, 2.778779839429617, 9.68778649458887, 3.868679105734419, 8.827249763251146, 9.394324622693789, 5.641247008143924, 6.513715554414921, 4.697467048750592, 7.628774857225916, 0.5766071035884782, 6.881736691915166, 9.179517149753172, 5.460696920679577, 5.538098976469248, 1.251033026617898, 5.783257092131426, 7.704607895429443, 5.082305566901233, 3.6127444757340936, 8.625541695976706, 7.292843014725511, 6.767212902734501, 6.809335410528683, 5.268322064377317, 2.4553386645426, 7.681068733846629, 7.424319139177558, 7.9412622950022165, 5.7262122537146665, 5.567396529656943, 5.695339465021933, 5.77139866257222, 6.749787259644532, 10.615694027506015, 6.82036207990816, 7.43874005209721, 9.095577773477828, 4.940191159742902], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7025045051032333, "mean_inference_ms": 7.781667697184194, "mean_action_processing_ms": 0.6550022329680328, "mean_env_wait_ms": 28.971657269379538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023139238357543945, "StateBufferConnector_ms": 0.04469037055969238, "ViewRequirementAgentConnector_ms": 0.7443695068359375}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3932292, "num_agent_steps_trained": 3932292, "num_env_steps_sampled": 3932292, "num_env_steps_trained": 3932292, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 216.7308624193109, "num_env_steps_trained_throughput_per_sec": 216.7308624193109, "timesteps_total": 3932292, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 3932292, "timers": {"training_iteration_time_ms": 70180.225, "sample_time_ms": 53584.32, "load_time_ms": 754.634, "load_throughput": 20722.62, "learn_time_ms": 15384.565, "learn_throughput": 1016.473, "synch_weights_time_ms": 428.238}, "counters": {"num_env_steps_sampled": 3932292, "num_env_steps_trained": 3932292, "num_agent_steps_sampled": 3932292, "num_agent_steps_trained": 3932292}, "done": false, "episodes_total": 1736, "training_iteration": 256, "trial_id": "c5092_00000", "date": "2025-06-08_11-45-01", "timestamp": 1749375901, "time_this_iter_s": 72.18105602264404, "time_total_s": 7442.586715221405, "pid": 124808, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 143078.0001, "r_mean": 0.00262556626757631, "r_var": 483.0033684101736, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [143079, 22972.16387915665, 8656057134306197.0], "realized_pnl": [143079, 25134.61398579515, 1.5855276500918534e+16], "compounded_returns": [143079, 9762.573014769969, 12895976060138.445], "balance": [143079, 20203222.11198927, 4.71661172567763e+19], "position_value": [143079, 147220.57888674256, 2.6311058923603976e+16], "current_position_size": [143079, 736007.0138617902, 6.577645953713654e+17], "last_log_ret": [143079, 0.008255249161021733, 402.001959214211], "sortino_ratio": [143079, 2.752910415198574, 118992041.7616432], "rolling_pnl_sigma": [143079, 0.026793793586883947, 254.77183440602775], "portfolio_cash_ratio": [143079, 0.8074635828149166, 13756.487622225235], "free_collateral": [143079, 20360897.613787904, 4.682961441666398e+19], "mm_reqs": [143079, 12576.133923835261, 677950714077698.5], "unrealized_pnl_0": [143079, 12.713758324559306, 276069948334.0795], "unrealized_pnl_1": [143079, 8.525987280428978, 1152290570760.0972], "unrealized_pnl_2": [143079, 8496.28877383222, 581128348944946.1], "unrealized_pnl_3": [143079, 28846.477073086935, 2.100001257888518e+16], "unrealized_pnl_4": [143079, 77.9392224244697, 2722224430430.253], "unrealized_pnl_5": [143079, 1888.7901092166219, 199580872768434.34], "unrealized_pnl_6": [143079, 81.84825338610932, 2797003945252.488], "unrealized_pnl_7": [143079, 14.260231428081857, 478526888572.02814], "unrealized_pnl_8": [143079, 30.178562518484544, 313907956205.9457], "unrealized_pnl_9": [143079, 970.7470686478086, 57623171273509.64], "margin_usage_ratio": [143079, 0.007215938860799334, 21.02428455708882]}, "pcr_min_ew": 0.9906114521528938, "pcr_max_ew": 1.000000000000073}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000029F4E667760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17_stage1", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [3000000.0, 0.005], [4500000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7442.586715221405, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 79.08780487804877, "ram_util_percent": 51.4439024390244, "gpu_util_percent0": 0.08329268292682927, "vram_util_percent0": 0.18863932291666669}}
